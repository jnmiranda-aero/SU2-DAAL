<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Documentation: SU2_CFD/src/solvers/CAdjNSSolver.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logoSU2small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('CAdjNSSolver_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">CAdjNSSolver.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="CAdjNSSolver_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*!</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * \file CAdjNSSolver.cpp</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * \brief Main subroutines for solving Navier-Stokes adjoint problems.</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * \author F. Palacios, T. Economon, H. Kline</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * \version 8.1.0 &quot;Harrier&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * SU2 Project Website: https://su2code.github.io</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> * The SU2 Project is maintained by the SU2 Foundation</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * (http://su2foundation.org)</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * Copyright 2012-2024, SU2 Contributors (cf. AUTHORS.md)</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> * SU2 is free software; you can redistribute it and/or</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * License as published by the Free Software Foundation; either</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment"> * SU2 is distributed in the hope that it will be useful,</span></div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> * Lesser General Public License for more details.</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment"> * License along with SU2. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160; </div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;../../include/solvers/CAdjNSSolver.hpp&quot;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;../../include/variables/CAdjNSVariable.hpp&quot;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;../../../Common/include/toolboxes/geometry_toolbox.hpp&quot;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#acd8b443b57b29343b1ce316bed3f380b">   33</a></span>&#160;<a class="code" href="classCAdjNSSolver.html#acd8b443b57b29343b1ce316bed3f380b">CAdjNSSolver::CAdjNSSolver</a>() : <a class="code" href="classCAdjEulerSolver.html">CAdjEulerSolver</a>() { }</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a323f1dc7c0b9fe00d1911eeeea365d46">   35</a></span>&#160;<a class="code" href="classCAdjNSSolver.html#acd8b443b57b29343b1ce316bed3f380b">CAdjNSSolver::CAdjNSSolver</a>(<a class="code" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh) : <a class="code" href="classCAdjEulerSolver.html">CAdjEulerSolver</a>() {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iPoint, iVertex;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  <span class="keywordtype">string</span> text_line, mesh_filename;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim, iVar, iMarker;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  ifstream restart_file;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  <span class="keywordtype">string</span> filename, AdjExt;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  <a class="code" href="classCSolver.html#afb69ab045d3dd03f45e013d448c3cea3">adjoint</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> RefArea    = config-&gt;<a class="code" href="classCConfig.html#a515e35504ab34bf25d222e377f3b4c81">GetRefArea</a>();</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> RefDensity  = config-&gt;<a class="code" href="classCConfig.html#af30dc08c28dd72bfcedc6a5a4e224036">GetDensity_FreeStreamND</a>();</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Gas_Constant    = config-&gt;<a class="code" href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Mach_Motion     = config-&gt;<a class="code" href="classCConfig.html#a5442ec644c8d291d3e07c158ba5d54a4">GetMach_Motion</a>();</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *Normal = <span class="keyword">nullptr</span>, myArea_Monitored;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> RefVel2, Mach2Vel, Weight_ObjFunc, factor;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *Velocity_Inf;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">string</span> Marker_Tag, Monitoring_Tag;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring, jMarker, ObjFunc;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">bool</span> grid_movement  = config-&gt;<a class="code" href="classCConfig.html#a9182d3dbb0b3bfa2ebb944f18795f5ca">GetGrid_Movement</a>();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">bool</span> restart = config-&gt;<a class="code" href="classCConfig.html#ae55bdae4e8b4e61fd07a857005cc6799">GetRestart</a>();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  <span class="comment">/*--- Norm heat flux objective test ---*/</span></div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a> = 1.0;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>()==<a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a>)</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a> = 8.0; <span class="comment">// Matches MaxNorm defined in solver_direct_mean.</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="comment">/*--- Set the gamma value ---*/</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> = config-&gt;<a class="code" href="classCConfig.html#a0b5df9254891b32a88e83880778f9261">GetGamma</a>();</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a> = <a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> - 1.0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;  <span class="comment">/*--- Define geometry constants in the solver structure ---*/</span></div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>         = geometry-&gt;<a class="code" href="classCGeometry.html#ace7f7fe876f629f5bd5f92d4805a1a4b">GetnDim</a>();</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>      = config-&gt;<a class="code" href="classCConfig.html#a459dee039e618d21a5d78db61c221240">GetnMarker_All</a>();</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <a class="code" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>       = geometry-&gt;<a class="code" href="classCGeometry.html#a275fb07cd99ab79d7a04b4862280169d">GetnPoint</a>();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  <a class="code" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a> = geometry-&gt;<a class="code" href="classCGeometry.html#ac84179060bbac1fe5e856ea3da850b6e">GetnPointDomain</a>();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a> = <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> + 2;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="comment">/*--- Initialize nVarGrad for deallocation ---*/</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="classCSolver.html#af8dc930f3b6fc31ecf48d2294baf9d5f">nVarGrad</a> = <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160; </div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="classCSolver.html#ac2b7eb546780ee9e5aa95ca88562699d">Residual_RMS</a>.resize(<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>,0.0);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="classCSolver.html#a59da1efb04d4d6cb0627b61005ff3ed5">Residual_Max</a>.resize(<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>,0.0);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="classCSolver.html#af333279175711dc23f668300c357bd5c">Point_Max</a>.resize(<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>,0);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="classCSolver.html#a167cf81a9f3a29dc176728cb033185a4">Point_Max_Coord</a>.<a class="code" href="classC2DContainer.html#adefb48b593f76aa322e228fea8f76127">resize</a>(<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>,<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>) = <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>(0.0);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <span class="comment">/*--- Define some auxiliary arrays related to the residual ---*/</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>     = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>[iVar]     = 0.0;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="classCSolver.html#a313f866523cd6bed20eb620faee4b73a">Residual_i</a>   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code" href="classCSolver.html#a313f866523cd6bed20eb620faee4b73a">Residual_i</a>[iVar]   = 0.0;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="classCSolver.html#a1d6e05a7a904684360013dff7b241be6">Residual_j</a>   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code" href="classCSolver.html#a1d6e05a7a904684360013dff7b241be6">Residual_j</a>[iVar]   = 0.0;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <a class="code" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[iVar]   = 0.0;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[iVar]   = 0.0;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="classCSolver.html#aea78ca4418d89965bfe052196a360389">Res_Conv_j</a>   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code" href="classCSolver.html#aea78ca4418d89965bfe052196a360389">Res_Conv_j</a>[iVar]   = 0.0;</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="classCSolver.html#a75021726ee9fbb9262ffea01e989237a">Res_Visc_j</a>   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code" href="classCSolver.html#a75021726ee9fbb9262ffea01e989237a">Res_Visc_j</a>[iVar]   = 0.0;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="comment">/*--- Define some auxiliary arrays related to the solution ---*/</span></div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="classCSolver.html#a9958742a687a4c92d0bf1ead78aa1a0c">Solution</a>   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code" href="classCSolver.html#a9958742a687a4c92d0bf1ead78aa1a0c">Solution</a>[iVar]   = 0.0;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="classCSolver.html#aa4d789119564e1489b48763e0f7cdeee">Solution_i</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code" href="classCSolver.html#aa4d789119564e1489b48763e0f7cdeee">Solution_i</a>[iVar] = 0.0;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="classCSolver.html#aa3e97145d1cf5b3803df5ac763eca2fc">Solution_j</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code" href="classCSolver.html#aa3e97145d1cf5b3803df5ac763eca2fc">Solution_j</a>[iVar] = 0.0;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="comment">/*--- Define some auxiliary arrays related to the flow solution ---*/</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a066a1c3fb9cf63efc84a58ac67a76437">FlowPrimVar_i</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+7]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+7; iVar++) <a class="code" href="classCAdjEulerSolver.html#a066a1c3fb9cf63efc84a58ac67a76437">FlowPrimVar_i</a>[iVar] = 0.0;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#aa29c3c368ebace7feb2c88a2cc57f260">FlowPrimVar_j</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+7]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+7; iVar++) <a class="code" href="classCAdjEulerSolver.html#aa29c3c368ebace7feb2c88a2cc57f260">FlowPrimVar_j</a>[iVar] = 0.0;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="comment">/*--- Define some auxiliary vectors related to the geometry ---*/</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="classC2DContainer.html">Vector</a>   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]; <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) <a class="code" href="classC2DContainer.html">Vector</a>[iDim]   = 0.0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="classCSolver.html#af494e3d4d3cda6635e6b55da05de9662">Vector_i</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]; <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) <a class="code" href="classCSolver.html#af494e3d4d3cda6635e6b55da05de9662">Vector_i</a>[iDim] = 0.0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="classCSolver.html#af6b2525dd5f8326b7b72f51c5f749b30">Vector_j</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]; <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) <a class="code" href="classCSolver.html#af6b2525dd5f8326b7b72f51c5f749b30">Vector_j</a>[iDim] = 0.0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">/*--- Point to point Jacobians. These are always defined because</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;<span class="comment">   they are also used for sensitivity calculations. ---*/</span></div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160; </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="classCSolver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <a class="code" href="classCSolver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a>[iVar] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[iVar] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="comment">/*--- Solution and residual vectors ---*/</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <a class="code" href="classCSolver.html#a3f318bceaa27f4800de8ecf2cdcae5fb">LinSysSol</a>.Initialize(<a class="code" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>, <a class="code" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a>, <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, 0.0);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.Initialize(<a class="code" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>, <a class="code" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a>, <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, 0.0);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160; </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="comment">/*--- Jacobians and vector structures for implicit computations ---*/</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#a4bf6e287aaf809340df1e40a76cf438b">GetKind_TimeIntScheme_AdjFlow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>) {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classCSolver.html#ae31efca489e7d21f78b5c63c7c353134">Jacobian_ij</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <a class="code" href="classCSolver.html#aeca105abe8a547328e2b1a320708b226">Jacobian_ji</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <a class="code" href="classCSolver.html#a0ff55af7303be290661b65f60a037a42">Jacobian_jj</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) {</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[iVar] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      <a class="code" href="classCSolver.html#ae31efca489e7d21f78b5c63c7c353134">Jacobian_ij</a>[iVar] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;      <a class="code" href="classCSolver.html#aeca105abe8a547328e2b1a320708b226">Jacobian_ji</a>[iVar] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <a class="code" href="classCSolver.html#a0ff55af7303be290661b65f60a037a42">Jacobian_jj</a>[iVar] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    }</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Initialize Jacobian structure (Adjoint N-S). MG level: &quot;</span> &lt;&lt; iMesh &lt;&lt;<span class="stringliteral">&quot;.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#ae17220ac30c2abcc7fdd3c5dc8f04571">Initialize</a>(<a class="code" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>, <a class="code" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a>, <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <span class="keyword">true</span>, geometry, config);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>)</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Explicit scheme. No Jacobian structure (Adjoint N-S). MG level: &quot;</span> &lt;&lt; iMesh &lt;&lt;<span class="stringliteral">&quot;.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="comment">/*--- Sensitivity definition and coefficient on all markers ---*/</span></div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="keywordflow">for</span> (iMarker=0; iMarker&lt;<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a>[iMarker] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [geometry-&gt;<a class="code" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]];</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <span class="comment">/*--- Store the value of the characteristic primitive variables at the boundaries ---*/</span></div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a88866367a785e4cfdc5f72606c6cfe4c">DonorAdjVar</a>.resize(<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#a88866367a785e4cfdc5f72606c6cfe4c">DonorAdjVar</a>[iMarker].resize(geometry-&gt;<a class="code" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++) {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a88866367a785e4cfdc5f72606c6cfe4c">DonorAdjVar</a>[iMarker][iVertex].resize(<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, 0.0);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  }</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160; </div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <span class="comment">/*--- Store the value of the characteristic primitive variables at the boundaries ---*/</span></div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160; </div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#aa9f35cdd46666eb545d831c9bc5985d5">DonorGlobalIndex</a>.resize(<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>);</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#aa9f35cdd46666eb545d831c9bc5985d5">DonorGlobalIndex</a>[iMarker].resize(geometry-&gt;<a class="code" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker],0);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  }</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">Sens_Geo</a>   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>  = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>   = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>  = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a3f9e8576dc150e551bd19a64b1d43977">Sens_BPress</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">/*--- Initialize sensitivities to zero ---*/</span></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">Sens_Geo</a>[iMarker]   = 0.0;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker]  = 0.0;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker]   = 0.0;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] = 0.0;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker]  = 0.0;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#a3f9e8576dc150e551bd19a64b1d43977">Sens_BPress</a>[iMarker] = 0.0;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++)</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a>[iMarker][iVertex] = 0.0;</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="comment">/*--- Initialize the adjoint variables to zero (infinity state) ---*/</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a11a688be02f50bf45a49f23ea4ac4cb2">PsiRho_Inf</a> = 0.0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  <span class="keywordflow">if</span> ((config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a">TOTAL_HEATFLUX</a>) ||</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      (config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a>) ||</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      (config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7">INVERSE_DESIGN_HEATFLUX</a>))</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#a4a53581a74846bf44a7d7a85d15bb8e5">PsiE_Inf</a> = 1.0;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#a4a53581a74846bf44a7d7a85d15bb8e5">PsiE_Inf</a> = 0.0;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">Phi_Inf</a> = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">Phi_Inf</a>[0] = 0.0; <a class="code" href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">Phi_Inf</a>[1] = 0.0;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) <a class="code" href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">Phi_Inf</a>[2] = 0.0;</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <span class="comment">/*--- Initialize the solution to the far-field state everywhere. ---*/</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a> = <span class="keyword">new</span> <a class="code" href="classCAdjNSVariable.html">CAdjNSVariable</a>(<a class="code" href="classCAdjEulerSolver.html#a11a688be02f50bf45a49f23ea4ac4cb2">PsiRho_Inf</a>, <a class="code" href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">Phi_Inf</a>, <a class="code" href="classCAdjEulerSolver.html#a4a53581a74846bf44a7d7a85d15bb8e5">PsiE_Inf</a>, <a class="code" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>, <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, config);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="classCSolver.html#ad982896202dae6e41bfd3568f597cf46">SetBaseClassPointerToNodes</a>();</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160; </div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="comment">/*--- Read the restart metadata. ---*/</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160; </div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">if</span> (restart &amp;&amp; (iMesh == <a class="code" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>)) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    mesh_filename = config-&gt;<a class="code" href="classCConfig.html#a1132191f9f5af73ef4ff7eb356f41181">GetSolution_AdjFileName</a>();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    filename      = config-&gt;<a class="code" href="classCConfig.html#ace4081f7013cfe0fd756dff7d9ba7f8f">GetObjFunc_Extension</a>(mesh_filename);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;<span class="comment">//    Read_SU2_Restart_Metadata(geometry, config, true, filename);</span></div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160; </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">/*--- Calculate area monitored for area-averaged-outflow-quantity-based objectives ---*/</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   myArea_Monitored = 0.0;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="keywordflow">for</span> (iMarker_Monitoring = 0; iMarker_Monitoring &lt; config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>(); iMarker_Monitoring++) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;     <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring)==<a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa996eee7e64825e2976ea751d9ef2c6c1">SURFACE_TOTAL_PRESSURE</a> ||</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;         config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring)==<a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aae0adda208c6e887373a12474a9e6d9e2">SURFACE_STATIC_PRESSURE</a>) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;       Monitoring_Tag = config-&gt;<a class="code" href="classCConfig.html#a4558fc163c393e628050e7a2273673f1">GetMarker_Monitoring_TagBound</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;       <span class="comment">/*-- Find the marker index ---*/</span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;       iMarker = 0;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;       <span class="keywordflow">for</span> (jMarker= 0; jMarker &lt; config-&gt;<a class="code" href="classCConfig.html#a459dee039e618d21a5d78db61c221240">GetnMarker_All</a>(); jMarker++) {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;         Marker_Tag = config-&gt;<a class="code" href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">GetMarker_All_TagBound</a>(jMarker);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;         <span class="keywordflow">if</span> (Marker_Tag == Monitoring_Tag) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;           iMarker = jMarker;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;           <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++) {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;             iPoint = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;             <span class="keywordflow">if</span> (geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;               Normal = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>();</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;               myArea_Monitored += <a class="code" href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a>(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, Normal);</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;             }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;           }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;           <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;         }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;       }</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;     }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160; </div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="preprocessor"> #ifdef HAVE_MPI</span></div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;   <a class="code" href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">Area_Monitored</a> = 0.0;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   <a class="code" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;myArea_Monitored, &amp;<a class="code" href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">Area_Monitored</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="preprocessor"> #else</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <a class="code" href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">Area_Monitored</a> = myArea_Monitored;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;<span class="preprocessor"> #endif</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;   <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#aad80e2ae9bc0b7b1fed6ccc2b6b2bce0">GetnObj</a>() &gt; 1 &amp;&amp; iMesh == <a class="code" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>) {</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;     <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;       Mach2Vel = <a class="code" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(<a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>*Gas_Constant*config-&gt;<a class="code" href="classCConfig.html#afa49e1ce7793a31cc572d957caffaef9">GetTemperature_FreeStreamND</a>());</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;       RefVel2 = (Mach_Motion*Mach2Vel)*(Mach_Motion*Mach2Vel);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;     }</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;     <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;       Velocity_Inf = config-&gt;<a class="code" href="classCConfig.html#ae33781eb89184d511e23b7e247d21c8a">GetVelocity_FreeStreamND</a>();</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;       RefVel2 = 0.0;</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;       <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;         RefVel2  += Velocity_Inf[iDim]*Velocity_Inf[iDim];</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;     }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;     <span class="comment">/*--- Objective scaling: a factor must be applied to certain objectives ---*/</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;     <span class="keywordflow">for</span> (iMarker_Monitoring = 0; iMarker_Monitoring &lt; config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>(); iMarker_Monitoring++) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;         Weight_ObjFunc = config-&gt;<a class="code" href="classCConfig.html#a614c55e8d7945a11d92d7b51851291c2">GetWeight_ObjFunc</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;         factor = 1.0/(0.5*RefDensity*RefArea*RefVel2);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;         ObjFunc = config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;         <span class="keywordflow">if</span> ((ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7">INVERSE_DESIGN_HEATFLUX</a>) ||</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;             (ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a">TOTAL_HEATFLUX</a>) || (ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a>) ||</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;             (ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa2d1bc11eae99ce594d0a2281210e64d4">SURFACE_MASSFLOW</a>) ) factor = 1.0;</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">if</span> ((ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa996eee7e64825e2976ea751d9ef2c6c1">SURFACE_TOTAL_PRESSURE</a>) || (ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aae0adda208c6e887373a12474a9e6d9e2">SURFACE_STATIC_PRESSURE</a>))</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;          factor = 1.0/<a class="code" href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">Area_Monitored</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160; </div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        Weight_ObjFunc = Weight_ObjFunc*factor;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        config-&gt;<a class="code" href="classCConfig.html#adb9ce1745b78e43a916afd47c9d4e96b">SetWeight_ObjFunc</a>(iMarker_Monitoring, Weight_ObjFunc);</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;     }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;   }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="comment">/*--- MPI solution ---*/</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <a class="code" href="classCSolver.html#aab651e902cb3020b525c154cb76c4264">InitiateComms</a>(geometry, config, <a class="code" href="option__structure_8hpp.html#adfbf8ea588ac42ebd8a665059e6ff5f8ae3d87c0113dc985c598feb409a45c552">MPI_QUANTITIES::SOLUTION</a>);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="classCSolver.html#a3912ec3b77bf15b77790be7399f4fa53">CompleteComms</a>(geometry, config, <a class="code" href="option__structure_8hpp.html#adfbf8ea588ac42ebd8a665059e6ff5f8ae3d87c0113dc985c598feb409a45c552">MPI_QUANTITIES::SOLUTION</a>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;}</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160; </div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<a class="code" href="classCAdjNSSolver.html#a6e2a8b29fa5c5709d12e7970d8cc88eb">CAdjNSSolver::~CAdjNSSolver</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160; </div>
<div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a22ab579adc04b7c212508480df9dff8b">  292</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCAdjNSSolver.html#a22ab579adc04b7c212508480df9dff8b">CAdjNSSolver::SetTime_Step</a>(<a class="code" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code" href="classCSolver.html">CSolver</a> **solver_container, <a class="code" href="classCConfig.html">CConfig</a> *config,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Iteration) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <span class="comment">/*--- Use the flow solution to update the time step</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">   *    The time step depends on the characteristic velocity, which is the same</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;<span class="comment">   *    for the adjoint and flow solutions, albeit in the opposite direction. ---*/</span></div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#a59168ff9a35447672e6ee77cf4bcb1ec">SetTime_Step</a>(geometry, solver_container, config, iMesh, Iteration);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160; </div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160; </div>
<div class="line"><a name="l00302"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a0669f6fb8ef7cd7800d151d4aff7d3f6">  302</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCAdjNSSolver.html#a0669f6fb8ef7cd7800d151d4aff7d3f6">CAdjNSSolver::Preprocessing</a>(<a class="code" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code" href="classCSolver.html">CSolver</a> **solver_container, <a class="code" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iRKStep, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> RunTime_EqSystem, <span class="keywordtype">bool</span> Output) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iPoint, nonPhysicalPoints = 0;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> SharpEdge_Distance;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="keywordtype">bool</span> physical = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="comment">/*--- Retrieve information about the spatial and temporal integration for the</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;<span class="comment">   adjoint equations (note that the flow problem may use different methods). ---*/</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="keywordtype">bool</span> implicit       = (config-&gt;<a class="code" href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">GetKind_TimeIntScheme</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordtype">bool</span> limiter        = (config-&gt;<a class="code" href="classCConfig.html#aba1a437d929fef85ee9ea86dae47925f">GetKind_SlopeLimit_AdjFlow</a>() != <a class="code" href="option__structure_8hpp.html#a6a09a5472a47da677853641e633f3abeab50339a10e1de285ac99d4c3990b8693">LIMITER::NONE</a>);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <span class="keywordtype">bool</span> center_jst     = (config-&gt;<a class="code" href="classCConfig.html#aef335760724e0367ef46cd2714ce236d">GetKind_Centered_AdjFlow</a>() == <a class="code" href="option__structure_8hpp.html#adb5c3260b4674bf85aa558c7bff71772acadbfdd0081764bd8d24111dfa08a35f">CENTERED::JST</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordtype">bool</span> fixed_cl       = config-&gt;<a class="code" href="classCConfig.html#ae688e355a74025050498d8c03aee35b2">GetFixed_CL_Mode</a>();</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <span class="keywordtype">bool</span> eval_dof_dcx   = config-&gt;<a class="code" href="classCConfig.html#ab090a18d19d62ffc6fbf89f195eed16e">GetEval_dOF_dCX</a>();</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">/*--- Update the objective function coefficient to guarantee zero gradient. ---*/</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">if</span> (fixed_cl &amp;&amp; eval_dof_dcx) { <a class="code" href="classCAdjEulerSolver.html#a5265a44e6c43dee677c9f26333148432">SetFarfield_AoA</a>(geometry, solver_container, config, iMesh, Output); }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160; </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="comment">/*--- Residual initialization ---*/</span></div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160; </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">for</span> (iPoint = 0; iPoint &lt; <a class="code" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>; iPoint ++) {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="comment">/*--- Get the distance form a sharp edge ---*/</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    SharpEdge_Distance = geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#a8610d0fe0bf651b7036be5b3a6e1c130">GetSharpEdge_Distance</a>(iPoint);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">/*--- Set the primitive variables compressible</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;<span class="comment">     adjoint variables ---*/</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    physical = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCAdjEulerVariable.html#a08d1474748d5ddf53d62c1dde9f23ac8">SetPrimVar</a>(iPoint,SharpEdge_Distance, <span class="keyword">false</span>, config);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">/* Check for non-realizable states for reporting. */</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160; </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">if</span> (!physical) nonPhysicalPoints++;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160; </div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">/*--- Initialize the convective residual vector ---*/</span></div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160; </div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="keywordflow">if</span> (!Output) <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code" href="classCSysVector.html#a9990ad4ea225c98a1af50e00fecbc56f">SetBlock_Zero</a>(iPoint);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160; </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  }</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">/*--- Compute gradients adj for solution reconstruction and viscous term ---*/</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#a350466e9cc76639fb07c59ac43288bb8">GetReconstructionGradientRequired</a>()) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#af59700a2ce4edce862248ba52bdca025">GetKind_Gradient_Method_Recon</a>() == <a class="code" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4afda8790c8835b1a9827c006a31ea8465">GREEN_GAUSS</a>)</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;      <a class="code" href="classCSolver.html#a750e8a00ec7b8b41ff51c91fc4e35fe8">SetSolution_Gradient_GG</a>(geometry, config, 1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#af59700a2ce4edce862248ba52bdca025">GetKind_Gradient_Method_Recon</a>() == <a class="code" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a8e655dfdcc23cb033e14c30ff83f9df2">LEAST_SQUARES</a>)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <a class="code" href="classCSolver.html#a65af02f97fcf03a0f44c15dbb48522b9">SetSolution_Gradient_LS</a>(geometry, config, 1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#af59700a2ce4edce862248ba52bdca025">GetKind_Gradient_Method_Recon</a>() == <a class="code" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a06b4cd5e24ce8576f9329c2b5f75ba82">WEIGHTED_LEAST_SQUARES</a>)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <a class="code" href="classCSolver.html#a65af02f97fcf03a0f44c15dbb48522b9">SetSolution_Gradient_LS</a>(geometry, config, 1, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  }</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#a83d5144467a2c2fa78a7f9cc19026421">GetKind_Gradient_Method</a>() == <a class="code" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4afda8790c8835b1a9827c006a31ea8465">GREEN_GAUSS</a>) <a class="code" href="classCSolver.html#a750e8a00ec7b8b41ff51c91fc4e35fe8">SetSolution_Gradient_GG</a>(geometry, config, 1);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#a83d5144467a2c2fa78a7f9cc19026421">GetKind_Gradient_Method</a>() == <a class="code" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a06b4cd5e24ce8576f9329c2b5f75ba82">WEIGHTED_LEAST_SQUARES</a>) <a class="code" href="classCSolver.html#a65af02f97fcf03a0f44c15dbb48522b9">SetSolution_Gradient_LS</a>(geometry, config, 1);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="comment">/*--- Limiter computation (upwind reconstruction) ---*/</span></div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">if</span> (limiter &amp;&amp; !Output) <a class="code" href="classCSolver.html#a6bc3916452ffa54c2436de7bb627fefa">SetSolution_Limiter</a>(geometry, config);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">/*--- Compute gradients adj for viscous term coupling ---*/</span></div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160; </div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  <span class="keywordflow">if</span> ((config-&gt;<a class="code" href="classCConfig.html#a77312cf52a5ba2cc1239b7cee6fce7a7">GetKind_Solver</a>() == <a class="code" href="option__structure_8hpp.html#a44d6272fd9607cb31468949e83b21a1caf22389272c967284acc10130b9ce0e6c">MAIN_SOLVER::ADJ_RANS</a>) &amp;&amp; (!config-&gt;<a class="code" href="classCConfig.html#a693b7f150eb8b7a455e4174d4af744b8">GetFrozen_Visc_Cont</a>())) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#a83d5144467a2c2fa78a7f9cc19026421">GetKind_Gradient_Method</a>() == <a class="code" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4afda8790c8835b1a9827c006a31ea8465">GREEN_GAUSS</a>) solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code" href="classCSolver.html#a750e8a00ec7b8b41ff51c91fc4e35fe8">SetSolution_Gradient_GG</a>(geometry, config, 1);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#a83d5144467a2c2fa78a7f9cc19026421">GetKind_Gradient_Method</a>() == <a class="code" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a06b4cd5e24ce8576f9329c2b5f75ba82">WEIGHTED_LEAST_SQUARES</a>) solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code" href="classCSolver.html#a65af02f97fcf03a0f44c15dbb48522b9">SetSolution_Gradient_LS</a>(geometry, config, 1);</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  }</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;  <span class="comment">/*--- Artificial dissipation for centered schemes ---*/</span></div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keywordflow">if</span> (center_jst &amp;&amp; (iMesh == <a class="code" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>)) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#af1b72ed76900f821d2f51942cb4252db">SetCentered_Dissipation_Sensor</a>(geometry, config);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <a class="code" href="classCSolver.html#ae9fa6bf0e3ef0dff07dd85e0a87eef4d">SetUndivided_Laplacian</a>(geometry, config);</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  }</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  <span class="comment">/*--- Initialize the Jacobian for implicit integration ---*/</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keywordflow">if</span> (implicit) <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#a8f974ad2e089dccfc99ea21a4ef5a819">SetValZero</a>();</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="comment">/*--- Error message ---*/</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#aa495414133c826e5f6651d4ce82d0ef6">GetComm_Level</a>() == <a class="code" href="option__structure_8hpp.html#a98b1b0d541147aaee4b7100c8b0892e6a686cd34998b25d1929374643e062a074">COMM_FULL</a>) {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> MyErrorCounter = nonPhysicalPoints; nonPhysicalPoints = 0;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <a class="code" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyErrorCounter, &amp;nonPhysicalPoints, 1, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keywordflow">if</span> (iMesh == <a class="code" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>) config-&gt;<a class="code" href="classCConfig.html#a434fe0922532828b7e40ded865c5ce51">SetNonphysical_Points</a>(nonPhysicalPoints);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160; </div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;}</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160; </div>
<div class="line"><a name="l00391"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a87064a324dd57b715155f405fc0804fc">  391</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCAdjNSSolver.html#a87064a324dd57b715155f405fc0804fc">CAdjNSSolver::Viscous_Residual</a>(<a class="code" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code" href="classCSolver.html">CSolver</a> **solver_container, <a class="code" href="classCNumerics.html">CNumerics</a> **numerics_container,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                    <a class="code" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iRKStep) {</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160; </div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  <a class="code" href="classCNumerics.html">CNumerics</a>* numerics = numerics_container[<a class="code" href="option__structure_8hpp.html#a8a925ac62604ec86956557ab2acfb3f9">VISC_TERM</a>];</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iPoint, jPoint, iEdge;</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keywordtype">bool</span> implicit = (config-&gt;<a class="code" href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">GetKind_TimeIntScheme</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordflow">for</span> (iEdge = 0; iEdge &lt; geometry-&gt;<a class="code" href="classCGeometry.html#aba89cceede61b33426b2783385431f5b">GetnEdge</a>(); iEdge++) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="comment">/*--- Points in edge, coordinates and normal vector---*/</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    iPoint = geometry-&gt;<a class="code" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code" href="classCEdge.html#a5cd6f283cb2f3e4dfc037c0db6ae1055">GetNode</a>(iEdge,0);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    jPoint = geometry-&gt;<a class="code" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code" href="classCEdge.html#a5cd6f283cb2f3e4dfc037c0db6ae1055">GetNode</a>(iEdge,1);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    numerics-&gt;<a class="code" href="classCNumerics.html#a6ca4a8e17d68ea63f1dba96cd5f2967d">SetCoord</a>(geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(iPoint), geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(jPoint));</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    numerics-&gt;<a class="code" href="classCNumerics.html#a93fd2262832ae5081317548f2f9cdbb3">SetNormal</a>(geometry-&gt;<a class="code" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code" href="classCEdge.html#a4ace970590e47bd39ea5780c3e0e2037">GetNormal</a>(iEdge));</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160; </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="comment">/*--- Primitive variables w/o reconstruction and adjoint variables w/o reconstruction---*/</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160; </div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    numerics-&gt;<a class="code" href="classCNumerics.html#a028c500ba7ce96d3af061fc8218f76f1">SetPrimitive</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a634a803b0d397aec7a44420cd5159079">GetPrimitive</a>(iPoint),</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                           solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a634a803b0d397aec7a44420cd5159079">GetPrimitive</a>(jPoint));</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160; </div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    numerics-&gt;<a class="code" href="classCNumerics.html#a7a305597659a44840687afc1c1e0da6b">SetAdjointVar</a>(<a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint), <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(jPoint));</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">/*--- Gradient and limiter of Adjoint Variables ---*/</span></div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160; </div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    numerics-&gt;<a class="code" href="classCNumerics.html#a254b157377df5d326d24ee75e6e3676c">SetAdjointVarGradient</a>(<a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a07d4f954fe5a79e6f85adab3d462d73c">GetGradient</a>(iPoint), <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a07d4f954fe5a79e6f85adab3d462d73c">GetGradient</a>(jPoint));</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">/*--- Compute residual ---*/</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    numerics-&gt;<a class="code" href="classCNumerics.html#aa0ca13663a047ef2640b377b33875e29">ComputeResidual</a>(<a class="code" href="classCSolver.html#a313f866523cd6bed20eb620faee4b73a">Residual_i</a>, <a class="code" href="classCSolver.html#a1d6e05a7a904684360013dff7b241be6">Residual_j</a>, <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>, <a class="code" href="classCSolver.html#ae31efca489e7d21f78b5c63c7c353134">Jacobian_ij</a>, <a class="code" href="classCSolver.html#aeca105abe8a547328e2b1a320708b226">Jacobian_ji</a>, <a class="code" href="classCSolver.html#a0ff55af7303be290661b65f60a037a42">Jacobian_jj</a>, config);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    <span class="comment">/*--- Update adjoint viscous residual ---*/</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code" href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">SubtractBlock</a>(iPoint, <a class="code" href="classCSolver.html#a313f866523cd6bed20eb620faee4b73a">Residual_i</a>);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code" href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">AddBlock</a>(jPoint, <a class="code" href="classCSolver.html#a1d6e05a7a904684360013dff7b241be6">Residual_j</a>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#a423b77066cf386dd6e4b95a656e4aadb">SubtractBlock2Diag</a>(iPoint, <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#aaa63a679856fad3b4e76f9085b0ca40f">SubtractBlock</a>(iPoint, jPoint, <a class="code" href="classCSolver.html#ae31efca489e7d21f78b5c63c7c353134">Jacobian_ij</a>);</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;      <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#a03a189a2120be05e21fbd9b120549427">AddBlock</a>(jPoint, iPoint, <a class="code" href="classCSolver.html#aeca105abe8a547328e2b1a320708b226">Jacobian_ji</a>);</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;      <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#a5a4ef7eeb7f009450f575660108ed7be">AddBlock2Diag</a>(jPoint, <a class="code" href="classCSolver.html#a0ff55af7303be290661b65f60a037a42">Jacobian_jj</a>);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    }</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160; </div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;  }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160; </div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;}</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160; </div>
<div class="line"><a name="l00441"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a3f7289e94076471c23e53da293b69645">  441</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCAdjNSSolver.html#a3f7289e94076471c23e53da293b69645">CAdjNSSolver::Source_Residual</a>(<a class="code" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code" href="classCSolver.html">CSolver</a> **solver_container,</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;                                   <a class="code" href="classCNumerics.html">CNumerics</a> **numerics_container, <a class="code" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh) {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160; </div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;  <a class="code" href="classCNumerics.html">CNumerics</a>* numerics = numerics_container[<a class="code" href="option__structure_8hpp.html#a6d78d8ad6e8f106b8e77781f0b431ca6">SOURCE_FIRST_TERM</a>];</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;  <a class="code" href="classCNumerics.html">CNumerics</a>* second_numerics = numerics_container[<a class="code" href="option__structure_8hpp.html#a1fe79b42ed6f64e83f679323332fd763">SOURCE_SECOND_TERM</a>];</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iPoint, jPoint, iEdge;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keywordtype">bool</span> implicit = (config-&gt;<a class="code" href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">GetKind_TimeIntScheme</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;  <span class="keywordtype">bool</span> rotating_frame = config-&gt;<a class="code" href="classCConfig.html#ad201abca17f7635b19c11cc11b03b0ac">GetRotating_Frame</a>();</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;  <span class="comment">/*--- Loop over all the points, note that we are supposing that primitive and</span></div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;<span class="comment">   adjoint gradients have been computed previously ---*/</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;  <span class="keywordflow">for</span> (iPoint = 0; iPoint &lt; <a class="code" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a>; iPoint++) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160; </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="comment">/*--- Primitive variables w/o reconstruction, and its gradient ---*/</span></div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160; </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    numerics-&gt;<a class="code" href="classCNumerics.html#a028c500ba7ce96d3af061fc8218f76f1">SetPrimitive</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a634a803b0d397aec7a44420cd5159079">GetPrimitive</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160; </div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    numerics-&gt;<a class="code" href="classCNumerics.html#a49309c657274b77aa644958053b68bf4">SetPrimVarGradient</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160; </div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="comment">/*--- Gradient of adjoint variables ---*/</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160; </div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    numerics-&gt;<a class="code" href="classCNumerics.html#a254b157377df5d326d24ee75e6e3676c">SetAdjointVarGradient</a>(<a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a07d4f954fe5a79e6f85adab3d462d73c">GetGradient</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160; </div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="comment">/*--- Set volume ---*/</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    numerics-&gt;<a class="code" href="classCNumerics.html#a53c24228ba235c1a0c2e4509243e5e88">SetVolume</a>(geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#a35a504401472dfa76ef1187a5675414f">GetVolume</a>(iPoint));</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160; </div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">/*--- If turbulence computation we must add some coupling terms to the NS adjoint eq. ---*/</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160; </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span> ((config-&gt;<a class="code" href="classCConfig.html#a77312cf52a5ba2cc1239b7cee6fce7a7">GetKind_Solver</a>() == <a class="code" href="option__structure_8hpp.html#a44d6272fd9607cb31468949e83b21a1caf22389272c967284acc10130b9ce0e6c">MAIN_SOLVER::ADJ_RANS</a>) &amp;&amp; (!config-&gt;<a class="code" href="classCConfig.html#a693b7f150eb8b7a455e4174d4af744b8">GetFrozen_Visc_Cont</a>())) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="comment">/*--- Turbulent variables w/o reconstruction and its gradient ---*/</span></div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      numerics-&gt;<a class="code" href="classCNumerics.html#a6e1c4dea51983cbe489762bd43bae41d">SetScalarVar</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287">TURB_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      numerics-&gt;<a class="code" href="classCNumerics.html#a8c5ce8e8a1cb2c0bb03bf408d9a80d68">SetScalarVarGradient</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287">TURB_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a07d4f954fe5a79e6f85adab3d462d73c">GetGradient</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160; </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <span class="comment">/*--- Turbulent adjoint variables w/o reconstruction and its gradient ---*/</span></div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      numerics-&gt;<a class="code" href="classCNumerics.html#aaf211e0fafb2ffea485a888cc5a3a725">SetTurbAdjointVar</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160; </div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      numerics-&gt;<a class="code" href="classCNumerics.html#a3466f25da2e4c85318ee663b2d2cb1bb">SetTurbAdjointGradient</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a07d4f954fe5a79e6f85adab3d462d73c">GetGradient</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="comment">/*--- Set distance to the surface ---*/</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      numerics-&gt;<a class="code" href="classCNumerics.html#a9c9dd8be231884769f29c799db2404be">SetDistance</a>(geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#ac4bc76884771541056fd8b0471c161d2">GetWall_Distance</a>(iPoint), 0.0);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160; </div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="comment">/*--- Compute residual ---*/</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160; </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    numerics-&gt;<a class="code" href="classCNumerics.html#aa0ca13663a047ef2640b377b33875e29">ComputeResidual</a>(<a class="code" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>, config);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160; </div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <span class="comment">/*--- Add to the residual ---*/</span></div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160; </div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code" href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">AddBlock</a>(iPoint, <a class="code" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160; </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;  }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160; </div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;  <span class="comment">/*--- If turbulence computation we must add some coupling terms to the NS adjoint eq. ---*/</span></div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160; </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;  <span class="keywordflow">if</span> ((config-&gt;<a class="code" href="classCConfig.html#a77312cf52a5ba2cc1239b7cee6fce7a7">GetKind_Solver</a>() == <a class="code" href="option__structure_8hpp.html#a44d6272fd9607cb31468949e83b21a1caf22389272c967284acc10130b9ce0e6c">MAIN_SOLVER::ADJ_RANS</a>) &amp;&amp; (!config-&gt;<a class="code" href="classCConfig.html#a693b7f150eb8b7a455e4174d4af744b8">GetFrozen_Visc_Cont</a>())) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordflow">for</span> (iEdge = 0; iEdge &lt; geometry-&gt;<a class="code" href="classCGeometry.html#aba89cceede61b33426b2783385431f5b">GetnEdge</a>(); iEdge++) {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160; </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;      <span class="comment">/*--- Points in edge, and normal vector ---*/</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      iPoint = geometry-&gt;<a class="code" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code" href="classCEdge.html#a5cd6f283cb2f3e4dfc037c0db6ae1055">GetNode</a>(iEdge,0);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      jPoint = geometry-&gt;<a class="code" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code" href="classCEdge.html#a5cd6f283cb2f3e4dfc037c0db6ae1055">GetNode</a>(iEdge,1);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      second_numerics-&gt;<a class="code" href="classCNumerics.html#a93fd2262832ae5081317548f2f9cdbb3">SetNormal</a>(geometry-&gt;<a class="code" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code" href="classCEdge.html#a4ace970590e47bd39ea5780c3e0e2037">GetNormal</a>(iEdge));</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      <span class="comment">/*--- Conservative variables w/o reconstruction ---*/</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160; </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;      second_numerics-&gt;<a class="code" href="classCNumerics.html#a2d59a0969bac4b0e43b74ba4ec4d1eff">SetConservative</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint),</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                                     solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(jPoint));</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;      <span class="comment">/*--- Gradient of primitive variables w/o reconstruction ---*/</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      second_numerics-&gt;<a class="code" href="classCNumerics.html#a49309c657274b77aa644958053b68bf4">SetPrimVarGradient</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint),</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                                        solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(jPoint));</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;      <span class="comment">/*--- Viscosity ---*/</span></div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160; </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      second_numerics-&gt;<a class="code" href="classCNumerics.html#a0d3d722905b8615ef2cb5d59c4b95fb3">SetLaminarViscosity</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(iPoint),</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;                                         solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(jPoint));</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      <span class="comment">/*--- Turbulent variables w/o reconstruction ---*/</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;      second_numerics-&gt;<a class="code" href="classCNumerics.html#a6e1c4dea51983cbe489762bd43bae41d">SetScalarVar</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287">TURB_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint),</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;                                solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287">TURB_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(jPoint));</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160; </div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      <span class="comment">/*--- Turbulent adjoint variables w/o reconstruction ---*/</span></div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      second_numerics-&gt;<a class="code" href="classCNumerics.html#aaf211e0fafb2ffea485a888cc5a3a725">SetTurbAdjointVar</a>(solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint),</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                       solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(jPoint));</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160; </div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;      <span class="comment">/*--- Set distance to the surface ---*/</span></div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      second_numerics-&gt;<a class="code" href="classCNumerics.html#a9c9dd8be231884769f29c799db2404be">SetDistance</a>(geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#ac4bc76884771541056fd8b0471c161d2">GetWall_Distance</a>(iPoint), geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#ac4bc76884771541056fd8b0471c161d2">GetWall_Distance</a>(jPoint));</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;      <span class="comment">/*--- Update adjoint viscous residual ---*/</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160; </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;      second_numerics-&gt;<a class="code" href="classCNumerics.html#aa0ca13663a047ef2640b377b33875e29">ComputeResidual</a>(<a class="code" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>, config);</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160; </div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code" href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">AddBlock</a>(iPoint, <a class="code" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code" href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">SubtractBlock</a>(jPoint, <a class="code" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>);</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;    }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  }</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160; </div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="comment">// WARNING: The rotating frame source term has been placed in the second</span></div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  <span class="comment">// source term container since the section below is commented. This needs a</span></div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">// permanent fix asap!</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160; </div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;  <span class="keywordflow">if</span> (rotating_frame) {</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="comment">/*--- Loop over all points ---*/</span></div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">for</span> (iPoint = 0; iPoint &lt; <a class="code" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a>; iPoint++) {</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;      <span class="comment">/*--- Load the adjoint variables ---*/</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;      second_numerics-&gt;<a class="code" href="classCNumerics.html#a7a305597659a44840687afc1c1e0da6b">SetAdjointVar</a>(<a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint),</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                                     <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint));</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;      <span class="comment">/*--- Load the volume of the dual mesh cell ---*/</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      second_numerics-&gt;<a class="code" href="classCNumerics.html#a53c24228ba235c1a0c2e4509243e5e88">SetVolume</a>(geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#a35a504401472dfa76ef1187a5675414f">GetVolume</a>(iPoint));</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160; </div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;      <span class="comment">/*--- Compute the adjoint rotating frame source residual ---*/</span></div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      second_numerics-&gt;<a class="code" href="classCNumerics.html#aa0ca13663a047ef2640b377b33875e29">ComputeResidual</a>(<a class="code" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>, <a class="code" href="classCSolver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a>, config);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;      <span class="comment">/*--- Add the source residual to the total ---*/</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code" href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">AddBlock</a>(iPoint, <a class="code" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <span class="comment">/*--- Add the implicit Jacobian contribution ---*/</span></div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">if</span> (implicit) <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#a5a4ef7eeb7f009450f575660108ed7be">AddBlock2Diag</a>(iPoint, <a class="code" href="classCSolver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a>);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160; </div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  }</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;}</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160; </div>
<div class="line"><a name="l00583"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a6e72f094190680fa7fb078d7aae9c1d8">  583</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCAdjNSSolver.html#a6e72f094190680fa7fb078d7aae9c1d8">CAdjNSSolver::Viscous_Sensitivity</a>(<a class="code" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code" href="classCSolver.html">CSolver</a> **solver_container, <a class="code" href="classCNumerics.html">CNumerics</a> *numerics, <a class="code" href="classCConfig.html">CConfig</a> *config) {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160; </div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iVertex, iPoint;</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim, jDim, iMarker, iPos, jPos;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *d = <span class="keyword">nullptr</span>, div_phi, *Normal = <span class="keyword">nullptr</span>, Area,</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;  normal_grad_psi5, normal_grad_T, sigma_partial, Laminar_Viscosity = 0.0, heat_flux_factor, temp_sens = 0.0,</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  *Psi = <span class="keyword">nullptr</span>, *U = <span class="keyword">nullptr</span>, Enthalpy, gradPsi5_v, psi5_tau_partial, psi5_tau_grad_vel, source_v_1, Density,</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  Pressure = 0.0, div_vel, val_turb_ke, vartheta, vartheta_partial, psi5_p_div_vel, Omega[3], rho_v[3] = {0.0,0.0,0.0},</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <a class="code" href="group__GeometryToolbox.html#ga26f2f767e60f046c51299f6236f84ffe">CrossProduct</a>[3], r, ru, rv, rw, rE, p, T, dp_dr, dp_dru,</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  dp_drv, dp_drw, dp_drE, dH_dr, dH_dru, dH_drv, dH_drw, dH_drE, H, D[3][3], Dd[3], Mach_Inf, eps, scale = 1.0,</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;  RefVel2, RefDensity, Mach2Vel, *Velocity_Inf, factor;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160; </div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;  <span class="keyword">auto</span> *USens = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keyword">auto</span> *UnitNormal = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;  <span class="keyword">auto</span> *normal_grad_vel = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;  <span class="keyword">auto</span> *tang_deriv_psi5 = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;  <span class="keyword">auto</span> *tang_deriv_T = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;  <span class="keyword">auto</span> **Sigma = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160; </div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    Sigma[iDim] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160; </div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;  <span class="keyword">auto</span> *normal_grad_gridvel = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;  <span class="keyword">auto</span> *normal_grad_v_ux =<span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;  <span class="keyword">auto</span> **Sigma_Psi5v = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    Sigma_Psi5v[iDim] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  <span class="keyword">auto</span> **tau = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    tau[iDim] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <span class="keyword">auto</span> *Velocity = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160; </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  <span class="keywordtype">bool</span> rotating_frame    = config-&gt;<a class="code" href="classCConfig.html#ad201abca17f7635b19c11cc11b03b0ac">GetRotating_Frame</a>();</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  <span class="keywordtype">bool</span> grid_movement     = config-&gt;<a class="code" href="classCConfig.html#a9182d3dbb0b3bfa2ebb944f18795f5ca">GetGrid_Movement</a>();</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> RefArea    = config-&gt;<a class="code" href="classCConfig.html#a515e35504ab34bf25d222e377f3b4c81">GetRefArea</a>();</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Mach_Motion     = config-&gt;<a class="code" href="classCConfig.html#a5442ec644c8d291d3e07c158ba5d54a4">GetMach_Motion</a>();</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ObjFunc = config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>();</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Gas_Constant    = config-&gt;<a class="code" href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Cp              = (<a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> / <a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>) * Gas_Constant;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Prandtl_Lam     = config-&gt;<a class="code" href="classCConfig.html#a502035c2b049606186e11e01b7df626a">GetPrandtl_Lam</a>();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160; </div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#ab05a2ea2f4079504565628130bee2ae3">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) scale = 1.0/12.0;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  <span class="keywordflow">else</span> scale = 1.0;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="comment">/*--- Compute non-dimensional factor. For dynamic meshes, use the motion Mach</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;<span class="comment">   number as a reference value for computing the force coefficients.</span></div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;<span class="comment">   Otherwise, use the freestream values,</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="comment">   which is the standard convention. ---*/</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160; </div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    Mach2Vel = <a class="code" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(<a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>*Gas_Constant*config-&gt;<a class="code" href="classCConfig.html#afa49e1ce7793a31cc572d957caffaef9">GetTemperature_FreeStreamND</a>());</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    RefVel2 = (Mach_Motion*Mach2Vel)*(Mach_Motion*Mach2Vel);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;  }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    Velocity_Inf = config-&gt;<a class="code" href="classCConfig.html#ae33781eb89184d511e23b7e247d21c8a">GetVelocity_FreeStreamND</a>();</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    RefVel2 = 0.0;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      RefVel2  += Velocity_Inf[iDim]*Velocity_Inf[iDim];</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  }</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  RefDensity  = config-&gt;<a class="code" href="classCConfig.html#af30dc08c28dd72bfcedc6a5a4e224036">GetDensity_FreeStreamND</a>();</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160; </div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;  factor = 1.0;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">/*-- For multi-objective problems these scaling factors are applied before solution ---*/</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#aad80e2ae9bc0b7b1fed6ccc2b6b2bce0">GetnObj</a>()==1) {</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    factor = 1.0/(0.5*RefDensity*RefArea*RefVel2);</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordflow">if</span> ((ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7">INVERSE_DESIGN_HEATFLUX</a>) ||</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        (ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a">TOTAL_HEATFLUX</a>) || (ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a>) ||</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        (ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa2d1bc11eae99ce594d0a2281210e64d4">SURFACE_MASSFLOW</a>))</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      factor = 1.0;</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">if</span> ((ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa996eee7e64825e2976ea751d9ef2c6c1">SURFACE_TOTAL_PRESSURE</a>) || (ObjFunc == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aae0adda208c6e887373a12474a9e6d9e2">SURFACE_STATIC_PRESSURE</a>))</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      factor = 1.0/<a class="code" href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">Area_Monitored</a>;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;  }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160; </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="comment">/*--- Compute gradient of the grid velocity, if applicable ---*/</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160; </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  <span class="keywordflow">if</span> (grid_movement)</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <a class="code" href="classCSolver.html#a287c7f92e934ae07a3b772c0752142e7">SetGridVel_Gradient</a>(geometry, config);</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160; </div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">Total_Sens_Geo</a> = 0.0;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a> = 0.0;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a> = 0.0;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a> = 0.0;</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  <a class="code" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a> = 0.0;</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160; </div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <a class="code" href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">Sens_Geo</a>[iMarker] = 0.0;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160; </div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">if</span> ((config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a>) ||</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;        (config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a>)) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160; </div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;      <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++) {</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        iPoint = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;        <span class="keywordflow">if</span> (geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160; </div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> PsiVar_Grad = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a07d4f954fe5a79e6f85adab3d462d73c">GetGradient</a>(iPoint);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;          <span class="keyword">const</span> <span class="keyword">auto</span> PrimVar_Grad = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160; </div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;          Laminar_Viscosity = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(iPoint);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160; </div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;          heat_flux_factor = Cp * Laminar_Viscosity / Prandtl_Lam;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          <span class="comment">/*--- Compute face area and the unit normal to the surface ---*/</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;          Normal = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>();</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;          Area = <a class="code" href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a>(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, Normal);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) { UnitNormal[iDim] = Normal[iDim] / Area; }</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;          <span class="comment">/*--- Compute the sensitivity related to the temperature ---*/</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160; </div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;          normal_grad_psi5 = 0.0; normal_grad_T = 0.0;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;            normal_grad_psi5 += PsiVar_Grad[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim]*UnitNormal[iDim];</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            normal_grad_T += PrimVar_Grad[0][iDim]*UnitNormal[iDim];</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;          }</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160; </div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;          temp_sens = 0.0;</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a>) {</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;            <span class="comment">/*--- Heat Flux Term: temp_sens = (\partial_tg \psi_5)\cdot (k \partial_tg T) ---*/</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160; </div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;              tang_deriv_psi5[iDim] = PsiVar_Grad[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim] - normal_grad_psi5*UnitNormal[iDim];</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;              tang_deriv_T[iDim] = PrimVar_Grad[0][iDim] - normal_grad_T*UnitNormal[iDim];</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;            }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;              temp_sens += heat_flux_factor * tang_deriv_psi5[iDim] * tang_deriv_T[iDim];</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160; </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a>) {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            <span class="comment">/*--- Isothermal Term: temp_sens = - k * \partial_n(\psi_5) * \partial_n(T) ---*/</span></div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            temp_sens = - heat_flux_factor * normal_grad_psi5 * normal_grad_T;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;          }</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160; </div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160; </div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;          <span class="comment">/*--- Term: sigma_partial = \Sigma_{ji} n_i \partial_n v_j ---*/</span></div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;          div_phi = 0.0;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            div_phi += PsiVar_Grad[iDim+1][iDim];</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;            <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;              Sigma[iDim][jDim] = Laminar_Viscosity * (PsiVar_Grad[iDim+1][jDim]+PsiVar_Grad[jDim+1][iDim]);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;          }</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            Sigma[iDim][iDim] -= <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Laminar_Viscosity * div_phi;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160; </div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160; </div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;            normal_grad_vel[iDim] = 0.0;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;              normal_grad_vel[iDim] += PrimVar_Grad[iDim+1][jDim]*UnitNormal[jDim];</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;          }</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160; </div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;          sigma_partial = 0.0;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;              sigma_partial += UnitNormal[iDim]*Sigma[iDim][jDim]*normal_grad_vel[jDim];</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;          <span class="comment">/*--- Compute additional terms in the surface sensitivity for</span></div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;<span class="comment">           moving walls in a rotating frame or dynamic mesh problem. ---*/</span></div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160; </div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160; </div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            Psi = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint);</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            U = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            Density = U[0];</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            Pressure = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">GetPressure</a>(iPoint);</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            Enthalpy = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a525636dad6b2064101677df44f274443">GetEnthalpy</a>(iPoint);</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160; </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="comment">/*--- Turbulent kinetic energy ---*/</span></div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="comment">// turb_ke is not considered in the stress tensor, see #797</span></div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            val_turb_ke = 0.0;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <a class="code" href="classCNumerics.html#a18b6238c38e05339954c0bb6121203d1">CNumerics::ComputeStressTensor</a>(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, tau, PrimVar_Grad+1, Laminar_Viscosity, Density, val_turb_ke);</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            <span class="comment">/*--- Form normal_grad_gridvel = \partial_n (u_omega) ---*/</span></div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160; </div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            <span class="keyword">const</span> <span class="keyword">auto</span> GridVel_Grad = geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#a1024c8b8a4b750b16f77465d4060d152">GetGridVel_Grad</a>(iPoint);</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;              normal_grad_gridvel[iDim] = 0.0;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;              <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                normal_grad_gridvel[iDim] += GridVel_Grad[iDim][jDim]*UnitNormal[jDim];</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            }</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="comment">/*--- Form normal_grad_v_ux = \partial_n (v - u_omega) ---*/</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;              normal_grad_v_ux[iDim] = normal_grad_vel[iDim] - normal_grad_gridvel[iDim];</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160; </div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;            <span class="comment">/*--- Form Sigma_Psi5v ---*/</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160; </div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            div_vel = 0.0;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <span class="keywordflow">for</span> (iDim = 0 ; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;              Velocity[iDim] = U[iDim+1]/Density;</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;              div_vel += PrimVar_Grad[iDim+1][iDim];</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;            }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;            gradPsi5_v = 0.0;</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;              gradPsi5_v += PsiVar_Grad[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1][iDim]*Velocity[iDim];</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;              <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                Sigma_Psi5v[iDim][jDim] = Laminar_Viscosity * (PsiVar_Grad[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1][iDim]*Velocity[jDim]+PsiVar_Grad[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1][jDim]*Velocity[iDim]);</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;              Sigma_Psi5v[iDim][iDim] -= <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Laminar_Viscosity * gradPsi5_v;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160; </div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            <span class="comment">/*--- Now compute terms of the surface sensitivity ---*/</span></div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            <span class="comment">/*--- Form vartheta_partial = \vartheta * \partial_n (v - u_x) . n ---*/</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            vartheta = Density*Psi[0] + Density*Enthalpy*Psi[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1];</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;              vartheta += U[iDim+1]*Psi[iDim+1];</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            vartheta_partial = 0.0;</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;              vartheta_partial += vartheta * normal_grad_v_ux[iDim] * UnitNormal[iDim];</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160; </div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            <span class="comment">/*--- Form sigma_partial = n_i ( \Sigma_Phi_{ij} + \Sigma_Psi5v_{ij} ) \partial_n (v - u_x)_j ---*/</span></div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160; </div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            sigma_partial = 0.0;</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;              <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;                sigma_partial += UnitNormal[iDim]*(Sigma[iDim][jDim]+Sigma_Psi5v[iDim][jDim])*normal_grad_v_ux[jDim];</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160; </div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            <span class="comment">/*--- Form psi5_tau_partial = \Psi_5 * \partial_n (v - u_x)_i * tau_{ij} * n_j ---*/</span></div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160; </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;            psi5_tau_partial = 0.0;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;              <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                psi5_tau_partial -= Psi[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*normal_grad_v_ux[iDim]*tau[iDim][jDim]*UnitNormal[jDim];</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160; </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;            <span class="comment">/*--- Form psi5_p_div_vel = ---*/</span></div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160; </div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;            psi5_p_div_vel = -Psi[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*Pressure*div_vel;</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160; </div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="comment">/*--- Form psi5_tau_grad_vel = \Psi_5 * tau_{ij} : \nabla( v ) ---*/</span></div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160; </div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            psi5_tau_grad_vel = 0.0;</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;              <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                psi5_tau_grad_vel += Psi[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*tau[iDim][jDim]*PrimVar_Grad[iDim+1][jDim];</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="comment">/*--- Retrieve the angular velocity vector ---*/</span></div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;            source_v_1 = 0.0;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            <span class="keywordflow">if</span> (rotating_frame) {</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160; </div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;              <span class="keywordflow">for</span> (iDim = 0; iDim &lt; 3; iDim++){</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;                Omega[iDim] = config-&gt;<a class="code" href="classCConfig.html#a3f9890ff8ca2b98646e4ebf3de8c9c13">GetRotation_Rate</a>(iDim)/config-&gt;<a class="code" href="classCConfig.html#ab3ab2f06b6d038aea73beed05cd13448">GetOmega_Ref</a>();</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;              }</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;              <span class="comment">/*--- Calculate momentum source terms as: rho * ( Omega X V ) ---*/</span></div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;              <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                rho_v[iDim] = U[iDim+1];</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;              <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) rho_v[2] = 0.0;</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160; </div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;              <a class="code" href="group__GeometryToolbox.html#ga26f2f767e60f046c51299f6236f84ffe">CrossProduct</a>[0] = Omega[1]*rho_v[2] - Omega[2]*rho_v[1];</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;              <a class="code" href="group__GeometryToolbox.html#ga26f2f767e60f046c51299f6236f84ffe">CrossProduct</a>[1] = Omega[2]*rho_v[0] - Omega[0]*rho_v[2];</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;              <a class="code" href="group__GeometryToolbox.html#ga26f2f767e60f046c51299f6236f84ffe">CrossProduct</a>[2] = Omega[0]*rho_v[1] - Omega[1]*rho_v[0];</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160; </div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160; </div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;              <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;                source_v_1 += Psi[iDim+1]*<a class="code" href="group__GeometryToolbox.html#ga26f2f767e60f046c51299f6236f84ffe">CrossProduct</a>[iDim];</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;              }</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            }</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <span class="comment">/*--- For simplicity, store all additional terms within sigma_partial ---*/</span></div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160; </div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            sigma_partial = sigma_partial + vartheta_partial + psi5_tau_partial + psi5_p_div_vel + psi5_tau_grad_vel + source_v_1;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160; </div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;          <span class="comment">/*--- Compute sensitivity for each surface point ---*/</span></div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;          <a class="code" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a>[iMarker][iVertex] = (sigma_partial - temp_sens) * Area * scale * factor;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <span class="comment">/*--- If sharp edge, set the sensitivity to 0 on that region ---*/</span></div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;          <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#ab33081c547f43eb27cc54852d4629dd3">GetSens_Remove_Sharp</a>()) {</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            eps = config-&gt;<a class="code" href="classCConfig.html#a3bd1de6bcb6cd7062816341b0d956459">GetVenkat_LimiterCoeff</a>()*config-&gt;<a class="code" href="classCConfig.html#a7c7b4b489dcb3b505c091de0ae300891">GetRefElemLength</a>();</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;            <span class="keywordflow">if</span> ( geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#a8610d0fe0bf651b7036be5b3a6e1c130">GetSharpEdge_Distance</a>(iPoint) &lt; config-&gt;<a class="code" href="classCConfig.html#ac421daafab2ffc8171aba0a05ce017ab">GetAdjSharp_LimiterCoeff</a>()*eps )</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;              <a class="code" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a>[iMarker][iVertex] = 0.0;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;          <a class="code" href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">Sens_Geo</a>[iMarker] -= <a class="code" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a>[iMarker][iVertex];</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        }</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;      }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">Total_Sens_Geo</a> += <a class="code" href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">Sens_Geo</a>[iMarker];</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;    }</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  }</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160; </div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  <span class="comment">/*--- Farfield Sensitivity (Mach, AoA, Press, Temp), only for compressible flows ---*/</span></div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba2017081e4aa73a6aef6fdd6b3a380fbf">FAR_FIELD</a> || config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba6dc1b159829aa7885fc905d3d81f28bd">INLET_FLOW</a> ||</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba8e57aa6eae14b4e84e2ebd0be0d385fb">SUPERSONIC_INLET</a> || config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820bacaed259788fb153495d0901f31e529bf">SUPERSONIC_OUTLET</a> ||</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;        config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba938badc8671d389b99bd9ae9eb6cfa73">ENGINE_INFLOW</a>  ) {</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160; </div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker]  = 0.0;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker]   = 0.0;</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] = 0.0;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker]  = 0.0;</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a3f9e8576dc150e551bd19a64b1d43977">Sens_BPress</a>[iMarker] = 0.0;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160; </div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++) {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        iPoint = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="keywordflow">if</span> (geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;          Psi = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint);</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;          U = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint);</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          Normal = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>();</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          Mach_Inf   = config-&gt;<a class="code" href="classCConfig.html#a5a078901bb388e9caa9cb856e3348f0b">GetMach</a>();</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;          <span class="keywordflow">if</span> (grid_movement) Mach_Inf = config-&gt;<a class="code" href="classCConfig.html#a5442ec644c8d291d3e07c158ba5d54a4">GetMach_Motion</a>();</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          r = U[0]; ru = U[1]; rv = U[2];</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { rw = 0.0; rE = U[3]; }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;          <span class="keywordflow">else</span> { rw = U[3]; rE = U[4]; }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;          p = <a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*(rE-(ru*ru + rv*rv + rw*rw)/(2*r));</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;          Area = <a class="code" href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a>(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, Normal);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) UnitNormal[iDim] = -Normal[iDim]/Area;</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160; </div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;          H = (rE + p)/r;</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;          dp_dr = <a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*(ru*ru + rv*rv + rw*rw)/(2*r*r);</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;          dp_dru = -<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*ru/r;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;          dp_drv = -<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*rv/r;</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { dp_drw = 0.0; dp_drE = <a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>; }</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;          <span class="keywordflow">else</span> { dp_drw = -<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*rw/r; dp_drE = <a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>; }</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160; </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;          dH_dr = (-H + dp_dr)/r; dH_dru = dp_dru/r; dH_drv = dp_drv/r;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { dH_drw = 0.0; dH_drE = (1 + dp_drE)/r; }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;          <span class="keywordflow">else</span> { dH_drw = dp_drw/r; dH_drE = (1 + dp_drE)/r; }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][0] = 0.0;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][0] = Area*UnitNormal[0];</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][0] = Area*UnitNormal[1];</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][0] = 0.0;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160; </div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][1] = (-(ru*ru)/(r*r) + dp_dr)*Area*UnitNormal[0] + (-(ru*rv)/(r*r))*Area*UnitNormal[1];</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][1] = (2*ru/r + dp_dru)*Area*UnitNormal[0] + (rv/r)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][1] = (dp_drv)*Area*UnitNormal[0] + (ru/r)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][1] = (dp_drE)*Area*UnitNormal[0];</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][2] = (-(ru*rv)/(r*r))*Area*UnitNormal[0] + (-(rv*rv)/(r*r) + dp_dr)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][2] = (rv/r)*Area*UnitNormal[0] + (dp_dru)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][2] = (ru/r)*Area*UnitNormal[0] + (2*rv/r + dp_drv)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][2] = (dp_drE)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160; </div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][3] = (ru*dH_dr)*Area*UnitNormal[0] + (rv*dH_dr)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][3] = (H + ru*dH_dru)*Area*UnitNormal[0] + (rv*dH_dru)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][3] = (ru*dH_drv)*Area*UnitNormal[0] + (H + rv*dH_drv)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][3] = (ru*dH_drE)*Area*UnitNormal[0] + (rv*dH_drE)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;          }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][0] = 0.0;</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][0] = Area*UnitNormal[0];</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][0] = Area*UnitNormal[1];</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][0] = Area*UnitNormal[2];</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[4][0] = 0.0;</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][1] = (-(ru*ru)/(r*r) + dp_dr)*Area*UnitNormal[0] + (-(ru*rv)/(r*r))*Area*UnitNormal[1] + (-(ru*rw)/(r*r))*Area*UnitNormal[2];</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][1] = (2*ru/r + dp_dru)*Area*UnitNormal[0] + (rv/r)*Area*UnitNormal[1] + (rw/r)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][1] = (dp_drv)*Area*UnitNormal[0] + (ru/r)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][1] = (dp_drw)*Area*UnitNormal[0] + (ru/r)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[4][1] = (dp_drE)*Area*UnitNormal[0];</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][2] = (-(ru*rv)/(r*r))*Area*UnitNormal[0] + (-(rv*rv)/(r*r) + dp_dr)*Area*UnitNormal[1] + (-(rv*rw)/(r*r))*Area*UnitNormal[2];</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][2] = (rv/r)*Area*UnitNormal[0] + (dp_dru)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][2] = (ru/r)*Area*UnitNormal[0] + (2*rv/r + dp_drv)*Area*UnitNormal[1] + (rw/r)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][2] = (dp_drw)*Area*UnitNormal[1] + (rv/r)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[4][2] = (dp_drE)*Area*UnitNormal[1];</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160; </div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][3] = (-(ru*rw)/(r*r))*Area*UnitNormal[0] + (-(rv*rw)/(r*r))*Area*UnitNormal[1] + (-(rw*rw)/(r*r) + dp_dr)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][3] = (rw/r)*Area*UnitNormal[0] + (dp_dru)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][3] = (rw/r)*Area*UnitNormal[1] + (dp_drv)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][3] = (ru/r)*Area*UnitNormal[0] + (rv/r)*Area*UnitNormal[1] + (2*rw/r + dp_drw)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[4][3] = (dp_drE)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][4] = (ru*dH_dr)*Area*UnitNormal[0] + (rv*dH_dr)*Area*UnitNormal[1] + (rw*dH_dr)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][4] = (H + ru*dH_dru)*Area*UnitNormal[0] + (rv*dH_dru)*Area*UnitNormal[1] + (rw*dH_dru)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][4] = (ru*dH_drv)*Area*UnitNormal[0] + (H + rv*dH_drv)*Area*UnitNormal[1] + (rw*dH_drv)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][4] = (ru*dH_drw)*Area*UnitNormal[0] + (rv*dH_drw)*Area*UnitNormal[1] + (H + rw*dH_drw)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            <a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[4][4] = (ru*dH_drE)*Area*UnitNormal[0] + (rv*dH_drE)*Area*UnitNormal[1] + (rw*dH_drE)*Area*UnitNormal[2];</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;          }</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160; </div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;          <span class="comment">/*--- Mach number sensitivity ---*/</span></div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;          USens[0] = 0.0; USens[1] = ru/Mach_Inf; USens[2] = rv/Mach_Inf;</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { USens[3] = <a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>*Mach_Inf*p; }</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;          <span class="keywordflow">else</span> { USens[3] = rw/Mach_Inf; USens[4] = <a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>*Mach_Inf*p; }</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iPos++) {</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;            <span class="keywordflow">for</span> (jPos = 0; jPos &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jPos++) {</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;              <a class="code" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker] += Psi[iPos]*<a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[jPos][iPos]*USens[jPos];</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            }</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;          }</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160; </div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;          <span class="comment">/*--- AoA sensitivity ---*/</span></div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;          USens[0] = 0.0;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { USens[1] = -rv; USens[2] = ru; USens[3] = 0.0; }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;          <span class="keywordflow">else</span> { USens[1] = -rw; USens[2] = 0.0; USens[3] = ru; USens[4] = 0.0; }</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iPos++) {</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;            <span class="keywordflow">for</span> (jPos = 0; jPos &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jPos++) {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;              <a class="code" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker] += Psi[iPos]*<a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[jPos][iPos]*USens[jPos];</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;            }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;          }</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160; </div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;          <span class="comment">/*--- Pressure sensitivity ---*/</span></div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160; </div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;          USens[0] = r/p; USens[1] = ru/p; USens[2] = rv/p;</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { USens[3] = rE/p; }</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;          <span class="keywordflow">else</span> { USens[3] = rw/p; USens[4] = rE/p; }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iPos++) {</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;            <span class="keywordflow">for</span> (jPos = 0; jPos &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jPos++) {</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;              <a class="code" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] += Psi[iPos]*<a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[jPos][iPos]*USens[jPos];</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;            }</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;          }</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;          <span class="comment">/*--- Temperature sensitivity ---*/</span></div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;          T = p/(r*Gas_Constant);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;          USens[0] = -r/T; USens[1] = 0.5*ru/T; USens[2] = 0.5*rv/T;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { USens[3] = (ru*ru + rv*rv + rw*rw)/(r*T); }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;          <span class="keywordflow">else</span> { USens[3] = 0.5*rw/T; USens[4] = (ru*ru + rv*rv + rw*rw)/(r*T); }</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iPos++) {</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;            <span class="keywordflow">for</span> (jPos = 0; jPos &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jPos++) {</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;              <a class="code" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker] += Psi[iPos]*<a class="code" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[jPos][iPos]*USens[jPos];</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;            }</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;          }</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;        }</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;      }</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a>  -= <a class="code" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker] * scale * factor;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a>   -= <a class="code" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker] * scale * factor;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a> -= <a class="code" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] * scale * factor;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a>  -= <a class="code" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker] * scale * factor;</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    }</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160; </div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;  }</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160; </div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;  <span class="comment">/*--- Explicit contribution from objective function quantity ---*/</span></div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <span class="keywordflow">if</span> ((config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a>) ||</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;        (config-&gt;<a class="code" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a>)) {</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160; </div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker]  = 0.0;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker]   = 0.0;</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] = 0.0;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker]  = 0.0;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a3f9e8576dc150e551bd19a64b1d43977">Sens_BPress</a>[iMarker] = 0.0;</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++) {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        iPoint = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160; </div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;        <span class="keywordflow">if</span> (geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;          Normal = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>();</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;          p = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">GetPressure</a>(iPoint);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160; </div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;          Mach_Inf   = config-&gt;<a class="code" href="classCConfig.html#a5a078901bb388e9caa9cb856e3348f0b">GetMach</a>();</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;          <span class="keywordflow">if</span> (grid_movement) Mach_Inf = config-&gt;<a class="code" href="classCConfig.html#a5442ec644c8d291d3e07c158ba5d54a4">GetMach_Motion</a>();</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;          d = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCAdjEulerVariable.html#a79bc01240b870051482bdffaabc863f9">GetForceProj_Vector</a>(iPoint);</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;          Area = <a class="code" href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a>(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, Normal);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) UnitNormal[iDim] = -Normal[iDim]/Area;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          <span class="comment">/*--- Mach number sensitivity ---*/</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160; </div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) Dd[iPos] = -(2.0/Mach_Inf)*d[iPos];</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) <a class="code" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker] += p*Dd[iPos]*Area*UnitNormal[iPos];</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;          <span class="comment">/*--- AoA sensitivity ---*/</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160; </div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;          <span class="keywordflow">if</span> (config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa8f80a9cba152af34bddb134a95f70e67">DRAG_COEFFICIENT</a> ||</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;              config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa74469d47da8b77e6328e3661964307d8">LIFT_COEFFICIENT</a> ||</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;              config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa6dbcda3aa9205f9255ff777ea28510b1">SIDEFORCE_COEFFICIENT</a> ||</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;              config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aac8b258aaf52323223d470403a2ff10b0">EQUIVALENT_AREA</a> ||</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;              config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa986b33b640b206199e379e5a22fc2278">NEARFIELD_PRESSURE</a>) {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;              D[0][0] = 0.0; D[0][1] = -1.0;</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;              D[1][0] = 1.0; D[1][1] = 0.0;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;            }</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;              D[0][0] = 0.0; D[0][1] = 0.0; D[0][2] = -1.0;</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;              D[1][0] = 0.0; D[1][1] = 0.0; D[1][2] = 0.0;</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;              D[2][0] = 1.0; D[2][1] = 0.0; D[2][2] = 0.0;</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;            }</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;            <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) Dd[iPos] = 0.0;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) {</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;              <span class="keywordflow">for</span> (jPos = 0; jPos &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jPos++)</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                Dd[iPos] += D[iPos][jPos]*d[jPos];</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;            }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;          }</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;          <span class="comment">/*--- Coefficients with no explicit AoA dependece ---*/</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;          <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;            <span class="keywordflow">for</span> (iPos = 0; iPos&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) Dd[iPos] = 0.0;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;          }</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160; </div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++)</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;            <a class="code" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker] += p*Dd[iPos]*Area*UnitNormal[iPos];</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;          <span class="comment">/*--- Pressure sensitivity ---*/</span></div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160; </div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;          <span class="keywordflow">for</span> (iPos = 0; iPos&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) Dd[iPos] = -(1/p)*d[iPos];</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;          <span class="keywordflow">for</span> (iPos = 0; iPos&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++)</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;            <a class="code" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] += p*Dd[iPos]*Area*UnitNormal[iPos];</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160; </div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;          <span class="comment">/*--- Temperature sensitivity ---*/</span></div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160; </div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;          <span class="keywordflow">for</span> (iPos = 0; iPos&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) Dd[iPos] = 0.0;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;          <span class="keywordflow">for</span> (iPos = 0; iPos&lt;<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++)</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;            <a class="code" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker] += p*Dd[iPos]*Area*UnitNormal[iPos];</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160; </div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        }</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      }</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160; </div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a>  += <a class="code" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker] * scale * factor;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a>   += <a class="code" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker] * scale * factor;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a> += <a class="code" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] * scale * factor;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a>  += <a class="code" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker] * scale * factor;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160; </div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;    }</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;  }</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160; </div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160; </div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160; </div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> MyTotal_Sens_Geo   = <a class="code" href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">Total_Sens_Geo</a>;     <a class="code" href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">Total_Sens_Geo</a> = 0.0;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> MyTotal_Sens_Mach  = <a class="code" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a>;    <a class="code" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a> = 0.0;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> MyTotal_Sens_AoA   = <a class="code" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a>;     <a class="code" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a> = 0.0;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> MyTotal_Sens_Press = <a class="code" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a>;   <a class="code" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a> = 0.0;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> MyTotal_Sens_Temp  = <a class="code" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a>;    <a class="code" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a> = 0.0;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <a class="code" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyTotal_Sens_Geo, &amp;<a class="code" href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">Total_Sens_Geo</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;  <a class="code" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyTotal_Sens_Mach, &amp;<a class="code" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;  <a class="code" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyTotal_Sens_AoA, &amp;<a class="code" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;  <a class="code" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyTotal_Sens_Press, &amp;<a class="code" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;  <a class="code" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyTotal_Sens_Temp, &amp;<a class="code" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160; </div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160; </div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;  <span class="keyword">delete</span> [] USens;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <span class="keyword">delete</span> [] UnitNormal;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <span class="keyword">delete</span> [] normal_grad_vel;</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <span class="keyword">delete</span> [] tang_deriv_psi5;</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <span class="keyword">delete</span> [] tang_deriv_T;</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;    <span class="keyword">delete</span> [] Sigma[iDim];</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;  <span class="keyword">delete</span> [] Sigma;</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <span class="keyword">delete</span> [] normal_grad_gridvel;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <span class="keyword">delete</span> [] normal_grad_v_ux;</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <span class="keyword">delete</span> [] Sigma_Psi5v[iDim];</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <span class="keyword">delete</span> [] Sigma_Psi5v;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keyword">delete</span> [] tau[iDim];</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keyword">delete</span> [] tau;</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keyword">delete</span> [] Velocity;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160; </div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;}</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#aac064a699355df483ca48c40e7c50675"> 1167</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCAdjNSSolver.html#aac064a699355df483ca48c40e7c50675">CAdjNSSolver::BC_HeatFlux_Wall</a>(<a class="code" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code" href="classCSolver.html">CSolver</a> **solver_container, <a class="code" href="classCNumerics.html">CNumerics</a> *conv_numerics, <a class="code" href="classCNumerics.html">CNumerics</a> *visc_numerics, <a class="code" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> val_marker) {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160; </div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim, iVar, jVar, jDim;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iVertex, iPoint, total_index, Point_Normal;</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160; </div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *d, l1psi, vartheta, Sigma_5, phi[3] = {};</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> sq_vel, ProjGridVel, Enthalpy = 0.0, *GridVel;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscDens, XiDens, Density, Pressure = 0.0, dPhiE_dn;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Laminar_Viscosity = 0.0, Eddy_Viscosity = 0.0;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Sigma_xx, Sigma_yy, Sigma_zz, Sigma_xy, Sigma_xz, Sigma_yz;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Sigma_xx5, Sigma_yy5, Sigma_zz5, Sigma_xy5, Sigma_xz5;</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Sigma_yz5, eta_xx, eta_yy, eta_zz, eta_xy, eta_xz, eta_yz;</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *Coord_i, *Coord_j, dist_ij_2;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dSigmaxx_phi1, dSigmayy_phi1, dSigmazz_phi1, dSigmaxy_phi1, dSigmaxz_phi1, dSigmayz_phi1;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dSigmaxx_phi2, dSigmayy_phi2, dSigmazz_phi2, dSigmaxy_phi2, dSigmaxz_phi2, dSigmayz_phi2;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dSigmaxx_phi3, dSigmayy_phi3, dSigmazz_phi3, dSigmaxy_phi3, dSigmaxz_phi3, dSigmayz_phi3;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dSigma5_psi5;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160; </div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;  <span class="keywordtype">bool</span> implicit = (config-&gt;<a class="code" href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">GetKind_TimeIntScheme</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>);</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;  <span class="keywordtype">bool</span> grid_movement  = config-&gt;<a class="code" href="classCConfig.html#a9182d3dbb0b3bfa2ebb944f18795f5ca">GetGrid_Movement</a>();</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Prandtl_Lam  = config-&gt;<a class="code" href="classCConfig.html#a502035c2b049606186e11e01b7df626a">GetPrandtl_Lam</a>();</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Prandtl_Turb = config-&gt;<a class="code" href="classCConfig.html#a4b89ad15fa82f93ca8ccfe945e2c14a7">GetPrandtl_Turb</a>();</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160; </div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  <span class="keyword">auto</span> *Psi = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="keyword">auto</span> **Tau = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    Tau[iDim] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;  <span class="keyword">auto</span> *Velocity = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <span class="keyword">auto</span> *Normal = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;  <span class="keyword">auto</span> *Edge_Vector = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <span class="keyword">auto</span> **GradPhi = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    GradPhi[iDim] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <span class="keyword">auto</span> *GradPsiE = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <span class="comment">/*--- Loop over all of the vertices on this boundary marker ---*/</span></div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160; </div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[val_marker]; iVertex++) {</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    iPoint = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="comment">/*--- Check if the node belongs to the domain (i.e, not a halo node) ---*/</span></div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordflow">if</span> (geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160; </div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      <span class="comment">/*--- Normal vector for this vertex (negate for outward convention) ---*/</span></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160; </div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>(Normal);</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) Normal[iDim] = -Normal[iDim];</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160; </div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      <span class="comment">/*--- Initialize the convective &amp; viscous residuals to zero ---*/</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;      <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;        <a class="code" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[iVar] = 0.0; <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[iVar] = 0.0;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <span class="keywordflow">if</span> (implicit) { <span class="keywordflow">for</span> (jVar = 0; jVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jVar ++) <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[iVar][jVar] = 0.0; }</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;      <span class="comment">/*--- Retrieve adjoint solution at the wall boundary node ---*/</span></div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++)</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        Psi[iVar] = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint,iVar);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="comment">/*--- Get the force projection vector (based on the objective function) ---*/</span></div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      d = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCAdjEulerVariable.html#a79bc01240b870051482bdffaabc863f9">GetForceProj_Vector</a>(iPoint);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160; </div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="comment">/*--- Set the adjoint velocity BC ---*/</span></div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) { phi[iDim] = d[iDim]; }</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <span class="comment">/*--- Correct the adjoint velocity BC for dynamic meshes ---*/</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        GridVel = geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#a65d855a9c2ad2971546038b34acd5b92">GetGridVel</a>(iPoint);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;          phi[iDim] -= Psi[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*GridVel[iDim];</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <span class="comment">/*--- Impose the value of the adjoint velocity as a strong boundary</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;<span class="comment">       condition (Dirichlet). Fix the adjoint velocity and remove any addtional</span></div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;<span class="comment">       contribution to the residual at this node. ---*/</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a6ee4d8d450971204cc054a33d6473732">SetSolution_Old</a>(iPoint,iDim+1, phi[iDim]);</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160; </div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>(iPoint, iDim+1) = 0.0;</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCAdjEulerVariable.html#a14a7a77262dfba287156315a5142e923">SetVel_ResTruncError_Zero</a>(iPoint);</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160; </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      <span class="comment">/*--- Compute additional contributions to the adjoint density and energy</span></div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;<span class="comment">       equations which will be added to the residual (weak imposition) ---*/</span></div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="comment">/*--- Energy residual due to the convective term ---*/</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      l1psi = 0.0;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;        l1psi += Normal[iDim]*d[iDim];</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;      <a class="code" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = l1psi*<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>;</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      <span class="comment">/*--- Flux contribution and Jacobian contributions for moving</span></div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;<span class="comment">         walls. Note that these are only for the adjoint density and</span></div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;<span class="comment">         adjoint energy equations (the adjoint vel. uses a strong BC). ---*/</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="comment">/*--- Get the grid velocity at this node and impose v = u_wall ---*/</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160; </div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        GridVel = geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#a65d855a9c2ad2971546038b34acd5b92">GetGridVel</a>(iPoint);</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) Velocity[iDim] = GridVel[iDim];</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160; </div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="comment">/*--- Get some additional quantities from the flow solution ---*/</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        Density = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a4892ca545884011b7903a8e35c43b43f">GetDensity</a>(iPoint);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        Pressure = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">GetPressure</a>(iPoint);</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        Enthalpy = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a525636dad6b2064101677df44f274443">GetEnthalpy</a>(iPoint);</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        Laminar_Viscosity = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(iPoint);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        Eddy_Viscosity = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#adae2e4228e113624b7ab1f9ab1a493c6">GetEddyViscosity</a>(iPoint); <span class="comment">// Should be zero at the wall</span></div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        ViscDens = (Laminar_Viscosity + Eddy_Viscosity) / Density;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        XiDens = <a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> * (Laminar_Viscosity/Prandtl_Lam + Eddy_Viscosity/Prandtl_Turb) / Density;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160; </div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        <span class="comment">/*--- Compute projections, velocity squared divided by two, and</span></div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;<span class="comment">           other inner products. Note that we are imposing v = u_wall from</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;<span class="comment">           the direct problem and that phi = d - \psi_5 * v ---*/</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        ProjGridVel = 0.0; sq_vel = 0.0;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        vartheta = Psi[0] + Psi[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*Enthalpy;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;          ProjGridVel += GridVel[iDim]*Normal[iDim];</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;          sq_vel      += 0.5*GridVel[iDim]*GridVel[iDim];</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;          vartheta    += GridVel[iDim]*phi[iDim];</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        }</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        <span class="comment">/*--- Convective flux at the wall node (adjoint density) ---*/</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <a class="code" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[0] = -vartheta*ProjGridVel + l1psi*<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*sq_vel;</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160; </div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;        <span class="comment">/*--- Implicit contributions from convective part ---*/</span></div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;        <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;          <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][0] += -ProjGridVel;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;          <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] += -ProjGridVel * Enthalpy;</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        }</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="comment">/*--- Viscous flux contributions at the wall node. Impose dPhiE_dn = 0</span></div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;<span class="comment">           (adiabatic walls with frozen viscosity). ---*/</span></div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160; </div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        dPhiE_dn = 0.0;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160; </div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <span class="comment">/*--- Store the adjoint velocity and energy gradients for clarity ---*/</span></div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160; </div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;        <span class="keyword">const</span> <span class="keyword">auto</span> PsiVar_Grad = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a07d4f954fe5a79e6f85adab3d462d73c">GetGradient</a>(iPoint);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;          GradPsiE[iDim] =  PsiVar_Grad[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim];</div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;          <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;            GradPhi[iDim][jDim] =  PsiVar_Grad[iDim+1][jDim];</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;        }</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160; </div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;          <span class="comment">/*--- Compute the adjoint stress tensor ---*/</span></div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;          Sigma_xx  = ViscDens * (<a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[0][0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1]);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;          Sigma_yy  = ViscDens * (-<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[1][1]);</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;          Sigma_xy  = ViscDens * (GradPhi[1][0] + GradPhi[0][1]);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;          Sigma_xx5 = ViscDens * ( <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[0] * GradPsiE[0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1]);</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;          Sigma_yy5 = ViscDens * (- <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[1] * GradPsiE[1]);</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;          Sigma_xy5 = ViscDens * (Velocity[0] * GradPsiE[1] + Velocity[1] * GradPsiE[0]);</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;          Sigma_5   = XiDens * dPhiE_dn;</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;          eta_xx    = Sigma_xx + Sigma_xx5;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;          eta_yy    = Sigma_yy + Sigma_yy5;</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;          eta_xy    = Sigma_xy + Sigma_xy5;</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160; </div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;          <span class="comment">/*--- Viscous flux at the wall node (adjoint density &amp; energy only) ---*/</span></div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160; </div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;          <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[0] = - (Velocity[0] * Normal[0] * eta_xx  + Velocity[1] * Normal[1] * eta_yy</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;              + (Velocity[0] * Normal[1] + Velocity[1] * Normal[0]) * eta_xy</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;              - (sq_vel - Pressure/(Density*<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * Sigma_5);</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;          <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = Sigma_5;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160; </div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;          <span class="comment">/*--- Computation of the Jacobians at Point i---*/</span></div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160; </div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;          <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160; </div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            <span class="comment">/*--- Compute closest normal neighbor ---*/</span></div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;            Point_Normal = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code" href="classCVertex.html#ab8b0e96f9384b0a861c7a70616976b75">GetNormal_Neighbor</a>();</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160; </div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            <span class="comment">/*--- Get coordinates of i &amp; nearest normal and compute distance ---*/</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160; </div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            Coord_i = geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(iPoint);</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;            Coord_j = geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(Point_Normal);</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            dist_ij_2 = 0.0;</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;              Edge_Vector[iDim] = Coord_j[iDim]-Coord_i[iDim];</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;              dist_ij_2 += Edge_Vector[iDim]*Edge_Vector[iDim];</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            }</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160; </div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            dSigmaxx_phi1 = -<a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            dSigmaxx_phi2 =   <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            dSigmayy_phi1 =   <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;            dSigmayy_phi2 = -<a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            dSigmaxy_phi1 = -ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;            dSigmaxy_phi2 = -ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; </div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;            <span class="comment">//              dSigmaxx5_psi5 = -ViscDens * ( FOUR3*Velocity[0]*Edge_Vector[0] -  TWO3*Velocity[1]*Edge_Vector[1] )/dist_ij_2;</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            <span class="comment">//              dSigmayy5_psi5 = -ViscDens * (- TWO3*Velocity[0]*Edge_Vector[0] + FOUR3*Velocity[1]*Edge_Vector[1] )/dist_ij_2;</span></div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;            <span class="comment">//              dSigmaxy5_psi5 = -ViscDens * ( Velocity[0]*Edge_Vector[1] + Velocity[1]*Edge_Vector[0] )/dist_ij_2;</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;            dSigma5_psi5   = -XiDens * ( Edge_Vector[0]*Normal[0] + Edge_Vector[1]*Normal[1] )/dist_ij_2;</div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160; </div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][0] += 0.0;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][1] += -( Velocity[0]*Normal[0]*dSigmaxx_phi1 + Velocity[1]*Normal[1]*dSigmayy_phi1</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;                + (Velocity[0]*Normal[1] + Velocity[1]*Normal[0])*dSigmaxy_phi1 );</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][2] += -( Velocity[0]*Normal[0]*dSigmaxx_phi2 + Velocity[1]*Normal[1]*dSigmayy_phi2</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;                + (Velocity[0]*Normal[1] + Velocity[1]*Normal[0])*dSigmaxy_phi2 );</div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][3] += (sq_vel - Pressure/(Density*<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * dSigma5_psi5;</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[3][0] += 0.0;</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[3][1] += 0.0;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[3][2] += 0.0;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[3][3] += dSigma5_psi5;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;          }</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160; </div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160; </div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) {</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160; </div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;          <span class="comment">/*--- Compute the adjoint stress tensor ---*/</span></div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;          Sigma_xx  = ViscDens * (<a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[0][0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1] - <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>  * GradPhi[2][2]);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;          Sigma_yy  = ViscDens * (-<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[1][1] - <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>  * GradPhi[2][2]);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;          Sigma_zz  = ViscDens * (-<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[2][2]);</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;          Sigma_xy  = ViscDens * (GradPhi[1][0] + GradPhi[0][1]);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;          Sigma_xz  = ViscDens * (GradPhi[2][0] + GradPhi[0][2]);</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;          Sigma_yz  = ViscDens * (GradPhi[2][1] + GradPhi[1][2]);</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;          Sigma_xx5 = ViscDens * ( <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[0] * GradPsiE[0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;          Sigma_yy5 = ViscDens * (- <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[1] * GradPsiE[1] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;          Sigma_zz5 = ViscDens * (- <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;          Sigma_xy5 = ViscDens * (Velocity[0] * GradPsiE[1] + Velocity[1] * GradPsiE[0]);</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;          Sigma_xz5 = ViscDens * (Velocity[0] * GradPsiE[2] + Velocity[2] * GradPsiE[0]);</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;          Sigma_yz5 = ViscDens * (Velocity[1] * GradPsiE[2] + Velocity[2] * GradPsiE[1]);</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;          Sigma_5   = XiDens * dPhiE_dn;</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;          eta_xx    = Sigma_xx + Sigma_xx5; eta_yy = Sigma_yy + Sigma_yy5; eta_zz = Sigma_zz + Sigma_zz5;</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;          eta_xy    = Sigma_xy + Sigma_xy5; eta_xz = Sigma_xz + Sigma_xz5; eta_yz = Sigma_yz + Sigma_yz5;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160; </div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;          <span class="comment">/*--- Viscous flux at the wall node (adjoint density &amp; energy only) ---*/</span></div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;          <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[0] = - (Velocity[0] * Normal[0] * eta_xx  + Velocity[1] * Normal[1] * eta_yy + Velocity[2] * Normal[2] * eta_zz</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;              + (Velocity[0] * Normal[1] + Velocity[1] * Normal[0]) * eta_xy</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;              + (Velocity[0] * Normal[2] + Velocity[2] * Normal[0]) * eta_xz</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;              + (Velocity[2] * Normal[1] + Velocity[1] * Normal[2]) * eta_yz</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;              - (sq_vel - Pressure/(Density*<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * Sigma_5);</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;          <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = Sigma_5;</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160; </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;          <span class="comment">/*--- Computation of the Jacobians at Point i---*/</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;          <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160; </div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;            <span class="comment">/*--- Compute closest normal neighbor ---*/</span></div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;            Point_Normal = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code" href="classCVertex.html#ab8b0e96f9384b0a861c7a70616976b75">GetNormal_Neighbor</a>();</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160; </div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;            <span class="comment">/*--- Get coordinates of i &amp; nearest normal and compute distance ---*/</span></div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;            Coord_i = geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(iPoint);</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;            Coord_j = geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(Point_Normal);</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;            dist_ij_2 = 0.0;</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;              Edge_Vector[iDim] = Coord_j[iDim]-Coord_i[iDim];</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;              dist_ij_2 += Edge_Vector[iDim]*Edge_Vector[iDim];</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;            }</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160; </div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;            dSigmaxx_phi1 = -<a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;            dSigmaxx_phi2 =   <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;            dSigmaxx_phi3 =   <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[2]/dist_ij_2;</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;            dSigmayy_phi1 =   <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            dSigmayy_phi2 = -<a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;            dSigmayy_phi3 =   <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[2]/dist_ij_2;</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;            dSigmazz_phi1 =   <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;            dSigmazz_phi2 =   <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;            dSigmazz_phi3 = -<a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * ViscDens * Edge_Vector[2]/dist_ij_2;</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;            dSigmaxy_phi1 = -ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;            dSigmaxy_phi2 = -ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;            dSigmaxy_phi3 = 0;</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;            dSigmaxz_phi1 = -ViscDens * Edge_Vector[2]/dist_ij_2;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;            dSigmaxz_phi2 = 0;</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;            dSigmaxz_phi3 = -ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;            dSigmayz_phi1 = 0;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;            dSigmayz_phi2 = -ViscDens * Edge_Vector[2]/dist_ij_2;</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;            dSigmayz_phi3 = -ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160; </div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;            <span class="comment">//              dSigmaxx5_psi5 = -ViscDens * ( FOUR3*Velocity[0]*Edge_Vector[0] -  TWO3*Velocity[1]*Edge_Vector[1] -  TWO3*Velocity[2]*Edge_Vector[2])/dist_ij_2;</span></div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;            <span class="comment">//              dSigmayy5_psi5 = -ViscDens * (- TWO3*Velocity[0]*Edge_Vector[0] + FOUR3*Velocity[1]*Edge_Vector[1] -  TWO3*Velocity[2]*Edge_Vector[2])/dist_ij_2;</span></div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;            <span class="comment">//              dSigmazz5_psi5 = -ViscDens * (- TWO3*Velocity[0]*Edge_Vector[0] -  TWO3*Velocity[1]*Edge_Vector[1] + FOUR3*Velocity[2]*Edge_Vector[2])/dist_ij_2;</span></div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;            <span class="comment">//              dSigmaxy5_psi5 = -ViscDens * ( Velocity[0]*Edge_Vector[1] + Velocity[1]*Edge_Vector[0] )/dist_ij_2;</span></div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;            <span class="comment">//              dSigmaxz5_psi5 = -ViscDens * ( Velocity[0]*Edge_Vector[2] + Velocity[2]*Edge_Vector[0] )/dist_ij_2;</span></div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;            <span class="comment">//              dSigmayz5_psi5 = -ViscDens * ( Velocity[1]*Edge_Vector[2] + Velocity[2]*Edge_Vector[1] )/dist_ij_2;</span></div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;            dSigma5_psi5   = -XiDens * ( Edge_Vector[0]*Normal[0] + Edge_Vector[1]*Normal[1] + Edge_Vector[2]*Normal[2] )/dist_ij_2;</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][0] += 0.0;</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][1] += -( Velocity[0]*Normal[0]*dSigmaxx_phi1 + Velocity[1]*Normal[1]*dSigmayy_phi1 + Velocity[2]*Normal[2]*dSigmazz_phi1</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                + (Velocity[0]*Normal[1] + Velocity[1]*Normal[0])*dSigmaxy_phi1</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                + (Velocity[0]*Normal[2] + Velocity[2]*Normal[0])*dSigmaxz_phi1</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;                + (Velocity[2]*Normal[1] + Velocity[1]*Normal[2])*dSigmayz_phi1 );</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][2] += -( Velocity[0]*Normal[0]*dSigmaxx_phi2 + Velocity[1]*Normal[1]*dSigmayy_phi2 + Velocity[2]*Normal[2]*dSigmazz_phi2</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                + (Velocity[0]*Normal[1] + Velocity[1]*Normal[0])*dSigmaxy_phi2</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;                + (Velocity[0]*Normal[2] + Velocity[2]*Normal[0])*dSigmaxz_phi2</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                + (Velocity[2]*Normal[1] + Velocity[1]*Normal[2])*dSigmayz_phi2 );</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][3] += -( Velocity[0]*Normal[0]*dSigmaxx_phi3 + Velocity[1]*Normal[1]*dSigmayy_phi3 + Velocity[2]*Normal[2]*dSigmazz_phi3</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;                + (Velocity[0]*Normal[1] + Velocity[1]*Normal[0])*dSigmaxy_phi3</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;                + (Velocity[0]*Normal[2] + Velocity[2]*Normal[0])*dSigmaxz_phi3</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;                + (Velocity[2]*Normal[1] + Velocity[1]*Normal[2])*dSigmayz_phi3 );</div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][4] += (sq_vel - Pressure/(Density*<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * dSigma5_psi5;</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160; </div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[4][0] += 0.0;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[4][1] += 0.0;</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[4][2] += 0.0;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[4][3] += 0.0;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[4][4] += dSigma5_psi5;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160; </div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;          }</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;        }</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;      }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;      <span class="comment">/*--- Convective contribution to the residual at the wall ---*/</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160; </div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;      <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code" href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">SubtractBlock</a>(iPoint, <a class="code" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;      <span class="comment">/*--- Viscous contribution to the residual at the wall ---*/</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160; </div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;      <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code" href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">SubtractBlock</a>(iPoint, <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>);</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160; </div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;      <span class="comment">/*--- Enforce the no-slip boundary condition in a strong way by</span></div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;<span class="comment">       modifying the velocity-rows of the Jacobian (1 on the diagonal). ---*/</span></div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160; </div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;        <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#a423b77066cf386dd6e4b95a656e4aadb">SubtractBlock2Diag</a>(iPoint, <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>);</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;        <span class="keywordflow">for</span> (iVar = 1; iVar &lt;= <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iVar++) {</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;          total_index = iPoint*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+iVar;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;          <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#a9473b0224c9b9a2749571db0bbd22a70">DeleteValsRowi</a>(total_index);</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;        }</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      }</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;    }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;  }</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    <span class="keyword">delete</span> [] Tau[iDim];</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <span class="keyword">delete</span> [] Tau;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <span class="keyword">delete</span> [] Psi;</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <span class="keyword">delete</span> [] Velocity;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="keyword">delete</span> [] Normal;</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="keyword">delete</span> [] Edge_Vector;</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;  <span class="keyword">delete</span> [] GradPsiE;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="keyword">delete</span> [] GradPhi[iDim];</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;  <span class="keyword">delete</span> [] GradPhi;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160; </div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;}</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160; </div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160; </div>
<div class="line"><a name="l01529"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a159875229feba5b14c433990e5a89d60"> 1529</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classCAdjNSSolver.html#a159875229feba5b14c433990e5a89d60">CAdjNSSolver::BC_Isothermal_Wall</a>(<a class="code" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code" href="classCSolver.html">CSolver</a> **solver_container, <a class="code" href="classCNumerics.html">CNumerics</a> *conv_numerics, <a class="code" href="classCNumerics.html">CNumerics</a> *visc_numerics, <a class="code" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> val_marker) {</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160; </div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iVertex, iPoint, total_index;</div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim, iVar, jVar, jDim;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *d, q, *U, dVisc_T, rho, pressure, div_phi,</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  force_stress, Sigma_5, phi[3] = {0.0,0.0,0.0};</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> phis1, phis2, sq_vel, ProjVel, Enthalpy, *GridVel, phi_u, d_n;</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Energy, ViscDens, XiDens, Density, SoundSpeed, Pressure, dPhiE_dn, Laminar_Viscosity, Eddy_Viscosity,</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;  Sigma_xx, Sigma_yy, Sigma_zz, Sigma_xy, Sigma_xz, Sigma_yz,</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  Sigma_xx5, Sigma_yy5, Sigma_zz5, Sigma_xy5, Sigma_xz5,</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  Sigma_yz5, eta_xx, eta_yy, eta_zz, eta_xy, eta_xz, eta_yz;</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kGTdotn=0.0, Area=0.0, Xi=0.0;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160; </div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;  <span class="keyword">auto</span> *Psi = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;  <span class="keyword">auto</span> **Tau = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    Tau[iDim] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <span class="keyword">auto</span> *Velocity = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <span class="keyword">auto</span> *Normal = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160; </div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <span class="keyword">auto</span> **GradPhi = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;    GradPhi[iDim] = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  <span class="keyword">auto</span> *GradPsiE = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *GradT;<span class="comment">// = new su2double[nDim];</span></div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *GradP;</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *GradDens;</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="keyword">auto</span> *dPoRho2 = <span class="keyword">new</span> <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160; </div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;  <span class="keywordtype">bool</span> implicit = (config-&gt;<a class="code" href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">GetKind_TimeIntScheme</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;  <span class="keywordtype">bool</span> grid_movement  = config-&gt;<a class="code" href="classCConfig.html#a9182d3dbb0b3bfa2ebb944f18795f5ca">GetGrid_Movement</a>();</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="keywordtype">bool</span> heat_flux_obj;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160; </div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Prandtl_Lam  = config-&gt;<a class="code" href="classCConfig.html#a502035c2b049606186e11e01b7df626a">GetPrandtl_Lam</a>();</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Prandtl_Turb = config-&gt;<a class="code" href="classCConfig.html#a4b89ad15fa82f93ca8ccfe945e2c14a7">GetPrandtl_Turb</a>();</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Gas_Constant = config-&gt;<a class="code" href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Cp = (<a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> / <a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>) * Gas_Constant;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Thermal_Conductivity;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> invrho3;</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Volume;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> mu2;</div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> gpsiAv2;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> gpsi5n;</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <span class="keywordtype">string</span> Marker_Tag = config-&gt;<a class="code" href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">GetMarker_All_TagBound</a>(val_marker);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="keywordtype">string</span> Monitoring_Tag;</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jMarker, iMarker_Monitoring=0;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;  <a class="code" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Weight_ObjFunc = 1.0;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;  <span class="comment">/*--- Identify marker monitoring index ---*/</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;  <span class="keywordflow">for</span> (jMarker = 0; jMarker &lt; config-&gt;<a class="code" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>(); jMarker++) {</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    Monitoring_Tag = config-&gt;<a class="code" href="classCConfig.html#a4558fc163c393e628050e7a2273673f1">GetMarker_Monitoring_TagBound</a>(jMarker);</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">if</span> (Monitoring_Tag==Marker_Tag)</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      iMarker_Monitoring = jMarker;</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;  }</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;  <span class="comment">/*-- Get objective weight --*/</span></div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;  Weight_ObjFunc = config-&gt;<a class="code" href="classCConfig.html#a614c55e8d7945a11d92d7b51851291c2">GetWeight_ObjFunc</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;  heat_flux_obj  = ((config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring) == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a">TOTAL_HEATFLUX</a>) ||</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;                           (config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring) == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a>) ||</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;                           (config-&gt;<a class="code" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring) == <a class="code" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7">INVERSE_DESIGN_HEATFLUX</a>));</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160; </div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[val_marker]; iVertex++) {</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160; </div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    iPoint = geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160; </div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="keywordflow">if</span> (geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160; </div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;      <span class="comment">/*--- Initialize the convective &amp; viscous residuals to zero ---*/</span></div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;      <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;        <a class="code" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[iVar] = 0.0;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;        <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[iVar] = 0.0;</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;        <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;          <span class="keywordflow">for</span> (jVar = 0; jVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jVar ++)</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;            <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[iVar][jVar] = 0.0;</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;        }</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;      }</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160; </div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;      <span class="comment">/*--- Retrieve adjoint solution at the wall boundary node ---*/</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;      <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++)</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;        Psi[iVar] = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint,iVar);</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160; </div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      <span class="comment">/*--- Normal vector for this vertex (negate for outward convention) ---*/</span></div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;      geometry-&gt;<a class="code" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>(Normal);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      Volume = geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#a35a504401472dfa76ef1187a5675414f">GetVolume</a>(iPoint);</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) Normal[iDim] = -Normal[iDim];</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160; </div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="comment">/*--- Get the force projection vector (based on the objective function) ---*/</span></div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;      d = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCAdjEulerVariable.html#a79bc01240b870051482bdffaabc863f9">GetForceProj_Vector</a>(iPoint);</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160; </div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;      <span class="comment">/*--- Adjustments to strong boundary condition for dynamic meshes ---*/</span></div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;      <span class="keywordflow">if</span> ( grid_movement) {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        GridVel = geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#a65d855a9c2ad2971546038b34acd5b92">GetGridVel</a>(iPoint);</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;          phi[iDim] = d[iDim] - Psi[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1]*GridVel[iDim];</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;          phi[iDim] = d[iDim];</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        }</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      }</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160; </div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <span class="comment">/*--- Strong BC imposition for the adjoint velocity equations ---*/</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>(iPoint, iDim+1) = 0.0;</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCAdjEulerVariable.html#a14a7a77262dfba287156315a5142e923">SetVel_ResTruncError_Zero</a>(iPoint);</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;        <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a6ee4d8d450971204cc054a33d6473732">SetSolution_Old</a>(iPoint,iDim+1, phi[iDim]);</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;      <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        <span class="keywordflow">for</span> (iVar = 1; iVar &lt;= <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iVar++) {</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;          total_index = iPoint*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+iVar;</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;          <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#a9473b0224c9b9a2749571db0bbd22a70">DeleteValsRowi</a>(total_index);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;        }</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;      }</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160; </div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;      <span class="comment">/*--- Get transport coefficient information ---*/</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;      Laminar_Viscosity    = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(iPoint);</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;      Eddy_Viscosity       = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#adae2e4228e113624b7ab1f9ab1a493c6">GetEddyViscosity</a>(iPoint);</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;      Thermal_Conductivity = Cp * ( Laminar_Viscosity/Prandtl_Lam</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;                                   +Eddy_Viscosity/Prandtl_Turb);</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160; </div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;<span class="comment">//      GradV = solver_container[FLOW_SOL]-&gt;GetNodes()-&gt;GetGradient_Primitive(iPoint);</span></div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160; </div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;      <span class="comment">/*--- Calculate Dirichlet condition for energy equation ---*/</span></div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;      <span class="keywordflow">if</span> (!heat_flux_obj) {</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;        q = 0.0;</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;      }</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160; </div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        Area = <a class="code" href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a>(<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, Normal);</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        <span class="comment">/*--- Temperature gradient term ---*/</span></div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        GradT = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint)[0];</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        kGTdotn = 0.0;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;          kGTdotn += Cp * Laminar_Viscosity/Prandtl_Lam*GradT[iDim]*Normal[iDim]/Area;</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        <span class="comment">// Cp * Viscosity/Prandtl_Lam matches term used in solver_direct_mean</span></div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        <span class="comment">/*--- constant term to multiply max heat flux objective ---*/</span></div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        Xi = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#a3a9516a882682f02bd9ab15d209740e5">GetTotal_HeatFlux</a>(); <span class="comment">// versions for max heat flux</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        Xi = <a class="code" href="group__VecExpr.html#ga93385cff4ce14b9889bcc9e5ee65332c">pow</a>(Xi, 1.0/<a class="code" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a>-1.0)/<a class="code" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a>;</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160; </div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;        <span class="comment">/*--- Boundary condition value ---*/</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;        q = Xi * <a class="code" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a> * <a class="code" href="group__VecExpr.html#ga93385cff4ce14b9889bcc9e5ee65332c">pow</a>(kGTdotn, <a class="code" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a>-1.0)*Area*Weight_ObjFunc;</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      }</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160; </div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      <span class="comment">/*--- Strong BC enforcement of the energy equation ---*/</span></div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;      <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>(iPoint, <a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1) = 0.0;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a20a656c4093a9101875dde0886d0ecef">SetEnergy_ResTruncError_Zero</a>(iPoint);</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a6ee4d8d450971204cc054a33d6473732">SetSolution_Old</a>(iPoint,<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1, q);</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;        iVar = <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1;</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;        total_index = iPoint*<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+iVar;</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#a9473b0224c9b9a2749571db0bbd22a70">DeleteValsRowi</a>(total_index);</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;      }</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <span class="comment">/*--- Additional contributions to adjoint density (weak imposition) ---*/</span></div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160; </div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      <span class="comment">/*--- Acquire gradient information ---*/</span></div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <span class="keyword">auto</span> PsiVar_Grad = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a07d4f954fe5a79e6f85adab3d462d73c">GetGradient</a>(iPoint);</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      GradP    = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint)[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1];</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;      GradDens = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint)[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="comment">/*--- Acqure flow information ---*/</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      rho = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a4892ca545884011b7903a8e35c43b43f">GetDensity</a>(iPoint);</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      pressure = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">GetPressure</a>(iPoint);</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;      invrho3 = (1.0/rho)*(1.0/rho)*(1.0/rho);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160; </div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;      <span class="comment">/*--- Calculate supporting quantities ---*/</span></div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;      mu2 = Thermal_Conductivity/Cp;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;      gpsiAv2 = 0.0;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;      gpsi5n = 0.0;</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;        dPoRho2[iDim] = (GradP[iDim]*rho - 2.0*GradDens[iDim]*pressure)*invrho3;</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        gpsiAv2 += -mu2*<a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>/<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a> * PsiVar_Grad[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim]*dPoRho2[iDim];</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        gpsi5n += PsiVar_Grad[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim]*Normal[iDim];</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;      }</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160; </div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;      <span class="comment">/*--- Apply first order term to boundary ---*/</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;      <a class="code" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[0] = gpsiAv2*Volume;</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160; </div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      <span class="comment">/*--- Apply second order term to boundary ---*/</span></div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;      <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[0] = -mu2*<a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>/(rho*<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)*(pressure/rho)*gpsi5n;</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160; </div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      <span class="comment">/*--- Components of the effective and adjoint stress tensors ---*/</span></div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      PsiVar_Grad = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a07d4f954fe5a79e6f85adab3d462d73c">GetGradient</a>(iPoint);</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;      div_phi = 0;</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        div_phi += PsiVar_Grad[iDim+1][iDim];</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;          Tau[iDim][jDim] = (PsiVar_Grad[iDim+1][jDim]+PsiVar_Grad[jDim+1][iDim]);</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      }</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        Tau[iDim][iDim] -= <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*div_phi;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160; </div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <span class="comment">/*--- force_stress = n_i \Tau_{ij} d_j ---*/</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      force_stress = 0.0;</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;          force_stress += Normal[iDim]*Tau[iDim][jDim]*d[jDim];</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160; </div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <span class="comment">/*--- \partial \mu_dyn \partial T ---*/</span></div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <span class="comment">//        mu_dyn = solver_container[FLOW_SOL]-&gt;GetNodes()-&gt;GetLaminarViscosity(iPoint);</span></div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;      <span class="comment">//        Temp = solver_container[FLOW_SOL]-&gt;GetNodes()-&gt;GetTemperature(iPoint);</span></div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      dVisc_T = 0.0;  <span class="comment">// dVisc_T = mu_dyn*(Temp+3.0*mu2)/(2.0*Temp*(Temp+mu2));</span></div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160; </div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;      <span class="comment">/*--- \Sigma_5 Check Area computation for Res_Conv[0] ---*/</span></div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;      Sigma_5 = (<a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>/Cp)*dVisc_T*force_stress;</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160; </div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;      <span class="comment">/*--- Imposition of residuals ---*/</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;      rho = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a4892ca545884011b7903a8e35c43b43f">GetDensity</a>(iPoint);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;      pressure = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">GetPressure</a>(iPoint);</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;      <a class="code" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[0] = pressure*Sigma_5/(<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*rho*rho);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160; </div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;      <span class="comment">/*--- Flux contribution and Jacobian contributions for moving</span></div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;<span class="comment">         walls. Note that these are only for the adjoint density and</span></div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;<span class="comment">         adjoint energy equations (the adjoint vel. uses a strong BC). ---*/</span></div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;      <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160; </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        <span class="comment">/*--- Get the appropriate grid velocity at this node ---*/</span></div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;        GridVel = geometry-&gt;<a class="code" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code" href="classCPoint.html#a65d855a9c2ad2971546038b34acd5b92">GetGridVel</a>(iPoint);</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;        <span class="comment">/*--- Get the enthalpy from the direct solution ---*/</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;        Enthalpy = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a525636dad6b2064101677df44f274443">GetEnthalpy</a>(iPoint);</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160; </div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;        <span class="comment">/*--- Compute projections, velocity squared divided by two, and</span></div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;<span class="comment">           other inner products. Note that we are imposing v = u_wall from</span></div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;<span class="comment">           the direct problem and that phi = d - \psi_5 * v ---*/</span></div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;        ProjVel = 0.0; sq_vel = 0.0; phi_u = 0.0; d_n = 0.0;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        phis1 = 0.0; phis2 = Psi[0] + Enthalpy * Psi[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1];</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;          ProjVel += GridVel[iDim]*Normal[iDim];</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;          sq_vel  += 0.5*GridVel[iDim]*GridVel[iDim];</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;          phis1   += Normal[iDim]*phi[iDim];</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;          phis2   += GridVel[iDim]*phi[iDim];</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;          phi_u   += GridVel[iDim]*phi[iDim];</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;          d_n     += d[iDim]*Normal[iDim];</div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;        }</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;        <span class="comment">//          phis1 += ProjVel * Psi[nVar-1];</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160; </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        <span class="comment">/*--- Convective flux at the wall node (adjoint density &amp; energy only) ---*/</span></div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160; </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;        <span class="comment">/*--- Version 1 (full) ---*/</span></div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;        <span class="comment">//Res_Conv_i[0] = ProjVel * Psi[0] - phis2 * ProjVel + phis1 * Gamma_Minus_One * sq_vel - ProjVel*Psi[0];</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;        <span class="comment">//Res_Conv_i[nVar-1] = ProjVel * Psi[nVar-1] + phis1 * Gamma_Minus_One - ProjVel*Psi[nVar-1];</span></div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;        <span class="comment">/*--- Simplified version ---*/</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;        <a class="code" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[0] = -(Psi[0] + phi_u + Psi[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1]*Enthalpy)*ProjVel + d_n*<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*sq_vel;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; </div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <span class="comment">/*--- TO DO: Implicit contributions for convective part ---*/</span></div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160; </div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160; </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <span class="comment">/*--- Viscous flux contributions at the wall node ---*/</span></div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        U = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint);</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        Laminar_Viscosity = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(iPoint);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        Eddy_Viscosity = solver_container[<a class="code" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code" href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">GetNodes</a>()-&gt;<a class="code" href="classCVariable.html#adae2e4228e113624b7ab1f9ab1a493c6">GetEddyViscosity</a>(iPoint); <span class="comment">// Should be zero at the wall</span></div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;        Density = U[0];</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;          Velocity[iDim] = GridVel[iDim];</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        Energy = U[<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] / Density;</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        SoundSpeed = <a class="code" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(<a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>*<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*(Energy-sq_vel));</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        Pressure = (SoundSpeed * SoundSpeed * Density) / <a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>;</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        ViscDens = (Laminar_Viscosity + Eddy_Viscosity) / Density;</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        XiDens = <a class="code" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> * (Laminar_Viscosity/Prandtl_Lam + Eddy_Viscosity/Prandtl_Turb) / Density;</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160; </div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        <span class="comment">/*--- Average of the derivatives of the adjoint variables ---*/</span></div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        PsiVar_Grad = <a class="code" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code" href="classCVariable.html#a07d4f954fe5a79e6f85adab3d462d73c">GetGradient</a>(iPoint);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160; </div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;          GradPsiE[iDim] =  PsiVar_Grad[<a class="code" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim];</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;          <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;            GradPhi[iDim][jDim] =  PsiVar_Grad[iDim+1][jDim];</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        }</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160; </div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;        <span class="comment">/*--- Impose dPhiE_dn = 0 (adiabatic walls with frozen viscosity). Note</span></div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;<span class="comment">           that this is where a different adjoint boundary condition for temperature</span></div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;<span class="comment">           could be imposed. ---*/</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;        dPhiE_dn = 0.0;</div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160; </div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> ==2) {</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160; </div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;          <span class="comment">/*--- Compute the adjoint stress tensor ---*/</span></div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;          Sigma_xx  = ViscDens * (<a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[0][0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1]);</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;          Sigma_yy  = ViscDens * (-<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[1][1]);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;          Sigma_xy  = ViscDens * (GradPhi[1][0] + GradPhi[0][1]);</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;          Sigma_xx5 = ViscDens * ( <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[0] * GradPsiE[0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1]);</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;          Sigma_yy5 = ViscDens * (- <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[1] * GradPsiE[1]);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;          Sigma_xy5 = ViscDens * (Velocity[0] * GradPsiE[1] + Velocity[1] * GradPsiE[0]);</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;          Sigma_5   = XiDens * dPhiE_dn;</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;          eta_xx    = Sigma_xx + Sigma_xx5;</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;          eta_yy    = Sigma_yy + Sigma_yy5;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;          eta_xy    = Sigma_xy + Sigma_xy5;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160; </div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;          <span class="comment">/*--- Viscous flux at the wall node (adjoint density &amp; energy only) ---*/</span></div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;          <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[0] = - (Velocity[0] * Normal[0] * eta_xx  + Velocity[1] * Normal[1] * eta_yy</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;              + (Velocity[0] * Normal[1] + Velocity[1] * Normal[0]) * eta_xy</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;              - (sq_vel - Pressure/(Density*<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * Sigma_5);</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;          <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[1] = 0.0;</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;          <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[2] = 0.0;</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160; </div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) {</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160; </div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;          <span class="comment">/*--- Compute the adjoint stress tensor ---*/</span></div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;          Sigma_xx  = ViscDens * (<a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[0][0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1] - <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>  * GradPhi[2][2]);</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;          Sigma_yy  = ViscDens * (-<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[1][1] - <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>  * GradPhi[2][2]);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;          Sigma_zz  = ViscDens * (-<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[2][2]);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;          Sigma_xy  = ViscDens * (GradPhi[1][0] + GradPhi[0][1]);</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;          Sigma_xz  = ViscDens * (GradPhi[2][0] + GradPhi[0][2]);</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;          Sigma_yz  = ViscDens * (GradPhi[2][1] + GradPhi[1][2]);</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;          Sigma_xx5 = ViscDens * ( <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[0] * GradPsiE[0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;          Sigma_yy5 = ViscDens * (- <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[1] * GradPsiE[1] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;          Sigma_zz5 = ViscDens * (- <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] -  <a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1] + <a class="code" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;          Sigma_xy5 = ViscDens * (Velocity[0] * GradPsiE[1] + Velocity[1] * GradPsiE[0]);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;          Sigma_xz5 = ViscDens * (Velocity[0] * GradPsiE[2] + Velocity[2] * GradPsiE[0]);</div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;          Sigma_yz5 = ViscDens * (Velocity[1] * GradPsiE[2] + Velocity[2] * GradPsiE[1]);</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;          Sigma_5   = XiDens * dPhiE_dn;</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;          eta_xx    = Sigma_xx + Sigma_xx5; eta_yy = Sigma_yy + Sigma_yy5; eta_zz = Sigma_zz + Sigma_zz5;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;          eta_xy    = Sigma_xy + Sigma_xy5; eta_xz = Sigma_xz + Sigma_xz5; eta_yz = Sigma_yz + Sigma_yz5;</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160; </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;          <span class="comment">/*--- Viscous flux at the wall node (adjoint density &amp; energy only) ---*/</span></div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;          <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[0] = - (Velocity[0] * Normal[0] * eta_xx  + Velocity[1] * Normal[1] * eta_yy + Velocity[2] * Normal[2] * eta_zz</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;              + (Velocity[0] * Normal[1] + Velocity[1] * Normal[0]) * eta_xy</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;              + (Velocity[0] * Normal[2] + Velocity[2] * Normal[0]) * eta_xz</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;              + (Velocity[2] * Normal[1] + Velocity[1] * Normal[2]) * eta_yz</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;              - (sq_vel - Pressure/(Density*<a class="code" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * Sigma_5);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;          <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[1] = 0.0;</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;          <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[2] = 0.0;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;          <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[3] = 0.0;</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;        }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;      }</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160; </div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;      <span class="comment">/*--- Update convective and viscous residuals ---*/</span></div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code" href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">AddBlock</a>(iPoint, <a class="code" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;      <a class="code" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code" href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">SubtractBlock</a>(iPoint, <a class="code" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>);</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;      <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;        <a class="code" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code" href="classCSysMatrix.html#a423b77066cf386dd6e4b95a656e4aadb">SubtractBlock2Diag</a>(iPoint, <a class="code" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>);</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;      }</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    }</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160; </div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keyword">delete</span> [] Tau[iDim];</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;  <span class="keyword">delete</span> [] Tau;</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;  <span class="keyword">delete</span> [] Psi;</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;  <span class="keyword">delete</span> [] Velocity;</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <span class="keyword">delete</span> [] Normal;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <span class="keyword">delete</span> [] GradPsiE;</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    <span class="keyword">delete</span> [] GradPhi[iDim];</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <span class="keyword">delete</span> [] GradPhi;</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;  <span class="keyword">delete</span> [] dPoRho2;</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;}</div>
<div class="ttc" id="aclassC2DContainer_html"><div class="ttname"><a href="classC2DContainer.html">C2DContainer</a></div><div class="ttdoc">A templated matrix/vector-like object.</div><div class="ttdef"><b>Definition:</b> <a href="C2DContainer_8hpp_source.html#l00371">C2DContainer.hpp:372</a></div></div>
<div class="ttc" id="aclassC2DContainer_html_adefb48b593f76aa322e228fea8f76127"><div class="ttname"><a href="classC2DContainer.html#adefb48b593f76aa322e228fea8f76127">C2DContainer::resize</a></div><div class="ttdeci">C2DContainer &amp; resize(const Index_t size1, const Index_t size2=1) noexcept</div><div class="ttdoc">Request a change of size.</div><div class="ttdef"><b>Definition:</b> <a href="C2DContainer_8hpp_source.html#l00537">C2DContainer.hpp:537</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html"><div class="ttname"><a href="classCAdjEulerSolver.html">CAdjEulerSolver</a></div><div class="ttdoc">Main class for defining the Euler's adjoint flow solver.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00039">CAdjEulerSolver.hpp:39</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a066a1c3fb9cf63efc84a58ac67a76437"><div class="ttname"><a href="classCAdjEulerSolver.html#a066a1c3fb9cf63efc84a58ac67a76437">CAdjEulerSolver::FlowPrimVar_i</a></div><div class="ttdeci">su2double * FlowPrimVar_i</div><div class="ttdoc">Store the flow solution at point i.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00064">CAdjEulerSolver.hpp:64</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a11a688be02f50bf45a49f23ea4ac4cb2"><div class="ttname"><a href="classCAdjEulerSolver.html#a11a688be02f50bf45a49f23ea4ac4cb2">CAdjEulerSolver::PsiRho_Inf</a></div><div class="ttdeci">su2double PsiRho_Inf</div><div class="ttdoc">PsiRho variable at the infinity.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00042">CAdjEulerSolver.hpp:42</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a3656883f9d954ca86220b3bfcab25bc7"><div class="ttname"><a href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">CAdjEulerSolver::Phi_Inf</a></div><div class="ttdeci">su2double * Phi_Inf</div><div class="ttdoc">Phi vector at the infinity.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00044">CAdjEulerSolver.hpp:44</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a387182abffb4a18a66322e7357ce4eac"><div class="ttname"><a href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">CAdjEulerSolver::Sens_AoA</a></div><div class="ttdeci">su2double * Sens_AoA</div><div class="ttdoc">Angle of attack sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00047">CAdjEulerSolver.hpp:47</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a3f9e8576dc150e551bd19a64b1d43977"><div class="ttname"><a href="classCAdjEulerSolver.html#a3f9e8576dc150e551bd19a64b1d43977">CAdjEulerSolver::Sens_BPress</a></div><div class="ttdeci">su2double * Sens_BPress</div><div class="ttdoc">Back pressure sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00051">CAdjEulerSolver.hpp:51</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a44d7c3320be93416c2013eaf7bb98562"><div class="ttname"><a href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">CAdjEulerSolver::Sens_Press</a></div><div class="ttdeci">su2double * Sens_Press</div><div class="ttdoc">Pressure sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00049">CAdjEulerSolver.hpp:49</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a4a53581a74846bf44a7d7a85d15bb8e5"><div class="ttname"><a href="classCAdjEulerSolver.html#a4a53581a74846bf44a7d7a85d15bb8e5">CAdjEulerSolver::PsiE_Inf</a></div><div class="ttdeci">su2double PsiE_Inf</div><div class="ttdoc">PsiE variable at the infinity.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00043">CAdjEulerSolver.hpp:43</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a5265a44e6c43dee677c9f26333148432"><div class="ttname"><a href="classCAdjEulerSolver.html#a5265a44e6c43dee677c9f26333148432">CAdjEulerSolver::SetFarfield_AoA</a></div><div class="ttdeci">void SetFarfield_AoA(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, bool Output)</div><div class="ttdoc">Update the AoA and freestream velocity at the farfield.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8cpp_source.html#l02103">CAdjEulerSolver.cpp:2103</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a58d3d6883f58061e0a5ce4e81c748fb0"><div class="ttname"><a href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">CAdjEulerSolver::Total_Sens_Geo</a></div><div class="ttdeci">su2double Total_Sens_Geo</div><div class="ttdoc">Total shape sensitivity coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00056">CAdjEulerSolver.hpp:56</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a58f168e47ed752d3b0cd67ddf729c552"><div class="ttname"><a href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CAdjEulerSolver::CSensitivity</a></div><div class="ttdeci">su2double ** CSensitivity</div><div class="ttdoc">Shape sensitivity coefficient for each boundary and vertex.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00052">CAdjEulerSolver.hpp:52</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a63e3f7ad5daf7b04bb551c898b8099a7"><div class="ttname"><a href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">CAdjEulerSolver::Sens_Geo</a></div><div class="ttdeci">su2double * Sens_Geo</div><div class="ttdoc">Shape sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00048">CAdjEulerSolver.hpp:48</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a84f2772cbd2fa10fc51970495e929d4b"><div class="ttname"><a href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">CAdjEulerSolver::Gamma</a></div><div class="ttdeci">su2double Gamma</div><div class="ttdoc">Fluid's Gamma constant (ratio of specific heats).</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00062">CAdjEulerSolver.hpp:62</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a88866367a785e4cfdc5f72606c6cfe4c"><div class="ttname"><a href="classCAdjEulerSolver.html#a88866367a785e4cfdc5f72606c6cfe4c">CAdjEulerSolver::DonorAdjVar</a></div><div class="ttdeci">vector&lt; vector&lt; vector&lt; su2double &gt; &gt; &gt; DonorAdjVar</div><div class="ttdoc">Value of the donor variables at each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00053">CAdjEulerSolver.hpp:53</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a9d54da0d71cf883ef9882a5b952e8d7e"><div class="ttname"><a href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">CAdjEulerSolver::Total_Sens_Press</a></div><div class="ttdeci">su2double Total_Sens_Press</div><div class="ttdoc">Total farfield sensitivity to pressure.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00057">CAdjEulerSolver.hpp:57</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a9d6f0287021d17e2313fcd7a630e4150"><div class="ttname"><a href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">CAdjEulerSolver::nodes</a></div><div class="ttdeci">CAdjEulerVariable * nodes</div><div class="ttdoc">The highest level in the variable hierarchy this solver can safely use.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00074">CAdjEulerSolver.hpp:74</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_aa29c3c368ebace7feb2c88a2cc57f260"><div class="ttname"><a href="classCAdjEulerSolver.html#aa29c3c368ebace7feb2c88a2cc57f260">CAdjEulerSolver::FlowPrimVar_j</a></div><div class="ttdeci">su2double * FlowPrimVar_j</div><div class="ttdoc">Store the flow solution at point j.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00065">CAdjEulerSolver.hpp:65</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_aa5d4c1937cfe9ca07e7f2e692170b437"><div class="ttname"><a href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">CAdjEulerSolver::pnorm</a></div><div class="ttdeci">su2double pnorm</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00068">CAdjEulerSolver.hpp:68</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_aa9f35cdd46666eb545d831c9bc5985d5"><div class="ttname"><a href="classCAdjEulerSolver.html#aa9f35cdd46666eb545d831c9bc5985d5">CAdjEulerSolver::DonorGlobalIndex</a></div><div class="ttdeci">vector&lt; vector&lt; unsigned long &gt; &gt; DonorGlobalIndex</div><div class="ttdoc">Value of the donor global index.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00066">CAdjEulerSolver.hpp:66</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_aaa2d20642192953874b39ef80b882397"><div class="ttname"><a href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">CAdjEulerSolver::Total_Sens_Mach</a></div><div class="ttdeci">su2double Total_Sens_Mach</div><div class="ttdoc">Total mach sensitivity coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00054">CAdjEulerSolver.hpp:54</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_acf0412ccd54deb050dc4a8923413be9f"><div class="ttname"><a href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">CAdjEulerSolver::Gamma_Minus_One</a></div><div class="ttdeci">su2double Gamma_Minus_One</div><div class="ttdoc">Fluids's Gamma - 1.0 .</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00063">CAdjEulerSolver.hpp:63</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_acfaa34c05bb62cca6a0deccea83bcf73"><div class="ttname"><a href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">CAdjEulerSolver::Total_Sens_AoA</a></div><div class="ttdeci">su2double Total_Sens_AoA</div><div class="ttdoc">Total angle of attack sensitivity coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00055">CAdjEulerSolver.hpp:55</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_ad4ccc706c5355e248c2e091676957b94"><div class="ttname"><a href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">CAdjEulerSolver::Sens_Mach</a></div><div class="ttdeci">su2double * Sens_Mach</div><div class="ttdoc">Mach sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00046">CAdjEulerSolver.hpp:46</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_ad8bbbbd00a0b4111a25044c084572706"><div class="ttname"><a href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">CAdjEulerSolver::Total_Sens_Temp</a></div><div class="ttdeci">su2double Total_Sens_Temp</div><div class="ttdoc">Total farfield sensitivity to temperature.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00058">CAdjEulerSolver.hpp:58</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_ae69171bce719d74c9a5961170fe0aae4"><div class="ttname"><a href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">CAdjEulerSolver::Sens_Temp</a></div><div class="ttdeci">su2double * Sens_Temp</div><div class="ttdoc">Temperature sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00050">CAdjEulerSolver.hpp:50</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_af1b72ed76900f821d2f51942cb4252db"><div class="ttname"><a href="classCAdjEulerSolver.html#af1b72ed76900f821d2f51942cb4252db">CAdjEulerSolver::SetCentered_Dissipation_Sensor</a></div><div class="ttdeci">void SetCentered_Dissipation_Sensor(CGeometry *geometry, CConfig *config)</div><div class="ttdoc">Compute the sensor for higher order dissipation control in rotating problems.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8cpp_source.html#l01317">CAdjEulerSolver.cpp:1317</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_af3684618530046d51d1e035f4d531ce2"><div class="ttname"><a href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">CAdjEulerSolver::Area_Monitored</a></div><div class="ttdeci">su2double Area_Monitored</div><div class="ttdoc">Store the total area of the monitored outflow surface (used for normalization in continuous adjoint o...</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerSolver_8hpp_source.html#l00069">CAdjEulerSolver.hpp:69</a></div></div>
<div class="ttc" id="aclassCAdjEulerVariable_html_a08d1474748d5ddf53d62c1dde9f23ac8"><div class="ttname"><a href="classCAdjEulerVariable.html#a08d1474748d5ddf53d62c1dde9f23ac8">CAdjEulerVariable::SetPrimVar</a></div><div class="ttdeci">bool SetPrimVar(unsigned long iPoint, su2double SharpEdge_Distance, bool check, CConfig *config) final</div><div class="ttdoc">Set all the primitive variables for compressible flows.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerVariable_8cpp_source.html#l00109">CAdjEulerVariable.cpp:109</a></div></div>
<div class="ttc" id="aclassCAdjEulerVariable_html_a14a7a77262dfba287156315a5142e923"><div class="ttname"><a href="classCAdjEulerVariable.html#a14a7a77262dfba287156315a5142e923">CAdjEulerVariable::SetVel_ResTruncError_Zero</a></div><div class="ttdeci">void SetVel_ResTruncError_Zero(unsigned long iPoint) final</div><div class="ttdoc">Set the momentum part of the truncation error to zero.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerVariable_8hpp_source.html#l00109">CAdjEulerVariable.hpp:109</a></div></div>
<div class="ttc" id="aclassCAdjEulerVariable_html_a79bc01240b870051482bdffaabc863f9"><div class="ttname"><a href="classCAdjEulerVariable.html#a79bc01240b870051482bdffaabc863f9">CAdjEulerVariable::GetForceProj_Vector</a></div><div class="ttdeci">su2double * GetForceProj_Vector(unsigned long iPoint) final</div><div class="ttdoc">Get the value of the force projection vector.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjEulerVariable_8hpp_source.html#l00126">CAdjEulerVariable.hpp:126</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a0669f6fb8ef7cd7800d151d4aff7d3f6"><div class="ttname"><a href="classCAdjNSSolver.html#a0669f6fb8ef7cd7800d151d4aff7d3f6">CAdjNSSolver::Preprocessing</a></div><div class="ttdeci">void Preprocessing(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, unsigned short iRKStep, unsigned short RunTime_EqSystem, bool Output) override</div><div class="ttdoc">Restart residual and compute gradients.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjNSSolver_8cpp_source.html#l00302">CAdjNSSolver.cpp:302</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a159875229feba5b14c433990e5a89d60"><div class="ttname"><a href="classCAdjNSSolver.html#a159875229feba5b14c433990e5a89d60">CAdjNSSolver::BC_Isothermal_Wall</a></div><div class="ttdeci">void BC_Isothermal_Wall(CGeometry *geometry, CSolver **solver_container, CNumerics *conv_numerics, CNumerics *visc_numerics, CConfig *config, unsigned short val_marker) override</div><div class="ttdoc">Impose via the residual or brute force the Navier-Stokes adjoint boundary condition (heat flux).</div><div class="ttdef"><b>Definition:</b> <a href="CAdjNSSolver_8cpp_source.html#l01529">CAdjNSSolver.cpp:1529</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a22ab579adc04b7c212508480df9dff8b"><div class="ttname"><a href="classCAdjNSSolver.html#a22ab579adc04b7c212508480df9dff8b">CAdjNSSolver::SetTime_Step</a></div><div class="ttdeci">void SetTime_Step(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, unsigned long Iteration) override</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjNSSolver_8cpp_source.html#l00292">CAdjNSSolver.cpp:292</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a3f7289e94076471c23e53da293b69645"><div class="ttname"><a href="classCAdjNSSolver.html#a3f7289e94076471c23e53da293b69645">CAdjNSSolver::Source_Residual</a></div><div class="ttdeci">void Source_Residual(CGeometry *geometry, CSolver **solver_container, CNumerics **numerics_container, CConfig *config, unsigned short iMesh) override</div><div class="ttdoc">Source term computation.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjNSSolver_8cpp_source.html#l00441">CAdjNSSolver.cpp:441</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a6e2a8b29fa5c5709d12e7970d8cc88eb"><div class="ttname"><a href="classCAdjNSSolver.html#a6e2a8b29fa5c5709d12e7970d8cc88eb">CAdjNSSolver::~CAdjNSSolver</a></div><div class="ttdeci">~CAdjNSSolver(void) override</div><div class="ttdoc">Destructor of the class.</div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a6e72f094190680fa7fb078d7aae9c1d8"><div class="ttname"><a href="classCAdjNSSolver.html#a6e72f094190680fa7fb078d7aae9c1d8">CAdjNSSolver::Viscous_Sensitivity</a></div><div class="ttdeci">void Viscous_Sensitivity(CGeometry *geometry, CSolver **solver_container, CNumerics *numerics, CConfig *config) override</div><div class="ttdoc">Compute the viscous sensitivity of the functional.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjNSSolver_8cpp_source.html#l00583">CAdjNSSolver.cpp:583</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a87064a324dd57b715155f405fc0804fc"><div class="ttname"><a href="classCAdjNSSolver.html#a87064a324dd57b715155f405fc0804fc">CAdjNSSolver::Viscous_Residual</a></div><div class="ttdeci">void Viscous_Residual(CGeometry *geometry, CSolver **solver_container, CNumerics **numerics_container, CConfig *config, unsigned short iMesh, unsigned short iRKStep) override</div><div class="ttdoc">Compute the viscous residuals for the adjoint equation.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjNSSolver_8cpp_source.html#l00391">CAdjNSSolver.cpp:391</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_aac064a699355df483ca48c40e7c50675"><div class="ttname"><a href="classCAdjNSSolver.html#aac064a699355df483ca48c40e7c50675">CAdjNSSolver::BC_HeatFlux_Wall</a></div><div class="ttdeci">void BC_HeatFlux_Wall(CGeometry *geometry, CSolver **solver_container, CNumerics *conv_numerics, CNumerics *visc_numerics, CConfig *config, unsigned short val_marker) override</div><div class="ttdoc">Impose via the residual or brute force the Navier-Stokes adjoint boundary condition (heat flux).</div><div class="ttdef"><b>Definition:</b> <a href="CAdjNSSolver_8cpp_source.html#l01167">CAdjNSSolver.cpp:1167</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_acd8b443b57b29343b1ce316bed3f380b"><div class="ttname"><a href="classCAdjNSSolver.html#acd8b443b57b29343b1ce316bed3f380b">CAdjNSSolver::CAdjNSSolver</a></div><div class="ttdeci">CAdjNSSolver(void)</div><div class="ttdoc">Constructor of the class.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjNSSolver_8cpp_source.html#l00033">CAdjNSSolver.cpp:33</a></div></div>
<div class="ttc" id="aclassCAdjNSVariable_html"><div class="ttname"><a href="classCAdjNSVariable.html">CAdjNSVariable</a></div><div class="ttdoc">Main class for defining the variables of the adjoint Navier-Stokes solver.</div><div class="ttdef"><b>Definition:</b> <a href="CAdjNSVariable_8hpp_source.html#l00038">CAdjNSVariable.hpp:38</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a381d4b3738c09d92ee1ae9f89715b541"><div class="ttname"><a href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">CBaseMPIWrapper::Allreduce</a></div><div class="ttdeci">static void Allreduce(const void *sendbuf, void *recvbuf, int count, Datatype datatype, Op op, Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00561">mpi_structure.hpp:561</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a8154391fc3522954802889d81d4ef5da"><div class="ttname"><a href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">CBaseMPIWrapper::GetComm</a></div><div class="ttdeci">static Comm GetComm()</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00521">mpi_structure.hpp:521</a></div></div>
<div class="ttc" id="aclassCConfig_html"><div class="ttname"><a href="classCConfig.html">CConfig</a></div><div class="ttdoc">Main class for defining the problem; basically this class reads the configuration file,...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l00062">CConfig.hpp:62</a></div></div>
<div class="ttc" id="aclassCConfig_html_a0b5df9254891b32a88e83880778f9261"><div class="ttname"><a href="classCConfig.html#a0b5df9254891b32a88e83880778f9261">CConfig::GetGamma</a></div><div class="ttdeci">su2double GetGamma(void) const</div><div class="ttdoc">Get the value of the Gamma of fluid (ratio of specific heats).</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01634">CConfig.hpp:1634</a></div></div>
<div class="ttc" id="aclassCConfig_html_a1132191f9f5af73ef4ff7eb356f41181"><div class="ttname"><a href="classCConfig.html#a1132191f9f5af73ef4ff7eb356f41181">CConfig::GetSolution_AdjFileName</a></div><div class="ttdeci">string GetSolution_AdjFileName(void) const</div><div class="ttdoc">Get the name of the file with the solution of the adjoint flow problem with drag objective function.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05605">CConfig.hpp:5605</a></div></div>
<div class="ttc" id="aclassCConfig_html_a1431ababf767a9f74ff74fe9ef647957"><div class="ttname"><a href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">CConfig::GetGas_ConstantND</a></div><div class="ttdeci">su2double GetGas_ConstantND(void) const</div><div class="ttdoc">Get the value of specific gas constant.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01688">CConfig.hpp:1688</a></div></div>
<div class="ttc" id="aclassCConfig_html_a350466e9cc76639fb07c59ac43288bb8"><div class="ttname"><a href="classCConfig.html#a350466e9cc76639fb07c59ac43288bb8">CConfig::GetReconstructionGradientRequired</a></div><div class="ttdeci">bool GetReconstructionGradientRequired(void) const</div><div class="ttdoc">Get flag for whether a second gradient calculation is required for upwind reconstruction alone.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l04262">CConfig.hpp:4262</a></div></div>
<div class="ttc" id="aclassCConfig_html_a3bd1de6bcb6cd7062816341b0d956459"><div class="ttname"><a href="classCConfig.html#a3bd1de6bcb6cd7062816341b0d956459">CConfig::GetVenkat_LimiterCoeff</a></div><div class="ttdeci">su2double GetVenkat_LimiterCoeff(void) const</div><div class="ttdoc">Get the value of limiter coefficient.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l02490">CConfig.hpp:2490</a></div></div>
<div class="ttc" id="aclassCConfig_html_a3f9890ff8ca2b98646e4ebf3de8c9c13"><div class="ttname"><a href="classCConfig.html#a3f9890ff8ca2b98646e4ebf3de8c9c13">CConfig::GetRotation_Rate</a></div><div class="ttdeci">su2double GetRotation_Rate(unsigned short iDim) const</div><div class="ttdoc">Get the rotation rate of the mesh.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l06028">CConfig.hpp:6028</a></div></div>
<div class="ttc" id="aclassCConfig_html_a434fe0922532828b7e40ded865c5ce51"><div class="ttname"><a href="classCConfig.html#a434fe0922532828b7e40ded865c5ce51">CConfig::SetNonphysical_Points</a></div><div class="ttdeci">void SetNonphysical_Points(unsigned long val_nonphys_points)</div><div class="ttdoc">Set the current number of non-physical nodes in the solution.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l08811">CConfig.hpp:8811</a></div></div>
<div class="ttc" id="aclassCConfig_html_a4558fc163c393e628050e7a2273673f1"><div class="ttname"><a href="classCConfig.html#a4558fc163c393e628050e7a2273673f1">CConfig::GetMarker_Monitoring_TagBound</a></div><div class="ttdeci">string GetMarker_Monitoring_TagBound(unsigned short val_marker) const</div><div class="ttdoc">Get the name of the surface defined in the geometry file.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03403">CConfig.hpp:3403</a></div></div>
<div class="ttc" id="aclassCConfig_html_a459dee039e618d21a5d78db61c221240"><div class="ttname"><a href="classCConfig.html#a459dee039e618d21a5d78db61c221240">CConfig::GetnMarker_All</a></div><div class="ttdeci">unsigned short GetnMarker_All(void) const</div><div class="ttdoc">Get the total number of boundary markers of the local process including send/receive domains.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03071">CConfig.hpp:3071</a></div></div>
<div class="ttc" id="aclassCConfig_html_a4b89ad15fa82f93ca8ccfe945e2c14a7"><div class="ttname"><a href="classCConfig.html#a4b89ad15fa82f93ca8ccfe945e2c14a7">CConfig::GetPrandtl_Turb</a></div><div class="ttdeci">su2double GetPrandtl_Turb(unsigned short val_index=0) const</div><div class="ttdoc">Get the value of the turbulent Prandtl number.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01783">CConfig.hpp:1783</a></div></div>
<div class="ttc" id="aclassCConfig_html_a4bf6e287aaf809340df1e40a76cf438b"><div class="ttname"><a href="classCConfig.html#a4bf6e287aaf809340df1e40a76cf438b">CConfig::GetKind_TimeIntScheme_AdjFlow</a></div><div class="ttdeci">unsigned short GetKind_TimeIntScheme_AdjFlow(void) const</div><div class="ttdoc">Get the kind of integration scheme (explicit or implicit) for the adjoint flow equations.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l04853">CConfig.hpp:4853</a></div></div>
<div class="ttc" id="aclassCConfig_html_a502035c2b049606186e11e01b7df626a"><div class="ttname"><a href="classCConfig.html#a502035c2b049606186e11e01b7df626a">CConfig::GetPrandtl_Lam</a></div><div class="ttdeci">su2double GetPrandtl_Lam(unsigned short val_index=0) const</div><div class="ttdoc">Get the value of the laminar Prandtl number.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01777">CConfig.hpp:1777</a></div></div>
<div class="ttc" id="aclassCConfig_html_a515e35504ab34bf25d222e377f3b4c81"><div class="ttname"><a href="classCConfig.html#a515e35504ab34bf25d222e377f3b4c81">CConfig::GetRefArea</a></div><div class="ttdeci">su2double GetRefArea(void) const</div><div class="ttdoc">Get the reference area for non dimensional coefficient computation. If the value from the is 0 then,...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l02076">CConfig.hpp:2076</a></div></div>
<div class="ttc" id="aclassCConfig_html_a5442ec644c8d291d3e07c158ba5d54a4"><div class="ttname"><a href="classCConfig.html#a5442ec644c8d291d3e07c158ba5d54a4">CConfig::GetMach_Motion</a></div><div class="ttdeci">su2double GetMach_Motion(void) const</div><div class="ttdoc">Get the mach number based on the mesh velocity and freestream quantities.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05959">CConfig.hpp:5959</a></div></div>
<div class="ttc" id="aclassCConfig_html_a5a078901bb388e9caa9cb856e3348f0b"><div class="ttname"><a href="classCConfig.html#a5a078901bb388e9caa9cb856e3348f0b">CConfig::GetMach</a></div><div class="ttdeci">su2double GetMach(void) const</div><div class="ttdoc">Get the value of the Mach number (velocity divided by speed of sound).</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01628">CConfig.hpp:1628</a></div></div>
<div class="ttc" id="aclassCConfig_html_a614c55e8d7945a11d92d7b51851291c2"><div class="ttname"><a href="classCConfig.html#a614c55e8d7945a11d92d7b51851291c2">CConfig::GetWeight_ObjFunc</a></div><div class="ttdeci">su2double GetWeight_ObjFunc(unsigned short val_obj) const</div><div class="ttdoc">Get the weight of objective function. There are several options: Drag coefficient,...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05428">CConfig.hpp:5428</a></div></div>
<div class="ttc" id="aclassCConfig_html_a693b7f150eb8b7a455e4174d4af744b8"><div class="ttname"><a href="classCConfig.html#a693b7f150eb8b7a455e4174d4af744b8">CConfig::GetFrozen_Visc_Cont</a></div><div class="ttdeci">bool GetFrozen_Visc_Cont(void) const</div><div class="ttdoc">Provides information about the way in which the turbulence will be treated by the cont....</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05028">CConfig.hpp:5028</a></div></div>
<div class="ttc" id="aclassCConfig_html_a6e65810e59b8015104b84c4fd5b1d7f9"><div class="ttname"><a href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">CConfig::GetnMarker_Monitoring</a></div><div class="ttdeci">unsigned short GetnMarker_Monitoring(void) const</div><div class="ttdoc">Get the total number of monitoring markers.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03155">CConfig.hpp:3155</a></div></div>
<div class="ttc" id="aclassCConfig_html_a77312cf52a5ba2cc1239b7cee6fce7a7"><div class="ttname"><a href="classCConfig.html#a77312cf52a5ba2cc1239b7cee6fce7a7">CConfig::GetKind_Solver</a></div><div class="ttdeci">MAIN_SOLVER GetKind_Solver(void) const</div><div class="ttdoc">Governing equations of the flow (it can be different from the run time equation).</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03832">CConfig.hpp:3832</a></div></div>
<div class="ttc" id="aclassCConfig_html_a7c7b4b489dcb3b505c091de0ae300891"><div class="ttname"><a href="classCConfig.html#a7c7b4b489dcb3b505c091de0ae300891">CConfig::GetRefElemLength</a></div><div class="ttdeci">su2double GetRefElemLength(void) const</div><div class="ttdoc">Get the reference element length for computing the slope limiting epsilon.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l02420">CConfig.hpp:2420</a></div></div>
<div class="ttc" id="aclassCConfig_html_a83d5144467a2c2fa78a7f9cc19026421"><div class="ttname"><a href="classCConfig.html#a83d5144467a2c2fa78a7f9cc19026421">CConfig::GetKind_Gradient_Method</a></div><div class="ttdeci">unsigned short GetKind_Gradient_Method(void) const</div><div class="ttdoc">Get the kind of method for computation of spatial gradients used for viscous and source terms.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l04250">CConfig.hpp:4250</a></div></div>
<div class="ttc" id="aclassCConfig_html_a9182d3dbb0b3bfa2ebb944f18795f5ca"><div class="ttname"><a href="classCConfig.html#a9182d3dbb0b3bfa2ebb944f18795f5ca">CConfig::GetGrid_Movement</a></div><div class="ttdeci">bool GetGrid_Movement(void) const</div><div class="ttdoc">Get information about the grid movement.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05905">CConfig.hpp:5905</a></div></div>
<div class="ttc" id="aclassCConfig_html_a99e6285b421215b1995965cd534976ae"><div class="ttname"><a href="classCConfig.html#a99e6285b421215b1995965cd534976ae">CConfig::GetKind_ObjFunc</a></div><div class="ttdeci">unsigned short GetKind_ObjFunc(unsigned short val_obj=0) const</div><div class="ttdoc">Get the kind of objective function. There are several options: Drag coefficient, Lift coefficient,...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05419">CConfig.hpp:5419</a></div></div>
<div class="ttc" id="aclassCConfig_html_aa495414133c826e5f6651d4ce82d0ef6"><div class="ttname"><a href="classCConfig.html#aa495414133c826e5f6651d4ce82d0ef6">CConfig::GetComm_Level</a></div><div class="ttdeci">unsigned short GetComm_Level(void) const</div><div class="ttdoc">Get the level of MPI communications to be performed.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l09491">CConfig.hpp:9491</a></div></div>
<div class="ttc" id="aclassCConfig_html_aad80e2ae9bc0b7b1fed6ccc2b6b2bce0"><div class="ttname"><a href="classCConfig.html#aad80e2ae9bc0b7b1fed6ccc2b6b2bce0">CConfig::GetnObj</a></div><div class="ttdeci">unsigned short GetnObj(void) const</div><div class="ttdoc">Get the total number of objectives in kind_objective list.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03209">CConfig.hpp:3209</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab05a2ea2f4079504565628130bee2ae3"><div class="ttname"><a href="classCConfig.html#ab05a2ea2f4079504565628130bee2ae3">CConfig::GetSystemMeasurements</a></div><div class="ttdeci">unsigned short GetSystemMeasurements(void) const</div><div class="ttdoc">Governing equations of the flow (it can be different from the run time equation).</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03919">CConfig.hpp:3919</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab090a18d19d62ffc6fbf89f195eed16e"><div class="ttname"><a href="classCConfig.html#ab090a18d19d62ffc6fbf89f195eed16e">CConfig::GetEval_dOF_dCX</a></div><div class="ttdeci">bool GetEval_dOF_dCX(void) const</div><div class="ttdoc">Get information about whether to use fixed CL mode.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l08722">CConfig.hpp:8722</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab33081c547f43eb27cc54852d4629dd3"><div class="ttname"><a href="classCConfig.html#ab33081c547f43eb27cc54852d4629dd3">CConfig::GetSens_Remove_Sharp</a></div><div class="ttdeci">bool GetSens_Remove_Sharp(void) const</div><div class="ttdoc">Provides information about if the sharp edges are going to be removed from the sensitivity.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05054">CConfig.hpp:5054</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab3ab2f06b6d038aea73beed05cd13448"><div class="ttname"><a href="classCConfig.html#ab3ab2f06b6d038aea73beed05cd13448">CConfig::GetOmega_Ref</a></div><div class="ttdeci">su2double GetOmega_Ref(void) const</div><div class="ttdoc">Get the value of the reference angular velocity for non-dimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01898">CConfig.hpp:1898</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab8c9c1f45950a29355be4ff357049440"><div class="ttname"><a href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">CConfig::GetMarker_All_TagBound</a></div><div class="ttdeci">string GetMarker_All_TagBound(unsigned short val_marker) const</div><div class="ttdoc">Get the index of the surface defined in the geometry file.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03355">CConfig.hpp:3355</a></div></div>
<div class="ttc" id="aclassCConfig_html_aba1a437d929fef85ee9ea86dae47925f"><div class="ttname"><a href="classCConfig.html#aba1a437d929fef85ee9ea86dae47925f">CConfig::GetKind_SlopeLimit_AdjFlow</a></div><div class="ttdeci">LIMITER GetKind_SlopeLimit_AdjFlow(void) const</div><div class="ttdoc">Get the method for limiting the spatial gradients.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l04813">CConfig.hpp:4813</a></div></div>
<div class="ttc" id="aclassCConfig_html_ac421daafab2ffc8171aba0a05ce017ab"><div class="ttname"><a href="classCConfig.html#ac421daafab2ffc8171aba0a05ce017ab">CConfig::GetAdjSharp_LimiterCoeff</a></div><div class="ttdeci">su2double GetAdjSharp_LimiterCoeff(void) const</div><div class="ttdoc">Get the value of sharp edge limiter.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l02502">CConfig.hpp:2502</a></div></div>
<div class="ttc" id="aclassCConfig_html_ace4081f7013cfe0fd756dff7d9ba7f8f"><div class="ttname"><a href="classCConfig.html#ace4081f7013cfe0fd756dff7d9ba7f8f">CConfig::GetObjFunc_Extension</a></div><div class="ttdeci">string GetObjFunc_Extension(string val_filename) const</div><div class="ttdoc">Append the input filename string with the appropriate objective function extension.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8cpp_source.html#l08453">CConfig.cpp:8453</a></div></div>
<div class="ttc" id="aclassCConfig_html_ad16f71356f146b530fb1fbb45444525c"><div class="ttname"><a href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">CConfig::GetKind_TimeIntScheme</a></div><div class="ttdeci">unsigned short GetKind_TimeIntScheme(void) const</div><div class="ttdoc">Get the kind of time integration method.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l04539">CConfig.hpp:4539</a></div></div>
<div class="ttc" id="aclassCConfig_html_ad201abca17f7635b19c11cc11b03b0ac"><div class="ttname"><a href="classCConfig.html#ad201abca17f7635b19c11cc11b03b0ac">CConfig::GetRotating_Frame</a></div><div class="ttdeci">bool GetRotating_Frame(void) const</div><div class="ttdoc">Get information about the rotational frame.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l06313">CConfig.hpp:6313</a></div></div>
<div class="ttc" id="aclassCConfig_html_adb9ce1745b78e43a916afd47c9d4e96b"><div class="ttname"><a href="classCConfig.html#adb9ce1745b78e43a916afd47c9d4e96b">CConfig::SetWeight_ObjFunc</a></div><div class="ttdeci">void SetWeight_ObjFunc(unsigned short val_obj, su2double val)</div><div class="ttdoc">Set the weight of objective function. There are several options: Drag coefficient,...</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05437">CConfig.hpp:5437</a></div></div>
<div class="ttc" id="aclassCConfig_html_ae003cd8f406eaaa91849a774c9a20730"><div class="ttname"><a href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">CConfig::GetMarker_All_KindBC</a></div><div class="ttdeci">unsigned short GetMarker_All_KindBC(unsigned short val_marker) const</div><div class="ttdoc">Get the kind of boundary for each marker.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l03431">CConfig.hpp:3431</a></div></div>
<div class="ttc" id="aclassCConfig_html_ae33781eb89184d511e23b7e247d21c8a"><div class="ttname"><a href="classCConfig.html#ae33781eb89184d511e23b7e247d21c8a">CConfig::GetVelocity_FreeStreamND</a></div><div class="ttdeci">su2double * GetVelocity_FreeStreamND(void)</div><div class="ttdoc">Get the vector of the non-dimensionalized freestream velocity.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01959">CConfig.hpp:1959</a></div></div>
<div class="ttc" id="aclassCConfig_html_ae55bdae4e8b4e61fd07a857005cc6799"><div class="ttname"><a href="classCConfig.html#ae55bdae4e8b4e61fd07a857005cc6799">CConfig::GetRestart</a></div><div class="ttdeci">bool GetRestart(void) const</div><div class="ttdoc">Provides the restart information.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l05485">CConfig.hpp:5485</a></div></div>
<div class="ttc" id="aclassCConfig_html_ae688e355a74025050498d8c03aee35b2"><div class="ttname"><a href="classCConfig.html#ae688e355a74025050498d8c03aee35b2">CConfig::GetFixed_CL_Mode</a></div><div class="ttdeci">bool GetFixed_CL_Mode(void) const</div><div class="ttdoc">Get information about whether to use fixed CL mode.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l08716">CConfig.hpp:8716</a></div></div>
<div class="ttc" id="aclassCConfig_html_aef335760724e0367ef46cd2714ce236d"><div class="ttname"><a href="classCConfig.html#aef335760724e0367ef46cd2714ce236d">CConfig::GetKind_Centered_AdjFlow</a></div><div class="ttdeci">CENTERED GetKind_Centered_AdjFlow(void) const</div><div class="ttdoc">Get the kind of center convective numerical scheme for the adjoint flow equations.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l04870">CConfig.hpp:4870</a></div></div>
<div class="ttc" id="aclassCConfig_html_af30dc08c28dd72bfcedc6a5a4e224036"><div class="ttname"><a href="classCConfig.html#af30dc08c28dd72bfcedc6a5a4e224036">CConfig::GetDensity_FreeStreamND</a></div><div class="ttdeci">su2double GetDensity_FreeStreamND(void) const</div><div class="ttdoc">Get the value of the non-dimensionalized freestream density.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01953">CConfig.hpp:1953</a></div></div>
<div class="ttc" id="aclassCConfig_html_af59700a2ce4edce862248ba52bdca025"><div class="ttname"><a href="classCConfig.html#af59700a2ce4edce862248ba52bdca025">CConfig::GetKind_Gradient_Method_Recon</a></div><div class="ttdeci">unsigned short GetKind_Gradient_Method_Recon(void) const</div><div class="ttdoc">Get the kind of method for computation of spatial gradients used for upwind reconstruction.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l04256">CConfig.hpp:4256</a></div></div>
<div class="ttc" id="aclassCConfig_html_afa49e1ce7793a31cc572d957caffaef9"><div class="ttname"><a href="classCConfig.html#afa49e1ce7793a31cc572d957caffaef9">CConfig::GetTemperature_FreeStreamND</a></div><div class="ttdeci">su2double GetTemperature_FreeStreamND(void) const</div><div class="ttdoc">Get the value of the non-dimensionalized freestream temperature.</div><div class="ttdef"><b>Definition:</b> <a href="CConfig_8hpp_source.html#l01941">CConfig.hpp:1941</a></div></div>
<div class="ttc" id="aclassCEdge_html_a4ace970590e47bd39ea5780c3e0e2037"><div class="ttname"><a href="classCEdge.html#a4ace970590e47bd39ea5780c3e0e2037">CEdge::GetNormal</a></div><div class="ttdeci">void GetNormal(unsigned long iEdge, T &amp;normal) const</div><div class="ttdoc">Copy the the normal vector of a face.</div><div class="ttdef"><b>Definition:</b> <a href="CEdge_8hpp_source.html#l00161">CEdge.hpp:161</a></div></div>
<div class="ttc" id="aclassCEdge_html_a5cd6f283cb2f3e4dfc037c0db6ae1055"><div class="ttname"><a href="classCEdge.html#a5cd6f283cb2f3e4dfc037c0db6ae1055">CEdge::GetNode</a></div><div class="ttdeci">unsigned long GetNode(unsigned long iEdge, unsigned long iNode) const</div><div class="ttdoc">Get left/right node index defining the edge.</div><div class="ttdef"><b>Definition:</b> <a href="CEdge_8hpp_source.html#l00072">CEdge.hpp:72</a></div></div>
<div class="ttc" id="aclassCGeometry_html"><div class="ttname"><a href="classCGeometry.html">CGeometry</a></div><div class="ttdoc">Parent class for defining the geometry of the problem (complete geometry, multigrid agglomerated geom...</div><div class="ttdef"><b>Definition:</b> <a href="CGeometry_8hpp_source.html#l00075">CGeometry.hpp:75</a></div></div>
<div class="ttc" id="aclassCGeometry_html_a275fb07cd99ab79d7a04b4862280169d"><div class="ttname"><a href="classCGeometry.html#a275fb07cd99ab79d7a04b4862280169d">CGeometry::GetnPoint</a></div><div class="ttdeci">unsigned long GetnPoint() const</div><div class="ttdoc">Get number of points.</div><div class="ttdef"><b>Definition:</b> <a href="CGeometry_8hpp_source.html#l00466">CGeometry.hpp:466</a></div></div>
<div class="ttc" id="aclassCGeometry_html_a3513d08c59b4d166078ca7a9e65c8112"><div class="ttname"><a href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">CGeometry::nodes</a></div><div class="ttdeci">CPoint * nodes</div><div class="ttdoc">Node vector (dual grid information).</div><div class="ttdef"><b>Definition:</b> <a href="CGeometry_8hpp_source.html#l00235">CGeometry.hpp:235</a></div></div>
<div class="ttc" id="aclassCGeometry_html_a6c5ff184cfb3b1e983b1f2abee098675"><div class="ttname"><a href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">CGeometry::vertex</a></div><div class="ttdeci">CVertex *** vertex</div><div class="ttdoc">Boundary Vertex vector (dual grid information).</div><div class="ttdef"><b>Definition:</b> <a href="CGeometry_8hpp_source.html#l00237">CGeometry.hpp:237</a></div></div>
<div class="ttc" id="aclassCGeometry_html_aba89cceede61b33426b2783385431f5b"><div class="ttname"><a href="classCGeometry.html#aba89cceede61b33426b2783385431f5b">CGeometry::GetnEdge</a></div><div class="ttdeci">unsigned long GetnEdge() const</div><div class="ttdoc">Get number of edges.</div><div class="ttdef"><b>Definition:</b> <a href="CGeometry_8hpp_source.html#l00496">CGeometry.hpp:496</a></div></div>
<div class="ttc" id="aclassCGeometry_html_ac84179060bbac1fe5e856ea3da850b6e"><div class="ttname"><a href="classCGeometry.html#ac84179060bbac1fe5e856ea3da850b6e">CGeometry::GetnPointDomain</a></div><div class="ttdeci">unsigned long GetnPointDomain() const</div><div class="ttdoc">Get number of real points (that belong to the domain).</div><div class="ttdef"><b>Definition:</b> <a href="CGeometry_8hpp_source.html#l00472">CGeometry.hpp:472</a></div></div>
<div class="ttc" id="aclassCGeometry_html_ace7f7fe876f629f5bd5f92d4805a1a4b"><div class="ttname"><a href="classCGeometry.html#ace7f7fe876f629f5bd5f92d4805a1a4b">CGeometry::GetnDim</a></div><div class="ttdeci">unsigned short GetnDim() const</div><div class="ttdoc">Get number of coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="CGeometry_8hpp_source.html#l00454">CGeometry.hpp:454</a></div></div>
<div class="ttc" id="aclassCGeometry_html_ad3786f48d61e374f2da254781de1b7c7"><div class="ttname"><a href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">CGeometry::edges</a></div><div class="ttdeci">CEdge * edges</div><div class="ttdoc">Edge vector (dual grid information).</div><div class="ttdef"><b>Definition:</b> <a href="CGeometry_8hpp_source.html#l00236">CGeometry.hpp:236</a></div></div>
<div class="ttc" id="aclassCGeometry_html_aeba95cec237839c5b08f0f5fbe0d9fd9"><div class="ttname"><a href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">CGeometry::nVertex</a></div><div class="ttdeci">unsigned long * nVertex</div><div class="ttdoc">Number of vertex for each marker.</div><div class="ttdef"><b>Definition:</b> <a href="CGeometry_8hpp_source.html#l00240">CGeometry.hpp:240</a></div></div>
<div class="ttc" id="aclassCNumerics_html"><div class="ttname"><a href="classCNumerics.html">CNumerics</a></div><div class="ttdoc">Class for defining the numerical methods.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00047">CNumerics.hpp:47</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a028c500ba7ce96d3af061fc8218f76f1"><div class="ttname"><a href="classCNumerics.html#a028c500ba7ce96d3af061fc8218f76f1">CNumerics::SetPrimitive</a></div><div class="ttdeci">void SetPrimitive(const su2double *val_v_i, const su2double *val_v_j)</div><div class="ttdoc">Set the value of the primitive variables.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00285">CNumerics.hpp:285</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a0d3d722905b8615ef2cb5d59c4b95fb3"><div class="ttname"><a href="classCNumerics.html#a0d3d722905b8615ef2cb5d59c4b95fb3">CNumerics::SetLaminarViscosity</a></div><div class="ttdeci">void SetLaminarViscosity(su2double val_laminar_viscosity_i, su2double val_laminar_viscosity_j)</div><div class="ttdoc">Set the laminar viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00759">CNumerics.hpp:759</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a18b6238c38e05339954c0bb6121203d1"><div class="ttname"><a href="classCNumerics.html#a18b6238c38e05339954c0bb6121203d1">CNumerics::ComputeStressTensor</a></div><div class="ttdeci">static void ComputeStressTensor(size_t nDim, Mat1 &amp;stress, const Mat2 &amp;velgrad, Scalar viscosity, Scalar density=0.0, Scalar turb_ke=0.0, bool reynolds3x3=false)</div><div class="ttdoc">Compute the stress tensor from the velocity gradients.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00478">CNumerics.hpp:478</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a254b157377df5d326d24ee75e6e3676c"><div class="ttname"><a href="classCNumerics.html#a254b157377df5d326d24ee75e6e3676c">CNumerics::SetAdjointVarGradient</a></div><div class="ttdeci">void SetAdjointVarGradient(CMatrixView&lt; const su2double &gt; val_psivar_grad_i, CMatrixView&lt; const su2double &gt; val_psivar_grad_j)</div><div class="ttdoc">Set the gradient of the adjoint variables.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00343">CNumerics.hpp:343</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a2d59a0969bac4b0e43b74ba4ec4d1eff"><div class="ttname"><a href="classCNumerics.html#a2d59a0969bac4b0e43b74ba4ec4d1eff">CNumerics::SetConservative</a></div><div class="ttdeci">void SetConservative(const su2double *val_u_i, const su2double *val_u_j)</div><div class="ttdoc">Set the value of the conservative variables.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00275">CNumerics.hpp:275</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a3466f25da2e4c85318ee663b2d2cb1bb"><div class="ttname"><a href="classCNumerics.html#a3466f25da2e4c85318ee663b2d2cb1bb">CNumerics::SetTurbAdjointGradient</a></div><div class="ttdeci">void SetTurbAdjointGradient(CMatrixView&lt; const su2double &gt; val_turbpsivar_grad_i, CMatrixView&lt; const su2double &gt; val_turbpsivar_grad_j)</div><div class="ttdoc">Set the gradient of the adjoint turbulent variables.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00414">CNumerics.hpp:414</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a49309c657274b77aa644958053b68bf4"><div class="ttname"><a href="classCNumerics.html#a49309c657274b77aa644958053b68bf4">CNumerics::SetPrimVarGradient</a></div><div class="ttdeci">void SetPrimVarGradient(CMatrixView&lt; const su2double &gt; val_primvar_grad_i, CMatrixView&lt; const su2double &gt; val_primvar_grad_j)</div><div class="ttdoc">Set the gradient of the primitive variables.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00322">CNumerics.hpp:322</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a53c24228ba235c1a0c2e4509243e5e88"><div class="ttname"><a href="classCNumerics.html#a53c24228ba235c1a0c2e4509243e5e88">CNumerics::SetVolume</a></div><div class="ttdeci">void SetVolume(su2double val_volume)</div><div class="ttdoc">Set the value of the volume of the control volume.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00961">CNumerics.hpp:961</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a6ca4a8e17d68ea63f1dba96cd5f2967d"><div class="ttname"><a href="classCNumerics.html#a6ca4a8e17d68ea63f1dba96cd5f2967d">CNumerics::SetCoord</a></div><div class="ttdeci">void SetCoord(const su2double *val_coord_i, const su2double *val_coord_j)</div><div class="ttdoc">Set coordinates of the points.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00846">CNumerics.hpp:846</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a6e1c4dea51983cbe489762bd43bae41d"><div class="ttname"><a href="classCNumerics.html#a6e1c4dea51983cbe489762bd43bae41d">CNumerics::SetScalarVar</a></div><div class="ttdeci">void SetScalarVar(const su2double *val_scalarvar_i, const su2double *val_scalarvar_j)</div><div class="ttdoc">Set the value of the scalar variable.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00354">CNumerics.hpp:354</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a7a305597659a44840687afc1c1e0da6b"><div class="ttname"><a href="classCNumerics.html#a7a305597659a44840687afc1c1e0da6b">CNumerics::SetAdjointVar</a></div><div class="ttdeci">void SetAdjointVar(const su2double *val_psi_i, const su2double *val_psi_j)</div><div class="ttdoc">Set the value of the adjoint variable.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00333">CNumerics.hpp:333</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a8c5ce8e8a1cb2c0bb03bf408d9a80d68"><div class="ttname"><a href="classCNumerics.html#a8c5ce8e8a1cb2c0bb03bf408d9a80d68">CNumerics::SetScalarVarGradient</a></div><div class="ttdeci">void SetScalarVarGradient(CMatrixView&lt; const su2double &gt; val_scalarvar_grad_i, CMatrixView&lt; const su2double &gt; val_scalarvar_grad_j)</div><div class="ttdoc">Set the gradient of the scalar variables.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00374">CNumerics.hpp:374</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a93fd2262832ae5081317548f2f9cdbb3"><div class="ttname"><a href="classCNumerics.html#a93fd2262832ae5081317548f2f9cdbb3">CNumerics::SetNormal</a></div><div class="ttdeci">void SetNormal(const su2double *val_normal)</div><div class="ttdoc">Set the value of the normal vector to the face between two points.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00955">CNumerics.hpp:955</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a9c9dd8be231884769f29c799db2404be"><div class="ttname"><a href="classCNumerics.html#a9c9dd8be231884769f29c799db2404be">CNumerics::SetDistance</a></div><div class="ttdeci">void SetDistance(su2double val_dist_i, su2double val_dist_j)</div><div class="ttdoc">Set the value of the distance from the nearest wall.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00826">CNumerics.hpp:826</a></div></div>
<div class="ttc" id="aclassCNumerics_html_aa0ca13663a047ef2640b377b33875e29"><div class="ttname"><a href="classCNumerics.html#aa0ca13663a047ef2640b377b33875e29">CNumerics::ComputeResidual</a></div><div class="ttdeci">virtual void ComputeResidual(su2double *val_residual, CConfig *config)</div><div class="ttdoc">Compute the numerical residual.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l01286">CNumerics.hpp:1286</a></div></div>
<div class="ttc" id="aclassCNumerics_html_aaf211e0fafb2ffea485a888cc5a3a725"><div class="ttname"><a href="classCNumerics.html#aaf211e0fafb2ffea485a888cc5a3a725">CNumerics::SetTurbAdjointVar</a></div><div class="ttdeci">void SetTurbAdjointVar(const su2double *val_turbpsivar_i, const su2double *val_turbpsivar_j)</div><div class="ttdoc">Set the value of the adjoint turbulent variable.</div><div class="ttdef"><b>Definition:</b> <a href="CNumerics_8hpp_source.html#l00404">CNumerics.hpp:404</a></div></div>
<div class="ttc" id="aclassCPoint_html_a1024c8b8a4b750b16f77465d4060d152"><div class="ttname"><a href="classCPoint.html#a1024c8b8a4b750b16f77465d4060d152">CPoint::GetGridVel_Grad</a></div><div class="ttdeci">CVectorOfMatrix &amp; GetGridVel_Grad()</div><div class="ttdoc">Get the grid velocity gradients for the entire domain.</div><div class="ttdef"><b>Definition:</b> <a href="CPoint_8hpp_source.html#l00849">CPoint.hpp:849</a></div></div>
<div class="ttc" id="aclassCPoint_html_a35a504401472dfa76ef1187a5675414f"><div class="ttname"><a href="classCPoint.html#a35a504401472dfa76ef1187a5675414f">CPoint::GetVolume</a></div><div class="ttdeci">su2double &amp; GetVolume(unsigned long iPoint)</div><div class="ttdoc">Get area or volume of the control volume.</div><div class="ttdef"><b>Definition:</b> <a href="CPoint_8hpp_source.html#l00557">CPoint.hpp:557</a></div></div>
<div class="ttc" id="aclassCPoint_html_a65d855a9c2ad2971546038b34acd5b92"><div class="ttname"><a href="classCPoint.html#a65d855a9c2ad2971546038b34acd5b92">CPoint::GetGridVel</a></div><div class="ttdeci">su2double * GetGridVel(unsigned long iPoint)</div><div class="ttdoc">Get the value of the grid velocity at the point.</div><div class="ttdef"><b>Definition:</b> <a href="CPoint_8hpp_source.html#l00820">CPoint.hpp:820</a></div></div>
<div class="ttc" id="aclassCPoint_html_a8610d0fe0bf651b7036be5b3a6e1c130"><div class="ttname"><a href="classCPoint.html#a8610d0fe0bf651b7036be5b3a6e1c130">CPoint::GetSharpEdge_Distance</a></div><div class="ttdeci">su2double &amp; GetSharpEdge_Distance(unsigned long iPoint)</div><div class="ttdoc">Get the value of the distance to a sharp edge.</div><div class="ttdef"><b>Definition:</b> <a href="CPoint_8hpp_source.html#l00521">CPoint.hpp:521</a></div></div>
<div class="ttc" id="aclassCPoint_html_aa58a27b602e47ddcad22ae74a5c6bc81"><div class="ttname"><a href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">CPoint::GetDomain</a></div><div class="ttdeci">bool GetDomain(unsigned long iPoint) const</div><div class="ttdoc">For parallel computation, its indicates if a point must be computed or not.</div><div class="ttdef"><b>Definition:</b> <a href="CPoint_8hpp_source.html#l00423">CPoint.hpp:423</a></div></div>
<div class="ttc" id="aclassCPoint_html_ab16c29dd03911529cd73bf467c313179"><div class="ttname"><a href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">CPoint::GetCoord</a></div><div class="ttdeci">su2double GetCoord(unsigned long iPoint, unsigned long iDim) const</div><div class="ttdoc">Get the coordinates dor the control volume.</div><div class="ttdef"><b>Definition:</b> <a href="CPoint_8hpp_source.html#l00158">CPoint.hpp:158</a></div></div>
<div class="ttc" id="aclassCPoint_html_ac4bc76884771541056fd8b0471c161d2"><div class="ttname"><a href="classCPoint.html#ac4bc76884771541056fd8b0471c161d2">CPoint::GetWall_Distance</a></div><div class="ttdeci">su2double &amp; GetWall_Distance(unsigned long iPoint)</div><div class="ttdoc">Get the value of the distance to the nearest wall.</div><div class="ttdef"><b>Definition:</b> <a href="CPoint_8hpp_source.html#l00492">CPoint.hpp:492</a></div></div>
<div class="ttc" id="aclassCSolver_html"><div class="ttname"><a href="classCSolver.html">CSolver</a></div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00066">CSolver.hpp:66</a></div></div>
<div class="ttc" id="aclassCSolver_html_a0b5af72c2c107a4c6831dc6df1b83881"><div class="ttname"><a href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">CSolver::Jacobian</a></div><div class="ttdeci">CSysMatrix&lt; su2mixedfloat &gt; Jacobian</div><div class="ttdoc">Complete sparse Jacobian structure for implicit computations.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00194">CSolver.hpp:194</a></div></div>
<div class="ttc" id="aclassCSolver_html_a0ff55af7303be290661b65f60a037a42"><div class="ttname"><a href="classCSolver.html#a0ff55af7303be290661b65f60a037a42">CSolver::Jacobian_jj</a></div><div class="ttdeci">su2double ** Jacobian_jj</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00129">CSolver.hpp:129</a></div></div>
<div class="ttc" id="aclassCSolver_html_a11fe70fe56043dd44dd79b7d9aa358f0"><div class="ttname"><a href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">CSolver::Jacobian_j</a></div><div class="ttdeci">su2double ** Jacobian_j</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians at point j.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00125">CSolver.hpp:125</a></div></div>
<div class="ttc" id="aclassCSolver_html_a167cf81a9f3a29dc176728cb033185a4"><div class="ttname"><a href="classCSolver.html#a167cf81a9f3a29dc176728cb033185a4">CSolver::Point_Max_Coord</a></div><div class="ttdeci">su2activematrix Point_Max_Coord</div><div class="ttdoc">Vector with pointers to the coords of the maximal residual for each variable.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00100">CSolver.hpp:100</a></div></div>
<div class="ttc" id="aclassCSolver_html_a1d6e05a7a904684360013dff7b241be6"><div class="ttname"><a href="classCSolver.html#a1d6e05a7a904684360013dff7b241be6">CSolver::Residual_j</a></div><div class="ttdeci">su2double * Residual_j</div><div class="ttdoc">Auxiliary nVar vector for storing the residual at point j.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00110">CSolver.hpp:110</a></div></div>
<div class="ttc" id="aclassCSolver_html_a203241aa245597347fb258fac60962f6"><div class="ttname"><a href="classCSolver.html#a203241aa245597347fb258fac60962f6">CSolver::nDim</a></div><div class="ttdeci">unsigned short nDim</div><div class="ttdoc">Number of dimensions of the problem.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00086">CSolver.hpp:86</a></div></div>
<div class="ttc" id="aclassCSolver_html_a223a1270fee36d9c742e806a47b0ffb3"><div class="ttname"><a href="classCSolver.html#a223a1270fee36d9c742e806a47b0ffb3">CSolver::Jacobian_i</a></div><div class="ttdeci">su2double ** Jacobian_i</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians at point i.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00124">CSolver.hpp:124</a></div></div>
<div class="ttc" id="aclassCSolver_html_a287c7f92e934ae07a3b772c0752142e7"><div class="ttname"><a href="classCSolver.html#a287c7f92e934ae07a3b772c0752142e7">CSolver::SetGridVel_Gradient</a></div><div class="ttdeci">void SetGridVel_Gradient(CGeometry *geometry, const CConfig *config) const</div><div class="ttdoc">Compute the Least Squares gradient of the grid velocity.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8cpp_source.html#l02245">CSolver.cpp:2245</a></div></div>
<div class="ttc" id="aclassCSolver_html_a313f866523cd6bed20eb620faee4b73a"><div class="ttname"><a href="classCSolver.html#a313f866523cd6bed20eb620faee4b73a">CSolver::Residual_i</a></div><div class="ttdeci">su2double * Residual_i</div><div class="ttdoc">Auxiliary nVar vector for storing the residual at point i.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00109">CSolver.hpp:109</a></div></div>
<div class="ttc" id="aclassCSolver_html_a37691f1bd6dc4fe9f28ae511b0def484"><div class="ttname"><a href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">CSolver::Jacobian_ii</a></div><div class="ttdeci">su2double ** Jacobian_ii</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00126">CSolver.hpp:126</a></div></div>
<div class="ttc" id="aclassCSolver_html_a3912ec3b77bf15b77790be7399f4fa53"><div class="ttname"><a href="classCSolver.html#a3912ec3b77bf15b77790be7399f4fa53">CSolver::CompleteComms</a></div><div class="ttdeci">void CompleteComms(CGeometry *geometry, const CConfig *config, MPI_QUANTITIES commType)</div><div class="ttdoc">Routine to complete the set of non-blocking communications launched by InitiateComms() and unpacking ...</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8cpp_source.html#l01548">CSolver.cpp:1548</a></div></div>
<div class="ttc" id="aclassCSolver_html_a3a9516a882682f02bd9ab15d209740e5"><div class="ttname"><a href="classCSolver.html#a3a9516a882682f02bd9ab15d209740e5">CSolver::GetTotal_HeatFlux</a></div><div class="ttdeci">virtual su2double GetTotal_HeatFlux() const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l02211">CSolver.hpp:2211</a></div></div>
<div class="ttc" id="aclassCSolver_html_a3f318bceaa27f4800de8ecf2cdcae5fb"><div class="ttname"><a href="classCSolver.html#a3f318bceaa27f4800de8ecf2cdcae5fb">CSolver::LinSysSol</a></div><div class="ttdeci">CSysVector&lt; su2double &gt; LinSysSol</div><div class="ttdoc">vector to store iterative solution of implicit linear system.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00191">CSolver.hpp:191</a></div></div>
<div class="ttc" id="aclassCSolver_html_a403c73150cc7c99c43763238c1005242"><div class="ttname"><a href="classCSolver.html#a403c73150cc7c99c43763238c1005242">CSolver::Res_Conv_i</a></div><div class="ttdeci">su2double * Res_Conv_i</div><div class="ttdoc">Auxiliary vector for storing the convective residual at point i.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00120">CSolver.hpp:120</a></div></div>
<div class="ttc" id="aclassCSolver_html_a515af1055f70b894174566926ae3cae2"><div class="ttname"><a href="classCSolver.html#a515af1055f70b894174566926ae3cae2">CSolver::nPoint</a></div><div class="ttdeci">unsigned long nPoint</div><div class="ttdoc">Number of points of the computational grid.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00087">CSolver.hpp:87</a></div></div>
<div class="ttc" id="aclassCSolver_html_a56fdcd670654dd632a847c70d4b42597"><div class="ttname"><a href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">CSolver::Res_Visc_i</a></div><div class="ttdeci">su2double * Res_Visc_i</div><div class="ttdoc">Auxiliary vector for storing the viscous residual at point i.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00121">CSolver.hpp:121</a></div></div>
<div class="ttc" id="aclassCSolver_html_a59168ff9a35447672e6ee77cf4bcb1ec"><div class="ttname"><a href="classCSolver.html#a59168ff9a35447672e6ee77cf4bcb1ec">CSolver::SetTime_Step</a></div><div class="ttdeci">virtual void SetTime_Step(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, unsigned long Iteration)</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00607">CSolver.hpp:607</a></div></div>
<div class="ttc" id="aclassCSolver_html_a59da1efb04d4d6cb0627b61005ff3ed5"><div class="ttname"><a href="classCSolver.html#a59da1efb04d4d6cb0627b61005ff3ed5">CSolver::Residual_Max</a></div><div class="ttdeci">vector&lt; su2double &gt; Residual_Max</div><div class="ttdoc">Vector with the maximal residual for each variable.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00095">CSolver.hpp:95</a></div></div>
<div class="ttc" id="aclassCSolver_html_a5c2921b0edd0eec84882c328a740904a"><div class="ttname"><a href="classCSolver.html#a5c2921b0edd0eec84882c328a740904a">CSolver::rank</a></div><div class="ttdeci">int rank</div><div class="ttdoc">MPI Rank.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00070">CSolver.hpp:70</a></div></div>
<div class="ttc" id="aclassCSolver_html_a65af02f97fcf03a0f44c15dbb48522b9"><div class="ttname"><a href="classCSolver.html#a65af02f97fcf03a0f44c15dbb48522b9">CSolver::SetSolution_Gradient_LS</a></div><div class="ttdeci">void SetSolution_Gradient_LS(CGeometry *geometry, const CConfig *config, short idxVel, bool reconstruction=false)</div><div class="ttdoc">Compute the Least Squares gradient of the solution.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8cpp_source.html#l02135">CSolver.cpp:2135</a></div></div>
<div class="ttc" id="aclassCSolver_html_a69bc3df96cdb96a8b25b788118c4fcc9"><div class="ttname"><a href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">CSolver::nVar</a></div><div class="ttdeci">unsigned short nVar</div><div class="ttdoc">Number of variables of the problem.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00080">CSolver.hpp:80</a></div></div>
<div class="ttc" id="aclassCSolver_html_a6bc3916452ffa54c2436de7bb627fefa"><div class="ttname"><a href="classCSolver.html#a6bc3916452ffa54c2436de7bb627fefa">CSolver::SetSolution_Limiter</a></div><div class="ttdeci">void SetSolution_Limiter(CGeometry *geometry, const CConfig *config)</div><div class="ttdoc">Compute slope limiter.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8cpp_source.html#l02257">CSolver.cpp:2257</a></div></div>
<div class="ttc" id="aclassCSolver_html_a75021726ee9fbb9262ffea01e989237a"><div class="ttname"><a href="classCSolver.html#a75021726ee9fbb9262ffea01e989237a">CSolver::Res_Visc_j</a></div><div class="ttdeci">su2double * Res_Visc_j</div><div class="ttdoc">Auxiliary vector for storing the viscous residual at point j.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00123">CSolver.hpp:123</a></div></div>
<div class="ttc" id="aclassCSolver_html_a750e8a00ec7b8b41ff51c91fc4e35fe8"><div class="ttname"><a href="classCSolver.html#a750e8a00ec7b8b41ff51c91fc4e35fe8">CSolver::SetSolution_Gradient_GG</a></div><div class="ttdeci">void SetSolution_Gradient_GG(CGeometry *geometry, const CConfig *config, short idxVel, bool reconstruction=false)</div><div class="ttdoc">Compute the Green-Gauss gradient of the solution.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8cpp_source.html#l02126">CSolver.cpp:2126</a></div></div>
<div class="ttc" id="aclassCSolver_html_a7be1f967f5d31417059fbbaf88d55309"><div class="ttname"><a href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">CSolver::LinSysRes</a></div><div class="ttdeci">CSysVector&lt; su2double &gt; LinSysRes</div><div class="ttdoc">vector to store iterative residual of implicit linear system.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00192">CSolver.hpp:192</a></div></div>
<div class="ttc" id="aclassCSolver_html_a9958742a687a4c92d0bf1ead78aa1a0c"><div class="ttname"><a href="classCSolver.html#a9958742a687a4c92d0bf1ead78aa1a0c">CSolver::Solution</a></div><div class="ttdeci">su2double * Solution</div><div class="ttdoc">Auxiliary nVar vector.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00111">CSolver.hpp:111</a></div></div>
<div class="ttc" id="aclassCSolver_html_a9cbdd9cf3215a07fe59433fc9504a3bb"><div class="ttname"><a href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">CSolver::nPointDomain</a></div><div class="ttdeci">unsigned long nPointDomain</div><div class="ttdoc">Number of points of the computational grid.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00088">CSolver.hpp:88</a></div></div>
<div class="ttc" id="aclassCSolver_html_aa3e97145d1cf5b3803df5ac763eca2fc"><div class="ttname"><a href="classCSolver.html#aa3e97145d1cf5b3803df5ac763eca2fc">CSolver::Solution_j</a></div><div class="ttdeci">su2double * Solution_j</div><div class="ttdoc">Auxiliary nVar vector for storing the solution at point j.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00113">CSolver.hpp:113</a></div></div>
<div class="ttc" id="aclassCSolver_html_aa4d789119564e1489b48763e0f7cdeee"><div class="ttname"><a href="classCSolver.html#aa4d789119564e1489b48763e0f7cdeee">CSolver::Solution_i</a></div><div class="ttdeci">su2double * Solution_i</div><div class="ttdoc">Auxiliary nVar vector for storing the solution at point i.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00112">CSolver.hpp:112</a></div></div>
<div class="ttc" id="aclassCSolver_html_aab651e902cb3020b525c154cb76c4264"><div class="ttname"><a href="classCSolver.html#aab651e902cb3020b525c154cb76c4264">CSolver::InitiateComms</a></div><div class="ttdeci">void InitiateComms(CGeometry *geometry, const CConfig *config, MPI_QUANTITIES commType)</div><div class="ttdoc">Routine to load a solver quantity into the data structures for MPI point-to-point communication and t...</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8cpp_source.html#l01406">CSolver.cpp:1406</a></div></div>
<div class="ttc" id="aclassCSolver_html_ac2b7eb546780ee9e5aa95ca88562699d"><div class="ttname"><a href="classCSolver.html#ac2b7eb546780ee9e5aa95ca88562699d">CSolver::Residual_RMS</a></div><div class="ttdeci">vector&lt; su2double &gt; Residual_RMS</div><div class="ttdoc">Vector with the mean residual for each variable.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00094">CSolver.hpp:94</a></div></div>
<div class="ttc" id="aclassCSolver_html_ad982896202dae6e41bfd3568f597cf46"><div class="ttname"><a href="classCSolver.html#ad982896202dae6e41bfd3568f597cf46">CSolver::SetBaseClassPointerToNodes</a></div><div class="ttdeci">void SetBaseClassPointerToNodes()</div><div class="ttdoc">Call this method to set &quot;base_nodes&quot; after the &quot;nodes&quot; variable of the derived solver is instantiated...</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00165">CSolver.hpp:165</a></div></div>
<div class="ttc" id="aclassCSolver_html_adbb9d8927623f02c779ad6fe07fe44ff"><div class="ttname"><a href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">CSolver::Residual</a></div><div class="ttdeci">su2double * Residual</div><div class="ttdoc">Auxiliary nVar vector.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00108">CSolver.hpp:108</a></div></div>
<div class="ttc" id="aclassCSolver_html_ae31efca489e7d21f78b5c63c7c353134"><div class="ttname"><a href="classCSolver.html#ae31efca489e7d21f78b5c63c7c353134">CSolver::Jacobian_ij</a></div><div class="ttdeci">su2double ** Jacobian_ij</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00127">CSolver.hpp:127</a></div></div>
<div class="ttc" id="aclassCSolver_html_ae9fa6bf0e3ef0dff07dd85e0a87eef4d"><div class="ttname"><a href="classCSolver.html#ae9fa6bf0e3ef0dff07dd85e0a87eef4d">CSolver::SetUndivided_Laplacian</a></div><div class="ttdeci">void SetUndivided_Laplacian(CGeometry *geometry, const CConfig *config)</div><div class="ttdoc">Compute the undivided laplacian for the solution variables.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8cpp_source.html#l02158">CSolver.cpp:2158</a></div></div>
<div class="ttc" id="aclassCSolver_html_aea78ca4418d89965bfe052196a360389"><div class="ttname"><a href="classCSolver.html#aea78ca4418d89965bfe052196a360389">CSolver::Res_Conv_j</a></div><div class="ttdeci">su2double * Res_Conv_j</div><div class="ttdoc">Auxiliary vector for storing the convective residual at point j.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00122">CSolver.hpp:122</a></div></div>
<div class="ttc" id="aclassCSolver_html_aeca105abe8a547328e2b1a320708b226"><div class="ttname"><a href="classCSolver.html#aeca105abe8a547328e2b1a320708b226">CSolver::Jacobian_ji</a></div><div class="ttdeci">su2double ** Jacobian_ji</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00128">CSolver.hpp:128</a></div></div>
<div class="ttc" id="aclassCSolver_html_af3198e52a2ea377bb765647b5e697197"><div class="ttname"><a href="classCSolver.html#af3198e52a2ea377bb765647b5e697197">CSolver::GetNodes</a></div><div class="ttdeci">CVariable * GetNodes()</div><div class="ttdoc">Allow outside access to the nodes of the solver, containing conservatives, primitives,...</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00226">CSolver.hpp:226</a></div></div>
<div class="ttc" id="aclassCSolver_html_af333279175711dc23f668300c357bd5c"><div class="ttname"><a href="classCSolver.html#af333279175711dc23f668300c357bd5c">CSolver::Point_Max</a></div><div class="ttdeci">vector&lt; unsigned long &gt; Point_Max</div><div class="ttdoc">Vector with the maximal residual for each variable.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00098">CSolver.hpp:98</a></div></div>
<div class="ttc" id="aclassCSolver_html_af494e3d4d3cda6635e6b55da05de9662"><div class="ttname"><a href="classCSolver.html#af494e3d4d3cda6635e6b55da05de9662">CSolver::Vector_i</a></div><div class="ttdeci">su2double * Vector_i</div><div class="ttdoc">Auxiliary nDim vector to do the reconstruction of the variables at point i.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00115">CSolver.hpp:115</a></div></div>
<div class="ttc" id="aclassCSolver_html_af6b2525dd5f8326b7b72f51c5f749b30"><div class="ttname"><a href="classCSolver.html#af6b2525dd5f8326b7b72f51c5f749b30">CSolver::Vector_j</a></div><div class="ttdeci">su2double * Vector_j</div><div class="ttdoc">Auxiliary nDim vector to do the reconstruction of the variables at point j.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00116">CSolver.hpp:116</a></div></div>
<div class="ttc" id="aclassCSolver_html_af8dc930f3b6fc31ecf48d2294baf9d5f"><div class="ttname"><a href="classCSolver.html#af8dc930f3b6fc31ecf48d2294baf9d5f">CSolver::nVarGrad</a></div><div class="ttdeci">unsigned short nVarGrad</div><div class="ttdoc">Number of variables for deallocating the LS Cvector.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00085">CSolver.hpp:85</a></div></div>
<div class="ttc" id="aclassCSolver_html_afb56deafa3cb78f8b32ccc88e5f7f873"><div class="ttname"><a href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">CSolver::nMarker</a></div><div class="ttdeci">unsigned long nMarker</div><div class="ttdoc">Total number of markers using the grid information.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00141">CSolver.hpp:141</a></div></div>
<div class="ttc" id="aclassCSolver_html_afb69ab045d3dd03f45e013d448c3cea3"><div class="ttname"><a href="classCSolver.html#afb69ab045d3dd03f45e013d448c3cea3">CSolver::adjoint</a></div><div class="ttdeci">bool adjoint</div><div class="ttdoc">Boolean to determine whether solver is initialized as a direct or an adjoint solver.</div><div class="ttdef"><b>Definition:</b> <a href="CSolver_8hpp_source.html#l00072">CSolver.hpp:72</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_a03a189a2120be05e21fbd9b120549427"><div class="ttname"><a href="classCSysMatrix.html#a03a189a2120be05e21fbd9b120549427">CSysMatrix::AddBlock</a></div><div class="ttdeci">void AddBlock(unsigned long block_i, unsigned long block_j, const OtherType *val_block, OtherType alpha=1.0)</div><div class="ttdoc">Add a scaled block (in flat format) to the sparse matrix (see SetBlock).</div><div class="ttdef"><b>Definition:</b> <a href="CSysMatrix_8hpp_source.html#l00458">CSysMatrix.hpp:458</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_a423b77066cf386dd6e4b95a656e4aadb"><div class="ttname"><a href="classCSysMatrix.html#a423b77066cf386dd6e4b95a656e4aadb">CSysMatrix::SubtractBlock2Diag</a></div><div class="ttdeci">void SubtractBlock2Diag(unsigned long block_i, const OtherType &amp;val_block)</div><div class="ttdoc">Short-hand to AddBlock2Diag with alpha = -1, i.e. subtracts from the current diagonal.</div><div class="ttdef"><b>Definition:</b> <a href="CSysMatrix_8hpp_source.html#l00747">CSysMatrix.hpp:747</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_a5a4ef7eeb7f009450f575660108ed7be"><div class="ttname"><a href="classCSysMatrix.html#a5a4ef7eeb7f009450f575660108ed7be">CSysMatrix::AddBlock2Diag</a></div><div class="ttdeci">void AddBlock2Diag(unsigned long block_i, const OtherType &amp;val_block, T alpha=1.0)</div><div class="ttdoc">Non overwrite version of SetBlock2Diag, also with scaling.</div><div class="ttdef"><b>Definition:</b> <a href="CSysMatrix_8hpp_source.html#l00739">CSysMatrix.hpp:739</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_a8f974ad2e089dccfc99ea21a4ef5a819"><div class="ttname"><a href="classCSysMatrix.html#a8f974ad2e089dccfc99ea21a4ef5a819">CSysMatrix::SetValZero</a></div><div class="ttdeci">void SetValZero(void)</div><div class="ttdoc">Sets to zero all the entries of the sparse matrix.</div><div class="ttdef"><b>Definition:</b> <a href="CSysMatrix_8cpp_source.html#l00457">CSysMatrix.cpp:457</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_a9473b0224c9b9a2749571db0bbd22a70"><div class="ttname"><a href="classCSysMatrix.html#a9473b0224c9b9a2749571db0bbd22a70">CSysMatrix::DeleteValsRowi</a></div><div class="ttdeci">void DeleteValsRowi(unsigned long i)</div><div class="ttdoc">Deletes the values of the row i of the sparse matrix.</div><div class="ttdef"><b>Definition:</b> <a href="CSysMatrix_8cpp_source.html#l00553">CSysMatrix.cpp:553</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_aaa63a679856fad3b4e76f9085b0ca40f"><div class="ttname"><a href="classCSysMatrix.html#aaa63a679856fad3b4e76f9085b0ca40f">CSysMatrix::SubtractBlock</a></div><div class="ttdeci">void SubtractBlock(unsigned long block_i, unsigned long block_j, const OtherType *const *val_block)</div><div class="ttdoc">Subtracts the specified block to the sparse matrix (see AddBlock).</div><div class="ttdef"><b>Definition:</b> <a href="CSysMatrix_8hpp_source.html#l00504">CSysMatrix.hpp:504</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_ae17220ac30c2abcc7fdd3c5dc8f04571"><div class="ttname"><a href="classCSysMatrix.html#ae17220ac30c2abcc7fdd3c5dc8f04571">CSysMatrix::Initialize</a></div><div class="ttdeci">void Initialize(unsigned long npoint, unsigned long npointdomain, unsigned short nvar, unsigned short neqn, bool EdgeConnect, CGeometry *geometry, const CConfig *config, bool needTranspPtr=false, bool grad_mode=false)</div><div class="ttdoc">Initializes the sparse matrix.</div><div class="ttdef"><b>Definition:</b> <a href="CSysMatrix_8cpp_source.html#l00080">CSysMatrix.cpp:80</a></div></div>
<div class="ttc" id="aclassCSysVector_html_a71ea6ec1ebdb77535b976bb40e7659a6"><div class="ttname"><a href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">CSysVector::SubtractBlock</a></div><div class="ttdeci">void SubtractBlock(unsigned long iPoint, const VectorType &amp;block)</div><div class="ttdoc">Subtract &quot;block&quot; from the vector, see AddBlock.</div><div class="ttdef"><b>Definition:</b> <a href="CSysVector_8hpp_source.html#l00385">CSysVector.hpp:385</a></div></div>
<div class="ttc" id="aclassCSysVector_html_a9990ad4ea225c98a1af50e00fecbc56f"><div class="ttname"><a href="classCSysVector.html#a9990ad4ea225c98a1af50e00fecbc56f">CSysVector::SetBlock_Zero</a></div><div class="ttdeci">void SetBlock_Zero(unsigned long iPoint)</div><div class="ttdoc">Set the values to zero for one block.</div><div class="ttdef"><b>Definition:</b> <a href="CSysVector_8hpp_source.html#l00353">CSysVector.hpp:353</a></div></div>
<div class="ttc" id="aclassCSysVector_html_aa463275cba394503a9778529fdaa4494"><div class="ttname"><a href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">CSysVector::AddBlock</a></div><div class="ttdeci">void AddBlock(unsigned long iPoint, const VectorType &amp;block, ScalarType alpha=1)</div><div class="ttdoc">Add &quot;block&quot; to the vector, see SetBlock.</div><div class="ttdef"><b>Definition:</b> <a href="CSysVector_8hpp_source.html#l00377">CSysVector.hpp:377</a></div></div>
<div class="ttc" id="aclassCVariable_html_a07d4f954fe5a79e6f85adab3d462d73c"><div class="ttname"><a href="classCVariable.html#a07d4f954fe5a79e6f85adab3d462d73c">CVariable::GetGradient</a></div><div class="ttdeci">CVectorOfMatrix &amp; GetGradient(void)</div><div class="ttdoc">Get the gradient of the entire solution.</div><div class="ttdef"><b>Definition:</b> <a href="CVariable_8hpp_source.html#l00730">CVariable.hpp:730</a></div></div>
<div class="ttc" id="aclassCVariable_html_a0acbe55ca86de2c0205ae921193e9e95"><div class="ttname"><a href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">CVariable::GetLaminarViscosity</a></div><div class="ttdeci">virtual su2double GetLaminarViscosity(unsigned long iPoint) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="CVariable_8hpp_source.html#l01084">CVariable.hpp:1084</a></div></div>
<div class="ttc" id="aclassCVariable_html_a20a656c4093a9101875dde0886d0ecef"><div class="ttname"><a href="classCVariable.html#a20a656c4093a9101875dde0886d0ecef">CVariable::SetEnergy_ResTruncError_Zero</a></div><div class="ttdeci">void SetEnergy_ResTruncError_Zero(unsigned long iPoint)</div><div class="ttdoc">Set the velocity of the truncation error to zero.</div><div class="ttdef"><b>Definition:</b> <a href="CVariable_8hpp_source.html#l00686">CVariable.hpp:686</a></div></div>
<div class="ttc" id="aclassCVariable_html_a261483e39c23c1de7cb9aea7e917c121"><div class="ttname"><a href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">CVariable::GetSolution</a></div><div class="ttdeci">su2double GetSolution(unsigned long iPoint, unsigned long iVar) const</div><div class="ttdoc">Get the solution.</div><div class="ttdef"><b>Definition:</b> <a href="CVariable_8hpp_source.html#l00230">CVariable.hpp:230</a></div></div>
<div class="ttc" id="aclassCVariable_html_a4892ca545884011b7903a8e35c43b43f"><div class="ttname"><a href="classCVariable.html#a4892ca545884011b7903a8e35c43b43f">CVariable::GetDensity</a></div><div class="ttdeci">virtual su2double GetDensity(unsigned long iPoint) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="CVariable_8hpp_source.html#l00941">CVariable.hpp:941</a></div></div>
<div class="ttc" id="aclassCVariable_html_a525636dad6b2064101677df44f274443"><div class="ttname"><a href="classCVariable.html#a525636dad6b2064101677df44f274443">CVariable::GetEnthalpy</a></div><div class="ttdeci">virtual su2double GetEnthalpy(unsigned long iPoint) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="CVariable_8hpp_source.html#l00997">CVariable.hpp:997</a></div></div>
<div class="ttc" id="aclassCVariable_html_a634a803b0d397aec7a44420cd5159079"><div class="ttname"><a href="classCVariable.html#a634a803b0d397aec7a44420cd5159079">CVariable::GetPrimitive</a></div><div class="ttdeci">virtual const MatrixType &amp; GetPrimitive() const</div><div class="ttdoc">Get the primitive variables for all points.</div><div class="ttdef"><b>Definition:</b> <a href="CVariable_8hpp_source.html#l01251">CVariable.hpp:1251</a></div></div>
<div class="ttc" id="aclassCVariable_html_a6ee4d8d450971204cc054a33d6473732"><div class="ttname"><a href="classCVariable.html#a6ee4d8d450971204cc054a33d6473732">CVariable::SetSolution_Old</a></div><div class="ttdeci">void SetSolution_Old(unsigned long iPoint, const su2double *solution_old)</div><div class="ttdoc">Set the value of the old solution.</div><div class="ttdef"><b>Definition:</b> <a href="CVariable_8hpp_source.html#l00245">CVariable.hpp:245</a></div></div>
<div class="ttc" id="aclassCVariable_html_a8b7f4e020a837b1fe639e8d875f964d5"><div class="ttname"><a href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">CVariable::GetGradient_Primitive</a></div><div class="ttdeci">virtual su2double GetGradient_Primitive(unsigned long iPoint, unsigned long iVar, unsigned long iDim) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="CVariable_8hpp_source.html#l01589">CVariable.hpp:1589</a></div></div>
<div class="ttc" id="aclassCVariable_html_ad08820234eeedeb13105e603af2c67ad"><div class="ttname"><a href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">CVariable::GetPressure</a></div><div class="ttdeci">virtual su2double GetPressure(unsigned long iPoint) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="CVariable_8hpp_source.html#l01004">CVariable.hpp:1004</a></div></div>
<div class="ttc" id="aclassCVariable_html_adae2e4228e113624b7ab1f9ab1a493c6"><div class="ttname"><a href="classCVariable.html#adae2e4228e113624b7ab1f9ab1a493c6">CVariable::GetEddyViscosity</a></div><div class="ttdeci">virtual su2double GetEddyViscosity(unsigned long iPoint) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="CVariable_8hpp_source.html#l00990">CVariable.hpp:990</a></div></div>
<div class="ttc" id="aclassCVertex_html_a57cacfe764770e6c0e54c278cb584f7c"><div class="ttname"><a href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">CVertex::GetNormal</a></div><div class="ttdeci">void GetNormal(su2double *val_normal) const override</div><div class="ttdoc">Copy the the normal vector of a face.</div><div class="ttdef"><b>Definition:</b> <a href="CVertex_8hpp_source.html#l00093">CVertex.hpp:93</a></div></div>
<div class="ttc" id="aclassCVertex_html_ab8b0e96f9384b0a861c7a70616976b75"><div class="ttname"><a href="classCVertex.html#ab8b0e96f9384b0a861c7a70616976b75">CVertex::GetNormal_Neighbor</a></div><div class="ttdeci">unsigned long GetNormal_Neighbor(void) const</div><div class="ttdoc">Get the value of the closest neighbor.</div><div class="ttdef"><b>Definition:</b> <a href="CVertex_8hpp_source.html#l00321">CVertex.hpp:321</a></div></div>
<div class="ttc" id="aclassCVertex_html_ad568da06e7191358d3a09a1bee71cdb5"><div class="ttname"><a href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">CVertex::GetNode</a></div><div class="ttdeci">unsigned long GetNode() const</div><div class="ttdoc">Get the node of the vertex.</div><div class="ttdef"><b>Definition:</b> <a href="CVertex_8hpp_source.html#l00069">CVertex.hpp:69</a></div></div>
<div class="ttc" id="acode__config_8hpp_html_a404145e25ce1ea18e25e884f125237e3"><div class="ttname"><a href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a></div><div class="ttdeci">double su2double</div><div class="ttdef"><b>Definition:</b> <a href="code__config_8hpp_source.html#l00126">code_config.hpp:126</a></div></div>
<div class="ttc" id="agroup__GeometryToolbox_html_ga26f2f767e60f046c51299f6236f84ffe"><div class="ttname"><a href="group__GeometryToolbox.html#ga26f2f767e60f046c51299f6236f84ffe">GeometryToolbox::CrossProduct</a></div><div class="ttdeci">void CrossProduct(const T *a, const T *b, T *c)</div><div class="ttdoc">c = a x b</div><div class="ttdef"><b>Definition:</b> <a href="geometry__toolbox_8hpp_source.html#l00084">geometry_toolbox.hpp:84</a></div></div>
<div class="ttc" id="agroup__GeometryToolbox_html_gad8b24e50333c9a8378f7abf18222f36a"><div class="ttname"><a href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a></div><div class="ttdeci">T Norm(Int nDim, const T *a)</div><div class="ttdef"><b>Definition:</b> <a href="geometry__toolbox_8hpp_source.html#l00078">geometry_toolbox.hpp:78</a></div></div>
<div class="ttc" id="agroup__SIMD_html_ga54a1925ab40fb4249ea255072520de35"><div class="ttname"><a href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a></div><div class="ttdeci">FORCEINLINE ARRAY_T sqrt(const ARRAY_T &amp;x)</div><div class="ttdef"><b>Definition:</b> <a href="special__vectorization_8hpp_source.html#l00116">special_vectorization.hpp:116</a></div></div>
<div class="ttc" id="agroup__VecExpr_html_ga93385cff4ce14b9889bcc9e5ee65332c"><div class="ttname"><a href="group__VecExpr.html#ga93385cff4ce14b9889bcc9e5ee65332c">VecExpr::pow</a></div><div class="ttdeci">auto pow(const CVecExpr&lt; U, S &gt; &amp;u, const CVecExpr&lt; V, S &gt; &amp;v) -&gt; decltype(pow_&lt; U, V, S &gt;(u.derived(), v.derived()))</div><div class="ttdef"><b>Definition:</b> <a href="vector__expressions_8hpp_source.html#l00194">vector_expressions.hpp:194</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_a9b2b3fcdfe74a7a8b6d98a14d92a4b43"><div class="ttname"><a href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a></div><div class="ttdeci">#define MPI_UNSIGNED_LONG</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00473">mpi_structure.hpp:473</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aa058ba472f0fd41ae860caeaebca0166"><div class="ttname"><a href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a></div><div class="ttdeci">#define MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00479">mpi_structure.hpp:479</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aafd1dc0086079e7904385538c54c9c8f"><div class="ttname"><a href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a></div><div class="ttdeci">#define MPI_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00477">mpi_structure.hpp:477</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a010c51bd37c27270292797ea1db8a942"><div class="ttname"><a href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a></div><div class="ttdeci">const int MASTER_NODE</div><div class="ttdoc">Master node for MPI parallelization.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00111">option_structure.hpp:111</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89"><div class="ttname"><a href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a></div><div class="ttdeci">@ EULER_IMPLICIT</div><div class="ttdoc">Implicit Euler time integration definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01492">option_structure.hpp:1492</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a1fe79b42ed6f64e83f679323332fd763"><div class="ttname"><a href="option__structure_8hpp.html#a1fe79b42ed6f64e83f679323332fd763">SOURCE_SECOND_TERM</a></div><div class="ttdeci">const int SOURCE_SECOND_TERM</div><div class="ttdoc">Position of the second source term in the numerics container array.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00498">option_structure.hpp:498</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a43ea705e690ad6482423e483ddf04ed1"><div class="ttname"><a href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a></div><div class="ttdeci">const unsigned int MESH_0</div><div class="ttdoc">Definition of the finest grid level.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00087">option_structure.hpp:87</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a44d6272fd9607cb31468949e83b21a1caf22389272c967284acc10130b9ce0e6c"><div class="ttname"><a href="option__structure_8hpp.html#a44d6272fd9607cb31468949e83b21a1caf22389272c967284acc10130b9ce0e6c">MAIN_SOLVER::ADJ_RANS</a></div><div class="ttdeci">@ ADJ_RANS</div><div class="ttdoc">Definition of the continuous adjoint Reynolds-averaged Navier-Stokes' (RANS) solver.</div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a">TOTAL_HEATFLUX</a></div><div class="ttdeci">@ TOTAL_HEATFLUX</div><div class="ttdoc">Total heat flux.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01979">option_structure.hpp:1979</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa2d1bc11eae99ce594d0a2281210e64d4"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa2d1bc11eae99ce594d0a2281210e64d4">SURFACE_MASSFLOW</a></div><div class="ttdeci">@ SURFACE_MASSFLOW</div><div class="ttdoc">Mass Flow Rate objective function definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01997">option_structure.hpp:1997</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a></div><div class="ttdeci">@ MAXIMUM_HEATFLUX</div><div class="ttdoc">Maximum heat flux.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01980">option_structure.hpp:1980</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa6dbcda3aa9205f9255ff777ea28510b1"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa6dbcda3aa9205f9255ff777ea28510b1">SIDEFORCE_COEFFICIENT</a></div><div class="ttdeci">@ SIDEFORCE_COEFFICIENT</div><div class="ttdoc">Side force objective function definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01975">option_structure.hpp:1975</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa74469d47da8b77e6328e3661964307d8"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa74469d47da8b77e6328e3661964307d8">LIFT_COEFFICIENT</a></div><div class="ttdeci">@ LIFT_COEFFICIENT</div><div class="ttdoc">Lift objective function definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01974">option_structure.hpp:1974</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7">INVERSE_DESIGN_HEATFLUX</a></div><div class="ttdeci">@ INVERSE_DESIGN_HEATFLUX</div><div class="ttdoc">Heat flux objective function definition (inverse design).</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01978">option_structure.hpp:1978</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa8f80a9cba152af34bddb134a95f70e67"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa8f80a9cba152af34bddb134a95f70e67">DRAG_COEFFICIENT</a></div><div class="ttdeci">@ DRAG_COEFFICIENT</div><div class="ttdoc">Drag objective function definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01973">option_structure.hpp:1973</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa986b33b640b206199e379e5a22fc2278"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa986b33b640b206199e379e5a22fc2278">NEARFIELD_PRESSURE</a></div><div class="ttdeci">@ NEARFIELD_PRESSURE</div><div class="ttdoc">NearField Pressure objective function definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01986">option_structure.hpp:1986</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa996eee7e64825e2976ea751d9ef2c6c1"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa996eee7e64825e2976ea751d9ef2c6c1">SURFACE_TOTAL_PRESSURE</a></div><div class="ttdeci">@ SURFACE_TOTAL_PRESSURE</div><div class="ttdoc">Total Pressure objective function definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01994">option_structure.hpp:1994</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aac8b258aaf52323223d470403a2ff10b0"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aac8b258aaf52323223d470403a2ff10b0">EQUIVALENT_AREA</a></div><div class="ttdeci">@ EQUIVALENT_AREA</div><div class="ttdoc">Equivalent area objective function definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01985">option_structure.hpp:1985</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aae0adda208c6e887373a12474a9e6d9e2"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aae0adda208c6e887373a12474a9e6d9e2">SURFACE_STATIC_PRESSURE</a></div><div class="ttdeci">@ SURFACE_STATIC_PRESSURE</div><div class="ttdoc">Static Pressure objective function definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01995">option_structure.hpp:1995</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a6a09a5472a47da677853641e633f3abeab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="option__structure_8hpp.html#a6a09a5472a47da677853641e633f3abeab50339a10e1de285ac99d4c3990b8693">LIMITER::NONE</a></div><div class="ttdeci">@ NONE</div><div class="ttdoc">No limiter.</div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a6d78d8ad6e8f106b8e77781f0b431ca6"><div class="ttname"><a href="option__structure_8hpp.html#a6d78d8ad6e8f106b8e77781f0b431ca6">SOURCE_FIRST_TERM</a></div><div class="ttdeci">const int SOURCE_FIRST_TERM</div><div class="ttdoc">Position of the first source term in the numerics container array.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00497">option_structure.hpp:497</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a88c999a2ce949a2b939c223ae1132480"><div class="ttname"><a href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a></div><div class="ttdeci">const su2double TWO3</div><div class="ttdoc">Two divided by three.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00104">option_structure.hpp:104</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a8a925ac62604ec86956557ab2acfb3f9"><div class="ttname"><a href="option__structure_8hpp.html#a8a925ac62604ec86956557ab2acfb3f9">VISC_TERM</a></div><div class="ttdeci">const int VISC_TERM</div><div class="ttdoc">Position of the viscous terms in the numerics container array.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00496">option_structure.hpp:496</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a8e54c1f9902bceca5a447c00f47dba85"><div class="ttname"><a href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a></div><div class="ttdeci">const su2double FOUR3</div><div class="ttdoc">Four divided by three.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00105">option_structure.hpp:105</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a98b1b0d541147aaee4b7100c8b0892e6a686cd34998b25d1929374643e062a074"><div class="ttname"><a href="option__structure_8hpp.html#a98b1b0d541147aaee4b7100c8b0892e6a686cd34998b25d1929374643e062a074">COMM_FULL</a></div><div class="ttdeci">@ COMM_FULL</div><div class="ttdoc">Perform all MPI communications.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l02578">option_structure.hpp:2577</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551"><div class="ttname"><a href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a></div><div class="ttdeci">@ FLOW_SOL</div><div class="ttdoc">Position of the mean flow solution in the solver container array.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00477">option_structure.hpp:477</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287"><div class="ttname"><a href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287">TURB_SOL</a></div><div class="ttdeci">@ TURB_SOL</div><div class="ttdoc">Position of the turbulence model solution in the solver container array.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00479">option_structure.hpp:479</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5"><div class="ttname"><a href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a></div><div class="ttdeci">@ ADJTURB_SOL</div><div class="ttdoc">Position of the continuous adjoint turbulence solution in the solver container array.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00480">option_structure.hpp:480</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba2017081e4aa73a6aef6fdd6b3a380fbf"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba2017081e4aa73a6aef6fdd6b3a380fbf">FAR_FIELD</a></div><div class="ttdeci">@ FAR_FIELD</div><div class="ttdoc">Boundary far-field definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01597">option_structure.hpp:1597</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a></div><div class="ttdeci">@ ISOTHERMAL</div><div class="ttdoc">No slip isothermal wall boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01612">option_structure.hpp:1612</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba6dc1b159829aa7885fc905d3d81f28bd"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba6dc1b159829aa7885fc905d3d81f28bd">INLET_FLOW</a></div><div class="ttdeci">@ INLET_FLOW</div><div class="ttdoc">Boundary inlet flow definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01599">option_structure.hpp:1599</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba8e57aa6eae14b4e84e2ebd0be0d385fb"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba8e57aa6eae14b4e84e2ebd0be0d385fb">SUPERSONIC_INLET</a></div><div class="ttdeci">@ SUPERSONIC_INLET</div><div class="ttdoc">Boundary supersonic inlet definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01607">option_structure.hpp:1607</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba938badc8671d389b99bd9ae9eb6cfa73"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba938badc8671d389b99bd9ae9eb6cfa73">ENGINE_INFLOW</a></div><div class="ttdeci">@ ENGINE_INFLOW</div><div class="ttdoc">Boundary nacelle inflow.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01609">option_structure.hpp:1609</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a></div><div class="ttdeci">@ HEAT_FLUX</div><div class="ttdoc">No slip constant heat flux wall boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01613">option_structure.hpp:1613</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820bacaed259788fb153495d0901f31e529bf"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820bacaed259788fb153495d0901f31e529bf">SUPERSONIC_OUTLET</a></div><div class="ttdeci">@ SUPERSONIC_OUTLET</div><div class="ttdoc">Boundary supersonic inlet definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01608">option_structure.hpp:1608</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_adb5c3260b4674bf85aa558c7bff71772acadbfdd0081764bd8d24111dfa08a35f"><div class="ttname"><a href="option__structure_8hpp.html#adb5c3260b4674bf85aa558c7bff71772acadbfdd0081764bd8d24111dfa08a35f">CENTERED::JST</a></div><div class="ttdeci">@ JST</div><div class="ttdoc">Jameson-Smith-Turkel centered numerical method.</div></div>
<div class="ttc" id="aoption__structure_8hpp_html_adfbf8ea588ac42ebd8a665059e6ff5f8ae3d87c0113dc985c598feb409a45c552"><div class="ttname"><a href="option__structure_8hpp.html#adfbf8ea588ac42ebd8a665059e6ff5f8ae3d87c0113dc985c598feb409a45c552">MPI_QUANTITIES::SOLUTION</a></div><div class="ttdeci">@ SOLUTION</div><div class="ttdoc">Conservative solution communication.</div></div>
<div class="ttc" id="aoption__structure_8hpp_html_af38c934f477044b7ceb0394ffd9b3ea4a06b4cd5e24ce8576f9329c2b5f75ba82"><div class="ttname"><a href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a06b4cd5e24ce8576f9329c2b5f75ba82">WEIGHTED_LEAST_SQUARES</a></div><div class="ttdeci">@ WEIGHTED_LEAST_SQUARES</div><div class="ttdoc">Gradients computation using inverse-distance weighted least squares.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01564">option_structure.hpp:1563</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_af38c934f477044b7ceb0394ffd9b3ea4a8e655dfdcc23cb033e14c30ff83f9df2"><div class="ttname"><a href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a8e655dfdcc23cb033e14c30ff83f9df2">LEAST_SQUARES</a></div><div class="ttdeci">@ LEAST_SQUARES</div><div class="ttdoc">Gradient computation using unweighted least squares.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01562">option_structure.hpp:1562</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_af38c934f477044b7ceb0394ffd9b3ea4afda8790c8835b1a9827c006a31ea8465"><div class="ttname"><a href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4afda8790c8835b1a9827c006a31ea8465">GREEN_GAUSS</a></div><div class="ttdeci">@ GREEN_GAUSS</div><div class="ttdoc">Gradient computation using Green-Gauss theorem.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01561">option_structure.hpp:1561</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa"><div class="ttname"><a href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a></div><div class="ttdeci">@ US</div><div class="ttdoc">Definition of incompressible solver.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00450">option_structure.hpp:449</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_6f9fd837e39f246a8f0c94f670ad0309.html">SU2_CFD</a></li><li class="navelem"><a class="el" href="dir_74ad77d76f42ded9212b1c5616a2ad50.html">src</a></li><li class="navelem"><a class="el" href="dir_320eb617c00a5dd44b94c6b6f4553ab7.html">solvers</a></li><li class="navelem"><a class="el" href="CAdjNSSolver_8cpp.html">CAdjNSSolver.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
