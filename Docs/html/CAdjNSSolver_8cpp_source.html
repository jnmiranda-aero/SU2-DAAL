<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Documentation: SU2_CFD/src/solvers/CAdjNSSolver.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logoSU2small.png"/></td>
  <td id="projectalign">
   <div id="projectname">Documentation
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('CAdjNSSolver_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">CAdjNSSolver.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="CAdjNSSolver_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/*!</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> * \file CAdjNSSolver.cpp</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment"> * \brief Main subroutines for solving Navier-Stokes adjoint problems.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment"> * \author F. Palacios, T. Economon, H. Kline</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * \version 8.0.1 &quot;Harrier&quot;</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> *</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> * SU2 Project Website: https://su2code.github.io</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> *</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> * The SU2 Project is maintained by the SU2 Foundation</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> * (http://su2foundation.org)</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> *</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> * Copyright 2012-2024, SU2 Contributors (cf. AUTHORS.md)</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> *</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> * SU2 is free software; you can redistribute it and/or</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> * modify it under the terms of the GNU Lesser General Public</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> * License as published by the Free Software Foundation; either</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span><span class="comment"> * version 2.1 of the License, or (at your option) any later version.</span></div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="comment"> *</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="comment"> * SU2 is distributed in the hope that it will be useful,</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="comment"> * Lesser General Public License for more details.</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="comment"> *</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="comment"> * License along with SU2. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="comment"> */</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span> </div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span> </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;../../include/solvers/CAdjNSSolver.hpp&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;../../include/variables/CAdjNSVariable.hpp&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;../../../Common/include/toolboxes/geometry_toolbox.hpp&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#acd8b443b57b29343b1ce316bed3f380b">   33</a></span><a class="code hl_function" href="classCAdjNSSolver.html#acd8b443b57b29343b1ce316bed3f380b">CAdjNSSolver::CAdjNSSolver</a>() : <a class="code hl_class" href="classCAdjEulerSolver.html">CAdjEulerSolver</a>() { }</div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span> </div>
<div class="foldopen" id="foldopen00035" data-start="{" data-end="}">
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a323f1dc7c0b9fe00d1911eeeea365d46">   35</a></span><a class="code hl_function" href="classCAdjNSSolver.html#acd8b443b57b29343b1ce316bed3f380b">CAdjNSSolver::CAdjNSSolver</a>(<a class="code hl_class" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code hl_class" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh) : <a class="code hl_class" href="classCAdjEulerSolver.html">CAdjEulerSolver</a>() {</div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iPoint, iVertex;</div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span>  <span class="keywordtype">string</span> text_line, mesh_filename;</div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim, iVar, iMarker;</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>  ifstream restart_file;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>  <span class="keywordtype">string</span> filename, AdjExt;</div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>  <a class="code hl_variable" href="classCSolver.html#afb69ab045d3dd03f45e013d448c3cea3">adjoint</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> RefArea    = config-&gt;<a class="code hl_function" href="classCConfig.html#a515e35504ab34bf25d222e377f3b4c81">GetRefArea</a>();</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> RefDensity  = config-&gt;<a class="code hl_function" href="classCConfig.html#af30dc08c28dd72bfcedc6a5a4e224036">GetDensity_FreeStreamND</a>();</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Gas_Constant    = config-&gt;<a class="code hl_function" href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">GetGas_ConstantND</a>();</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Mach_Motion     = config-&gt;<a class="code hl_function" href="classCConfig.html#a5442ec644c8d291d3e07c158ba5d54a4">GetMach_Motion</a>();</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *Normal = <span class="keyword">nullptr</span>, myArea_Monitored;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> RefVel2, Mach2Vel, Weight_ObjFunc, factor;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *Velocity_Inf;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span> </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>  <span class="keywordtype">string</span> Marker_Tag, Monitoring_Tag;</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring, jMarker, ObjFunc;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>  <span class="keywordtype">bool</span> grid_movement  = config-&gt;<a class="code hl_function" href="classCConfig.html#a9182d3dbb0b3bfa2ebb944f18795f5ca">GetGrid_Movement</a>();</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>  <span class="keywordtype">bool</span> restart = config-&gt;<a class="code hl_function" href="classCConfig.html#ae55bdae4e8b4e61fd07a857005cc6799">GetRestart</a>();</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>  <span class="comment">/*--- Norm heat flux objective test ---*/</span></div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a> = 1.0;</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>  <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>()==<a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a>)</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a> = 8.0; <span class="comment">// Matches MaxNorm defined in solver_direct_mean.</span></div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span> </div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>  <span class="comment">/*--- Set the gamma value ---*/</span></div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span> </div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> = config-&gt;<a class="code hl_function" href="classCConfig.html#a0b5df9254891b32a88e83880778f9261">GetGamma</a>();</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a> = <a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> - 1.0;</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span> </div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>  <span class="comment">/*--- Define geometry constants in the solver structure ---*/</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span> </div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>  <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>         = geometry-&gt;<a class="code hl_function" href="classCGeometry.html#ace7f7fe876f629f5bd5f92d4805a1a4b">GetnDim</a>();</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>  <a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>      = config-&gt;<a class="code hl_function" href="classCConfig.html#a459dee039e618d21a5d78db61c221240">GetnMarker_All</a>();</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>  <a class="code hl_variable" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>       = geometry-&gt;<a class="code hl_function" href="classCGeometry.html#a275fb07cd99ab79d7a04b4862280169d">GetnPoint</a>();</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>  <a class="code hl_variable" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a> = geometry-&gt;<a class="code hl_function" href="classCGeometry.html#ac84179060bbac1fe5e856ea3da850b6e">GetnPointDomain</a>();</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span> </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>  <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a> = <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> + 2;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span> </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>  <span class="comment">/*--- Initialize nVarGrad for deallocation ---*/</span></div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>  <a class="code hl_variable" href="classCSolver.html#af8dc930f3b6fc31ecf48d2294baf9d5f">nVarGrad</a> = <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span> </div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>  <a class="code hl_variable" href="classCSolver.html#ac2b7eb546780ee9e5aa95ca88562699d">Residual_RMS</a>.resize(<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>,0.0);</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  <a class="code hl_variable" href="classCSolver.html#a59da1efb04d4d6cb0627b61005ff3ed5">Residual_Max</a>.resize(<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>,0.0);</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>  <a class="code hl_variable" href="classCSolver.html#af333279175711dc23f668300c357bd5c">Point_Max</a>.resize(<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>,0);</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>  <a class="code hl_variable" href="classCSolver.html#a167cf81a9f3a29dc176728cb033185a4">Point_Max_Coord</a>.<a class="code hl_function" href="classC2DContainer.html#a39929b060c72565b4ab19c3a391bb8e6">resize</a>(<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>,<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>) = <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>(0.0);</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>  <span class="comment">/*--- Define some auxiliary arrays related to the residual ---*/</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span> </div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>  <a class="code hl_variable" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>     = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code hl_variable" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>[iVar]     = 0.0;</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>  <a class="code hl_variable" href="classCSolver.html#a313f866523cd6bed20eb620faee4b73a">Residual_i</a>   = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code hl_variable" href="classCSolver.html#a313f866523cd6bed20eb620faee4b73a">Residual_i</a>[iVar]   = 0.0;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>  <a class="code hl_variable" href="classCSolver.html#a1d6e05a7a904684360013dff7b241be6">Residual_j</a>   = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code hl_variable" href="classCSolver.html#a1d6e05a7a904684360013dff7b241be6">Residual_j</a>[iVar]   = 0.0;</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>  <a class="code hl_variable" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>   = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code hl_variable" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[iVar]   = 0.0;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>  <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>   = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[iVar]   = 0.0;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>  <a class="code hl_variable" href="classCSolver.html#aea78ca4418d89965bfe052196a360389">Res_Conv_j</a>   = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code hl_variable" href="classCSolver.html#aea78ca4418d89965bfe052196a360389">Res_Conv_j</a>[iVar]   = 0.0;</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>  <a class="code hl_variable" href="classCSolver.html#a75021726ee9fbb9262ffea01e989237a">Res_Visc_j</a>   = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code hl_variable" href="classCSolver.html#a75021726ee9fbb9262ffea01e989237a">Res_Visc_j</a>[iVar]   = 0.0;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span> </div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>  <span class="comment">/*--- Define some auxiliary arrays related to the solution ---*/</span></div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span> </div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>  <a class="code hl_variable" href="classCSolver.html#a9958742a687a4c92d0bf1ead78aa1a0c">Solution</a>   = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code hl_variable" href="classCSolver.html#a9958742a687a4c92d0bf1ead78aa1a0c">Solution</a>[iVar]   = 0.0;</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>  <a class="code hl_variable" href="classCSolver.html#aa4d789119564e1489b48763e0f7cdeee">Solution_i</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code hl_variable" href="classCSolver.html#aa4d789119564e1489b48763e0f7cdeee">Solution_i</a>[iVar] = 0.0;</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>  <a class="code hl_variable" href="classCSolver.html#aa3e97145d1cf5b3803df5ac763eca2fc">Solution_j</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) <a class="code hl_variable" href="classCSolver.html#aa3e97145d1cf5b3803df5ac763eca2fc">Solution_j</a>[iVar] = 0.0;</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span> </div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>  <span class="comment">/*--- Define some auxiliary arrays related to the flow solution ---*/</span></div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a066a1c3fb9cf63efc84a58ac67a76437">FlowPrimVar_i</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+7]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+7; iVar++) <a class="code hl_variable" href="classCAdjEulerSolver.html#a066a1c3fb9cf63efc84a58ac67a76437">FlowPrimVar_i</a>[iVar] = 0.0;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#aa29c3c368ebace7feb2c88a2cc57f260">FlowPrimVar_j</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+7]; <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+7; iVar++) <a class="code hl_variable" href="classCAdjEulerSolver.html#aa29c3c368ebace7feb2c88a2cc57f260">FlowPrimVar_j</a>[iVar] = 0.0;</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span> </div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>  <span class="comment">/*--- Define some auxiliary vectors related to the geometry ---*/</span></div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>  <a class="code hl_class" href="classC2DContainer.html">Vector</a>   = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]; <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) <a class="code hl_class" href="classC2DContainer.html">Vector</a>[iDim]   = 0.0;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>  <a class="code hl_variable" href="classCSolver.html#af494e3d4d3cda6635e6b55da05de9662">Vector_i</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]; <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) <a class="code hl_variable" href="classCSolver.html#af494e3d4d3cda6635e6b55da05de9662">Vector_i</a>[iDim] = 0.0;</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>  <a class="code hl_variable" href="classCSolver.html#af6b2525dd5f8326b7b72f51c5f749b30">Vector_j</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>]; <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) <a class="code hl_variable" href="classCSolver.html#af6b2525dd5f8326b7b72f51c5f749b30">Vector_j</a>[iDim] = 0.0;</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span> </div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  <span class="comment">/*--- Point to point Jacobians. These are always defined because</span></div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span><span class="comment">   they are also used for sensitivity calculations. ---*/</span></div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span> </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>  <a class="code hl_variable" href="classCSolver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>  <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>  <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) {</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    <a class="code hl_variable" href="classCSolver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a>[iVar] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[iVar] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>  }</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span> </div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>  <span class="comment">/*--- Solution and residual vectors ---*/</span></div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span> </div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>  <a class="code hl_variable" href="classCSolver.html#a3f318bceaa27f4800de8ecf2cdcae5fb">LinSysSol</a>.Initialize(<a class="code hl_variable" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>, <a class="code hl_variable" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a>, <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, 0.0);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>  <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.Initialize(<a class="code hl_variable" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>, <a class="code hl_variable" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a>, <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, 0.0);</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span> </div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>  <span class="comment">/*--- Jacobians and vector structures for implicit computations ---*/</span></div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span> </div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>  <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#a4bf6e287aaf809340df1e40a76cf438b">GetKind_TimeIntScheme_AdjFlow</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>) {</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <a class="code hl_variable" href="classCSolver.html#ae31efca489e7d21f78b5c63c7c353134">Jacobian_ij</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <a class="code hl_variable" href="classCSolver.html#aeca105abe8a547328e2b1a320708b226">Jacobian_ji</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <a class="code hl_variable" href="classCSolver.html#a0ff55af7303be290661b65f60a037a42">Jacobian_jj</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) {</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>      <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[iVar] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>      <a class="code hl_variable" href="classCSolver.html#ae31efca489e7d21f78b5c63c7c353134">Jacobian_ij</a>[iVar] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>      <a class="code hl_variable" href="classCSolver.html#aeca105abe8a547328e2b1a320708b226">Jacobian_ji</a>[iVar] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>      <a class="code hl_variable" href="classCSolver.html#a0ff55af7303be290661b65f60a037a42">Jacobian_jj</a>[iVar] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    }</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code hl_variable" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>)</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>      cout &lt;&lt; <span class="stringliteral">&quot;Initialize Jacobian structure (Adjoint N-S). MG level: &quot;</span> &lt;&lt; iMesh &lt;&lt;<span class="stringliteral">&quot;.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#ae17220ac30c2abcc7fdd3c5dc8f04571">Initialize</a>(<a class="code hl_variable" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>, <a class="code hl_variable" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a>, <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <span class="keyword">true</span>, geometry, config);</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code hl_variable" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>)</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>      cout &lt;&lt; <span class="stringliteral">&quot;Explicit scheme. No Jacobian structure (Adjoint N-S). MG level: &quot;</span> &lt;&lt; iMesh &lt;&lt;<span class="stringliteral">&quot;.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>  }</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span> </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>  <span class="comment">/*--- Sensitivity definition and coefficient on all markers ---*/</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>  <span class="keywordflow">for</span> (iMarker=0; iMarker&lt;<a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a>[iMarker] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]];</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>  }</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>  <span class="comment">/*--- Store the value of the characteristic primitive variables at the boundaries ---*/</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span> </div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a88866367a785e4cfdc5f72606c6cfe4c">DonorAdjVar</a>.resize(<a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>);</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#a88866367a785e4cfdc5f72606c6cfe4c">DonorAdjVar</a>[iMarker].resize(geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]);</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>    <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++) {</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a88866367a785e4cfdc5f72606c6cfe4c">DonorAdjVar</a>[iMarker][iVertex].resize(<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, 0.0);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    }</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>  }</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span> </div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>  <span class="comment">/*--- Store the value of the characteristic primitive variables at the boundaries ---*/</span></div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span> </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#aa9f35cdd46666eb545d831c9bc5985d5">DonorGlobalIndex</a>.resize(<a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#aa9f35cdd46666eb545d831c9bc5985d5">DonorGlobalIndex</a>[iMarker].resize(geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker],0);</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>  }</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span> </div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">Sens_Geo</a>   = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>  = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>   = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>  = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a3f9e8576dc150e551bd19a64b1d43977">Sens_BPress</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>];</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>  <span class="comment">/*--- Initialize sensitivities to zero ---*/</span></div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">Sens_Geo</a>[iMarker]   = 0.0;</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker]  = 0.0;</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker]   = 0.0;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] = 0.0;</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker]  = 0.0;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#a3f9e8576dc150e551bd19a64b1d43977">Sens_BPress</a>[iMarker] = 0.0;</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++)</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a>[iMarker][iVertex] = 0.0;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>  }</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span> </div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>  <span class="comment">/*--- Initialize the adjoint variables to zero (infinity state) ---*/</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a11a688be02f50bf45a49f23ea4ac4cb2">PsiRho_Inf</a> = 0.0;</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>  <span class="keywordflow">if</span> ((config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a">TOTAL_HEATFLUX</a>) ||</div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>      (config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a>) ||</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>      (config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7">INVERSE_DESIGN_HEATFLUX</a>))</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#a4a53581a74846bf44a7d7a85d15bb8e5">PsiE_Inf</a> = 1.0;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>  <span class="keywordflow">else</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#a4a53581a74846bf44a7d7a85d15bb8e5">PsiE_Inf</a> = 0.0;</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">Phi_Inf</a> = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">Phi_Inf</a>[0] = 0.0; <a class="code hl_variable" href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">Phi_Inf</a>[1] = 0.0;</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) <a class="code hl_variable" href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">Phi_Inf</a>[2] = 0.0;</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span> </div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>  <span class="comment">/*--- Initialize the solution to the far-field state everywhere. ---*/</span></div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span> </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a> = <span class="keyword">new</span> <a class="code hl_class" href="classCAdjNSVariable.html">CAdjNSVariable</a>(<a class="code hl_variable" href="classCAdjEulerSolver.html#a11a688be02f50bf45a49f23ea4ac4cb2">PsiRho_Inf</a>, <a class="code hl_variable" href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">Phi_Inf</a>, <a class="code hl_variable" href="classCAdjEulerSolver.html#a4a53581a74846bf44a7d7a85d15bb8e5">PsiE_Inf</a>, <a class="code hl_variable" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>, <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, config);</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>  <a class="code hl_function" href="classCSolver.html#ad982896202dae6e41bfd3568f597cf46">SetBaseClassPointerToNodes</a>();</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span> </div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>  <span class="comment">/*--- Read the restart metadata. ---*/</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span> </div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>  <span class="keywordflow">if</span> (restart &amp;&amp; (iMesh == <a class="code hl_variable" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>)) {</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    mesh_filename = config-&gt;<a class="code hl_function" href="classCConfig.html#a1132191f9f5af73ef4ff7eb356f41181">GetSolution_AdjFileName</a>();</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    filename      = config-&gt;<a class="code hl_function" href="classCConfig.html#ace4081f7013cfe0fd756dff7d9ba7f8f">GetObjFunc_Extension</a>(mesh_filename);</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span><span class="comment">//    Read_SU2_Restart_Metadata(geometry, config, true, filename);</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>  }</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>  <span class="comment">/*--- Calculate area monitored for area-averaged-outflow-quantity-based objectives ---*/</span></div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>   myArea_Monitored = 0.0;</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>   <span class="keywordflow">for</span> (iMarker_Monitoring = 0; iMarker_Monitoring &lt; config-&gt;<a class="code hl_function" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>(); iMarker_Monitoring++) {</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>     <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring)==<a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa996eee7e64825e2976ea751d9ef2c6c1">SURFACE_TOTAL_PRESSURE</a> ||</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>         config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring)==<a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aae0adda208c6e887373a12474a9e6d9e2">SURFACE_STATIC_PRESSURE</a>) {</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>       Monitoring_Tag = config-&gt;<a class="code hl_function" href="classCConfig.html#a4558fc163c393e628050e7a2273673f1">GetMarker_Monitoring_TagBound</a>(iMarker_Monitoring);</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>       <span class="comment">/*-- Find the marker index ---*/</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>       iMarker = 0;</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>       <span class="keywordflow">for</span> (jMarker= 0; jMarker &lt; config-&gt;<a class="code hl_function" href="classCConfig.html#a459dee039e618d21a5d78db61c221240">GetnMarker_All</a>(); jMarker++) {</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>         Marker_Tag = config-&gt;<a class="code hl_function" href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">GetMarker_All_TagBound</a>(jMarker);</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>         <span class="keywordflow">if</span> (Marker_Tag == Monitoring_Tag) {</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>           iMarker = jMarker;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>           <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++) {</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>             iPoint = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>             <span class="keywordflow">if</span> (geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>               Normal = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>();</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>               myArea_Monitored += <a class="code hl_function" href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a>(<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, Normal);</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>             }</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>           }</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>           <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>         }</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>       }</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>     }</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>   }</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span> </div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span> </div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span><span class="preprocessor"> #ifdef HAVE_MPI</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>   <a class="code hl_variable" href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">Area_Monitored</a> = 0.0;</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>   <a class="code hl_function" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;myArea_Monitored, &amp;<a class="code hl_variable" href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">Area_Monitored</a>, 1, <a class="code hl_define" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code hl_define" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code hl_function" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span><span class="preprocessor"> #else</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>   <a class="code hl_variable" href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">Area_Monitored</a> = myArea_Monitored;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span><span class="preprocessor"> #endif</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span> </div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>   <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#aad80e2ae9bc0b7b1fed6ccc2b6b2bce0">GetnObj</a>() &gt; 1 &amp;&amp; iMesh == <a class="code hl_variable" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>) {</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>     <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>       Mach2Vel = <a class="code hl_function" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(<a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>*Gas_Constant*config-&gt;<a class="code hl_function" href="classCConfig.html#afa49e1ce7793a31cc572d957caffaef9">GetTemperature_FreeStreamND</a>());</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>       RefVel2 = (Mach_Motion*Mach2Vel)*(Mach_Motion*Mach2Vel);</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>     }</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>     <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>       Velocity_Inf = config-&gt;<a class="code hl_function" href="classCConfig.html#a13840ca712bf87d32d18917d0c39cfae">GetVelocity_FreeStreamND</a>();</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>       RefVel2 = 0.0;</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>       <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>         RefVel2  += Velocity_Inf[iDim]*Velocity_Inf[iDim];</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>     }</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span> </div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>     <span class="comment">/*--- Objective scaling: a factor must be applied to certain objectives ---*/</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>     <span class="keywordflow">for</span> (iMarker_Monitoring = 0; iMarker_Monitoring &lt; config-&gt;<a class="code hl_function" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>(); iMarker_Monitoring++) {</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>         Weight_ObjFunc = config-&gt;<a class="code hl_function" href="classCConfig.html#a614c55e8d7945a11d92d7b51851291c2">GetWeight_ObjFunc</a>(iMarker_Monitoring);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span> </div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>         factor = 1.0/(0.5*RefDensity*RefArea*RefVel2);</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span> </div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>         ObjFunc = config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>         <span class="keywordflow">if</span> ((ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7">INVERSE_DESIGN_HEATFLUX</a>) ||</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>             (ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a">TOTAL_HEATFLUX</a>) || (ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a>) ||</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>             (ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa2d1bc11eae99ce594d0a2281210e64d4">SURFACE_MASSFLOW</a>) ) factor = 1.0;</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span> </div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>        <span class="keywordflow">if</span> ((ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa996eee7e64825e2976ea751d9ef2c6c1">SURFACE_TOTAL_PRESSURE</a>) || (ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aae0adda208c6e887373a12474a9e6d9e2">SURFACE_STATIC_PRESSURE</a>))</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>          factor = 1.0/<a class="code hl_variable" href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">Area_Monitored</a>;</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span> </div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>        Weight_ObjFunc = Weight_ObjFunc*factor;</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>        config-&gt;<a class="code hl_function" href="classCConfig.html#adb9ce1745b78e43a916afd47c9d4e96b">SetWeight_ObjFunc</a>(iMarker_Monitoring, Weight_ObjFunc);</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span> </div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>     }</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>   }</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span> </div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>  <span class="comment">/*--- MPI solution ---*/</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span> </div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>  <a class="code hl_function" href="classCSolver.html#a7c5c26e7f006b4bb7e93582d839cf09d">InitiateComms</a>(geometry, config, <a class="code hl_enumvalue" href="option__structure_8hpp.html#adfbf8ea588ac42ebd8a665059e6ff5f8a0a57d2bc6d4da43c5fdb8c9293764d8d">SOLUTION</a>);</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>  <a class="code hl_function" href="classCSolver.html#a6891c839827efbebdcbf9a349f4da92c">CompleteComms</a>(geometry, config, <a class="code hl_enumvalue" href="option__structure_8hpp.html#adfbf8ea588ac42ebd8a665059e6ff5f8a0a57d2bc6d4da43c5fdb8c9293764d8d">SOLUTION</a>);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span> </div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>}</div>
</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span> </div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span><a class="code hl_function" href="classCAdjNSSolver.html#a6e2a8b29fa5c5709d12e7970d8cc88eb">CAdjNSSolver::~CAdjNSSolver</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span> </div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span> </div>
<div class="foldopen" id="foldopen00292" data-start="{" data-end="}">
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a22ab579adc04b7c212508480df9dff8b">  292</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classCAdjNSSolver.html#a22ab579adc04b7c212508480df9dff8b">CAdjNSSolver::SetTime_Step</a>(<a class="code hl_class" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code hl_class" href="classCSolver.html">CSolver</a> **solver_container, <a class="code hl_class" href="classCConfig.html">CConfig</a> *config,</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>                            <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Iteration) {</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span> </div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>  <span class="comment">/*--- Use the flow solution to update the time step</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span><span class="comment">   *    The time step depends on the characteristic velocity, which is the same</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span><span class="comment">   *    for the adjoint and flow solutions, albeit in the opposite direction. ---*/</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>  solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#a59168ff9a35447672e6ee77cf4bcb1ec">SetTime_Step</a>(geometry, solver_container, config, iMesh, Iteration);</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span> </div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>}</div>
</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span> </div>
<div class="foldopen" id="foldopen00302" data-start="{" data-end="}">
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a0669f6fb8ef7cd7800d151d4aff7d3f6">  302</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classCAdjNSSolver.html#a0669f6fb8ef7cd7800d151d4aff7d3f6">CAdjNSSolver::Preprocessing</a>(<a class="code hl_class" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code hl_class" href="classCSolver.html">CSolver</a> **solver_container, <a class="code hl_class" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iRKStep, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> RunTime_EqSystem, <span class="keywordtype">bool</span> Output) {</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span> </div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iPoint, nonPhysicalPoints = 0;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> SharpEdge_Distance;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>  <span class="keywordtype">bool</span> physical = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span> </div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>  <span class="comment">/*--- Retrieve information about the spatial and temporal integration for the</span></div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span><span class="comment">   adjoint equations (note that the flow problem may use different methods). ---*/</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span> </div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>  <span class="keywordtype">bool</span> implicit       = (config-&gt;<a class="code hl_function" href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">GetKind_TimeIntScheme</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>);</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>  <span class="keywordtype">bool</span> limiter        = (config-&gt;<a class="code hl_function" href="classCConfig.html#aba1a437d929fef85ee9ea86dae47925f">GetKind_SlopeLimit_AdjFlow</a>() != <a class="code hl_enumvalue" href="option__structure_8hpp.html#a6a09a5472a47da677853641e633f3abeab50339a10e1de285ac99d4c3990b8693">LIMITER::NONE</a>);</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>  <span class="keywordtype">bool</span> center_jst     = (config-&gt;<a class="code hl_function" href="classCConfig.html#aef335760724e0367ef46cd2714ce236d">GetKind_Centered_AdjFlow</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#adb5c3260b4674bf85aa558c7bff71772acadbfdd0081764bd8d24111dfa08a35f">CENTERED::JST</a>);</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>  <span class="keywordtype">bool</span> fixed_cl       = config-&gt;<a class="code hl_function" href="classCConfig.html#ae688e355a74025050498d8c03aee35b2">GetFixed_CL_Mode</a>();</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>  <span class="keywordtype">bool</span> eval_dof_dcx   = config-&gt;<a class="code hl_function" href="classCConfig.html#ab090a18d19d62ffc6fbf89f195eed16e">GetEval_dOF_dCX</a>();</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span> </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>  <span class="comment">/*--- Update the objective function coefficient to guarantee zero gradient. ---*/</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span> </div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>  <span class="keywordflow">if</span> (fixed_cl &amp;&amp; eval_dof_dcx) { <a class="code hl_function" href="classCAdjEulerSolver.html#a5265a44e6c43dee677c9f26333148432">SetFarfield_AoA</a>(geometry, solver_container, config, iMesh, Output); }</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span> </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>  <span class="comment">/*--- Residual initialization ---*/</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span> </div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>  <span class="keywordflow">for</span> (iPoint = 0; iPoint &lt; <a class="code hl_variable" href="classCSolver.html#a515af1055f70b894174566926ae3cae2">nPoint</a>; iPoint ++) {</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span> </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    <span class="comment">/*--- Get the distance form a sharp edge ---*/</span></div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span> </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>    SharpEdge_Distance = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#adc3f21497e23f4d682d62ed454daac66">GetSharpEdge_Distance</a>(iPoint);</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span> </div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    <span class="comment">/*--- Set the primitive variables compressible</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span><span class="comment">     adjoint variables ---*/</span></div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span> </div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    physical = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCAdjEulerVariable.html#a08d1474748d5ddf53d62c1dde9f23ac8">SetPrimVar</a>(iPoint,SharpEdge_Distance, <span class="keyword">false</span>, config);</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span> </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <span class="comment">/* Check for non-realizable states for reporting. */</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span> </div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <span class="keywordflow">if</span> (!physical) nonPhysicalPoints++;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    <span class="comment">/*--- Initialize the convective residual vector ---*/</span></div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span> </div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    <span class="keywordflow">if</span> (!Output) <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code hl_function" href="classCSysVector.html#a9990ad4ea225c98a1af50e00fecbc56f">SetBlock_Zero</a>(iPoint);</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span> </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>  }</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>  <span class="comment">/*--- Compute gradients adj for solution reconstruction and viscous term ---*/</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>  <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#a350466e9cc76639fb07c59ac43288bb8">GetReconstructionGradientRequired</a>()) {</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>    <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#af59700a2ce4edce862248ba52bdca025">GetKind_Gradient_Method_Recon</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4afda8790c8835b1a9827c006a31ea8465">GREEN_GAUSS</a>)</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>      <a class="code hl_function" href="classCSolver.html#a1b8b8b923658b7e099dc1f5c86a1dd4d">SetSolution_Gradient_GG</a>(geometry, config, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#af59700a2ce4edce862248ba52bdca025">GetKind_Gradient_Method_Recon</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a8e655dfdcc23cb033e14c30ff83f9df2">LEAST_SQUARES</a>)</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>      <a class="code hl_function" href="classCSolver.html#a517cd065a6aef8177158c3cd51e81738">SetSolution_Gradient_LS</a>(geometry, config, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>    <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#af59700a2ce4edce862248ba52bdca025">GetKind_Gradient_Method_Recon</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a06b4cd5e24ce8576f9329c2b5f75ba82">WEIGHTED_LEAST_SQUARES</a>)</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>      <a class="code hl_function" href="classCSolver.html#a517cd065a6aef8177158c3cd51e81738">SetSolution_Gradient_LS</a>(geometry, config, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>  }</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>  <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#a83d5144467a2c2fa78a7f9cc19026421">GetKind_Gradient_Method</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4afda8790c8835b1a9827c006a31ea8465">GREEN_GAUSS</a>) <a class="code hl_function" href="classCSolver.html#a1b8b8b923658b7e099dc1f5c86a1dd4d">SetSolution_Gradient_GG</a>(geometry, config);</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>  <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#a83d5144467a2c2fa78a7f9cc19026421">GetKind_Gradient_Method</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a06b4cd5e24ce8576f9329c2b5f75ba82">WEIGHTED_LEAST_SQUARES</a>) <a class="code hl_function" href="classCSolver.html#a517cd065a6aef8177158c3cd51e81738">SetSolution_Gradient_LS</a>(geometry, config);</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span> </div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>  <span class="comment">/*--- Limiter computation (upwind reconstruction) ---*/</span></div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span> </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>  <span class="keywordflow">if</span> (limiter &amp;&amp; !Output) <a class="code hl_function" href="classCSolver.html#a6bc3916452ffa54c2436de7bb627fefa">SetSolution_Limiter</a>(geometry, config);</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span> </div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>  <span class="comment">/*--- Compute gradients adj for viscous term coupling ---*/</span></div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span> </div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>  <span class="keywordflow">if</span> ((config-&gt;<a class="code hl_function" href="classCConfig.html#a77312cf52a5ba2cc1239b7cee6fce7a7">GetKind_Solver</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a44d6272fd9607cb31468949e83b21a1caf22389272c967284acc10130b9ce0e6c">MAIN_SOLVER::ADJ_RANS</a>) &amp;&amp; (!config-&gt;<a class="code hl_function" href="classCConfig.html#a693b7f150eb8b7a455e4174d4af744b8">GetFrozen_Visc_Cont</a>())) {</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>    <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#a83d5144467a2c2fa78a7f9cc19026421">GetKind_Gradient_Method</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4afda8790c8835b1a9827c006a31ea8465">GREEN_GAUSS</a>) solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#a1b8b8b923658b7e099dc1f5c86a1dd4d">SetSolution_Gradient_GG</a>(geometry, config);</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>    <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#a83d5144467a2c2fa78a7f9cc19026421">GetKind_Gradient_Method</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a06b4cd5e24ce8576f9329c2b5f75ba82">WEIGHTED_LEAST_SQUARES</a>) solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#a517cd065a6aef8177158c3cd51e81738">SetSolution_Gradient_LS</a>(geometry, config);</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>  }</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span> </div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>  <span class="comment">/*--- Artificial dissipation for centered schemes ---*/</span></div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span> </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>  <span class="keywordflow">if</span> (center_jst &amp;&amp; (iMesh == <a class="code hl_variable" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>)) {</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>    <a class="code hl_function" href="classCAdjEulerSolver.html#af1b72ed76900f821d2f51942cb4252db">SetCentered_Dissipation_Sensor</a>(geometry, config);</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>    <a class="code hl_function" href="classCSolver.html#ae9fa6bf0e3ef0dff07dd85e0a87eef4d">SetUndivided_Laplacian</a>(geometry, config);</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>  }</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span> </div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>  <span class="comment">/*--- Initialize the Jacobian for implicit integration ---*/</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>  <span class="keywordflow">if</span> (implicit) <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#a8f974ad2e089dccfc99ea21a4ef5a819">SetValZero</a>();</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>  <span class="comment">/*--- Error message ---*/</span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span> </div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>  <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#aa495414133c826e5f6651d4ce82d0ef6">GetComm_Level</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a98b1b0d541147aaee4b7100c8b0892e6a686cd34998b25d1929374643e062a074">COMM_FULL</a>) {</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span><span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> MyErrorCounter = nonPhysicalPoints; nonPhysicalPoints = 0;</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>    <a class="code hl_function" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyErrorCounter, &amp;nonPhysicalPoints, 1, <a class="code hl_define" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, <a class="code hl_define" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code hl_function" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    <span class="keywordflow">if</span> (iMesh == <a class="code hl_variable" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>) config-&gt;<a class="code hl_function" href="classCConfig.html#a434fe0922532828b7e40ded865c5ce51">SetNonphysical_Points</a>(nonPhysicalPoints);</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>  }</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span> </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>}</div>
</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span> </div>
<div class="foldopen" id="foldopen00391" data-start="{" data-end="}">
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a87064a324dd57b715155f405fc0804fc">  391</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classCAdjNSSolver.html#a87064a324dd57b715155f405fc0804fc">CAdjNSSolver::Viscous_Residual</a>(<a class="code hl_class" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code hl_class" href="classCSolver.html">CSolver</a> **solver_container, <a class="code hl_class" href="classCNumerics.html">CNumerics</a> **numerics_container,</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>                                    <a class="code hl_class" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iRKStep) {</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span> </div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>  <a class="code hl_class" href="classCNumerics.html">CNumerics</a>* numerics = numerics_container[<a class="code hl_variable" href="option__structure_8hpp.html#a8a925ac62604ec86956557ab2acfb3f9">VISC_TERM</a>];</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span> </div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iPoint, jPoint, iEdge;</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>  <span class="keywordtype">bool</span> implicit = (config-&gt;<a class="code hl_function" href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">GetKind_TimeIntScheme</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>);</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span> </div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>  <span class="keywordflow">for</span> (iEdge = 0; iEdge &lt; geometry-&gt;<a class="code hl_function" href="classCGeometry.html#aba89cceede61b33426b2783385431f5b">GetnEdge</a>(); iEdge++) {</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span> </div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>    <span class="comment">/*--- Points in edge, coordinates and normal vector---*/</span></div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    iPoint = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code hl_function" href="classCEdge.html#a5cd6f283cb2f3e4dfc037c0db6ae1055">GetNode</a>(iEdge,0);</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    jPoint = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code hl_function" href="classCEdge.html#a5cd6f283cb2f3e4dfc037c0db6ae1055">GetNode</a>(iEdge,1);</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span> </div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a6ca4a8e17d68ea63f1dba96cd5f2967d">SetCoord</a>(geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(iPoint), geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(jPoint));</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a93fd2262832ae5081317548f2f9cdbb3">SetNormal</a>(geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code hl_function" href="classCEdge.html#a4ace970590e47bd39ea5780c3e0e2037">GetNormal</a>(iEdge));</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span> </div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>    <span class="comment">/*--- Primitive variables w/o reconstruction and adjoint variables w/o reconstruction---*/</span></div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span> </div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a028c500ba7ce96d3af061fc8218f76f1">SetPrimitive</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a2925893e2535d4b24f8f3e9c4339b8b2">GetPrimitive</a>(iPoint),</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>                           solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a2925893e2535d4b24f8f3e9c4339b8b2">GetPrimitive</a>(jPoint));</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span> </div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a7a305597659a44840687afc1c1e0da6b">SetAdjointVar</a>(<a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint), <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(jPoint));</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span> </div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    <span class="comment">/*--- Gradient and limiter of Adjoint Variables ---*/</span></div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span> </div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>    numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a254b157377df5d326d24ee75e6e3676c">SetAdjointVarGradient</a>(<a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a3215c20563e6d4bbeb4020d6161b48e5">GetGradient</a>(iPoint), <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a3215c20563e6d4bbeb4020d6161b48e5">GetGradient</a>(jPoint));</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span> </div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>    <span class="comment">/*--- Compute residual ---*/</span></div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span> </div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>    numerics-&gt;<a class="code hl_function" href="classCNumerics.html#aa0ca13663a047ef2640b377b33875e29">ComputeResidual</a>(<a class="code hl_variable" href="classCSolver.html#a313f866523cd6bed20eb620faee4b73a">Residual_i</a>, <a class="code hl_variable" href="classCSolver.html#a1d6e05a7a904684360013dff7b241be6">Residual_j</a>, <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>, <a class="code hl_variable" href="classCSolver.html#ae31efca489e7d21f78b5c63c7c353134">Jacobian_ij</a>, <a class="code hl_variable" href="classCSolver.html#aeca105abe8a547328e2b1a320708b226">Jacobian_ji</a>, <a class="code hl_variable" href="classCSolver.html#a0ff55af7303be290661b65f60a037a42">Jacobian_jj</a>, config);</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span> </div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    <span class="comment">/*--- Update adjoint viscous residual ---*/</span></div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span> </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code hl_function" href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">SubtractBlock</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#a313f866523cd6bed20eb620faee4b73a">Residual_i</a>);</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code hl_function" href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">AddBlock</a>(jPoint, <a class="code hl_variable" href="classCSolver.html#a1d6e05a7a904684360013dff7b241be6">Residual_j</a>);</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span> </div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>      <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#a423b77066cf386dd6e4b95a656e4aadb">SubtractBlock2Diag</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>);</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>      <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#aaa63a679856fad3b4e76f9085b0ca40f">SubtractBlock</a>(iPoint, jPoint, <a class="code hl_variable" href="classCSolver.html#ae31efca489e7d21f78b5c63c7c353134">Jacobian_ij</a>);</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>      <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#a03a189a2120be05e21fbd9b120549427">AddBlock</a>(jPoint, iPoint, <a class="code hl_variable" href="classCSolver.html#aeca105abe8a547328e2b1a320708b226">Jacobian_ji</a>);</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>      <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#a5a4ef7eeb7f009450f575660108ed7be">AddBlock2Diag</a>(jPoint, <a class="code hl_variable" href="classCSolver.html#a0ff55af7303be290661b65f60a037a42">Jacobian_jj</a>);</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    }</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span> </div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>  }</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span> </div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>}</div>
</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span> </div>
<div class="foldopen" id="foldopen00441" data-start="{" data-end="}">
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a3f7289e94076471c23e53da293b69645">  441</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classCAdjNSSolver.html#a3f7289e94076471c23e53da293b69645">CAdjNSSolver::Source_Residual</a>(<a class="code hl_class" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code hl_class" href="classCSolver.html">CSolver</a> **solver_container,</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>                                   <a class="code hl_class" href="classCNumerics.html">CNumerics</a> **numerics_container, <a class="code hl_class" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh) {</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span> </div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>  <a class="code hl_class" href="classCNumerics.html">CNumerics</a>* numerics = numerics_container[<a class="code hl_variable" href="option__structure_8hpp.html#a6d78d8ad6e8f106b8e77781f0b431ca6">SOURCE_FIRST_TERM</a>];</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>  <a class="code hl_class" href="classCNumerics.html">CNumerics</a>* second_numerics = numerics_container[<a class="code hl_variable" href="option__structure_8hpp.html#a1fe79b42ed6f64e83f679323332fd763">SOURCE_SECOND_TERM</a>];</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span> </div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iPoint, jPoint, iEdge;</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span> </div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>  <span class="keywordtype">bool</span> implicit = (config-&gt;<a class="code hl_function" href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">GetKind_TimeIntScheme</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>);</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>  <span class="keywordtype">bool</span> rotating_frame = config-&gt;<a class="code hl_function" href="classCConfig.html#ad201abca17f7635b19c11cc11b03b0ac">GetRotating_Frame</a>();</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span> </div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>  <span class="comment">/*--- Loop over all the points, note that we are supposing that primitive and</span></div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span><span class="comment">   adjoint gradients have been computed previously ---*/</span></div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span> </div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>  <span class="keywordflow">for</span> (iPoint = 0; iPoint &lt; <a class="code hl_variable" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a>; iPoint++) {</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span> </div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>    <span class="comment">/*--- Primitive variables w/o reconstruction, and its gradient ---*/</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span> </div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a028c500ba7ce96d3af061fc8218f76f1">SetPrimitive</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a2925893e2535d4b24f8f3e9c4339b8b2">GetPrimitive</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span> </div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>    numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a49309c657274b77aa644958053b68bf4">SetPrimVarGradient</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span> </div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <span class="comment">/*--- Gradient of adjoint variables ---*/</span></div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span> </div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a254b157377df5d326d24ee75e6e3676c">SetAdjointVarGradient</a>(<a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a3215c20563e6d4bbeb4020d6161b48e5">GetGradient</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span> </div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    <span class="comment">/*--- Set volume ---*/</span></div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span> </div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a53c24228ba235c1a0c2e4509243e5e88">SetVolume</a>(geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#acc83b19b9c7201987cc2e948a7259af8">GetVolume</a>(iPoint));</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span> </div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    <span class="comment">/*--- If turbulence computation we must add some coupling terms to the NS adjoint eq. ---*/</span></div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span> </div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    <span class="keywordflow">if</span> ((config-&gt;<a class="code hl_function" href="classCConfig.html#a77312cf52a5ba2cc1239b7cee6fce7a7">GetKind_Solver</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a44d6272fd9607cb31468949e83b21a1caf22389272c967284acc10130b9ce0e6c">MAIN_SOLVER::ADJ_RANS</a>) &amp;&amp; (!config-&gt;<a class="code hl_function" href="classCConfig.html#a693b7f150eb8b7a455e4174d4af744b8">GetFrozen_Visc_Cont</a>())) {</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span> </div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>      <span class="comment">/*--- Turbulent variables w/o reconstruction and its gradient ---*/</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>      numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a6e1c4dea51983cbe489762bd43bae41d">SetScalarVar</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287">TURB_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span> </div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>      numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a8c5ce8e8a1cb2c0bb03bf408d9a80d68">SetScalarVarGradient</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287">TURB_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a3215c20563e6d4bbeb4020d6161b48e5">GetGradient</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span> </div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>      <span class="comment">/*--- Turbulent adjoint variables w/o reconstruction and its gradient ---*/</span></div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span> </div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>      numerics-&gt;<a class="code hl_function" href="classCNumerics.html#aaf211e0fafb2ffea485a888cc5a3a725">SetTurbAdjointVar</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span> </div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>      numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a3466f25da2e4c85318ee663b2d2cb1bb">SetTurbAdjointGradient</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a3215c20563e6d4bbeb4020d6161b48e5">GetGradient</a>(iPoint), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span> </div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>      <span class="comment">/*--- Set distance to the surface ---*/</span></div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span> </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>      numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a9c9dd8be231884769f29c799db2404be">SetDistance</a>(geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#aed2e3cbb4c15d03c7cee5602e8c06985">GetWall_Distance</a>(iPoint), 0.0);</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span> </div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>    }</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span> </div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    <span class="comment">/*--- Compute residual ---*/</span></div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span> </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    numerics-&gt;<a class="code hl_function" href="classCNumerics.html#aa0ca13663a047ef2640b377b33875e29">ComputeResidual</a>(<a class="code hl_variable" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>, config);</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span> </div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    <span class="comment">/*--- Add to the residual ---*/</span></div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span> </div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>    <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code hl_function" href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">AddBlock</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>);</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span> </div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>  }</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span> </div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>  <span class="comment">/*--- If turbulence computation we must add some coupling terms to the NS adjoint eq. ---*/</span></div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span> </div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>  <span class="keywordflow">if</span> ((config-&gt;<a class="code hl_function" href="classCConfig.html#a77312cf52a5ba2cc1239b7cee6fce7a7">GetKind_Solver</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a44d6272fd9607cb31468949e83b21a1caf22389272c967284acc10130b9ce0e6c">MAIN_SOLVER::ADJ_RANS</a>) &amp;&amp; (!config-&gt;<a class="code hl_function" href="classCConfig.html#a693b7f150eb8b7a455e4174d4af744b8">GetFrozen_Visc_Cont</a>())) {</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span> </div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    <span class="keywordflow">for</span> (iEdge = 0; iEdge &lt; geometry-&gt;<a class="code hl_function" href="classCGeometry.html#aba89cceede61b33426b2783385431f5b">GetnEdge</a>(); iEdge++) {</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span> </div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>      <span class="comment">/*--- Points in edge, and normal vector ---*/</span></div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span> </div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>      iPoint = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code hl_function" href="classCEdge.html#a5cd6f283cb2f3e4dfc037c0db6ae1055">GetNode</a>(iEdge,0);</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>      jPoint = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code hl_function" href="classCEdge.html#a5cd6f283cb2f3e4dfc037c0db6ae1055">GetNode</a>(iEdge,1);</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>      second_numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a93fd2262832ae5081317548f2f9cdbb3">SetNormal</a>(geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">edges</a>-&gt;<a class="code hl_function" href="classCEdge.html#a4ace970590e47bd39ea5780c3e0e2037">GetNormal</a>(iEdge));</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span> </div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>      <span class="comment">/*--- Conservative variables w/o reconstruction ---*/</span></div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span> </div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>      second_numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a2d59a0969bac4b0e43b74ba4ec4d1eff">SetConservative</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint),</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>                                     solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(jPoint));</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span> </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>      <span class="comment">/*--- Gradient of primitive variables w/o reconstruction ---*/</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span> </div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>      second_numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a49309c657274b77aa644958053b68bf4">SetPrimVarGradient</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint),</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>                                        solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(jPoint));</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span> </div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>      <span class="comment">/*--- Viscosity ---*/</span></div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span> </div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>      second_numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a0d3d722905b8615ef2cb5d59c4b95fb3">SetLaminarViscosity</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(iPoint),</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>                                         solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(jPoint));</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span> </div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>      <span class="comment">/*--- Turbulent variables w/o reconstruction ---*/</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span> </div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>      second_numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a6e1c4dea51983cbe489762bd43bae41d">SetScalarVar</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287">TURB_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint),</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>                                solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287">TURB_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(jPoint));</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span> </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>      <span class="comment">/*--- Turbulent adjoint variables w/o reconstruction ---*/</span></div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span> </div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>      second_numerics-&gt;<a class="code hl_function" href="classCNumerics.html#aaf211e0fafb2ffea485a888cc5a3a725">SetTurbAdjointVar</a>(solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint),</div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>                                       solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(jPoint));</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span> </div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>      <span class="comment">/*--- Set distance to the surface ---*/</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span> </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>      second_numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a9c9dd8be231884769f29c799db2404be">SetDistance</a>(geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#aed2e3cbb4c15d03c7cee5602e8c06985">GetWall_Distance</a>(iPoint), geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#aed2e3cbb4c15d03c7cee5602e8c06985">GetWall_Distance</a>(jPoint));</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span> </div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>      <span class="comment">/*--- Update adjoint viscous residual ---*/</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span> </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>      second_numerics-&gt;<a class="code hl_function" href="classCNumerics.html#aa0ca13663a047ef2640b377b33875e29">ComputeResidual</a>(<a class="code hl_variable" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>, config);</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span> </div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>      <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code hl_function" href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">AddBlock</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>);</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>      <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code hl_function" href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">SubtractBlock</a>(jPoint, <a class="code hl_variable" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>);</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    }</div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span> </div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>  }</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span> </div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>  <span class="comment">// WARNING: The rotating frame source term has been placed in the second</span></div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  <span class="comment">// source term container since the section below is commented. This needs a</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>  <span class="comment">// permanent fix asap!</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span> </div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>  <span class="keywordflow">if</span> (rotating_frame) {</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span> </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>    <span class="comment">/*--- Loop over all points ---*/</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>    <span class="keywordflow">for</span> (iPoint = 0; iPoint &lt; <a class="code hl_variable" href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">nPointDomain</a>; iPoint++) {</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>      <span class="comment">/*--- Load the adjoint variables ---*/</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>      second_numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a7a305597659a44840687afc1c1e0da6b">SetAdjointVar</a>(<a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint),</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>                                     <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint));</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span> </div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>      <span class="comment">/*--- Load the volume of the dual mesh cell ---*/</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>      second_numerics-&gt;<a class="code hl_function" href="classCNumerics.html#a53c24228ba235c1a0c2e4509243e5e88">SetVolume</a>(geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#acc83b19b9c7201987cc2e948a7259af8">GetVolume</a>(iPoint));</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span> </div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>      <span class="comment">/*--- Compute the adjoint rotating frame source residual ---*/</span></div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>      second_numerics-&gt;<a class="code hl_function" href="classCNumerics.html#aa0ca13663a047ef2640b377b33875e29">ComputeResidual</a>(<a class="code hl_variable" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>, <a class="code hl_variable" href="classCSolver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a>, config);</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span> </div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>      <span class="comment">/*--- Add the source residual to the total ---*/</span></div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>      <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code hl_function" href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">AddBlock</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">Residual</a>);</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span> </div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>      <span class="comment">/*--- Add the implicit Jacobian contribution ---*/</span></div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>      <span class="keywordflow">if</span> (implicit) <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#a5a4ef7eeb7f009450f575660108ed7be">AddBlock2Diag</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a>);</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span> </div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    }</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>  }</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>}</div>
</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span> </div>
<div class="foldopen" id="foldopen00583" data-start="{" data-end="}">
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a6e72f094190680fa7fb078d7aae9c1d8">  583</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classCAdjNSSolver.html#a6e72f094190680fa7fb078d7aae9c1d8">CAdjNSSolver::Viscous_Sensitivity</a>(<a class="code hl_class" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code hl_class" href="classCSolver.html">CSolver</a> **solver_container, <a class="code hl_class" href="classCNumerics.html">CNumerics</a> *numerics, <a class="code hl_class" href="classCConfig.html">CConfig</a> *config) {</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span> </div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iVertex, iPoint;</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim, jDim, iMarker, iPos, jPos;</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *d = <span class="keyword">nullptr</span>, div_phi, *Normal = <span class="keyword">nullptr</span>, Area,</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>  normal_grad_psi5, normal_grad_T, sigma_partial, Laminar_Viscosity = 0.0, heat_flux_factor, temp_sens = 0.0,</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>  *Psi = <span class="keyword">nullptr</span>, *U = <span class="keyword">nullptr</span>, Enthalpy, gradPsi5_v, psi5_tau_partial, psi5_tau_grad_vel, source_v_1, Density,</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>  Pressure = 0.0, div_vel, val_turb_ke, vartheta, vartheta_partial, psi5_p_div_vel, Omega[3], rho_v[3] = {0.0,0.0,0.0},</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>  CrossProduct[3], r, ru, rv, rw, rE, p, T, dp_dr, dp_dru,</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>  dp_drv, dp_drw, dp_drE, dH_dr, dH_dru, dH_drv, dH_drw, dH_drE, H, D[3][3], Dd[3], Mach_Inf, eps, scale = 1.0,</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>  RefVel2, RefDensity, Mach2Vel, *Velocity_Inf, factor;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span> </div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>  <span class="keyword">auto</span> *USens = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>  <span class="keyword">auto</span> *UnitNormal = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>  <span class="keyword">auto</span> *normal_grad_vel = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>  <span class="keyword">auto</span> *tang_deriv_psi5 = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>  <span class="keyword">auto</span> *tang_deriv_T = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>  <span class="keyword">auto</span> **Sigma = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span> </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>    Sigma[iDim] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span> </div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>  <span class="keyword">auto</span> *normal_grad_gridvel = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>  <span class="keyword">auto</span> *normal_grad_v_ux =<span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>  <span class="keyword">auto</span> **Sigma_Psi5v = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    Sigma_Psi5v[iDim] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>  <span class="keyword">auto</span> **tau = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>    tau[iDim] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>  <span class="keyword">auto</span> *Velocity = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span> </div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>  <span class="keywordtype">bool</span> rotating_frame    = config-&gt;<a class="code hl_function" href="classCConfig.html#ad201abca17f7635b19c11cc11b03b0ac">GetRotating_Frame</a>();</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>  <span class="keywordtype">bool</span> grid_movement     = config-&gt;<a class="code hl_function" href="classCConfig.html#a9182d3dbb0b3bfa2ebb944f18795f5ca">GetGrid_Movement</a>();</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> RefArea    = config-&gt;<a class="code hl_function" href="classCConfig.html#a515e35504ab34bf25d222e377f3b4c81">GetRefArea</a>();</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Mach_Motion     = config-&gt;<a class="code hl_function" href="classCConfig.html#a5442ec644c8d291d3e07c158ba5d54a4">GetMach_Motion</a>();</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ObjFunc = config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>();</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Gas_Constant    = config-&gt;<a class="code hl_function" href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">GetGas_ConstantND</a>();</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Cp              = (<a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> / <a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>) * Gas_Constant;</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Prandtl_Lam     = config-&gt;<a class="code hl_function" href="classCConfig.html#a502035c2b049606186e11e01b7df626a">GetPrandtl_Lam</a>();</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span> </div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>  <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#ab05a2ea2f4079504565628130bee2ae3">GetSystemMeasurements</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) scale = 1.0/12.0;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>  <span class="keywordflow">else</span> scale = 1.0;</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span> </div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>  <span class="comment">/*--- Compute non-dimensional factor. For dynamic meshes, use the motion Mach</span></div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span><span class="comment">   number as a reference value for computing the force coefficients.</span></div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span><span class="comment">   Otherwise, use the freestream values,</span></div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span><span class="comment">   which is the standard convention. ---*/</span></div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span> </div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>  <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    Mach2Vel = <a class="code hl_function" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(<a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>*Gas_Constant*config-&gt;<a class="code hl_function" href="classCConfig.html#afa49e1ce7793a31cc572d957caffaef9">GetTemperature_FreeStreamND</a>());</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    RefVel2 = (Mach_Motion*Mach2Vel)*(Mach_Motion*Mach2Vel);</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>  }</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>    Velocity_Inf = config-&gt;<a class="code hl_function" href="classCConfig.html#a13840ca712bf87d32d18917d0c39cfae">GetVelocity_FreeStreamND</a>();</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    RefVel2 = 0.0;</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>    <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>      RefVel2  += Velocity_Inf[iDim]*Velocity_Inf[iDim];</div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>  }</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span> </div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>  RefDensity  = config-&gt;<a class="code hl_function" href="classCConfig.html#af30dc08c28dd72bfcedc6a5a4e224036">GetDensity_FreeStreamND</a>();</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span> </div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>  factor = 1.0;</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>  <span class="comment">/*-- For multi-objective problems these scaling factors are applied before solution ---*/</span></div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>  <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#aad80e2ae9bc0b7b1fed6ccc2b6b2bce0">GetnObj</a>()==1) {</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    factor = 1.0/(0.5*RefDensity*RefArea*RefVel2);</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span> </div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>    <span class="keywordflow">if</span> ((ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7">INVERSE_DESIGN_HEATFLUX</a>) ||</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>        (ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a">TOTAL_HEATFLUX</a>) || (ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a>) ||</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>        (ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa2d1bc11eae99ce594d0a2281210e64d4">SURFACE_MASSFLOW</a>))</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>      factor = 1.0;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span> </div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>    <span class="keywordflow">if</span> ((ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa996eee7e64825e2976ea751d9ef2c6c1">SURFACE_TOTAL_PRESSURE</a>) || (ObjFunc == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aae0adda208c6e887373a12474a9e6d9e2">SURFACE_STATIC_PRESSURE</a>))</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>      factor = 1.0/<a class="code hl_variable" href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">Area_Monitored</a>;</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span> </div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>  }</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span> </div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span> </div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>  <span class="comment">/*--- Compute gradient of the grid velocity, if applicable ---*/</span></div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span> </div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>  <span class="keywordflow">if</span> (grid_movement)</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>    <a class="code hl_function" href="classCSolver.html#a287c7f92e934ae07a3b772c0752142e7">SetGridVel_Gradient</a>(geometry, config);</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span> </div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">Total_Sens_Geo</a> = 0.0;</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a> = 0.0;</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a> = 0.0;</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a> = 0.0;</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>  <a class="code hl_variable" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a> = 0.0;</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span> </div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span> </div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>    <a class="code hl_variable" href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">Sens_Geo</a>[iMarker] = 0.0;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span> </div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>    <span class="keywordflow">if</span> ((config-&gt;<a class="code hl_function" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a>) ||</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>        (config-&gt;<a class="code hl_function" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a>)) {</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span> </div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>      <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++) {</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span> </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>        iPoint = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span> </div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>        <span class="keywordflow">if</span> (geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span> </div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>          <span class="keyword">const</span> <span class="keyword">auto</span> PsiVar_Grad = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a3215c20563e6d4bbeb4020d6161b48e5">GetGradient</a>(iPoint);</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>          <span class="keyword">const</span> <span class="keyword">auto</span> PrimVar_Grad = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint);</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span> </div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>          Laminar_Viscosity = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(iPoint);</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span> </div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>          heat_flux_factor = Cp * Laminar_Viscosity / Prandtl_Lam;</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span> </div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>          <span class="comment">/*--- Compute face area and the unit normal to the surface ---*/</span></div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span> </div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>          Normal = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>();</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>          Area = <a class="code hl_function" href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a>(<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, Normal);</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) { UnitNormal[iDim] = Normal[iDim] / Area; }</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span> </div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>          <span class="comment">/*--- Compute the sensitivity related to the temperature ---*/</span></div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span> </div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span> </div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>          normal_grad_psi5 = 0.0; normal_grad_T = 0.0;</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>            normal_grad_psi5 += PsiVar_Grad[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim]*UnitNormal[iDim];</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>            normal_grad_T += PrimVar_Grad[0][iDim]*UnitNormal[iDim];</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>          }</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span> </div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>          temp_sens = 0.0;</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>          <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a>) {</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span> </div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>            <span class="comment">/*--- Heat Flux Term: temp_sens = (\partial_tg \psi_5)\cdot (k \partial_tg T) ---*/</span></div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span> </div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>              tang_deriv_psi5[iDim] = PsiVar_Grad[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim] - normal_grad_psi5*UnitNormal[iDim];</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>              tang_deriv_T[iDim] = PrimVar_Grad[0][iDim] - normal_grad_T*UnitNormal[iDim];</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>            }</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>              temp_sens += heat_flux_factor * tang_deriv_psi5[iDim] * tang_deriv_T[iDim];</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span> </div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a>) {</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span> </div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>            <span class="comment">/*--- Isothermal Term: temp_sens = - k * \partial_n(\psi_5) * \partial_n(T) ---*/</span></div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span> </div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>            temp_sens = - heat_flux_factor * normal_grad_psi5 * normal_grad_T;</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span> </div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>          }</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span> </div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span> </div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>          <span class="comment">/*--- Term: sigma_partial = \Sigma_{ji} n_i \partial_n v_j ---*/</span></div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span> </div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>          div_phi = 0.0;</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>            div_phi += PsiVar_Grad[iDim+1][iDim];</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>            <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>              Sigma[iDim][jDim] = Laminar_Viscosity * (PsiVar_Grad[iDim+1][jDim]+PsiVar_Grad[jDim+1][iDim]);</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>          }</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>            Sigma[iDim][iDim] -= <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Laminar_Viscosity * div_phi;</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span> </div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span> </div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>            normal_grad_vel[iDim] = 0.0;</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>            <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>              normal_grad_vel[iDim] += PrimVar_Grad[iDim+1][jDim]*UnitNormal[jDim];</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>          }</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span> </div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>          sigma_partial = 0.0;</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>            <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>              sigma_partial += UnitNormal[iDim]*Sigma[iDim][jDim]*normal_grad_vel[jDim];</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span> </div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>          <span class="comment">/*--- Compute additional terms in the surface sensitivity for</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span><span class="comment">           moving walls in a rotating frame or dynamic mesh problem. ---*/</span></div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span> </div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>          <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span> </div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>            Psi = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint);</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>            U = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint);</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>            Density = U[0];</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>            Pressure = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">GetPressure</a>(iPoint);</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>            Enthalpy = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a525636dad6b2064101677df44f274443">GetEnthalpy</a>(iPoint);</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span> </div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>            <span class="comment">/*--- Turbulent kinetic energy ---*/</span></div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>            <span class="comment">// turb_ke is not considered in the stress tensor, see #797</span></div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>            val_turb_ke = 0.0;</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>            <a class="code hl_function" href="classCNumerics.html#a18b6238c38e05339954c0bb6121203d1">CNumerics::ComputeStressTensor</a>(<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, tau, PrimVar_Grad+1, Laminar_Viscosity, Density, val_turb_ke);</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>            <span class="comment">/*--- Form normal_grad_gridvel = \partial_n (u_omega) ---*/</span></div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span> </div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>            <span class="keyword">const</span> <span class="keyword">auto</span> GridVel_Grad = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#a870a64e09cf1a2be5909ccc8f1483d50">GetGridVel_Grad</a>(iPoint);</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>              normal_grad_gridvel[iDim] = 0.0;</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>              <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>                normal_grad_gridvel[iDim] += GridVel_Grad[iDim][jDim]*UnitNormal[jDim];</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>            }</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span> </div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>            <span class="comment">/*--- Form normal_grad_v_ux = \partial_n (v - u_omega) ---*/</span></div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span> </div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>              normal_grad_v_ux[iDim] = normal_grad_vel[iDim] - normal_grad_gridvel[iDim];</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span> </div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>            <span class="comment">/*--- Form Sigma_Psi5v ---*/</span></div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span> </div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>            div_vel = 0.0;</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>            <span class="keywordflow">for</span> (iDim = 0 ; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>              Velocity[iDim] = U[iDim+1]/Density;</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>              div_vel += PrimVar_Grad[iDim+1][iDim];</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>            }</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span> </div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>            gradPsi5_v = 0.0;</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>              gradPsi5_v += PsiVar_Grad[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1][iDim]*Velocity[iDim];</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>              <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>                Sigma_Psi5v[iDim][jDim] = Laminar_Viscosity * (PsiVar_Grad[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1][iDim]*Velocity[jDim]+PsiVar_Grad[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1][jDim]*Velocity[iDim]);</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>            }</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>              Sigma_Psi5v[iDim][iDim] -= <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Laminar_Viscosity * gradPsi5_v;</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span> </div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span> </div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>            <span class="comment">/*--- Now compute terms of the surface sensitivity ---*/</span></div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span> </div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>            <span class="comment">/*--- Form vartheta_partial = \vartheta * \partial_n (v - u_x) . n ---*/</span></div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>            vartheta = Density*Psi[0] + Density*Enthalpy*Psi[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1];</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>              vartheta += U[iDim+1]*Psi[iDim+1];</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>            }</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>            vartheta_partial = 0.0;</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>              vartheta_partial += vartheta * normal_grad_v_ux[iDim] * UnitNormal[iDim];</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span> </div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>            <span class="comment">/*--- Form sigma_partial = n_i ( \Sigma_Phi_{ij} + \Sigma_Psi5v_{ij} ) \partial_n (v - u_x)_j ---*/</span></div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span> </div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>            sigma_partial = 0.0;</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>              <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>                sigma_partial += UnitNormal[iDim]*(Sigma[iDim][jDim]+Sigma_Psi5v[iDim][jDim])*normal_grad_v_ux[jDim];</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span> </div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>            <span class="comment">/*--- Form psi5_tau_partial = \Psi_5 * \partial_n (v - u_x)_i * tau_{ij} * n_j ---*/</span></div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span> </div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>            psi5_tau_partial = 0.0;</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>              <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>                psi5_tau_partial -= Psi[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*normal_grad_v_ux[iDim]*tau[iDim][jDim]*UnitNormal[jDim];</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span> </div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>            <span class="comment">/*--- Form psi5_p_div_vel = ---*/</span></div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span> </div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>            psi5_p_div_vel = -Psi[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*Pressure*div_vel;</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span> </div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>            <span class="comment">/*--- Form psi5_tau_grad_vel = \Psi_5 * tau_{ij} : \nabla( v ) ---*/</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span> </div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>            psi5_tau_grad_vel = 0.0;</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>              <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>                psi5_tau_grad_vel += Psi[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*tau[iDim][jDim]*PrimVar_Grad[iDim+1][jDim];</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span> </div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>            <span class="comment">/*--- Retrieve the angular velocity vector ---*/</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span> </div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>            source_v_1 = 0.0;</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>            <span class="keywordflow">if</span> (rotating_frame) {</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span> </div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>              <span class="keywordflow">for</span> (iDim = 0; iDim &lt; 3; iDim++){</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>                Omega[iDim] = config-&gt;<a class="code hl_function" href="classCConfig.html#a3f9890ff8ca2b98646e4ebf3de8c9c13">GetRotation_Rate</a>(iDim)/config-&gt;<a class="code hl_function" href="classCConfig.html#ab3ab2f06b6d038aea73beed05cd13448">GetOmega_Ref</a>();</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>              }</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span> </div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>              <span class="comment">/*--- Calculate momentum source terms as: rho * ( Omega X V ) ---*/</span></div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span> </div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>              <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>                rho_v[iDim] = U[iDim+1];</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>              <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) rho_v[2] = 0.0;</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span> </div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>              CrossProduct[0] = Omega[1]*rho_v[2] - Omega[2]*rho_v[1];</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>              CrossProduct[1] = Omega[2]*rho_v[0] - Omega[0]*rho_v[2];</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>              CrossProduct[2] = Omega[0]*rho_v[1] - Omega[1]*rho_v[0];</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span> </div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span> </div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>              <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>                source_v_1 += Psi[iDim+1]*CrossProduct[iDim];</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>              }</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>            }</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span> </div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>            <span class="comment">/*--- For simplicity, store all additional terms within sigma_partial ---*/</span></div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span> </div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>            sigma_partial = sigma_partial + vartheta_partial + psi5_tau_partial + psi5_p_div_vel + psi5_tau_grad_vel + source_v_1;</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span> </div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>          }</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span> </div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>          <span class="comment">/*--- Compute sensitivity for each surface point ---*/</span></div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span> </div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>          <a class="code hl_variable" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a>[iMarker][iVertex] = (sigma_partial - temp_sens) * Area * scale * factor;</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span> </div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>          <span class="comment">/*--- If sharp edge, set the sensitivity to 0 on that region ---*/</span></div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span> </div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>          <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#ab33081c547f43eb27cc54852d4629dd3">GetSens_Remove_Sharp</a>()) {</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>            eps = config-&gt;<a class="code hl_function" href="classCConfig.html#a3bd1de6bcb6cd7062816341b0d956459">GetVenkat_LimiterCoeff</a>()*config-&gt;<a class="code hl_function" href="classCConfig.html#a7c7b4b489dcb3b505c091de0ae300891">GetRefElemLength</a>();</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>            <span class="keywordflow">if</span> ( geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#adc3f21497e23f4d682d62ed454daac66">GetSharpEdge_Distance</a>(iPoint) &lt; config-&gt;<a class="code hl_function" href="classCConfig.html#ac421daafab2ffc8171aba0a05ce017ab">GetAdjSharp_LimiterCoeff</a>()*eps )</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>              <a class="code hl_variable" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a>[iMarker][iVertex] = 0.0;</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>          }</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span> </div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>          <a class="code hl_variable" href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">Sens_Geo</a>[iMarker] -= <a class="code hl_variable" href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CSensitivity</a>[iMarker][iVertex];</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span> </div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>        }</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>      }</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span> </div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">Total_Sens_Geo</a> += <a class="code hl_variable" href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">Sens_Geo</a>[iMarker];</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span> </div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>    }</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>  }</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span> </div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>  <span class="comment">/*--- Farfield Sensitivity (Mach, AoA, Press, Temp), only for compressible flows ---*/</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span> </div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span> </div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>    <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba2017081e4aa73a6aef6fdd6b3a380fbf">FAR_FIELD</a> || config-&gt;<a class="code hl_function" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba6dc1b159829aa7885fc905d3d81f28bd">INLET_FLOW</a> ||</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>        config-&gt;<a class="code hl_function" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba8e57aa6eae14b4e84e2ebd0be0d385fb">SUPERSONIC_INLET</a> || config-&gt;<a class="code hl_function" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820bacaed259788fb153495d0901f31e529bf">SUPERSONIC_OUTLET</a> ||</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>        config-&gt;<a class="code hl_function" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba938badc8671d389b99bd9ae9eb6cfa73">ENGINE_INFLOW</a>  ) {</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span> </div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker]  = 0.0;</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker]   = 0.0;</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] = 0.0;</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker]  = 0.0;</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a3f9e8576dc150e551bd19a64b1d43977">Sens_BPress</a>[iMarker] = 0.0;</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span> </div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>      <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++) {</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>        iPoint = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span> </div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>        <span class="keywordflow">if</span> (geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>          Psi = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint);</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>          U = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint);</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>          Normal = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>();</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span> </div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>          Mach_Inf   = config-&gt;<a class="code hl_function" href="classCConfig.html#a5a078901bb388e9caa9cb856e3348f0b">GetMach</a>();</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>          <span class="keywordflow">if</span> (grid_movement) Mach_Inf = config-&gt;<a class="code hl_function" href="classCConfig.html#a5442ec644c8d291d3e07c158ba5d54a4">GetMach_Motion</a>();</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span> </div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>          r = U[0]; ru = U[1]; rv = U[2];</div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { rw = 0.0; rE = U[3]; }</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>          <span class="keywordflow">else</span> { rw = U[3]; rE = U[4]; }</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>          p = <a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*(rE-(ru*ru + rv*rv + rw*rw)/(2*r));</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span> </div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>          Area = <a class="code hl_function" href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a>(<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, Normal);</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) UnitNormal[iDim] = -Normal[iDim]/Area;</div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span> </div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>          H = (rE + p)/r;</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span> </div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>          dp_dr = <a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*(ru*ru + rv*rv + rw*rw)/(2*r*r);</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>          dp_dru = -<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*ru/r;</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>          dp_drv = -<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*rv/r;</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { dp_drw = 0.0; dp_drE = <a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>; }</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>          <span class="keywordflow">else</span> { dp_drw = -<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*rw/r; dp_drE = <a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>; }</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span> </div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>          dH_dr = (-H + dp_dr)/r; dH_dru = dp_dru/r; dH_drv = dp_drv/r;</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { dH_drw = 0.0; dH_drE = (1 + dp_drE)/r; }</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>          <span class="keywordflow">else</span> { dH_drw = dp_drw/r; dH_drE = (1 + dp_drE)/r; }</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span> </div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][0] = 0.0;</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][0] = Area*UnitNormal[0];</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][0] = Area*UnitNormal[1];</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][0] = 0.0;</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span> </div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][1] = (-(ru*ru)/(r*r) + dp_dr)*Area*UnitNormal[0] + (-(ru*rv)/(r*r))*Area*UnitNormal[1];</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][1] = (2*ru/r + dp_dru)*Area*UnitNormal[0] + (rv/r)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][1] = (dp_drv)*Area*UnitNormal[0] + (ru/r)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][1] = (dp_drE)*Area*UnitNormal[0];</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span> </div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][2] = (-(ru*rv)/(r*r))*Area*UnitNormal[0] + (-(rv*rv)/(r*r) + dp_dr)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][2] = (rv/r)*Area*UnitNormal[0] + (dp_dru)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][2] = (ru/r)*Area*UnitNormal[0] + (2*rv/r + dp_drv)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][2] = (dp_drE)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span> </div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][3] = (ru*dH_dr)*Area*UnitNormal[0] + (rv*dH_dr)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][3] = (H + ru*dH_dru)*Area*UnitNormal[0] + (rv*dH_dru)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][3] = (ru*dH_drv)*Area*UnitNormal[0] + (H + rv*dH_drv)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][3] = (ru*dH_drE)*Area*UnitNormal[0] + (rv*dH_drE)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>          }</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][0] = 0.0;</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][0] = Area*UnitNormal[0];</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][0] = Area*UnitNormal[1];</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][0] = Area*UnitNormal[2];</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[4][0] = 0.0;</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span> </div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][1] = (-(ru*ru)/(r*r) + dp_dr)*Area*UnitNormal[0] + (-(ru*rv)/(r*r))*Area*UnitNormal[1] + (-(ru*rw)/(r*r))*Area*UnitNormal[2];</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][1] = (2*ru/r + dp_dru)*Area*UnitNormal[0] + (rv/r)*Area*UnitNormal[1] + (rw/r)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][1] = (dp_drv)*Area*UnitNormal[0] + (ru/r)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][1] = (dp_drw)*Area*UnitNormal[0] + (ru/r)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[4][1] = (dp_drE)*Area*UnitNormal[0];</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span> </div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][2] = (-(ru*rv)/(r*r))*Area*UnitNormal[0] + (-(rv*rv)/(r*r) + dp_dr)*Area*UnitNormal[1] + (-(rv*rw)/(r*r))*Area*UnitNormal[2];</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][2] = (rv/r)*Area*UnitNormal[0] + (dp_dru)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][2] = (ru/r)*Area*UnitNormal[0] + (2*rv/r + dp_drv)*Area*UnitNormal[1] + (rw/r)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][2] = (dp_drw)*Area*UnitNormal[1] + (rv/r)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[4][2] = (dp_drE)*Area*UnitNormal[1];</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span> </div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][3] = (-(ru*rw)/(r*r))*Area*UnitNormal[0] + (-(rv*rw)/(r*r))*Area*UnitNormal[1] + (-(rw*rw)/(r*r) + dp_dr)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][3] = (rw/r)*Area*UnitNormal[0] + (dp_dru)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][3] = (rw/r)*Area*UnitNormal[1] + (dp_drv)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][3] = (ru/r)*Area*UnitNormal[0] + (rv/r)*Area*UnitNormal[1] + (2*rw/r + dp_drw)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[4][3] = (dp_drE)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span> </div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[0][4] = (ru*dH_dr)*Area*UnitNormal[0] + (rv*dH_dr)*Area*UnitNormal[1] + (rw*dH_dr)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[1][4] = (H + ru*dH_dru)*Area*UnitNormal[0] + (rv*dH_dru)*Area*UnitNormal[1] + (rw*dH_dru)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[2][4] = (ru*dH_drv)*Area*UnitNormal[0] + (H + rv*dH_drv)*Area*UnitNormal[1] + (rw*dH_drv)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[3][4] = (ru*dH_drw)*Area*UnitNormal[0] + (rv*dH_drw)*Area*UnitNormal[1] + (H + rw*dH_drw)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>            <a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[4][4] = (ru*dH_drE)*Area*UnitNormal[0] + (rv*dH_drE)*Area*UnitNormal[1] + (rw*dH_drE)*Area*UnitNormal[2];</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>          }</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span> </div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>          <span class="comment">/*--- Mach number sensitivity ---*/</span></div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span> </div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>          USens[0] = 0.0; USens[1] = ru/Mach_Inf; USens[2] = rv/Mach_Inf;</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { USens[3] = <a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>*Mach_Inf*p; }</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>          <span class="keywordflow">else</span> { USens[3] = rw/Mach_Inf; USens[4] = <a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>*Mach_Inf*p; }</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iPos++) {</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>            <span class="keywordflow">for</span> (jPos = 0; jPos &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jPos++) {</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>              <a class="code hl_variable" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker] += Psi[iPos]*<a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[jPos][iPos]*USens[jPos];</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>            }</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>          }</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span> </div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>          <span class="comment">/*--- AoA sensitivity ---*/</span></div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span> </div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>          USens[0] = 0.0;</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { USens[1] = -rv; USens[2] = ru; USens[3] = 0.0; }</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>          <span class="keywordflow">else</span> { USens[1] = -rw; USens[2] = 0.0; USens[3] = ru; USens[4] = 0.0; }</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iPos++) {</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>            <span class="keywordflow">for</span> (jPos = 0; jPos &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jPos++) {</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>              <a class="code hl_variable" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker] += Psi[iPos]*<a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[jPos][iPos]*USens[jPos];</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>            }</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>          }</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span> </div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>          <span class="comment">/*--- Pressure sensitivity ---*/</span></div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span> </div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>          USens[0] = r/p; USens[1] = ru/p; USens[2] = rv/p;</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { USens[3] = rE/p; }</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>          <span class="keywordflow">else</span> { USens[3] = rw/p; USens[4] = rE/p; }</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iPos++) {</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>            <span class="keywordflow">for</span> (jPos = 0; jPos &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jPos++) {</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>              <a class="code hl_variable" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] += Psi[iPos]*<a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[jPos][iPos]*USens[jPos];</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>            }</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>          }</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span> </div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>          <span class="comment">/*--- Temperature sensitivity ---*/</span></div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span> </div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>          T = p/(r*Gas_Constant);</div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>          USens[0] = -r/T; USens[1] = 0.5*ru/T; USens[2] = 0.5*rv/T;</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) { USens[3] = (ru*ru + rv*rv + rw*rw)/(r*T); }</div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>          <span class="keywordflow">else</span> { USens[3] = 0.5*rw/T; USens[4] = (ru*ru + rv*rv + rw*rw)/(r*T); }</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iPos++) {</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>            <span class="keywordflow">for</span> (jPos = 0; jPos &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jPos++) {</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>              <a class="code hl_variable" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker] += Psi[iPos]*<a class="code hl_variable" href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[jPos][iPos]*USens[jPos];</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>            }</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>          }</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>        }</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>      }</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span> </div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a>  -= <a class="code hl_variable" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker] * scale * factor;</div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a>   -= <a class="code hl_variable" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker] * scale * factor;</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a> -= <a class="code hl_variable" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] * scale * factor;</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a>  -= <a class="code hl_variable" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker] * scale * factor;</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span> </div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    }</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span> </div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>  }</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span> </div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>  <span class="comment">/*--- Explicit contribution from objective function quantity ---*/</span></div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span> </div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>  <span class="keywordflow">for</span> (iMarker = 0; iMarker &lt; <a class="code hl_variable" href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">nMarker</a>; iMarker++) {</div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span> </div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>    <span class="keywordflow">if</span> ((config-&gt;<a class="code hl_function" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a>) ||</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>        (config-&gt;<a class="code hl_function" href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">GetMarker_All_KindBC</a>(iMarker) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a>)) {</div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span> </div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker]  = 0.0;</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker]   = 0.0;</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] = 0.0;</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker]  = 0.0;</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a3f9e8576dc150e551bd19a64b1d43977">Sens_BPress</a>[iMarker] = 0.0;</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span> </div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>      <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[iMarker]; iVertex++) {</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>        iPoint = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span> </div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>        <span class="keywordflow">if</span> (geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span> </div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>          Normal = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[iMarker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>();</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>          p = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">GetPressure</a>(iPoint);</div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span> </div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>          Mach_Inf   = config-&gt;<a class="code hl_function" href="classCConfig.html#a5a078901bb388e9caa9cb856e3348f0b">GetMach</a>();</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>          <span class="keywordflow">if</span> (grid_movement) Mach_Inf = config-&gt;<a class="code hl_function" href="classCConfig.html#a5442ec644c8d291d3e07c158ba5d54a4">GetMach_Motion</a>();</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span> </div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>          d = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCAdjEulerVariable.html#a15674cbc0b8d9a722952c53d9b298175">GetForceProj_Vector</a>(iPoint);</div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>          Area = <a class="code hl_function" href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a>(<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, Normal);</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>          <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) UnitNormal[iDim] = -Normal[iDim]/Area;</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span> </div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>          <span class="comment">/*--- Mach number sensitivity ---*/</span></div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span> </div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) Dd[iPos] = -(2.0/Mach_Inf)*d[iPos];</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) <a class="code hl_variable" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker] += p*Dd[iPos]*Area*UnitNormal[iPos];</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span> </div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>          <span class="comment">/*--- AoA sensitivity ---*/</span></div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span> </div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>          <span class="keywordflow">if</span> (config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa8f80a9cba152af34bddb134a95f70e67">DRAG_COEFFICIENT</a> ||</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>              config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa74469d47da8b77e6328e3661964307d8">LIFT_COEFFICIENT</a> ||</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>              config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa6dbcda3aa9205f9255ff777ea28510b1">SIDEFORCE_COEFFICIENT</a> ||</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>              config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aac8b258aaf52323223d470403a2ff10b0">EQUIVALENT_AREA</a> ||</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>              config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa986b33b640b206199e379e5a22fc2278">NEARFIELD_PRESSURE</a>) {</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>              D[0][0] = 0.0; D[0][1] = -1.0;</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>              D[1][0] = 1.0; D[1][1] = 0.0;</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>            }</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>              D[0][0] = 0.0; D[0][1] = 0.0; D[0][2] = -1.0;</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>              D[1][0] = 0.0; D[1][1] = 0.0; D[1][2] = 0.0;</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>              D[2][0] = 1.0; D[2][1] = 0.0; D[2][2] = 0.0;</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>            }</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>            <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) Dd[iPos] = 0.0;</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>            <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) {</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>              <span class="keywordflow">for</span> (jPos = 0; jPos &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jPos++)</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>                Dd[iPos] += D[iPos][jPos]*d[jPos];</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>            }</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>          }</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span> </div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>          <span class="comment">/*--- Coefficients with no explicit AoA dependece ---*/</span></div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span> </div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>            <span class="keywordflow">for</span> (iPos = 0; iPos&lt;<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) Dd[iPos] = 0.0;</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>          }</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span> </div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>          <span class="keywordflow">for</span> (iPos = 0; iPos &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++)</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>            <a class="code hl_variable" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker] += p*Dd[iPos]*Area*UnitNormal[iPos];</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span> </div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>          <span class="comment">/*--- Pressure sensitivity ---*/</span></div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span> </div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>          <span class="keywordflow">for</span> (iPos = 0; iPos&lt;<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) Dd[iPos] = -(1/p)*d[iPos];</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>          <span class="keywordflow">for</span> (iPos = 0; iPos&lt;<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++)</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>            <a class="code hl_variable" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] += p*Dd[iPos]*Area*UnitNormal[iPos];</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span> </div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>          <span class="comment">/*--- Temperature sensitivity ---*/</span></div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span> </div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>          <span class="keywordflow">for</span> (iPos = 0; iPos&lt;<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++) Dd[iPos] = 0.0;</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>          <span class="keywordflow">for</span> (iPos = 0; iPos&lt;<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iPos++)</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>            <a class="code hl_variable" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker] += p*Dd[iPos]*Area*UnitNormal[iPos];</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span> </div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>        }</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>      }</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span> </div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a>  += <a class="code hl_variable" href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">Sens_Mach</a>[iMarker] * scale * factor;</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a>   += <a class="code hl_variable" href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">Sens_AoA</a>[iMarker] * scale * factor;</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a> += <a class="code hl_variable" href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">Sens_Press</a>[iMarker] * scale * factor;</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a>  += <a class="code hl_variable" href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">Sens_Temp</a>[iMarker] * scale * factor;</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span> </div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>    }</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>  }</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span> </div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span> </div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span><span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span> </div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> MyTotal_Sens_Geo   = <a class="code hl_variable" href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">Total_Sens_Geo</a>;     <a class="code hl_variable" href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">Total_Sens_Geo</a> = 0.0;</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> MyTotal_Sens_Mach  = <a class="code hl_variable" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a>;    <a class="code hl_variable" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a> = 0.0;</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> MyTotal_Sens_AoA   = <a class="code hl_variable" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a>;     <a class="code hl_variable" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a> = 0.0;</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> MyTotal_Sens_Press = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a>;   <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a> = 0.0;</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> MyTotal_Sens_Temp  = <a class="code hl_variable" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a>;    <a class="code hl_variable" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a> = 0.0;</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span> </div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>  <a class="code hl_function" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyTotal_Sens_Geo, &amp;<a class="code hl_variable" href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">Total_Sens_Geo</a>, 1, <a class="code hl_define" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code hl_define" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code hl_function" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>  <a class="code hl_function" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyTotal_Sens_Mach, &amp;<a class="code hl_variable" href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">Total_Sens_Mach</a>, 1, <a class="code hl_define" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code hl_define" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code hl_function" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>  <a class="code hl_function" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyTotal_Sens_AoA, &amp;<a class="code hl_variable" href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">Total_Sens_AoA</a>, 1, <a class="code hl_define" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code hl_define" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code hl_function" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>  <a class="code hl_function" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyTotal_Sens_Press, &amp;<a class="code hl_variable" href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">Total_Sens_Press</a>, 1, <a class="code hl_define" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code hl_define" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code hl_function" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>  <a class="code hl_function" href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">SU2_MPI::Allreduce</a>(&amp;MyTotal_Sens_Temp, &amp;<a class="code hl_variable" href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">Total_Sens_Temp</a>, 1, <a class="code hl_define" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code hl_define" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code hl_function" href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">SU2_MPI::GetComm</a>());</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span> </div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span> </div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>  <span class="keyword">delete</span> [] USens;</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>  <span class="keyword">delete</span> [] UnitNormal;</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>  <span class="keyword">delete</span> [] normal_grad_vel;</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>  <span class="keyword">delete</span> [] tang_deriv_psi5;</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>  <span class="keyword">delete</span> [] tang_deriv_T;</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>    <span class="keyword">delete</span> [] Sigma[iDim];</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>  <span class="keyword">delete</span> [] Sigma;</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>  <span class="keyword">delete</span> [] normal_grad_gridvel;</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>  <span class="keyword">delete</span> [] normal_grad_v_ux;</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>    <span class="keyword">delete</span> [] Sigma_Psi5v[iDim];</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>  <span class="keyword">delete</span> [] Sigma_Psi5v;</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>    <span class="keyword">delete</span> [] tau[iDim];</div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>  <span class="keyword">delete</span> [] tau;</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>  <span class="keyword">delete</span> [] Velocity;</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span> </div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>}</div>
</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span> </div>
<div class="foldopen" id="foldopen01167" data-start="{" data-end="}">
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#aac064a699355df483ca48c40e7c50675"> 1167</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classCAdjNSSolver.html#aac064a699355df483ca48c40e7c50675">CAdjNSSolver::BC_HeatFlux_Wall</a>(<a class="code hl_class" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code hl_class" href="classCSolver.html">CSolver</a> **solver_container, <a class="code hl_class" href="classCNumerics.html">CNumerics</a> *conv_numerics, <a class="code hl_class" href="classCNumerics.html">CNumerics</a> *visc_numerics, <a class="code hl_class" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> val_marker) {</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span> </div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim, iVar, jVar, jDim;</div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iVertex, iPoint, total_index, Point_Normal;</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span> </div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *d, l1psi, vartheta, Sigma_5, phi[3] = {};</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> sq_vel, ProjGridVel, Enthalpy = 0.0, *GridVel;</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> ViscDens, XiDens, Density, Pressure = 0.0, dPhiE_dn;</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Laminar_Viscosity = 0.0, Eddy_Viscosity = 0.0;</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Sigma_xx, Sigma_yy, Sigma_zz, Sigma_xy, Sigma_xz, Sigma_yz;</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Sigma_xx5, Sigma_yy5, Sigma_zz5, Sigma_xy5, Sigma_xz5;</div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Sigma_yz5, eta_xx, eta_yy, eta_zz, eta_xy, eta_xz, eta_yz;</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *Coord_i, *Coord_j, dist_ij_2;</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dSigmaxx_phi1, dSigmayy_phi1, dSigmazz_phi1, dSigmaxy_phi1, dSigmaxz_phi1, dSigmayz_phi1;</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dSigmaxx_phi2, dSigmayy_phi2, dSigmazz_phi2, dSigmaxy_phi2, dSigmaxz_phi2, dSigmayz_phi2;</div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dSigmaxx_phi3, dSigmayy_phi3, dSigmazz_phi3, dSigmaxy_phi3, dSigmaxz_phi3, dSigmayz_phi3;</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> dSigma5_psi5;</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span> </div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>  <span class="keywordtype">bool</span> implicit = (config-&gt;<a class="code hl_function" href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">GetKind_TimeIntScheme</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>);</div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>  <span class="keywordtype">bool</span> grid_movement  = config-&gt;<a class="code hl_function" href="classCConfig.html#a9182d3dbb0b3bfa2ebb944f18795f5ca">GetGrid_Movement</a>();</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span> </div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Prandtl_Lam  = config-&gt;<a class="code hl_function" href="classCConfig.html#a502035c2b049606186e11e01b7df626a">GetPrandtl_Lam</a>();</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Prandtl_Turb = config-&gt;<a class="code hl_function" href="classCConfig.html#a4b89ad15fa82f93ca8ccfe945e2c14a7">GetPrandtl_Turb</a>();</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span> </div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>  <span class="keyword">auto</span> *Psi = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>  <span class="keyword">auto</span> **Tau = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>    Tau[iDim] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>  <span class="keyword">auto</span> *Velocity = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>  <span class="keyword">auto</span> *Normal = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>  <span class="keyword">auto</span> *Edge_Vector = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>  <span class="keyword">auto</span> **GradPhi = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>*[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>    GradPhi[iDim] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>  <span class="keyword">auto</span> *GradPsiE = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span> </div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>  <span class="comment">/*--- Loop over all of the vertices on this boundary marker ---*/</span></div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span> </div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>  <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[val_marker]; iVertex++) {</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span> </div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>    iPoint = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span> </div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>    <span class="comment">/*--- Check if the node belongs to the domain (i.e, not a halo node) ---*/</span></div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span> </div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>    <span class="keywordflow">if</span> (geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span> </div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>      <span class="comment">/*--- Normal vector for this vertex (negate for outward convention) ---*/</span></div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span> </div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>      geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>(Normal);</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) Normal[iDim] = -Normal[iDim];</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span> </div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>      <span class="comment">/*--- Initialize the convective &amp; viscous residuals to zero ---*/</span></div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span> </div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>      <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) {</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>        <a class="code hl_variable" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[iVar] = 0.0; <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[iVar] = 0.0;</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>        <span class="keywordflow">if</span> (implicit) { <span class="keywordflow">for</span> (jVar = 0; jVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jVar ++) <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[iVar][jVar] = 0.0; }</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>      }</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span> </div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>      <span class="comment">/*--- Retrieve adjoint solution at the wall boundary node ---*/</span></div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span> </div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>      <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++)</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>        Psi[iVar] = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint,iVar);</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span> </div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>      <span class="comment">/*--- Get the force projection vector (based on the objective function) ---*/</span></div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span> </div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>      d = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCAdjEulerVariable.html#a15674cbc0b8d9a722952c53d9b298175">GetForceProj_Vector</a>(iPoint);</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span> </div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>      <span class="comment">/*--- Set the adjoint velocity BC ---*/</span></div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span> </div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) { phi[iDim] = d[iDim]; }</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span> </div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>      <span class="comment">/*--- Correct the adjoint velocity BC for dynamic meshes ---*/</span></div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span> </div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>      <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>        GridVel = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#ad7b8ff47f6645f36c9a529073343c097">GetGridVel</a>(iPoint);</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>          phi[iDim] -= Psi[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*GridVel[iDim];</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>      }</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span> </div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>      <span class="comment">/*--- Impose the value of the adjoint velocity as a strong boundary</span></div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span><span class="comment">       condition (Dirichlet). Fix the adjoint velocity and remove any addtional</span></div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span><span class="comment">       contribution to the residual at this node. ---*/</span></div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span> </div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>        <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a6ee4d8d450971204cc054a33d6473732">SetSolution_Old</a>(iPoint,iDim+1, phi[iDim]);</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span> </div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>        <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>(iPoint, iDim+1) = 0.0;</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCAdjEulerVariable.html#a14a7a77262dfba287156315a5142e923">SetVel_ResTruncError_Zero</a>(iPoint);</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span> </div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>      <span class="comment">/*--- Compute additional contributions to the adjoint density and energy</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span><span class="comment">       equations which will be added to the residual (weak imposition) ---*/</span></div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span> </div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>      <span class="comment">/*--- Energy residual due to the convective term ---*/</span></div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span> </div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>      l1psi = 0.0;</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>        l1psi += Normal[iDim]*d[iDim];</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>      <a class="code hl_variable" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = l1psi*<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>;</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span> </div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>      <span class="comment">/*--- Flux contribution and Jacobian contributions for moving</span></div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span><span class="comment">         walls. Note that these are only for the adjoint density and</span></div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span><span class="comment">         adjoint energy equations (the adjoint vel. uses a strong BC). ---*/</span></div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span> </div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>      <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span> </div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>        <span class="comment">/*--- Get the grid velocity at this node and impose v = u_wall ---*/</span></div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span> </div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>        GridVel = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#ad7b8ff47f6645f36c9a529073343c097">GetGridVel</a>(iPoint);</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) Velocity[iDim] = GridVel[iDim];</div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span> </div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>        <span class="comment">/*--- Get some additional quantities from the flow solution ---*/</span></div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span> </div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>        Density = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a4892ca545884011b7903a8e35c43b43f">GetDensity</a>(iPoint);</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>        Pressure = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">GetPressure</a>(iPoint);</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>        Enthalpy = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a525636dad6b2064101677df44f274443">GetEnthalpy</a>(iPoint);</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>        Laminar_Viscosity = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(iPoint);</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>        Eddy_Viscosity = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#adae2e4228e113624b7ab1f9ab1a493c6">GetEddyViscosity</a>(iPoint); <span class="comment">// Should be zero at the wall</span></div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span> </div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>        ViscDens = (Laminar_Viscosity + Eddy_Viscosity) / Density;</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>        XiDens = <a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> * (Laminar_Viscosity/Prandtl_Lam + Eddy_Viscosity/Prandtl_Turb) / Density;</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span> </div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>        <span class="comment">/*--- Compute projections, velocity squared divided by two, and</span></div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span><span class="comment">           other inner products. Note that we are imposing v = u_wall from</span></div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span><span class="comment">           the direct problem and that phi = d - \psi_5 * v ---*/</span></div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span> </div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>        ProjGridVel = 0.0; sq_vel = 0.0;</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>        vartheta = Psi[0] + Psi[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*Enthalpy;</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>          ProjGridVel += GridVel[iDim]*Normal[iDim];</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>          sq_vel      += 0.5*GridVel[iDim]*GridVel[iDim];</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>          vartheta    += GridVel[iDim]*phi[iDim];</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>        }</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span> </div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>        <span class="comment">/*--- Convective flux at the wall node (adjoint density) ---*/</span></div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span> </div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>        <a class="code hl_variable" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[0] = -vartheta*ProjGridVel + l1psi*<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*sq_vel;</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span> </div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>        <span class="comment">/*--- Implicit contributions from convective part ---*/</span></div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span> </div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>        <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>          <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][0] += -ProjGridVel;</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>          <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] += -ProjGridVel * Enthalpy;</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>        }</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span> </div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>        <span class="comment">/*--- Viscous flux contributions at the wall node. Impose dPhiE_dn = 0</span></div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span><span class="comment">           (adiabatic walls with frozen viscosity). ---*/</span></div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span> </div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>        dPhiE_dn = 0.0;</div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span> </div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>        <span class="comment">/*--- Store the adjoint velocity and energy gradients for clarity ---*/</span></div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span> </div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>        <span class="keyword">const</span> <span class="keyword">auto</span> PsiVar_Grad = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a3215c20563e6d4bbeb4020d6161b48e5">GetGradient</a>(iPoint);</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span>          GradPsiE[iDim] =  PsiVar_Grad[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim];</div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>          <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>            GradPhi[iDim][jDim] =  PsiVar_Grad[iDim+1][jDim];</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>        }</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span> </div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span> </div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>          <span class="comment">/*--- Compute the adjoint stress tensor ---*/</span></div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span> </div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>          Sigma_xx  = ViscDens * (<a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[0][0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1]);</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>          Sigma_yy  = ViscDens * (-<a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[1][1]);</div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>          Sigma_xy  = ViscDens * (GradPhi[1][0] + GradPhi[0][1]);</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>          Sigma_xx5 = ViscDens * ( <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[0] * GradPsiE[0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1]);</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>          Sigma_yy5 = ViscDens * (- <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[1] * GradPsiE[1]);</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>          Sigma_xy5 = ViscDens * (Velocity[0] * GradPsiE[1] + Velocity[1] * GradPsiE[0]);</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>          Sigma_5   = XiDens * dPhiE_dn;</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>          eta_xx    = Sigma_xx + Sigma_xx5;</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>          eta_yy    = Sigma_yy + Sigma_yy5;</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>          eta_xy    = Sigma_xy + Sigma_xy5;</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span> </div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>          <span class="comment">/*--- Viscous flux at the wall node (adjoint density &amp; energy only) ---*/</span></div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span> </div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>          <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[0] = - (Velocity[0] * Normal[0] * eta_xx  + Velocity[1] * Normal[1] * eta_yy</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>              + (Velocity[0] * Normal[1] + Velocity[1] * Normal[0]) * eta_xy</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>              - (sq_vel - Pressure/(Density*<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * Sigma_5);</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>          <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = Sigma_5;</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span> </div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>          <span class="comment">/*--- Computation of the Jacobians at Point i---*/</span></div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span> </div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>          <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span> </div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>            <span class="comment">/*--- Compute closest normal neighbor ---*/</span></div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span> </div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>            Point_Normal = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#ab8b0e96f9384b0a861c7a70616976b75">GetNormal_Neighbor</a>();</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span> </div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>            <span class="comment">/*--- Get coordinates of i &amp; nearest normal and compute distance ---*/</span></div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span> </div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>            Coord_i = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(iPoint);</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>            Coord_j = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(Point_Normal);</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>            dist_ij_2 = 0.0;</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>              Edge_Vector[iDim] = Coord_j[iDim]-Coord_i[iDim];</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>              dist_ij_2 += Edge_Vector[iDim]*Edge_Vector[iDim];</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>            }</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span> </div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>            dSigmaxx_phi1 = -<a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>            dSigmaxx_phi2 =   <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>            dSigmayy_phi1 =   <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>            dSigmayy_phi2 = -<a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>            dSigmaxy_phi1 = -ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>            dSigmaxy_phi2 = -ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span> </div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>            <span class="comment">//              dSigmaxx5_psi5 = -ViscDens * ( FOUR3*Velocity[0]*Edge_Vector[0] -  TWO3*Velocity[1]*Edge_Vector[1] )/dist_ij_2;</span></div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>            <span class="comment">//              dSigmayy5_psi5 = -ViscDens * (- TWO3*Velocity[0]*Edge_Vector[0] + FOUR3*Velocity[1]*Edge_Vector[1] )/dist_ij_2;</span></div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>            <span class="comment">//              dSigmaxy5_psi5 = -ViscDens * ( Velocity[0]*Edge_Vector[1] + Velocity[1]*Edge_Vector[0] )/dist_ij_2;</span></div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>            dSigma5_psi5   = -XiDens * ( Edge_Vector[0]*Normal[0] + Edge_Vector[1]*Normal[1] )/dist_ij_2;</div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span> </div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][0] += 0.0;</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][1] += -( Velocity[0]*Normal[0]*dSigmaxx_phi1 + Velocity[1]*Normal[1]*dSigmayy_phi1</div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>                + (Velocity[0]*Normal[1] + Velocity[1]*Normal[0])*dSigmaxy_phi1 );</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][2] += -( Velocity[0]*Normal[0]*dSigmaxx_phi2 + Velocity[1]*Normal[1]*dSigmayy_phi2</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>                + (Velocity[0]*Normal[1] + Velocity[1]*Normal[0])*dSigmaxy_phi2 );</div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][3] += (sq_vel - Pressure/(Density*<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * dSigma5_psi5;</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span> </div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[3][0] += 0.0;</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[3][1] += 0.0;</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[3][2] += 0.0;</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[3][3] += dSigma5_psi5;</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span> </div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>          }</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span> </div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span> </div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) {</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span> </div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>          <span class="comment">/*--- Compute the adjoint stress tensor ---*/</span></div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>          Sigma_xx  = ViscDens * (<a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[0][0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1] - <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>  * GradPhi[2][2]);</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>          Sigma_yy  = ViscDens * (-<a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[1][1] - <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>  * GradPhi[2][2]);</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>          Sigma_zz  = ViscDens * (-<a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[2][2]);</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>          Sigma_xy  = ViscDens * (GradPhi[1][0] + GradPhi[0][1]);</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>          Sigma_xz  = ViscDens * (GradPhi[2][0] + GradPhi[0][2]);</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>          Sigma_yz  = ViscDens * (GradPhi[2][1] + GradPhi[1][2]);</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>          Sigma_xx5 = ViscDens * ( <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[0] * GradPsiE[0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>          Sigma_yy5 = ViscDens * (- <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[1] * GradPsiE[1] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>          Sigma_zz5 = ViscDens * (- <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>          Sigma_xy5 = ViscDens * (Velocity[0] * GradPsiE[1] + Velocity[1] * GradPsiE[0]);</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>          Sigma_xz5 = ViscDens * (Velocity[0] * GradPsiE[2] + Velocity[2] * GradPsiE[0]);</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>          Sigma_yz5 = ViscDens * (Velocity[1] * GradPsiE[2] + Velocity[2] * GradPsiE[1]);</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>          Sigma_5   = XiDens * dPhiE_dn;</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>          eta_xx    = Sigma_xx + Sigma_xx5; eta_yy = Sigma_yy + Sigma_yy5; eta_zz = Sigma_zz + Sigma_zz5;</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>          eta_xy    = Sigma_xy + Sigma_xy5; eta_xz = Sigma_xz + Sigma_xz5; eta_yz = Sigma_yz + Sigma_yz5;</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span> </div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>          <span class="comment">/*--- Viscous flux at the wall node (adjoint density &amp; energy only) ---*/</span></div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span> </div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>          <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[0] = - (Velocity[0] * Normal[0] * eta_xx  + Velocity[1] * Normal[1] * eta_yy + Velocity[2] * Normal[2] * eta_zz</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>              + (Velocity[0] * Normal[1] + Velocity[1] * Normal[0]) * eta_xy</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>              + (Velocity[0] * Normal[2] + Velocity[2] * Normal[0]) * eta_xz</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>              + (Velocity[2] * Normal[1] + Velocity[1] * Normal[2]) * eta_yz</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>              - (sq_vel - Pressure/(Density*<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * Sigma_5);</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>          <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = Sigma_5;</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span> </div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>          <span class="comment">/*--- Computation of the Jacobians at Point i---*/</span></div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span> </div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>          <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span> </div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>            <span class="comment">/*--- Compute closest normal neighbor ---*/</span></div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span> </div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>            Point_Normal = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#ab8b0e96f9384b0a861c7a70616976b75">GetNormal_Neighbor</a>();</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span> </div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>            <span class="comment">/*--- Get coordinates of i &amp; nearest normal and compute distance ---*/</span></div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span> </div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>            Coord_i = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(iPoint);</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>            Coord_j = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">GetCoord</a>(Point_Normal);</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>            dist_ij_2 = 0.0;</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>            <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>              Edge_Vector[iDim] = Coord_j[iDim]-Coord_i[iDim];</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>              dist_ij_2 += Edge_Vector[iDim]*Edge_Vector[iDim];</div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>            }</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span> </div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>            dSigmaxx_phi1 = -<a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>            dSigmaxx_phi2 =   <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>            dSigmaxx_phi3 =   <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[2]/dist_ij_2;</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>            dSigmayy_phi1 =   <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>            dSigmayy_phi2 = -<a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>            dSigmayy_phi3 =   <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[2]/dist_ij_2;</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>            dSigmazz_phi1 =   <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>            dSigmazz_phi2 =   <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>            dSigmazz_phi3 = -<a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * ViscDens * Edge_Vector[2]/dist_ij_2;</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>            dSigmaxy_phi1 = -ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>            dSigmaxy_phi2 = -ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>            dSigmaxy_phi3 = 0;</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>            dSigmaxz_phi1 = -ViscDens * Edge_Vector[2]/dist_ij_2;</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>            dSigmaxz_phi2 = 0;</div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>            dSigmaxz_phi3 = -ViscDens * Edge_Vector[0]/dist_ij_2;</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>            dSigmayz_phi1 = 0;</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>            dSigmayz_phi2 = -ViscDens * Edge_Vector[2]/dist_ij_2;</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>            dSigmayz_phi3 = -ViscDens * Edge_Vector[1]/dist_ij_2;</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span> </div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>            <span class="comment">//              dSigmaxx5_psi5 = -ViscDens * ( FOUR3*Velocity[0]*Edge_Vector[0] -  TWO3*Velocity[1]*Edge_Vector[1] -  TWO3*Velocity[2]*Edge_Vector[2])/dist_ij_2;</span></div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>            <span class="comment">//              dSigmayy5_psi5 = -ViscDens * (- TWO3*Velocity[0]*Edge_Vector[0] + FOUR3*Velocity[1]*Edge_Vector[1] -  TWO3*Velocity[2]*Edge_Vector[2])/dist_ij_2;</span></div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>            <span class="comment">//              dSigmazz5_psi5 = -ViscDens * (- TWO3*Velocity[0]*Edge_Vector[0] -  TWO3*Velocity[1]*Edge_Vector[1] + FOUR3*Velocity[2]*Edge_Vector[2])/dist_ij_2;</span></div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>            <span class="comment">//              dSigmaxy5_psi5 = -ViscDens * ( Velocity[0]*Edge_Vector[1] + Velocity[1]*Edge_Vector[0] )/dist_ij_2;</span></div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>            <span class="comment">//              dSigmaxz5_psi5 = -ViscDens * ( Velocity[0]*Edge_Vector[2] + Velocity[2]*Edge_Vector[0] )/dist_ij_2;</span></div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>            <span class="comment">//              dSigmayz5_psi5 = -ViscDens * ( Velocity[1]*Edge_Vector[2] + Velocity[2]*Edge_Vector[1] )/dist_ij_2;</span></div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>            dSigma5_psi5   = -XiDens * ( Edge_Vector[0]*Normal[0] + Edge_Vector[1]*Normal[1] + Edge_Vector[2]*Normal[2] )/dist_ij_2;</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span> </div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][0] += 0.0;</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][1] += -( Velocity[0]*Normal[0]*dSigmaxx_phi1 + Velocity[1]*Normal[1]*dSigmayy_phi1 + Velocity[2]*Normal[2]*dSigmazz_phi1</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>                + (Velocity[0]*Normal[1] + Velocity[1]*Normal[0])*dSigmaxy_phi1</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>                + (Velocity[0]*Normal[2] + Velocity[2]*Normal[0])*dSigmaxz_phi1</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>                + (Velocity[2]*Normal[1] + Velocity[1]*Normal[2])*dSigmayz_phi1 );</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][2] += -( Velocity[0]*Normal[0]*dSigmaxx_phi2 + Velocity[1]*Normal[1]*dSigmayy_phi2 + Velocity[2]*Normal[2]*dSigmazz_phi2</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>                + (Velocity[0]*Normal[1] + Velocity[1]*Normal[0])*dSigmaxy_phi2</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>                + (Velocity[0]*Normal[2] + Velocity[2]*Normal[0])*dSigmaxz_phi2</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>                + (Velocity[2]*Normal[1] + Velocity[1]*Normal[2])*dSigmayz_phi2 );</div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][3] += -( Velocity[0]*Normal[0]*dSigmaxx_phi3 + Velocity[1]*Normal[1]*dSigmayy_phi3 + Velocity[2]*Normal[2]*dSigmazz_phi3</div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>                + (Velocity[0]*Normal[1] + Velocity[1]*Normal[0])*dSigmaxy_phi3</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>                + (Velocity[0]*Normal[2] + Velocity[2]*Normal[0])*dSigmaxz_phi3</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>                + (Velocity[2]*Normal[1] + Velocity[1]*Normal[2])*dSigmayz_phi3 );</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[0][4] += (sq_vel - Pressure/(Density*<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * dSigma5_psi5;</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span> </div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[4][0] += 0.0;</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[4][1] += 0.0;</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[4][2] += 0.0;</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[4][3] += 0.0;</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[4][4] += dSigma5_psi5;</div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span> </div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>          }</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>        }</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>      }</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span> </div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>      <span class="comment">/*--- Convective contribution to the residual at the wall ---*/</span></div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span> </div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>      <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code hl_function" href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">SubtractBlock</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>);</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span> </div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>      <span class="comment">/*--- Viscous contribution to the residual at the wall ---*/</span></div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span> </div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>      <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code hl_function" href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">SubtractBlock</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>);</div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span> </div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>      <span class="comment">/*--- Enforce the no-slip boundary condition in a strong way by</span></div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span><span class="comment">       modifying the velocity-rows of the Jacobian (1 on the diagonal). ---*/</span></div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span> </div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>      <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>        <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#a423b77066cf386dd6e4b95a656e4aadb">SubtractBlock2Diag</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>);</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>        <span class="keywordflow">for</span> (iVar = 1; iVar &lt;= <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iVar++) {</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>          total_index = iPoint*<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+iVar;</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span>          <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#a9473b0224c9b9a2749571db0bbd22a70">DeleteValsRowi</a>(total_index);</div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>        }</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>      }</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span> </div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>    }</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span> </div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span>  }</div>
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"> 1513</span> </div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>    <span class="keyword">delete</span> [] Tau[iDim];</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>  <span class="keyword">delete</span> [] Tau;</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>  <span class="keyword">delete</span> [] Psi;</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>  <span class="keyword">delete</span> [] Velocity;</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span>  <span class="keyword">delete</span> [] Normal;</div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>  <span class="keyword">delete</span> [] Edge_Vector;</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>  <span class="keyword">delete</span> [] GradPsiE;</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>    <span class="keyword">delete</span> [] GradPhi[iDim];</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>  <span class="keyword">delete</span> [] GradPhi;</div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span> </div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>}</div>
</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span> </div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span> </div>
<div class="foldopen" id="foldopen01529" data-start="{" data-end="}">
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"><a class="line" href="classCAdjNSSolver.html#a159875229feba5b14c433990e5a89d60"> 1529</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classCAdjNSSolver.html#a159875229feba5b14c433990e5a89d60">CAdjNSSolver::BC_Isothermal_Wall</a>(<a class="code hl_class" href="classCGeometry.html">CGeometry</a> *geometry, <a class="code hl_class" href="classCSolver.html">CSolver</a> **solver_container, <a class="code hl_class" href="classCNumerics.html">CNumerics</a> *conv_numerics, <a class="code hl_class" href="classCNumerics.html">CNumerics</a> *visc_numerics, <a class="code hl_class" href="classCConfig.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> val_marker) {</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span> </div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iVertex, iPoint, total_index;</div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim, iVar, jVar, jDim;</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *d, q, *U, dVisc_T, rho, pressure, div_phi,</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>  force_stress, Sigma_5, phi[3] = {0.0,0.0,0.0};</div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> phis1, phis2, sq_vel, ProjVel, Enthalpy, *GridVel, phi_u, d_n;</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Energy, ViscDens, XiDens, Density, SoundSpeed, Pressure, dPhiE_dn, Laminar_Viscosity, Eddy_Viscosity,</div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span>  Sigma_xx, Sigma_yy, Sigma_zz, Sigma_xy, Sigma_xz, Sigma_yz,</div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>  Sigma_xx5, Sigma_yy5, Sigma_zz5, Sigma_xy5, Sigma_xz5,</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>  Sigma_yz5, eta_xx, eta_yy, eta_zz, eta_xy, eta_xz, eta_yz;</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> kGTdotn=0.0, Area=0.0, Xi=0.0;</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span> </div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span>  <span class="keyword">auto</span> *Psi = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>  <span class="keyword">auto</span> **Tau = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>    Tau[iDim] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>  <span class="keyword">auto</span> *Velocity = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>  <span class="keyword">auto</span> *Normal = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span> </div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>  <span class="keyword">auto</span> **GradPhi = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>* [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>    GradPhi[iDim] = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span>  <span class="keyword">auto</span> *GradPsiE = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> [<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *GradT;<span class="comment">// = new su2double[nDim];</span></div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *GradP;</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> *GradDens;</div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>  <span class="keyword">auto</span> *dPoRho2 = <span class="keyword">new</span> <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a>[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span> </div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>  <span class="keywordtype">bool</span> implicit = (config-&gt;<a class="code hl_function" href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">GetKind_TimeIntScheme</a>() == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a>);</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>  <span class="keywordtype">bool</span> grid_movement  = config-&gt;<a class="code hl_function" href="classCConfig.html#a9182d3dbb0b3bfa2ebb944f18795f5ca">GetGrid_Movement</a>();</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>  <span class="keywordtype">bool</span> heat_flux_obj;</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span> </div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Prandtl_Lam  = config-&gt;<a class="code hl_function" href="classCConfig.html#a502035c2b049606186e11e01b7df626a">GetPrandtl_Lam</a>();</div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Prandtl_Turb = config-&gt;<a class="code hl_function" href="classCConfig.html#a4b89ad15fa82f93ca8ccfe945e2c14a7">GetPrandtl_Turb</a>();</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Gas_Constant = config-&gt;<a class="code hl_function" href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">GetGas_ConstantND</a>();</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Cp = (<a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> / <a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>) * Gas_Constant;</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Thermal_Conductivity;</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> invrho3;</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Volume;</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> mu2;</div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> gpsiAv2;</div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> gpsi5n;</div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span> </div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>  <span class="keywordtype">string</span> Marker_Tag = config-&gt;<a class="code hl_function" href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">GetMarker_All_TagBound</a>(val_marker);</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>  <span class="keywordtype">string</span> Monitoring_Tag;</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jMarker, iMarker_Monitoring=0;</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>  <a class="code hl_typedef" href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a> Weight_ObjFunc = 1.0;</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span> </div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>  <span class="comment">/*--- Identify marker monitoring index ---*/</span></div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>  <span class="keywordflow">for</span> (jMarker = 0; jMarker &lt; config-&gt;<a class="code hl_function" href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">GetnMarker_Monitoring</a>(); jMarker++) {</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>    Monitoring_Tag = config-&gt;<a class="code hl_function" href="classCConfig.html#a4558fc163c393e628050e7a2273673f1">GetMarker_Monitoring_TagBound</a>(jMarker);</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>    <span class="keywordflow">if</span> (Monitoring_Tag==Marker_Tag)</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>      iMarker_Monitoring = jMarker;</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>  }</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>  <span class="comment">/*-- Get objective weight --*/</span></div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>  Weight_ObjFunc = config-&gt;<a class="code hl_function" href="classCConfig.html#a614c55e8d7945a11d92d7b51851291c2">GetWeight_ObjFunc</a>(iMarker_Monitoring);</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>  heat_flux_obj  = ((config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a">TOTAL_HEATFLUX</a>) ||</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>                           (config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a>) ||</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>                           (config-&gt;<a class="code hl_function" href="classCConfig.html#a99e6285b421215b1995965cd534976ae">GetKind_ObjFunc</a>(iMarker_Monitoring) == <a class="code hl_enumvalue" href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7">INVERSE_DESIGN_HEATFLUX</a>));</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span> </div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>  <span class="keywordflow">for</span> (iVertex = 0; iVertex &lt; geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">nVertex</a>[val_marker]; iVertex++) {</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span> </div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span>    iPoint = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">GetNode</a>();</div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span> </div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span>    <span class="keywordflow">if</span> (geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">GetDomain</a>(iPoint)) {</div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span> </div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span>      <span class="comment">/*--- Initialize the convective &amp; viscous residuals to zero ---*/</span></div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>      <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) {</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>        <a class="code hl_variable" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[iVar] = 0.0;</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>        <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[iVar] = 0.0;</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>        <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>          <span class="keywordflow">for</span> (jVar = 0; jVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; jVar ++)</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>            <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>[iVar][jVar] = 0.0;</div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>        }</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>      }</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span> </div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>      <span class="comment">/*--- Retrieve adjoint solution at the wall boundary node ---*/</span></div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>      <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++)</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>        Psi[iVar] = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint,iVar);</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span> </div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>      <span class="comment">/*--- Normal vector for this vertex (negate for outward convention) ---*/</span></div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>      geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">vertex</a>[val_marker][iVertex]-&gt;<a class="code hl_function" href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">GetNormal</a>(Normal);</div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>      Volume = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#acc83b19b9c7201987cc2e948a7259af8">GetVolume</a>(iPoint);</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) Normal[iDim] = -Normal[iDim];</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span> </div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span>      <span class="comment">/*--- Get the force projection vector (based on the objective function) ---*/</span></div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>      d = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCAdjEulerVariable.html#a15674cbc0b8d9a722952c53d9b298175">GetForceProj_Vector</a>(iPoint);</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span> </div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span>      <span class="comment">/*--- Adjustments to strong boundary condition for dynamic meshes ---*/</span></div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>      <span class="keywordflow">if</span> ( grid_movement) {</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>        GridVel = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#ad7b8ff47f6645f36c9a529073343c097">GetGridVel</a>(iPoint);</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span>        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"> 1622</span>          phi[iDim] = d[iDim] - Psi[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1]*GridVel[iDim];</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>        }</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>          phi[iDim] = d[iDim];</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>        }</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span>      }</div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span> </div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>      <span class="comment">/*--- Strong BC imposition for the adjoint velocity equations ---*/</span></div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>        <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>(iPoint, iDim+1) = 0.0;</div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCAdjEulerVariable.html#a14a7a77262dfba287156315a5142e923">SetVel_ResTruncError_Zero</a>(iPoint);</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>        <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a6ee4d8d450971204cc054a33d6473732">SetSolution_Old</a>(iPoint,iDim+1, phi[iDim]);</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>      <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>        <span class="keywordflow">for</span> (iVar = 1; iVar &lt;= <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iVar++) {</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>          total_index = iPoint*<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+iVar;</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>          <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#a9473b0224c9b9a2749571db0bbd22a70">DeleteValsRowi</a>(total_index);</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>        }</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>      }</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span> </div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>      <span class="comment">/*--- Get transport coefficient information ---*/</span></div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>      Laminar_Viscosity    = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(iPoint);</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>      Eddy_Viscosity       = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#adae2e4228e113624b7ab1f9ab1a493c6">GetEddyViscosity</a>(iPoint);</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>      Thermal_Conductivity = Cp * ( Laminar_Viscosity/Prandtl_Lam</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>                                   +Eddy_Viscosity/Prandtl_Turb);</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span> </div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span><span class="comment">//      GradV = solver_container[FLOW_SOL]-&gt;GetNodes()-&gt;GetGradient_Primitive(iPoint);</span></div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span> </div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>      <span class="comment">/*--- Calculate Dirichlet condition for energy equation ---*/</span></div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>      <span class="keywordflow">if</span> (!heat_flux_obj) {</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span>        q = 0.0;</div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>      }</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span> </div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>        Area = <a class="code hl_function" href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a>(<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>, Normal);</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span> </div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>        <span class="comment">/*--- Temperature gradient term ---*/</span></div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>        GradT = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint)[0];</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>        kGTdotn = 0.0;</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>          kGTdotn += Cp * Laminar_Viscosity/Prandtl_Lam*GradT[iDim]*Normal[iDim]/Area;</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>        <span class="comment">// Cp * Viscosity/Prandtl_Lam matches term used in solver_direct_mean</span></div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span>        <span class="comment">/*--- constant term to multiply max heat flux objective ---*/</span></div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>        Xi = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#a3a9516a882682f02bd9ab15d209740e5">GetTotal_HeatFlux</a>(); <span class="comment">// versions for max heat flux</span></div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>        Xi = <a class="code hl_function" href="group__SIMD.html#ga768cbdeba8e4567257959378fba27f17">pow</a>(Xi, 1.0/<a class="code hl_variable" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a>-1.0)/<a class="code hl_variable" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a>;</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span> </div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>        <span class="comment">/*--- Boundary condition value ---*/</span></div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span>        q = Xi * <a class="code hl_variable" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a> * <a class="code hl_function" href="group__SIMD.html#ga768cbdeba8e4567257959378fba27f17">pow</a>(kGTdotn, <a class="code hl_variable" href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">pnorm</a>-1.0)*Area*Weight_ObjFunc;</div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>      }</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span> </div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>      <span class="comment">/*--- Strong BC enforcement of the energy equation ---*/</span></div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>      <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1) = 0.0;</div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a20a656c4093a9101875dde0886d0ecef">SetEnergy_ResTruncError_Zero</a>(iPoint);</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>      <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a6ee4d8d450971204cc054a33d6473732">SetSolution_Old</a>(iPoint,<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1, q);</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>      <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>        iVar = <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1;</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>        total_index = iPoint*<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+iVar;</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>        <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#a9473b0224c9b9a2749571db0bbd22a70">DeleteValsRowi</a>(total_index);</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>      }</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span> </div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>      <span class="comment">/*--- Additional contributions to adjoint density (weak imposition) ---*/</span></div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span> </div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>      <span class="comment">/*--- Acquire gradient information ---*/</span></div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>      <span class="keyword">auto</span> PsiVar_Grad = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a3215c20563e6d4bbeb4020d6161b48e5">GetGradient</a>(iPoint);</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>      GradP    = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint)[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1];</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>      GradDens = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">GetGradient_Primitive</a>(iPoint)[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span> </div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>      <span class="comment">/*--- Acqure flow information ---*/</span></div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>      rho = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a4892ca545884011b7903a8e35c43b43f">GetDensity</a>(iPoint);</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>      pressure = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">GetPressure</a>(iPoint);</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>      invrho3 = (1.0/rho)*(1.0/rho)*(1.0/rho);</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span> </div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>      <span class="comment">/*--- Calculate supporting quantities ---*/</span></div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>      mu2 = Thermal_Conductivity/Cp;</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>      gpsiAv2 = 0.0;</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>      gpsi5n = 0.0;</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>        dPoRho2[iDim] = (GradP[iDim]*rho - 2.0*GradDens[iDim]*pressure)*invrho3;</div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>        gpsiAv2 += -mu2*<a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>/<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a> * PsiVar_Grad[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim]*dPoRho2[iDim];</div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>        gpsi5n += PsiVar_Grad[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim]*Normal[iDim];</div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>      }</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span> </div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>      <span class="comment">/*--- Apply first order term to boundary ---*/</span></div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>      <a class="code hl_variable" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[0] = gpsiAv2*Volume;</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span> </div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>      <span class="comment">/*--- Apply second order term to boundary ---*/</span></div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>      <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[0] = -mu2*<a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>/(rho*<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)*(pressure/rho)*gpsi5n;</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span> </div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>      <span class="comment">/*--- Components of the effective and adjoint stress tensors ---*/</span></div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span>      PsiVar_Grad = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a3215c20563e6d4bbeb4020d6161b48e5">GetGradient</a>(iPoint);</div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>      div_phi = 0;</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>        div_phi += PsiVar_Grad[iDim+1][iDim];</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>        <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span>          Tau[iDim][jDim] = (PsiVar_Grad[iDim+1][jDim]+PsiVar_Grad[jDim+1][iDim]);</div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span>      }</div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>        Tau[iDim][iDim] -= <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*div_phi;</div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span> </div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>      <span class="comment">/*--- force_stress = n_i \Tau_{ij} d_j ---*/</span></div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>      force_stress = 0.0;</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>      <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>        <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>          force_stress += Normal[iDim]*Tau[iDim][jDim]*d[jDim];</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span> </div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>      <span class="comment">/*--- \partial \mu_dyn \partial T ---*/</span></div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>      <span class="comment">//        mu_dyn = solver_container[FLOW_SOL]-&gt;GetNodes()-&gt;GetLaminarViscosity(iPoint);</span></div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>      <span class="comment">//        Temp = solver_container[FLOW_SOL]-&gt;GetNodes()-&gt;GetTemperature(iPoint);</span></div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>      dVisc_T = 0.0;  <span class="comment">// dVisc_T = mu_dyn*(Temp+3.0*mu2)/(2.0*Temp*(Temp+mu2));</span></div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span> </div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>      <span class="comment">/*--- \Sigma_5 Check Area computation for Res_Conv[0] ---*/</span></div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>      Sigma_5 = (<a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>/Cp)*dVisc_T*force_stress;</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span> </div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>      <span class="comment">/*--- Imposition of residuals ---*/</span></div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>      rho = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a4892ca545884011b7903a8e35c43b43f">GetDensity</a>(iPoint);</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>      pressure = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">GetPressure</a>(iPoint);</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>      <a class="code hl_variable" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[0] = pressure*Sigma_5/(<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*rho*rho);</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span> </div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>      <span class="comment">/*--- Flux contribution and Jacobian contributions for moving</span></div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span><span class="comment">         walls. Note that these are only for the adjoint density and</span></div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span><span class="comment">         adjoint energy equations (the adjoint vel. uses a strong BC). ---*/</span></div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>      <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span> </div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>        <span class="comment">/*--- Get the appropriate grid velocity at this node ---*/</span></div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>        GridVel = geometry-&gt;<a class="code hl_variable" href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">nodes</a>-&gt;<a class="code hl_function" href="classCPoint.html#ad7b8ff47f6645f36c9a529073343c097">GetGridVel</a>(iPoint);</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span> </div>
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"> 1749</span>        <span class="comment">/*--- Get the enthalpy from the direct solution ---*/</span></div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>        Enthalpy = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a525636dad6b2064101677df44f274443">GetEnthalpy</a>(iPoint);</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span> </div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>        <span class="comment">/*--- Compute projections, velocity squared divided by two, and</span></div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span><span class="comment">           other inner products. Note that we are imposing v = u_wall from</span></div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span><span class="comment">           the direct problem and that phi = d - \psi_5 * v ---*/</span></div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>        ProjVel = 0.0; sq_vel = 0.0; phi_u = 0.0; d_n = 0.0;</div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>        phis1 = 0.0; phis2 = Psi[0] + Enthalpy * Psi[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1];</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>          ProjVel += GridVel[iDim]*Normal[iDim];</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span>          sq_vel  += 0.5*GridVel[iDim]*GridVel[iDim];</div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>          phis1   += Normal[iDim]*phi[iDim];</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span>          phis2   += GridVel[iDim]*phi[iDim];</div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>          phi_u   += GridVel[iDim]*phi[iDim];</div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span>          d_n     += d[iDim]*Normal[iDim];</div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>        }</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span>        <span class="comment">//          phis1 += ProjVel * Psi[nVar-1];</span></div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span> </div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span>        <span class="comment">/*--- Convective flux at the wall node (adjoint density &amp; energy only) ---*/</span></div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span> </div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>        <span class="comment">/*--- Version 1 (full) ---*/</span></div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span>        <span class="comment">//Res_Conv_i[0] = ProjVel * Psi[0] - phis2 * ProjVel + phis1 * Gamma_Minus_One * sq_vel - ProjVel*Psi[0];</span></div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>        <span class="comment">//Res_Conv_i[nVar-1] = ProjVel * Psi[nVar-1] + phis1 * Gamma_Minus_One - ProjVel*Psi[nVar-1];</span></div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span> </div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>        <span class="comment">/*--- Simplified version ---*/</span></div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>        <a class="code hl_variable" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>[0] = -(Psi[0] + phi_u + Psi[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1]*Enthalpy)*ProjVel + d_n*<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*sq_vel;</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span> </div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>        <span class="comment">/*--- TO DO: Implicit contributions for convective part ---*/</span></div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span> </div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span> </div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>        <span class="comment">/*--- Viscous flux contributions at the wall node ---*/</span></div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span>        U = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">GetSolution</a>(iPoint);</div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>        Laminar_Viscosity = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">GetLaminarViscosity</a>(iPoint);</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span>        Eddy_Viscosity = solver_container[<a class="code hl_enumvalue" href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a>]-&gt;<a class="code hl_function" href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">GetNodes</a>()-&gt;<a class="code hl_function" href="classCVariable.html#adae2e4228e113624b7ab1f9ab1a493c6">GetEddyViscosity</a>(iPoint); <span class="comment">// Should be zero at the wall</span></div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span>        Density = U[0];</div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span>          Velocity[iDim] = GridVel[iDim];</div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span>        }</div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>        Energy = U[<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] / Density;</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span>        SoundSpeed = <a class="code hl_function" href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a>(<a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>*<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>*(Energy-sq_vel));</div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>        Pressure = (SoundSpeed * SoundSpeed * Density) / <a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a>;</div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>        ViscDens = (Laminar_Viscosity + Eddy_Viscosity) / Density;</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span>        XiDens = <a class="code hl_variable" href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">Gamma</a> * (Laminar_Viscosity/Prandtl_Lam + Eddy_Viscosity/Prandtl_Turb) / Density;</div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span> </div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>        <span class="comment">/*--- Average of the derivatives of the adjoint variables ---*/</span></div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>        PsiVar_Grad = <a class="code hl_variable" href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">nodes</a>-&gt;<a class="code hl_function" href="classCVariable.html#a3215c20563e6d4bbeb4020d6161b48e5">GetGradient</a>(iPoint);</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span> </div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span>        <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span>          GradPsiE[iDim] =  PsiVar_Grad[<a class="code hl_variable" href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1][iDim];</div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span>          <span class="keywordflow">for</span> (jDim = 0; jDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; jDim++)</div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span>            GradPhi[iDim][jDim] =  PsiVar_Grad[iDim+1][jDim];</div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>        }</div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span> </div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>        <span class="comment">/*--- Impose dPhiE_dn = 0 (adiabatic walls with frozen viscosity). Note</span></div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span><span class="comment">           that this is where a different adjoint boundary condition for temperature</span></div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span><span class="comment">           could be imposed. ---*/</span></div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span>        dPhiE_dn = 0.0;</div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span> </div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> ==2) {</div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span> </div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span>          <span class="comment">/*--- Compute the adjoint stress tensor ---*/</span></div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>          Sigma_xx  = ViscDens * (<a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[0][0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1]);</div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>          Sigma_yy  = ViscDens * (-<a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[1][1]);</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span>          Sigma_xy  = ViscDens * (GradPhi[1][0] + GradPhi[0][1]);</div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>          Sigma_xx5 = ViscDens * ( <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[0] * GradPsiE[0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1]);</div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>          Sigma_yy5 = ViscDens * (- <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[1] * GradPsiE[1]);</div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span>          Sigma_xy5 = ViscDens * (Velocity[0] * GradPsiE[1] + Velocity[1] * GradPsiE[0]);</div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>          Sigma_5   = XiDens * dPhiE_dn;</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>          eta_xx    = Sigma_xx + Sigma_xx5;</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span>          eta_yy    = Sigma_yy + Sigma_yy5;</div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>          eta_xy    = Sigma_xy + Sigma_xy5;</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span> </div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span>          <span class="comment">/*--- Viscous flux at the wall node (adjoint density &amp; energy only) ---*/</span></div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span>          <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[0] = - (Velocity[0] * Normal[0] * eta_xx  + Velocity[1] * Normal[1] * eta_yy</div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span>              + (Velocity[0] * Normal[1] + Velocity[1] * Normal[0]) * eta_xy</div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span>              - (sq_vel - Pressure/(Density*<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * Sigma_5);</div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>          <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[1] = 0.0;</div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span>          <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[2] = 0.0;</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span> </div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) {</div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span> </div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>          <span class="comment">/*--- Compute the adjoint stress tensor ---*/</span></div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>          Sigma_xx  = ViscDens * (<a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[0][0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1] - <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>  * GradPhi[2][2]);</div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>          Sigma_yy  = ViscDens * (-<a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[1][1] - <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>  * GradPhi[2][2]);</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>          Sigma_zz  = ViscDens * (-<a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[0][0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * GradPhi[1][1] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * GradPhi[2][2]);</div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span>          Sigma_xy  = ViscDens * (GradPhi[1][0] + GradPhi[0][1]);</div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span>          Sigma_xz  = ViscDens * (GradPhi[2][0] + GradPhi[0][2]);</div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>          Sigma_yz  = ViscDens * (GradPhi[2][1] + GradPhi[1][2]);</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>          Sigma_xx5 = ViscDens * ( <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[0] * GradPsiE[0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span>          Sigma_yy5 = ViscDens * (- <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[1] * GradPsiE[1] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>          Sigma_zz5 = ViscDens * (- <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[0] * GradPsiE[0] -  <a class="code hl_variable" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a> * Velocity[1] * GradPsiE[1] + <a class="code hl_variable" href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a> * Velocity[2] * GradPsiE[2]);</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span>          Sigma_xy5 = ViscDens * (Velocity[0] * GradPsiE[1] + Velocity[1] * GradPsiE[0]);</div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span>          Sigma_xz5 = ViscDens * (Velocity[0] * GradPsiE[2] + Velocity[2] * GradPsiE[0]);</div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>          Sigma_yz5 = ViscDens * (Velocity[1] * GradPsiE[2] + Velocity[2] * GradPsiE[1]);</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>          Sigma_5   = XiDens * dPhiE_dn;</div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>          eta_xx    = Sigma_xx + Sigma_xx5; eta_yy = Sigma_yy + Sigma_yy5; eta_zz = Sigma_zz + Sigma_zz5;</div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>          eta_xy    = Sigma_xy + Sigma_xy5; eta_xz = Sigma_xz + Sigma_xz5; eta_yz = Sigma_yz + Sigma_yz5;</div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span> </div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span>          <span class="comment">/*--- Viscous flux at the wall node (adjoint density &amp; energy only) ---*/</span></div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span>          <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[0] = - (Velocity[0] * Normal[0] * eta_xx  + Velocity[1] * Normal[1] * eta_yy + Velocity[2] * Normal[2] * eta_zz</div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>              + (Velocity[0] * Normal[1] + Velocity[1] * Normal[0]) * eta_xy</div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span>              + (Velocity[0] * Normal[2] + Velocity[2] * Normal[0]) * eta_xz</div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>              + (Velocity[2] * Normal[1] + Velocity[1] * Normal[2]) * eta_yz</div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>              - (sq_vel - Pressure/(Density*<a class="code hl_variable" href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">Gamma_Minus_One</a>)) * Sigma_5);</div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>          <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[1] = 0.0;</div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span>          <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[2] = 0.0;</div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span>          <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>[3] = 0.0;</div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>        }</div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>      }</div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span> </div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span>      <span class="comment">/*--- Update convective and viscous residuals ---*/</span></div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>      <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code hl_function" href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">AddBlock</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#a403c73150cc7c99c43763238c1005242">Res_Conv_i</a>);</div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span>      <a class="code hl_variable" href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">LinSysRes</a>.<a class="code hl_function" href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">SubtractBlock</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">Res_Visc_i</a>);</div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span>      <span class="keywordflow">if</span> (implicit) {</div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span>        <a class="code hl_variable" href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">Jacobian</a>.<a class="code hl_function" href="classCSysMatrix.html#a423b77066cf386dd6e4b95a656e4aadb">SubtractBlock2Diag</a>(iPoint, <a class="code hl_variable" href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">Jacobian_ii</a>);</div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>      }</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span> </div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span>    }</div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span> </div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span>  }</div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span> </div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span>    <span class="keyword">delete</span> [] Tau[iDim];</div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span>  <span class="keyword">delete</span> [] Tau;</div>
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"> 1873</span>  <span class="keyword">delete</span> [] Psi;</div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>  <span class="keyword">delete</span> [] Velocity;</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>  <span class="keyword">delete</span> [] Normal;</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>  <span class="keyword">delete</span> [] GradPsiE;</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code hl_variable" href="classCSolver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>    <span class="keyword">delete</span> [] GradPhi[iDim];</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>  <span class="keyword">delete</span> [] GradPhi;</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span>  <span class="keyword">delete</span> [] dPoRho2;</div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>}</div>
</div>
<div class="ttc" id="aclassC2DContainer_html"><div class="ttname"><a href="classC2DContainer.html">C2DContainer</a></div><div class="ttdoc">A templated matrix/vector-like object.</div><div class="ttdef"><b>Definition</b> <a href="C2DContainer_8hpp_source.html#l00371">C2DContainer.hpp:372</a></div></div>
<div class="ttc" id="aclassC2DContainer_html_a39929b060c72565b4ab19c3a391bb8e6"><div class="ttname"><a href="classC2DContainer.html#a39929b060c72565b4ab19c3a391bb8e6">C2DContainer::resize</a></div><div class="ttdeci">C2DContainer &amp; resize(const Index_t size1, const Index_t size2=1) noexcept</div><div class="ttdoc">Request a change of size.</div><div class="ttdef"><b>Definition</b> <a href="C2DContainer_8hpp_source.html#l00537">C2DContainer.hpp:537</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html"><div class="ttname"><a href="classCAdjEulerSolver.html">CAdjEulerSolver</a></div><div class="ttdoc">Main class for defining the Euler's adjoint flow solver.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00039">CAdjEulerSolver.hpp:39</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a066a1c3fb9cf63efc84a58ac67a76437"><div class="ttname"><a href="classCAdjEulerSolver.html#a066a1c3fb9cf63efc84a58ac67a76437">CAdjEulerSolver::FlowPrimVar_i</a></div><div class="ttdeci">su2double * FlowPrimVar_i</div><div class="ttdoc">Store the flow solution at point i.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00064">CAdjEulerSolver.hpp:64</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a11a688be02f50bf45a49f23ea4ac4cb2"><div class="ttname"><a href="classCAdjEulerSolver.html#a11a688be02f50bf45a49f23ea4ac4cb2">CAdjEulerSolver::PsiRho_Inf</a></div><div class="ttdeci">su2double PsiRho_Inf</div><div class="ttdoc">PsiRho variable at the infinity.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00042">CAdjEulerSolver.hpp:42</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a3656883f9d954ca86220b3bfcab25bc7"><div class="ttname"><a href="classCAdjEulerSolver.html#a3656883f9d954ca86220b3bfcab25bc7">CAdjEulerSolver::Phi_Inf</a></div><div class="ttdeci">su2double * Phi_Inf</div><div class="ttdoc">Phi vector at the infinity.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00044">CAdjEulerSolver.hpp:44</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a387182abffb4a18a66322e7357ce4eac"><div class="ttname"><a href="classCAdjEulerSolver.html#a387182abffb4a18a66322e7357ce4eac">CAdjEulerSolver::Sens_AoA</a></div><div class="ttdeci">su2double * Sens_AoA</div><div class="ttdoc">Angle of attack sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00047">CAdjEulerSolver.hpp:47</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a3f9e8576dc150e551bd19a64b1d43977"><div class="ttname"><a href="classCAdjEulerSolver.html#a3f9e8576dc150e551bd19a64b1d43977">CAdjEulerSolver::Sens_BPress</a></div><div class="ttdeci">su2double * Sens_BPress</div><div class="ttdoc">Back pressure sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00051">CAdjEulerSolver.hpp:51</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a44d7c3320be93416c2013eaf7bb98562"><div class="ttname"><a href="classCAdjEulerSolver.html#a44d7c3320be93416c2013eaf7bb98562">CAdjEulerSolver::Sens_Press</a></div><div class="ttdeci">su2double * Sens_Press</div><div class="ttdoc">Pressure sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00049">CAdjEulerSolver.hpp:49</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a4a53581a74846bf44a7d7a85d15bb8e5"><div class="ttname"><a href="classCAdjEulerSolver.html#a4a53581a74846bf44a7d7a85d15bb8e5">CAdjEulerSolver::PsiE_Inf</a></div><div class="ttdeci">su2double PsiE_Inf</div><div class="ttdoc">PsiE variable at the infinity.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00043">CAdjEulerSolver.hpp:43</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a5265a44e6c43dee677c9f26333148432"><div class="ttname"><a href="classCAdjEulerSolver.html#a5265a44e6c43dee677c9f26333148432">CAdjEulerSolver::SetFarfield_AoA</a></div><div class="ttdeci">void SetFarfield_AoA(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, bool Output)</div><div class="ttdoc">Update the AoA and freestream velocity at the farfield.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8cpp_source.html#l02103">CAdjEulerSolver.cpp:2103</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a58d3d6883f58061e0a5ce4e81c748fb0"><div class="ttname"><a href="classCAdjEulerSolver.html#a58d3d6883f58061e0a5ce4e81c748fb0">CAdjEulerSolver::Total_Sens_Geo</a></div><div class="ttdeci">su2double Total_Sens_Geo</div><div class="ttdoc">Total shape sensitivity coefficient for all the boundaries.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00056">CAdjEulerSolver.hpp:56</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a58f168e47ed752d3b0cd67ddf729c552"><div class="ttname"><a href="classCAdjEulerSolver.html#a58f168e47ed752d3b0cd67ddf729c552">CAdjEulerSolver::CSensitivity</a></div><div class="ttdeci">su2double ** CSensitivity</div><div class="ttdoc">Shape sensitivity coefficient for each boundary and vertex.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00052">CAdjEulerSolver.hpp:52</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a63e3f7ad5daf7b04bb551c898b8099a7"><div class="ttname"><a href="classCAdjEulerSolver.html#a63e3f7ad5daf7b04bb551c898b8099a7">CAdjEulerSolver::Sens_Geo</a></div><div class="ttdeci">su2double * Sens_Geo</div><div class="ttdoc">Shape sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00048">CAdjEulerSolver.hpp:48</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a84f2772cbd2fa10fc51970495e929d4b"><div class="ttname"><a href="classCAdjEulerSolver.html#a84f2772cbd2fa10fc51970495e929d4b">CAdjEulerSolver::Gamma</a></div><div class="ttdeci">su2double Gamma</div><div class="ttdoc">Fluid's Gamma constant (ratio of specific heats).</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00062">CAdjEulerSolver.hpp:62</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a88866367a785e4cfdc5f72606c6cfe4c"><div class="ttname"><a href="classCAdjEulerSolver.html#a88866367a785e4cfdc5f72606c6cfe4c">CAdjEulerSolver::DonorAdjVar</a></div><div class="ttdeci">vector&lt; vector&lt; vector&lt; su2double &gt; &gt; &gt; DonorAdjVar</div><div class="ttdoc">Value of the donor variables at each boundary.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00053">CAdjEulerSolver.hpp:53</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a9d54da0d71cf883ef9882a5b952e8d7e"><div class="ttname"><a href="classCAdjEulerSolver.html#a9d54da0d71cf883ef9882a5b952e8d7e">CAdjEulerSolver::Total_Sens_Press</a></div><div class="ttdeci">su2double Total_Sens_Press</div><div class="ttdoc">Total farfield sensitivity to pressure.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00057">CAdjEulerSolver.hpp:57</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_a9d6f0287021d17e2313fcd7a630e4150"><div class="ttname"><a href="classCAdjEulerSolver.html#a9d6f0287021d17e2313fcd7a630e4150">CAdjEulerSolver::nodes</a></div><div class="ttdeci">CAdjEulerVariable * nodes</div><div class="ttdoc">The highest level in the variable hierarchy this solver can safely use.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00074">CAdjEulerSolver.hpp:74</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_aa29c3c368ebace7feb2c88a2cc57f260"><div class="ttname"><a href="classCAdjEulerSolver.html#aa29c3c368ebace7feb2c88a2cc57f260">CAdjEulerSolver::FlowPrimVar_j</a></div><div class="ttdeci">su2double * FlowPrimVar_j</div><div class="ttdoc">Store the flow solution at point j.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00065">CAdjEulerSolver.hpp:65</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_aa5d4c1937cfe9ca07e7f2e692170b437"><div class="ttname"><a href="classCAdjEulerSolver.html#aa5d4c1937cfe9ca07e7f2e692170b437">CAdjEulerSolver::pnorm</a></div><div class="ttdeci">su2double pnorm</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00068">CAdjEulerSolver.hpp:68</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_aa9f35cdd46666eb545d831c9bc5985d5"><div class="ttname"><a href="classCAdjEulerSolver.html#aa9f35cdd46666eb545d831c9bc5985d5">CAdjEulerSolver::DonorGlobalIndex</a></div><div class="ttdeci">vector&lt; vector&lt; unsigned long &gt; &gt; DonorGlobalIndex</div><div class="ttdoc">Value of the donor global index.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00066">CAdjEulerSolver.hpp:66</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_aaa2d20642192953874b39ef80b882397"><div class="ttname"><a href="classCAdjEulerSolver.html#aaa2d20642192953874b39ef80b882397">CAdjEulerSolver::Total_Sens_Mach</a></div><div class="ttdeci">su2double Total_Sens_Mach</div><div class="ttdoc">Total mach sensitivity coefficient for all the boundaries.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00054">CAdjEulerSolver.hpp:54</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_acf0412ccd54deb050dc4a8923413be9f"><div class="ttname"><a href="classCAdjEulerSolver.html#acf0412ccd54deb050dc4a8923413be9f">CAdjEulerSolver::Gamma_Minus_One</a></div><div class="ttdeci">su2double Gamma_Minus_One</div><div class="ttdoc">Fluids's Gamma - 1.0 .</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00063">CAdjEulerSolver.hpp:63</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_acfaa34c05bb62cca6a0deccea83bcf73"><div class="ttname"><a href="classCAdjEulerSolver.html#acfaa34c05bb62cca6a0deccea83bcf73">CAdjEulerSolver::Total_Sens_AoA</a></div><div class="ttdeci">su2double Total_Sens_AoA</div><div class="ttdoc">Total angle of attack sensitivity coefficient for all the boundaries.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00055">CAdjEulerSolver.hpp:55</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_ad4ccc706c5355e248c2e091676957b94"><div class="ttname"><a href="classCAdjEulerSolver.html#ad4ccc706c5355e248c2e091676957b94">CAdjEulerSolver::Sens_Mach</a></div><div class="ttdeci">su2double * Sens_Mach</div><div class="ttdoc">Mach sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00046">CAdjEulerSolver.hpp:46</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_ad8bbbbd00a0b4111a25044c084572706"><div class="ttname"><a href="classCAdjEulerSolver.html#ad8bbbbd00a0b4111a25044c084572706">CAdjEulerSolver::Total_Sens_Temp</a></div><div class="ttdeci">su2double Total_Sens_Temp</div><div class="ttdoc">Total farfield sensitivity to temperature.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00058">CAdjEulerSolver.hpp:58</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_ae69171bce719d74c9a5961170fe0aae4"><div class="ttname"><a href="classCAdjEulerSolver.html#ae69171bce719d74c9a5961170fe0aae4">CAdjEulerSolver::Sens_Temp</a></div><div class="ttdeci">su2double * Sens_Temp</div><div class="ttdoc">Temperature sensitivity coefficient for each boundary.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00050">CAdjEulerSolver.hpp:50</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_af1b72ed76900f821d2f51942cb4252db"><div class="ttname"><a href="classCAdjEulerSolver.html#af1b72ed76900f821d2f51942cb4252db">CAdjEulerSolver::SetCentered_Dissipation_Sensor</a></div><div class="ttdeci">void SetCentered_Dissipation_Sensor(CGeometry *geometry, CConfig *config)</div><div class="ttdoc">Compute the sensor for higher order dissipation control in rotating problems.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8cpp_source.html#l01317">CAdjEulerSolver.cpp:1317</a></div></div>
<div class="ttc" id="aclassCAdjEulerSolver_html_af3684618530046d51d1e035f4d531ce2"><div class="ttname"><a href="classCAdjEulerSolver.html#af3684618530046d51d1e035f4d531ce2">CAdjEulerSolver::Area_Monitored</a></div><div class="ttdeci">su2double Area_Monitored</div><div class="ttdoc">Store the total area of the monitored outflow surface (used for normalization in continuous adjoint o...</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerSolver_8hpp_source.html#l00069">CAdjEulerSolver.hpp:69</a></div></div>
<div class="ttc" id="aclassCAdjEulerVariable_html_a08d1474748d5ddf53d62c1dde9f23ac8"><div class="ttname"><a href="classCAdjEulerVariable.html#a08d1474748d5ddf53d62c1dde9f23ac8">CAdjEulerVariable::SetPrimVar</a></div><div class="ttdeci">bool SetPrimVar(unsigned long iPoint, su2double SharpEdge_Distance, bool check, CConfig *config) final</div><div class="ttdoc">Set all the primitive variables for compressible flows.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerVariable_8cpp_source.html#l00109">CAdjEulerVariable.cpp:109</a></div></div>
<div class="ttc" id="aclassCAdjEulerVariable_html_a14a7a77262dfba287156315a5142e923"><div class="ttname"><a href="classCAdjEulerVariable.html#a14a7a77262dfba287156315a5142e923">CAdjEulerVariable::SetVel_ResTruncError_Zero</a></div><div class="ttdeci">void SetVel_ResTruncError_Zero(unsigned long iPoint) final</div><div class="ttdoc">Set the momentum part of the truncation error to zero.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerVariable_8hpp_source.html#l00109">CAdjEulerVariable.hpp:109</a></div></div>
<div class="ttc" id="aclassCAdjEulerVariable_html_a15674cbc0b8d9a722952c53d9b298175"><div class="ttname"><a href="classCAdjEulerVariable.html#a15674cbc0b8d9a722952c53d9b298175">CAdjEulerVariable::GetForceProj_Vector</a></div><div class="ttdeci">su2double * GetForceProj_Vector(unsigned long iPoint) final</div><div class="ttdoc">Get the value of the force projection vector.</div><div class="ttdef"><b>Definition</b> <a href="CAdjEulerVariable_8hpp_source.html#l00126">CAdjEulerVariable.hpp:126</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a0669f6fb8ef7cd7800d151d4aff7d3f6"><div class="ttname"><a href="classCAdjNSSolver.html#a0669f6fb8ef7cd7800d151d4aff7d3f6">CAdjNSSolver::Preprocessing</a></div><div class="ttdeci">void Preprocessing(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, unsigned short iRKStep, unsigned short RunTime_EqSystem, bool Output) override</div><div class="ttdoc">Restart residual and compute gradients.</div><div class="ttdef"><b>Definition</b> <a href="CAdjNSSolver_8cpp_source.html#l00302">CAdjNSSolver.cpp:302</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a159875229feba5b14c433990e5a89d60"><div class="ttname"><a href="classCAdjNSSolver.html#a159875229feba5b14c433990e5a89d60">CAdjNSSolver::BC_Isothermal_Wall</a></div><div class="ttdeci">void BC_Isothermal_Wall(CGeometry *geometry, CSolver **solver_container, CNumerics *conv_numerics, CNumerics *visc_numerics, CConfig *config, unsigned short val_marker) override</div><div class="ttdoc">Impose via the residual or brute force the Navier-Stokes adjoint boundary condition (heat flux).</div><div class="ttdef"><b>Definition</b> <a href="CAdjNSSolver_8cpp_source.html#l01529">CAdjNSSolver.cpp:1529</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a22ab579adc04b7c212508480df9dff8b"><div class="ttname"><a href="classCAdjNSSolver.html#a22ab579adc04b7c212508480df9dff8b">CAdjNSSolver::SetTime_Step</a></div><div class="ttdeci">void SetTime_Step(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, unsigned long Iteration) override</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition</b> <a href="CAdjNSSolver_8cpp_source.html#l00292">CAdjNSSolver.cpp:292</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a3f7289e94076471c23e53da293b69645"><div class="ttname"><a href="classCAdjNSSolver.html#a3f7289e94076471c23e53da293b69645">CAdjNSSolver::Source_Residual</a></div><div class="ttdeci">void Source_Residual(CGeometry *geometry, CSolver **solver_container, CNumerics **numerics_container, CConfig *config, unsigned short iMesh) override</div><div class="ttdoc">Source term computation.</div><div class="ttdef"><b>Definition</b> <a href="CAdjNSSolver_8cpp_source.html#l00441">CAdjNSSolver.cpp:441</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a6e2a8b29fa5c5709d12e7970d8cc88eb"><div class="ttname"><a href="classCAdjNSSolver.html#a6e2a8b29fa5c5709d12e7970d8cc88eb">CAdjNSSolver::~CAdjNSSolver</a></div><div class="ttdeci">~CAdjNSSolver(void) override</div><div class="ttdoc">Destructor of the class.</div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a6e72f094190680fa7fb078d7aae9c1d8"><div class="ttname"><a href="classCAdjNSSolver.html#a6e72f094190680fa7fb078d7aae9c1d8">CAdjNSSolver::Viscous_Sensitivity</a></div><div class="ttdeci">void Viscous_Sensitivity(CGeometry *geometry, CSolver **solver_container, CNumerics *numerics, CConfig *config) override</div><div class="ttdoc">Compute the viscous sensitivity of the functional.</div><div class="ttdef"><b>Definition</b> <a href="CAdjNSSolver_8cpp_source.html#l00583">CAdjNSSolver.cpp:583</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_a87064a324dd57b715155f405fc0804fc"><div class="ttname"><a href="classCAdjNSSolver.html#a87064a324dd57b715155f405fc0804fc">CAdjNSSolver::Viscous_Residual</a></div><div class="ttdeci">void Viscous_Residual(CGeometry *geometry, CSolver **solver_container, CNumerics **numerics_container, CConfig *config, unsigned short iMesh, unsigned short iRKStep) override</div><div class="ttdoc">Compute the viscous residuals for the adjoint equation.</div><div class="ttdef"><b>Definition</b> <a href="CAdjNSSolver_8cpp_source.html#l00391">CAdjNSSolver.cpp:391</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_aac064a699355df483ca48c40e7c50675"><div class="ttname"><a href="classCAdjNSSolver.html#aac064a699355df483ca48c40e7c50675">CAdjNSSolver::BC_HeatFlux_Wall</a></div><div class="ttdeci">void BC_HeatFlux_Wall(CGeometry *geometry, CSolver **solver_container, CNumerics *conv_numerics, CNumerics *visc_numerics, CConfig *config, unsigned short val_marker) override</div><div class="ttdoc">Impose via the residual or brute force the Navier-Stokes adjoint boundary condition (heat flux).</div><div class="ttdef"><b>Definition</b> <a href="CAdjNSSolver_8cpp_source.html#l01167">CAdjNSSolver.cpp:1167</a></div></div>
<div class="ttc" id="aclassCAdjNSSolver_html_acd8b443b57b29343b1ce316bed3f380b"><div class="ttname"><a href="classCAdjNSSolver.html#acd8b443b57b29343b1ce316bed3f380b">CAdjNSSolver::CAdjNSSolver</a></div><div class="ttdeci">CAdjNSSolver(void)</div><div class="ttdoc">Constructor of the class.</div><div class="ttdef"><b>Definition</b> <a href="CAdjNSSolver_8cpp_source.html#l00033">CAdjNSSolver.cpp:33</a></div></div>
<div class="ttc" id="aclassCAdjNSVariable_html"><div class="ttname"><a href="classCAdjNSVariable.html">CAdjNSVariable</a></div><div class="ttdoc">Main class for defining the variables of the adjoint Navier-Stokes solver.</div><div class="ttdef"><b>Definition</b> <a href="CAdjNSVariable_8hpp_source.html#l00038">CAdjNSVariable.hpp:38</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a381d4b3738c09d92ee1ae9f89715b541"><div class="ttname"><a href="classCBaseMPIWrapper.html#a381d4b3738c09d92ee1ae9f89715b541">CBaseMPIWrapper::Allreduce</a></div><div class="ttdeci">static void Allreduce(const void *sendbuf, void *recvbuf, int count, Datatype datatype, Op op, Comm comm)</div><div class="ttdef"><b>Definition</b> <a href="mpi__structure_8hpp_source.html#l00561">mpi_structure.hpp:561</a></div></div>
<div class="ttc" id="aclassCBaseMPIWrapper_html_a8154391fc3522954802889d81d4ef5da"><div class="ttname"><a href="classCBaseMPIWrapper.html#a8154391fc3522954802889d81d4ef5da">CBaseMPIWrapper::GetComm</a></div><div class="ttdeci">static Comm GetComm()</div><div class="ttdef"><b>Definition</b> <a href="mpi__structure_8hpp_source.html#l00521">mpi_structure.hpp:521</a></div></div>
<div class="ttc" id="aclassCConfig_html"><div class="ttname"><a href="classCConfig.html">CConfig</a></div><div class="ttdoc">Main class for defining the problem; basically this class reads the configuration file,...</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l00062">CConfig.hpp:62</a></div></div>
<div class="ttc" id="aclassCConfig_html_a0b5df9254891b32a88e83880778f9261"><div class="ttname"><a href="classCConfig.html#a0b5df9254891b32a88e83880778f9261">CConfig::GetGamma</a></div><div class="ttdeci">su2double GetGamma(void) const</div><div class="ttdoc">Get the value of the Gamma of fluid (ratio of specific heats).</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l01617">CConfig.hpp:1617</a></div></div>
<div class="ttc" id="aclassCConfig_html_a1132191f9f5af73ef4ff7eb356f41181"><div class="ttname"><a href="classCConfig.html#a1132191f9f5af73ef4ff7eb356f41181">CConfig::GetSolution_AdjFileName</a></div><div class="ttdeci">string GetSolution_AdjFileName(void) const</div><div class="ttdoc">Get the name of the file with the solution of the adjoint flow problem with drag objective function.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l05511">CConfig.hpp:5511</a></div></div>
<div class="ttc" id="aclassCConfig_html_a13840ca712bf87d32d18917d0c39cfae"><div class="ttname"><a href="classCConfig.html#a13840ca712bf87d32d18917d0c39cfae">CConfig::GetVelocity_FreeStreamND</a></div><div class="ttdeci">su2double * GetVelocity_FreeStreamND(void)</div><div class="ttdoc">Get the vector of the non-dimensionalized freestream velocity.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l01942">CConfig.hpp:1942</a></div></div>
<div class="ttc" id="aclassCConfig_html_a1431ababf767a9f74ff74fe9ef647957"><div class="ttname"><a href="classCConfig.html#a1431ababf767a9f74ff74fe9ef647957">CConfig::GetGas_ConstantND</a></div><div class="ttdeci">su2double GetGas_ConstantND(void) const</div><div class="ttdoc">Get the value of specific gas constant.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l01671">CConfig.hpp:1671</a></div></div>
<div class="ttc" id="aclassCConfig_html_a350466e9cc76639fb07c59ac43288bb8"><div class="ttname"><a href="classCConfig.html#a350466e9cc76639fb07c59ac43288bb8">CConfig::GetReconstructionGradientRequired</a></div><div class="ttdeci">bool GetReconstructionGradientRequired(void) const</div><div class="ttdoc">Get flag for whether a second gradient calculation is required for upwind reconstruction alone.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l04173">CConfig.hpp:4173</a></div></div>
<div class="ttc" id="aclassCConfig_html_a3bd1de6bcb6cd7062816341b0d956459"><div class="ttname"><a href="classCConfig.html#a3bd1de6bcb6cd7062816341b0d956459">CConfig::GetVenkat_LimiterCoeff</a></div><div class="ttdeci">su2double GetVenkat_LimiterCoeff(void) const</div><div class="ttdoc">Get the value of limiter coefficient.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l02425">CConfig.hpp:2425</a></div></div>
<div class="ttc" id="aclassCConfig_html_a3f9890ff8ca2b98646e4ebf3de8c9c13"><div class="ttname"><a href="classCConfig.html#a3f9890ff8ca2b98646e4ebf3de8c9c13">CConfig::GetRotation_Rate</a></div><div class="ttdeci">su2double GetRotation_Rate(unsigned short iDim) const</div><div class="ttdoc">Get the rotation rate of the mesh.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l05934">CConfig.hpp:5934</a></div></div>
<div class="ttc" id="aclassCConfig_html_a434fe0922532828b7e40ded865c5ce51"><div class="ttname"><a href="classCConfig.html#a434fe0922532828b7e40ded865c5ce51">CConfig::SetNonphysical_Points</a></div><div class="ttdeci">void SetNonphysical_Points(unsigned long val_nonphys_points)</div><div class="ttdoc">Set the current number of non-physical nodes in the solution.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l08705">CConfig.hpp:8705</a></div></div>
<div class="ttc" id="aclassCConfig_html_a4558fc163c393e628050e7a2273673f1"><div class="ttname"><a href="classCConfig.html#a4558fc163c393e628050e7a2273673f1">CConfig::GetMarker_Monitoring_TagBound</a></div><div class="ttdeci">string GetMarker_Monitoring_TagBound(unsigned short val_marker) const</div><div class="ttdoc">Get the name of the surface defined in the geometry file.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l03335">CConfig.hpp:3335</a></div></div>
<div class="ttc" id="aclassCConfig_html_a459dee039e618d21a5d78db61c221240"><div class="ttname"><a href="classCConfig.html#a459dee039e618d21a5d78db61c221240">CConfig::GetnMarker_All</a></div><div class="ttdeci">unsigned short GetnMarker_All(void) const</div><div class="ttdoc">Get the total number of boundary markers of the local process including send/receive domains.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l03003">CConfig.hpp:3003</a></div></div>
<div class="ttc" id="aclassCConfig_html_a4b89ad15fa82f93ca8ccfe945e2c14a7"><div class="ttname"><a href="classCConfig.html#a4b89ad15fa82f93ca8ccfe945e2c14a7">CConfig::GetPrandtl_Turb</a></div><div class="ttdeci">su2double GetPrandtl_Turb(unsigned short val_index=0) const</div><div class="ttdoc">Get the value of the turbulent Prandtl number.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l01766">CConfig.hpp:1766</a></div></div>
<div class="ttc" id="aclassCConfig_html_a4bf6e287aaf809340df1e40a76cf438b"><div class="ttname"><a href="classCConfig.html#a4bf6e287aaf809340df1e40a76cf438b">CConfig::GetKind_TimeIntScheme_AdjFlow</a></div><div class="ttdeci">unsigned short GetKind_TimeIntScheme_AdjFlow(void) const</div><div class="ttdoc">Get the kind of integration scheme (explicit or implicit) for the adjoint flow equations.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l04765">CConfig.hpp:4765</a></div></div>
<div class="ttc" id="aclassCConfig_html_a502035c2b049606186e11e01b7df626a"><div class="ttname"><a href="classCConfig.html#a502035c2b049606186e11e01b7df626a">CConfig::GetPrandtl_Lam</a></div><div class="ttdeci">su2double GetPrandtl_Lam(unsigned short val_index=0) const</div><div class="ttdoc">Get the value of the laminar Prandtl number.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l01760">CConfig.hpp:1760</a></div></div>
<div class="ttc" id="aclassCConfig_html_a515e35504ab34bf25d222e377f3b4c81"><div class="ttname"><a href="classCConfig.html#a515e35504ab34bf25d222e377f3b4c81">CConfig::GetRefArea</a></div><div class="ttdeci">su2double GetRefArea(void) const</div><div class="ttdoc">Get the reference area for non dimensional coefficient computation. If the value from the is 0 then,...</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l02047">CConfig.hpp:2047</a></div></div>
<div class="ttc" id="aclassCConfig_html_a5442ec644c8d291d3e07c158ba5d54a4"><div class="ttname"><a href="classCConfig.html#a5442ec644c8d291d3e07c158ba5d54a4">CConfig::GetMach_Motion</a></div><div class="ttdeci">su2double GetMach_Motion(void) const</div><div class="ttdoc">Get the mach number based on the mesh velocity and freestream quantities.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l05865">CConfig.hpp:5865</a></div></div>
<div class="ttc" id="aclassCConfig_html_a5a078901bb388e9caa9cb856e3348f0b"><div class="ttname"><a href="classCConfig.html#a5a078901bb388e9caa9cb856e3348f0b">CConfig::GetMach</a></div><div class="ttdeci">su2double GetMach(void) const</div><div class="ttdoc">Get the value of the Mach number (velocity divided by speed of sound).</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l01611">CConfig.hpp:1611</a></div></div>
<div class="ttc" id="aclassCConfig_html_a614c55e8d7945a11d92d7b51851291c2"><div class="ttname"><a href="classCConfig.html#a614c55e8d7945a11d92d7b51851291c2">CConfig::GetWeight_ObjFunc</a></div><div class="ttdeci">su2double GetWeight_ObjFunc(unsigned short val_obj) const</div><div class="ttdoc">Get the weight of objective function. There are several options: Drag coefficient,...</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l05334">CConfig.hpp:5334</a></div></div>
<div class="ttc" id="aclassCConfig_html_a693b7f150eb8b7a455e4174d4af744b8"><div class="ttname"><a href="classCConfig.html#a693b7f150eb8b7a455e4174d4af744b8">CConfig::GetFrozen_Visc_Cont</a></div><div class="ttdeci">bool GetFrozen_Visc_Cont(void) const</div><div class="ttdoc">Provides information about the way in which the turbulence will be treated by the cont....</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l04940">CConfig.hpp:4940</a></div></div>
<div class="ttc" id="aclassCConfig_html_a6e65810e59b8015104b84c4fd5b1d7f9"><div class="ttname"><a href="classCConfig.html#a6e65810e59b8015104b84c4fd5b1d7f9">CConfig::GetnMarker_Monitoring</a></div><div class="ttdeci">unsigned short GetnMarker_Monitoring(void) const</div><div class="ttdoc">Get the total number of monitoring markers.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l03087">CConfig.hpp:3087</a></div></div>
<div class="ttc" id="aclassCConfig_html_a77312cf52a5ba2cc1239b7cee6fce7a7"><div class="ttname"><a href="classCConfig.html#a77312cf52a5ba2cc1239b7cee6fce7a7">CConfig::GetKind_Solver</a></div><div class="ttdeci">MAIN_SOLVER GetKind_Solver(void) const</div><div class="ttdoc">Governing equations of the flow (it can be different from the run time equation).</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l03743">CConfig.hpp:3743</a></div></div>
<div class="ttc" id="aclassCConfig_html_a7c7b4b489dcb3b505c091de0ae300891"><div class="ttname"><a href="classCConfig.html#a7c7b4b489dcb3b505c091de0ae300891">CConfig::GetRefElemLength</a></div><div class="ttdeci">su2double GetRefElemLength(void) const</div><div class="ttdoc">Get the reference element length for computing the slope limiting epsilon.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l02355">CConfig.hpp:2355</a></div></div>
<div class="ttc" id="aclassCConfig_html_a83d5144467a2c2fa78a7f9cc19026421"><div class="ttname"><a href="classCConfig.html#a83d5144467a2c2fa78a7f9cc19026421">CConfig::GetKind_Gradient_Method</a></div><div class="ttdeci">unsigned short GetKind_Gradient_Method(void) const</div><div class="ttdoc">Get the kind of method for computation of spatial gradients used for viscous and source terms.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l04161">CConfig.hpp:4161</a></div></div>
<div class="ttc" id="aclassCConfig_html_a9182d3dbb0b3bfa2ebb944f18795f5ca"><div class="ttname"><a href="classCConfig.html#a9182d3dbb0b3bfa2ebb944f18795f5ca">CConfig::GetGrid_Movement</a></div><div class="ttdeci">bool GetGrid_Movement(void) const</div><div class="ttdoc">Get information about the grid movement.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l05811">CConfig.hpp:5811</a></div></div>
<div class="ttc" id="aclassCConfig_html_a99e6285b421215b1995965cd534976ae"><div class="ttname"><a href="classCConfig.html#a99e6285b421215b1995965cd534976ae">CConfig::GetKind_ObjFunc</a></div><div class="ttdeci">unsigned short GetKind_ObjFunc(unsigned short val_obj=0) const</div><div class="ttdoc">Get the kind of objective function. There are several options: Drag coefficient, Lift coefficient,...</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l05325">CConfig.hpp:5325</a></div></div>
<div class="ttc" id="aclassCConfig_html_aa495414133c826e5f6651d4ce82d0ef6"><div class="ttname"><a href="classCConfig.html#aa495414133c826e5f6651d4ce82d0ef6">CConfig::GetComm_Level</a></div><div class="ttdeci">unsigned short GetComm_Level(void) const</div><div class="ttdoc">Get the level of MPI communications to be performed.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l09385">CConfig.hpp:9385</a></div></div>
<div class="ttc" id="aclassCConfig_html_aad80e2ae9bc0b7b1fed6ccc2b6b2bce0"><div class="ttname"><a href="classCConfig.html#aad80e2ae9bc0b7b1fed6ccc2b6b2bce0">CConfig::GetnObj</a></div><div class="ttdeci">unsigned short GetnObj(void) const</div><div class="ttdoc">Get the total number of objectives in kind_objective list.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l03141">CConfig.hpp:3141</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab05a2ea2f4079504565628130bee2ae3"><div class="ttname"><a href="classCConfig.html#ab05a2ea2f4079504565628130bee2ae3">CConfig::GetSystemMeasurements</a></div><div class="ttdeci">unsigned short GetSystemMeasurements(void) const</div><div class="ttdoc">Governing equations of the flow (it can be different from the run time equation).</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l03830">CConfig.hpp:3830</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab090a18d19d62ffc6fbf89f195eed16e"><div class="ttname"><a href="classCConfig.html#ab090a18d19d62ffc6fbf89f195eed16e">CConfig::GetEval_dOF_dCX</a></div><div class="ttdeci">bool GetEval_dOF_dCX(void) const</div><div class="ttdoc">Get information about whether to use fixed CL mode.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l08616">CConfig.hpp:8616</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab33081c547f43eb27cc54852d4629dd3"><div class="ttname"><a href="classCConfig.html#ab33081c547f43eb27cc54852d4629dd3">CConfig::GetSens_Remove_Sharp</a></div><div class="ttdeci">bool GetSens_Remove_Sharp(void) const</div><div class="ttdoc">Provides information about if the sharp edges are going to be removed from the sensitivity.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l04966">CConfig.hpp:4966</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab3ab2f06b6d038aea73beed05cd13448"><div class="ttname"><a href="classCConfig.html#ab3ab2f06b6d038aea73beed05cd13448">CConfig::GetOmega_Ref</a></div><div class="ttdeci">su2double GetOmega_Ref(void) const</div><div class="ttdoc">Get the value of the reference angular velocity for non-dimensionalization.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l01881">CConfig.hpp:1881</a></div></div>
<div class="ttc" id="aclassCConfig_html_ab8c9c1f45950a29355be4ff357049440"><div class="ttname"><a href="classCConfig.html#ab8c9c1f45950a29355be4ff357049440">CConfig::GetMarker_All_TagBound</a></div><div class="ttdeci">string GetMarker_All_TagBound(unsigned short val_marker) const</div><div class="ttdoc">Get the index of the surface defined in the geometry file.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l03287">CConfig.hpp:3287</a></div></div>
<div class="ttc" id="aclassCConfig_html_aba1a437d929fef85ee9ea86dae47925f"><div class="ttname"><a href="classCConfig.html#aba1a437d929fef85ee9ea86dae47925f">CConfig::GetKind_SlopeLimit_AdjFlow</a></div><div class="ttdeci">LIMITER GetKind_SlopeLimit_AdjFlow(void) const</div><div class="ttdoc">Get the method for limiting the spatial gradients.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l04725">CConfig.hpp:4725</a></div></div>
<div class="ttc" id="aclassCConfig_html_ac421daafab2ffc8171aba0a05ce017ab"><div class="ttname"><a href="classCConfig.html#ac421daafab2ffc8171aba0a05ce017ab">CConfig::GetAdjSharp_LimiterCoeff</a></div><div class="ttdeci">su2double GetAdjSharp_LimiterCoeff(void) const</div><div class="ttdoc">Get the value of sharp edge limiter.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l02437">CConfig.hpp:2437</a></div></div>
<div class="ttc" id="aclassCConfig_html_ace4081f7013cfe0fd756dff7d9ba7f8f"><div class="ttname"><a href="classCConfig.html#ace4081f7013cfe0fd756dff7d9ba7f8f">CConfig::GetObjFunc_Extension</a></div><div class="ttdeci">string GetObjFunc_Extension(string val_filename) const</div><div class="ttdoc">Append the input filename string with the appropriate objective function extension.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8cpp_source.html#l08334">CConfig.cpp:8334</a></div></div>
<div class="ttc" id="aclassCConfig_html_ad16f71356f146b530fb1fbb45444525c"><div class="ttname"><a href="classCConfig.html#ad16f71356f146b530fb1fbb45444525c">CConfig::GetKind_TimeIntScheme</a></div><div class="ttdeci">unsigned short GetKind_TimeIntScheme(void) const</div><div class="ttdoc">Get the kind of time integration method.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l04451">CConfig.hpp:4451</a></div></div>
<div class="ttc" id="aclassCConfig_html_ad201abca17f7635b19c11cc11b03b0ac"><div class="ttname"><a href="classCConfig.html#ad201abca17f7635b19c11cc11b03b0ac">CConfig::GetRotating_Frame</a></div><div class="ttdeci">bool GetRotating_Frame(void) const</div><div class="ttdoc">Get information about the rotational frame.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l06219">CConfig.hpp:6219</a></div></div>
<div class="ttc" id="aclassCConfig_html_adb9ce1745b78e43a916afd47c9d4e96b"><div class="ttname"><a href="classCConfig.html#adb9ce1745b78e43a916afd47c9d4e96b">CConfig::SetWeight_ObjFunc</a></div><div class="ttdeci">void SetWeight_ObjFunc(unsigned short val_obj, su2double val)</div><div class="ttdoc">Set the weight of objective function. There are several options: Drag coefficient,...</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l05343">CConfig.hpp:5343</a></div></div>
<div class="ttc" id="aclassCConfig_html_ae003cd8f406eaaa91849a774c9a20730"><div class="ttname"><a href="classCConfig.html#ae003cd8f406eaaa91849a774c9a20730">CConfig::GetMarker_All_KindBC</a></div><div class="ttdeci">unsigned short GetMarker_All_KindBC(unsigned short val_marker) const</div><div class="ttdoc">Get the kind of boundary for each marker.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l03363">CConfig.hpp:3363</a></div></div>
<div class="ttc" id="aclassCConfig_html_ae55bdae4e8b4e61fd07a857005cc6799"><div class="ttname"><a href="classCConfig.html#ae55bdae4e8b4e61fd07a857005cc6799">CConfig::GetRestart</a></div><div class="ttdeci">bool GetRestart(void) const</div><div class="ttdoc">Provides the restart information.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l05391">CConfig.hpp:5391</a></div></div>
<div class="ttc" id="aclassCConfig_html_ae688e355a74025050498d8c03aee35b2"><div class="ttname"><a href="classCConfig.html#ae688e355a74025050498d8c03aee35b2">CConfig::GetFixed_CL_Mode</a></div><div class="ttdeci">bool GetFixed_CL_Mode(void) const</div><div class="ttdoc">Get information about whether to use fixed CL mode.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l08610">CConfig.hpp:8610</a></div></div>
<div class="ttc" id="aclassCConfig_html_aef335760724e0367ef46cd2714ce236d"><div class="ttname"><a href="classCConfig.html#aef335760724e0367ef46cd2714ce236d">CConfig::GetKind_Centered_AdjFlow</a></div><div class="ttdeci">CENTERED GetKind_Centered_AdjFlow(void) const</div><div class="ttdoc">Get the kind of center convective numerical scheme for the adjoint flow equations.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l04782">CConfig.hpp:4782</a></div></div>
<div class="ttc" id="aclassCConfig_html_af30dc08c28dd72bfcedc6a5a4e224036"><div class="ttname"><a href="classCConfig.html#af30dc08c28dd72bfcedc6a5a4e224036">CConfig::GetDensity_FreeStreamND</a></div><div class="ttdeci">su2double GetDensity_FreeStreamND(void) const</div><div class="ttdoc">Get the value of the non-dimensionalized freestream density.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l01936">CConfig.hpp:1936</a></div></div>
<div class="ttc" id="aclassCConfig_html_af59700a2ce4edce862248ba52bdca025"><div class="ttname"><a href="classCConfig.html#af59700a2ce4edce862248ba52bdca025">CConfig::GetKind_Gradient_Method_Recon</a></div><div class="ttdeci">unsigned short GetKind_Gradient_Method_Recon(void) const</div><div class="ttdoc">Get the kind of method for computation of spatial gradients used for upwind reconstruction.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l04167">CConfig.hpp:4167</a></div></div>
<div class="ttc" id="aclassCConfig_html_afa49e1ce7793a31cc572d957caffaef9"><div class="ttname"><a href="classCConfig.html#afa49e1ce7793a31cc572d957caffaef9">CConfig::GetTemperature_FreeStreamND</a></div><div class="ttdeci">su2double GetTemperature_FreeStreamND(void) const</div><div class="ttdoc">Get the value of the non-dimensionalized freestream temperature.</div><div class="ttdef"><b>Definition</b> <a href="CConfig_8hpp_source.html#l01924">CConfig.hpp:1924</a></div></div>
<div class="ttc" id="aclassCEdge_html_a4ace970590e47bd39ea5780c3e0e2037"><div class="ttname"><a href="classCEdge.html#a4ace970590e47bd39ea5780c3e0e2037">CEdge::GetNormal</a></div><div class="ttdeci">void GetNormal(unsigned long iEdge, T &amp;normal) const</div><div class="ttdoc">Copy the the normal vector of a face.</div><div class="ttdef"><b>Definition</b> <a href="CEdge_8hpp_source.html#l00161">CEdge.hpp:161</a></div></div>
<div class="ttc" id="aclassCEdge_html_a5cd6f283cb2f3e4dfc037c0db6ae1055"><div class="ttname"><a href="classCEdge.html#a5cd6f283cb2f3e4dfc037c0db6ae1055">CEdge::GetNode</a></div><div class="ttdeci">unsigned long GetNode(unsigned long iEdge, unsigned long iNode) const</div><div class="ttdoc">Get left/right node index defining the edge.</div><div class="ttdef"><b>Definition</b> <a href="CEdge_8hpp_source.html#l00072">CEdge.hpp:72</a></div></div>
<div class="ttc" id="aclassCGeometry_html"><div class="ttname"><a href="classCGeometry.html">CGeometry</a></div><div class="ttdoc">Parent class for defining the geometry of the problem (complete geometry, multigrid agglomerated geom...</div><div class="ttdef"><b>Definition</b> <a href="CGeometry_8hpp_source.html#l00075">CGeometry.hpp:75</a></div></div>
<div class="ttc" id="aclassCGeometry_html_a275fb07cd99ab79d7a04b4862280169d"><div class="ttname"><a href="classCGeometry.html#a275fb07cd99ab79d7a04b4862280169d">CGeometry::GetnPoint</a></div><div class="ttdeci">unsigned long GetnPoint() const</div><div class="ttdoc">Get number of points.</div><div class="ttdef"><b>Definition</b> <a href="CGeometry_8hpp_source.html#l00464">CGeometry.hpp:464</a></div></div>
<div class="ttc" id="aclassCGeometry_html_a3513d08c59b4d166078ca7a9e65c8112"><div class="ttname"><a href="classCGeometry.html#a3513d08c59b4d166078ca7a9e65c8112">CGeometry::nodes</a></div><div class="ttdeci">CPoint * nodes</div><div class="ttdoc">Node vector (dual grid information).</div><div class="ttdef"><b>Definition</b> <a href="CGeometry_8hpp_source.html#l00235">CGeometry.hpp:235</a></div></div>
<div class="ttc" id="aclassCGeometry_html_a6c5ff184cfb3b1e983b1f2abee098675"><div class="ttname"><a href="classCGeometry.html#a6c5ff184cfb3b1e983b1f2abee098675">CGeometry::vertex</a></div><div class="ttdeci">CVertex *** vertex</div><div class="ttdoc">Boundary Vertex vector (dual grid information).</div><div class="ttdef"><b>Definition</b> <a href="CGeometry_8hpp_source.html#l00237">CGeometry.hpp:237</a></div></div>
<div class="ttc" id="aclassCGeometry_html_aba89cceede61b33426b2783385431f5b"><div class="ttname"><a href="classCGeometry.html#aba89cceede61b33426b2783385431f5b">CGeometry::GetnEdge</a></div><div class="ttdeci">unsigned long GetnEdge() const</div><div class="ttdoc">Get number of edges.</div><div class="ttdef"><b>Definition</b> <a href="CGeometry_8hpp_source.html#l00494">CGeometry.hpp:494</a></div></div>
<div class="ttc" id="aclassCGeometry_html_ac84179060bbac1fe5e856ea3da850b6e"><div class="ttname"><a href="classCGeometry.html#ac84179060bbac1fe5e856ea3da850b6e">CGeometry::GetnPointDomain</a></div><div class="ttdeci">unsigned long GetnPointDomain() const</div><div class="ttdoc">Get number of real points (that belong to the domain).</div><div class="ttdef"><b>Definition</b> <a href="CGeometry_8hpp_source.html#l00470">CGeometry.hpp:470</a></div></div>
<div class="ttc" id="aclassCGeometry_html_ace7f7fe876f629f5bd5f92d4805a1a4b"><div class="ttname"><a href="classCGeometry.html#ace7f7fe876f629f5bd5f92d4805a1a4b">CGeometry::GetnDim</a></div><div class="ttdeci">unsigned short GetnDim() const</div><div class="ttdoc">Get number of coordinates.</div><div class="ttdef"><b>Definition</b> <a href="CGeometry_8hpp_source.html#l00452">CGeometry.hpp:452</a></div></div>
<div class="ttc" id="aclassCGeometry_html_ad3786f48d61e374f2da254781de1b7c7"><div class="ttname"><a href="classCGeometry.html#ad3786f48d61e374f2da254781de1b7c7">CGeometry::edges</a></div><div class="ttdeci">CEdge * edges</div><div class="ttdoc">Edge vector (dual grid information).</div><div class="ttdef"><b>Definition</b> <a href="CGeometry_8hpp_source.html#l00236">CGeometry.hpp:236</a></div></div>
<div class="ttc" id="aclassCGeometry_html_aeba95cec237839c5b08f0f5fbe0d9fd9"><div class="ttname"><a href="classCGeometry.html#aeba95cec237839c5b08f0f5fbe0d9fd9">CGeometry::nVertex</a></div><div class="ttdeci">unsigned long * nVertex</div><div class="ttdoc">Number of vertex for each marker.</div><div class="ttdef"><b>Definition</b> <a href="CGeometry_8hpp_source.html#l00240">CGeometry.hpp:240</a></div></div>
<div class="ttc" id="aclassCNumerics_html"><div class="ttname"><a href="classCNumerics.html">CNumerics</a></div><div class="ttdoc">Class for defining the numerical methods.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00047">CNumerics.hpp:47</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a028c500ba7ce96d3af061fc8218f76f1"><div class="ttname"><a href="classCNumerics.html#a028c500ba7ce96d3af061fc8218f76f1">CNumerics::SetPrimitive</a></div><div class="ttdeci">void SetPrimitive(const su2double *val_v_i, const su2double *val_v_j)</div><div class="ttdoc">Set the value of the primitive variables.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00285">CNumerics.hpp:285</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a0d3d722905b8615ef2cb5d59c4b95fb3"><div class="ttname"><a href="classCNumerics.html#a0d3d722905b8615ef2cb5d59c4b95fb3">CNumerics::SetLaminarViscosity</a></div><div class="ttdeci">void SetLaminarViscosity(su2double val_laminar_viscosity_i, su2double val_laminar_viscosity_j)</div><div class="ttdoc">Set the laminar viscosity.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00759">CNumerics.hpp:759</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a18b6238c38e05339954c0bb6121203d1"><div class="ttname"><a href="classCNumerics.html#a18b6238c38e05339954c0bb6121203d1">CNumerics::ComputeStressTensor</a></div><div class="ttdeci">static void ComputeStressTensor(size_t nDim, Mat1 &amp;stress, const Mat2 &amp;velgrad, Scalar viscosity, Scalar density=0.0, Scalar turb_ke=0.0, bool reynolds3x3=false)</div><div class="ttdoc">Compute the stress tensor from the velocity gradients.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00478">CNumerics.hpp:478</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a254b157377df5d326d24ee75e6e3676c"><div class="ttname"><a href="classCNumerics.html#a254b157377df5d326d24ee75e6e3676c">CNumerics::SetAdjointVarGradient</a></div><div class="ttdeci">void SetAdjointVarGradient(CMatrixView&lt; const su2double &gt; val_psivar_grad_i, CMatrixView&lt; const su2double &gt; val_psivar_grad_j)</div><div class="ttdoc">Set the gradient of the adjoint variables.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00343">CNumerics.hpp:343</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a2d59a0969bac4b0e43b74ba4ec4d1eff"><div class="ttname"><a href="classCNumerics.html#a2d59a0969bac4b0e43b74ba4ec4d1eff">CNumerics::SetConservative</a></div><div class="ttdeci">void SetConservative(const su2double *val_u_i, const su2double *val_u_j)</div><div class="ttdoc">Set the value of the conservative variables.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00275">CNumerics.hpp:275</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a3466f25da2e4c85318ee663b2d2cb1bb"><div class="ttname"><a href="classCNumerics.html#a3466f25da2e4c85318ee663b2d2cb1bb">CNumerics::SetTurbAdjointGradient</a></div><div class="ttdeci">void SetTurbAdjointGradient(CMatrixView&lt; const su2double &gt; val_turbpsivar_grad_i, CMatrixView&lt; const su2double &gt; val_turbpsivar_grad_j)</div><div class="ttdoc">Set the gradient of the adjoint turbulent variables.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00414">CNumerics.hpp:414</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a49309c657274b77aa644958053b68bf4"><div class="ttname"><a href="classCNumerics.html#a49309c657274b77aa644958053b68bf4">CNumerics::SetPrimVarGradient</a></div><div class="ttdeci">void SetPrimVarGradient(CMatrixView&lt; const su2double &gt; val_primvar_grad_i, CMatrixView&lt; const su2double &gt; val_primvar_grad_j)</div><div class="ttdoc">Set the gradient of the primitive variables.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00322">CNumerics.hpp:322</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a53c24228ba235c1a0c2e4509243e5e88"><div class="ttname"><a href="classCNumerics.html#a53c24228ba235c1a0c2e4509243e5e88">CNumerics::SetVolume</a></div><div class="ttdeci">void SetVolume(su2double val_volume)</div><div class="ttdoc">Set the value of the volume of the control volume.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00961">CNumerics.hpp:961</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a6ca4a8e17d68ea63f1dba96cd5f2967d"><div class="ttname"><a href="classCNumerics.html#a6ca4a8e17d68ea63f1dba96cd5f2967d">CNumerics::SetCoord</a></div><div class="ttdeci">void SetCoord(const su2double *val_coord_i, const su2double *val_coord_j)</div><div class="ttdoc">Set coordinates of the points.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00846">CNumerics.hpp:846</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a6e1c4dea51983cbe489762bd43bae41d"><div class="ttname"><a href="classCNumerics.html#a6e1c4dea51983cbe489762bd43bae41d">CNumerics::SetScalarVar</a></div><div class="ttdeci">void SetScalarVar(const su2double *val_scalarvar_i, const su2double *val_scalarvar_j)</div><div class="ttdoc">Set the value of the scalar variable.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00354">CNumerics.hpp:354</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a7a305597659a44840687afc1c1e0da6b"><div class="ttname"><a href="classCNumerics.html#a7a305597659a44840687afc1c1e0da6b">CNumerics::SetAdjointVar</a></div><div class="ttdeci">void SetAdjointVar(const su2double *val_psi_i, const su2double *val_psi_j)</div><div class="ttdoc">Set the value of the adjoint variable.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00333">CNumerics.hpp:333</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a8c5ce8e8a1cb2c0bb03bf408d9a80d68"><div class="ttname"><a href="classCNumerics.html#a8c5ce8e8a1cb2c0bb03bf408d9a80d68">CNumerics::SetScalarVarGradient</a></div><div class="ttdeci">void SetScalarVarGradient(CMatrixView&lt; const su2double &gt; val_scalarvar_grad_i, CMatrixView&lt; const su2double &gt; val_scalarvar_grad_j)</div><div class="ttdoc">Set the gradient of the scalar variables.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00374">CNumerics.hpp:374</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a93fd2262832ae5081317548f2f9cdbb3"><div class="ttname"><a href="classCNumerics.html#a93fd2262832ae5081317548f2f9cdbb3">CNumerics::SetNormal</a></div><div class="ttdeci">void SetNormal(const su2double *val_normal)</div><div class="ttdoc">Set the value of the normal vector to the face between two points.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00955">CNumerics.hpp:955</a></div></div>
<div class="ttc" id="aclassCNumerics_html_a9c9dd8be231884769f29c799db2404be"><div class="ttname"><a href="classCNumerics.html#a9c9dd8be231884769f29c799db2404be">CNumerics::SetDistance</a></div><div class="ttdeci">void SetDistance(su2double val_dist_i, su2double val_dist_j)</div><div class="ttdoc">Set the value of the distance from the nearest wall.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00826">CNumerics.hpp:826</a></div></div>
<div class="ttc" id="aclassCNumerics_html_aa0ca13663a047ef2640b377b33875e29"><div class="ttname"><a href="classCNumerics.html#aa0ca13663a047ef2640b377b33875e29">CNumerics::ComputeResidual</a></div><div class="ttdeci">virtual void ComputeResidual(su2double *val_residual, CConfig *config)</div><div class="ttdoc">Compute the numerical residual.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l01286">CNumerics.hpp:1286</a></div></div>
<div class="ttc" id="aclassCNumerics_html_aaf211e0fafb2ffea485a888cc5a3a725"><div class="ttname"><a href="classCNumerics.html#aaf211e0fafb2ffea485a888cc5a3a725">CNumerics::SetTurbAdjointVar</a></div><div class="ttdeci">void SetTurbAdjointVar(const su2double *val_turbpsivar_i, const su2double *val_turbpsivar_j)</div><div class="ttdoc">Set the value of the adjoint turbulent variable.</div><div class="ttdef"><b>Definition</b> <a href="CNumerics_8hpp_source.html#l00404">CNumerics.hpp:404</a></div></div>
<div class="ttc" id="aclassCPoint_html_a870a64e09cf1a2be5909ccc8f1483d50"><div class="ttname"><a href="classCPoint.html#a870a64e09cf1a2be5909ccc8f1483d50">CPoint::GetGridVel_Grad</a></div><div class="ttdeci">CVectorOfMatrix &amp; GetGridVel_Grad()</div><div class="ttdoc">Get the grid velocity gradients for the entire domain.</div><div class="ttdef"><b>Definition</b> <a href="CPoint_8hpp_source.html#l00851">CPoint.hpp:851</a></div></div>
<div class="ttc" id="aclassCPoint_html_aa58a27b602e47ddcad22ae74a5c6bc81"><div class="ttname"><a href="classCPoint.html#aa58a27b602e47ddcad22ae74a5c6bc81">CPoint::GetDomain</a></div><div class="ttdeci">bool GetDomain(unsigned long iPoint) const</div><div class="ttdoc">For parallel computation, its indicates if a point must be computed or not.</div><div class="ttdef"><b>Definition</b> <a href="CPoint_8hpp_source.html#l00425">CPoint.hpp:425</a></div></div>
<div class="ttc" id="aclassCPoint_html_ab16c29dd03911529cd73bf467c313179"><div class="ttname"><a href="classCPoint.html#ab16c29dd03911529cd73bf467c313179">CPoint::GetCoord</a></div><div class="ttdeci">su2double GetCoord(unsigned long iPoint, unsigned long iDim) const</div><div class="ttdoc">Get the coordinates dor the control volume.</div><div class="ttdef"><b>Definition</b> <a href="CPoint_8hpp_source.html#l00158">CPoint.hpp:158</a></div></div>
<div class="ttc" id="aclassCPoint_html_acc83b19b9c7201987cc2e948a7259af8"><div class="ttname"><a href="classCPoint.html#acc83b19b9c7201987cc2e948a7259af8">CPoint::GetVolume</a></div><div class="ttdeci">su2double &amp; GetVolume(unsigned long iPoint)</div><div class="ttdoc">Get area or volume of the control volume.</div><div class="ttdef"><b>Definition</b> <a href="CPoint_8hpp_source.html#l00559">CPoint.hpp:559</a></div></div>
<div class="ttc" id="aclassCPoint_html_ad7b8ff47f6645f36c9a529073343c097"><div class="ttname"><a href="classCPoint.html#ad7b8ff47f6645f36c9a529073343c097">CPoint::GetGridVel</a></div><div class="ttdeci">su2double * GetGridVel(unsigned long iPoint)</div><div class="ttdoc">Get the value of the grid velocity at the point.</div><div class="ttdef"><b>Definition</b> <a href="CPoint_8hpp_source.html#l00822">CPoint.hpp:822</a></div></div>
<div class="ttc" id="aclassCPoint_html_adc3f21497e23f4d682d62ed454daac66"><div class="ttname"><a href="classCPoint.html#adc3f21497e23f4d682d62ed454daac66">CPoint::GetSharpEdge_Distance</a></div><div class="ttdeci">su2double &amp; GetSharpEdge_Distance(unsigned long iPoint)</div><div class="ttdoc">Get the value of the distance to a sharp edge.</div><div class="ttdef"><b>Definition</b> <a href="CPoint_8hpp_source.html#l00523">CPoint.hpp:523</a></div></div>
<div class="ttc" id="aclassCPoint_html_aed2e3cbb4c15d03c7cee5602e8c06985"><div class="ttname"><a href="classCPoint.html#aed2e3cbb4c15d03c7cee5602e8c06985">CPoint::GetWall_Distance</a></div><div class="ttdeci">su2double &amp; GetWall_Distance(unsigned long iPoint)</div><div class="ttdoc">Get the value of the distance to the nearest wall.</div><div class="ttdef"><b>Definition</b> <a href="CPoint_8hpp_source.html#l00494">CPoint.hpp:494</a></div></div>
<div class="ttc" id="aclassCSolver_html"><div class="ttname"><a href="classCSolver.html">CSolver</a></div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00066">CSolver.hpp:66</a></div></div>
<div class="ttc" id="aclassCSolver_html_a0b5af72c2c107a4c6831dc6df1b83881"><div class="ttname"><a href="classCSolver.html#a0b5af72c2c107a4c6831dc6df1b83881">CSolver::Jacobian</a></div><div class="ttdeci">CSysMatrix&lt; su2mixedfloat &gt; Jacobian</div><div class="ttdoc">Complete sparse Jacobian structure for implicit computations.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00194">CSolver.hpp:194</a></div></div>
<div class="ttc" id="aclassCSolver_html_a0ff55af7303be290661b65f60a037a42"><div class="ttname"><a href="classCSolver.html#a0ff55af7303be290661b65f60a037a42">CSolver::Jacobian_jj</a></div><div class="ttdeci">su2double ** Jacobian_jj</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00129">CSolver.hpp:129</a></div></div>
<div class="ttc" id="aclassCSolver_html_a11fe70fe56043dd44dd79b7d9aa358f0"><div class="ttname"><a href="classCSolver.html#a11fe70fe56043dd44dd79b7d9aa358f0">CSolver::Jacobian_j</a></div><div class="ttdeci">su2double ** Jacobian_j</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians at point j.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00125">CSolver.hpp:125</a></div></div>
<div class="ttc" id="aclassCSolver_html_a167cf81a9f3a29dc176728cb033185a4"><div class="ttname"><a href="classCSolver.html#a167cf81a9f3a29dc176728cb033185a4">CSolver::Point_Max_Coord</a></div><div class="ttdeci">su2activematrix Point_Max_Coord</div><div class="ttdoc">Vector with pointers to the coords of the maximal residual for each variable.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00100">CSolver.hpp:100</a></div></div>
<div class="ttc" id="aclassCSolver_html_a1b8b8b923658b7e099dc1f5c86a1dd4d"><div class="ttname"><a href="classCSolver.html#a1b8b8b923658b7e099dc1f5c86a1dd4d">CSolver::SetSolution_Gradient_GG</a></div><div class="ttdeci">void SetSolution_Gradient_GG(CGeometry *geometry, const CConfig *config, bool reconstruction=false)</div><div class="ttdoc">Compute the Green-Gauss gradient of the solution.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8cpp_source.html#l02113">CSolver.cpp:2113</a></div></div>
<div class="ttc" id="aclassCSolver_html_a1d6e05a7a904684360013dff7b241be6"><div class="ttname"><a href="classCSolver.html#a1d6e05a7a904684360013dff7b241be6">CSolver::Residual_j</a></div><div class="ttdeci">su2double * Residual_j</div><div class="ttdoc">Auxiliary nVar vector for storing the residual at point j.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00110">CSolver.hpp:110</a></div></div>
<div class="ttc" id="aclassCSolver_html_a203241aa245597347fb258fac60962f6"><div class="ttname"><a href="classCSolver.html#a203241aa245597347fb258fac60962f6">CSolver::nDim</a></div><div class="ttdeci">unsigned short nDim</div><div class="ttdoc">Number of dimensions of the problem.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00086">CSolver.hpp:86</a></div></div>
<div class="ttc" id="aclassCSolver_html_a223a1270fee36d9c742e806a47b0ffb3"><div class="ttname"><a href="classCSolver.html#a223a1270fee36d9c742e806a47b0ffb3">CSolver::Jacobian_i</a></div><div class="ttdeci">su2double ** Jacobian_i</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians at point i.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00124">CSolver.hpp:124</a></div></div>
<div class="ttc" id="aclassCSolver_html_a287c7f92e934ae07a3b772c0752142e7"><div class="ttname"><a href="classCSolver.html#a287c7f92e934ae07a3b772c0752142e7">CSolver::SetGridVel_Gradient</a></div><div class="ttdeci">void SetGridVel_Gradient(CGeometry *geometry, const CConfig *config) const</div><div class="ttdoc">Compute the Least Squares gradient of the grid velocity.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8cpp_source.html#l02233">CSolver.cpp:2233</a></div></div>
<div class="ttc" id="aclassCSolver_html_a313f866523cd6bed20eb620faee4b73a"><div class="ttname"><a href="classCSolver.html#a313f866523cd6bed20eb620faee4b73a">CSolver::Residual_i</a></div><div class="ttdeci">su2double * Residual_i</div><div class="ttdoc">Auxiliary nVar vector for storing the residual at point i.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00109">CSolver.hpp:109</a></div></div>
<div class="ttc" id="aclassCSolver_html_a37691f1bd6dc4fe9f28ae511b0def484"><div class="ttname"><a href="classCSolver.html#a37691f1bd6dc4fe9f28ae511b0def484">CSolver::Jacobian_ii</a></div><div class="ttdeci">su2double ** Jacobian_ii</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00126">CSolver.hpp:126</a></div></div>
<div class="ttc" id="aclassCSolver_html_a3a9516a882682f02bd9ab15d209740e5"><div class="ttname"><a href="classCSolver.html#a3a9516a882682f02bd9ab15d209740e5">CSolver::GetTotal_HeatFlux</a></div><div class="ttdeci">virtual su2double GetTotal_HeatFlux() const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l02209">CSolver.hpp:2209</a></div></div>
<div class="ttc" id="aclassCSolver_html_a3f318bceaa27f4800de8ecf2cdcae5fb"><div class="ttname"><a href="classCSolver.html#a3f318bceaa27f4800de8ecf2cdcae5fb">CSolver::LinSysSol</a></div><div class="ttdeci">CSysVector&lt; su2double &gt; LinSysSol</div><div class="ttdoc">vector to store iterative solution of implicit linear system.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00191">CSolver.hpp:191</a></div></div>
<div class="ttc" id="aclassCSolver_html_a403c73150cc7c99c43763238c1005242"><div class="ttname"><a href="classCSolver.html#a403c73150cc7c99c43763238c1005242">CSolver::Res_Conv_i</a></div><div class="ttdeci">su2double * Res_Conv_i</div><div class="ttdoc">Auxiliary vector for storing the convective residual at point i.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00120">CSolver.hpp:120</a></div></div>
<div class="ttc" id="aclassCSolver_html_a515af1055f70b894174566926ae3cae2"><div class="ttname"><a href="classCSolver.html#a515af1055f70b894174566926ae3cae2">CSolver::nPoint</a></div><div class="ttdeci">unsigned long nPoint</div><div class="ttdoc">Number of points of the computational grid.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00087">CSolver.hpp:87</a></div></div>
<div class="ttc" id="aclassCSolver_html_a517cd065a6aef8177158c3cd51e81738"><div class="ttname"><a href="classCSolver.html#a517cd065a6aef8177158c3cd51e81738">CSolver::SetSolution_Gradient_LS</a></div><div class="ttdeci">void SetSolution_Gradient_LS(CGeometry *geometry, const CConfig *config, bool reconstruction=false)</div><div class="ttdoc">Compute the Least Squares gradient of the solution.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8cpp_source.html#l02123">CSolver.cpp:2123</a></div></div>
<div class="ttc" id="aclassCSolver_html_a56fdcd670654dd632a847c70d4b42597"><div class="ttname"><a href="classCSolver.html#a56fdcd670654dd632a847c70d4b42597">CSolver::Res_Visc_i</a></div><div class="ttdeci">su2double * Res_Visc_i</div><div class="ttdoc">Auxiliary vector for storing the viscous residual at point i.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00121">CSolver.hpp:121</a></div></div>
<div class="ttc" id="aclassCSolver_html_a59168ff9a35447672e6ee77cf4bcb1ec"><div class="ttname"><a href="classCSolver.html#a59168ff9a35447672e6ee77cf4bcb1ec">CSolver::SetTime_Step</a></div><div class="ttdeci">virtual void SetTime_Step(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, unsigned long Iteration)</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00605">CSolver.hpp:605</a></div></div>
<div class="ttc" id="aclassCSolver_html_a59da1efb04d4d6cb0627b61005ff3ed5"><div class="ttname"><a href="classCSolver.html#a59da1efb04d4d6cb0627b61005ff3ed5">CSolver::Residual_Max</a></div><div class="ttdeci">vector&lt; su2double &gt; Residual_Max</div><div class="ttdoc">Vector with the maximal residual for each variable.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00095">CSolver.hpp:95</a></div></div>
<div class="ttc" id="aclassCSolver_html_a5c2921b0edd0eec84882c328a740904a"><div class="ttname"><a href="classCSolver.html#a5c2921b0edd0eec84882c328a740904a">CSolver::rank</a></div><div class="ttdeci">int rank</div><div class="ttdoc">MPI Rank.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00070">CSolver.hpp:70</a></div></div>
<div class="ttc" id="aclassCSolver_html_a6891c839827efbebdcbf9a349f4da92c"><div class="ttname"><a href="classCSolver.html#a6891c839827efbebdcbf9a349f4da92c">CSolver::CompleteComms</a></div><div class="ttdeci">void CompleteComms(CGeometry *geometry, const CConfig *config, unsigned short commType)</div><div class="ttdoc">Routine to complete the set of non-blocking communications launched by InitiateComms() and unpacking ...</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8cpp_source.html#l01548">CSolver.cpp:1548</a></div></div>
<div class="ttc" id="aclassCSolver_html_a69bc3df96cdb96a8b25b788118c4fcc9"><div class="ttname"><a href="classCSolver.html#a69bc3df96cdb96a8b25b788118c4fcc9">CSolver::nVar</a></div><div class="ttdeci">unsigned short nVar</div><div class="ttdoc">Number of variables of the problem.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00080">CSolver.hpp:80</a></div></div>
<div class="ttc" id="aclassCSolver_html_a6bc3916452ffa54c2436de7bb627fefa"><div class="ttname"><a href="classCSolver.html#a6bc3916452ffa54c2436de7bb627fefa">CSolver::SetSolution_Limiter</a></div><div class="ttdeci">void SetSolution_Limiter(CGeometry *geometry, const CConfig *config)</div><div class="ttdoc">Compute slope limiter.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8cpp_source.html#l02245">CSolver.cpp:2245</a></div></div>
<div class="ttc" id="aclassCSolver_html_a75021726ee9fbb9262ffea01e989237a"><div class="ttname"><a href="classCSolver.html#a75021726ee9fbb9262ffea01e989237a">CSolver::Res_Visc_j</a></div><div class="ttdeci">su2double * Res_Visc_j</div><div class="ttdoc">Auxiliary vector for storing the viscous residual at point j.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00123">CSolver.hpp:123</a></div></div>
<div class="ttc" id="aclassCSolver_html_a7be1f967f5d31417059fbbaf88d55309"><div class="ttname"><a href="classCSolver.html#a7be1f967f5d31417059fbbaf88d55309">CSolver::LinSysRes</a></div><div class="ttdeci">CSysVector&lt; su2double &gt; LinSysRes</div><div class="ttdoc">vector to store iterative residual of implicit linear system.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00192">CSolver.hpp:192</a></div></div>
<div class="ttc" id="aclassCSolver_html_a7c5c26e7f006b4bb7e93582d839cf09d"><div class="ttname"><a href="classCSolver.html#a7c5c26e7f006b4bb7e93582d839cf09d">CSolver::InitiateComms</a></div><div class="ttdeci">void InitiateComms(CGeometry *geometry, const CConfig *config, unsigned short commType)</div><div class="ttdoc">Routine to load a solver quantity into the data structures for MPI point-to-point communication and t...</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8cpp_source.html#l01406">CSolver.cpp:1406</a></div></div>
<div class="ttc" id="aclassCSolver_html_a9958742a687a4c92d0bf1ead78aa1a0c"><div class="ttname"><a href="classCSolver.html#a9958742a687a4c92d0bf1ead78aa1a0c">CSolver::Solution</a></div><div class="ttdeci">su2double * Solution</div><div class="ttdoc">Auxiliary nVar vector.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00111">CSolver.hpp:111</a></div></div>
<div class="ttc" id="aclassCSolver_html_a9cbdd9cf3215a07fe59433fc9504a3bb"><div class="ttname"><a href="classCSolver.html#a9cbdd9cf3215a07fe59433fc9504a3bb">CSolver::nPointDomain</a></div><div class="ttdeci">unsigned long nPointDomain</div><div class="ttdoc">Number of points of the computational grid.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00088">CSolver.hpp:88</a></div></div>
<div class="ttc" id="aclassCSolver_html_aa3e97145d1cf5b3803df5ac763eca2fc"><div class="ttname"><a href="classCSolver.html#aa3e97145d1cf5b3803df5ac763eca2fc">CSolver::Solution_j</a></div><div class="ttdeci">su2double * Solution_j</div><div class="ttdoc">Auxiliary nVar vector for storing the solution at point j.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00113">CSolver.hpp:113</a></div></div>
<div class="ttc" id="aclassCSolver_html_aa4d789119564e1489b48763e0f7cdeee"><div class="ttname"><a href="classCSolver.html#aa4d789119564e1489b48763e0f7cdeee">CSolver::Solution_i</a></div><div class="ttdeci">su2double * Solution_i</div><div class="ttdoc">Auxiliary nVar vector for storing the solution at point i.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00112">CSolver.hpp:112</a></div></div>
<div class="ttc" id="aclassCSolver_html_ac2b7eb546780ee9e5aa95ca88562699d"><div class="ttname"><a href="classCSolver.html#ac2b7eb546780ee9e5aa95ca88562699d">CSolver::Residual_RMS</a></div><div class="ttdeci">vector&lt; su2double &gt; Residual_RMS</div><div class="ttdoc">Vector with the mean residual for each variable.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00094">CSolver.hpp:94</a></div></div>
<div class="ttc" id="aclassCSolver_html_ad982896202dae6e41bfd3568f597cf46"><div class="ttname"><a href="classCSolver.html#ad982896202dae6e41bfd3568f597cf46">CSolver::SetBaseClassPointerToNodes</a></div><div class="ttdeci">void SetBaseClassPointerToNodes()</div><div class="ttdoc">Call this method to set &quot;base_nodes&quot; after the &quot;nodes&quot; variable of the derived solver is instantiated...</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00165">CSolver.hpp:165</a></div></div>
<div class="ttc" id="aclassCSolver_html_adb28ae3845a6b61cf764a8e9fe4b794e"><div class="ttname"><a href="classCSolver.html#adb28ae3845a6b61cf764a8e9fe4b794e">CSolver::GetNodes</a></div><div class="ttdeci">CVariable * GetNodes()</div><div class="ttdoc">Allow outside access to the nodes of the solver, containing conservatives, primitives,...</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00226">CSolver.hpp:226</a></div></div>
<div class="ttc" id="aclassCSolver_html_adbb9d8927623f02c779ad6fe07fe44ff"><div class="ttname"><a href="classCSolver.html#adbb9d8927623f02c779ad6fe07fe44ff">CSolver::Residual</a></div><div class="ttdeci">su2double * Residual</div><div class="ttdoc">Auxiliary nVar vector.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00108">CSolver.hpp:108</a></div></div>
<div class="ttc" id="aclassCSolver_html_ae31efca489e7d21f78b5c63c7c353134"><div class="ttname"><a href="classCSolver.html#ae31efca489e7d21f78b5c63c7c353134">CSolver::Jacobian_ij</a></div><div class="ttdeci">su2double ** Jacobian_ij</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00127">CSolver.hpp:127</a></div></div>
<div class="ttc" id="aclassCSolver_html_ae9fa6bf0e3ef0dff07dd85e0a87eef4d"><div class="ttname"><a href="classCSolver.html#ae9fa6bf0e3ef0dff07dd85e0a87eef4d">CSolver::SetUndivided_Laplacian</a></div><div class="ttdeci">void SetUndivided_Laplacian(CGeometry *geometry, const CConfig *config)</div><div class="ttdoc">Compute the undivided laplacian for the solution variables.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8cpp_source.html#l02146">CSolver.cpp:2146</a></div></div>
<div class="ttc" id="aclassCSolver_html_aea78ca4418d89965bfe052196a360389"><div class="ttname"><a href="classCSolver.html#aea78ca4418d89965bfe052196a360389">CSolver::Res_Conv_j</a></div><div class="ttdeci">su2double * Res_Conv_j</div><div class="ttdoc">Auxiliary vector for storing the convective residual at point j.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00122">CSolver.hpp:122</a></div></div>
<div class="ttc" id="aclassCSolver_html_aeca105abe8a547328e2b1a320708b226"><div class="ttname"><a href="classCSolver.html#aeca105abe8a547328e2b1a320708b226">CSolver::Jacobian_ji</a></div><div class="ttdeci">su2double ** Jacobian_ji</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00128">CSolver.hpp:128</a></div></div>
<div class="ttc" id="aclassCSolver_html_af333279175711dc23f668300c357bd5c"><div class="ttname"><a href="classCSolver.html#af333279175711dc23f668300c357bd5c">CSolver::Point_Max</a></div><div class="ttdeci">vector&lt; unsigned long &gt; Point_Max</div><div class="ttdoc">Vector with the maximal residual for each variable.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00098">CSolver.hpp:98</a></div></div>
<div class="ttc" id="aclassCSolver_html_af494e3d4d3cda6635e6b55da05de9662"><div class="ttname"><a href="classCSolver.html#af494e3d4d3cda6635e6b55da05de9662">CSolver::Vector_i</a></div><div class="ttdeci">su2double * Vector_i</div><div class="ttdoc">Auxiliary nDim vector to do the reconstruction of the variables at point i.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00115">CSolver.hpp:115</a></div></div>
<div class="ttc" id="aclassCSolver_html_af6b2525dd5f8326b7b72f51c5f749b30"><div class="ttname"><a href="classCSolver.html#af6b2525dd5f8326b7b72f51c5f749b30">CSolver::Vector_j</a></div><div class="ttdeci">su2double * Vector_j</div><div class="ttdoc">Auxiliary nDim vector to do the reconstruction of the variables at point j.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00116">CSolver.hpp:116</a></div></div>
<div class="ttc" id="aclassCSolver_html_af8dc930f3b6fc31ecf48d2294baf9d5f"><div class="ttname"><a href="classCSolver.html#af8dc930f3b6fc31ecf48d2294baf9d5f">CSolver::nVarGrad</a></div><div class="ttdeci">unsigned short nVarGrad</div><div class="ttdoc">Number of variables for deallocating the LS Cvector.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00085">CSolver.hpp:85</a></div></div>
<div class="ttc" id="aclassCSolver_html_afb56deafa3cb78f8b32ccc88e5f7f873"><div class="ttname"><a href="classCSolver.html#afb56deafa3cb78f8b32ccc88e5f7f873">CSolver::nMarker</a></div><div class="ttdeci">unsigned long nMarker</div><div class="ttdoc">Total number of markers using the grid information.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00141">CSolver.hpp:141</a></div></div>
<div class="ttc" id="aclassCSolver_html_afb69ab045d3dd03f45e013d448c3cea3"><div class="ttname"><a href="classCSolver.html#afb69ab045d3dd03f45e013d448c3cea3">CSolver::adjoint</a></div><div class="ttdeci">bool adjoint</div><div class="ttdoc">Boolean to determine whether solver is initialized as a direct or an adjoint solver.</div><div class="ttdef"><b>Definition</b> <a href="CSolver_8hpp_source.html#l00072">CSolver.hpp:72</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_a03a189a2120be05e21fbd9b120549427"><div class="ttname"><a href="classCSysMatrix.html#a03a189a2120be05e21fbd9b120549427">CSysMatrix::AddBlock</a></div><div class="ttdeci">void AddBlock(unsigned long block_i, unsigned long block_j, const OtherType *val_block, OtherType alpha=1.0)</div><div class="ttdoc">Add a scaled block (in flat format) to the sparse matrix (see SetBlock).</div><div class="ttdef"><b>Definition</b> <a href="CSysMatrix_8hpp_source.html#l00458">CSysMatrix.hpp:458</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_a423b77066cf386dd6e4b95a656e4aadb"><div class="ttname"><a href="classCSysMatrix.html#a423b77066cf386dd6e4b95a656e4aadb">CSysMatrix::SubtractBlock2Diag</a></div><div class="ttdeci">void SubtractBlock2Diag(unsigned long block_i, const OtherType &amp;val_block)</div><div class="ttdoc">Short-hand to AddBlock2Diag with alpha = -1, i.e. subtracts from the current diagonal.</div><div class="ttdef"><b>Definition</b> <a href="CSysMatrix_8hpp_source.html#l00747">CSysMatrix.hpp:747</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_a5a4ef7eeb7f009450f575660108ed7be"><div class="ttname"><a href="classCSysMatrix.html#a5a4ef7eeb7f009450f575660108ed7be">CSysMatrix::AddBlock2Diag</a></div><div class="ttdeci">void AddBlock2Diag(unsigned long block_i, const OtherType &amp;val_block, T alpha=1.0)</div><div class="ttdoc">Non overwrite version of SetBlock2Diag, also with scaling.</div><div class="ttdef"><b>Definition</b> <a href="CSysMatrix_8hpp_source.html#l00739">CSysMatrix.hpp:739</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_a8f974ad2e089dccfc99ea21a4ef5a819"><div class="ttname"><a href="classCSysMatrix.html#a8f974ad2e089dccfc99ea21a4ef5a819">CSysMatrix::SetValZero</a></div><div class="ttdeci">void SetValZero(void)</div><div class="ttdoc">Sets to zero all the entries of the sparse matrix.</div><div class="ttdef"><b>Definition</b> <a href="CSysMatrix_8cpp_source.html#l00457">CSysMatrix.cpp:457</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_a9473b0224c9b9a2749571db0bbd22a70"><div class="ttname"><a href="classCSysMatrix.html#a9473b0224c9b9a2749571db0bbd22a70">CSysMatrix::DeleteValsRowi</a></div><div class="ttdeci">void DeleteValsRowi(unsigned long i)</div><div class="ttdoc">Deletes the values of the row i of the sparse matrix.</div><div class="ttdef"><b>Definition</b> <a href="CSysMatrix_8cpp_source.html#l00553">CSysMatrix.cpp:553</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_aaa63a679856fad3b4e76f9085b0ca40f"><div class="ttname"><a href="classCSysMatrix.html#aaa63a679856fad3b4e76f9085b0ca40f">CSysMatrix::SubtractBlock</a></div><div class="ttdeci">void SubtractBlock(unsigned long block_i, unsigned long block_j, const OtherType *const *val_block)</div><div class="ttdoc">Subtracts the specified block to the sparse matrix (see AddBlock).</div><div class="ttdef"><b>Definition</b> <a href="CSysMatrix_8hpp_source.html#l00504">CSysMatrix.hpp:504</a></div></div>
<div class="ttc" id="aclassCSysMatrix_html_ae17220ac30c2abcc7fdd3c5dc8f04571"><div class="ttname"><a href="classCSysMatrix.html#ae17220ac30c2abcc7fdd3c5dc8f04571">CSysMatrix::Initialize</a></div><div class="ttdeci">void Initialize(unsigned long npoint, unsigned long npointdomain, unsigned short nvar, unsigned short neqn, bool EdgeConnect, CGeometry *geometry, const CConfig *config, bool needTranspPtr=false, bool grad_mode=false)</div><div class="ttdoc">Initializes the sparse matrix.</div><div class="ttdef"><b>Definition</b> <a href="CSysMatrix_8cpp_source.html#l00080">CSysMatrix.cpp:80</a></div></div>
<div class="ttc" id="aclassCSysVector_html_a71ea6ec1ebdb77535b976bb40e7659a6"><div class="ttname"><a href="classCSysVector.html#a71ea6ec1ebdb77535b976bb40e7659a6">CSysVector::SubtractBlock</a></div><div class="ttdeci">void SubtractBlock(unsigned long iPoint, const VectorType &amp;block)</div><div class="ttdoc">Subtract &quot;block&quot; from the vector, see AddBlock.</div><div class="ttdef"><b>Definition</b> <a href="CSysVector_8hpp_source.html#l00385">CSysVector.hpp:385</a></div></div>
<div class="ttc" id="aclassCSysVector_html_a9990ad4ea225c98a1af50e00fecbc56f"><div class="ttname"><a href="classCSysVector.html#a9990ad4ea225c98a1af50e00fecbc56f">CSysVector::SetBlock_Zero</a></div><div class="ttdeci">void SetBlock_Zero(unsigned long iPoint)</div><div class="ttdoc">Set the values to zero for one block.</div><div class="ttdef"><b>Definition</b> <a href="CSysVector_8hpp_source.html#l00353">CSysVector.hpp:353</a></div></div>
<div class="ttc" id="aclassCSysVector_html_aa463275cba394503a9778529fdaa4494"><div class="ttname"><a href="classCSysVector.html#aa463275cba394503a9778529fdaa4494">CSysVector::AddBlock</a></div><div class="ttdeci">void AddBlock(unsigned long iPoint, const VectorType &amp;block, ScalarType alpha=1)</div><div class="ttdoc">Add &quot;block&quot; to the vector, see SetBlock.</div><div class="ttdef"><b>Definition</b> <a href="CSysVector_8hpp_source.html#l00377">CSysVector.hpp:377</a></div></div>
<div class="ttc" id="aclassCVariable_html_a0acbe55ca86de2c0205ae921193e9e95"><div class="ttname"><a href="classCVariable.html#a0acbe55ca86de2c0205ae921193e9e95">CVariable::GetLaminarViscosity</a></div><div class="ttdeci">virtual su2double GetLaminarViscosity(unsigned long iPoint) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition</b> <a href="CVariable_8hpp_source.html#l01074">CVariable.hpp:1074</a></div></div>
<div class="ttc" id="aclassCVariable_html_a20a656c4093a9101875dde0886d0ecef"><div class="ttname"><a href="classCVariable.html#a20a656c4093a9101875dde0886d0ecef">CVariable::SetEnergy_ResTruncError_Zero</a></div><div class="ttdeci">void SetEnergy_ResTruncError_Zero(unsigned long iPoint)</div><div class="ttdoc">Set the velocity of the truncation error to zero.</div><div class="ttdef"><b>Definition</b> <a href="CVariable_8hpp_source.html#l00686">CVariable.hpp:686</a></div></div>
<div class="ttc" id="aclassCVariable_html_a261483e39c23c1de7cb9aea7e917c121"><div class="ttname"><a href="classCVariable.html#a261483e39c23c1de7cb9aea7e917c121">CVariable::GetSolution</a></div><div class="ttdeci">su2double GetSolution(unsigned long iPoint, unsigned long iVar) const</div><div class="ttdoc">Get the solution.</div><div class="ttdef"><b>Definition</b> <a href="CVariable_8hpp_source.html#l00230">CVariable.hpp:230</a></div></div>
<div class="ttc" id="aclassCVariable_html_a2925893e2535d4b24f8f3e9c4339b8b2"><div class="ttname"><a href="classCVariable.html#a2925893e2535d4b24f8f3e9c4339b8b2">CVariable::GetPrimitive</a></div><div class="ttdeci">virtual const MatrixType &amp; GetPrimitive() const</div><div class="ttdoc">Get the primitive variables for all points.</div><div class="ttdef"><b>Definition</b> <a href="CVariable_8hpp_source.html#l01241">CVariable.hpp:1241</a></div></div>
<div class="ttc" id="aclassCVariable_html_a3215c20563e6d4bbeb4020d6161b48e5"><div class="ttname"><a href="classCVariable.html#a3215c20563e6d4bbeb4020d6161b48e5">CVariable::GetGradient</a></div><div class="ttdeci">CVectorOfMatrix &amp; GetGradient(void)</div><div class="ttdoc">Get the gradient of the entire solution.</div><div class="ttdef"><b>Definition</b> <a href="CVariable_8hpp_source.html#l00720">CVariable.hpp:720</a></div></div>
<div class="ttc" id="aclassCVariable_html_a4892ca545884011b7903a8e35c43b43f"><div class="ttname"><a href="classCVariable.html#a4892ca545884011b7903a8e35c43b43f">CVariable::GetDensity</a></div><div class="ttdeci">virtual su2double GetDensity(unsigned long iPoint) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition</b> <a href="CVariable_8hpp_source.html#l00931">CVariable.hpp:931</a></div></div>
<div class="ttc" id="aclassCVariable_html_a525636dad6b2064101677df44f274443"><div class="ttname"><a href="classCVariable.html#a525636dad6b2064101677df44f274443">CVariable::GetEnthalpy</a></div><div class="ttdeci">virtual su2double GetEnthalpy(unsigned long iPoint) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition</b> <a href="CVariable_8hpp_source.html#l00987">CVariable.hpp:987</a></div></div>
<div class="ttc" id="aclassCVariable_html_a6ee4d8d450971204cc054a33d6473732"><div class="ttname"><a href="classCVariable.html#a6ee4d8d450971204cc054a33d6473732">CVariable::SetSolution_Old</a></div><div class="ttdeci">void SetSolution_Old(unsigned long iPoint, const su2double *solution_old)</div><div class="ttdoc">Set the value of the old solution.</div><div class="ttdef"><b>Definition</b> <a href="CVariable_8hpp_source.html#l00245">CVariable.hpp:245</a></div></div>
<div class="ttc" id="aclassCVariable_html_a8b7f4e020a837b1fe639e8d875f964d5"><div class="ttname"><a href="classCVariable.html#a8b7f4e020a837b1fe639e8d875f964d5">CVariable::GetGradient_Primitive</a></div><div class="ttdeci">virtual su2double GetGradient_Primitive(unsigned long iPoint, unsigned long iVar, unsigned long iDim) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition</b> <a href="CVariable_8hpp_source.html#l01579">CVariable.hpp:1579</a></div></div>
<div class="ttc" id="aclassCVariable_html_ad08820234eeedeb13105e603af2c67ad"><div class="ttname"><a href="classCVariable.html#ad08820234eeedeb13105e603af2c67ad">CVariable::GetPressure</a></div><div class="ttdeci">virtual su2double GetPressure(unsigned long iPoint) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition</b> <a href="CVariable_8hpp_source.html#l00994">CVariable.hpp:994</a></div></div>
<div class="ttc" id="aclassCVariable_html_adae2e4228e113624b7ab1f9ab1a493c6"><div class="ttname"><a href="classCVariable.html#adae2e4228e113624b7ab1f9ab1a493c6">CVariable::GetEddyViscosity</a></div><div class="ttdeci">virtual su2double GetEddyViscosity(unsigned long iPoint) const</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition</b> <a href="CVariable_8hpp_source.html#l00980">CVariable.hpp:980</a></div></div>
<div class="ttc" id="aclassCVertex_html_a57cacfe764770e6c0e54c278cb584f7c"><div class="ttname"><a href="classCVertex.html#a57cacfe764770e6c0e54c278cb584f7c">CVertex::GetNormal</a></div><div class="ttdeci">void GetNormal(su2double *val_normal) const override</div><div class="ttdoc">Copy the the normal vector of a face.</div><div class="ttdef"><b>Definition</b> <a href="CVertex_8hpp_source.html#l00093">CVertex.hpp:93</a></div></div>
<div class="ttc" id="aclassCVertex_html_ab8b0e96f9384b0a861c7a70616976b75"><div class="ttname"><a href="classCVertex.html#ab8b0e96f9384b0a861c7a70616976b75">CVertex::GetNormal_Neighbor</a></div><div class="ttdeci">unsigned long GetNormal_Neighbor(void) const</div><div class="ttdoc">Get the value of the closest neighbor.</div><div class="ttdef"><b>Definition</b> <a href="CVertex_8hpp_source.html#l00321">CVertex.hpp:321</a></div></div>
<div class="ttc" id="aclassCVertex_html_ad568da06e7191358d3a09a1bee71cdb5"><div class="ttname"><a href="classCVertex.html#ad568da06e7191358d3a09a1bee71cdb5">CVertex::GetNode</a></div><div class="ttdeci">unsigned long GetNode() const</div><div class="ttdoc">Get the node of the vertex.</div><div class="ttdef"><b>Definition</b> <a href="CVertex_8hpp_source.html#l00069">CVertex.hpp:69</a></div></div>
<div class="ttc" id="acode__config_8hpp_html_a404145e25ce1ea18e25e884f125237e3"><div class="ttname"><a href="code__config_8hpp.html#a404145e25ce1ea18e25e884f125237e3">su2double</a></div><div class="ttdeci">double su2double</div><div class="ttdef"><b>Definition</b> <a href="code__config_8hpp_source.html#l00126">code_config.hpp:126</a></div></div>
<div class="ttc" id="agroup__GeometryToolbox_html_gad8b24e50333c9a8378f7abf18222f36a"><div class="ttname"><a href="group__GeometryToolbox.html#gad8b24e50333c9a8378f7abf18222f36a">GeometryToolbox::Norm</a></div><div class="ttdeci">T Norm(Int nDim, const T *a)</div><div class="ttdef"><b>Definition</b> <a href="geometry__toolbox_8hpp_source.html#l00078">geometry_toolbox.hpp:78</a></div></div>
<div class="ttc" id="agroup__SIMD_html_ga54a1925ab40fb4249ea255072520de35"><div class="ttname"><a href="group__SIMD.html#ga54a1925ab40fb4249ea255072520de35">sqrt</a></div><div class="ttdeci">FORCEINLINE ARRAY_T sqrt(const ARRAY_T &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="special__vectorization_8hpp_source.html#l00116">special_vectorization.hpp:116</a></div></div>
<div class="ttc" id="agroup__SIMD_html_ga768cbdeba8e4567257959378fba27f17"><div class="ttname"><a href="group__SIMD.html#ga768cbdeba8e4567257959378fba27f17">pow</a></div><div class="ttdeci">FORCEINLINE ARRAY_T pow(const ARRAY_T &amp;a, const ARRAY_T &amp;b)</div><div class="ttdef"><b>Definition</b> <a href="special__vectorization_8hpp_source.html#l00177">special_vectorization.hpp:177</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_a9b2b3fcdfe74a7a8b6d98a14d92a4b43"><div class="ttname"><a href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a></div><div class="ttdeci">#define MPI_UNSIGNED_LONG</div><div class="ttdef"><b>Definition</b> <a href="mpi__structure_8hpp_source.html#l00473">mpi_structure.hpp:473</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aa058ba472f0fd41ae860caeaebca0166"><div class="ttname"><a href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a></div><div class="ttdeci">#define MPI_SUM</div><div class="ttdef"><b>Definition</b> <a href="mpi__structure_8hpp_source.html#l00479">mpi_structure.hpp:479</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aafd1dc0086079e7904385538c54c9c8f"><div class="ttname"><a href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a></div><div class="ttdeci">#define MPI_DOUBLE</div><div class="ttdef"><b>Definition</b> <a href="mpi__structure_8hpp_source.html#l00477">mpi_structure.hpp:477</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a010c51bd37c27270292797ea1db8a942"><div class="ttname"><a href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a></div><div class="ttdeci">const int MASTER_NODE</div><div class="ttdoc">Master node for MPI parallelization.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l00111">option_structure.hpp:111</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89"><div class="ttname"><a href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a44b9890f7a050b3f77a39477eff4eb89">EULER_IMPLICIT</a></div><div class="ttdeci">@ EULER_IMPLICIT</div><div class="ttdoc">Implicit Euler time integration definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01439">option_structure.hpp:1439</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a1fe79b42ed6f64e83f679323332fd763"><div class="ttname"><a href="option__structure_8hpp.html#a1fe79b42ed6f64e83f679323332fd763">SOURCE_SECOND_TERM</a></div><div class="ttdeci">const int SOURCE_SECOND_TERM</div><div class="ttdoc">Position of the second source term in the numerics container array.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l00497">option_structure.hpp:497</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a43ea705e690ad6482423e483ddf04ed1"><div class="ttname"><a href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a></div><div class="ttdeci">const unsigned int MESH_0</div><div class="ttdoc">Definition of the finest grid level.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l00087">option_structure.hpp:87</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a44d6272fd9607cb31468949e83b21a1caf22389272c967284acc10130b9ce0e6c"><div class="ttname"><a href="option__structure_8hpp.html#a44d6272fd9607cb31468949e83b21a1caf22389272c967284acc10130b9ce0e6c">MAIN_SOLVER::ADJ_RANS</a></div><div class="ttdeci">@ ADJ_RANS</div><div class="ttdoc">Definition of the continuous adjoint Reynolds-averaged Navier-Stokes' (RANS) solver.</div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa006ea5367887f911cb8c5af544ccc55a">TOTAL_HEATFLUX</a></div><div class="ttdeci">@ TOTAL_HEATFLUX</div><div class="ttdoc">Total heat flux.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01910">option_structure.hpp:1910</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa2d1bc11eae99ce594d0a2281210e64d4"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa2d1bc11eae99ce594d0a2281210e64d4">SURFACE_MASSFLOW</a></div><div class="ttdeci">@ SURFACE_MASSFLOW</div><div class="ttdoc">Mass Flow Rate objective function definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01928">option_structure.hpp:1928</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa3a6f3ba01c50e7625df3b39055b237c9">MAXIMUM_HEATFLUX</a></div><div class="ttdeci">@ MAXIMUM_HEATFLUX</div><div class="ttdoc">Maximum heat flux.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01911">option_structure.hpp:1911</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa6dbcda3aa9205f9255ff777ea28510b1"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa6dbcda3aa9205f9255ff777ea28510b1">SIDEFORCE_COEFFICIENT</a></div><div class="ttdeci">@ SIDEFORCE_COEFFICIENT</div><div class="ttdoc">Side force objective function definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01906">option_structure.hpp:1906</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa74469d47da8b77e6328e3661964307d8"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa74469d47da8b77e6328e3661964307d8">LIFT_COEFFICIENT</a></div><div class="ttdeci">@ LIFT_COEFFICIENT</div><div class="ttdoc">Lift objective function definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01905">option_structure.hpp:1905</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa76dd32a2beed2a4f4524bb0519555cf7">INVERSE_DESIGN_HEATFLUX</a></div><div class="ttdeci">@ INVERSE_DESIGN_HEATFLUX</div><div class="ttdoc">Heat flux objective function definition (inverse design).</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01909">option_structure.hpp:1909</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa8f80a9cba152af34bddb134a95f70e67"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa8f80a9cba152af34bddb134a95f70e67">DRAG_COEFFICIENT</a></div><div class="ttdeci">@ DRAG_COEFFICIENT</div><div class="ttdoc">Drag objective function definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01904">option_structure.hpp:1904</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa986b33b640b206199e379e5a22fc2278"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa986b33b640b206199e379e5a22fc2278">NEARFIELD_PRESSURE</a></div><div class="ttdeci">@ NEARFIELD_PRESSURE</div><div class="ttdoc">NearField Pressure objective function definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01917">option_structure.hpp:1917</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aa996eee7e64825e2976ea751d9ef2c6c1"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aa996eee7e64825e2976ea751d9ef2c6c1">SURFACE_TOTAL_PRESSURE</a></div><div class="ttdeci">@ SURFACE_TOTAL_PRESSURE</div><div class="ttdoc">Total Pressure objective function definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01925">option_structure.hpp:1925</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aac8b258aaf52323223d470403a2ff10b0"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aac8b258aaf52323223d470403a2ff10b0">EQUIVALENT_AREA</a></div><div class="ttdeci">@ EQUIVALENT_AREA</div><div class="ttdoc">Equivalent area objective function definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01916">option_structure.hpp:1916</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a451d8d6bd6a84f670f76e9fc4e3dfe8aae0adda208c6e887373a12474a9e6d9e2"><div class="ttname"><a href="option__structure_8hpp.html#a451d8d6bd6a84f670f76e9fc4e3dfe8aae0adda208c6e887373a12474a9e6d9e2">SURFACE_STATIC_PRESSURE</a></div><div class="ttdeci">@ SURFACE_STATIC_PRESSURE</div><div class="ttdoc">Static Pressure objective function definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01926">option_structure.hpp:1926</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a6a09a5472a47da677853641e633f3abeab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="option__structure_8hpp.html#a6a09a5472a47da677853641e633f3abeab50339a10e1de285ac99d4c3990b8693">LIMITER::NONE</a></div><div class="ttdeci">@ NONE</div><div class="ttdoc">No limiter.</div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a6d78d8ad6e8f106b8e77781f0b431ca6"><div class="ttname"><a href="option__structure_8hpp.html#a6d78d8ad6e8f106b8e77781f0b431ca6">SOURCE_FIRST_TERM</a></div><div class="ttdeci">const int SOURCE_FIRST_TERM</div><div class="ttdoc">Position of the first source term in the numerics container array.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l00496">option_structure.hpp:496</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a88c999a2ce949a2b939c223ae1132480"><div class="ttname"><a href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a></div><div class="ttdeci">const su2double TWO3</div><div class="ttdoc">Two divided by three.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l00104">option_structure.hpp:104</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a8a925ac62604ec86956557ab2acfb3f9"><div class="ttname"><a href="option__structure_8hpp.html#a8a925ac62604ec86956557ab2acfb3f9">VISC_TERM</a></div><div class="ttdeci">const int VISC_TERM</div><div class="ttdoc">Position of the viscous terms in the numerics container array.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l00495">option_structure.hpp:495</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a8e54c1f9902bceca5a447c00f47dba85"><div class="ttname"><a href="option__structure_8hpp.html#a8e54c1f9902bceca5a447c00f47dba85">FOUR3</a></div><div class="ttdeci">const su2double FOUR3</div><div class="ttdoc">Four divided by three.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l00105">option_structure.hpp:105</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a98b1b0d541147aaee4b7100c8b0892e6a686cd34998b25d1929374643e062a074"><div class="ttname"><a href="option__structure_8hpp.html#a98b1b0d541147aaee4b7100c8b0892e6a686cd34998b25d1929374643e062a074">COMM_FULL</a></div><div class="ttdeci">@ COMM_FULL</div><div class="ttdoc">Perform all MPI communications.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l02509">option_structure.hpp:2508</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551"><div class="ttname"><a href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a92f0912350cd513b18e91a14cb86a551">FLOW_SOL</a></div><div class="ttdeci">@ FLOW_SOL</div><div class="ttdoc">Position of the mean flow solution in the solver container array.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l00476">option_structure.hpp:476</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287"><div class="ttname"><a href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0a93642bc5a217e0b200a6ce869d3f4287">TURB_SOL</a></div><div class="ttdeci">@ TURB_SOL</div><div class="ttdoc">Position of the turbulence model solution in the solver container array.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l00478">option_structure.hpp:478</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5"><div class="ttname"><a href="option__structure_8hpp.html#aa1864ace40c403efd231e7ad3a91e7e0ad7e6164629d786c8c0fdcf570abc22c5">ADJTURB_SOL</a></div><div class="ttdeci">@ ADJTURB_SOL</div><div class="ttdoc">Position of the continuous adjoint turbulence solution in the solver container array.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l00479">option_structure.hpp:479</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba2017081e4aa73a6aef6fdd6b3a380fbf"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba2017081e4aa73a6aef6fdd6b3a380fbf">FAR_FIELD</a></div><div class="ttdeci">@ FAR_FIELD</div><div class="ttdoc">Boundary far-field definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01544">option_structure.hpp:1544</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a></div><div class="ttdeci">@ ISOTHERMAL</div><div class="ttdoc">No slip isothermal wall boundary condition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01559">option_structure.hpp:1559</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba6dc1b159829aa7885fc905d3d81f28bd"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba6dc1b159829aa7885fc905d3d81f28bd">INLET_FLOW</a></div><div class="ttdeci">@ INLET_FLOW</div><div class="ttdoc">Boundary inlet flow definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01546">option_structure.hpp:1546</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba8e57aa6eae14b4e84e2ebd0be0d385fb"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba8e57aa6eae14b4e84e2ebd0be0d385fb">SUPERSONIC_INLET</a></div><div class="ttdeci">@ SUPERSONIC_INLET</div><div class="ttdoc">Boundary supersonic inlet definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01554">option_structure.hpp:1554</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba938badc8671d389b99bd9ae9eb6cfa73"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba938badc8671d389b99bd9ae9eb6cfa73">ENGINE_INFLOW</a></div><div class="ttdeci">@ ENGINE_INFLOW</div><div class="ttdoc">Boundary nacelle inflow.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01556">option_structure.hpp:1556</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a></div><div class="ttdeci">@ HEAT_FLUX</div><div class="ttdoc">No slip constant heat flux wall boundary condition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01560">option_structure.hpp:1560</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820bacaed259788fb153495d0901f31e529bf"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820bacaed259788fb153495d0901f31e529bf">SUPERSONIC_OUTLET</a></div><div class="ttdeci">@ SUPERSONIC_OUTLET</div><div class="ttdoc">Boundary supersonic inlet definition.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01555">option_structure.hpp:1555</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_adb5c3260b4674bf85aa558c7bff71772acadbfdd0081764bd8d24111dfa08a35f"><div class="ttname"><a href="option__structure_8hpp.html#adb5c3260b4674bf85aa558c7bff71772acadbfdd0081764bd8d24111dfa08a35f">CENTERED::JST</a></div><div class="ttdeci">@ JST</div><div class="ttdoc">Jameson-Smith-Turkel centered numerical method.</div></div>
<div class="ttc" id="aoption__structure_8hpp_html_adfbf8ea588ac42ebd8a665059e6ff5f8a0a57d2bc6d4da43c5fdb8c9293764d8d"><div class="ttname"><a href="option__structure_8hpp.html#adfbf8ea588ac42ebd8a665059e6ff5f8a0a57d2bc6d4da43c5fdb8c9293764d8d">SOLUTION</a></div><div class="ttdeci">@ SOLUTION</div><div class="ttdoc">Conservative solution communication.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l02475">option_structure.hpp:2475</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_af38c934f477044b7ceb0394ffd9b3ea4a06b4cd5e24ce8576f9329c2b5f75ba82"><div class="ttname"><a href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a06b4cd5e24ce8576f9329c2b5f75ba82">WEIGHTED_LEAST_SQUARES</a></div><div class="ttdeci">@ WEIGHTED_LEAST_SQUARES</div><div class="ttdoc">Gradients computation using inverse-distance weighted least squares.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01511">option_structure.hpp:1510</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_af38c934f477044b7ceb0394ffd9b3ea4a8e655dfdcc23cb033e14c30ff83f9df2"><div class="ttname"><a href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4a8e655dfdcc23cb033e14c30ff83f9df2">LEAST_SQUARES</a></div><div class="ttdeci">@ LEAST_SQUARES</div><div class="ttdoc">Gradient computation using unweighted least squares.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01509">option_structure.hpp:1509</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_af38c934f477044b7ceb0394ffd9b3ea4afda8790c8835b1a9827c006a31ea8465"><div class="ttname"><a href="option__structure_8hpp.html#af38c934f477044b7ceb0394ffd9b3ea4afda8790c8835b1a9827c006a31ea8465">GREEN_GAUSS</a></div><div class="ttdeci">@ GREEN_GAUSS</div><div class="ttdoc">Gradient computation using Green-Gauss theorem.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l01508">option_structure.hpp:1508</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa"><div class="ttname"><a href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a></div><div class="ttdeci">@ US</div><div class="ttdoc">Definition of incompressible solver.</div><div class="ttdef"><b>Definition</b> <a href="option__structure_8hpp_source.html#l00449">option_structure.hpp:448</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_6f9fd837e39f246a8f0c94f670ad0309.html">SU2_CFD</a></li><li class="navelem"><a class="el" href="dir_74ad77d76f42ded9212b1c5616a2ad50.html">src</a></li><li class="navelem"><a class="el" href="dir_320eb617c00a5dd44b94c6b6f4553ab7.html">solvers</a></li><li class="navelem"><a class="el" href="CAdjNSSolver_8cpp.html">CAdjNSSolver.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
