<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>My Project: /home/juan/DAAL/SU2/SU2-DAAL/SU2_CFD/src/solver_direct_mean_fem.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logoSU2_v3.3_small.jpeg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">My Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('solver__direct__mean__fem_8cpp_source.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">solver_direct_mean_fem.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="solver__direct__mean__fem_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;../include/solver_structure.hpp&quot;</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &quot;../include/data_manufactured_solutions.hpp&quot;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160; </div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="solver__direct__mean__fem_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">   35</a></span>&#160;<span class="preprocessor">#define SIZE_ARR_NORM 8</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160; </div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a456d88944ff65d3c05368245a573ecb7">   37</a></span>&#160;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a456d88944ff65d3c05368245a573ecb7">CFEM_DG_EulerSolver::CFEM_DG_EulerSolver</a>(<span class="keywordtype">void</span>) : <a class="code" href="class_c_solver.html">CSolver</a>() {</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="comment">/*--- Basic array initialization ---*/</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a> = NULL;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160; </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a069e21a1a7bb86994d97296c8be8482d">CSF_Inv</a> = NULL;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3490fa3bd85d5fade030b46f3d90fb51">CEff_Inv</a> = NULL;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a777496791f91315cc44fa3bf90237738">CMx_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4ed349d7fd826d372ce1fe6119bfc1">CMy_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CMz_Inv</a> = NULL;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFx_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFy_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9e7a08fa34a5d46b21a127c5e0535a98">CFz_Inv</a> = NULL;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <span class="comment">/*--- Surface-based array initialization ---*/</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">Surface_CSF_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac4a8cda93a2c52067378ab6b4a46f469">Surface_CEff_Inv</a> = NULL;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">Surface_CFx_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">Surface_CFy_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">Surface_CFz_Inv</a> = NULL;</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">Surface_CMx_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">Surface_CMy_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">Surface_CMz_Inv</a> = NULL;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2a26031c6fd9824899ecb92125207b60">Surface_CSF</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d84d5e44c469d17b9024f44a93bb2bc">Surface_CEff</a> = NULL;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3dde950e7512a05dc691db87cd8ca51f">Surface_CFx</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d7110b59eb940c5e354f2303946dcf2">Surface_CFy</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50202c322d1794f32fbfe7eff7617c25">Surface_CFz</a> = NULL;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa2b0fa39f8b4853f27c537e30681d2c7">Surface_CMx</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a417c1b82a8a8b76d049cd48a796f68f3">Surface_CMy</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">Surface_CMz</a> = NULL;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#add6a32199a4a6df9ade18f1c4fe325d1">Cauchy_Serie</a> = NULL;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160; </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  <span class="comment">/*--- Initialization of the boolean symmetrizingTermsPresent. ---*/</span></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160; </div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="comment">/*--- Initialize the variables for the monitoring data to avoid</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="comment">        possible valgrind warnings. ---*/</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a>   = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a>  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a92b0e3fa2d142ef6ed6c2ac4aafc9c04">Total_CSF</a> = 0.0;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a215f5d64c363a662ee0cb31cbd4f13a1">Total_CFx</a>  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6a9e78792a4e1dd0b5c27501105be895">Total_CFy</a> = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3d32ed98538d3d4c345dd9c3a7d74c28">Total_CFz</a> = 0.0;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af47adcfc34283af5e61df0a69374e912">Total_CMx</a>  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a54b44d56de430143b203dedb967e69d9">Total_CMy</a> = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7924707aed377b385c0cd7019ae1ef71">Total_CMz</a> = 0.0;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a973142a08d87ce2338d5c64f7f1e146b">Total_CEff</a> = 0.0;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="comment">/*--- Initialize the pointer for performing the BLAS functionalities. ---*/</span></div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a> = NULL;</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;}</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160; </div>
<div class="line"><a name="l00072"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a70d30ef9e7cd7620d54ec73f4b1ed28c">   72</a></span>&#160;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a456d88944ff65d3c05368245a573ecb7">CFEM_DG_EulerSolver::CFEM_DG_EulerSolver</a>(<a class="code" href="class_c_config.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> val_nDim, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh) : <a class="code" href="class_c_solver.html">CSolver</a>() {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="comment">/*--- Basic array initialization ---*/</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a> = NULL;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160; </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a069e21a1a7bb86994d97296c8be8482d">CSF_Inv</a> = NULL;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3490fa3bd85d5fade030b46f3d90fb51">CEff_Inv</a> = NULL;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a777496791f91315cc44fa3bf90237738">CMx_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4ed349d7fd826d372ce1fe6119bfc1">CMy_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CMz_Inv</a> = NULL;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFx_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFy_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9e7a08fa34a5d46b21a127c5e0535a98">CFz_Inv</a> = NULL;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <span class="comment">/*--- Surface-based array initialization ---*/</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">Surface_CSF_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac4a8cda93a2c52067378ab6b4a46f469">Surface_CEff_Inv</a> = NULL;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">Surface_CFx_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">Surface_CFy_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">Surface_CFz_Inv</a> = NULL;</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">Surface_CMx_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">Surface_CMy_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">Surface_CMz_Inv</a> = NULL;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160; </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2a26031c6fd9824899ecb92125207b60">Surface_CSF</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d84d5e44c469d17b9024f44a93bb2bc">Surface_CEff</a> = NULL;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3dde950e7512a05dc691db87cd8ca51f">Surface_CFx</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d7110b59eb940c5e354f2303946dcf2">Surface_CFy</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50202c322d1794f32fbfe7eff7617c25">Surface_CFz</a> = NULL;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa2b0fa39f8b4853f27c537e30681d2c7">Surface_CMx</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a417c1b82a8a8b76d049cd48a796f68f3">Surface_CMy</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">Surface_CMz</a> = NULL;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#add6a32199a4a6df9ade18f1c4fe325d1">Cauchy_Serie</a> = NULL;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="comment">/*--- Initialization of the boolean symmetrizingTermsPresent. ---*/</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <span class="comment">/*--- Dummy solver constructor that calls the SetNondim. routine in</span></div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">        order to load the flow non-dim. information into the config class.</span></div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">        This is needed to complete a partitioning for time-accurate local</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">        time stepping that depends on the flow state. ---*/</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> = val_nDim;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a> = config-&gt;<a class="code" href="class_c_config.html#a5f01bbbd9c331ecea38eebbe9cc9cd4e">GetGamma</a>();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a> = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a> - 1.0;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a31316dc2fe564329d9bb372961b10a3a">SetNondimensionalization</a>(config, iMesh, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="comment">/*--- Initialize the variables for the monitoring data to avoid</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">        possible valgrind warnings. ---*/</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a>   = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a>  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a92b0e3fa2d142ef6ed6c2ac4aafc9c04">Total_CSF</a> = 0.0;</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a215f5d64c363a662ee0cb31cbd4f13a1">Total_CFx</a>  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6a9e78792a4e1dd0b5c27501105be895">Total_CFy</a> = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3d32ed98538d3d4c345dd9c3a7d74c28">Total_CFz</a> = 0.0;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af47adcfc34283af5e61df0a69374e912">Total_CMx</a>  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a54b44d56de430143b203dedb967e69d9">Total_CMy</a> = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7924707aed377b385c0cd7019ae1ef71">Total_CMz</a> = 0.0;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a973142a08d87ce2338d5c64f7f1e146b">Total_CEff</a> = 0.0;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="comment">/*--- Initialize the pointer for performing the BLAS functionalities. ---*/</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a> = NULL;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;}</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a677fa998b78bd489a3f8bee0d56623dd">  116</a></span>&#160;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a456d88944ff65d3c05368245a573ecb7">CFEM_DG_EulerSolver::CFEM_DG_EulerSolver</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry, <a class="code" href="class_c_config.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh) : <a class="code" href="class_c_solver.html">CSolver</a>() {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160; </div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="comment">/*--- Array initialization ---*/</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a> = NULL;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a069e21a1a7bb86994d97296c8be8482d">CSF_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3490fa3bd85d5fade030b46f3d90fb51">CEff_Inv</a> = NULL;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a777496791f91315cc44fa3bf90237738">CMx_Inv</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4ed349d7fd826d372ce1fe6119bfc1">CMy_Inv</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CMz_Inv</a> = NULL;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFx_Inv</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFy_Inv</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9e7a08fa34a5d46b21a127c5e0535a98">CFz_Inv</a> = NULL;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160; </div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">Surface_CSF_Inv</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac4a8cda93a2c52067378ab6b4a46f469">Surface_CEff_Inv</a> = NULL;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">Surface_CFx_Inv</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">Surface_CFy_Inv</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">Surface_CFz_Inv</a> = NULL;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">Surface_CMx_Inv</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">Surface_CMy_Inv</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">Surface_CMz_Inv</a> = NULL;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160; </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2a26031c6fd9824899ecb92125207b60">Surface_CSF</a> = NULL; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d84d5e44c469d17b9024f44a93bb2bc">Surface_CEff</a> = NULL;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3dde950e7512a05dc691db87cd8ca51f">Surface_CFx</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d7110b59eb940c5e354f2303946dcf2">Surface_CFy</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50202c322d1794f32fbfe7eff7617c25">Surface_CFz</a> = NULL;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa2b0fa39f8b4853f27c537e30681d2c7">Surface_CMx</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a417c1b82a8a8b76d049cd48a796f68f3">Surface_CMy</a> = NULL;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">Surface_CMz</a> = NULL;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#add6a32199a4a6df9ade18f1c4fe325d1">Cauchy_Serie</a> = NULL;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="comment">/*--- Allocate the memory for blasFunctions. ---*/</span></div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a> = <span class="keyword">new</span> <a class="code" href="class_c_blas_structure.html">CBlasStructure</a>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="comment">/*--- Set the gamma value ---*/</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a> = config-&gt;<a class="code" href="class_c_config.html#a5f01bbbd9c331ecea38eebbe9cc9cd4e">GetGamma</a>();</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a> = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a> - 1.0;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="comment">/*--- Define geometry constants in the solver structure. ---*/</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>    = geometry-&gt;<a class="code" href="class_c_geometry.html#a2af01006c0c4f74ba089582f1a3587fe">GetnDim</a>();</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a> = config-&gt;<a class="code" href="class_c_config.html#a300c4884edfc0c2acf395036439004f4">GetnMarker_All</a>();</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160; </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> compressible = (config-&gt;<a class="code" href="class_c_config.html#a66ca7e620390a81cd49cd0a00716128e">GetKind_Regime</a>() == <a class="code" href="option__structure_8hpp.html#a3d92e0a004752d2ef55cf6c1e2e3d6f0a20621ea72bb142dc0c8bf116a257516a">COMPRESSIBLE</a>);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <span class="keywordflow">if</span>( compressible ) <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a> = <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> + 2;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;  <span class="keywordflow">else</span>               <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a> = <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> + 1;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  <span class="comment">/*--- Create an object of the class CMeshFEM_DG and retrieve the necessary</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">        geometrical information for the FEM DG solver. ---*/</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="class_c_mesh_f_e_m___d_g.html">CMeshFEM_DG</a> *DGGeometry = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="class_c_mesh_f_e_m___d_g.html">CMeshFEM_DG</a> *<span class="keyword">&gt;</span>(geometry);</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9d920892529ca8e2f5060f4c95238df4">nVolElemTot</a>   = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#af06ca9410fb198794145e8e58fb56f44">GetNVolElemTot</a>();</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a> = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a665c7319b3d55a66ba83cd074b35f9a5">GetNVolElemOwned</a>();</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>       = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a838a7b4f4ad6edcf019a90113a09b290">GetVolElem</a>();</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>    = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#aeb53bd5673788fa54b2b5cb8f9e4351c">GetNVolElemOwnedPerTimeLevel</a>();</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7f54ebf747f54031baaa79339ff5503f">nVolElemInternalPerTimeLevel</a> = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a6577c4980bf903b48255719c1c0a06cb">GetNVolElemInternalPerTimeLevel</a>();</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>     = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a2ce361abdf78606a7c979200d0651cd4">GetNVolElemHaloPerTimeLevel</a>();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad1f55a7f9d7d977e9dbae3182131673f">ownedElemAdjLowTimeLevel</a> = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a6362ff203ba22102290ef749df8dc2ae">GetOwnedElemAdjLowTimeLevel</a>();</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4856180300943d0a34620292be9fb44c">haloElemAdjLowTimeLevel</a>  = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a3c91aa9efae12fe6b85d8ff80d5bbd29">GetHaloElemAdjLowTimeLevel</a>();</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afa04dc04f2f6aece10303e9aab1ccc1e">nMeshPoints</a> = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a2e7a02df420fb13f650e4873d2f133fb">GetNMeshPoints</a>();</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0540afa5ec869952098d67fed71432f8">meshPoints</a>  = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#abe0901934ae02df89c88d001a92c1e36">GetMeshPoints</a>();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160; </div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a> = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m___d_g.html#a3939eb809d5977e54e14bfa30e9bf7b2">GetNMatchingFacesWithHaloElem</a>();</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a275680d0b201cfb25fdaaeb9c2ca1d22">nMatchingInternalFacesLocalElem</a>    = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m___d_g.html#a615c4d6a9dd427b88692efa390bc56e0">GetNMatchingFacesInternal</a>();</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>              = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m___d_g.html#a543cd1533ba1dd5b7c976765047cf62a">GetMatchingFaces</a>();</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a> = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#ab056ee4e0e2283a391d35c5412406c1d">GetBoundaries</a>();</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8f73c23ba58699a103874a6c8f7cebb6">nStandardBoundaryFacesSol</a> = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#ad609c4e6db76df210be7140bace02120">GetNStandardBoundaryFacesSol</a>();</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac870835423bcf03b2c005d21c4056100">nStandardElementsSol</a>      = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m___d_g.html#a28f901b586c3e81f6a172a9489df2541">GetNStandardElementsSol</a>();</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a78f3b044c00751d3995e326b7a824048">nStandardMatchingFacesSol</a> = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m___d_g.html#a849f86fec4a59548e161ff5309c73a3b">GetNStandardMatchingFacesSol</a>();</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a> = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#ad52714f971aaaa67a26012d286f51090">GetStandardBoundaryFacesSol</a>();</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>      = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m___d_g.html#a54499dba9b28c04afe4fde40692e13b6">GetStandardElementsSol</a>();</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a> = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m___d_g.html#a3e70f3ccf8c20e6a134b65ddbd0db793">GetStandardMatchingFacesSol</a>();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a353efc3b5e3478ca75ba6cb27acab9bb">timeCoefADER_DG</a>                        = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m___d_g.html#a2703c77a006ce3188d76cbdf351ca373">GetTimeCoefADER_DG</a>();</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a12a7b04efdba0f2488dc786a1261f1b0">timeInterpolDOFToIntegrationADER_DG</a>    = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m___d_g.html#a5cb43fb02147615d3bbd7d89fccc1437">GetTimeInterpolDOFToIntegrationADER_DG</a>();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a47bc2e588fd015b5b565e5b5263cf423">timeInterpolAdjDOFToIntegrationADER_DG</a> = DGGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m___d_g.html#a76e74c45b81fabf7dd4d67b7f9f8cfcf">GetTimeInterpolAdjDOFToIntegrationADER_DG</a>();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160; </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  <span class="comment">/*--- Determine the maximum number of integration points used. Usually this</span></div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment">        is for the volume integral, but to avoid problems the faces are also</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment">        taken into account.  ---*/</span></div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nIntegrationMax = 0;</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8f73c23ba58699a103874a6c8f7cebb6">nStandardBoundaryFacesSol</a>; ++i) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[i].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    nIntegrationMax = max(nIntegrationMax, nInt);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160; </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac870835423bcf03b2c005d21c4056100">nStandardElementsSol</a>; ++i) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[i].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    nIntegrationMax = max(nIntegrationMax, nInt);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  }</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160; </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a78f3b044c00751d3995e326b7a824048">nStandardMatchingFacesSol</a>; ++i) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[i].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    nIntegrationMax = max(nIntegrationMax, nInt);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="comment">/*--- Determine the maximum number of DOFs used. This is for the volume elements.</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;<span class="comment">        Note that also the element adjacent to side 1 of the matching faces must</span></div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="comment">        be taken into account, because this could be an external element. */</span></div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsMax = 0;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac870835423bcf03b2c005d21c4056100">nStandardElementsSol</a>; ++i) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[i].<a class="code" href="class_c_f_e_m_standard_element.html#a8610f2db30d0c53bc46b9513d492d46b">GetNDOFs</a>();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    nDOFsMax = max(nDOFsMax, nDOFs);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160; </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a78f3b044c00751d3995e326b7a824048">nStandardMatchingFacesSol</a>; ++i) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[i].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a043294eff88a9374a936fefaca0ea860">GetNDOFsElemSide1</a>();</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    nDOFsMax = max(nDOFsMax, nDOFs);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;  }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <span class="comment">/*--- Determine the size of the work array. ---*/</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadGemm = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="class_c_config.html#a2e9af0bd3e1f5ed865e81b627e94a662">GetViscous</a>() ) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="comment">/* Viscous simulation. */</span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeFluxes = nIntegrationMax*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    sizeFluxes = nPadGemm*max(sizeFluxes, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) nDOFsMax);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeGradSolInt = nIntegrationMax*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*max(nPadGemm,nDOFsMax);</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a95cef33ccbfa61def433d11ddef5745d">sizeWorkArray</a> = nIntegrationMax*(4 + 3*nPadGemm) + sizeFluxes + sizeGradSolInt</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                  + max(nIntegrationMax,nDOFsMax)*nPadGemm + nPadGemm*nDOFsMax;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160; </div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">/* Inviscid simulation. */</span></div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeVol = nPadGemm*nIntegrationMax*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+2) + nPadGemm*nDOFsMax;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeSur = nPadGemm*(2*nIntegrationMax + max(nIntegrationMax,nDOFsMax));</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a95cef33ccbfa61def433d11ddef5745d">sizeWorkArray</a> = max(sizeVol, sizeSur);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">GetKind_TimeIntScheme_Flow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a>) {</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    <span class="comment">/*--- ADER-DG scheme. Determine the size needed for the predictor step</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;<span class="comment">          and make sure that sizeWorkArray is big enough. This size depends</span></div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;<span class="comment">          whether an aliased or a non-aliased predictor step is used. Note</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;<span class="comment">          that the size estimates are for viscous computations. ---*/</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeDOFs = config-&gt;<a class="code" href="class_c_config.html#ab110ba67babf383e40ac4896bc65a599">GetnTimeDOFsADER_DG</a>();</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizePredictorADER = 4*nPadGemm*nDOFsMax*nTimeDOFs</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                   +   nPadGemm*nDOFsMax;</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160; </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;    <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a6a283ba2b1eacb99905f0e12636c8e15">GetKind_ADER_Predictor</a>() == <a class="code" href="option__structure_8hpp.html#a2a786c02917df4dda5cf6c49e01794fea5fa3210aba4e29bca6294a071fdf8086">ADER_ALIASED_PREDICTOR</a>)</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;      sizePredictorADER += <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*nPadGemm*nDOFsMax + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*nPadGemm*nIntegrationMax;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;      sizePredictorADER += (<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1)*nPadGemm*max(nIntegrationMax, nDOFsMax)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                         + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*nPadGemm*max(nIntegrationMax,nDOFsMax);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a95cef33ccbfa61def433d11ddef5745d">sizeWorkArray</a> = max(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a95cef33ccbfa61def433d11ddef5745d">sizeWorkArray</a>, sizePredictorADER);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  }</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <span class="comment">/*--- Perform the non-dimensionalization for the flow equations using the</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;<span class="comment">        specified reference values. ---*/</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a31316dc2fe564329d9bb372961b10a3a">SetNondimensionalization</a>(config, iMesh, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <span class="comment">/*--- Define some auxiliary vectors related to the residual ---*/</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <a class="code" href="class_c_solver.html#a2eefc28ecb9b38a0776fc4f95efdb8ed">Residual_RMS</a> = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) <a class="code" href="class_c_solver.html#a2eefc28ecb9b38a0776fc4f95efdb8ed">Residual_RMS</a>[iVar] = 1.e-35;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="class_c_solver.html#a7fa2598a504eef695b0ae88db95b5c4b">Residual_Max</a> = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) <a class="code" href="class_c_solver.html#a7fa2598a504eef695b0ae88db95b5c4b">Residual_Max</a>[iVar] = 1.e-35;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="class_c_solver.html#a75322711ff68e7268b0ef7b0cf03906f">Point_Max</a>    = <span class="keyword">new</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>]; <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) <a class="code" href="class_c_solver.html#a75322711ff68e7268b0ef7b0cf03906f">Point_Max</a>[iVar]    = 0;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;  <a class="code" href="class_c_solver.html#a63d2dfa86c11b820cd97620eac163a49">Point_Max_Coord</a> = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>*[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="class_c_solver.html#a63d2dfa86c11b820cd97620eac163a49">Point_Max_Coord</a>[iVar] = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) <a class="code" href="class_c_solver.html#a63d2dfa86c11b820cd97620eac163a49">Point_Max_Coord</a>[iVar][iDim] = 0.0;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">/*--- Non-dimensional coefficients ---*/</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a>   = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a>   = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a069e21a1a7bb86994d97296c8be8482d">CSF_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a777496791f91315cc44fa3bf90237738">CMx_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4ed349d7fd826d372ce1fe6119bfc1">CMy_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CMz_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3490fa3bd85d5fade030b46f3d90fb51">CEff_Inv</a> = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFx_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFy_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9e7a08fa34a5d46b21a127c5e0535a98">CFz_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a>   = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a>   = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">Surface_CSF_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac4a8cda93a2c52067378ab6b4a46f469">Surface_CEff_Inv</a> = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">Surface_CFx_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">Surface_CFy_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">Surface_CFz_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">Surface_CMx_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">Surface_CMy_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">Surface_CMz_Inv</a>  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a>       = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a>       = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2a26031c6fd9824899ecb92125207b60">Surface_CSF</a>      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d84d5e44c469d17b9024f44a93bb2bc">Surface_CEff</a>     = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3dde950e7512a05dc691db87cd8ca51f">Surface_CFx</a>      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d7110b59eb940c5e354f2303946dcf2">Surface_CFy</a>      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50202c322d1794f32fbfe7eff7617c25">Surface_CFz</a>      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa2b0fa39f8b4853f27c537e30681d2c7">Surface_CMx</a>      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a417c1b82a8a8b76d049cd48a796f68f3">Surface_CMy</a>      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">Surface_CMz</a>      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">/*--- Init total coefficients ---*/</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a>   = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a>  = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a92b0e3fa2d142ef6ed6c2ac4aafc9c04">Total_CSF</a> = 0.0;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af47adcfc34283af5e61df0a69374e912">Total_CMx</a>  = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a54b44d56de430143b203dedb967e69d9">Total_CMy</a> = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7924707aed377b385c0cd7019ae1ef71">Total_CMz</a> = 0.0;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a215f5d64c363a662ee0cb31cbd4f13a1">Total_CFx</a>  = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6a9e78792a4e1dd0b5c27501105be895">Total_CFy</a> = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3d32ed98538d3d4c345dd9c3a7d74c28">Total_CFz</a> = 0.0;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a973142a08d87ce2338d5c64f7f1e146b">Total_CEff</a> = 0.0;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160; </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">/*--- Read farfield conditions ---*/</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa9c51b1803e120b62903c76d666f7dc2">Density_Inf</a>     = config-&gt;<a class="code" href="class_c_config.html#acc0e8477d26aab6003845d62cb43b0fa">GetDensity_FreeStreamND</a>();</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a28853952a2d55f77b1826b10c5e608b5">Pressure_Inf</a>    = config-&gt;<a class="code" href="class_c_config.html#a59c43ad0ef9a59bc51c2a7e399fea004">GetPressure_FreeStreamND</a>();</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abb32d1dea64bec72ee273f0ceff0da6a">Velocity_Inf</a>    = config-&gt;<a class="code" href="class_c_config.html#a13840ca712bf87d32d18917d0c39cfae">GetVelocity_FreeStreamND</a>();</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a412f5e00b438248a33f3f95ec8115fd4">Energy_Inf</a>      = config-&gt;<a class="code" href="class_c_config.html#a10a3691153903d82aecc25cadcc03917">GetEnergy_FreeStreamND</a>();</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a1f8fc98a188469be0d59e9053457bcaf">Temperature_Inf</a> = config-&gt;<a class="code" href="class_c_config.html#a00454cff9575acd21239959b4030b192">GetTemperature_FreeStreamND</a>();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e0a2262626fecae2af8958d3de6fb75">Mach_Inf</a>        = config-&gt;<a class="code" href="class_c_config.html#a624138f0bb5ee7494459b8e25c5d6287">GetMach</a>();</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="comment">/*--- Set the conservative variables of the free-stream. ---*/</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>.resize(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  <span class="keywordflow">if</span>( compressible ) {</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[0] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa9c51b1803e120b62903c76d666f7dc2">Density_Inf</a>;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[iDim+1] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa9c51b1803e120b62903c76d666f7dc2">Density_Inf</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abb32d1dea64bec72ee273f0ceff0da6a">Velocity_Inf</a>[iDim];</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa9c51b1803e120b62903c76d666f7dc2">Density_Inf</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a412f5e00b438248a33f3f95ec8115fd4">Energy_Inf</a>;</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  }</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[0] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a28853952a2d55f77b1826b10c5e608b5">Pressure_Inf</a>;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[iDim+1] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa9c51b1803e120b62903c76d666f7dc2">Density_Inf</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abb32d1dea64bec72ee273f0ceff0da6a">Velocity_Inf</a>[iDim];</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  }</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="comment">/*--- Determine the total number of DOFs stored on this rank and allocate the memory</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;<span class="comment">        to store the conservative variables. ---*/</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a> = 0;</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++i) <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a> += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].nDOFsSol;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a> = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>;</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9d920892529ca8e2f5060f4c95238df4">nVolElemTot</a>; ++i) <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a> += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].nDOFsSol;</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160; </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.resize(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="comment">/*--- Allocate the memory for the working vectors for the solution variables</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;<span class="comment">        for all the time levels used. ---*/</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeLevels = config-&gt;<a class="code" href="class_c_config.html#a957e791919e7c6947131c06aedc7ff8d">GetnLevels_TimeAccurateLTS</a>();</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>.resize(nTimeLevels);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160; </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  vector&lt;unsigned long&gt; nDOFsTimeLevels(nTimeLevels, 0);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9d920892529ca8e2f5060f4c95238df4">nVolElemTot</a>; ++i) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    nDOFsTimeLevels[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>] += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].offsetDOFsSolPrevTimeLevel != ULONG_MAX)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;      nDOFsTimeLevels[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>-1] += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nTimeLevels; ++i)</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[i].resize(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*nDOFsTimeLevels[i]);</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">/*--- Check for the ADER-DG time integration scheme and allocate the memory</span></div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;<span class="comment">        for the additional vectors. ---*/</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">GetKind_TimeIntScheme_Flow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a>) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeDOFs = config-&gt;<a class="code" href="class_c_config.html#ab110ba67babf383e40ac4896bc65a599">GetnTimeDOFsADER_DG</a>();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">VecTotResDOFsADER</a>.assign(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>, 0.0);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a98849e262d69140a6a2d222d1a33de00">VecSolDOFsPredictorADER</a>.resize(nTimeDOFs*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  }</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <span class="comment">/*--- Runge Kutta type of time integration schemes. Allocate the memory to</span></div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;<span class="comment">          possibly store the new solution. ---*/</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">GetKind_TimeIntScheme_Flow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a6b39c56a74e0c2bbb104a17be7aaf269">CLASSICAL_RK4_EXPLICIT</a>)</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a492db7771aa00ca8a1b154931b7dd0ef">VecSolDOFsNew</a>.resize(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  }</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160; </div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;  <span class="comment">/*--- Determine the global number of DOFs. ---*/</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(&amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>, &amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a34748ca6005136ee4ac1028624e7530c">nDOFsGlobal</a>, 1, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a34748ca6005136ee4ac1028624e7530c">nDOFsGlobal</a> = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>;</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">/*--- Store the number of DOFs in the geometry class in case of restart. ---*/</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  geometry-&gt;<a class="code" href="class_c_geometry.html#afa2a7a03d8fd185ef68e922008008187">SetnPointDomain</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  geometry-&gt;<a class="code" href="class_c_geometry.html#aa9837fdad77772142c8f43cf9d6d958c">SetGlobal_nPointDomain</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a34748ca6005136ee4ac1028624e7530c">nDOFsGlobal</a>);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  <span class="comment">/*--- Allocate the memory to store the time steps, residuals, etc. ---*/</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>.resize(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160; </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">GetKind_TimeIntScheme_Flow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a>)</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.resize(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.resize(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160; </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>.assign(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>+1, 0);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>.assign(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>+1, 0);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8d2f8c9a6a10df61413ba7a206a034da">startLocResFacesMarkers</a>.resize(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af49be394a337648305708ce9d970d81a">startLocResInternalFacesLocalElem</a>.assign(nTimeLevels+1, 0);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a56c65d7a358c016a7bb58dfcfc3999d7">startLocResInternalFacesWithHaloElem</a>.assign(nTimeLevels+1, 0);</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160; </div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;  <span class="comment">/*--- Determine the size of the vector to store residuals that come from the</span></div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;<span class="comment">        integral over the faces and determine the number of entries in this</span></div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="comment">        vector for the local DOFs. ---*/</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a2e9af0bd3e1f5ed865e81b627e94a662">GetViscous</a>() &amp;&amp; (fabs(config-&gt;<a class="code" href="class_c_config.html#aebb368493e43eb306cf65de037c2e9bc">GetTheta_Interior_Penalty_DGFEM</a>()) &gt; 1.e-8))</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  <span class="comment">/*--- First the internal matching faces. ---*/</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> sizeVecResFaces = 0;</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[nTimeLevels]; ++i) {</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <span class="comment">/* Determine the time level of the face. */</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elem0     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elem1     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = min(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].timeLevel,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                         <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].timeLevel);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">/* The terms that only contribute to the DOFs located on the face.</span></div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="comment">       Check the time level of the element compared to the face. */</span></div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#a6bd23e7c338057fe4aa5bed22b284323">indStandardElement</a>;</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#acd4208ae47226c5917479d6a232b7584">GetNDOFsFaceSide0</a>();</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a0e3ff97b8c11ca92ede562565eec7041">GetNDOFsFaceSide1</a>();</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160; </div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    sizeVecResFaces += nDOFsFace0;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="keywordflow">if</span>(timeLevel == <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].timeLevel) {</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsFace0; ++j)</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        ++<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].DOFsSolFaceSide0[j]+1];</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsFace0; ++j)</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        ++<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].DOFsSolFaceSide0[j]+1];</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    sizeVecResFaces += nDOFsFace1;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span>(timeLevel == <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].timeLevel) {</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsFace1; ++j)</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        ++<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].DOFsSolFaceSide1[j]+1];</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsFace1; ++j)</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        ++<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].DOFsSolFaceSide1[j]+1];</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    }</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160; </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="comment">/* The symmetrizing terms, if present, contribute to all</span></div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="comment">       the DOFs of the adjacent elements. */</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a0719e8b18410e4720f58449ac28e8c38">GetNDOFsElemSide0</a>();</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a043294eff88a9374a936fefaca0ea860">GetNDOFsElemSide1</a>();</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160; </div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      sizeVecResFaces += nDOFsElem0;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <span class="keywordflow">if</span>(timeLevel == <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].timeLevel) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsElem0; ++j)</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          ++<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].DOFsSolElementSide0[j]+1];</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsElem0; ++j)</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          ++<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].DOFsSolElementSide0[j]+1];</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      sizeVecResFaces += nDOFsElem1;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      <span class="keywordflow">if</span>(timeLevel == <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].timeLevel) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsElem1; ++j)</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;          ++<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].DOFsSolElementSide1[j]+1];</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsElem1; ++j)</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;          ++<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].DOFsSolElementSide1[j]+1];</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;      }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">/* Store the position of the residual in the appropriate entry. */</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="keywordflow">if</span>(i &lt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[0] )</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af49be394a337648305708ce9d970d81a">startLocResInternalFacesLocalElem</a>[timeLevel+1] = sizeVecResFaces;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a56c65d7a358c016a7bb58dfcfc3999d7">startLocResInternalFacesWithHaloElem</a>[timeLevel+1] = sizeVecResFaces;</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;  }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160; </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;  <span class="comment">/* Set the uninitialized values of startLocResInternalFacesLocalElem. */</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=1; i&lt;=nTimeLevels; ++i) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af49be394a337648305708ce9d970d81a">startLocResInternalFacesLocalElem</a>[i] == 0)</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af49be394a337648305708ce9d970d81a">startLocResInternalFacesLocalElem</a>[i] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af49be394a337648305708ce9d970d81a">startLocResInternalFacesLocalElem</a>[i-1];</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;  }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160; </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  <span class="comment">/* Set the uninitialized values of startLocResInternalFacesWithHaloElem. */</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a56c65d7a358c016a7bb58dfcfc3999d7">startLocResInternalFacesWithHaloElem</a>[0] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af49be394a337648305708ce9d970d81a">startLocResInternalFacesLocalElem</a>[nTimeLevels];</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160; </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=1; i&lt;=nTimeLevels; ++i) {</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a56c65d7a358c016a7bb58dfcfc3999d7">startLocResInternalFacesWithHaloElem</a>[i] == 0)</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a56c65d7a358c016a7bb58dfcfc3999d7">startLocResInternalFacesWithHaloElem</a>[i] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a56c65d7a358c016a7bb58dfcfc3999d7">startLocResInternalFacesWithHaloElem</a>[i-1];</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;  }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;  <span class="comment">/* The physical boundary faces. Exclude the periodic boundaries,</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;<span class="comment">     because these are not physical boundaries. */</span></div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker=0; iMarker&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>; ++iMarker) {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8d2f8c9a6a10df61413ba7a206a034da">startLocResFacesMarkers</a>[iMarker].assign(nTimeLevels+1, 0);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8d2f8c9a6a10df61413ba7a206a034da">startLocResFacesMarkers</a>[iMarker][0] = sizeVecResFaces;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <span class="keywordflow">if</span>( !(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].periodicBoundary) ) {</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;      <span class="comment">/* Easier storage of the variables for this boundary. */</span></div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      nSurfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.size();</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;      <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.data();</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160; </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;      <span class="comment">/*--- Loop over the surface elements and update the required data. ---*/</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;nSurfElem; ++i) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind       = surfElem[i].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a26266f4d68d95c22bbb949fe6d8f5db6">GetNDOFsFace</a>();</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160; </div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="comment">/* The terms that only contribute to the DOFs located on the face. */</span></div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        sizeVecResFaces += nDOFsFace;</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsFace; ++j)</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;          ++<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[surfElem[i].DOFsSolFace[j]+1];</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="comment">/* The symmetrizing terms, if present, contribute to all</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">           the DOFs of the adjacent elements. */</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#aad6afe2fa8d35697a57dfc22a7542176">GetNDOFsElem</a>();</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;          sizeVecResFaces += nDOFsElem;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsElem; ++j)</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            ++<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[surfElem[i].DOFsSolElement[j]+1];</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;        <span class="comment">/* Determine the time level of the adjacent element and store the position of the</span></div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="comment">           residual in the appropriate entry. */</span></div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[surfElem[i].<a class="code" href="class_c_surface_element_f_e_m.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8d2f8c9a6a10df61413ba7a206a034da">startLocResFacesMarkers</a>[iMarker][timeLevel+1] = sizeVecResFaces;</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;      }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;    }</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="comment">/* Set the unitialized values of startLocResFacesMarkers[iMarker]. */</span></div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=1; i&lt;=nTimeLevels; ++i) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8d2f8c9a6a10df61413ba7a206a034da">startLocResFacesMarkers</a>[iMarker][i] == 0)</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8d2f8c9a6a10df61413ba7a206a034da">startLocResFacesMarkers</a>[iMarker][i] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8d2f8c9a6a10df61413ba7a206a034da">startLocResFacesMarkers</a>[iMarker][i-1];</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    }</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">/*--- Put nEntriesResFaces and nEntriesResAdjFaces in cumulative storage</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;<span class="comment">        format and allocate the memory for entriesResFaces, entriesResAdjFaces</span></div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;<span class="comment">        and VecResFaces. ---*/</span></div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>; ++i) {</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[i+1]    += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[i];</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>[i+1] += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>[i];</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;  }</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160; </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a85ca865434583283c6fa8da85f635b74">entriesResFaces</a>.resize(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>]);</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a114589ab188875a99b7879c4099eb757">entriesResAdjFaces</a>.resize(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>]);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.resize(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*sizeVecResFaces);</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;  <span class="comment">/*--- Repeat the loops over the internal and boundary faces, but now store</span></div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;<span class="comment">        the entries in entriesResFaces and entriesResAdjFaces. A counter</span></div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">        variable is needed to keep track of the appropriate location in</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;<span class="comment">        entriesResFaces and entriesResAdjFaces. ---*/</span></div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;  vector&lt;unsigned long&gt; counterEntries    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  vector&lt;unsigned long&gt; counterEntriesAdj = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="comment">/* First the loop over the internal matching faces. */</span></div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;  sizeVecResFaces = 0;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[nTimeLevels]; ++i) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160; </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">/* Determine the time level of the face. */</span></div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elem0     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elem1     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = min(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].timeLevel,</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                                         <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].timeLevel);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160; </div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="comment">/* The terms that only contribute to the DOFs located on the face. */</span></div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#a6bd23e7c338057fe4aa5bed22b284323">indStandardElement</a>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#acd4208ae47226c5917479d6a232b7584">GetNDOFsFaceSide0</a>();</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a0e3ff97b8c11ca92ede562565eec7041">GetNDOFsFaceSide1</a>();</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    <span class="keywordflow">if</span>(timeLevel == <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].timeLevel) {</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsFace0; ++j) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = counterEntries[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#af43fe79ecbba91bb155dc13f7dfa8140">DOFsSolFaceSide0</a>[j]]++;</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a85ca865434583283c6fa8da85f635b74">entriesResFaces</a>[jj]    = sizeVecResFaces++;</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    }</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsFace0; ++j) {</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = counterEntriesAdj[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#af43fe79ecbba91bb155dc13f7dfa8140">DOFsSolFaceSide0</a>[j]]++;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a114589ab188875a99b7879c4099eb757">entriesResAdjFaces</a>[jj] = sizeVecResFaces++;</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      }</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    }</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">if</span>(timeLevel == <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].timeLevel) {</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsFace1; ++j) {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = counterEntries[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#ab2262d6fc255298ba8ac9f9c0685173c">DOFsSolFaceSide1</a>[j]]++;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a85ca865434583283c6fa8da85f635b74">entriesResFaces</a>[jj]    = sizeVecResFaces++;</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      }</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    }</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsFace1; ++j) {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = counterEntriesAdj[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#ab2262d6fc255298ba8ac9f9c0685173c">DOFsSolFaceSide1</a>[j]]++;</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a114589ab188875a99b7879c4099eb757">entriesResAdjFaces</a>[jj] = sizeVecResFaces++;</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      }</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    }</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160; </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <span class="comment">/* The symmetrizing terms, if present, contribute to all</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;<span class="comment">       the DOFs of the adjacent elements. */</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a0719e8b18410e4720f58449ac28e8c38">GetNDOFsElemSide0</a>();</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a043294eff88a9374a936fefaca0ea860">GetNDOFsElemSide1</a>();</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;      <span class="keywordflow">if</span>(timeLevel == <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].timeLevel) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsElem0; ++j) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = counterEntries[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#aaf7209a1e287371117f9e525f6aae3e6">DOFsSolElementSide0</a>[j]]++;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a85ca865434583283c6fa8da85f635b74">entriesResFaces</a>[jj]    = sizeVecResFaces++;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;      }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsElem0; ++j) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = counterEntriesAdj[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#aaf7209a1e287371117f9e525f6aae3e6">DOFsSolElementSide0</a>[j]]++;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a114589ab188875a99b7879c4099eb757">entriesResAdjFaces</a>[jj] = sizeVecResFaces++;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;        }</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      }</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160; </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;      <span class="keywordflow">if</span>(timeLevel == <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].timeLevel) {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsElem1; ++j) {</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = counterEntries[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#ab6c86e670d9d1ae338a04795a5638b1f">DOFsSolElementSide1</a>[j]]++;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a85ca865434583283c6fa8da85f635b74">entriesResFaces</a>[jj]    = sizeVecResFaces++;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        }</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      }</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsElem1; ++j) {</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = counterEntriesAdj[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#ab6c86e670d9d1ae338a04795a5638b1f">DOFsSolElementSide1</a>[j]]++;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a114589ab188875a99b7879c4099eb757">entriesResAdjFaces</a>[jj] = sizeVecResFaces++;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        }</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      }</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    }</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;  }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;  <span class="comment">/* And the physical boundary faces. Exclude the periodic boundaries,</span></div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;<span class="comment">     because these are not physical boundaries. */</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker=0; iMarker&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>; ++iMarker) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;    <span class="keywordflow">if</span>( !(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].periodicBoundary) ) {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      <span class="comment">/* Easier storage of the variables for this boundary. */</span></div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      nSurfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.size();</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.data();</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160; </div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="comment">/*--- Loop over the surface elements to set entriesResFaces. ---*/</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;nSurfElem; ++i) {</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160; </div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="comment">/* The terms that only contribute to the DOFs located on the face. */</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind       = surfElem[i].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a26266f4d68d95c22bbb949fe6d8f5db6">GetNDOFsFace</a>();</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160; </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsFace; ++j) {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj    = counterEntries[surfElem[i].<a class="code" href="class_c_surface_element_f_e_m.html#aee91841e533b10cdbe3b3b09e98e3695">DOFsSolFace</a>[j]]++;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a85ca865434583283c6fa8da85f635b74">entriesResFaces</a>[jj] = sizeVecResFaces++;</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        }</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160; </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="comment">/* The symmetrizing terms, if present, contribute to all</span></div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;<span class="comment">           the DOFs of the adjacent elements. */</span></div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) {</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#aad6afe2fa8d35697a57dfc22a7542176">GetNDOFsElem</a>();</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFsElem; ++j) {</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj    = counterEntries[surfElem[i].<a class="code" href="class_c_surface_element_f_e_m.html#abdf9f21e0435e853d60d7faeecbb5e2f">DOFsSolElement</a>[j]]++;</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a85ca865434583283c6fa8da85f635b74">entriesResFaces</a>[jj] = sizeVecResFaces++;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;          }</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        }</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    }</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  }</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  <span class="comment">/*--- Start the solution from the free-stream state. This is overruled</span></div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;<span class="comment">        when a restart takes place. ---*/</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = 0;</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i) {</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++j, ++ii) {</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>[ii] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[j];</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="comment">/* Check if the exact Jacobian of the spatial discretization must be</span></div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;<span class="comment">     determined. If so, the color of each DOF must be determined, which</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;<span class="comment">     is converted to the DOFs for each color. */</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="class_c_config.html#a9301440279b2cbf0f8ea3c8a83e240e6">GetJacobian_Spatial_Discretization_Only</a>() ) {</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="comment">/* Write a message that the graph coloring is performed. */</span></div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>)</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Creating the vertex colors of the graph. &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160; </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    <span class="comment">/* Determine the graph of the stencil of every local DOF. */</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    DetermineGraphDOFs(DGGeometry, config);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160; </div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <span class="comment">/* Carry out the vertex coloring of the graph. */</span></div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <a class="code" href="class_c_graph_coloring_structure.html">CGraphColoringStructure</a> graphColoring;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    vector&lt;int&gt; colorLocalDOFs;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    graphColoring.<a class="code" href="class_c_graph_coloring_structure.html#af201979cd95be98ba34369bb30629956">GraphVertexColoring</a>(config, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>,</div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;                                      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5bda43e6dcef5d4811431f7e24bc6369">nGlobalColors</a>, colorLocalDOFs);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160; </div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    <span class="comment">/* Write a message that the all volume DOFs have been colored. */</span></div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>)</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;There are &quot;</span> &lt;&lt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5bda43e6dcef5d4811431f7e24bc6369">nGlobalColors</a></div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; colors present in the graph for &quot;</span> &lt;&lt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>.back()</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; DOFs.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160; </div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">/* Determine the meta data needed for the computation of the Jacobian. */</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    MetaDataJacobianComputation(DGGeometry, colorLocalDOFs);</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;  }</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160; </div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;  <span class="comment">/* Set up the persistent communication for the conservative variables and</span></div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;<span class="comment">     the reverse communication for the residuals of the halo elements. */</span></div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;  Prepare_MPI_Communication(DGGeometry, config);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160; </div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;  <span class="comment">/* Set up the list of tasks to be carried out in the computational expensive</span></div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;<span class="comment">     part of the code. For the Runge-Kutta schemes this is typically the</span></div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;<span class="comment">     computation of the spatial residual, while for ADER this list contains</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="comment">     the tasks to be done for one space time step. */</span></div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  SetUpTaskList(config);</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;}</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160; </div>
<div class="line"><a name="l00721"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a785146ae1cdaef2a880dab58dfcca0e1">  721</a></span>&#160;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a785146ae1cdaef2a880dab58dfcca0e1">CFEM_DG_EulerSolver::~CFEM_DG_EulerSolver</a>(<span class="keywordtype">void</span>) {</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160; </div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>    != NULL) <span class="keyword">delete</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>;</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a> != NULL) <span class="keyword">delete</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <span class="comment">/*--- Array deallocation ---*/</span></div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a> != NULL)           <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a>;</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a> != NULL)           <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a>;</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a069e21a1a7bb86994d97296c8be8482d">CSF_Inv</a> != NULL)          <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a069e21a1a7bb86994d97296c8be8482d">CSF_Inv</a>;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a777496791f91315cc44fa3bf90237738">CMx_Inv</a> != NULL)          <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a777496791f91315cc44fa3bf90237738">CMx_Inv</a>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4ed349d7fd826d372ce1fe6119bfc1">CMy_Inv</a> != NULL)          <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4ed349d7fd826d372ce1fe6119bfc1">CMy_Inv</a>;</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CMz_Inv</a> != NULL)          <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CMz_Inv</a>;</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFx_Inv</a> != NULL)          <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFx_Inv</a>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFy_Inv</a> != NULL)          <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFy_Inv</a>;</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9e7a08fa34a5d46b21a127c5e0535a98">CFz_Inv</a> != NULL)          <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9e7a08fa34a5d46b21a127c5e0535a98">CFz_Inv</a>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a> != NULL)   <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a>;</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a> != NULL)   <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a>;</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">Surface_CSF_Inv</a> != NULL)  <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">Surface_CSF_Inv</a>;</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac4a8cda93a2c52067378ab6b4a46f469">Surface_CEff_Inv</a> != NULL) <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac4a8cda93a2c52067378ab6b4a46f469">Surface_CEff_Inv</a>;</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">Surface_CFx_Inv</a> != NULL)  <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">Surface_CFx_Inv</a>;</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">Surface_CFy_Inv</a> != NULL)  <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">Surface_CFy_Inv</a>;</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">Surface_CFz_Inv</a> != NULL)  <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">Surface_CFz_Inv</a>;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">Surface_CMx_Inv</a> != NULL)  <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">Surface_CMx_Inv</a>;</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">Surface_CMy_Inv</a> != NULL)  <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">Surface_CMy_Inv</a>;</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">Surface_CMz_Inv</a> != NULL)  <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">Surface_CMz_Inv</a>;</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a> != NULL)       <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a>;</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a> != NULL)       <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a>;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2a26031c6fd9824899ecb92125207b60">Surface_CSF</a> != NULL)      <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2a26031c6fd9824899ecb92125207b60">Surface_CSF</a>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d84d5e44c469d17b9024f44a93bb2bc">Surface_CEff</a> != NULL)     <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d84d5e44c469d17b9024f44a93bb2bc">Surface_CEff</a>;</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3dde950e7512a05dc691db87cd8ca51f">Surface_CFx</a> != NULL)      <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3dde950e7512a05dc691db87cd8ca51f">Surface_CFx</a>;</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d7110b59eb940c5e354f2303946dcf2">Surface_CFy</a> != NULL)      <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d7110b59eb940c5e354f2303946dcf2">Surface_CFy</a>;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50202c322d1794f32fbfe7eff7617c25">Surface_CFz</a> != NULL)      <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50202c322d1794f32fbfe7eff7617c25">Surface_CFz</a>;</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa2b0fa39f8b4853f27c537e30681d2c7">Surface_CMx</a> != NULL)      <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa2b0fa39f8b4853f27c537e30681d2c7">Surface_CMx</a>;</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a417c1b82a8a8b76d049cd48a796f68f3">Surface_CMy</a> != NULL)      <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a417c1b82a8a8b76d049cd48a796f68f3">Surface_CMy</a>;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">Surface_CMz</a> != NULL)      <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">Surface_CMz</a>;</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3490fa3bd85d5fade030b46f3d90fb51">CEff_Inv</a> != NULL)         <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3490fa3bd85d5fade030b46f3d90fb51">CEff_Inv</a>;</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160; </div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#add6a32199a4a6df9ade18f1c4fe325d1">Cauchy_Serie</a> != NULL) <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#add6a32199a4a6df9ade18f1c4fe325d1">Cauchy_Serie</a>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;}</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a31316dc2fe564329d9bb372961b10a3a">  761</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a31316dc2fe564329d9bb372961b10a3a">CFEM_DG_EulerSolver::SetNondimensionalization</a>(<a class="code" href="class_c_config.html">CConfig</a>        *config,</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;                                                   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh,</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">bool</span>     writeOutput) {</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160; </div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Temperature_FreeStream = 0.0, Mach2Vel_FreeStream = 0.0, ModVel_FreeStream = 0.0,</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  Energy_FreeStream = 0.0, ModVel_FreeStreamND = 0.0, Velocity_Reynolds = 0.0,</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  Omega_FreeStream = 0.0, Omega_FreeStreamND = 0.0, Viscosity_FreeStream = 0.0,</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;  Density_FreeStream = 0.0, Pressure_FreeStream = 0.0, Tke_FreeStream = 0.0,</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  Length_Ref = 0.0, Density_Ref = 0.0, Pressure_Ref = 0.0, Velocity_Ref = 0.0,</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;  Temperature_Ref = 0.0, Time_Ref = 0.0, Omega_Ref = 0.0, Force_Ref = 0.0,</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;  Gas_Constant_Ref = 0.0, Viscosity_Ref = 0.0, Conductivity_Ref = 0.0, Energy_Ref= 0.0,</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;  Froude = 0.0, Pressure_FreeStreamND = 0.0, Density_FreeStreamND = 0.0,</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;  Temperature_FreeStreamND = 0.0, Gas_ConstantND = 0.0,</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;  Velocity_FreeStreamND[3] = {0.0, 0.0, 0.0}, Viscosity_FreeStreamND = 0.0,</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;  Tke_FreeStreamND = 0.0, Energy_FreeStreamND = 0.0,</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;  Total_UnstTimeND = 0.0, Delta_UnstTimeND = 0.0;</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160; </div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim;</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160; </div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;  <span class="comment">/*--- Local variables ---*/</span></div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Alpha            = config-&gt;<a class="code" href="class_c_config.html#a6020a5df7025ffb286f9b9f55f3f2773">GetAoA</a>()*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0;</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Beta             = config-&gt;<a class="code" href="class_c_config.html#a4305a79a4c74f13160c0dd8daae181ef">GetAoS</a>()*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0;</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Mach             = config-&gt;<a class="code" href="class_c_config.html#a624138f0bb5ee7494459b8e25c5d6287">GetMach</a>();</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Reynolds         = config-&gt;<a class="code" href="class_c_config.html#a43d642b59f0e1dae7abd613f337f5cf4">GetReynolds</a>();</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;  <span class="keywordtype">bool</span> unsteady           = (config-&gt;<a class="code" href="class_c_config.html#a45e95664235928d911e7c3876fe078b3">GetUnsteady_Simulation</a>() != <a class="code" href="option__structure_8hpp.html#a0e3c6990687ed4453e660b9db9181885a0d077f5b932ce05e5b9f30c6087a2f31">NO</a>);</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;  <span class="keywordtype">bool</span> viscous            = config-&gt;<a class="code" href="class_c_config.html#a2e9af0bd3e1f5ed865e81b627e94a662">GetViscous</a>();</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;  <span class="keywordtype">bool</span> grid_movement      = config-&gt;<a class="code" href="class_c_config.html#a65f49bf3888539804cc0ceac28a32923">GetGrid_Movement</a>();</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;  <span class="keywordtype">bool</span> turbulent          = (config-&gt;<a class="code" href="class_c_config.html#a0e2628fc803f14ec6179427ee02e8655">GetKind_Solver</a>() == <a class="code" href="option__structure_8hpp.html#a7e93bda08563596859d4d82f0ab516aca9833bae71221104500b678a587572a2b">FEM_RANS</a>) || (config-&gt;<a class="code" href="class_c_config.html#a0e2628fc803f14ec6179427ee02e8655">GetKind_Solver</a>() == <a class="code" href="option__structure_8hpp.html#a7e93bda08563596859d4d82f0ab516acad2cab85bb44510e289b85c4d94ac478a">FEM_LES</a>);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;  <span class="keywordtype">bool</span> tkeNeeded          = ((turbulent) &amp;&amp; (config-&gt;<a class="code" href="class_c_config.html#a40aaed07fc5844d505d2c0b7076594d7">GetKind_Turb_Model</a>() == <a class="code" href="option__structure_8hpp.html#ad373dc9c6ae8d8d7fe047111b3944f4ea92433826a98d86b2750b2126b12892e6">SST</a>));</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;  <span class="keywordtype">bool</span> free_stream_temp   = (config-&gt;<a class="code" href="class_c_config.html#a204106aac96526165d76f6055d75758c">GetKind_FreeStreamOption</a>() == <a class="code" href="option__structure_8hpp.html#a12f1af627694b6770a33eb21cbbe4a36a87b50d917dc1184a391e4e66490b5c47">TEMPERATURE_FS</a>);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;  <span class="keywordtype">bool</span> reynolds_init      = (config-&gt;<a class="code" href="class_c_config.html#ac5caa07310bcfde15a16e5eeadbfa454">GetKind_InitOption</a>() == <a class="code" href="option__structure_8hpp.html#ac9f3f2c2da455edd2b4b1f7ff0688db1a966c1ce78de3189e9f29ab4f1bb900f6">REYNOLDS</a>);</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160; </div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;  <span class="comment">/*--- Compute the Free Stream velocity, using the Mach number ---*/</span></div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;  Pressure_FreeStream = config-&gt;<a class="code" href="class_c_config.html#a957806325eb8ed6cc4c41e886903f9cf">GetPressure_FreeStream</a>();</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;  Density_FreeStream  = config-&gt;<a class="code" href="class_c_config.html#ae9520958df27678474890ee79980ee24">GetDensity_FreeStream</a>();</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;  Temperature_FreeStream  = config-&gt;<a class="code" href="class_c_config.html#a85b0488628cfb289b5413a888fb7cb0c">GetTemperature_FreeStream</a>();</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;  <span class="keywordflow">switch</span> (config-&gt;<a class="code" href="class_c_config.html#ac36fbf73af5ad628f510769c556717d3">GetKind_FluidModel</a>()) {</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160; </div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6a27b0e0183e180e07e87338c46d879469">STANDARD_AIR</a>:</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160; </div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;      <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) config-&gt;<a class="code" href="class_c_config.html#a77175a3f3539c5884347ec0d8a5dd3ed">SetGas_Constant</a>(287.058);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) config-&gt;<a class="code" href="class_c_config.html#a77175a3f3539c5884347ec0d8a5dd3ed">SetGas_Constant</a>(1716.49);</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a> = <span class="keyword">new</span> <a class="code" href="class_c_ideal_gas.html">CIdealGas</a>(1.4, config-&gt;<a class="code" href="class_c_config.html#acc01ed919b224cf1c8419848ba157332">GetGas_Constant</a>(), config-&gt;<a class="code" href="class_c_config.html#a54f9761f3971e4c3b74afa7b09e17281">GetCompute_Entropy</a>());</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">if</span> (free_stream_temp) {</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aba62ecbb521322a3c475561f84d77a1a">SetTDState_PT</a>(Pressure_FreeStream, Temperature_FreeStream);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;        Density_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ab386408b4b890e3e27be7a28a740d1ae">GetDensity</a>();</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;        config-&gt;<a class="code" href="class_c_config.html#a03e72fe3f8576f2aecb234079607dc46">SetDensity_FreeStream</a>(Density_FreeStream);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      }</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ad93e74a6cc6610e9c31c180040bda4e6">SetTDState_Prho</a>(Pressure_FreeStream, Density_FreeStream );</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        Temperature_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aeba3f29d27211ff50acad59477105969">GetTemperature</a>();</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        config-&gt;<a class="code" href="class_c_config.html#a5dd15f92f800bf0a8501daf65cbf24fd">SetTemperature_FreeStream</a>(Temperature_FreeStream);</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      }</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160; </div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6a018f14c4cf09b1168d285920002c0e02">IDEAL_GAS</a>:</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160; </div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a> = <span class="keyword">new</span> <a class="code" href="class_c_ideal_gas.html">CIdealGas</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>, config-&gt;<a class="code" href="class_c_config.html#acc01ed919b224cf1c8419848ba157332">GetGas_Constant</a>(), config-&gt;<a class="code" href="class_c_config.html#a54f9761f3971e4c3b74afa7b09e17281">GetCompute_Entropy</a>());</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="keywordflow">if</span> (free_stream_temp) {</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aba62ecbb521322a3c475561f84d77a1a">SetTDState_PT</a>(Pressure_FreeStream, Temperature_FreeStream);</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        Density_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ab386408b4b890e3e27be7a28a740d1ae">GetDensity</a>();</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        config-&gt;<a class="code" href="class_c_config.html#a03e72fe3f8576f2aecb234079607dc46">SetDensity_FreeStream</a>(Density_FreeStream);</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      }</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ad93e74a6cc6610e9c31c180040bda4e6">SetTDState_Prho</a>(Pressure_FreeStream, Density_FreeStream );</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;        Temperature_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aeba3f29d27211ff50acad59477105969">GetTemperature</a>();</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        config-&gt;<a class="code" href="class_c_config.html#a5dd15f92f800bf0a8501daf65cbf24fd">SetTemperature_FreeStream</a>(Temperature_FreeStream);</div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      }</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160; </div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6abbbb49e6f42fe5d0fec2f5728888a595">VW_GAS</a>:</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a> = <span class="keyword">new</span> <a class="code" href="class_c_van_der_waals_gas.html">CVanDerWaalsGas</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>, config-&gt;<a class="code" href="class_c_config.html#acc01ed919b224cf1c8419848ba157332">GetGas_Constant</a>(),</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                                       config-&gt;<a class="code" href="class_c_config.html#a0db6b19fdbad621160f1ff55da7cec0d">GetPressure_Critical</a>(), config-&gt;<a class="code" href="class_c_config.html#a4804ac178513e42634818413c96dbf69">GetTemperature_Critical</a>());</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;      <span class="keywordflow">if</span> (free_stream_temp) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aba62ecbb521322a3c475561f84d77a1a">SetTDState_PT</a>(Pressure_FreeStream, Temperature_FreeStream);</div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;        Density_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ab386408b4b890e3e27be7a28a740d1ae">GetDensity</a>();</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;        config-&gt;<a class="code" href="class_c_config.html#a03e72fe3f8576f2aecb234079607dc46">SetDensity_FreeStream</a>(Density_FreeStream);</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      }</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ad93e74a6cc6610e9c31c180040bda4e6">SetTDState_Prho</a>(Pressure_FreeStream, Density_FreeStream );</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        Temperature_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aeba3f29d27211ff50acad59477105969">GetTemperature</a>();</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        config-&gt;<a class="code" href="class_c_config.html#a5dd15f92f800bf0a8501daf65cbf24fd">SetTemperature_FreeStream</a>(Temperature_FreeStream);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6af5fbeda4fe0ca675217a7e8ce7e33376">PR_GAS</a>:</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160; </div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a> = <span class="keyword">new</span> <a class="code" href="class_c_peng_robinson.html">CPengRobinson</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>, config-&gt;<a class="code" href="class_c_config.html#acc01ed919b224cf1c8419848ba157332">GetGas_Constant</a>(), config-&gt;<a class="code" href="class_c_config.html#a0db6b19fdbad621160f1ff55da7cec0d">GetPressure_Critical</a>(),</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;                                     config-&gt;<a class="code" href="class_c_config.html#a4804ac178513e42634818413c96dbf69">GetTemperature_Critical</a>(), config-&gt;<a class="code" href="class_c_config.html#a802168826c8d609805ca466c495fcffd">GetAcentric_Factor</a>());</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <span class="keywordflow">if</span> (free_stream_temp) {</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aba62ecbb521322a3c475561f84d77a1a">SetTDState_PT</a>(Pressure_FreeStream, Temperature_FreeStream);</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;        Density_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ab386408b4b890e3e27be7a28a740d1ae">GetDensity</a>();</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        config-&gt;<a class="code" href="class_c_config.html#a03e72fe3f8576f2aecb234079607dc46">SetDensity_FreeStream</a>(Density_FreeStream);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ad93e74a6cc6610e9c31c180040bda4e6">SetTDState_Prho</a>(Pressure_FreeStream, Density_FreeStream );</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        Temperature_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aeba3f29d27211ff50acad59477105969">GetTemperature</a>();</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        config-&gt;<a class="code" href="class_c_config.html#a5dd15f92f800bf0a8501daf65cbf24fd">SetTemperature_FreeStream</a>(Temperature_FreeStream);</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160; </div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;  }</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;  Mach2Vel_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a4a2b307dfa2a545c632548c8d7c6e86c">GetSoundSpeed</a>();</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160; </div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;  <span class="comment">/*--- Compute the Free Stream velocity, using the Mach number ---*/</span></div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160; </div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[0] = cos(Alpha)*Mach*Mach2Vel_FreeStream;</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[1] = sin(Alpha)*Mach*Mach2Vel_FreeStream;</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;  }</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[0] = cos(Alpha)*cos(Beta)*Mach*Mach2Vel_FreeStream;</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[1] = sin(Beta)*Mach*Mach2Vel_FreeStream;</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[2] = sin(Alpha)*cos(Beta)*Mach*Mach2Vel_FreeStream;</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;  }</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;  <span class="comment">/*--- Compute the modulus of the free stream velocity ---*/</span></div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160; </div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;  ModVel_FreeStream = 0.0;</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++)</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    ModVel_FreeStream += config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[iDim]*config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[iDim];</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;  ModVel_FreeStream = sqrt(ModVel_FreeStream); config-&gt;<a class="code" href="class_c_config.html#a530e7500f6d37f1b08b491c73adca7c5">SetModVel_FreeStream</a>(ModVel_FreeStream);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160; </div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;  <span class="comment">/*--- Viscous initialization ---*/</span></div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160; </div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;  <span class="keywordflow">if</span> (viscous) {</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160; </div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;    <span class="comment">/*--- The dimensional viscosity is needed to determine the free-stream conditions.</span></div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;<span class="comment">          To accomplish this, simply set the non-dimensional coefficients to the</span></div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;<span class="comment">          dimensional ones. This will be overruled later.---*/</span></div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#a13d0041a3a4692ec11ceb8913e6f838c">SetMu_RefND</a>(config-&gt;<a class="code" href="class_c_config.html#aec59768cd9ae76e07db52a62c532a677">GetMu_Ref</a>());</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#a1696047f983ba93433524f68c91081ab">SetMu_Temperature_RefND</a>(config-&gt;<a class="code" href="class_c_config.html#a048053ffa126a91fc931109042a04fcb">GetMu_Temperature_Ref</a>());</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#afda4123ea9b79517fff1acf7747dd873">SetMu_SND</a>(config-&gt;<a class="code" href="class_c_config.html#ab0ded0ff59242b315296a98e136fc080">GetMu_S</a>());</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160; </div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#a4839611d49c172c1d8ee67b862c6e621">SetMu_ConstantND</a>(config-&gt;<a class="code" href="class_c_config.html#a0c3089623173e72c021c745235fdd47d">GetMu_Constant</a>());</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160; </div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;    <span class="comment">/*--- Reynolds based initialization ---*/</span></div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160; </div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    <span class="keywordflow">if</span> (reynolds_init) {</div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160; </div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;      <span class="comment">/*--- First, check if there is mesh motion. If yes, use the Mach</span></div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;<span class="comment">       number relative to the body to initialize the flow. ---*/</span></div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160; </div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;      <span class="keywordflow">if</span> (grid_movement) Velocity_Reynolds = config-&gt;<a class="code" href="class_c_config.html#a84da3953107e3dad010e13227f1d84d0">GetMach_Motion</a>()*Mach2Vel_FreeStream;</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;      <span class="keywordflow">else</span> Velocity_Reynolds = ModVel_FreeStream;</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160; </div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;      <span class="comment">/*--- For viscous flows, pressure will be computed from a density</span></div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;<span class="comment">            that is found from the Reynolds number. The viscosity is computed</span></div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;<span class="comment">            from the dimensional version of Sutherland&#39;s law or the constant</span></div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;<span class="comment">            viscosity, depending on the input option.---*/</span></div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160; </div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ae5660a6bc666007eb80b491873d487d2">SetLaminarViscosityModel</a>(config);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160; </div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      Viscosity_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;      config-&gt;<a class="code" href="class_c_config.html#ad29da5efbc55028f58a405ae9363ff9f">SetViscosity_FreeStream</a>(Viscosity_FreeStream);</div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160; </div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;      Density_FreeStream = Reynolds*Viscosity_FreeStream/(Velocity_Reynolds*config-&gt;<a class="code" href="class_c_config.html#a07e07baa3b8259bfa545fd1de2fac74a">GetLength_Reynolds</a>());</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;      config-&gt;<a class="code" href="class_c_config.html#a03e72fe3f8576f2aecb234079607dc46">SetDensity_FreeStream</a>(Density_FreeStream);</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a77fd0c1114048ef6ce3b574c9321533b">SetTDState_rhoT</a>(Density_FreeStream, Temperature_FreeStream);</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;      Pressure_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;      config-&gt;<a class="code" href="class_c_config.html#ab9f282a9910f42c0871da3718965eb0a">SetPressure_FreeStream</a>(Pressure_FreeStream);</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;      Energy_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a99d4d8c322ea4f1072e0326f09154318">GetStaticEnergy</a>() + 0.5*ModVel_FreeStream*ModVel_FreeStream;</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160; </div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    }</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160; </div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    <span class="comment">/*--- Thermodynamics quantities based initialization ---*/</span></div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160; </div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ae5660a6bc666007eb80b491873d487d2">SetLaminarViscosityModel</a>(config);</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;      Viscosity_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;      config-&gt;<a class="code" href="class_c_config.html#ad29da5efbc55028f58a405ae9363ff9f">SetViscosity_FreeStream</a>(Viscosity_FreeStream);</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;      Energy_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a99d4d8c322ea4f1072e0326f09154318">GetStaticEnergy</a>() + 0.5*ModVel_FreeStream*ModVel_FreeStream;</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160; </div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    }</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160; </div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <span class="comment">/*--- Turbulence kinetic energy ---*/</span></div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    Tke_FreeStream  = 3.0/2.0*(ModVel_FreeStream*ModVel_FreeStream*config-&gt;<a class="code" href="class_c_config.html#acab57b0918bd4f1d5b9893dcdf0f987c">GetTurbulenceIntensity_FreeStream</a>()*config-&gt;<a class="code" href="class_c_config.html#acab57b0918bd4f1d5b9893dcdf0f987c">GetTurbulenceIntensity_FreeStream</a>());</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160; </div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;  }</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160; </div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="comment">/*--- For inviscid flow, energy is calculated from the specified</span></div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;<span class="comment">     FreeStream quantities using the proper gas law. ---*/</span></div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    Energy_FreeStream = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a99d4d8c322ea4f1072e0326f09154318">GetStaticEnergy</a>() + 0.5*ModVel_FreeStream*ModVel_FreeStream;</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160; </div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;  }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160; </div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  <span class="comment">/*-- Compute the freestream energy. ---*/</span></div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <span class="keywordflow">if</span> (tkeNeeded) { Energy_FreeStream += Tke_FreeStream; }; config-&gt;<a class="code" href="class_c_config.html#a925f9f6e7ae91307610f6d2b0586aad5">SetEnergy_FreeStream</a>(Energy_FreeStream);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <span class="comment">/*--- Compute non dimensional quantities. By definition,</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;<span class="comment">   Lref is one because we have converted the grid to meters. ---*/</span></div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#aac9fcd40a51d17b6f7a296126b62caf9">GetRef_NonDim</a>() == <a class="code" href="option__structure_8hpp.html#abb44095cd1b2b41f904fc18bc658b543a844c8392dad6330e1016dd64031273bd">DIMENSIONAL</a>) {</div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    Pressure_Ref      = 1.0;</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    Density_Ref       = 1.0;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    Temperature_Ref   = 1.0;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;  }</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#aac9fcd40a51d17b6f7a296126b62caf9">GetRef_NonDim</a>() == <a class="code" href="option__structure_8hpp.html#abb44095cd1b2b41f904fc18bc658b543a36c407890548309c6d9931dc2026d793">FREESTREAM_PRESS_EQ_ONE</a>) {</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;    Pressure_Ref      = Pressure_FreeStream;     <span class="comment">// Pressure_FreeStream = 1.0</span></div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    Density_Ref       = Density_FreeStream;      <span class="comment">// Density_FreeStream = 1.0</span></div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;    Temperature_Ref   = Temperature_FreeStream;  <span class="comment">// Temperature_FreeStream = 1.0</span></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;  }</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#aac9fcd40a51d17b6f7a296126b62caf9">GetRef_NonDim</a>() == <a class="code" href="option__structure_8hpp.html#abb44095cd1b2b41f904fc18bc658b543a92bd0b044c90bae1d77b5d60562ad548">FREESTREAM_VEL_EQ_MACH</a>) {</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    Pressure_Ref      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*Pressure_FreeStream; <span class="comment">// Pressure_FreeStream = 1.0/Gamma</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    Density_Ref       = Density_FreeStream;        <span class="comment">// Density_FreeStream = 1.0</span></div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    Temperature_Ref   = Temperature_FreeStream;    <span class="comment">// Temp_FreeStream = 1.0</span></div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;  }</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#aac9fcd40a51d17b6f7a296126b62caf9">GetRef_NonDim</a>() == <a class="code" href="option__structure_8hpp.html#abb44095cd1b2b41f904fc18bc658b543ab0999eb35a4affc392d7d52037c1f91e">FREESTREAM_VEL_EQ_ONE</a>) {</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    Pressure_Ref      = Mach*Mach*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*Pressure_FreeStream; <span class="comment">// Pressure_FreeStream = 1.0/(Gamma*(M_inf)^2)</span></div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    Density_Ref       = Density_FreeStream;        <span class="comment">// Density_FreeStream = 1.0</span></div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    Temperature_Ref   = Temperature_FreeStream;    <span class="comment">// Temp_FreeStream = 1.0</span></div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;  }</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;  config-&gt;<a class="code" href="class_c_config.html#aa529accbcb66c5f6b56eaab6fda7071b">SetPressure_Ref</a>(Pressure_Ref);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;  config-&gt;<a class="code" href="class_c_config.html#aed0475c5a5a27525d544f40366ce561a">SetDensity_Ref</a>(Density_Ref);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;  config-&gt;<a class="code" href="class_c_config.html#a86599996300e409cf4f474b8a061d906">SetTemperature_Ref</a>(Temperature_Ref);</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  Length_Ref        = 1.0;                                                         config-&gt;<a class="code" href="class_c_config.html#a8d4fc7062852023d1daec115ca5eceba">SetLength_Ref</a>(Length_Ref);</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;  Velocity_Ref      = sqrt(config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>()/config-&gt;<a class="code" href="class_c_config.html#a8cc3d7d06d995bf315cbed96412a9b7e">GetDensity_Ref</a>());    config-&gt;<a class="code" href="class_c_config.html#a1d437bdfd2876763fc5cba066b2d8ee3">SetVelocity_Ref</a>(Velocity_Ref);</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  Time_Ref          = Length_Ref/Velocity_Ref;                                     config-&gt;<a class="code" href="class_c_config.html#a3cbef01a6e1083e96cebef19c96d9ad6">SetTime_Ref</a>(Time_Ref);</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;  Omega_Ref         = Velocity_Ref/Length_Ref;                                     config-&gt;<a class="code" href="class_c_config.html#a4cd8ee91bc2fc5601aff8f8eb017591d">SetOmega_Ref</a>(Omega_Ref);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;  Force_Ref         = Velocity_Ref*Velocity_Ref/Length_Ref;                        config-&gt;<a class="code" href="class_c_config.html#a0af31479b78f20cfab0d770c270da6d6">SetForce_Ref</a>(Force_Ref);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;  Gas_Constant_Ref  = Velocity_Ref*Velocity_Ref/config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>();      config-&gt;<a class="code" href="class_c_config.html#a59a783581a8ff2203a5df4143ba1f9d3">SetGas_Constant_Ref</a>(Gas_Constant_Ref);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  Viscosity_Ref     = config-&gt;<a class="code" href="class_c_config.html#a8cc3d7d06d995bf315cbed96412a9b7e">GetDensity_Ref</a>()*Velocity_Ref*Length_Ref;            config-&gt;<a class="code" href="class_c_config.html#a411b28e2984c771c3f3f4472bc425940">SetViscosity_Ref</a>(Viscosity_Ref);</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;  Conductivity_Ref  = Viscosity_Ref*Gas_Constant_Ref;                              config-&gt;<a class="code" href="class_c_config.html#a8fe434bf622c8a3eb95994dfa96ac9e9">SetConductivity_Ref</a>(Conductivity_Ref);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  Froude            = ModVel_FreeStream/sqrt(<a class="code" href="option__structure_8hpp.html#a194d116741c1b9a9b2d2d5ca0de9c5a3">STANDARD_GRAVITY</a>*Length_Ref);         config-&gt;<a class="code" href="class_c_config.html#ae91198a9134853e8970cd38db8628c24">SetFroude</a>(Froude);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <span class="comment">/*--- Divide by reference values, to compute the non-dimensional free-stream values ---*/</span></div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160; </div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;  Pressure_FreeStreamND = Pressure_FreeStream/config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>();  config-&gt;<a class="code" href="class_c_config.html#aa81134852bfae258be83fcbb88bea0a6">SetPressure_FreeStreamND</a>(Pressure_FreeStreamND);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;  Density_FreeStreamND  = Density_FreeStream/config-&gt;<a class="code" href="class_c_config.html#a8cc3d7d06d995bf315cbed96412a9b7e">GetDensity_Ref</a>();    config-&gt;<a class="code" href="class_c_config.html#a6a9642ebdd5941ab1d4e72519439ef51">SetDensity_FreeStreamND</a>(Density_FreeStreamND);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160; </div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    Velocity_FreeStreamND[iDim] = config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[iDim]/Velocity_Ref; config-&gt;<a class="code" href="class_c_config.html#a0dd94d37a95acbb120ec45ea7f5e4e9c">SetVelocity_FreeStreamND</a>(Velocity_FreeStreamND[iDim], iDim);</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  }</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160; </div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  Temperature_FreeStreamND = Temperature_FreeStream/config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>(); config-&gt;<a class="code" href="class_c_config.html#afaa9eb2373caea9d89df79ff693c4a0d">SetTemperature_FreeStreamND</a>(Temperature_FreeStreamND);</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160; </div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  Gas_ConstantND = config-&gt;<a class="code" href="class_c_config.html#acc01ed919b224cf1c8419848ba157332">GetGas_Constant</a>()/Gas_Constant_Ref;    config-&gt;<a class="code" href="class_c_config.html#adaef7ca454b96e9bb01416cbd523abdc">SetGas_ConstantND</a>(Gas_ConstantND);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160; </div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160; </div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;  ModVel_FreeStreamND = 0.0;</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;  <span class="keywordflow">for</span> (iDim = 0; iDim &lt; <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) ModVel_FreeStreamND += Velocity_FreeStreamND[iDim]*Velocity_FreeStreamND[iDim];</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;  ModVel_FreeStreamND    = sqrt(ModVel_FreeStreamND); config-&gt;<a class="code" href="class_c_config.html#a06234c8c7b3b63373789e8826b5122d0">SetModVel_FreeStreamND</a>(ModVel_FreeStreamND);</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160; </div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;  Viscosity_FreeStreamND = Viscosity_FreeStream / Viscosity_Ref;   config-&gt;<a class="code" href="class_c_config.html#ad2df4adf68a538a1b151deba9b94090f">SetViscosity_FreeStreamND</a>(Viscosity_FreeStreamND);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160; </div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  Tke_FreeStream  = 3.0/2.0*(ModVel_FreeStream*ModVel_FreeStream*config-&gt;<a class="code" href="class_c_config.html#acab57b0918bd4f1d5b9893dcdf0f987c">GetTurbulenceIntensity_FreeStream</a>()*config-&gt;<a class="code" href="class_c_config.html#acab57b0918bd4f1d5b9893dcdf0f987c">GetTurbulenceIntensity_FreeStream</a>());</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  config-&gt;<a class="code" href="class_c_config.html#a60325c7c0961c3ec27b040de0416af55">SetTke_FreeStream</a>(Tke_FreeStream);</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160; </div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  Tke_FreeStreamND  = 3.0/2.0*(ModVel_FreeStreamND*ModVel_FreeStreamND*config-&gt;<a class="code" href="class_c_config.html#acab57b0918bd4f1d5b9893dcdf0f987c">GetTurbulenceIntensity_FreeStream</a>()*config-&gt;<a class="code" href="class_c_config.html#acab57b0918bd4f1d5b9893dcdf0f987c">GetTurbulenceIntensity_FreeStream</a>());</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  config-&gt;<a class="code" href="class_c_config.html#aa70032ce7349ef173870f72c58be0a6f">SetTke_FreeStreamND</a>(Tke_FreeStreamND);</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  Omega_FreeStream = Density_FreeStream*Tke_FreeStream/max((Viscosity_FreeStream*config-&gt;<a class="code" href="class_c_config.html#ab2c45bd43a8f9e852c7f52a0b5003552">GetTurb2LamViscRatio_FreeStream</a>()), 1.e-25);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;  config-&gt;<a class="code" href="class_c_config.html#a50947bb098db079c9ea1829ed09b5d01">SetOmega_FreeStream</a>(Omega_FreeStream);</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160; </div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;  Omega_FreeStreamND = Density_FreeStreamND*Tke_FreeStreamND/max((Viscosity_FreeStreamND*config-&gt;<a class="code" href="class_c_config.html#ab2c45bd43a8f9e852c7f52a0b5003552">GetTurb2LamViscRatio_FreeStream</a>()), 1.e-25);</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;  config-&gt;<a class="code" href="class_c_config.html#a8e18855ef00253c9b6a311c2c77ba292">SetOmega_FreeStreamND</a>(Omega_FreeStreamND);</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160; </div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;  <span class="comment">/*--- Initialize the dimensionless Fluid Model that will be used to solve the dimensionless problem ---*/</span></div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160; </div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  <span class="comment">/*--- Delete the original (dimensional) FluidModel object before replacing. ---*/</span></div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keyword">delete</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>;</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;  <span class="keywordflow">switch</span> (config-&gt;<a class="code" href="class_c_config.html#ac36fbf73af5ad628f510769c556717d3">GetKind_FluidModel</a>()) {</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160; </div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6a27b0e0183e180e07e87338c46d879469">STANDARD_AIR</a>:</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a> = <span class="keyword">new</span> <a class="code" href="class_c_ideal_gas.html">CIdealGas</a>(1.4, Gas_ConstantND, config-&gt;<a class="code" href="class_c_config.html#a54f9761f3971e4c3b74afa7b09e17281">GetCompute_Entropy</a>());</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#adead4cab94b577e9e4129ef57110febd">SetEnergy_Prho</a>(Pressure_FreeStreamND, Density_FreeStreamND);</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160; </div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6a018f14c4cf09b1168d285920002c0e02">IDEAL_GAS</a>:</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a> = <span class="keyword">new</span> <a class="code" href="class_c_ideal_gas.html">CIdealGas</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>, Gas_ConstantND, config-&gt;<a class="code" href="class_c_config.html#a54f9761f3971e4c3b74afa7b09e17281">GetCompute_Entropy</a>());</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#adead4cab94b577e9e4129ef57110febd">SetEnergy_Prho</a>(Pressure_FreeStreamND, Density_FreeStreamND);</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6abbbb49e6f42fe5d0fec2f5728888a595">VW_GAS</a>:</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a> = <span class="keyword">new</span> <a class="code" href="class_c_van_der_waals_gas.html">CVanDerWaalsGas</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>, Gas_ConstantND, config-&gt;<a class="code" href="class_c_config.html#a0db6b19fdbad621160f1ff55da7cec0d">GetPressure_Critical</a>() /config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>(),</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                                       config-&gt;<a class="code" href="class_c_config.html#a4804ac178513e42634818413c96dbf69">GetTemperature_Critical</a>()/config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>());</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#adead4cab94b577e9e4129ef57110febd">SetEnergy_Prho</a>(Pressure_FreeStreamND, Density_FreeStreamND);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160; </div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6af5fbeda4fe0ca675217a7e8ce7e33376">PR_GAS</a>:</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a> = <span class="keyword">new</span> <a class="code" href="class_c_peng_robinson.html">CPengRobinson</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>, Gas_ConstantND, config-&gt;<a class="code" href="class_c_config.html#a0db6b19fdbad621160f1ff55da7cec0d">GetPressure_Critical</a>() /config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>(),</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                                     config-&gt;<a class="code" href="class_c_config.html#a4804ac178513e42634818413c96dbf69">GetTemperature_Critical</a>()/config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>(), config-&gt;<a class="code" href="class_c_config.html#a802168826c8d609805ca466c495fcffd">GetAcentric_Factor</a>());</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#adead4cab94b577e9e4129ef57110febd">SetEnergy_Prho</a>(Pressure_FreeStreamND, Density_FreeStreamND);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160; </div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;  }</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;  Energy_FreeStreamND = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a99d4d8c322ea4f1072e0326f09154318">GetStaticEnergy</a>() + 0.5*ModVel_FreeStreamND*ModVel_FreeStreamND;</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160; </div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  <span class="keywordflow">if</span> (viscous) {</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="comment">/*--- Constant viscosity model ---*/</span></div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#a4839611d49c172c1d8ee67b862c6e621">SetMu_ConstantND</a>(config-&gt;<a class="code" href="class_c_config.html#a0c3089623173e72c021c745235fdd47d">GetMu_Constant</a>()/Viscosity_Ref);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160; </div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;    <span class="comment">/*--- Sutherland&#39;s model ---*/</span></div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160; </div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#a13d0041a3a4692ec11ceb8913e6f838c">SetMu_RefND</a>(config-&gt;<a class="code" href="class_c_config.html#aec59768cd9ae76e07db52a62c532a677">GetMu_Ref</a>()/Viscosity_Ref);</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#afda4123ea9b79517fff1acf7747dd873">SetMu_SND</a>(config-&gt;<a class="code" href="class_c_config.html#ab0ded0ff59242b315296a98e136fc080">GetMu_S</a>()/config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>());</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#a1696047f983ba93433524f68c91081ab">SetMu_Temperature_RefND</a>(config-&gt;<a class="code" href="class_c_config.html#a048053ffa126a91fc931109042a04fcb">GetMu_Temperature_Ref</a>()/config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>());</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="comment">/* constant thermal conductivity model */</span></div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    config-&gt;<a class="code" href="class_c_config.html#a942b0f312131b0074be26c5343ed8a05">SetKt_ConstantND</a>(config-&gt;<a class="code" href="class_c_config.html#a4d36c240b8d496897ccbedbd6e4259dc">GetKt_Constant</a>()/Conductivity_Ref);</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160; </div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ae5660a6bc666007eb80b491873d487d2">SetLaminarViscosityModel</a>(config);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#af21d9b7b51689e064184eb7b09ae639a">SetThermalConductivityModel</a>(config);</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160; </div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  }</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;  <span class="keywordflow">if</span> (tkeNeeded) { Energy_FreeStreamND += Tke_FreeStreamND; };  config-&gt;<a class="code" href="class_c_config.html#ac1d01eba47c6802477c7975166f656bc">SetEnergy_FreeStreamND</a>(Energy_FreeStreamND);</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160; </div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;  Energy_Ref = Energy_FreeStream/Energy_FreeStreamND; config-&gt;<a class="code" href="class_c_config.html#a54d01076568a5d48e16f2029af794b26">SetEnergy_Ref</a>(Energy_Ref);</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160; </div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;  Total_UnstTimeND = config-&gt;<a class="code" href="class_c_config.html#ade2279cd5e412277dfe4699475c12305">GetTotal_UnstTime</a>() / Time_Ref;    config-&gt;<a class="code" href="class_c_config.html#a4abc46b3abb3a9226d9ea323aaa17e0e">SetTotal_UnstTimeND</a>(Total_UnstTimeND);</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;  Delta_UnstTimeND = config-&gt;<a class="code" href="class_c_config.html#aa9a5ddd6d3f6f56bc21f8a2ec3e7d220">GetDelta_UnstTime</a>() / Time_Ref;    config-&gt;<a class="code" href="class_c_config.html#a9d3085d222e6ab0b658d79c52b6477fc">SetDelta_UnstTimeND</a>(Delta_UnstTimeND);</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160; </div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;  <span class="comment">/*--- Write output to the console if this is required and if this is the master node and first domain ---*/</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160; </div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>) &amp;&amp; (iMesh == <a class="code" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>) &amp;&amp; writeOutput) {</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    cout.precision(6);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">if</span> (viscous) {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Viscous flow: Computing pressure using the ideal gas law&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;based on the free-stream temperature and a density computed&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;from the Reynolds number.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Inviscid flow: Computing density based on free-stream&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;temperature and pressure using the ideal gas law.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    }</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160; </div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="keywordflow">if</span> (grid_movement) cout &lt;&lt; <span class="stringliteral">&quot;Force coefficients computed using MACH_MOTION.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">else</span> cout &lt;&lt; <span class="stringliteral">&quot;Force coefficients computed using free-stream values.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160; </div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    cout &lt;&lt;<span class="stringliteral">&quot;-- Input conditions:&quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160; </div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;    <span class="keywordflow">switch</span> (config-&gt;<a class="code" href="class_c_config.html#ac36fbf73af5ad628f510769c556717d3">GetKind_FluidModel</a>()) {</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6a27b0e0183e180e07e87338c46d879469">STANDARD_AIR</a>:</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Fluid Model: STANDARD_AIR &quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific gas constant: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#acc01ed919b224cf1c8419848ba157332">GetGas_Constant</a>();</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; N.m/kg.K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; lbf.ft/slug.R.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific gas constant (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>()&lt;&lt; endl;</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific Heat Ratio: &quot;</span>&lt;&lt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a> &lt;&lt; endl;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160; </div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6a018f14c4cf09b1168d285920002c0e02">IDEAL_GAS</a>:</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Fluid Model: IDEAL_GAS &quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific gas constant: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#acc01ed919b224cf1c8419848ba157332">GetGas_Constant</a>() &lt;&lt; <span class="stringliteral">&quot; N.m/kg.K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific gas constant (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>()&lt;&lt; endl;</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific Heat Ratio: &quot;</span>&lt;&lt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a> &lt;&lt; endl;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6abbbb49e6f42fe5d0fec2f5728888a595">VW_GAS</a>:</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Fluid Model: Van der Waals &quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific gas constant: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#acc01ed919b224cf1c8419848ba157332">GetGas_Constant</a>() &lt;&lt; <span class="stringliteral">&quot; N.m/kg.K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific gas constant (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>()&lt;&lt; endl;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific Heat Ratio: &quot;</span>&lt;&lt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a> &lt;&lt; endl;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Critical Pressure:   &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a0db6b19fdbad621160f1ff55da7cec0d">GetPressure_Critical</a>()  &lt;&lt; <span class="stringliteral">&quot; Pa.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Critical Temperature:  &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a4804ac178513e42634818413c96dbf69">GetTemperature_Critical</a>() &lt;&lt; <span class="stringliteral">&quot; K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Critical Pressure (non-dim):   &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a0db6b19fdbad621160f1ff55da7cec0d">GetPressure_Critical</a>() /config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Critical Temperature (non-dim) :  &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a4804ac178513e42634818413c96dbf69">GetTemperature_Critical</a>() /config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6af5fbeda4fe0ca675217a7e8ce7e33376">PR_GAS</a>:</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Fluid Model: Peng-Robinson &quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific gas constant: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#acc01ed919b224cf1c8419848ba157332">GetGas_Constant</a>() &lt;&lt; <span class="stringliteral">&quot; N.m/kg.K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific gas constant (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>()&lt;&lt; endl;</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Specific Heat Ratio: &quot;</span>&lt;&lt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a> &lt;&lt; endl;</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Critical Pressure:   &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a0db6b19fdbad621160f1ff55da7cec0d">GetPressure_Critical</a>()  &lt;&lt; <span class="stringliteral">&quot; Pa.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Critical Temperature:  &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a4804ac178513e42634818413c96dbf69">GetTemperature_Critical</a>() &lt;&lt; <span class="stringliteral">&quot; K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Critical Pressure (non-dim):   &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a0db6b19fdbad621160f1ff55da7cec0d">GetPressure_Critical</a>() /config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Critical Temperature (non-dim) :  &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a4804ac178513e42634818413c96dbf69">GetTemperature_Critical</a>() /config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160; </div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    }</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;    <span class="keywordflow">if</span> (viscous) {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;      <span class="keywordflow">switch</span> (config-&gt;<a class="code" href="class_c_config.html#af6fbd87066353c64a6a7e97d77c237db">GetKind_ViscosityModel</a>()) {</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160; </div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a83df276d33a9e23b8ae7dd00db6fd817ac665ee5e2a93b496d0c9dd82b30c4480">CONSTANT_VISCOSITY</a>:</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Viscosity Model: CONSTANT_VISCOSITY  &quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Laminar Viscosity: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a0c3089623173e72c021c745235fdd47d">GetMu_Constant</a>();</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;          <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; N.s/m^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; lbf.s/ft^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Laminar Viscosity (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#ab8374bd6eab3ea2e8c240ab8e702a508">GetMu_ConstantND</a>()&lt;&lt; endl;</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160; </div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a83df276d33a9e23b8ae7dd00db6fd817a0316ed5cbc90bdaf08101ed1aeeae0c8">SUTHERLAND</a>:</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Viscosity Model: SUTHERLAND &quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Ref. Laminar Viscosity: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#aec59768cd9ae76e07db52a62c532a677">GetMu_Ref</a>();</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;          <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; N.s/m^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; lbf.s/ft^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Ref. Temperature: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a048053ffa126a91fc931109042a04fcb">GetMu_Temperature_Ref</a>();</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;          <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; R.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Sutherland Constant: &quot;</span>&lt;&lt; config-&gt;<a class="code" href="class_c_config.html#ab0ded0ff59242b315296a98e136fc080">GetMu_S</a>();</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;          <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; R.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Laminar Viscosity (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#ab8374bd6eab3ea2e8c240ab8e702a508">GetMu_ConstantND</a>()&lt;&lt; endl;</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Ref. Temperature (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a890da0048214096d7fba85048e9336cf">GetMu_Temperature_RefND</a>()&lt;&lt; endl;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Sutherland constant (non-dim): &quot;</span>&lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a206b2d3e5357d3da3dc9686b434f674c">GetMu_SND</a>()&lt;&lt; endl;</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      }</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="keywordflow">switch</span> (config-&gt;<a class="code" href="class_c_config.html#a21815dd5c18f4d1029a1717de952ebea">GetKind_ConductivityModel</a>()) {</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160; </div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a3616aebee98fba744158cf119de2c9e6ada97e16f7fdc7812f37949e2d75cd3b6">CONSTANT_PRANDTL</a>:</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Conductivity Model: CONSTANT_PRANDTL  &quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Prandtl: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a619cb1400d6c944e83ad0ffe82deb021">GetPrandtl_Lam</a>()&lt;&lt; endl;</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160; </div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a3616aebee98fba744158cf119de2c9e6a92f4c6db8015e92cae8263aa01bb3812">CONSTANT_CONDUCTIVITY</a>:</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Conductivity Model: CONSTANT_CONDUCTIVITY &quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Molecular Conductivity: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a4d36c240b8d496897ccbedbd6e4259dc">GetKt_Constant</a>()&lt;&lt; <span class="stringliteral">&quot; W/m^2.K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;          cout &lt;&lt; <span class="stringliteral">&quot;Molecular Conductivity (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a9902362e404162a3aaac7dd6c2c2e895">GetKt_ConstantND</a>()&lt;&lt; endl;</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;      }</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    }</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160; </div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Free-stream static pressure: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a957806325eb8ed6cc4c41e886903f9cf">GetPressure_FreeStream</a>();</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; Pa.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; psf.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Free-stream total pressure: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a957806325eb8ed6cc4c41e886903f9cf">GetPressure_FreeStream</a>() * pow( 1.0+Mach*Mach*0.5*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>-1.0), <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>-1.0) );</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; Pa.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; psf.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160; </div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Free-stream temperature: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a85b0488628cfb289b5413a888fb7cb0c">GetTemperature_FreeStream</a>();</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; R.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160; </div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Free-stream density: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#ae9520958df27678474890ee79980ee24">GetDensity_FreeStream</a>();</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; kg/m^3.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; slug/ft^3.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Free-stream velocity: (&quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      cout &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[1] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    }</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) {</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Free-stream velocity: (&quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;      cout &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">GetVelocity_FreeStream</a>()[2] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;    }</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; m/s. &quot;</span>;</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; ft/s. &quot;</span>;</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160; </div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Magnitude: &quot;</span>   &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a6aa8fe1e4a3b1122be37013d25de9987">GetModVel_FreeStream</a>();</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; m/s.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; ft/s.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160; </div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Free-stream total energy per unit mass: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#aa81b35e9f5a93d058fd02b2b294656db">GetEnergy_FreeStream</a>();</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; m^2/s^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; ft^2/s^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160; </div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keywordflow">if</span> (viscous) {</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Free-stream viscosity: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a6a5600113766e9e2a353f704f2c86351">GetViscosity_FreeStream</a>();</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; N.s/m^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; lbf.s/ft^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;      <span class="keywordflow">if</span> (turbulent) {</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Free-stream turb. kinetic energy per unit mass: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a7db9cd4759eae88ef1a589be622ba9df">GetTke_FreeStream</a>();</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; m^2/s^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; ft^2/s^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Free-stream specific dissipation: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a593225859a0bf4bfd7d9f94a69b3a680">GetOmega_FreeStream</a>();</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;        <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; 1/s.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; 1/s.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;      }</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    }</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160; </div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">if</span> (unsteady) { cout &lt;&lt; <span class="stringliteral">&quot;Total time: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#ade2279cd5e412277dfe4699475c12305">GetTotal_UnstTime</a>() &lt;&lt; <span class="stringliteral">&quot; s. Time step: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#aa9a5ddd6d3f6f56bc21f8a2ec3e7d220">GetDelta_UnstTime</a>() &lt;&lt; <span class="stringliteral">&quot; s.&quot;</span> &lt;&lt; endl; }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160; </div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    <span class="comment">/*--- Print out reference values. ---*/</span></div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160; </div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;    cout &lt;&lt;<span class="stringliteral">&quot;-- Reference values:&quot;</span>&lt;&lt; endl;</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160; </div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Reference specific gas constant: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#aa479f31b4df9dc8825a97c2b46ba14b3">GetGas_Constant_Ref</a>();</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; N.m/kg.K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; lbf.ft/slug.R.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160; </div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Reference pressure: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>();</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; Pa.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; psf.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160; </div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Reference temperature: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>();</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; R.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Reference density: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a8cc3d7d06d995bf315cbed96412a9b7e">GetDensity_Ref</a>();</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; kg/m^3.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; slug/ft^3.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160; </div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Reference velocity: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a8f2c6f68c1e3756237596a7274e713f4">GetVelocity_Ref</a>();</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; m/s.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; ft/s.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Reference energy per unit mass: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a1bdb2d57f337b3d09b7a805ab69763c8">GetEnergy_Ref</a>();</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; m^2/s^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; ft^2/s^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <span class="keywordflow">if</span> (viscous) {</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Reference viscosity: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#adf48507f6200c50ac2e02f0d89bb3b59">GetViscosity_Ref</a>();</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;      <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; N.s/m^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; lbf.s/ft^2.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Reference conductivity: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a17823326106008a63a75524ecc822cf9">GetConductivity_Ref</a>();</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; W/m^2.K.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; lbf/ft.s.R.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    }</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160; </div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160; </div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <span class="keywordflow">if</span> (unsteady) cout &lt;&lt; <span class="stringliteral">&quot;Reference time: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a08a17689e8bcd7b952b530fcb5a44842">GetTime_Ref</a>() &lt;&lt;<span class="stringliteral">&quot; s.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160; </div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;    <span class="comment">/*--- Print out resulting non-dim values here. ---*/</span></div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160; </div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;-- Resulting non-dimensional state:&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Mach number (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a624138f0bb5ee7494459b8e25c5d6287">GetMach</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;    <span class="keywordflow">if</span> (viscous) {</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Reynolds number (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a43d642b59f0e1dae7abd613f337f5cf4">GetReynolds</a>() &lt;&lt;<span class="stringliteral">&quot;. Re length: &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a07e07baa3b8259bfa545fd1de2fac74a">GetLength_Reynolds</a>();</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a>) cout &lt;&lt; <span class="stringliteral">&quot; m.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">GetSystemMeasurements</a>() == <a class="code" href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a>) cout &lt;&lt; <span class="stringliteral">&quot; ft.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    }</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160; </div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Specific gas constant (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Free-stream temperature (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a00454cff9575acd21239959b4030b192">GetTemperature_FreeStreamND</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160; </div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Free-stream pressure (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a59c43ad0ef9a59bc51c2a7e399fea004">GetPressure_FreeStreamND</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160; </div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Free-stream density (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#acc0e8477d26aab6003845d62cb43b0fa">GetDensity_FreeStreamND</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Free-stream velocity (non-dim): (&quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a13840ca712bf87d32d18917d0c39cfae">GetVelocity_FreeStreamND</a>()[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;      cout &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a13840ca712bf87d32d18917d0c39cfae">GetVelocity_FreeStreamND</a>()[1] &lt;&lt; <span class="stringliteral">&quot;). &quot;</span>;</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Free-stream velocity (non-dim): (&quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a13840ca712bf87d32d18917d0c39cfae">GetVelocity_FreeStreamND</a>()[0] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;      cout &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a13840ca712bf87d32d18917d0c39cfae">GetVelocity_FreeStreamND</a>()[1] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a13840ca712bf87d32d18917d0c39cfae">GetVelocity_FreeStreamND</a>()[2] &lt;&lt; <span class="stringliteral">&quot;). &quot;</span>;</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    }</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Magnitude: &quot;</span>    &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a51588bf33cbfbb2866b0b0b9b5133907">GetModVel_FreeStreamND</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Free-stream total energy per unit mass (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a10a3691153903d82aecc25cadcc03917">GetEnergy_FreeStreamND</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160; </div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;    <span class="keywordflow">if</span> (viscous) {</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Free-stream viscosity (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a2ede918fd25217170b85049ddf07408b">GetViscosity_FreeStreamND</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordflow">if</span> (turbulent) {</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Free-stream turb. kinetic energy (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#af782fd344d8cbaac0d99eee409266c35">GetTke_FreeStreamND</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Free-stream specific dissipation (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a9429d355e689d8751b5c229dfd09184a">GetOmega_FreeStreamND</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;      }</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;    }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;    <span class="keywordflow">if</span> (unsteady) {</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Total time (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#acb8a7f20f16f7201b27be06fd765cd9b">GetTotal_UnstTimeND</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Time step (non-dim): &quot;</span> &lt;&lt; config-&gt;<a class="code" href="class_c_config.html#a417b45d0da107126e803258901f57920">GetDelta_UnstTimeND</a>() &lt;&lt; endl;</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    }</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160; </div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;    cout &lt;&lt; endl;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160; </div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;  }</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;}</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160; </div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::DetermineGraphDOFs(<span class="keyword">const</span> <a class="code" href="class_c_mesh_f_e_m.html">CMeshFEM</a> *FEMGeometry,</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;                                             <a class="code" href="class_c_config.html">CConfig</a>        *config) {</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160; </div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;  <span class="comment">/*-------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;  <span class="comment">/* Step 1: Determine the number of owned DOFs per rank in cumulative */</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;  <span class="comment">/*         storage format.                                           */</span></div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;<span class="comment">  /*********************************************************************/</span></div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;  <span class="comment">/*--- Gather the number of DOFs from all ranks. */</span></div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>.resize(<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>+1);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>[0] = 0;</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160; </div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;  <a class="code" href="class_c_base_m_p_i_wrapper.html#a55195abbb7206e08a4933fa53cd41923">SU2_MPI::Allgather</a>(&amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>, 1, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, &amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>[1], 1,</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;                     <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>[1] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160; </div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;  <span class="comment">/*--- Put nDOFsPerRank in cumulative storage format. ---*/</span></div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>; ++i)</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>[i+1] += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>[i];</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160; </div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;  <span class="comment">/*-------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;  <span class="comment">/* Step 2: Determine the global numbering of the DOFs, especially    */</span></div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;  <span class="comment">/*         of the externals.                                         */</span></div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;<span class="comment">  /*********************************************************************/</span></div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160; </div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;  <span class="comment">/* Determine the global values of the locally owned DOFs. */</span></div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;  vector&lt;unsigned long&gt; DOFsGlobalID(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>);</div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i)</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    DOFsGlobalID[i] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>[<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>] + i;</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;  <span class="comment">/*--- Get the communication information from DG_Geometry. Note that for a</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;<span class="comment">        FEM DG discretization the communication entities of FEMGeometry contain</span></div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;<span class="comment">        the volume elements. ---*/</span></div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;  <span class="keyword">const</span> vector&lt;int&gt;                    &amp;ranksSend    = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#aed3107fd85604d7461e62b4d10624744">GetRanksSend</a>();</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;  <span class="keyword">const</span> vector&lt;int&gt;                    &amp;ranksRecv    = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a77083c260f7414aebd965f8acc6b06c2">GetRanksRecv</a>();</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;  <span class="keyword">const</span> vector&lt;vector&lt;unsigned long&gt; &gt; &amp;elementsSend = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a5aad0edfb69733376406772385e3b7b8">GetEntitiesSend</a>();</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;  <span class="keyword">const</span> vector&lt;vector&lt;unsigned long&gt; &gt; &amp;elementsRecv = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a40be25094dbd18e97a336e62f97410b1">GetEntitiesRecv</a>();</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160; </div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160; </div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  <span class="comment">/* Parallel implementation. Allocate the memory for the send buffers and</span></div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;<span class="comment">     loop over the number of ranks to which I have to send data. Note that</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;<span class="comment">     self communication is not excluded here. */</span></div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  vector&lt;vector&lt;unsigned long&gt; &gt; sendBuf;</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;  sendBuf.resize(ranksSend.size());</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160; </div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;  vector&lt;SU2_MPI::Request&gt; sendReqs(ranksSend.size());</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0; i&lt;ranksSend.size(); ++i) {</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160; </div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="comment">/* Fill the send buffer for this rank. */</span></div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsSend[i].size(); ++j) {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = elementsSend[i][j];</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++k) {</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> kk = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k;</div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;        sendBuf[i].push_back(DOFsGlobalID[kk]);</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;      }</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    }</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160; </div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    <span class="comment">/* Send the data using non-blocking sends to avoid deadlock. */</span></div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    <span class="keywordtype">int</span> dest = ranksSend[i];</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a43a415ec11a029ade218eaf8c807a817">SU2_MPI::Isend</a>(sendBuf[i].data(), sendBuf[i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(), <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>,</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;                   dest, dest, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;sendReqs[i]);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;  }</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160; </div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  <span class="comment">/* Create a map of the receive rank to the index in ranksRecv. */</span></div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;  map&lt;int,int&gt; rankToIndRecvBuf;</div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;(int) ranksRecv.size(); ++i)</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    rankToIndRecvBuf[ranksRecv[i]] = i;</div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160; </div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="comment">/* Loop over the number of ranks from which I receive data. */</span></div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksRecv.size(); ++i) {</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160; </div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;    <span class="comment">/* Block until a message arrives and determine the source and size</span></div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;<span class="comment">       of the message. */</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <a class="code" href="struct_c_base_m_p_i_wrapper_1_1_status.html">SU2_MPI::Status</a> status;</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a18215cfe692fc1e82232e155504c1711">SU2_MPI::Probe</a>(<a class="code" href="mpi__structure_8hpp.html#aad01846ca8da972658f74b9affe1d5e8">MPI_ANY_SOURCE</a>, <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;status);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordtype">int</span> source = status.<a class="code" href="struct_c_base_m_p_i_wrapper_1_1_status.html#a0f9345f9774b7ed545340a0bc2b59ef1">MPI_SOURCE</a>;</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160; </div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordtype">int</span> sizeMess;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a2b80feee34755a59d180ab64eb2d712b">SU2_MPI::Get_count</a>(&amp;status, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, &amp;sizeMess);</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160; </div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="comment">/* Allocate the memory for the receive buffer, receive the message</span></div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;<span class="comment">       and determine the actual index of this rank in ranksRecv. */</span></div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    vector&lt;unsigned long&gt; recvBuf(sizeMess);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a2a0cf206352327fc745b3848b8c6d130">SU2_MPI::Recv</a>(recvBuf.data(), sizeMess, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>,</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;                  source, <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;status);</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160; </div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    map&lt;int,int&gt;::const_iterator MI = rankToIndRecvBuf.find(source);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    source = MI-&gt;second;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160; </div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <span class="comment">/* Loop over the receive elements and copy the data for its DOFs in</span></div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;<span class="comment">       DOFsGlobalID. */</span></div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = 0;</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsRecv[source].size(); ++j) {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = elementsRecv[source][j];</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++k, ++ii) {</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> kk = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k;</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;        DOFsGlobalID[kk] = recvBuf[ii];</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;      }</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;    }</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;  }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;  <span class="comment">/* Complete the non-blocking sends. */</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;  <a class="code" href="class_c_base_m_p_i_wrapper.html#a7a83091a6fcdc392a11be74734362eaa">SU2_MPI::Waitall</a>(ranksSend.size(), sendReqs.data(), MPI_STATUSES_IGNORE);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="comment">/* Wild cards have been used in the communication,</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;<span class="comment">     so synchronize the ranks to avoid problems.    */</span></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;  <a class="code" href="class_c_base_m_p_i_wrapper.html#a07f24df31c87ac960540ce8ac2b407d2">SU2_MPI::Barrier</a>(<a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160; </div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; </div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  <span class="comment">/*--- Sequential implementation. Halo&#39;s may be present due to periodic</span></div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;<span class="comment">        boundary conditions. A loop over the receiving ranks is carried out</span></div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;<span class="comment">        to cover both situations, i.e. halo&#39;s present and halo&#39;s not present. ---*/</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksRecv.size(); ++i) {</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsRecv[i].size(); ++j) {</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemR = elementsRecv[i][j];</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemS = elementsSend[i][j];</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160; </div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemR].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++k) {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> kR = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemR].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> kS = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemS].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160; </div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;        DOFsGlobalID[kR] = DOFsGlobalID[kS];</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      }</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    }</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;  }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160; </div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160; </div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="comment">/*-------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;  <span class="comment">/* Step 3: Determine the entries of the graph for the locally stored */</span></div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;  <span class="comment">/*         data. Note that this data must also be determined for the */</span></div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;  <span class="comment">/*         halo DOFs, because the faces between partitions are       */</span></div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  <span class="comment">/*         stored only once.                                         */</span></div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;<span class="comment">  /*********************************************************************/</span></div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <span class="comment">/* Allocate the memory for the first index of nonZeroEntriesJacobian.</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;<span class="comment">     During the construction of this data, also the halo DOFs are needed,</span></div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;<span class="comment">     hence it is allocate for all DOFs stored on this rank. */</span></div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>.resize(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>);</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160; </div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;  <span class="comment">/* The residual of the DOFs of a volume element depends on all the</span></div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;<span class="comment">     DOFs of that volume element. Set these dependencies. Only needed</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;<span class="comment">     for the owned elements. */</span></div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++i) {</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++j) {</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + j;</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++k) {</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> kk = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[jj].push_back(DOFsGlobalID[kk]);</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;      }</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    }</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;  }</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160; </div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;  <span class="comment">/* Loop over the internal matching faces to set the dependencies of the</span></div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;<span class="comment">     DOFs w.r.t. the DOFs of the neighbors. It is assumed that the residual</span></div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;<span class="comment">     of the DOFs depends on all the DOFs of the neighboring elements. This</span></div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;<span class="comment">     is always correct for the Navier-Stokes equations. For the Euler equations</span></div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">     in combination with a lumped mass matrix, this is a conservative</span></div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">     estimate. However, it is also correct when the full mass matrix is used.</span></div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;<span class="comment">     Therefore, this assumption is used here. */</span></div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeLevels = config-&gt;<a class="code" href="class_c_config.html#a957e791919e7c6947131c06aedc7ff8d">GetnLevels_TimeAccurateLTS</a>();</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[nTimeLevels]; ++i) {</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160; </div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="comment">/* Easier storage of the elements on both sides. */</span></div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elem0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elem1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[i].<a class="code" href="class_c_internal_face_element_f_e_m.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160; </div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="comment">/* Double loop over the DOFs of both elements and set the dependencies</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;<span class="comment">       accordingly. */</span></div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++j) {</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + j;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++k) {</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> kk = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k;</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[jj].push_back(DOFsGlobalID[kk]);</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[kk].push_back(DOFsGlobalID[jj]);</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;      }</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    }</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  }</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160; </div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <span class="comment">/*-------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;  <span class="comment">/* Step 4: Carry out the communication for the halo DOFs, such that  */</span></div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="comment">/*         all the graph information is obtained for the owned DOFs. */</span></div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;<span class="comment">  /*********************************************************************/</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160; </div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160; </div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;  <span class="comment">/* Parallel implementation. Allocate the memory for the inverse send buffers</span></div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;<span class="comment">     and loop over the number of ranks to which I have to send data for the</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;<span class="comment">     inverse communication pattern. Note that self communication is not</span></div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;<span class="comment">     excluded here, because efficiency is not really important for this function. */</span></div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;  vector&lt;vector&lt;unsigned long&gt; &gt; invSendBuf;</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  invSendBuf.resize(ranksRecv.size());</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  vector&lt;SU2_MPI::Request&gt; invSendReqs(ranksRecv.size());</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160; </div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0; i&lt;ranksRecv.size(); ++i) {</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160; </div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="comment">/* Fill the inverse send buffer for this rank. */</span></div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsRecv[i].size(); ++j) {</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = elementsRecv[i][j];</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++k) {</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> kk = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k;</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        invSendBuf[i].push_back(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[kk].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>());</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;        invSendBuf[i].insert(invSendBuf[i].end(),</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;                             <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[kk].begin(),</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;                             <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[kk].end());</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;      }</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    }</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160; </div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="comment">/* Send the data using non-blocking sends to avoid deadlock. */</span></div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordtype">int</span> dest = ranksRecv[i];</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a43a415ec11a029ade218eaf8c807a817">SU2_MPI::Isend</a>(invSendBuf[i].data(), invSendBuf[i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(), <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>,</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                   dest, dest+1, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;invSendReqs[i]);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;  }</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160; </div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;  <span class="comment">/* Create a map of the inverse receive (i.e. the original send) rank</span></div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;<span class="comment">     to the index in ranksSend. */</span></div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  map&lt;int,int&gt; rankToIndSendBuf;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0; i&lt;(int) ranksSend.size(); ++i)</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    rankToIndSendBuf[ranksSend[i]] = i;</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;  <span class="comment">/* Loop over the number of ranks from which I receive data</span></div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;<span class="comment">     in the inverse communication. */</span></div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksSend.size(); ++i) {</div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160; </div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="comment">/* Block until a message arrives and determine the source and size</span></div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;<span class="comment">       of the message. */</span></div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    <a class="code" href="struct_c_base_m_p_i_wrapper_1_1_status.html">SU2_MPI::Status</a> status;</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a18215cfe692fc1e82232e155504c1711">SU2_MPI::Probe</a>(<a class="code" href="mpi__structure_8hpp.html#aad01846ca8da972658f74b9affe1d5e8">MPI_ANY_SOURCE</a>, <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>+1, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;status);</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    <span class="keywordtype">int</span> source = status.<a class="code" href="struct_c_base_m_p_i_wrapper_1_1_status.html#a0f9345f9774b7ed545340a0bc2b59ef1">MPI_SOURCE</a>;</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;    <span class="keywordtype">int</span> sizeMess;</div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a2b80feee34755a59d180ab64eb2d712b">SU2_MPI::Get_count</a>(&amp;status, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, &amp;sizeMess);</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="comment">/* Allocate the memory for the receive buffer, receive the message</span></div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="comment">       and determine the actual index of this rank in ranksSend. */</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    vector&lt;unsigned long&gt; recvBuf(sizeMess);</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a2a0cf206352327fc745b3848b8c6d130">SU2_MPI::Recv</a>(recvBuf.data(), sizeMess, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>,</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;                  source, <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>+1, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;status);</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160; </div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    map&lt;int,int&gt;::const_iterator MI = rankToIndSendBuf.find(source);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    source = MI-&gt;second;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160; </div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="comment">/* Loop over the elements for which the data was just received. */</span></div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    <span class="keywordtype">int</span> ii = 0;</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsSend[source].size(); ++j) {</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = elementsSend[source][j];</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160; </div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++k) {</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> kk       = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k;</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nEntries = recvBuf[ii++];</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160; </div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[kk].insert(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[kk].end(),</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;                                          recvBuf.data() + ii,</div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;                                          recvBuf.data() + ii + nEntries);</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        ii += nEntries;</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      }</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    }</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  }</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160; </div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;  <span class="comment">/* Complete the non-blocking sends. */</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;  <a class="code" href="class_c_base_m_p_i_wrapper.html#a7a83091a6fcdc392a11be74734362eaa">SU2_MPI::Waitall</a>(ranksRecv.size(), invSendReqs.data(), MPI_STATUSES_IGNORE);</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160; </div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  <span class="comment">/* Wild cards have been used in the communication,</span></div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;<span class="comment">     so synchronize the ranks to avoid problems.    */</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;  <a class="code" href="class_c_base_m_p_i_wrapper.html#a07f24df31c87ac960540ce8ac2b407d2">SU2_MPI::Barrier</a>(<a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160; </div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;  <span class="comment">/*--- Sequential implementation. Just add the data of the halo DOFs</span></div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;<span class="comment">        to the corresponding owned DOFs. Note that only when periodic</span></div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;<span class="comment">        boundary conditions are present, something will happen. ---*/</span></div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksSend.size(); ++i) {</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsSend[i].size(); ++j) {</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemR = elementsRecv[i][j];</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemS = elementsSend[i][j];</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160; </div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemR].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++k) {</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> kR = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemR].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k;</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> kS = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemS].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k;</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160; </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[kS].insert(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[kS].end(),</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;                                          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[kR].begin(),</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;                                          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[kR].end());</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;      }</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    }</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  }</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160; </div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160; </div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;  <span class="comment">/*-------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <span class="comment">/* Step 5: Sort the entries of nonZeroEntriesJacobian in increasing  */</span></div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <span class="comment">/*         order and remove possible double entries (caused by       */</span></div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;  <span class="comment">/*         periodic boundaries under certain circumstances). Delete  */</span></div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="comment">/*         the memory of the halo data, because it is not needed     */</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <span class="comment">/*         anymore.                                                  */</span></div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;<span class="comment">  /*********************************************************************/</span></div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160; </div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;  <span class="comment">/* Loop over the locally owned DOFs and remove the possible double</span></div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;<span class="comment">     entries. This is accomplished by first sorting the data followed</span></div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;<span class="comment">     by the removal of duplicate entries using the unique function. */</span></div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i) {</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    sort(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i].begin(), <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i].end());</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;    vector&lt;unsigned long&gt;::iterator lastEntry;</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    lastEntry = unique(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i].begin(), <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i].end());</div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i].erase(lastEntry, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i].end());</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;  }</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160; </div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;  <span class="comment">/* Delete the memory of the halo data. To make sure that the memory</span></div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;<span class="comment">     is physically deleted, use the swap function. */</span></div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>; ++i)</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    vector&lt;unsigned long&gt;().swap(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i]);</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;}</div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::MetaDataJacobianComputation(<span class="keyword">const</span> <a class="code" href="class_c_mesh_f_e_m.html">CMeshFEM</a>    *FEMGeometry,</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;                                                      <span class="keyword">const</span> vector&lt;int&gt; &amp;colorLocalDOFs) {</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160; </div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;  <span class="comment">/*--- Part 1: Convert the coloring information of the DOFs to the        ---*/</span></div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="comment">/*---         reverse information, namely the DOFs for each color.       ---*/</span></div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160; </div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;  <span class="comment">/* Determine the locally owned DOFs for each color. */</span></div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#acef8be666e3344d8040644c250579cf4">localDOFsPerColor</a>.resize(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5bda43e6dcef5d4811431f7e24bc6369">nGlobalColors</a>);</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160; </div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#acef8be666e3344d8040644c250579cf4">localDOFsPerColor</a>[colorLocalDOFs[i]].push_back(i);</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; </div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;  <span class="comment">/*--- Part 2: Create the mapping from the global matrix index to the     ---*/</span></div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;  <span class="comment">/*---         color. In parallel this is a bit more work than one might  ---*/</span></div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;  <span class="comment">/*---         think, because the parallel data structures do not store   ---*/</span></div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;  <span class="comment">/*---         all the matrix entities of the local DOFs. Hence, this     ---*/</span></div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;  <span class="comment">/*---         must be reconstructed via communication.                   ---*/</span></div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160; </div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;  <span class="comment">/* Get the send and receive ranks for FEMGeometry. */</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;  <span class="keyword">const</span> vector&lt;int&gt; &amp;ranksSend = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#aed3107fd85604d7461e62b4d10624744">GetRanksSend</a>();</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;  <span class="keyword">const</span> vector&lt;int&gt; &amp;ranksRecv = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a77083c260f7414aebd965f8acc6b06c2">GetRanksRecv</a>();</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160; </div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;  <span class="comment">/* Store the ranks this rank communicates with in a map. These are both</span></div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;<span class="comment">     sending and receiving ranks. Make sure to exclude my own rank. */</span></div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;  map&lt;int,int&gt; rankCommToInd;</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksSend.size(); ++i) {</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;    <span class="keywordflow">if</span>(ranksSend[i] != <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>) {</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> ind = rankCommToInd.size();</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      rankCommToInd[ranksSend[i]] = ind;</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;    }</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;  }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160; </div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksRecv.size(); ++i) {</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    map&lt;int,int&gt;::const_iterator MI = rankCommToInd.find(ranksRecv[i]);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="keywordflow">if</span>((MI == rankCommToInd.end()) &amp;&amp;(ranksRecv[i] != <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>)) {</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> ind = rankCommToInd.size();</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;      rankCommToInd[ranksRecv[i]] = ind;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    }</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;  }</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160; </div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;  <span class="comment">/* Allocate the memory for the first index of the send buffers. */</span></div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;  vector&lt;vector&lt;unsigned long&gt; &gt; sendBuf(rankCommToInd.size(), vector&lt;unsigned long&gt;(0));</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160; </div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;  <span class="comment">/* Define the map from the global matrix index to the color and the set to</span></div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;<span class="comment">     keep track whether an index has already been treated. */</span></div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;  map&lt;unsigned long, int&gt; mapMatrixIndToColor;</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;  set&lt;unsigned long&gt; setTreatedIndices;</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160; </div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;  <span class="comment">/* Loop over the owned DOFs and its matrix entries to create the contents of</span></div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;<span class="comment">     either mapMatrixIndToColor (owned DOFs) or sendBuf (unowned DOFs). */</span></div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i) {</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i].size(); ++j) {</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i][j];</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160; </div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      <span class="comment">/* Check if jj has not been stored yet. */</span></div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;      pair&lt;set&lt;unsigned long&gt;::iterator,<span class="keywordtype">bool</span>&gt; attempt = setTreatedIndices.insert(jj);</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;      <span class="keywordflow">if</span>( attempt.second ) {</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160; </div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;        <span class="comment">/* Determine the rank where this DOF is stored. */</span></div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;        vector&lt;unsigned long&gt;::iterator low;</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;        low = lower_bound(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>.begin(), <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>.end(), jj);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        <span class="keywordtype">int</span> rankDOF = low - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>.begin();</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <span class="keywordflow">if</span>(*low &gt; jj) --rankDOF;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160; </div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;        <span class="comment">/* If rankDOF is the current rank, create the entry in</span></div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;<span class="comment">           mapMatrixIndToColor. Otherwise store jj in the appropriate send</span></div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;<span class="comment">           buffer. */</span></div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        <span class="keywordflow">if</span>(rankDOF == <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>) {</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;          mapMatrixIndToColor[jj] = colorLocalDOFs[jj-<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>[<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>]];</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;        }</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;          map&lt;int,int&gt;::const_iterator MI = rankCommToInd.find(rankDOF);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;          sendBuf[MI-&gt;second].push_back(jj);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;        }</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;      }</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    }</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;  }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160; </div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160; </div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;  <span class="comment">/*--- Loop over the ranks to which this rank has to send data.</span></div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;<span class="comment">        Use non-blocking sends to avoid deadlock. ---*/</span></div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;  vector&lt;SU2_MPI::Request&gt; sendReqs(rankCommToInd.size());</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160; </div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;  map&lt;int,int&gt;::const_iterator MI = rankCommToInd.begin();</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;rankCommToInd.size(); ++i, ++MI) {</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> dest = MI-&gt;first;</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ind  = MI-&gt;second;</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160; </div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a43a415ec11a029ade218eaf8c807a817">SU2_MPI::Isend</a>(sendBuf[ind].data(), sendBuf[ind].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(), <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>,</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;                   dest, dest+2, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;sendReqs[i]);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;  }</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;  <span class="comment">/* Loop over the ranks from which I receive data to be processed. The number</span></div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;<span class="comment">     of ranks is equal to the number of ranks to which I just sent data. */</span></div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  vector&lt;SU2_MPI::Request&gt; sendReturnReqs(rankCommToInd.size());</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  vector&lt;vector&lt;int&gt; &gt; sendReturnBuf(rankCommToInd.size(), vector&lt;int&gt;(0));</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;rankCommToInd.size(); ++i) {</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="comment">/* Block until a message arrives and determine the source and size</span></div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;<span class="comment">       of the message. */</span></div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;    <a class="code" href="struct_c_base_m_p_i_wrapper_1_1_status.html">SU2_MPI::Status</a> status;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a18215cfe692fc1e82232e155504c1711">SU2_MPI::Probe</a>(<a class="code" href="mpi__structure_8hpp.html#aad01846ca8da972658f74b9affe1d5e8">MPI_ANY_SOURCE</a>, <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>+2, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;status);</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;    <span class="keywordtype">int</span> source = status.<a class="code" href="struct_c_base_m_p_i_wrapper_1_1_status.html#a0f9345f9774b7ed545340a0bc2b59ef1">MPI_SOURCE</a>;</div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160; </div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    <span class="keywordtype">int</span> sizeMess;</div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a2b80feee34755a59d180ab64eb2d712b">SU2_MPI::Get_count</a>(&amp;status, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, &amp;sizeMess);</div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160; </div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <span class="comment">/* Allocate the memory for the receive buffer as well as for the</span></div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;<span class="comment">       return send buffer. Receive the message afterwards. */</span></div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    vector&lt;unsigned long&gt; recvBuf(sizeMess);</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    sendReturnBuf[i].resize(sizeMess);</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160; </div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a2a0cf206352327fc745b3848b8c6d130">SU2_MPI::Recv</a>(recvBuf.data(), sizeMess, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>,</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;                  source, <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>+2, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;status);</div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160; </div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;    <span class="comment">/* Loop over the data just received and fill the return send buffer</span></div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;<span class="comment">       with the color of the DOFs. */</span></div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;sizeMess; ++j) {</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = recvBuf[j] - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>[<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>];</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;      <span class="keywordflow">if</span>(jj &gt;= <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>) {</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;This DOF should be owned, but it is not. This should not happen.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        exit(1);</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;      }</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;      sendReturnBuf[i][j] = colorLocalDOFs[jj];</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    }</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160; </div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;    <span class="comment">/* Send the return buffer back to the calling rank. Again use non-blocking</span></div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;<span class="comment">       sends to avoid deadlock. */</span></div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a43a415ec11a029ade218eaf8c807a817">SU2_MPI::Isend</a>(sendReturnBuf[i].data(), sendReturnBuf[i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(), <a class="code" href="mpi__structure_8hpp.html#a43ed7cd86d20f84db849adc64a09415e">MPI_INT</a>,</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;                   source, source+3, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;sendReturnReqs[i]);</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;  }</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; </div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;  <span class="comment">/* Complete the first round of non-blocking sends. */</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;  <a class="code" href="class_c_base_m_p_i_wrapper.html#a7a83091a6fcdc392a11be74734362eaa">SU2_MPI::Waitall</a>(sendReqs.size(), sendReqs.data(), MPI_STATUSES_IGNORE);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;  <span class="comment">/* Loop over the ranks from which I receive the return information. */</span></div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;rankCommToInd.size(); ++i) {</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160; </div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;    <span class="comment">/* Block until a message arrives and determine the source of the message</span></div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160;<span class="comment">       and its index in the original send buffers. */</span></div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <a class="code" href="struct_c_base_m_p_i_wrapper_1_1_status.html">SU2_MPI::Status</a> status;</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a18215cfe692fc1e82232e155504c1711">SU2_MPI::Probe</a>(<a class="code" href="mpi__structure_8hpp.html#aad01846ca8da972658f74b9affe1d5e8">MPI_ANY_SOURCE</a>, <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>+3, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;status);</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <span class="keywordtype">int</span> source = status.<a class="code" href="struct_c_base_m_p_i_wrapper_1_1_status.html#a0f9345f9774b7ed545340a0bc2b59ef1">MPI_SOURCE</a>;</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160; </div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    MI = rankCommToInd.find(source);</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ind = MI-&gt;second;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160; </div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <span class="comment">/* Allocate the memory for the receive buffer and receive the message using</span></div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;<span class="comment">       a blocking receive. */</span></div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    vector&lt;int&gt; recvBuf(sendBuf[ind].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>());</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a2a0cf206352327fc745b3848b8c6d130">SU2_MPI::Recv</a>(recvBuf.data(), recvBuf.size(), <a class="code" href="mpi__structure_8hpp.html#a43ed7cd86d20f84db849adc64a09415e">MPI_INT</a>,</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;                  source, <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>+3, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>, &amp;status);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; </div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <span class="comment">/* Loop over the data just received and add them to the map</span></div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;<span class="comment">       mapMatrixIndToColor .*/</span></div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;sendBuf[ind].size(); ++j)</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;      mapMatrixIndToColor[sendBuf[ind][j]] = recvBuf[j];</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  }</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160; </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <span class="comment">/* Complete the second round of non-blocking sends. */</span></div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;  <a class="code" href="class_c_base_m_p_i_wrapper.html#a7a83091a6fcdc392a11be74734362eaa">SU2_MPI::Waitall</a>(sendReturnReqs.size(), sendReturnReqs.data(), MPI_STATUSES_IGNORE);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="comment">/* Wild cards have been used in the communication,</span></div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;<span class="comment">     so synchronize the ranks to avoid problems.    */</span></div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;  <a class="code" href="class_c_base_m_p_i_wrapper.html#a07f24df31c87ac960540ce8ac2b407d2">SU2_MPI::Barrier</a>(<a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160; </div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;  <span class="comment">/*--- Part 3: For each locally owned DOF it is determined which matrix   ---*/</span></div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;  <span class="comment">/*---         entry is computed for which color. This information is     ---*/</span></div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;  <span class="comment">/*---         stored in the vector of vectors colorToIndEntriesJacobian. ---*/</span></div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160; </div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;  <span class="comment">/* Loop over the ownded DOFs. */</span></div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ada0555d25a6c2b0f0118dcb954169500">colorToIndEntriesJacobian</a>.resize(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>);</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i) {</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160; </div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="comment">/* Initialize the elements of colorToIndEntriesJacobian to -1 to indicate</span></div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;<span class="comment">       that the color does not have a matrix entity . */</span></div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ada0555d25a6c2b0f0118dcb954169500">colorToIndEntriesJacobian</a>[i].assign(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5bda43e6dcef5d4811431f7e24bc6369">nGlobalColors</a>, -1);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="comment">/* Loop over the matrix entries of this DOF. */</span></div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> j=0; j&lt;(int) <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(); ++j) {</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;      <span class="comment">/* Search for the entry in mapMatrixIndToColor and determine the</span></div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;<span class="comment">         color of this entry. */</span></div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;      map&lt;unsigned long, int&gt;::const_iterator MMI;</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;      MMI = mapMatrixIndToColor.find(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i][j]);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;      <span class="keywordflow">if</span>(MMI == mapMatrixIndToColor.end()) {</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;Matrix entry not found in mapMatrixIndToColor.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;        cout &lt;&lt; <span class="stringliteral">&quot;This should not happen.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        exit(1);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;      }</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> color = MMI-&gt;second;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160; </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;      <span class="comment">/* Set the correct information in colorToIndEntriesJacobian. */</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ada0555d25a6c2b0f0118dcb954169500">colorToIndEntriesJacobian</a>[i][color] = j;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;    }</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;  }</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;}</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160; </div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::SetUpTaskList(<a class="code" href="class_c_config.html">CConfig</a> *config) {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160; </div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;  <span class="comment">/* Check whether an ADER space-time step must be carried out.</span></div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;<span class="comment">     When only a spatial Jacobian is computed this is false per definition.  */</span></div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;  <span class="keywordflow">if</span>( (config-&gt;<a class="code" href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">GetKind_TimeIntScheme_Flow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a>) &amp;&amp;</div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;     !(config-&gt;<a class="code" href="class_c_config.html#a9301440279b2cbf0f8ea3c8a83e240e6">GetJacobian_Spatial_Discretization_Only</a>()) ) {</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160; </div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="comment">/* ADER time integration with local time stepping. There are 2^(M-1)      */</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="comment">/* subtime steps, where M is the number of time levels. For each of       */</span></div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    <span class="comment">/* the subtime steps a number of tasks must be carried out, hence the     */</span></div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="comment">/* total list can become rather lengthy.                                  */</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160; </div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;    <span class="comment">/*--- Determine whether or not the predictor solution must be interpolated</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;<span class="comment">          for the time levels on this rank. Make a distinction between owned</span></div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;<span class="comment">          and halo elements. Also determine whether or not boundary conditions</span></div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;<span class="comment">          are present and whether or not these depend on halo data. ---*/</span></div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeLevels = config-&gt;<a class="code" href="class_c_config.html#a957e791919e7c6947131c06aedc7ff8d">GetnLevels_TimeAccurateLTS</a>();</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;    vector&lt;bool&gt; interpolOwnedElem(nTimeLevels, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;    vector&lt;bool&gt; interpolHaloElem(nTimeLevels, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;    vector&lt;bool&gt; BCPresent(nTimeLevels, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;    vector&lt;bool&gt; BCDependOnHalos(nTimeLevels, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160; </div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level=0; level&lt;nTimeLevels; ++level) {</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160; </div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;      <span class="comment">/* First check the boundary conditions. */</span></div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker=0; iMarker&lt;config-&gt;<a class="code" href="class_c_config.html#a300c4884edfc0c2acf395036439004f4">GetnMarker_All</a>(); iMarker++) {</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160; </div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> surfElemBeg = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#ab955ab8e1e78b773c33cc1d1f705d7d4">nSurfElem</a>[level];</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> surfElemEnd = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#ab955ab8e1e78b773c33cc1d1f705d7d4">nSurfElem</a>[level+1];</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        <span class="keywordflow">if</span>(surfElemEnd &gt; surfElemBeg) {</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;          BCPresent[level] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;          <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].haloInfoNeededForBC ) BCDependOnHalos[level] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;        }</div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;      }</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160; </div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;      <span class="comment">/* Determine whether or not the owned elements must be interpolated. */</span></div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level+1] &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level])</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;        interpolOwnedElem[level] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a275680d0b201cfb25fdaaeb9c2ca1d22">nMatchingInternalFacesLocalElem</a>[level+1] &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a275680d0b201cfb25fdaaeb9c2ca1d22">nMatchingInternalFacesLocalElem</a>[level])</div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;       interpolOwnedElem[level] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[level+1] &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[level]) </div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;        interpolOwnedElem[level] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;      <span class="keywordflow">if</span>( BCPresent[level] )</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;        interpolOwnedElem[level] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160; </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;      <span class="comment">/* Determine whether or not the halo elements must be interpolated. */</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[level+1] &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[level])</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;        interpolHaloElem[level] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      <span class="keywordflow">if</span>( BCDependOnHalos[level] )</div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        interpolHaloElem[level] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    }</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160; </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="comment">/* Determine the number of subtime steps and abbreviate the number of</span></div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;<span class="comment">       time integration points a bit easier.  */</span></div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>   nSubTimeSteps          = pow(2,nTimeLevels-1);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeIntegrationPoints = config-&gt;<a class="code" href="class_c_config.html#ae7e9d4b942d0db4b72f461c180ade3a4">GetnTimeIntegrationADER_DG</a>();</div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160; </div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <span class="comment">/* Define the two dimensional vector to store the latest index for a</span></div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;<span class="comment">       certain task for every time level. */</span></div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    vector&lt;vector&lt;int&gt; &gt; indexInList(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a488a3ac4df1541941741ed605e6b7121">CTaskDefinition::ADER_UPDATE_SOLUTION</a>+1,</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;                                     vector&lt;int&gt;(nTimeLevels, -1));</div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160; </div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <span class="comment">/* Loop over the number of subtime steps in the algorithm. */</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> step=0; step&lt;nSubTimeSteps; ++step) {</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160; </div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;      <span class="comment">/* Determine the time level for which an update must be carried out</span></div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;<span class="comment">         for this step. */</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = step+1;</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = 0;</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      <span class="keywordflow">while</span>( !(ii%2) ) {ii/=2; ++timeLevel;}</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;      <span class="comment">/* Definition of the variable to store previous indices of</span></div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;<span class="comment">         tasks that must have been completed. */</span></div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;      <span class="keywordtype">int</span> prevInd[5];</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160; </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;      <span class="comment">/* Carry out the predictor step of the communication elements of level 0</span></div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;<span class="comment">         if these elements are present on this rank. */</span></div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[0]</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                            + <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7f54ebf747f54031baaa79339ff5503f">nVolElemInternalPerTimeLevel</a>[0];</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[1];</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;      <span class="keywordflow">if</span>(elemEnd &gt; elemBeg) {</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a488a3ac4df1541941741ed605e6b7121">CTaskDefinition::ADER_UPDATE_SOLUTION</a>][0];</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a>][0] = tasksList.size();</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a>, 0, prevInd[0]));</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;      }</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160; </div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;      <span class="comment">/* Initiate the communication of elements of level 0, if there is</span></div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;<span class="comment">         something to be communicated. */</span></div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;      <span class="keywordflow">if</span>( commRequests[0].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() ) {</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <span class="keywordflow">if</span>(elemEnd &gt; elemBeg)   <span class="comment">// Data needs to be computed before sending.</span></div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;          prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a>][0];</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        <span class="keywordflow">else</span>                    <span class="comment">// Data only needs to be received.</span></div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;          prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a8d40e9069e07e9a58bfaebe57d05bbbd">CTaskDefinition::ADER_TIME_INTERPOLATE_HALO_ELEMENTS</a>][0];</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160; </div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;        <span class="comment">/* Make sure that any previous communication has been completed. */</span></div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aecf3a269d02eb493020bceecf4262415">CTaskDefinition::COMPLETE_REVERSE_MPI_COMMUNICATION</a>][0];</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;        <span class="comment">/* Create the task. */</span></div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;        indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a38b0ce8cd837938d82de2e50ec9e2a2a">CTaskDefinition::INITIATE_MPI_COMMUNICATION</a>][0] = tasksList.size();</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;        tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a38b0ce8cd837938d82de2e50ec9e2a2a">CTaskDefinition::INITIATE_MPI_COMMUNICATION</a>, 0,</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                                            prevInd[0], prevInd[1]));</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;      }</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160; </div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;      <span class="comment">/* Check if the time level is not nTimeLevels-1. In that case carry out</span></div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;<span class="comment">         the predictor step of the communication elements for the next time</span></div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">         level and initiate their communication, if appropriate on this rank. */</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      <span class="keywordflow">if</span>(timeLevel &lt; (nTimeLevels-1)) {</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nL = timeLevel+1;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160; </div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <span class="comment">/* Carry out the predictor step of the communication elements of level nL</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;<span class="comment">           if these elements are present on this rank. */</span></div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;        elemBeg = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[nL] + <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7f54ebf747f54031baaa79339ff5503f">nVolElemInternalPerTimeLevel</a>[nL];</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;        elemEnd = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[nL+1];</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160; </div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        <span class="keywordflow">if</span>(elemEnd &gt; elemBeg) {</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;          prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a488a3ac4df1541941741ed605e6b7121">CTaskDefinition::ADER_UPDATE_SOLUTION</a>][nL];</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;          indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a>][nL] = tasksList.size();</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;          tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a>, nL, prevInd[0]));</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        }</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="comment">/* Initiate the communication of elements of level nL, if there is</span></div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;<span class="comment">           something to be communicated. */</span></div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;        <span class="keywordflow">if</span>( commRequests[nL].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() ) {</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;          <span class="keywordflow">if</span>(elemEnd &gt; elemBeg)   <span class="comment">// Data needs to be computed before sending.</span></div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;            prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a>][nL];</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;          <span class="keywordflow">else</span>                    <span class="comment">// Data only needs to be received.</span></div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;            prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a8d40e9069e07e9a58bfaebe57d05bbbd">CTaskDefinition::ADER_TIME_INTERPOLATE_HALO_ELEMENTS</a>][nL];</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160; </div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;          <span class="comment">/* Make sure that any previous communication has been completed. */</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;          prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aecf3a269d02eb493020bceecf4262415">CTaskDefinition::COMPLETE_REVERSE_MPI_COMMUNICATION</a>][nL];</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160; </div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;          <span class="comment">/* Create the actual task. */</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;          indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a38b0ce8cd837938d82de2e50ec9e2a2a">CTaskDefinition::INITIATE_MPI_COMMUNICATION</a>][nL] = tasksList.size();</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;          tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a38b0ce8cd837938d82de2e50ec9e2a2a">CTaskDefinition::INITIATE_MPI_COMMUNICATION</a>, nL,</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;                                              prevInd[0], prevInd[1]));</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        }</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;      }</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160; </div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;      <span class="comment">/* Carry out the predictor step of the internal elements of time level 0,</span></div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;<span class="comment">         if these elements are present on this rank. */</span></div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;      elemBeg = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[0];</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;      elemEnd = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[0] + <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7f54ebf747f54031baaa79339ff5503f">nVolElemInternalPerTimeLevel</a>[0];</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160; </div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;      <span class="keywordflow">if</span>(elemEnd &gt; elemBeg) {</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;        prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a488a3ac4df1541941741ed605e6b7121">CTaskDefinition::ADER_UPDATE_SOLUTION</a>][0];</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a36f92d9c7d2f67190ce5da2cc0dfb885">CTaskDefinition::ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS</a>][0] = tasksList.size();</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;        tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a36f92d9c7d2f67190ce5da2cc0dfb885">CTaskDefinition::ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS</a>, 0, prevInd[0]));</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      }</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160; </div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;      <span class="comment">/* Determine the tasks to be completed before the communication of time</span></div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;<span class="comment">         level 0 can be completed. */</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;      prevInd[0] = prevInd[1] = prevInd[2] = -1;</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;      <span class="keywordflow">if</span>( commRequests[0].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() )</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;        prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a38b0ce8cd837938d82de2e50ec9e2a2a">CTaskDefinition::INITIATE_MPI_COMMUNICATION</a>][0];</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      <span class="keywordflow">if</span>( elementsSendSelfComm[0].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() ) {</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a>][0];</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        prevInd[2] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a36f92d9c7d2f67190ce5da2cc0dfb885">CTaskDefinition::ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS</a>][0];</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      }</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160; </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;      <span class="comment">/* Make sure that the -1 in prevInd, if any, are numbered last. */</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;      sort(prevInd, prevInd+3, greater&lt;int&gt;());</div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160; </div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;      <span class="comment">/* Complete the communication of time level 0, if there is something</span></div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;<span class="comment">         to be completed. */</span></div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;      <span class="keywordflow">if</span>(prevInd[0] &gt; -1) {</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a7c76da9a0dfec35be76a43ae8c059c9e">CTaskDefinition::COMPLETE_MPI_COMMUNICATION</a>][0] = tasksList.size();</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a7c76da9a0dfec35be76a43ae8c059c9e">CTaskDefinition::COMPLETE_MPI_COMMUNICATION</a>, 0,</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;                                            prevInd[0], prevInd[1], prevInd[2]));</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;      }</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160; </div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;      <span class="comment">/* Check if the time level is not nTimeLevels-1. In that case carry out</span></div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;<span class="comment">         the predictor step of the internal elements for the next time</span></div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;<span class="comment">         level and complete the communication for this time level,</span></div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment">         if appropriate on this rank. */</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;      <span class="keywordflow">if</span>(timeLevel &lt; (nTimeLevels-1)) {</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nL = timeLevel+1;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;        <span class="comment">/* Carry out the predictor step of the internal elements of level nL</span></div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;<span class="comment">           if these elements are present on this rank. */</span></div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        elemBeg = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[nL];</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        elemEnd = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[nL] + <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7f54ebf747f54031baaa79339ff5503f">nVolElemInternalPerTimeLevel</a>[nL];</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160; </div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        <span class="keywordflow">if</span>(elemEnd &gt; elemBeg) {</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;          prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a488a3ac4df1541941741ed605e6b7121">CTaskDefinition::ADER_UPDATE_SOLUTION</a>][nL];</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;          indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a36f92d9c7d2f67190ce5da2cc0dfb885">CTaskDefinition::ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS</a>][nL] = tasksList.size();</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;          tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a36f92d9c7d2f67190ce5da2cc0dfb885">CTaskDefinition::ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS</a>, nL, prevInd[0]));</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        }</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160; </div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        <span class="comment">/* Determine the tasks to be completed before the communication of time</span></div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;<span class="comment">           level nL can be completed. */</span></div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;        prevInd[0] = prevInd[1] = prevInd[2] = -1;</div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        <span class="keywordflow">if</span>( commRequests[nL].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() )</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;          prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a38b0ce8cd837938d82de2e50ec9e2a2a">CTaskDefinition::INITIATE_MPI_COMMUNICATION</a>][nL];</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160; </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;        <span class="keywordflow">if</span>( elementsSendSelfComm[nL].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() ) {</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;          prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a>][nL];</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;          prevInd[2] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a36f92d9c7d2f67190ce5da2cc0dfb885">CTaskDefinition::ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS</a>][nL];</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        }</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160; </div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        <span class="comment">/* Make sure that the -1 in prevInd, if any, are numbered last. */</span></div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        sort(prevInd, prevInd+3, greater&lt;int&gt;());</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160; </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        <span class="comment">/* Complete the communication of time level nL, if there is something</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;<span class="comment">           to be completed. */</span></div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;        <span class="keywordflow">if</span>(prevInd[0] &gt; -1) {</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;          indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a7c76da9a0dfec35be76a43ae8c059c9e">CTaskDefinition::COMPLETE_MPI_COMMUNICATION</a>][nL] = tasksList.size();</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;          tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a7c76da9a0dfec35be76a43ae8c059c9e">CTaskDefinition::COMPLETE_MPI_COMMUNICATION</a>, nL,</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;                                              prevInd[0], prevInd[1], prevInd[2]));</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        }</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;      }</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;      <span class="comment">/* Loop over the time integration points to compute the space time</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;<span class="comment">         integral for the corrector step. */</span></div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> intPoint=0; intPoint&lt;nTimeIntegrationPoints; ++intPoint) {</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160; </div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        <span class="comment">/* Loop over the time levels to be treated. */</span></div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level=0; level&lt;=timeLevel; ++level) {</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160; </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;          <span class="comment">/* Easier storage of the number of owned elements for this level</span></div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;<span class="comment">             and the number of owned elements of the adjacent time level</span></div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;<span class="comment">             that are needed for the computation of the surface integral. */</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nOwnedElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level+1]</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;                                   - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level];</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160; </div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nAdjOwnedElem = 0;</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;          <span class="keywordflow">if</span>(level &lt; (nTimeLevels-1))</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;            nAdjOwnedElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad1f55a7f9d7d977e9dbae3182131673f">ownedElemAdjLowTimeLevel</a>[level+1].size();</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160; </div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;          <span class="comment">/* Check if the solution of the owned elements of the current time</span></div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;<span class="comment">             level and the adjacent owned elements of the next time level must</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;<span class="comment">             be interpolated to the integration point intPoint. */</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;          <span class="keywordflow">if</span>( interpolOwnedElem[level] ) {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160; </div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            <span class="comment">/* Determine the tasks that should have been completed before this</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;<span class="comment">               task can be carried out. This depends on the time integration</span></div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment">               point. */</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;            <span class="keywordflow">if</span>(intPoint == 0) {</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160; </div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;              <span class="comment">/* First time integration point. The predictor steps of the</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;<span class="comment">                 owned elements must have been completed before this task</span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment">                 can be carried out. */</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;              <span class="keywordflow">if</span>( nOwnedElem ) {</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;                prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;                prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a36f92d9c7d2f67190ce5da2cc0dfb885">CTaskDefinition::ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;              }</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;              <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;                prevInd[0] = prevInd[1] = -1;</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;              }</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;              <span class="keywordflow">if</span>( nAdjOwnedElem ) {</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;                prevInd[2] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a>][level+1];</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;                prevInd[3] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a36f92d9c7d2f67190ce5da2cc0dfb885">CTaskDefinition::ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS</a>][level+1];</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;              }</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;              <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                prevInd[2] = prevInd[3] = -1;</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;              }</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;              prevInd[4] = -1;</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            }</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160; </div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;              <span class="comment">/* Not the first integration point. The residual computations of</span></div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;<span class="comment">                 the previous integration point must have been completed, because</span></div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;<span class="comment">                 the solution in the work vectors is overwritten. */</span></div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;              prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74af3eb9ac3d402c19dc3d270edff6625aa">CTaskDefinition::VOLUME_RESIDUAL</a>][level];</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;              prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a173b606ca522e3ac4103f4e43311e082">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_OWNED</a>][level];</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;              prevInd[2] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac997ca4b8d79ba7a41fb51cb53c8458">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_HALO</a>][level];</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;              prevInd[3] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aa5a84198558a8415e59d8179c9f9086b">CTaskDefinition::SURFACE_RESIDUAL_HALO_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;              prevInd[4] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a4f83604f71f03a0535dbc845096bcfec">CTaskDefinition::SURFACE_RESIDUAL_OWNED_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;            }</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;            <span class="comment">/* Create the task. */</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;            indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ad0d58281f452d4daa9507dd35d948f3b">CTaskDefinition::ADER_TIME_INTERPOLATE_OWNED_ELEMENTS</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ad0d58281f452d4daa9507dd35d948f3b">CTaskDefinition::ADER_TIME_INTERPOLATE_OWNED_ELEMENTS</a>,</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;                                                level, prevInd[0], prevInd[1], prevInd[2], prevInd[3], prevInd[4]));</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160; </div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;            <span class="comment">/* The info on the integration point and whether or not this</span></div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;<span class="comment">               time integration corresponds to the second part for the</span></div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;<span class="comment">               adjacent elements must be added to the task just created. */</span></div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;            tasksList.back().intPointADER          = intPoint;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;            tasksList.back().secondPartTimeIntADER = level &lt; timeLevel;</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;            <span class="comment">/* If artificial viscosity is used for the shock capturing</span></div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;<span class="comment">               terms, these terms must be computed for the owned elements,</span></div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;<span class="comment">               including the adjacent ones. */</span></div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;            prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ad0d58281f452d4daa9507dd35d948f3b">CTaskDefinition::ADER_TIME_INTERPOLATE_OWNED_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;            indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9f1a6175c942a7aab7fe961d7b144779">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_OWNED_ELEMENTS</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;            tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9f1a6175c942a7aab7fe961d7b144779">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_OWNED_ELEMENTS</a>,</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;                                                level, prevInd[0]));</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;          }</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160; </div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;          <span class="comment">/* The solution of the halo elements of the current time level and</span></div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;<span class="comment">             the adjacent halo elements of the next time level must be</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;<span class="comment">             interpolated to the integration point intPoint. Check if these</span></div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;<span class="comment">             elements are present. */</span></div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;          <span class="keywordflow">if</span>( interpolHaloElem[level] ) {</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160; </div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nAdjHaloElem = 0;</div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;            <span class="keywordflow">if</span>(level &lt; (nTimeLevels-1))</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;              nAdjHaloElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4856180300943d0a34620292be9fb44c">haloElemAdjLowTimeLevel</a>[level+1].size();</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160; </div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;            <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nHaloElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[level+1]</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;                                    - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[level];</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160; </div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;            <span class="comment">/* Determine the tasks that should have been completed before this</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;<span class="comment">               task can be carried out. This depends on the time integration</span></div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;<span class="comment">               point. */</span></div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;            <span class="keywordflow">if</span>(intPoint == 0) {</div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160; </div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;              <span class="comment">/* First time integration point. The communication of the</span></div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;<span class="comment">                 halo elements must have been completed before this task</span></div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;<span class="comment">                 can be carried out. */</span></div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;             <span class="keywordflow">if</span>( nHaloElem )</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;               prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a7c76da9a0dfec35be76a43ae8c059c9e">CTaskDefinition::COMPLETE_MPI_COMMUNICATION</a>][level];</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;             <span class="keywordflow">else</span></div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;               prevInd[0] = -1;</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160; </div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;             <span class="keywordflow">if</span>( nAdjHaloElem )</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;               prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a7c76da9a0dfec35be76a43ae8c059c9e">CTaskDefinition::COMPLETE_MPI_COMMUNICATION</a>][level+1];</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;             <span class="keywordflow">else</span></div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;               prevInd[1] = -1;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;            <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160; </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;              <span class="comment">/* Not the first integration point. The residual computation of</span></div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;<span class="comment">                 the previous integration point must have been completed, because</span></div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;<span class="comment">                 the solution in the work vectors is overwritten. */</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;              prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aa5a84198558a8415e59d8179c9f9086b">CTaskDefinition::SURFACE_RESIDUAL_HALO_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;              prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac997ca4b8d79ba7a41fb51cb53c8458">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_HALO</a>][level];</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;            }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160; </div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;            <span class="comment">/* Create the task. */</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;            indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a8d40e9069e07e9a58bfaebe57d05bbbd">CTaskDefinition::ADER_TIME_INTERPOLATE_HALO_ELEMENTS</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;            tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a8d40e9069e07e9a58bfaebe57d05bbbd">CTaskDefinition::ADER_TIME_INTERPOLATE_HALO_ELEMENTS</a>,</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;                                                level, prevInd[0], prevInd[1]));</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160; </div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;            <span class="comment">/* The info on the integration point and whether or not this</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">               time integration corresponds to the second part for the</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">               adjacent elements must be added to the task just created. */</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;            tasksList.back().intPointADER          = intPoint;</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;            tasksList.back().secondPartTimeIntADER = level &lt; timeLevel;</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160; </div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;            <span class="comment">/* If artificial viscosity is used for the shock capturing</span></div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;<span class="comment">               terms, these terms must be computed for the halo elements,</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;<span class="comment">               including the adjacent ones. */</span></div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;            prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a8d40e9069e07e9a58bfaebe57d05bbbd">CTaskDefinition::ADER_TIME_INTERPOLATE_HALO_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;            indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9e8d6353cb1f2eba954d362e17be57c0">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_HALO_ELEMENTS</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9e8d6353cb1f2eba954d362e17be57c0">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_HALO_ELEMENTS</a>,</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                                                level, prevInd[0]));</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;          }</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160; </div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;          <span class="comment">/* Check whether there are boundary conditions that involve halo elements. */</span></div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;          <span class="keywordflow">if</span>( BCDependOnHalos[level] ) {</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160; </div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;            <span class="comment">/* Create the dependency list for this task. */</span></div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;            prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9f1a6175c942a7aab7fe961d7b144779">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_OWNED_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;            prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9e8d6353cb1f2eba954d362e17be57c0">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_HALO_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160; </div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;            <span class="comment">/* Create the task for the boundary conditions that involve halo elements. */</span></div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;            indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac997ca4b8d79ba7a41fb51cb53c8458">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_HALO</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac997ca4b8d79ba7a41fb51cb53c8458">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_HALO</a>,</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;                                                level, prevInd[0], prevInd[1]));</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;          }</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160; </div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;          <span class="comment">/* Compute the surface residuals for this time level that involve</span></div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;<span class="comment">             halo elements, if present. Afterwards, accumulate the space time</span></div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="comment">             residuals for the halo elements. */</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;          <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[level+1] &gt;</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;             <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[level]) {</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160; </div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;            <span class="comment">/* Create the dependencies for the surface residual part that involve</span></div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="comment">               halo elements. For all but the first integration point, make sure</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;<span class="comment">               that the previous residual is already accumulated, because this</span></div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;<span class="comment">               task will overwrite that residual. */</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;            prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9f1a6175c942a7aab7fe961d7b144779">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_OWNED_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9e8d6353cb1f2eba954d362e17be57c0">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_HALO_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;            <span class="keywordflow">if</span>(intPoint == 0)</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;              prevInd[2] = -1;</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;              prevInd[2] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a3bfecd203c9e27daa248a223ab8fa3cb">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_HALO_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160; </div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;            <span class="comment">/* Create the task for the surface residual. */</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;            indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aa5a84198558a8415e59d8179c9f9086b">CTaskDefinition::SURFACE_RESIDUAL_HALO_ELEMENTS</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aa5a84198558a8415e59d8179c9f9086b">CTaskDefinition::SURFACE_RESIDUAL_HALO_ELEMENTS</a>,</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                                                level, prevInd[0], prevInd[1], prevInd[2]));</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160; </div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;            <span class="comment">/* Create the task to accumulate the surface residuals of the halo</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;<span class="comment">               elements. Make sure to set the integration point for this task. */</span></div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;            prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aa5a84198558a8415e59d8179c9f9086b">CTaskDefinition::SURFACE_RESIDUAL_HALO_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;            indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a3bfecd203c9e27daa248a223ab8fa3cb">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_HALO_ELEMENTS</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;            tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a3bfecd203c9e27daa248a223ab8fa3cb">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_HALO_ELEMENTS</a>,</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                                                level, prevInd[0]));</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;            tasksList.back().intPointADER = intPoint;</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;          }</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160; </div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;          <span class="comment">/* If this is the last integration point, initiate the reverse</span></div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;<span class="comment">             communication for the residuals of this time level, if there</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">             is something to communicate. */</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;          <span class="keywordflow">if</span>(intPoint == (nTimeIntegrationPoints-1)) {</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160; </div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;            <span class="comment">/* Check if there is something to communicate. Despite the fact</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;<span class="comment">               that self communication takes place when the reverse communication</span></div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;<span class="comment">               is completed, a check for self communication is still needed,</span></div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;<span class="comment">               because of the periodic transformations. */</span></div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;            <span class="keywordtype">bool</span> commData = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;            <span class="keywordflow">if</span>( commRequests[level].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() ) commData = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;            <span class="keywordflow">if</span>(commData || elementsSendSelfComm[level].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>()) {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160; </div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;              <span class="comment">/* Determine the dependencies before the reverse communication</span></div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;<span class="comment">                 can start. */</span></div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;              prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a3bfecd203c9e27daa248a223ab8fa3cb">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_HALO_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;              <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4856180300943d0a34620292be9fb44c">haloElemAdjLowTimeLevel</a>[level].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() )</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;                prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a3bfecd203c9e27daa248a223ab8fa3cb">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_HALO_ELEMENTS</a>][level-1];</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;                prevInd[1] = -1;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160; </div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;              prevInd[2] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a7c76da9a0dfec35be76a43ae8c059c9e">CTaskDefinition::COMPLETE_MPI_COMMUNICATION</a>][level];</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;              <span class="comment">/* Create the task. */</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;              indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a223498245ffb57eb996c758cb9bcff43">CTaskDefinition::INITIATE_REVERSE_MPI_COMMUNICATION</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;              tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a223498245ffb57eb996c758cb9bcff43">CTaskDefinition::INITIATE_REVERSE_MPI_COMMUNICATION</a>,</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;                                                  level, prevInd[0], prevInd[1], prevInd[2]));</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;            }</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;          }</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;          <span class="comment">/* Compute the contribution of the volume integral, boundary conditions that only</span></div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;<span class="comment">             involve owned elements and surface integral between owned elements for this</span></div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;<span class="comment">             time level, if present. */</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;          <span class="keywordflow">if</span>( nOwnedElem ) {</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160; </div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;            <span class="comment">/* Create the dependencies for this task. The shock capturing viscosity of</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;<span class="comment">               the owned elements must be completed and for all integration points but</span></div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;<span class="comment">               the first, the computed residuals must have been accumulated in the space</span></div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;<span class="comment">               time residual, because the tasks below will overwrite the residuals. */</span></div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9f1a6175c942a7aab7fe961d7b144779">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_OWNED_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;            <span class="keywordflow">if</span>(intPoint == 0)</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;              prevInd[1] = -1;</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;              prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ae7a15d8f6916cb075308fdf330f8d7cd">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160; </div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;            <span class="comment">/* Create the tasks. */</span></div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;            indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74af3eb9ac3d402c19dc3d270edff6625aa">CTaskDefinition::VOLUME_RESIDUAL</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;            tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74af3eb9ac3d402c19dc3d270edff6625aa">CTaskDefinition::VOLUME_RESIDUAL</a>, level,</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;                                                prevInd[0], prevInd[1]));</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160; </div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;            indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a173b606ca522e3ac4103f4e43311e082">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_OWNED</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a173b606ca522e3ac4103f4e43311e082">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_OWNED</a>, level,</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;                                                prevInd[0], prevInd[1]));</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160; </div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;            <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a275680d0b201cfb25fdaaeb9c2ca1d22">nMatchingInternalFacesLocalElem</a>[level+1] &gt;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;               <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a275680d0b201cfb25fdaaeb9c2ca1d22">nMatchingInternalFacesLocalElem</a>[level]) {</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;              indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a4f83604f71f03a0535dbc845096bcfec">CTaskDefinition::SURFACE_RESIDUAL_OWNED_ELEMENTS</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;              tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a4f83604f71f03a0535dbc845096bcfec">CTaskDefinition::SURFACE_RESIDUAL_OWNED_ELEMENTS</a>,</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                                                  level, prevInd[0], prevInd[1]));</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;            }</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;          }</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160; </div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;          <span class="comment">/* Accumulate the space time residuals for the owned elements of this</span></div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;<span class="comment">             level, if these elements are present. */</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;          <span class="keywordflow">if</span>(nAdjOwnedElem || nOwnedElem) {</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160; </div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            <span class="comment">/* Create the dependencies for this task. */</span></div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;            prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74af3eb9ac3d402c19dc3d270edff6625aa">CTaskDefinition::VOLUME_RESIDUAL</a>][level];</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;            prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a173b606ca522e3ac4103f4e43311e082">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_OWNED</a>][level];</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;            prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac997ca4b8d79ba7a41fb51cb53c8458">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_HALO</a>][level];</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;            prevInd[3] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a4f83604f71f03a0535dbc845096bcfec">CTaskDefinition::SURFACE_RESIDUAL_OWNED_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;            prevInd[4] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aa5a84198558a8415e59d8179c9f9086b">CTaskDefinition::SURFACE_RESIDUAL_HALO_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160; </div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            <span class="comment">/* Create the task. */</span></div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;            indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ae7a15d8f6916cb075308fdf330f8d7cd">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;            tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ae7a15d8f6916cb075308fdf330f8d7cd">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS</a>,</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                                                level, prevInd[0], prevInd[1], prevInd[2], prevInd[3], prevInd[4]));</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;            tasksList.back().intPointADER = intPoint;</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;          }</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160; </div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;          <span class="comment">/* If this is the last integration point, complete the reverse</span></div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;<span class="comment">             communication for the residuals of this time level, if there</span></div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;<span class="comment">             is something to communicate. */</span></div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;          <span class="keywordflow">if</span>(intPoint == (nTimeIntegrationPoints-1)) {</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160; </div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;            <span class="keywordtype">bool</span> commData = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160; </div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            <span class="keywordflow">if</span>( commRequests[level].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() ) commData = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            <span class="keywordflow">if</span>(commData || elementsSendSelfComm[level].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>()) {</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160; </div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;              <span class="comment">/* Determine the dependencies before the reverse communication</span></div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;<span class="comment">                 can be completed. */</span></div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;              prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a223498245ffb57eb996c758cb9bcff43">CTaskDefinition::INITIATE_REVERSE_MPI_COMMUNICATION</a>][level];</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;              prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ae7a15d8f6916cb075308fdf330f8d7cd">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;              <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad1f55a7f9d7d977e9dbae3182131673f">ownedElemAdjLowTimeLevel</a>[level].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() )</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;                prevInd[2] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ae7a15d8f6916cb075308fdf330f8d7cd">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS</a>][level-1];</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;              <span class="keywordflow">else</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;                prevInd[2] = -1;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160; </div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;              <span class="comment">/* Create the task. */</span></div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;              indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aecf3a269d02eb493020bceecf4262415">CTaskDefinition::COMPLETE_REVERSE_MPI_COMMUNICATION</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;              tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aecf3a269d02eb493020bceecf4262415">CTaskDefinition::COMPLETE_REVERSE_MPI_COMMUNICATION</a>,</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                                                  level, prevInd[0], prevInd[1], prevInd[2]));</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;            }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;          }</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160; </div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;        } <span class="comment">/* End loop time level. */</span></div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160; </div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;      } <span class="comment">/* End loop time integration points. */</span></div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160; </div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;      <span class="comment">/* Loop again over the number of active time levels for this subtime</span></div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;<span class="comment">         step and compute the update for the DOFs of the owned elements. */</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level=0; level&lt;=timeLevel; ++level) {</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level+1] &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level]) {</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; </div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;          <span class="comment">/* Updates must be carried out for this time level. First multiply the</span></div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;<span class="comment">             residuals by the inverse of the mass matrix. This task can be</span></div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">             completed if the communication of this level has been completed.</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;<span class="comment">             However, it is possible that no communication is needed and</span></div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;<span class="comment">             therefore the accumulation of the space time residuals is also</span></div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;<span class="comment">             added to the dependency list. */</span></div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;          prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aecf3a269d02eb493020bceecf4262415">CTaskDefinition::COMPLETE_REVERSE_MPI_COMMUNICATION</a>][level];</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;          prevInd[1] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ae7a15d8f6916cb075308fdf330f8d7cd">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS</a>][level];</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;          <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad1f55a7f9d7d977e9dbae3182131673f">ownedElemAdjLowTimeLevel</a>[level].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() )</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;            prevInd[2] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ae7a15d8f6916cb075308fdf330f8d7cd">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS</a>][level-1];</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;          <span class="keywordflow">else</span></div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;            prevInd[2] = -1;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160; </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;          indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74adde810be8601e9a6ee25b90abc35fbf1">CTaskDefinition::MULTIPLY_INVERSE_MASS_MATRIX</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;          tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74adde810be8601e9a6ee25b90abc35fbf1">CTaskDefinition::MULTIPLY_INVERSE_MASS_MATRIX</a>,</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                                               level, prevInd[0], prevInd[1], prevInd[2]));</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160; </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;          <span class="comment">/* Compute the new state vector for this time level. */</span></div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;          prevInd[0] = indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74adde810be8601e9a6ee25b90abc35fbf1">CTaskDefinition::MULTIPLY_INVERSE_MASS_MATRIX</a>][level];</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;          indexInList[<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a488a3ac4df1541941741ed605e6b7121">CTaskDefinition::ADER_UPDATE_SOLUTION</a>][level] = tasksList.size();</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;          tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a488a3ac4df1541941741ed605e6b7121">CTaskDefinition::ADER_UPDATE_SOLUTION</a>,</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;                                               level, prevInd[0]));</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;        }</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;      }</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;    } <span class="comment">/* End loop subtime steps. */</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160; </div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160; </div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;    <span class="comment">// EXTRA FOR DEBUGGING</span></div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;<span class="comment">/*  for(int i=0; i&lt;size; ++i) {</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="comment">      if(i == rank) {</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;<span class="comment">        cout &lt;&lt; endl;</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;<span class="comment">        cout &lt;&lt; &quot;Task list for rank &quot; &lt;&lt; rank &lt;&lt; endl;</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="comment">        cout &lt;&lt; &quot;------------------------------------------------&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;<span class="comment">        cout &lt;&lt; &quot;Number of tasks: &quot; &lt;&lt; tasksList.size() &lt;&lt; endl;</span></div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="comment">        for(unsigned long j=0; j&lt;tasksList.size(); ++j) {</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;<span class="comment">          cout &lt;&lt; &quot;Task &quot; &lt;&lt; j &lt;&lt; &quot;: &quot;;</span></div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;<span class="comment">          switch( tasksList[j].task ) {</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="comment">            case CTaskDefinition::NO_TASK: cout &lt;&lt; &quot;NO_TASK&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;<span class="comment">            case CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS: cout &lt;&lt; &quot;ADER_PREDICTOR_STEP_COMM_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;<span class="comment">            case CTaskDefinition::ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS: cout &lt;&lt; &quot;ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;<span class="comment">            case CTaskDefinition::INITIATE_MPI_COMMUNICATION: cout &lt;&lt; &quot;INITIATE_MPI_COMMUNICATION&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;<span class="comment">            case CTaskDefinition::COMPLETE_MPI_COMMUNICATION: cout &lt;&lt; &quot;COMPLETE_MPI_COMMUNICATION&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">            case CTaskDefinition::INITIATE_REVERSE_MPI_COMMUNICATION: cout &lt;&lt; &quot;INITIATE_REVERSE_MPI_COMMUNICATION&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;<span class="comment">            case CTaskDefinition::COMPLETE_REVERSE_MPI_COMMUNICATION: cout &lt;&lt; &quot;COMPLETE_REVERSE_MPI_COMMUNICATION&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">            case CTaskDefinition::ADER_TIME_INTERPOLATE_OWNED_ELEMENTS: cout &lt;&lt; &quot;ADER_TIME_INTERPOLATE_OWNED_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;<span class="comment">            case CTaskDefinition::ADER_TIME_INTERPOLATE_HALO_ELEMENTS: cout &lt;&lt; &quot;ADER_TIME_INTERPOLATE_HALO_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;<span class="comment">            case CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_OWNED_ELEMENTS: cout &lt;&lt; &quot;SHOCK_CAPTURING_VISCOSITY_OWNED_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;<span class="comment">            case CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_HALO_ELEMENTS: cout &lt;&lt; &quot;SHOCK_CAPTURING_VISCOSITY_HALO_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;<span class="comment">            case CTaskDefinition::VOLUME_RESIDUAL: cout &lt;&lt; &quot;VOLUME_RESIDUAL&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment">            case CTaskDefinition::SURFACE_RESIDUAL_OWNED_ELEMENTS: cout &lt;&lt; &quot;SURFACE_RESIDUAL_OWNED_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;<span class="comment">            case CTaskDefinition::SURFACE_RESIDUAL_HALO_ELEMENTS: cout &lt;&lt; &quot;SURFACE_RESIDUAL_HALO_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;<span class="comment">            case CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_OWNED: cout &lt;&lt; &quot;BOUNDARY_CONDITIONS_DEPEND_ON_OWNED&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;<span class="comment">            case CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_HALO: cout &lt;&lt; &quot;BOUNDARY_CONDITIONS_DEPEND_ON_HALO&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;<span class="comment">            case CTaskDefinition::SUM_UP_RESIDUAL_CONTRIBUTIONS_OWNED_ELEMENTS: cout &lt;&lt; &quot;SUM_UP_RESIDUAL_CONTRIBUTIONS_OWNED_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;<span class="comment">            case CTaskDefinition::SUM_UP_RESIDUAL_CONTRIBUTIONS_HALO_ELEMENTS: cout &lt;&lt; &quot;SUM_UP_RESIDUAL_CONTRIBUTIONS_HALO_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;<span class="comment">            case CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS: cout &lt;&lt; &quot;ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;<span class="comment">            case CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_HALO_ELEMENTS: cout &lt;&lt; &quot;ADER_ACCUMULATE_SPACETIME_RESIDUAL_HALO_ELEMENTS&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;<span class="comment">            case CTaskDefinition::MULTIPLY_INVERSE_MASS_MATRIX: cout &lt;&lt; &quot;MULTIPLY_INVERSE_MASS_MATRIX&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;<span class="comment">            case CTaskDefinition::ADER_UPDATE_SOLUTION: cout &lt;&lt; &quot;ADER_UPDATE_SOLUTION&quot; &lt;&lt; endl; break;</span></div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;<span class="comment">            default: cout &lt;&lt; &quot;This cannot happen&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;<span class="comment">          }</span></div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;<span class="comment">          cout &lt;&lt; &quot; Time level: &quot; &lt;&lt; tasksList[j].timeLevel</span></div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;<span class="comment">               &lt;&lt; &quot; Integration point: &quot; &lt;&lt; tasksList[j].intPointADER</span></div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;<span class="comment">               &lt;&lt; &quot; Second part: &quot; &lt;&lt; tasksList[j].secondPartTimeIntADER &lt;&lt; endl;</span></div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;<span class="comment">          cout &lt;&lt; &quot; Depends on tasks:&quot;;</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="comment">          for(unsigned short k=0; k&lt;tasksList[j].nIndMustBeCompleted; ++k)</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;<span class="comment">            cout &lt;&lt; &quot; &quot; &lt;&lt; tasksList[j].indMustBeCompleted[k];</span></div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;<span class="comment">          cout &lt;&lt; endl &lt;&lt; endl;</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;<span class="comment">        }</span></div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160;<span class="comment">      }</span></div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;<span class="comment">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160;<span class="comment">      SU2_MPI::Barrier(MPI_COMM_WORLD);</span></div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;<span class="comment">#endif</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;<span class="comment">    }</span></div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;<span class="comment">    cout &lt;&lt; &quot;CFEM_DG_EulerSolver::SetUpTaskList: ADER tasklist printed&quot; &lt;&lt; endl;</span></div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;<span class="comment">    exit(1); */</span></div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160; </div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;    <span class="comment">// END EXTRA FOR DEBUGGING.</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;  }</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160; </div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160;    <span class="comment">/* Standard time integration scheme for which the spatial residual must   */</span></div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;    <span class="comment">/* be computed for the DOFS of the owned elements. This results in a      */</span></div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160;    <span class="comment">/* relatively short tasks list, which can be set easily.                  */</span></div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160; </div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a38b0ce8cd837938d82de2e50ec9e2a2a">CTaskDefinition::INITIATE_MPI_COMMUNICATION</a>,                   0));                   <span class="comment">// Task  0</span></div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9f1a6175c942a7aab7fe961d7b144779">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_OWNED_ELEMENTS</a>,     0));                   <span class="comment">// Task  1</span></div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74af3eb9ac3d402c19dc3d270edff6625aa">CTaskDefinition::VOLUME_RESIDUAL</a>,                              0,  1));               <span class="comment">// Task  2</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a7c76da9a0dfec35be76a43ae8c059c9e">CTaskDefinition::COMPLETE_MPI_COMMUNICATION</a>,                   0,  0));               <span class="comment">// Task  3</span></div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9e8d6353cb1f2eba954d362e17be57c0">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_HALO_ELEMENTS</a>,      0,  3));               <span class="comment">// Task  4</span></div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aa5a84198558a8415e59d8179c9f9086b">CTaskDefinition::SURFACE_RESIDUAL_HALO_ELEMENTS</a>,               0,  1, 4));            <span class="comment">// Task  5</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac997ca4b8d79ba7a41fb51cb53c8458">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_HALO</a>,           0,  1, 3));            <span class="comment">// Task  6</span></div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ad0a99da83dbd845544315fd5ba3ec874">CTaskDefinition::SUM_UP_RESIDUAL_CONTRIBUTIONS_HALO_ELEMENTS</a>,  0,  5));               <span class="comment">// Task  7</span></div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a223498245ffb57eb996c758cb9bcff43">CTaskDefinition::INITIATE_REVERSE_MPI_COMMUNICATION</a>,           0,  7));               <span class="comment">// Task  8</span></div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a4f83604f71f03a0535dbc845096bcfec">CTaskDefinition::SURFACE_RESIDUAL_OWNED_ELEMENTS</a>,              0,  1));               <span class="comment">// Task  9</span></div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a173b606ca522e3ac4103f4e43311e082">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_OWNED</a>,          0,  1));               <span class="comment">// Task 10</span></div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aecf3a269d02eb493020bceecf4262415">CTaskDefinition::COMPLETE_REVERSE_MPI_COMMUNICATION</a>,           0,  2, 8));            <span class="comment">// Task 11</span></div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a701f1f1d4796783265f1ca3c9b0ace32">CTaskDefinition::SUM_UP_RESIDUAL_CONTRIBUTIONS_OWNED_ELEMENTS</a>, 0,  2, 6, 9, 10, 11)); <span class="comment">// Task 12</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;    tasksList.push_back(<a class="code" href="class_c_task_definition.html">CTaskDefinition</a>(<a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74adde810be8601e9a6ee25b90abc35fbf1">CTaskDefinition::MULTIPLY_INVERSE_MASS_MATRIX</a>,                 0, 12));               <span class="comment">// Task 13</span></div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;  }</div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;}</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160; </div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::Prepare_MPI_Communication(<span class="keyword">const</span> <a class="code" href="class_c_mesh_f_e_m.html">CMeshFEM</a> *FEMGeometry,</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;                                                    <a class="code" href="class_c_config.html">CConfig</a>        *config) {</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160; </div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;  <span class="comment">/*--- Get the communication information from DG_Geometry. Note that for a</span></div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;<span class="comment">        FEM DG discretization the communication entities of FEMGeometry contain</span></div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;<span class="comment">        the volume elements. ---*/</span></div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;  <span class="keyword">const</span> vector&lt;int&gt;                    &amp;ranksSend    = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#aed3107fd85604d7461e62b4d10624744">GetRanksSend</a>();</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;  <span class="keyword">const</span> vector&lt;int&gt;                    &amp;ranksRecv    = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a77083c260f7414aebd965f8acc6b06c2">GetRanksRecv</a>();</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;  <span class="keyword">const</span> vector&lt;vector&lt;unsigned long&gt; &gt; &amp;elementsSend = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a5aad0edfb69733376406772385e3b7b8">GetEntitiesSend</a>();</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;  <span class="keyword">const</span> vector&lt;vector&lt;unsigned long&gt; &gt; &amp;elementsRecv = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a40be25094dbd18e97a336e62f97410b1">GetEntitiesRecv</a>();</div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160; </div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;  <span class="comment">/*--- Step 1. Create the triple vector, which contains elements to be    ---*/</span></div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;  <span class="comment">/*---         sent and received per time level. Note that when time      ---*/</span></div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;  <span class="comment">/*---         accurate local time stepping is not used, this is just a   ---*/</span></div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;  <span class="comment">/*---         copy of elementsSend and elementsRecv.                     ---*/</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160; </div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;  <span class="comment">/* Allocate the first two indices of the triple vectors. */</span></div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeLevels = config-&gt;<a class="code" href="class_c_config.html#a957e791919e7c6947131c06aedc7ff8d">GetnLevels_TimeAccurateLTS</a>();</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160; </div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;  vector&lt;vector&lt;vector&lt;unsigned long&gt; &gt; &gt; elemSendPerTimeLevel, elemRecvPerTimeLevel;</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;  elemSendPerTimeLevel.resize(nTimeLevels);</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;  elemRecvPerTimeLevel.resize(nTimeLevels);</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160; </div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nTimeLevels; ++i) {</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;    elemSendPerTimeLevel[i].resize(elementsSend.size());</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;    elemRecvPerTimeLevel[i].resize(elementsRecv.size());</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;  }</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160; </div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;  <span class="comment">/* Loop over the send data and set the corresponding data</span></div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;<span class="comment">     in elemSendPerTimeLevel. */</span></div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;elementsSend.size(); ++i) {</div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsSend[i].size(); ++j) {</div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = elementsSend[i][j];</div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;      elemSendPerTimeLevel[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ii].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>][i].push_back(ii);</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    }</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;  }</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160; </div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;  <span class="comment">/* Loop over the receive data and set the corresponding data</span></div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;<span class="comment">     in recvSendPerTimeLevel. */</span></div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;elementsRecv.size(); ++i) {</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsRecv[i].size(); ++j) {</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = elementsRecv[i][j];</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;      elemRecvPerTimeLevel[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ii].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>][i].push_back(ii);</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    }</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;  }</div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160; </div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;  <span class="comment">/*--- Step 2. Find out whether or not self communication is present and  ---*/</span></div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;  <span class="comment">/*---         set the corresponding data for elementsSendSelfComm and    ---*/</span></div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;  <span class="comment">/*---         elementsRecvSelfComm for all time levels. This can only be ---*/</span></div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;  <span class="comment">/*---         the case when periodic boundaries are present in the grid. ---*/</span></div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160; </div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;  <span class="comment">/* Allocate the first index of elementsSendSelfComm and elementsRecvSelfComm. */</span></div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;  elementsSendSelfComm.resize(nTimeLevels);</div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;  elementsRecvSelfComm.resize(nTimeLevels);</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160; </div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;  <span class="comment">/* Loop over the ranks to which data is sent and copy the elements for self</span></div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;<span class="comment">     communication for all time levels. */</span></div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksSend.size(); ++i) {</div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;    <span class="keywordflow">if</span>(ranksSend[i] == <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>) {</div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nTimeLevels; ++j)</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        elementsSendSelfComm[j] = elemSendPerTimeLevel[j][i];</div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;    }</div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;  }</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160; </div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;  <span class="comment">/* Loop over the ranks from which data is received and copy the elements</span></div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;<span class="comment">     for self communication for all time levels. */</span></div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksRecv.size(); ++i) {</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;    <span class="keywordflow">if</span>(ranksRecv[i] == <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>) {</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nTimeLevels; ++j)</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        elementsRecvSelfComm[j] = elemRecvPerTimeLevel[j][i];</div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;    }</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;  }</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160; </div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160; </div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;  <span class="comment">/*--- Step 3. Determine the MPI communication patterns for               ---*/</span></div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;  <span class="comment">/*---         all time levels.                                           ---*/</span></div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160; </div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;  <span class="comment">/* Determine the number of time DOFs that must be communicated.</span></div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;<span class="comment">     For non-ADER schemes this is simply set to 1. */</span></div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeDOFs = 1;</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">GetKind_TimeIntScheme_Flow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a>)</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    nTimeDOFs = config-&gt;<a class="code" href="class_c_config.html#ab110ba67babf383e40ac4896bc65a599">GetnTimeDOFsADER_DG</a>();</div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160; </div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;  <span class="comment">/* Determine the number of items per DOF that must be communicated. */</span></div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nItemsPerDOF = nTimeDOFs*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160; </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;  <span class="comment">/* Allocate the memory for the first index of the vectors that</span></div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;<span class="comment">     determine the MPI communication patterns. */</span></div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;  commRequests.resize(nTimeLevels);</div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;  elementsRecvMPIComm.resize(nTimeLevels);</div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;  elementsSendMPIComm.resize(nTimeLevels);</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;  ranksRecvMPI.resize(nTimeLevels);</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;  ranksSendMPI.resize(nTimeLevels);</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;  commRecvBuf.resize(nTimeLevels);</div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;  commSendBuf.resize(nTimeLevels);</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160; </div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;  <span class="comment">/* Loop over the time levels. */</span></div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level=0; level&lt;nTimeLevels; ++level) {</div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160; </div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;    <span class="comment">/* Determine the number of ranks from which data will be received</span></div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;<span class="comment">       for this time level. Self communication is excluded. */</span></div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;    <span class="keywordtype">int</span> nRankRecv = 0;</div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksRecv.size(); ++i) {</div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;      <span class="keywordflow">if</span>((ranksRecv[i] != <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>) &amp;&amp; elemRecvPerTimeLevel[level][i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>()) ++nRankRecv;</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;    }</div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160; </div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;    <span class="comment">/* Determine the number of ranks to which data will be send</span></div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;<span class="comment">       for this time level. Self communication is excluded. */</span></div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;    <span class="keywordtype">int</span> nRankSend = 0;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksSend.size(); ++i) {</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;      <span class="keywordflow">if</span>((ranksSend[i] != <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>) &amp;&amp; elemSendPerTimeLevel[level][i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>()) ++nRankSend;</div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    }</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160; </div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <span class="comment">/* Allocate the memory for the second index of the vectors that</span></div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;<span class="comment">       determine the MPI communication. */</span></div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;    commRequests[level].resize(nRankRecv+nRankSend);</div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;    elementsRecvMPIComm[level].resize(nRankRecv);</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;    elementsSendMPIComm[level].resize(nRankSend);</div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;    ranksRecvMPI[level].resize(nRankRecv);</div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    ranksSendMPI[level].resize(nRankSend);</div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;    commRecvBuf[level].resize(nRankRecv);</div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    commSendBuf[level].resize(nRankSend);</div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160; </div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <span class="comment">/* Determine the receive information. */</span></div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    nRankRecv = 0;</div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksRecv.size(); ++i) {</div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;      <span class="keywordflow">if</span>((ranksRecv[i] != <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>) &amp;&amp; elemRecvPerTimeLevel[level][i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>()) {</div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160; </div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;        <span class="comment">/* Copy the elements to be received and the rank from where they come. */</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;        elementsRecvMPIComm[level][nRankRecv] = elemRecvPerTimeLevel[level][i];</div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;        ranksRecvMPI[level][nRankRecv] = ranksRecv[i];</div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160; </div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;        <span class="comment">/* Determine the size of the receive buffer and allocate the memory. */</span></div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> sizeBuf = 0;</div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsRecvMPIComm[level][nRankRecv].size(); ++j) {</div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = elementsRecvMPIComm[level][nRankRecv][j];</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;          sizeBuf += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;        }</div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160; </div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;        sizeBuf *= nItemsPerDOF;</div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;        commRecvBuf[level][nRankRecv].resize(sizeBuf);</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160; </div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;        <span class="comment">/* Update nRankRecv. */</span></div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;        ++nRankRecv;</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;      }</div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;    }</div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160; </div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;    <span class="comment">/* Determine the send information. */</span></div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;    nRankSend = 0;</div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksSend.size(); ++i) {</div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;      <span class="keywordflow">if</span>((ranksSend[i] != <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a>) &amp;&amp; elemSendPerTimeLevel[level][i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>()) {</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160; </div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        <span class="comment">/* Copy the elements to be sent and the rank to where they are sent. */</span></div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        elementsSendMPIComm[level][nRankSend] = elemSendPerTimeLevel[level][i];</div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        ranksSendMPI[level][nRankSend] = ranksSend[i];</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160; </div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;        <span class="comment">/* Determine the size of the send buffer and allocate the memory. */</span></div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> sizeBuf = 0;</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsSendMPIComm[level][nRankSend].size(); ++j) {</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = elementsSendMPIComm[level][nRankSend][j];</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;          sizeBuf += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;        }</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160; </div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;        sizeBuf *= nItemsPerDOF;</div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;        commSendBuf[level][nRankSend].resize(sizeBuf);</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160; </div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;        <span class="comment">/* Update nRankSend. */</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;        ++nRankSend;</div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;      }</div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    }</div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;  }</div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160; </div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160; </div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;  <span class="comment">/*--- Step 4. Store the information for the rotational periodic          ---*/</span></div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;  <span class="comment">/*---         corrections for the halo elements.                         ---*/</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160; </div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;  <span class="comment">/* Get the data for the rotational periodic halos from FEMGeometry. */</span></div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;  <span class="keyword">const</span> vector&lt;unsigned short&gt; &amp;markersRotPer = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#af94cdea59c732edb9373b95b65ea1f49">GetRotPerMarkers</a>();</div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;  <span class="keyword">const</span> vector&lt;vector&lt;unsigned long&gt; &gt; &amp;rotPerHalos = FEMGeometry-&gt;<a class="code" href="class_c_mesh_f_e_m.html#a2883fff4dbef506dfeffda8ed57da0b6">GetRotPerHalos</a>();</div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160; </div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;  <span class="comment">/* Allocate the memory for the first and second index of</span></div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;<span class="comment">     halosRotationalPeriodicity. Also allocate the memory to store the</span></div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;<span class="comment">     rotation matrices of the periodic transformations. */</span></div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nRotPerMarkers = markersRotPer.size();</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;  halosRotationalPeriodicity.resize(nTimeLevels);</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nTimeLevels; ++i)</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;    halosRotationalPeriodicity[i].resize(nRotPerMarkers);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160; </div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;  rotationMatricesPeriodicity.resize(9*nRotPerMarkers);</div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160; </div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;  <span class="comment">/* Loop over the rotational periodic transformations. */</span></div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0;</div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nRotPerMarkers; ++i) {</div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160; </div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;   <span class="comment">/* Get the rotation angles from config for this marker. */</span></div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pInd = markersRotPer[i];</div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;   <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *angles = config-&gt;<a class="code" href="class_c_config.html#a8b427e418c23b7e25da647fb21024098">GetPeriodicRotAngles</a>(config-&gt;<a class="code" href="class_c_config.html#a967e969a3beb24bb6e57d7036af003be">GetMarker_All_TagBound</a>(pInd));</div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160; </div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;    <span class="comment">/*--- Determine the rotation matrix from the donor to the halo elements.</span></div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;<span class="comment">          This is the transpose of the rotation matrix from the halo to the</span></div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;<span class="comment">          donor elements, which is stored in periodic angles of the marker. ---*/</span></div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> theta = angles[0], phi = angles[1], psi = angles[2];</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160; </div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> cosTheta = cos(theta), cosPhi = cos(phi), cosPsi = cos(psi);</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> sinTheta = sin(theta), sinPhi = sin(phi), sinPsi = sin(psi);</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160; </div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;    rotationMatricesPeriodicity[ii++] =  cosPhi*cosPsi;</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;    rotationMatricesPeriodicity[ii++] =  cosPhi*sinPsi;</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;    rotationMatricesPeriodicity[ii++] = -sinPhi;</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160; </div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;    rotationMatricesPeriodicity[ii++] = sinTheta*sinPhi*cosPsi - cosTheta*sinPsi;</div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    rotationMatricesPeriodicity[ii++] = sinTheta*sinPhi*sinPsi + cosTheta*cosPsi;</div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    rotationMatricesPeriodicity[ii++] = sinTheta*cosPhi;</div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160; </div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    rotationMatricesPeriodicity[ii++] = cosTheta*sinPhi*cosPsi + sinTheta*sinPsi;</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;    rotationMatricesPeriodicity[ii++] = cosTheta*sinPhi*sinPsi - sinTheta*cosPsi;</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;    rotationMatricesPeriodicity[ii++] = cosTheta*cosPhi;</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160; </div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    <span class="comment">/* Loop over the elements of this periodic transformation and store them</span></div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;<span class="comment">       in the appropriate location of halosRotationalPeriodicity. */</span></div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;rotPerHalos[i].size(); ++j) {</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = rotPerHalos[i][j];</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;      halosRotationalPeriodicity[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>][i].push_back(jj);</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;    }</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;  }</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;}</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160; </div>
<div class="line"><a name="l02732"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#aef4dade05b74d3e36f5b2c91d0a6fa46"> 2732</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4dade05b74d3e36f5b2c91d0a6fa46">CFEM_DG_EulerSolver::Initiate_MPI_Communication</a>(<a class="code" href="class_c_config.html">CConfig</a> *config,</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel) {</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160; </div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;  <span class="comment">/* Check if there is anything to communicate. */</span></div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;  <span class="keywordflow">if</span>( commRequests[timeLevel].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() ) {</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160; </div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <span class="comment">/* Set the pointer to the memory, whose data must be communicated.</span></div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;<span class="comment">       This depends on the time integration scheme used. For ADER the data of</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="comment">       the predictor part is communicated, while for the other time integration</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="comment">       schemes typically the working solution is communicated. Note that if the</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="comment">       working solution is communicated, there is only one time level. */</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeDOFs;</div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *commData;</div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">GetKind_TimeIntScheme_Flow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a>) {</div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;      nTimeDOFs = config-&gt;<a class="code" href="class_c_config.html#ab110ba67babf383e40ac4896bc65a599">GetnTimeDOFsADER_DG</a>();</div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;      commData  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a98849e262d69140a6a2d222d1a33de00">VecSolDOFsPredictorADER</a>.data();</div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    }</div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;      nTimeDOFs = 1;</div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;      commData  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[0].data();</div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    }</div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160; </div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    <span class="comment">/* Loop over the number of ranks to which this rank must send data. */</span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;    <span class="keywordtype">int</span> indComm = 0;</div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksSendMPI[timeLevel].size(); ++i, ++indComm) {</div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = 0;</div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160; </div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;      <span class="comment">/* Loop over the elements to be sent and copy the solution data</span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="comment">         into the send buffer. */</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sendBuf = commSendBuf[timeLevel][i].data();</div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsSendMPIComm[timeLevel][i].size(); ++j) {</div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = elementsSendMPIComm[timeLevel][i][j];</div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nItems = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a> * <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = nItems * <span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160; </div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;nTimeDOFs; ++k) {</div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indS = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>);</div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;          memcpy(sendBuf+ii, commData+indS, nBytes);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;          ii += nItems;</div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        }</div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;      }</div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160; </div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;      <span class="comment">/* Send the data using non-blocking sends. */</span></div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;      <span class="keywordtype">int</span> dest = ranksSendMPI[timeLevel][i];</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;      <span class="keywordtype">int</span> tag  = dest + timeLevel;</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a43a415ec11a029ade218eaf8c807a817">SU2_MPI::Isend</a>(sendBuf, ii, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, dest, tag, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>,</div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;                     &amp;commRequests[timeLevel][indComm]);</div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;    }</div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160; </div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;    <span class="comment">/* Loop over the number of ranks from which data is received. */</span></div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksRecvMPI[timeLevel].size(); ++i, ++indComm) {</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160; </div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;      <span class="comment">/* Post the non-blocking receive. */</span></div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;      <span class="keywordtype">int</span> source = ranksRecvMPI[timeLevel][i];</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;      <span class="keywordtype">int</span> tag    = <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> + timeLevel;</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#ae41565b441aee76e1b48eb03e5ac86dd">SU2_MPI::Irecv</a>(commRecvBuf[timeLevel][i].data(),</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;                     commRecvBuf[timeLevel][i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(),</div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;                     <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, source, tag, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>,</div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;                     &amp;commRequests[timeLevel][indComm]);</div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;    }</div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;  }</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160; </div>
<div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;}</div>
<div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160; </div>
<div class="line"><a name="l02798"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#ad3428a192cfff4925a3ce854866119de"> 2798</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad3428a192cfff4925a3ce854866119de">CFEM_DG_EulerSolver::Complete_MPI_Communication</a>(<a class="code" href="class_c_config.html">CConfig</a> *config,</div>
<div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel,</div>
<div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">bool</span> commMustBeCompleted) {</div>
<div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160; </div>
<div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;  <span class="comment">/* Set the pointer to the memory, whose data must be communicated.</span></div>
<div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;<span class="comment">     This depends on the time integration scheme used. For ADER the data of</span></div>
<div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;<span class="comment">     the predictor part is communicated, while for the other time integration</span></div>
<div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;<span class="comment">     schemes typically the working solution is communicated. Note that if the</span></div>
<div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;<span class="comment">     working solution is communicated, there is only one time level. */</span></div>
<div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeDOFs;</div>
<div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *commData;</div>
<div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">GetKind_TimeIntScheme_Flow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a>) {</div>
<div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;    nTimeDOFs = config-&gt;<a class="code" href="class_c_config.html#ab110ba67babf383e40ac4896bc65a599">GetnTimeDOFsADER_DG</a>();</div>
<div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;    commData  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a98849e262d69140a6a2d222d1a33de00">VecSolDOFsPredictorADER</a>.data();</div>
<div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;  }</div>
<div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;    nTimeDOFs = 1;</div>
<div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;    commData  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[0].data();</div>
<div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;  }</div>
<div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160; </div>
<div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;  <span class="comment">/*--- Complete the MPI communication, if needed and if possible, and  ---*/</span></div>
<div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;  <span class="comment">/*--- copy the data from the receive buffers into the correct         ---*/</span></div>
<div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;  <span class="comment">/*--- location in commData.                                           ---*/</span></div>
<div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160; </div>
<div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;  <span class="keywordflow">if</span>( commRequests[timeLevel].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() ) {</div>
<div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160; </div>
<div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;    <span class="comment">/*--- There are communication requests to be completed. Check if these</span></div>
<div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;<span class="comment">          requests must be completed. In that case Waitall is used.</span></div>
<div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;<span class="comment">          Otherwise, Testall is used to check if all the requests have</span></div>
<div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;<span class="comment">          been completed. If not, false is returned. ---*/</span></div>
<div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;    <span class="keywordflow">if</span>( commMustBeCompleted ) {</div>
<div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a7a83091a6fcdc392a11be74734362eaa">SU2_MPI::Waitall</a>(commRequests[timeLevel].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(),</div>
<div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                       commRequests[timeLevel].data(), MPI_STATUSES_IGNORE);</div>
<div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;    }</div>
<div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;      <span class="keywordtype">int</span> flag;</div>
<div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;      SU2_MPI::Testall(commRequests[timeLevel].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(),</div>
<div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                       commRequests[timeLevel].data(), &amp;flag, MPI_STATUSES_IGNORE);</div>
<div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;      <span class="keywordflow">if</span>( !flag ) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;    }</div>
<div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160; </div>
<div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;    <span class="comment">/* Loop over the number of ranks from which this rank has received data. */</span></div>
<div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksRecvMPI[timeLevel].size(); ++i) {</div>
<div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = 0;</div>
<div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160; </div>
<div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;      <span class="comment">/* Loop over the elements to be received and copy the solution data</span></div>
<div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;<span class="comment">         into commData. */</span></div>
<div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *recvBuf = commRecvBuf[timeLevel][i].data();</div>
<div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsRecvMPIComm[timeLevel][i].size(); ++j) {</div>
<div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = elementsRecvMPIComm[timeLevel][i][j];</div>
<div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nItems = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a> * <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = nItems * <span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160; </div>
<div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;nTimeDOFs; ++k) {</div>
<div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indR = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + k*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>);</div>
<div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;          memcpy(commData+indR, recvBuf+ii, nBytes);</div>
<div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;          ii += nItems;</div>
<div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;        }</div>
<div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;      }</div>
<div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;    }</div>
<div class="line"><a name="l02861"></a><span class="lineno"> 2861</span>&#160;  }</div>
<div class="line"><a name="l02862"></a><span class="lineno"> 2862</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160; </div>
<div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;  <span class="comment">/*---               Carry out the self communication.                 ---*/</span></div>
<div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160; </div>
<div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;  <span class="comment">/* Loop over the number of elements involved and copy the data of the DOFs. */</span></div>
<div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;elementsSendSelfComm[timeLevel].size(); ++i) {</div>
<div class="line"><a name="l02870"></a><span class="lineno"> 2870</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemS  = elementsSendSelfComm[timeLevel][i];</div>
<div class="line"><a name="l02871"></a><span class="lineno"> 2871</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemR  = elementsRecvSelfComm[timeLevel][i];</div>
<div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemS].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a> * <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160; </div>
<div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nTimeDOFs; ++j) {</div>
<div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indS = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemS].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + j*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>);</div>
<div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indR = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemR].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + j*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>);</div>
<div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160; </div>
<div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;      memcpy(commData+indR, commData+indS, nBytes);</div>
<div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    }</div>
<div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;  }</div>
<div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160; </div>
<div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;  <span class="comment">/*--- Correct the vector quantities in the rotational periodic halo&#39;s. ---*/</span></div>
<div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160; </div>
<div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;  <span class="comment">/*--- Loop over the markers for which a rotational periodic</span></div>
<div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;<span class="comment">        correction must be applied to the momentum variables. ---*/</span></div>
<div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0;</div>
<div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nRotPerMarkers = halosRotationalPeriodicity[timeLevel].size();</div>
<div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> k=0; k&lt;nRotPerMarkers; ++k) {</div>
<div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160; </div>
<div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    <span class="comment">/* Easier storage of the rotational matrix. */</span></div>
<div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rotMatrix[3][3];</div>
<div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160; </div>
<div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    rotMatrix[0][0] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    rotMatrix[0][1] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    rotMatrix[0][2] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160; </div>
<div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    rotMatrix[1][0] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    rotMatrix[1][1] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    rotMatrix[1][2] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160; </div>
<div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    rotMatrix[2][0] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    rotMatrix[2][1] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    rotMatrix[2][2] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160; </div>
<div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <span class="comment">/* Determine the number of elements for this transformation and</span></div>
<div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;<span class="comment">       loop over them. */</span></div>
<div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nHaloElem = halosRotationalPeriodicity[timeLevel][k].size();</div>
<div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;nHaloElem; ++j) {</div>
<div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160; </div>
<div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;      <span class="comment">/* Easier storage of the halo index and loop over its DOFs, including</span></div>
<div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;<span class="comment">         the multiple time DOFs for ADER. */</span></div>
<div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> tInd=0; tInd&lt;nTimeDOFs; ++tInd) {</div>
<div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> tIndOff = tInd*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a>;</div>
<div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ind     = halosRotationalPeriodicity[timeLevel][k][j];</div>
<div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ind].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++i) {</div>
<div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160; </div>
<div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;          <span class="comment">/* Determine the pointer in commData where the solution of this DOF</span></div>
<div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;<span class="comment">             is stored and copy the momentum variables. Note that a rotational</span></div>
<div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;<span class="comment">             correction can only take place for a 3D simulation. */</span></div>
<div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol = commData + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ind].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i + tIndOff);</div>
<div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160; </div>
<div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ru = sol[1], rv = sol[2], rw = sol[3];</div>
<div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160; </div>
<div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;          <span class="comment">/* Correct the momentum variables. */</span></div>
<div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;          sol[1] = rotMatrix[0][0]*ru + rotMatrix[0][1]*rv + rotMatrix[0][2]*rw;</div>
<div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;          sol[2] = rotMatrix[1][0]*ru + rotMatrix[1][1]*rv + rotMatrix[1][2]*rw;</div>
<div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;          sol[3] = rotMatrix[2][0]*ru + rotMatrix[2][1]*rv + rotMatrix[2][2]*rw;</div>
<div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;        }</div>
<div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;      }</div>
<div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;    }</div>
<div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;  }</div>
<div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160; </div>
<div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;  <span class="comment">/* Return true to indicate that the communication has been completed. */</span></div>
<div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;}</div>
<div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160; </div>
<div class="line"><a name="l02939"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a59148852103da2fb75a30e40f7ea4eb4"> 2939</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a59148852103da2fb75a30e40f7ea4eb4">CFEM_DG_EulerSolver::Initiate_MPI_ReverseCommunication</a>(<a class="code" href="class_c_config.html">CConfig</a> *config,</div>
<div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;                                                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel) {</div>
<div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160; </div>
<div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;  <span class="comment">/* Set the pointer to the residual to be communicated. */</span></div>
<div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resComm;</div>
<div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">GetKind_TimeIntScheme_Flow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a>) resComm = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">VecTotResDOFsADER</a>.data();</div>
<div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;  <span class="keywordflow">else</span>                                                resComm = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.data();</div>
<div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160; </div>
<div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;  <span class="comment">/*--- Correct the vector residuals in the rotational periodic halo&#39;s.  ---*/</span></div>
<div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160; </div>
<div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;  <span class="comment">/*--- Loop over the markers for which a rotational periodic</span></div>
<div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;<span class="comment">        correction must be applied to the momentum variables. ---*/</span></div>
<div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ii = 0;</div>
<div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nRotPerMarkers = halosRotationalPeriodicity[0].size();</div>
<div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;nRotPerMarkers; ++k) {</div>
<div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160; </div>
<div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;    <span class="comment">/* Easier storage of the transpose of the rotational matrix. */</span></div>
<div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rotMatrix[3][3];</div>
<div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160; </div>
<div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;    rotMatrix[0][0] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;    rotMatrix[1][0] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;    rotMatrix[2][0] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160; </div>
<div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;    rotMatrix[0][1] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;    rotMatrix[1][1] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;    rotMatrix[2][1] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160; </div>
<div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;    rotMatrix[0][2] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;    rotMatrix[1][2] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;    rotMatrix[2][2] = rotationMatricesPeriodicity[ii++];</div>
<div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160; </div>
<div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;    <span class="comment">/* Determine the number of elements for this transformation and</span></div>
<div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;<span class="comment">       loop over them. */</span></div>
<div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nHaloElem = halosRotationalPeriodicity[timeLevel][k].size();</div>
<div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;nHaloElem; ++j) {</div>
<div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160; </div>
<div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;      <span class="comment">/* Easier storage of the halo index and loop over its DOFs. */</span></div>
<div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ind = halosRotationalPeriodicity[timeLevel][k][j];</div>
<div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ind].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++i) {</div>
<div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160; </div>
<div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;        <span class="comment">/* Determine the pointer in VecResDOFs where the residual of this DOF</span></div>
<div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;<span class="comment">           is stored and copy the momentum residuals. Note that a rotational</span></div>
<div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;<span class="comment">           correction can only take place for a 3D simulation. */</span></div>
<div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *res = resComm + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ind].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i);</div>
<div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160; </div>
<div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ru = res[1], rv = res[2], rw = res[3];</div>
<div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160; </div>
<div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;        <span class="comment">/* Correct the momentum variables. */</span></div>
<div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;        res[1] = rotMatrix[0][0]*ru + rotMatrix[0][1]*rv + rotMatrix[0][2]*rw;</div>
<div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;        res[2] = rotMatrix[1][0]*ru + rotMatrix[1][1]*rv + rotMatrix[1][2]*rw;</div>
<div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;        res[3] = rotMatrix[2][0]*ru + rotMatrix[2][1]*rv + rotMatrix[2][2]*rw;</div>
<div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;      }</div>
<div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;    }</div>
<div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;  }</div>
<div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160; </div>
<div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160; </div>
<div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;  <span class="comment">/* Check if there is anything to communicate. */</span></div>
<div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;  <span class="keywordflow">if</span>( commRequests[timeLevel].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() ) {</div>
<div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160; </div>
<div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;    <span class="comment">/* Loop over the number of ranks from which this rank receives data in</span></div>
<div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;<span class="comment">       the original communication pattern. In the reverse pattern, data</span></div>
<div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;<span class="comment">       has to be sent. */</span></div>
<div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;    <span class="keywordtype">int</span> indComm = 0;</div>
<div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksRecvMPI[timeLevel].size(); ++i, ++indComm) {</div>
<div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = 0;</div>
<div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160; </div>
<div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;      <span class="comment">/* Loop over the elements copy the residual data into recvBuf. */</span></div>
<div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *recvBuf = commRecvBuf[timeLevel][i].data();</div>
<div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsRecvMPIComm[timeLevel][i].size(); ++j) {</div>
<div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = elementsRecvMPIComm[timeLevel][i][j];</div>
<div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nItems = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a> * <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = nItems * <span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160; </div>
<div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indS = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;        memcpy(recvBuf+ii, resComm+indS, nBytes);</div>
<div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;        ii += nItems;</div>
<div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;      }</div>
<div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160; </div>
<div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;      <span class="comment">/* Send the data using non-blocking sends. */</span></div>
<div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;      <span class="keywordtype">int</span> dest = ranksRecvMPI[timeLevel][i];</div>
<div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;      <span class="keywordtype">int</span> tag  = dest + timeLevel + 20;</div>
<div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a43a415ec11a029ade218eaf8c807a817">SU2_MPI::Isend</a>(recvBuf, ii, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, dest, tag, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>,</div>
<div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;                     &amp;commRequests[timeLevel][indComm]);</div>
<div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;    }</div>
<div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160; </div>
<div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;    <span class="comment">/* Post the non-blocking receives. As this is the reverse communication,</span></div>
<div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;<span class="comment">       a loop over the sending ranks must be carried out. */</span></div>
<div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksSendMPI[timeLevel].size(); ++i, ++indComm) {</div>
<div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160; </div>
<div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;      <span class="keywordtype">int</span> source = ranksSendMPI[timeLevel][i];</div>
<div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;      <span class="keywordtype">int</span> tag    = <a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> + timeLevel + 20;</div>
<div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#ae41565b441aee76e1b48eb03e5ac86dd">SU2_MPI::Irecv</a>(commSendBuf[timeLevel][i].data(),</div>
<div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                     commSendBuf[timeLevel][i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(),</div>
<div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;                     <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, source, tag, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>,</div>
<div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                     &amp;commRequests[timeLevel][indComm]);</div>
<div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;    }</div>
<div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;  }</div>
<div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160; </div>
<div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160; </div>
<div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;}</div>
<div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160; </div>
<div class="line"><a name="l03044"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#af5891c1fd8de49fe774a68cd7bc0b6ec"> 3044</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af5891c1fd8de49fe774a68cd7bc0b6ec">CFEM_DG_EulerSolver::Complete_MPI_ReverseCommunication</a>(<a class="code" href="class_c_config.html">CConfig</a> *config,</div>
<div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;                                                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel,</div>
<div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;                                                            <span class="keyword">const</span> <span class="keywordtype">bool</span> commMustBeCompleted) {</div>
<div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;  <span class="comment">/* Set the pointer to the residual to be communicated. */</span></div>
<div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resComm;</div>
<div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">GetKind_TimeIntScheme_Flow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a>) resComm = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">VecTotResDOFsADER</a>.data();</div>
<div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;  <span class="keywordflow">else</span>                                                resComm = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.data();</div>
<div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160; </div>
<div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160; </div>
<div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;  <span class="comment">/*---   Complete the MPI communication, if needed and if possible.    ---*/</span></div>
<div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160; </div>
<div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;  <span class="comment">/* Check if there are any requests to complete for this time level. */</span></div>
<div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;  <span class="keywordflow">if</span>( commRequests[timeLevel].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>() ) {</div>
<div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160; </div>
<div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;    <span class="comment">/*--- There are communication requests to be completed. Check if these</span></div>
<div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;<span class="comment">          requests must be completed. In that case Waitall is used.</span></div>
<div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;<span class="comment">          Otherwise, Testall is used to check if all the requests have</span></div>
<div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;<span class="comment">          been completed. If not, return false. ---*/</span></div>
<div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;    <span class="keywordflow">if</span>( commMustBeCompleted ) {</div>
<div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a7a83091a6fcdc392a11be74734362eaa">SU2_MPI::Waitall</a>(commRequests[timeLevel].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(),</div>
<div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;                       commRequests[timeLevel].data(), MPI_STATUSES_IGNORE);</div>
<div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;    }</div>
<div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;      <span class="keywordtype">int</span> flag;</div>
<div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;      SU2_MPI::Testall(commRequests[timeLevel].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(),</div>
<div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;                       commRequests[timeLevel].data(), &amp;flag, MPI_STATUSES_IGNORE);</div>
<div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;      <span class="keywordflow">if</span>( !flag ) <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;    }</div>
<div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160; </div>
<div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;    <span class="comment">/*-------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;    <span class="comment">/*---    Update the residuals of the owned DOFs with the data received. ---*/</span></div>
<div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;    <span class="comment">/*-------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160; </div>
<div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;    <span class="comment">/*--- Loop over the received residual data from all ranks and update the</span></div>
<div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;<span class="comment">          residual of the DOFs of the corresponding elements. Note that in</span></div>
<div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;<span class="comment">          reverse mode the send communication data must be used. ---*/</span></div>
<div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;ranksSendMPI[timeLevel].size(); ++i) {</div>
<div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160; </div>
<div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;      <span class="comment">/* Loop over the elements that must be updated. */</span></div>
<div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nn = 0;</div>
<div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;elementsSendMPIComm[timeLevel][i].size(); ++j) {</div>
<div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = elementsSendMPIComm[timeLevel][i][j];</div>
<div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160; </div>
<div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;        <span class="comment">/* Easier storage of the starting residual of this element and the</span></div>
<div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;<span class="comment">           data in the buffer and update the residuals of the DOFs. */</span></div>
<div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nRes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *res = resComm + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[jj].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *buf = commSendBuf[timeLevel][i].data() + nn;</div>
<div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160; </div>
<div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;        nn += nRes;</div>
<div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;nRes; ++k)</div>
<div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;          res[k] += buf[k];</div>
<div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;      }</div>
<div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;    }</div>
<div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;  }</div>
<div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160; </div>
<div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160; </div>
<div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;  <span class="comment">/*---               Carry out the self communication.                 ---*/</span></div>
<div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160; </div>
<div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;  <span class="comment">/*--- Loop over the number of elements involved and update the residuals</span></div>
<div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;<span class="comment">        of the owned DOFs. ---*/</span></div>
<div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;elementsSendSelfComm[timeLevel].size(); ++i) {</div>
<div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160; </div>
<div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> volOwned = elementsSendSelfComm[timeLevel][i];</div>
<div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> volHalo  = elementsRecvSelfComm[timeLevel][i];</div>
<div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resOwned = resComm + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[volOwned].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resHalo  = resComm + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[volHalo].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160; </div>
<div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nRes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[volOwned].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nRes; ++j)</div>
<div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;      resOwned[j] += resHalo[j];</div>
<div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;  }</div>
<div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160; </div>
<div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;  <span class="comment">/* Initialize the halo residuals of the just completed communication pattern</span></div>
<div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;<span class="comment">     to zero if ADER-DG is used. */</span></div>
<div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">GetKind_TimeIntScheme_Flow</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a>) {</div>
<div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iBeg      = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[timeLevel]].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> volIndEnd = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[timeLevel+1]-1;</div>
<div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iEnd      = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[volIndEnd].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;                                  +       <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[volIndEnd].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>);</div>
<div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160; </div>
<div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=iBeg; i&lt;iEnd; ++i)</div>
<div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">VecTotResDOFsADER</a>[i] = 0.0;</div>
<div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;  }</div>
<div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160; </div>
<div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;  <span class="comment">/* Return true to indicate that the communication has been completed. */</span></div>
<div class="line"><a name="l03136"></a><span class="lineno"> 3136</span>&#160;  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l03137"></a><span class="lineno"> 3137</span>&#160;}</div>
<div class="line"><a name="l03138"></a><span class="lineno"> 3138</span>&#160; </div>
<div class="line"><a name="l03139"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a5aa7f52ba149678087c03b59ca9dd9cf"> 3139</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5aa7f52ba149678087c03b59ca9dd9cf">CFEM_DG_EulerSolver::SetInitialCondition</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> **geometry, <a class="code" href="class_c_solver.html">CSolver</a> ***solver_container, <a class="code" href="class_c_config.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ExtIter) {</div>
<div class="line"><a name="l03140"></a><span class="lineno"> 3140</span>&#160; </div>
<div class="line"><a name="l03141"></a><span class="lineno"> 3141</span>&#160;<span class="preprocessor">#ifdef INVISCID_VORTEX</span></div>
<div class="line"><a name="l03142"></a><span class="lineno"> 3142</span>&#160; </div>
<div class="line"><a name="l03143"></a><span class="lineno"> 3143</span>&#160;  <span class="comment">/* Write a message that the solution is initialized for the inviscid vortex</span></div>
<div class="line"><a name="l03144"></a><span class="lineno"> 3144</span>&#160;<span class="comment">     test case. */</span></div>
<div class="line"><a name="l03145"></a><span class="lineno"> 3145</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>) {</div>
<div class="line"><a name="l03146"></a><span class="lineno"> 3146</span>&#160;    cout &lt;&lt; endl;</div>
<div class="line"><a name="l03147"></a><span class="lineno"> 3147</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Warning: Solution is initialized for the inviscid vortex test case!!!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03148"></a><span class="lineno"> 3148</span>&#160;    cout &lt;&lt; endl &lt;&lt; flush;</div>
<div class="line"><a name="l03149"></a><span class="lineno"> 3149</span>&#160;  }</div>
<div class="line"><a name="l03150"></a><span class="lineno"> 3150</span>&#160; </div>
<div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;  <span class="comment">/* The initial conditions are set to the solution of the inviscid vortex,</span></div>
<div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;<span class="comment">     which is an exact solution of the Euler equations. The initialization</span></div>
<div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;<span class="comment">     below is valid for both 2D and 3D. For the 3D case the z-direction is</span></div>
<div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;<span class="comment">     assumed to be the direction in which the solution does not change.</span></div>
<div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;<span class="comment">     First set the parameters, which define this test case. */</span></div>
<div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160; </div>
<div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> MachVortex  =  0.5;     <span class="comment">// Mach number of the undisturbed flow.</span></div>
<div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> x0Vortex    = -0.5;     <span class="comment">// Initial x-coordinate of the vortex center.</span></div>
<div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> y0Vortex    =  0.0;     <span class="comment">// Initial y-coordinate of the vortex center.</span></div>
<div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RVortex     =  0.1;     <span class="comment">// Radius of the vortex.</span></div>
<div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> epsVortex   =  1.0;     <span class="comment">// Strength of the vortex.</span></div>
<div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> thetaVortex =  0.0;     <span class="comment">// Advection angle (in degrees) of the vortex.</span></div>
<div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160; </div>
<div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;  <span class="comment">/* Compute the free stream velocities in x- and y-direction. */</span></div>
<div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> VelInf = MachVortex*sqrt(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>);</div>
<div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> uInf   = VelInf*cos(thetaVortex*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0);</div>
<div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vInf   = VelInf*sin(thetaVortex*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0);</div>
<div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160; </div>
<div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;  <span class="comment">/* Useful coefficients in which Gamma is present. */</span></div>
<div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ovGm1    = 1.0/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>;</div>
<div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> gamOvGm1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*ovGm1;</div>
<div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160; </div>
<div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;  <span class="comment">/* Loop over the owned elements. */</span></div>
<div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++i) {</div>
<div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160; </div>
<div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;    <span class="comment">/* Loop over the DOFs of this element. */</span></div>
<div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++j) {</div>
<div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160; </div>
<div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;      <span class="comment">/* Set the pointers to the coordinates and solution of this DOF. */</span></div>
<div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a53ea2b1580c4f0c4da67a21cbeaf27b3">coorSolDOFs</a>.data() + j*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + j);</div>
<div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160; </div>
<div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;      <span class="comment">/* Compute the coordinates relative to the center of the vortex. */</span></div>
<div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dx = coor[0] - x0Vortex;</div>
<div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dy = coor[1] - y0Vortex;</div>
<div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160; </div>
<div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;      <span class="comment">/* Compute the components of the velocity. */</span></div>
<div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> f  = 1.0 - (dx*dx + dy*dy)/(RVortex*RVortex);</div>
<div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> t1 = epsVortex*dy*exp(0.5*f)/(2.0*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>*RVortex);</div>
<div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u  = uInf - VelInf*t1;</div>
<div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160; </div>
<div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;      t1          = epsVortex*dx*exp(0.5*f)/(2.0*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>*RVortex);</div>
<div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v = vInf + VelInf*t1;</div>
<div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160; </div>
<div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;      <span class="comment">/* Compute the density and the pressure. */</span></div>
<div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;      t1 = 1.0 - epsVortex*epsVortex*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a></div>
<div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;         *       MachVortex*MachVortex*exp(f)/(8.0*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>);</div>
<div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160; </div>
<div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rho = pow(t1,ovGm1);</div>
<div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> p   = pow(t1,gamOvGm1);</div>
<div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160; </div>
<div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;      <span class="comment">/* Compute the conservative variables. Note that both 2D and 3D</span></div>
<div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;<span class="comment">         cases are treated correctly. */</span></div>
<div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;      solDOF[0]      = rho;</div>
<div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;      solDOF[1]      = rho*u;</div>
<div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;      solDOF[2]      = rho*v;</div>
<div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;      solDOF[3]      = 0.0;</div>
<div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;      solDOF[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] = p*ovGm1 + 0.5*rho*(u*u + v*v);</div>
<div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;    }</div>
<div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;  }</div>
<div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160; </div>
<div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;<span class="preprocessor">#elif RINGLEB</span></div>
<div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160; </div>
<div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;  <span class="comment">/* The initial conditions are set to the exact solution of the Ringleb flow.</span></div>
<div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;<span class="comment">     The reason for doing so, is that the Ringleb flow is an isolated solution</span></div>
<div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;<span class="comment">     of the Euler equations. If the initialization is too far off from the</span></div>
<div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;<span class="comment">     final solution, shocks develop, which may destabilize the solution and it</span></div>
<div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;<span class="comment">     is impossible to obtain a converged solution. */</span></div>
<div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160; </div>
<div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;  <span class="comment">/* Write a message that the solution is initialized for the Ringleb test case. */</span></div>
<div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>) {</div>
<div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;    cout &lt;&lt; endl;</div>
<div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Warning: Solution is initialized for the Ringleb test case!!!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;    cout &lt;&lt; endl &lt;&lt; flush;</div>
<div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;  }</div>
<div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160; </div>
<div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;  <span class="comment">/* Loop over the owned elements. */</span></div>
<div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++i) {</div>
<div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160; </div>
<div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;    <span class="comment">/* Loop over the DOFs of this element. */</span></div>
<div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++j) {</div>
<div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160; </div>
<div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;      <span class="comment">/* Set the pointers to the coordinates and solution of this DOF. */</span></div>
<div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a53ea2b1580c4f0c4da67a21cbeaf27b3">coorSolDOFs</a>.data() + j*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + j);</div>
<div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160; </div>
<div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;      <span class="comment">/* Compute the conservative flow variables of the Ringleb solution for the</span></div>
<div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;<span class="comment">         given coordinates. Note that it is possible to run this case in both 2D</span></div>
<div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;<span class="comment">         and 3D, where the z-direction is assumed to be the inactive direction. */</span></div>
<div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;      RinglebSolution(coor, solDOF);</div>
<div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;    }</div>
<div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;  }</div>
<div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160; </div>
<div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;<span class="preprocessor">#elif CUSTOM_BC_NSUNITQUAD</span></div>
<div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160; </div>
<div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;  <span class="comment">/* Write a message that the solution is initialized for the navier stokes test case</span></div>
<div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;<span class="comment">     on the unit quad. */</span></div>
<div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>) {</div>
<div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;    cout &lt;&lt; endl;</div>
<div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Warning: Solution is initialized for the Navier Stokes test case on the unit quad!!!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    cout &lt;&lt; endl &lt;&lt; flush;</div>
<div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;  }</div>
<div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160; </div>
<div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;  <span class="comment">/* Get the flow angle, which is stored in the angle of attack and the</span></div>
<div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;<span class="comment">     viscosity coefficient. */</span></div>
<div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> flowAngle = config-&gt;<a class="code" href="class_c_config.html#a6020a5df7025ffb286f9b9f55f3f2773">GetAoA</a>()*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0;</div>
<div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> mu        = config-&gt;<a class="code" href="class_c_config.html#a2ede918fd25217170b85049ddf07408b">GetViscosity_FreeStreamND</a>();</div>
<div class="line"><a name="l03258"></a><span class="lineno"> 3258</span>&#160; </div>
<div class="line"><a name="l03259"></a><span class="lineno"> 3259</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> cosFlowAngle = cos(flowAngle);</div>
<div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> sinFlowAngle = sin(flowAngle);</div>
<div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160; </div>
<div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;  <span class="comment">/* Loop over the owned elements. */</span></div>
<div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++i) {</div>
<div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160; </div>
<div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    <span class="comment">/* Loop over the DOFs of this element. */</span></div>
<div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++j) {</div>
<div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160; </div>
<div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;      <span class="comment">/* Set the pointers to the coordinates and solution of this DOF. */</span></div>
<div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a53ea2b1580c4f0c4da67a21cbeaf27b3">coorSolDOFs</a>.data() + j*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + j);</div>
<div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160; </div>
<div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;      <span class="comment">/*--- Set the exact solution in this DOF. ---*/</span></div>
<div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> xTilde = coor[0]*cosFlowAngle - coor[1]*sinFlowAngle;</div>
<div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> yTilde = coor[0]*sinFlowAngle + coor[1]*cosFlowAngle;</div>
<div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160; </div>
<div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;      solDOF[0]      =  1.0;</div>
<div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;      solDOF[1]      =  cosFlowAngle*yTilde*yTilde;</div>
<div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;      solDOF[2]      = -sinFlowAngle*yTilde*yTilde;</div>
<div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;      solDOF[3]      =  0.0;</div>
<div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;      solDOF[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] =  (2.0*mu*xTilde + 10)/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a></div>
<div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;                     +  0.5*yTilde*yTilde*yTilde*yTilde;</div>
<div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;    }</div>
<div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;  }</div>
<div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160; </div>
<div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;<span class="preprocessor">#elif TAYLOR_GREEN</span></div>
<div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160; </div>
<div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;  <span class="comment">/* Write a message that the solution is initialized for the Taylor-Green vortex</span></div>
<div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;<span class="comment">     test case. */</span></div>
<div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>) {</div>
<div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    cout &lt;&lt; endl;</div>
<div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Warning: Solution is initialized for the Taylor-Green vortex test case!!!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;    cout &lt;&lt; endl &lt;&lt; flush;</div>
<div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;  }</div>
<div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160; </div>
<div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;  <span class="comment">/* The initial conditions are set for the Taylor-Green vortex case, which</span></div>
<div class="line"><a name="l03296"></a><span class="lineno"> 3296</span>&#160;<span class="comment">   is a DNS case that features vortex breakdown into turbulence. These</span></div>
<div class="line"><a name="l03297"></a><span class="lineno"> 3297</span>&#160;<span class="comment">   particular settings are for the typical Re = 1600 case (M = 0.08) with</span></div>
<div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;<span class="comment">   an initial temperature of 300 K. Note that this condition works in both</span></div>
<div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;<span class="comment">   2D and 3D. */</span></div>
<div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160; </div>
<div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tgvLength   = 1.0;     <span class="comment">// Taylor-Green length scale.</span></div>
<div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tgvVelocity = 1.0;     <span class="comment">// Taylor-Green velocity.</span></div>
<div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tgvDensity  = 1.0;     <span class="comment">// Taylor-Green density.</span></div>
<div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tgvPressure = 100.0;   <span class="comment">// Taylor-Green pressure.</span></div>
<div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160; </div>
<div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;  <span class="comment">/* Useful coefficient in which Gamma is present. */</span></div>
<div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ovGm1    = 1.0/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>;</div>
<div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160; </div>
<div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;  <span class="comment">/* Loop over the owned elements. */</span></div>
<div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++i) {</div>
<div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160; </div>
<div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    <span class="comment">/* Loop over the DOFs of this element. */</span></div>
<div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++j) {</div>
<div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160; </div>
<div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;      <span class="comment">/* Set the pointers to the coordinates and solution of this DOF. */</span></div>
<div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a53ea2b1580c4f0c4da67a21cbeaf27b3">coorSolDOFs</a>.data() + j*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + j);</div>
<div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160; </div>
<div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> coorZ = 0.0;</div>
<div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) coorZ = coor[2];</div>
<div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160; </div>
<div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;      <span class="comment">/* Compute the primitive variables. */</span></div>
<div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rho = tgvDensity;</div>
<div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u   =  tgvVelocity * (sin(coor[0]/tgvLength)*</div>
<div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;                                      cos(coor[1]/tgvLength)*</div>
<div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;                                      cos(coorZ  /tgvLength));</div>
<div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v   = -tgvVelocity * (cos(coor[0]/tgvLength)*</div>
<div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;                                      sin(coor[1]/tgvLength)*</div>
<div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;                                      cos(coorZ  /tgvLength));</div>
<div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factorA = cos(2.0*coorZ/tgvLength) + 2.0;</div>
<div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factorB = cos(2.0*coor[0]/tgvLength) + cos(2.0*coor[1]/tgvLength);</div>
<div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> p   = tgvPressure+tgvDensity*(pow(tgvVelocity,2.0)/16.0)*factorA*factorB;</div>
<div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160; </div>
<div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;      <span class="comment">/* Compute the conservative variables. Note that both 2D and 3D</span></div>
<div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;<span class="comment">       cases are treated correctly. */</span></div>
<div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;      solDOF[0]      = rho;</div>
<div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;      solDOF[1]      = rho*u;</div>
<div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;      solDOF[2]      = rho*v;</div>
<div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;      solDOF[3]      = 0.0;</div>
<div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;      solDOF[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] = p*ovGm1 + 0.5*rho*(u*u + v*v);</div>
<div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;    }</div>
<div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;  }</div>
<div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160; </div>
<div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;<span class="preprocessor">#elif MANUFACTURED_SOLUTION</span></div>
<div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160; </div>
<div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;  <span class="comment">/* Write a message that the solution is initialized for a manufactured solution. */</span></div>
<div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>) {</div>
<div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    cout &lt;&lt; endl;</div>
<div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Warning: Solution is initialized for a manufactured solution!!!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;    cout &lt;&lt; endl &lt;&lt; flush;</div>
<div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;  }</div>
<div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160; </div>
<div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RGas = config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160; </div>
<div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;  <span class="comment">/* Loop over the owned elements. */</span></div>
<div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++i) {</div>
<div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160; </div>
<div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;    <span class="comment">/* Loop over the DOFs of this element. */</span></div>
<div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++j) {</div>
<div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160; </div>
<div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;      <span class="comment">/* Set the pointers to the coordinates and solution of this DOF. */</span></div>
<div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a53ea2b1580c4f0c4da67a21cbeaf27b3">coorSolDOFs</a>.data() + j*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + j);</div>
<div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160; </div>
<div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;      <span class="comment">/* Compute the solution. */</span></div>
<div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;      DetermineManufacturedSolution(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>, RGas,  coor, solDOF);</div>
<div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;    }</div>
<div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;  }</div>
<div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160; </div>
<div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160; </div>
<div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;}</div>
<div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160; </div>
<div class="line"><a name="l03374"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#aeb9ecebe3a3192fa6a00b0dcdf88d469"> 3374</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aeb9ecebe3a3192fa6a00b0dcdf88d469">CFEM_DG_EulerSolver::Preprocessing</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry, <a class="code" href="class_c_solver.html">CSolver</a> **solver_container, <a class="code" href="class_c_config.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iStep, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> RunTime_EqSystem, <span class="keywordtype">bool</span> Output) {</div>
<div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160; </div>
<div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ErrorCounter = 0;</div>
<div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160; </div>
<div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;  <span class="comment">/*--- Check for non-physical points. Only needed for a compressible solver. ---*/</span></div>
<div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160; </div>
<div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a66ca7e620390a81cd49cd0a00716128e">GetKind_Regime</a>() == <a class="code" href="option__structure_8hpp.html#a3d92e0a004752d2ef55cf6c1e2e3d6f0a20621ea72bb142dc0c8bf116a257516a">COMPRESSIBLE</a>) {</div>
<div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160; </div>
<div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    <span class="comment">/*--- Make a distinction between 2D and 3D for optimal performance. ---*/</span></div>
<div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;    <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160; </div>
<div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;      <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;        <span class="comment">/*--- 2D simulation. Loop over the owned DOFs and check for</span></div>
<div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;<span class="comment">              non-physical solutions. If found, the state is overwritten with</span></div>
<div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;<span class="comment">              the free-stream values. This usually does not work. ---*/</span></div>
<div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i) {</div>
<div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i;</div>
<div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Mom2         = solDOF[1]*solDOF[1] + solDOF[2]*solDOF[2];</div>
<div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = DensityInv*(solDOF[3] - 0.5*DensityInv*Mom2);</div>
<div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160; </div>
<div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Temperature = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aeba3f29d27211ff50acad59477105969">GetTemperature</a>();</div>
<div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160; </div>
<div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;          <span class="keywordflow">if</span>((Pressure &lt; 0.0) || (solDOF[0] &lt; 0.0) || (Temperature &lt; 0.0)) {</div>
<div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;            ++ErrorCounter;</div>
<div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160; </div>
<div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;            solDOF[0] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[0]; solDOF[1] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[1];</div>
<div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;            solDOF[2] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[2]; solDOF[3] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[3];</div>
<div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;          }</div>
<div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;        }</div>
<div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160; </div>
<div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;      }</div>
<div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160; </div>
<div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;      <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;        <span class="comment">/*--- 3D simulation. Loop over the owned DOFs and check for</span></div>
<div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;<span class="comment">              non-physical solutions. If found, the state is overwritten with</span></div>
<div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;<span class="comment">              the free-stream values. This usually does not work. ---*/</span></div>
<div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i) {</div>
<div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i;</div>
<div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Mom2         = solDOF[1]*solDOF[1] + solDOF[2]*solDOF[2]</div>
<div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;                                       + solDOF[3]*solDOF[3];</div>
<div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = DensityInv*(solDOF[4] - 0.5*DensityInv*Mom2);</div>
<div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160; </div>
<div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Temperature = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aeba3f29d27211ff50acad59477105969">GetTemperature</a>();</div>
<div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160; </div>
<div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;          <span class="keywordflow">if</span>((Pressure &lt; 0.0) || (solDOF[0] &lt; 0.0) || (Temperature &lt; 0.0)) {</div>
<div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;            ++ErrorCounter;</div>
<div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160; </div>
<div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;            solDOF[0] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[0]; solDOF[1] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[1];</div>
<div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;            solDOF[2] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[2]; solDOF[3] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[3];</div>
<div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;            solDOF[4] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[4];</div>
<div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;          }</div>
<div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;        }</div>
<div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160; </div>
<div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;      }</div>
<div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;    }</div>
<div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160; </div>
<div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;    <span class="comment">/*--- Collect the number of non-physical points for this iteration. ---*/</span></div>
<div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;    <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#aa878788c30e1c7c3ed4788e485bd2fb0">GetConsole_Output_Verb</a>() == <a class="code" href="option__structure_8hpp.html#ae40552e21f517bdde7c1a26de77b3e11a686b9a708a0e02450f0b19f485e7e96c">VERB_HIGH</a>) {</div>
<div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> MyErrorCounter = ErrorCounter;</div>
<div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(&amp;MyErrorCounter, &amp;ErrorCounter, 1, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;      <span class="keywordflow">if</span> (iMesh == <a class="code" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>) config-&gt;<a class="code" href="class_c_config.html#a434fe0922532828b7e40ded865c5ce51">SetNonphysical_Points</a>(ErrorCounter);</div>
<div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;    }</div>
<div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;  }</div>
<div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160; </div>
<div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;  <span class="comment">/*                       Check for grid motion.                                */</span></div>
<div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;  <span class="comment">/*-----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160; </div>
<div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> harmonic_balance = config-&gt;<a class="code" href="class_c_config.html#a45e95664235928d911e7c3876fe078b3">GetUnsteady_Simulation</a>() == <a class="code" href="option__structure_8hpp.html#a67e195cd9919c129a4abecd5dec5d9d0a116141d28357277f6fac452184452141">HARMONIC_BALANCE</a>;</div>
<div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a65f49bf3888539804cc0ceac28a32923">GetGrid_Movement</a>() &amp;&amp; !harmonic_balance) {</div>
<div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160; </div>
<div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;    <span class="comment">/*--- Determine the type of grid motion. ---*/</span></div>
<div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;    <span class="keywordflow">switch</span>( config-&gt;<a class="code" href="class_c_config.html#a0b17ab1184ea660b13ff0fa1c861239f">GetKind_GridMovement</a>(0) ) {</div>
<div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160; </div>
<div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a58bff0617305ea06492d81d265b0a10da21ba3bc4a36398f4c11fba2c3db9e877">MOVING_WALL</a>:</div>
<div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a58bff0617305ea06492d81d265b0a10da9bbe0bc2eafe12b2c686a121e632602a">ROTATING_FRAME</a>:</div>
<div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a58bff0617305ea06492d81d265b0a10da3833563dbc80900ab1895a2c412c4a2f">STEADY_TRANSLATION</a>: {</div>
<div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160; </div>
<div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;        <span class="comment">/* Steady motion. This is accounted for in the general preprocessing,</span></div>
<div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;<span class="comment">           where grid velocities are computed. */</span></div>
<div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;      }</div>
<div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160; </div>
<div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a58bff0617305ea06492d81d265b0a10da64b25709b7956ea45c64741c6fcc6893">RIGID_MOTION</a>: {</div>
<div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160; </div>
<div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        <span class="comment">/* Rigid body motion described. At the moment this is only</span></div>
<div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;<span class="comment">           possible for the Classical Runge Kutta scheme. */</span></div>
<div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;        <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#aeec93abf99b07f5fd7505df58a5577ae">GetKind_TimeIntScheme</a>() != <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a6b39c56a74e0c2bbb104a17be7aaf269">CLASSICAL_RK4_EXPLICIT</a>)</div>
<div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;          <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;Rigid body motion only possible for CLASSICAL_RK4_EXPLICIT.&quot;</span>,</div>
<div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;                         <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160; </div>
<div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;        <span class="comment">/* Determine whether or not it is needed to compute the motion data. */</span></div>
<div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ExtIter = config-&gt;<a class="code" href="class_c_config.html#aa48f2fc504ec2b261d5046f9a17677dd">GetExtIter</a>();</div>
<div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160; </div>
<div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;        <span class="keywordtype">bool</span> computeMotion = <span class="keyword">false</span>, firstTime = <span class="keyword">false</span>;</div>
<div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;        <span class="keywordflow">if</span>(ExtIter == 0 &amp;&amp; iStep == 0) computeMotion = firstTime = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;        <span class="keywordflow">if</span>(iStep == 1 || iStep == 3)   computeMotion = <span class="keyword">true</span>;</div>
<div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160; </div>
<div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;        <span class="keywordflow">if</span>( computeMotion ) {</div>
<div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160; </div>
<div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;          <span class="comment">/* Determine the number of time levels. For the classical Runge-Kutta</span></div>
<div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;<span class="comment">             scheme this should be 1. */</span></div>
<div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeLevels = config-&gt;<a class="code" href="class_c_config.html#a957e791919e7c6947131c06aedc7ff8d">GetnLevels_TimeAccurateLTS</a>();</div>
<div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160; </div>
<div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;          <span class="comment">/* Determine the time for which the motion data must be determined. */</span></div>
<div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> deltaT = config-&gt;<a class="code" href="class_c_config.html#a417b45d0da107126e803258901f57920">GetDelta_UnstTimeND</a>();</div>
<div class="line"><a name="l03492"></a><span class="lineno"> 3492</span>&#160; </div>
<div class="line"><a name="l03493"></a><span class="lineno"> 3493</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tNew = ExtIter*deltaT;</div>
<div class="line"><a name="l03494"></a><span class="lineno"> 3494</span>&#160;          <span class="keywordflow">if</span>( iStep ) tNew += 0.25*(iStep+1)*deltaT;</div>
<div class="line"><a name="l03495"></a><span class="lineno"> 3495</span>&#160; </div>
<div class="line"><a name="l03496"></a><span class="lineno"> 3496</span>&#160;          <span class="comment">/* Determine the time for which the currently stored position was</span></div>
<div class="line"><a name="l03497"></a><span class="lineno"> 3497</span>&#160;<span class="comment">             calculated. */</span></div>
<div class="line"><a name="l03498"></a><span class="lineno"> 3498</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tOld = tNew - 0.5*deltaT;</div>
<div class="line"><a name="l03499"></a><span class="lineno"> 3499</span>&#160; </div>
<div class="line"><a name="l03500"></a><span class="lineno"> 3500</span>&#160;          <span class="comment">/* Hard code the plunging motion in y-direction. */</span></div>
<div class="line"><a name="l03501"></a><span class="lineno"> 3501</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> b2New    = 0.25*tNew*tNew*(3.0-tNew);</div>
<div class="line"><a name="l03502"></a><span class="lineno"> 3502</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> db2Newdt = 0.75*tNew*(2.0-tNew);</div>
<div class="line"><a name="l03503"></a><span class="lineno"> 3503</span>&#160; </div>
<div class="line"><a name="l03504"></a><span class="lineno"> 3504</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> b2Old = 0.25*tOld*tOld*(3.0-tOld);</div>
<div class="line"><a name="l03505"></a><span class="lineno"> 3505</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dB2   = b2New - b2Old;</div>
<div class="line"><a name="l03506"></a><span class="lineno"> 3506</span>&#160; </div>
<div class="line"><a name="l03507"></a><span class="lineno"> 3507</span>&#160;          <span class="comment">/*-------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03508"></a><span class="lineno"> 3508</span>&#160;          <span class="comment">/*--- Update the coordinates of the DOFs (both grid and solution) ---*/</span></div>
<div class="line"><a name="l03509"></a><span class="lineno"> 3509</span>&#160;          <span class="comment">/*--- and of the integration points (volume and surfaces).        ---*/</span></div>
<div class="line"><a name="l03510"></a><span class="lineno"> 3510</span>&#160;          <span class="comment">/*-------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03511"></a><span class="lineno"> 3511</span>&#160; </div>
<div class="line"><a name="l03512"></a><span class="lineno"> 3512</span>&#160;          <span class="comment">/* The coordinates must be updated if this is not the first</span></div>
<div class="line"><a name="l03513"></a><span class="lineno"> 3513</span>&#160;<span class="comment">             first stage of the first time step. */</span></div>
<div class="line"><a name="l03514"></a><span class="lineno"> 3514</span>&#160;          <span class="keywordflow">if</span>( !firstTime ) {</div>
<div class="line"><a name="l03515"></a><span class="lineno"> 3515</span>&#160; </div>
<div class="line"><a name="l03516"></a><span class="lineno"> 3516</span>&#160;            <span class="comment">/* Adapt the coordinates of the grid points. */</span></div>
<div class="line"><a name="l03517"></a><span class="lineno"> 3517</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afa04dc04f2f6aece10303e9aab1ccc1e">nMeshPoints</a>; ++l)</div>
<div class="line"><a name="l03518"></a><span class="lineno"> 3518</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0540afa5ec869952098d67fed71432f8">meshPoints</a>[l].coor[1] += dB2;</div>
<div class="line"><a name="l03519"></a><span class="lineno"> 3519</span>&#160; </div>
<div class="line"><a name="l03520"></a><span class="lineno"> 3520</span>&#160;            <span class="comment">/* Loop over the owned volume elements. */</span></div>
<div class="line"><a name="l03521"></a><span class="lineno"> 3521</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++l) {</div>
<div class="line"><a name="l03522"></a><span class="lineno"> 3522</span>&#160; </div>
<div class="line"><a name="l03523"></a><span class="lineno"> 3523</span>&#160;              <span class="comment">/* Get the required data from the corresponding standard element. */</span></div>
<div class="line"><a name="l03524"></a><span class="lineno"> 3524</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l03525"></a><span class="lineno"> 3525</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l03526"></a><span class="lineno"> 3526</span>&#160; </div>
<div class="line"><a name="l03527"></a><span class="lineno"> 3527</span>&#160;              <span class="comment">/* Adapt the coordinates of the volume integration points. */</span></div>
<div class="line"><a name="l03528"></a><span class="lineno"> 3528</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l03529"></a><span class="lineno"> 3529</span>&#160;                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a51a6fc4be49459ff00b9391ba87291cd">coorIntegrationPoints</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03530"></a><span class="lineno"> 3530</span>&#160;                coor[1] += dB2;</div>
<div class="line"><a name="l03531"></a><span class="lineno"> 3531</span>&#160;              }</div>
<div class="line"><a name="l03532"></a><span class="lineno"> 3532</span>&#160; </div>
<div class="line"><a name="l03533"></a><span class="lineno"> 3533</span>&#160;              <span class="comment">/* Adapt the coordinates of the solution DOFs. */</span></div>
<div class="line"><a name="l03534"></a><span class="lineno"> 3534</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++i) {</div>
<div class="line"><a name="l03535"></a><span class="lineno"> 3535</span>&#160;                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a53ea2b1580c4f0c4da67a21cbeaf27b3">coorSolDOFs</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03536"></a><span class="lineno"> 3536</span>&#160;                coor[1] += dB2;</div>
<div class="line"><a name="l03537"></a><span class="lineno"> 3537</span>&#160;              }</div>
<div class="line"><a name="l03538"></a><span class="lineno"> 3538</span>&#160;            }</div>
<div class="line"><a name="l03539"></a><span class="lineno"> 3539</span>&#160; </div>
<div class="line"><a name="l03540"></a><span class="lineno"> 3540</span>&#160;            <span class="comment">/* Loop over the internal matching faces. */</span></div>
<div class="line"><a name="l03541"></a><span class="lineno"> 3541</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[nTimeLevels]; ++l) {</div>
<div class="line"><a name="l03542"></a><span class="lineno"> 3542</span>&#160; </div>
<div class="line"><a name="l03543"></a><span class="lineno"> 3543</span>&#160;              <span class="comment">/* Get the required information from the standard element. */</span></div>
<div class="line"><a name="l03544"></a><span class="lineno"> 3544</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#a6bd23e7c338057fe4aa5bed22b284323">indStandardElement</a>;</div>
<div class="line"><a name="l03545"></a><span class="lineno"> 3545</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l03546"></a><span class="lineno"> 3546</span>&#160; </div>
<div class="line"><a name="l03547"></a><span class="lineno"> 3547</span>&#160;              <span class="comment">/* Adapt the coordinates of the surface integration points. */</span></div>
<div class="line"><a name="l03548"></a><span class="lineno"> 3548</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l03549"></a><span class="lineno"> 3549</span>&#160;                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#a5653721389ffa28c4c5a0a10d41b0183">coorIntegrationPoints</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03550"></a><span class="lineno"> 3550</span>&#160;                coor[1] += dB2;</div>
<div class="line"><a name="l03551"></a><span class="lineno"> 3551</span>&#160;              }</div>
<div class="line"><a name="l03552"></a><span class="lineno"> 3552</span>&#160;            }</div>
<div class="line"><a name="l03553"></a><span class="lineno"> 3553</span>&#160; </div>
<div class="line"><a name="l03554"></a><span class="lineno"> 3554</span>&#160;            <span class="comment">/* The physical boundary faces. Exclude the periodic boundaries,</span></div>
<div class="line"><a name="l03555"></a><span class="lineno"> 3555</span>&#160;<span class="comment">               because these are not physical boundaries. */</span></div>
<div class="line"><a name="l03556"></a><span class="lineno"> 3556</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker=0; iMarker&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>; ++iMarker) {</div>
<div class="line"><a name="l03557"></a><span class="lineno"> 3557</span>&#160; </div>
<div class="line"><a name="l03558"></a><span class="lineno"> 3558</span>&#160;              <span class="keywordflow">if</span>( !(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].periodicBoundary) ) {</div>
<div class="line"><a name="l03559"></a><span class="lineno"> 3559</span>&#160; </div>
<div class="line"><a name="l03560"></a><span class="lineno"> 3560</span>&#160;                <span class="comment">/* Easier storage of the variables for this boundary. */</span></div>
<div class="line"><a name="l03561"></a><span class="lineno"> 3561</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nSurfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.size();</div>
<div class="line"><a name="l03562"></a><span class="lineno"> 3562</span>&#160;                <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a>  *surfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.data();</div>
<div class="line"><a name="l03563"></a><span class="lineno"> 3563</span>&#160; </div>
<div class="line"><a name="l03564"></a><span class="lineno"> 3564</span>&#160;                <span class="comment">/*--- Loop over the surface elements and update the coordinates of</span></div>
<div class="line"><a name="l03565"></a><span class="lineno"> 3565</span>&#160;<span class="comment">                      the integration points. ---*/</span></div>
<div class="line"><a name="l03566"></a><span class="lineno"> 3566</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;nSurfElem; ++l) {</div>
<div class="line"><a name="l03567"></a><span class="lineno"> 3567</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind  = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l03568"></a><span class="lineno"> 3568</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l03569"></a><span class="lineno"> 3569</span>&#160; </div>
<div class="line"><a name="l03570"></a><span class="lineno"> 3570</span>&#160;                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l03571"></a><span class="lineno"> 3571</span>&#160;                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03572"></a><span class="lineno"> 3572</span>&#160;                    coor[1] += dB2;</div>
<div class="line"><a name="l03573"></a><span class="lineno"> 3573</span>&#160;                  }</div>
<div class="line"><a name="l03574"></a><span class="lineno"> 3574</span>&#160;                }</div>
<div class="line"><a name="l03575"></a><span class="lineno"> 3575</span>&#160;              }</div>
<div class="line"><a name="l03576"></a><span class="lineno"> 3576</span>&#160;            }</div>
<div class="line"><a name="l03577"></a><span class="lineno"> 3577</span>&#160;          }</div>
<div class="line"><a name="l03578"></a><span class="lineno"> 3578</span>&#160; </div>
<div class="line"><a name="l03579"></a><span class="lineno"> 3579</span>&#160;          <span class="comment">/*-------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03580"></a><span class="lineno"> 3580</span>&#160;          <span class="comment">/*--- Compute the grid velocities of the volume solution DOFs and ---*/</span></div>
<div class="line"><a name="l03581"></a><span class="lineno"> 3581</span>&#160;          <span class="comment">/*--- and of the integration points (volume and surfaces).        ---*/</span></div>
<div class="line"><a name="l03582"></a><span class="lineno"> 3582</span>&#160;          <span class="comment">/*-------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03583"></a><span class="lineno"> 3583</span>&#160; </div>
<div class="line"><a name="l03584"></a><span class="lineno"> 3584</span>&#160;          <span class="comment">/* Loop over the owned volume elements. */</span></div>
<div class="line"><a name="l03585"></a><span class="lineno"> 3585</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++l) {</div>
<div class="line"><a name="l03586"></a><span class="lineno"> 3586</span>&#160; </div>
<div class="line"><a name="l03587"></a><span class="lineno"> 3587</span>&#160;            <span class="comment">/* Get the required data from the corresponding standard element. */</span></div>
<div class="line"><a name="l03588"></a><span class="lineno"> 3588</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l03589"></a><span class="lineno"> 3589</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l03590"></a><span class="lineno"> 3590</span>&#160; </div>
<div class="line"><a name="l03591"></a><span class="lineno"> 3591</span>&#160;            <span class="comment">/* Compute the grid velocity in the integration points. */</span></div>
<div class="line"><a name="l03592"></a><span class="lineno"> 3592</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l03593"></a><span class="lineno"> 3593</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03594"></a><span class="lineno"> 3594</span>&#160;              gridVel[1] = db2Newdt;</div>
<div class="line"><a name="l03595"></a><span class="lineno"> 3595</span>&#160;            }</div>
<div class="line"><a name="l03596"></a><span class="lineno"> 3596</span>&#160; </div>
<div class="line"><a name="l03597"></a><span class="lineno"> 3597</span>&#160;            <span class="comment">/* Compute the grid velocities for the solution DOFs. */</span></div>
<div class="line"><a name="l03598"></a><span class="lineno"> 3598</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++i) {</div>
<div class="line"><a name="l03599"></a><span class="lineno"> 3599</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03600"></a><span class="lineno"> 3600</span>&#160;              gridVel[1] = db2Newdt;</div>
<div class="line"><a name="l03601"></a><span class="lineno"> 3601</span>&#160;            }</div>
<div class="line"><a name="l03602"></a><span class="lineno"> 3602</span>&#160;          }</div>
<div class="line"><a name="l03603"></a><span class="lineno"> 3603</span>&#160; </div>
<div class="line"><a name="l03604"></a><span class="lineno"> 3604</span>&#160;          <span class="comment">/* Loop over the internal matching faces. */</span></div>
<div class="line"><a name="l03605"></a><span class="lineno"> 3605</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[nTimeLevels]; ++l) {</div>
<div class="line"><a name="l03606"></a><span class="lineno"> 3606</span>&#160; </div>
<div class="line"><a name="l03607"></a><span class="lineno"> 3607</span>&#160;            <span class="comment">/* Get the required information from the standard element. */</span></div>
<div class="line"><a name="l03608"></a><span class="lineno"> 3608</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#a6bd23e7c338057fe4aa5bed22b284323">indStandardElement</a>;</div>
<div class="line"><a name="l03609"></a><span class="lineno"> 3609</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l03610"></a><span class="lineno"> 3610</span>&#160; </div>
<div class="line"><a name="l03611"></a><span class="lineno"> 3611</span>&#160;            <span class="comment">/* Compute the grid velocity in the integration points. */</span></div>
<div class="line"><a name="l03612"></a><span class="lineno"> 3612</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l03613"></a><span class="lineno"> 3613</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#abe02962a6c79e9222e37282d146ad5a2">gridVelocities</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03614"></a><span class="lineno"> 3614</span>&#160;              gridVel[1] = db2Newdt;</div>
<div class="line"><a name="l03615"></a><span class="lineno"> 3615</span>&#160;            }</div>
<div class="line"><a name="l03616"></a><span class="lineno"> 3616</span>&#160;          }</div>
<div class="line"><a name="l03617"></a><span class="lineno"> 3617</span>&#160; </div>
<div class="line"><a name="l03618"></a><span class="lineno"> 3618</span>&#160;          <span class="comment">/* The physical boundary faces. Exclude the periodic boundaries,</span></div>
<div class="line"><a name="l03619"></a><span class="lineno"> 3619</span>&#160;<span class="comment">             because these are not physical boundaries. */</span></div>
<div class="line"><a name="l03620"></a><span class="lineno"> 3620</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker=0; iMarker&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>; ++iMarker) {</div>
<div class="line"><a name="l03621"></a><span class="lineno"> 3621</span>&#160; </div>
<div class="line"><a name="l03622"></a><span class="lineno"> 3622</span>&#160;            <span class="keywordflow">if</span>( !(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].periodicBoundary) ) {</div>
<div class="line"><a name="l03623"></a><span class="lineno"> 3623</span>&#160; </div>
<div class="line"><a name="l03624"></a><span class="lineno"> 3624</span>&#160;              <span class="comment">/* Easier storage of the variables for this boundary. */</span></div>
<div class="line"><a name="l03625"></a><span class="lineno"> 3625</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nSurfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.size();</div>
<div class="line"><a name="l03626"></a><span class="lineno"> 3626</span>&#160;              <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a>  *surfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.data();</div>
<div class="line"><a name="l03627"></a><span class="lineno"> 3627</span>&#160; </div>
<div class="line"><a name="l03628"></a><span class="lineno"> 3628</span>&#160;              <span class="comment">/*--- Loop over the surface elements and compute the grid velocities</span></div>
<div class="line"><a name="l03629"></a><span class="lineno"> 3629</span>&#160;<span class="comment">                    of the integration points. ---*/</span></div>
<div class="line"><a name="l03630"></a><span class="lineno"> 3630</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;nSurfElem; ++l) {</div>
<div class="line"><a name="l03631"></a><span class="lineno"> 3631</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind  = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l03632"></a><span class="lineno"> 3632</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l03633"></a><span class="lineno"> 3633</span>&#160; </div>
<div class="line"><a name="l03634"></a><span class="lineno"> 3634</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l03635"></a><span class="lineno"> 3635</span>&#160;                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03636"></a><span class="lineno"> 3636</span>&#160;                  gridVel[1] = db2Newdt;</div>
<div class="line"><a name="l03637"></a><span class="lineno"> 3637</span>&#160;                }</div>
<div class="line"><a name="l03638"></a><span class="lineno"> 3638</span>&#160;              }</div>
<div class="line"><a name="l03639"></a><span class="lineno"> 3639</span>&#160;            }</div>
<div class="line"><a name="l03640"></a><span class="lineno"> 3640</span>&#160;          }</div>
<div class="line"><a name="l03641"></a><span class="lineno"> 3641</span>&#160;        }</div>
<div class="line"><a name="l03642"></a><span class="lineno"> 3642</span>&#160; </div>
<div class="line"><a name="l03643"></a><span class="lineno"> 3643</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03644"></a><span class="lineno"> 3644</span>&#160;      }</div>
<div class="line"><a name="l03645"></a><span class="lineno"> 3645</span>&#160; </div>
<div class="line"><a name="l03646"></a><span class="lineno"> 3646</span>&#160;      <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l03647"></a><span class="lineno"> 3647</span>&#160;        <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;Only rigid body motion possible for DG-FEM solver at the moment.&quot;</span>,</div>
<div class="line"><a name="l03648"></a><span class="lineno"> 3648</span>&#160;                       <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l03649"></a><span class="lineno"> 3649</span>&#160;      }</div>
<div class="line"><a name="l03650"></a><span class="lineno"> 3650</span>&#160;    }</div>
<div class="line"><a name="l03651"></a><span class="lineno"> 3651</span>&#160;  }</div>
<div class="line"><a name="l03652"></a><span class="lineno"> 3652</span>&#160;}</div>
<div class="line"><a name="l03653"></a><span class="lineno"> 3653</span>&#160; </div>
<div class="line"><a name="l03654"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#addf1215b06e5a8166f8d84979eb1ed2d"> 3654</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addf1215b06e5a8166f8d84979eb1ed2d">CFEM_DG_EulerSolver::Postprocessing</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry, <a class="code" href="class_c_solver.html">CSolver</a> **solver_container, <a class="code" href="class_c_config.html">CConfig</a> *config,</div>
<div class="line"><a name="l03655"></a><span class="lineno"> 3655</span>&#160;                                      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh) { }</div>
<div class="line"><a name="l03656"></a><span class="lineno"> 3656</span>&#160; </div>
<div class="line"><a name="l03657"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#ac59d8dae95e3c3cc3ab3feaeb9be4b22"> 3657</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac59d8dae95e3c3cc3ab3feaeb9be4b22">CFEM_DG_EulerSolver::ComputeSpatialJacobian</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry,  <a class="code" href="class_c_solver.html">CSolver</a> **solver_container,</div>
<div class="line"><a name="l03658"></a><span class="lineno"> 3658</span>&#160;                                                 <a class="code" href="class_c_numerics.html">CNumerics</a> **numerics, <a class="code" href="class_c_config.html">CConfig</a> *config,</div>
<div class="line"><a name="l03659"></a><span class="lineno"> 3659</span>&#160;                                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> RunTime_EqSystem) {</div>
<div class="line"><a name="l03660"></a><span class="lineno"> 3660</span>&#160; </div>
<div class="line"><a name="l03661"></a><span class="lineno"> 3661</span>&#160;  <span class="comment">/* Write a message that the Jacobian is being computed. */</span></div>
<div class="line"><a name="l03662"></a><span class="lineno"> 3662</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>) {</div>
<div class="line"><a name="l03663"></a><span class="lineno"> 3663</span>&#160;    cout &lt;&lt; endl;</div>
<div class="line"><a name="l03664"></a><span class="lineno"> 3664</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Computing the Jacobian via coloring.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03665"></a><span class="lineno"> 3665</span>&#160;    cout &lt;&lt; endl &lt;&lt; flush;</div>
<div class="line"><a name="l03666"></a><span class="lineno"> 3666</span>&#160;  }</div>
<div class="line"><a name="l03667"></a><span class="lineno"> 3667</span>&#160; </div>
<div class="line"><a name="l03668"></a><span class="lineno"> 3668</span>&#160;  <span class="comment">/* Easier storage of the number of variables squared. */</span></div>
<div class="line"><a name="l03669"></a><span class="lineno"> 3669</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nVar2 = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03670"></a><span class="lineno"> 3670</span>&#160; </div>
<div class="line"><a name="l03671"></a><span class="lineno"> 3671</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03672"></a><span class="lineno"> 3672</span>&#160;  <span class="comment">/*--- Step 1: Computation of the actual Jacobian by looping over the     ---*/</span></div>
<div class="line"><a name="l03673"></a><span class="lineno"> 3673</span>&#160;  <span class="comment">/*---         of colors and disturbing the appropriate DOFs for each     ---*/</span></div>
<div class="line"><a name="l03674"></a><span class="lineno"> 3674</span>&#160;  <span class="comment">/*---         color. Note that for each color an additional loop over    ---*/</span></div>
<div class="line"><a name="l03675"></a><span class="lineno"> 3675</span>&#160;  <span class="comment">/*---         the number of variables is needed to create the Jacobian.  ---*/</span></div>
<div class="line"><a name="l03676"></a><span class="lineno"> 3676</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03677"></a><span class="lineno"> 3677</span>&#160; </div>
<div class="line"><a name="l03678"></a><span class="lineno"> 3678</span>&#160;  <span class="comment">/* Determine the number of non-zeros in the Jacobian matrix for the owned</span></div>
<div class="line"><a name="l03679"></a><span class="lineno"> 3679</span>&#160;<span class="comment">     DOFs in cumulative storage format. */</span></div>
<div class="line"><a name="l03680"></a><span class="lineno"> 3680</span>&#160;  vector&lt;unsigned long&gt; nNonZeroEntries(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>+1);</div>
<div class="line"><a name="l03681"></a><span class="lineno"> 3681</span>&#160; </div>
<div class="line"><a name="l03682"></a><span class="lineno"> 3682</span>&#160;  nNonZeroEntries[0] = 0;</div>
<div class="line"><a name="l03683"></a><span class="lineno"> 3683</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i)</div>
<div class="line"><a name="l03684"></a><span class="lineno"> 3684</span>&#160;    nNonZeroEntries[i+1] = nNonZeroEntries[i] + <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>();</div>
<div class="line"><a name="l03685"></a><span class="lineno"> 3685</span>&#160; </div>
<div class="line"><a name="l03686"></a><span class="lineno"> 3686</span>&#160;  <span class="comment">/* Copy the solution into the working variables. */</span></div>
<div class="line"><a name="l03687"></a><span class="lineno"> 3687</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a80fffbff76c3c0dbcf04030d999d8e71">Set_OldSolution</a>(geometry);</div>
<div class="line"><a name="l03688"></a><span class="lineno"> 3688</span>&#160; </div>
<div class="line"><a name="l03689"></a><span class="lineno"> 3689</span>&#160;  <span class="comment">/* Allocate the memory for local part of the Jacobian. Note that passivedouble</span></div>
<div class="line"><a name="l03690"></a><span class="lineno"> 3690</span>&#160;<span class="comment">     must be used for the Jacobian matrix. */</span></div>
<div class="line"><a name="l03691"></a><span class="lineno"> 3691</span>&#160;  vector&lt;passivedouble&gt; <a class="code" href="class_c_solver.html#a1c63fab194b1e802e0675a70014cc95b">Jacobian</a>(nVar2*nNonZeroEntries[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>]);</div>
<div class="line"><a name="l03692"></a><span class="lineno"> 3692</span>&#160; </div>
<div class="line"><a name="l03693"></a><span class="lineno"> 3693</span>&#160;  <span class="comment">/* Loop over the colors and write a message, if needed. */</span></div>
<div class="line"><a name="l03694"></a><span class="lineno"> 3694</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> color=0; color&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5bda43e6dcef5d4811431f7e24bc6369">nGlobalColors</a>; ++color) {</div>
<div class="line"><a name="l03695"></a><span class="lineno"> 3695</span>&#160; </div>
<div class="line"><a name="l03696"></a><span class="lineno"> 3696</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a> &amp;&amp; !(color%10)) {</div>
<div class="line"><a name="l03697"></a><span class="lineno"> 3697</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Color &quot;</span> &lt;&lt; color+1 &lt;&lt; <span class="stringliteral">&quot; out of &quot;</span> &lt;&lt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5bda43e6dcef5d4811431f7e24bc6369">nGlobalColors</a></div>
<div class="line"><a name="l03698"></a><span class="lineno"> 3698</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; is computed&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03699"></a><span class="lineno"> 3699</span>&#160;    }</div>
<div class="line"><a name="l03700"></a><span class="lineno"> 3700</span>&#160; </div>
<div class="line"><a name="l03701"></a><span class="lineno"> 3701</span>&#160;    <span class="comment">/* Loop over the number of variables. */</span></div>
<div class="line"><a name="l03702"></a><span class="lineno"> 3702</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">short</span> var=0; var&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++var) {</div>
<div class="line"><a name="l03703"></a><span class="lineno"> 3703</span>&#160; </div>
<div class="line"><a name="l03704"></a><span class="lineno"> 3704</span>&#160;      <span class="comment">/* Loop over the DOFs that must be disturbed for this color. */</span></div>
<div class="line"><a name="l03705"></a><span class="lineno"> 3705</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#acef8be666e3344d8040644c250579cf4">localDOFsPerColor</a>[color].size(); ++j) {</div>
<div class="line"><a name="l03706"></a><span class="lineno"> 3706</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#acef8be666e3344d8040644c250579cf4">localDOFsPerColor</a>[color][j];</div>
<div class="line"><a name="l03707"></a><span class="lineno"> 3707</span>&#160; </div>
<div class="line"><a name="l03708"></a><span class="lineno"> 3708</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[0].data() + jj*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03709"></a><span class="lineno"> 3709</span>&#160; </div>
<div class="line"><a name="l03710"></a><span class="lineno"> 3710</span>&#160;<span class="preprocessor">#ifdef CODI_FORWARD_TYPE</span></div>
<div class="line"><a name="l03711"></a><span class="lineno"> 3711</span>&#160;        solDOF[var].setGradient(1.0);</div>
<div class="line"><a name="l03712"></a><span class="lineno"> 3712</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03713"></a><span class="lineno"> 3713</span>&#160;        solDOF[var] += 0.001;   <span class="comment">/* This is to avoid a compiler warning. */</span></div>
<div class="line"><a name="l03714"></a><span class="lineno"> 3714</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03715"></a><span class="lineno"> 3715</span>&#160;      }</div>
<div class="line"><a name="l03716"></a><span class="lineno"> 3716</span>&#160; </div>
<div class="line"><a name="l03717"></a><span class="lineno"> 3717</span>&#160;      <span class="comment">/* Carry out all the tasks to compute the residual. */</span></div>
<div class="line"><a name="l03718"></a><span class="lineno"> 3718</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a651cad1a94f2024c75a1a8be347e3375">ProcessTaskList_DG</a>(geometry, solver_container, numerics, config, iMesh);</div>
<div class="line"><a name="l03719"></a><span class="lineno"> 3719</span>&#160; </div>
<div class="line"><a name="l03720"></a><span class="lineno"> 3720</span>&#160;      <span class="comment">/* Loop over all the locally owned DOFs. */</span></div>
<div class="line"><a name="l03721"></a><span class="lineno"> 3721</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i) {</div>
<div class="line"><a name="l03722"></a><span class="lineno"> 3722</span>&#160; </div>
<div class="line"><a name="l03723"></a><span class="lineno"> 3723</span>&#160;        <span class="comment">/* Check if a Jacobian entry is computed for this color. */</span></div>
<div class="line"><a name="l03724"></a><span class="lineno"> 3724</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ada0555d25a6c2b0f0118dcb954169500">colorToIndEntriesJacobian</a>[i][color] &gt;= 0) {</div>
<div class="line"><a name="l03725"></a><span class="lineno"> 3725</span>&#160; </div>
<div class="line"><a name="l03726"></a><span class="lineno"> 3726</span>&#160;          <span class="comment">/* Set the pointer to entry in Jacobian where the derivative data</span></div>
<div class="line"><a name="l03727"></a><span class="lineno"> 3727</span>&#160;<span class="comment">             must be stored. */</span></div>
<div class="line"><a name="l03728"></a><span class="lineno"> 3728</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> ind = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ada0555d25a6c2b0f0118dcb954169500">colorToIndEntriesJacobian</a>[i][color];</div>
<div class="line"><a name="l03729"></a><span class="lineno"> 3729</span>&#160;          <a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a> *Jac = <a class="code" href="class_c_solver.html#a1c63fab194b1e802e0675a70014cc95b">Jacobian</a>.data() + nVar2*(nNonZeroEntries[i] + ind);</div>
<div class="line"><a name="l03730"></a><span class="lineno"> 3730</span>&#160; </div>
<div class="line"><a name="l03731"></a><span class="lineno"> 3731</span>&#160;<span class="preprocessor">#ifdef CODI_FORWARD_TYPE</span></div>
<div class="line"><a name="l03732"></a><span class="lineno"> 3732</span>&#160;          <span class="comment">/* Set the pointer to the residual of the current DOF. */</span></div>
<div class="line"><a name="l03733"></a><span class="lineno"> 3733</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.data() + i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03734"></a><span class="lineno"> 3734</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03735"></a><span class="lineno"> 3735</span>&#160; </div>
<div class="line"><a name="l03736"></a><span class="lineno"> 3736</span>&#160;          <span class="comment">/* Store the matrix entries. */</span></div>
<div class="line"><a name="l03737"></a><span class="lineno"> 3737</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++j) {</div>
<div class="line"><a name="l03738"></a><span class="lineno"> 3738</span>&#160;<span class="preprocessor">#ifdef CODI_FORWARD_TYPE</span></div>
<div class="line"><a name="l03739"></a><span class="lineno"> 3739</span>&#160;            Jac[var+j*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>] = resDOF[j].getGradient();</div>
<div class="line"><a name="l03740"></a><span class="lineno"> 3740</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03741"></a><span class="lineno"> 3741</span>&#160;            Jac[var+j*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>] = 0.0;   <span class="comment">/* This is to avoid a compiler warning. */</span></div>
<div class="line"><a name="l03742"></a><span class="lineno"> 3742</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03743"></a><span class="lineno"> 3743</span>&#160;          }</div>
<div class="line"><a name="l03744"></a><span class="lineno"> 3744</span>&#160;        }</div>
<div class="line"><a name="l03745"></a><span class="lineno"> 3745</span>&#160;      }</div>
<div class="line"><a name="l03746"></a><span class="lineno"> 3746</span>&#160; </div>
<div class="line"><a name="l03747"></a><span class="lineno"> 3747</span>&#160;      <span class="comment">/* Reset the disturbances for this color. */</span></div>
<div class="line"><a name="l03748"></a><span class="lineno"> 3748</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#acef8be666e3344d8040644c250579cf4">localDOFsPerColor</a>[color].size(); ++j) {</div>
<div class="line"><a name="l03749"></a><span class="lineno"> 3749</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> jj = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#acef8be666e3344d8040644c250579cf4">localDOFsPerColor</a>[color][j];</div>
<div class="line"><a name="l03750"></a><span class="lineno"> 3750</span>&#160; </div>
<div class="line"><a name="l03751"></a><span class="lineno"> 3751</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[0].data() + jj*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l03752"></a><span class="lineno"> 3752</span>&#160; </div>
<div class="line"><a name="l03753"></a><span class="lineno"> 3753</span>&#160;<span class="preprocessor">#ifdef CODI_FORWARD_TYPE</span></div>
<div class="line"><a name="l03754"></a><span class="lineno"> 3754</span>&#160;        solDOF[var].setGradient(0.0);</div>
<div class="line"><a name="l03755"></a><span class="lineno"> 3755</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03756"></a><span class="lineno"> 3756</span>&#160;        solDOF[var] -= 0.001;   <span class="comment">/* This is to avoid a compiler warning. */</span></div>
<div class="line"><a name="l03757"></a><span class="lineno"> 3757</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03758"></a><span class="lineno"> 3758</span>&#160;      }</div>
<div class="line"><a name="l03759"></a><span class="lineno"> 3759</span>&#160; </div>
<div class="line"><a name="l03760"></a><span class="lineno"> 3760</span>&#160;    }</div>
<div class="line"><a name="l03761"></a><span class="lineno"> 3761</span>&#160;  }</div>
<div class="line"><a name="l03762"></a><span class="lineno"> 3762</span>&#160; </div>
<div class="line"><a name="l03763"></a><span class="lineno"> 3763</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03764"></a><span class="lineno"> 3764</span>&#160;  <span class="comment">/*--- Step 2: The writing of the Jacobian in Block Compressed Row        ---*/</span></div>
<div class="line"><a name="l03765"></a><span class="lineno"> 3765</span>&#160;  <span class="comment">/*---         Storage to file.                                           ---*/</span></div>
<div class="line"><a name="l03766"></a><span class="lineno"> 3766</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l03767"></a><span class="lineno"> 3767</span>&#160; </div>
<div class="line"><a name="l03768"></a><span class="lineno"> 3768</span>&#160;  <span class="comment">/* Write a message that the Jacobian is written to file. */</span></div>
<div class="line"><a name="l03769"></a><span class="lineno"> 3769</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>) {</div>
<div class="line"><a name="l03770"></a><span class="lineno"> 3770</span>&#160;    cout &lt;&lt; endl;</div>
<div class="line"><a name="l03771"></a><span class="lineno"> 3771</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Writing the Jacobian Block Compressed Row Storage.&quot;</span> &lt;&lt; flush;</div>
<div class="line"><a name="l03772"></a><span class="lineno"> 3772</span>&#160;  }</div>
<div class="line"><a name="l03773"></a><span class="lineno"> 3773</span>&#160; </div>
<div class="line"><a name="l03774"></a><span class="lineno"> 3774</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l03775"></a><span class="lineno"> 3775</span>&#160;  <span class="comment">/* Parallel mode. The parallel IO functionality is used to Write</span></div>
<div class="line"><a name="l03776"></a><span class="lineno"> 3776</span>&#160;<span class="comment">     the Jacobian matrix. */</span></div>
<div class="line"><a name="l03777"></a><span class="lineno"> 3777</span>&#160;  cout &lt;&lt; <span class="stringliteral">&quot;CFEM_DG_EulerSolver::ComputeSpatialJacobian: Not implemented yet&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03778"></a><span class="lineno"> 3778</span>&#160;  exit(1);</div>
<div class="line"><a name="l03779"></a><span class="lineno"> 3779</span>&#160; </div>
<div class="line"><a name="l03780"></a><span class="lineno"> 3780</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l03781"></a><span class="lineno"> 3781</span>&#160;  <span class="comment">/* Sequential mode. The entire file is written by one rank,</span></div>
<div class="line"><a name="l03782"></a><span class="lineno"> 3782</span>&#160;<span class="comment">     Open the file for writing. */</span></div>
<div class="line"><a name="l03783"></a><span class="lineno"> 3783</span>&#160;  FILE *fJac = fopen(<span class="stringliteral">&quot;Jacobian_DG.bin&quot;</span>, <span class="stringliteral">&quot;wb&quot;</span>);</div>
<div class="line"><a name="l03784"></a><span class="lineno"> 3784</span>&#160;  <span class="keywordflow">if</span>( !fJac) {</div>
<div class="line"><a name="l03785"></a><span class="lineno"> 3785</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Could not open the file Jacobian_DG for binary writing.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03786"></a><span class="lineno"> 3786</span>&#160;    exit(1);</div>
<div class="line"><a name="l03787"></a><span class="lineno"> 3787</span>&#160;  }</div>
<div class="line"><a name="l03788"></a><span class="lineno"> 3788</span>&#160; </div>
<div class="line"><a name="l03789"></a><span class="lineno"> 3789</span>&#160;  <span class="comment">/* Write the number of DOFs (Block rows in the matrix), the number of</span></div>
<div class="line"><a name="l03790"></a><span class="lineno"> 3790</span>&#160;<span class="comment">     variables (the dimension of each block) and the number of neighboring</span></div>
<div class="line"><a name="l03791"></a><span class="lineno"> 3791</span>&#160;<span class="comment">     blocks per DOF in cumulative storage format. */</span></div>
<div class="line"><a name="l03792"></a><span class="lineno"> 3792</span>&#160;  fwrite(&amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">nDOFsPerRank</a>[1], 1, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>), fJac);</div>
<div class="line"><a name="l03793"></a><span class="lineno"> 3793</span>&#160;  fwrite(&amp;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, 1, <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>), fJac);</div>
<div class="line"><a name="l03794"></a><span class="lineno"> 3794</span>&#160;  fwrite(nNonZeroEntries.data(), nNonZeroEntries.size(),</div>
<div class="line"><a name="l03795"></a><span class="lineno"> 3795</span>&#160;         <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>), fJac);</div>
<div class="line"><a name="l03796"></a><span class="lineno"> 3796</span>&#160; </div>
<div class="line"><a name="l03797"></a><span class="lineno"> 3797</span>&#160;  <span class="comment">/* Write the block column indices of the neighboring blocks. */</span></div>
<div class="line"><a name="l03798"></a><span class="lineno"> 3798</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i)</div>
<div class="line"><a name="l03799"></a><span class="lineno"> 3799</span>&#160;    fwrite(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i].data(), <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">nonZeroEntriesJacobian</a>[i].<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>(),</div>
<div class="line"><a name="l03800"></a><span class="lineno"> 3800</span>&#160;           <span class="keyword">sizeof</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>), fJac);</div>
<div class="line"><a name="l03801"></a><span class="lineno"> 3801</span>&#160; </div>
<div class="line"><a name="l03802"></a><span class="lineno"> 3802</span>&#160;  <span class="comment">/* Write the actual matrix elements. */</span></div>
<div class="line"><a name="l03803"></a><span class="lineno"> 3803</span>&#160;  fwrite(<a class="code" href="class_c_solver.html#a1c63fab194b1e802e0675a70014cc95b">Jacobian</a>.data(), <a class="code" href="class_c_solver.html#a1c63fab194b1e802e0675a70014cc95b">Jacobian</a>.size(), <span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>), fJac);</div>
<div class="line"><a name="l03804"></a><span class="lineno"> 3804</span>&#160; </div>
<div class="line"><a name="l03805"></a><span class="lineno"> 3805</span>&#160;  <span class="comment">/* Close the file again. */</span></div>
<div class="line"><a name="l03806"></a><span class="lineno"> 3806</span>&#160;  fclose(fJac);</div>
<div class="line"><a name="l03807"></a><span class="lineno"> 3807</span>&#160; </div>
<div class="line"><a name="l03808"></a><span class="lineno"> 3808</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03809"></a><span class="lineno"> 3809</span>&#160; </div>
<div class="line"><a name="l03810"></a><span class="lineno"> 3810</span>&#160;  <span class="comment">/* Write a message that the writing is done.. */</span></div>
<div class="line"><a name="l03811"></a><span class="lineno"> 3811</span>&#160;  <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>) {</div>
<div class="line"><a name="l03812"></a><span class="lineno"> 3812</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot; Done.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03813"></a><span class="lineno"> 3813</span>&#160;    cout &lt;&lt; endl &lt;&lt; flush;</div>
<div class="line"><a name="l03814"></a><span class="lineno"> 3814</span>&#160;  }</div>
<div class="line"><a name="l03815"></a><span class="lineno"> 3815</span>&#160;}</div>
<div class="line"><a name="l03816"></a><span class="lineno"> 3816</span>&#160; </div>
<div class="line"><a name="l03817"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a80fffbff76c3c0dbcf04030d999d8e71"> 3817</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a80fffbff76c3c0dbcf04030d999d8e71">CFEM_DG_EulerSolver::Set_OldSolution</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry) {</div>
<div class="line"><a name="l03818"></a><span class="lineno"> 3818</span>&#160; </div>
<div class="line"><a name="l03819"></a><span class="lineno"> 3819</span>&#160;  memcpy(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[0].data(), <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data(), <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.size()*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>));</div>
<div class="line"><a name="l03820"></a><span class="lineno"> 3820</span>&#160;}</div>
<div class="line"><a name="l03821"></a><span class="lineno"> 3821</span>&#160; </div>
<div class="line"><a name="l03822"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#ae0cae68d85b27d5eb1d3b27ec4669f3d"> 3822</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ae0cae68d85b27d5eb1d3b27ec4669f3d">CFEM_DG_EulerSolver::Set_NewSolution</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry) {</div>
<div class="line"><a name="l03823"></a><span class="lineno"> 3823</span>&#160; </div>
<div class="line"><a name="l03824"></a><span class="lineno"> 3824</span>&#160;  memcpy(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a492db7771aa00ca8a1b154931b7dd0ef">VecSolDOFsNew</a>.data(), <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data(), <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.size()*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>));</div>
<div class="line"><a name="l03825"></a><span class="lineno"> 3825</span>&#160;}</div>
<div class="line"><a name="l03826"></a><span class="lineno"> 3826</span>&#160; </div>
<div class="line"><a name="l03827"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a041ecaba8cd8d9bcfcec123c27bf9a7a"> 3827</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a041ecaba8cd8d9bcfcec123c27bf9a7a">CFEM_DG_EulerSolver::SetTime_Step</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry, <a class="code" href="class_c_solver.html">CSolver</a> **solver_container, <a class="code" href="class_c_config.html">CConfig</a> *config,</div>
<div class="line"><a name="l03828"></a><span class="lineno"> 3828</span>&#160;                                    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Iteration) {</div>
<div class="line"><a name="l03829"></a><span class="lineno"> 3829</span>&#160; </div>
<div class="line"><a name="l03830"></a><span class="lineno"> 3830</span>&#160;  <span class="comment">/* Check whether or not a time stepping scheme is used. */</span></div>
<div class="line"><a name="l03831"></a><span class="lineno"> 3831</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> time_stepping = config-&gt;<a class="code" href="class_c_config.html#a45e95664235928d911e7c3876fe078b3">GetUnsteady_Simulation</a>() == <a class="code" href="option__structure_8hpp.html#a67e195cd9919c129a4abecd5dec5d9d0ad914f117053e185f2adaab9780d9a50d">TIME_STEPPING</a>;</div>
<div class="line"><a name="l03832"></a><span class="lineno"> 3832</span>&#160; </div>
<div class="line"><a name="l03833"></a><span class="lineno"> 3833</span>&#160;  <span class="comment">/* Initialize the minimum and maximum time step. */</span></div>
<div class="line"><a name="l03834"></a><span class="lineno"> 3834</span>&#160;  <a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a> = 1.e25; <a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a> = 0.0;</div>
<div class="line"><a name="l03835"></a><span class="lineno"> 3835</span>&#160; </div>
<div class="line"><a name="l03836"></a><span class="lineno"> 3836</span>&#160;  <span class="comment">/* Easier storage of the CFL number. Note that if we are using explicit</span></div>
<div class="line"><a name="l03837"></a><span class="lineno"> 3837</span>&#160;<span class="comment">     time stepping, the regular CFL condition has been overwritten with the</span></div>
<div class="line"><a name="l03838"></a><span class="lineno"> 3838</span>&#160;<span class="comment">     unsteady CFL condition in the config post-processing (if non-zero). */</span></div>
<div class="line"><a name="l03839"></a><span class="lineno"> 3839</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> CFL = config-&gt;<a class="code" href="class_c_config.html#a5a509e57de00494a1cb92e011c1c0dbc">GetCFL</a>(iMesh);</div>
<div class="line"><a name="l03840"></a><span class="lineno"> 3840</span>&#160; </div>
<div class="line"><a name="l03841"></a><span class="lineno"> 3841</span>&#160;  <span class="comment">/*--- Explicit time stepping with imposed time step. If the unsteady CFL is</span></div>
<div class="line"><a name="l03842"></a><span class="lineno"> 3842</span>&#160;<span class="comment">        set to zero (default), it uses the defined unsteady time step,</span></div>
<div class="line"><a name="l03843"></a><span class="lineno"> 3843</span>&#160;<span class="comment">        otherwise it computes the time step based on the provided unsteady CFL.</span></div>
<div class="line"><a name="l03844"></a><span class="lineno"> 3844</span>&#160;<span class="comment">        Note that the regular CFL option in the config is always ignored with</span></div>
<div class="line"><a name="l03845"></a><span class="lineno"> 3845</span>&#160;<span class="comment">        time stepping. ---*/</span></div>
<div class="line"><a name="l03846"></a><span class="lineno"> 3846</span>&#160;  <span class="keywordflow">if</span> (time_stepping &amp;&amp; (config-&gt;<a class="code" href="class_c_config.html#a19a4294421a26b0562de1677d6b219ef">GetUnst_CFL</a>() == 0.0)) {</div>
<div class="line"><a name="l03847"></a><span class="lineno"> 3847</span>&#160; </div>
<div class="line"><a name="l03848"></a><span class="lineno"> 3848</span>&#160;    <span class="comment">/*--- Loop over the owned volume elements and set the fixed dt. ---*/</span></div>
<div class="line"><a name="l03849"></a><span class="lineno"> 3849</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++i)</div>
<div class="line"><a name="l03850"></a><span class="lineno"> 3850</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[i] = config-&gt;<a class="code" href="class_c_config.html#a417b45d0da107126e803258901f57920">GetDelta_UnstTimeND</a>();</div>
<div class="line"><a name="l03851"></a><span class="lineno"> 3851</span>&#160; </div>
<div class="line"><a name="l03852"></a><span class="lineno"> 3852</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03853"></a><span class="lineno"> 3853</span>&#160; </div>
<div class="line"><a name="l03854"></a><span class="lineno"> 3854</span>&#160;    <span class="comment">/*--- Check for a compressible solver. ---*/</span></div>
<div class="line"><a name="l03855"></a><span class="lineno"> 3855</span>&#160;    <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a66ca7e620390a81cd49cd0a00716128e">GetKind_Regime</a>() == <a class="code" href="option__structure_8hpp.html#a3d92e0a004752d2ef55cf6c1e2e3d6f0a20621ea72bb142dc0c8bf116a257516a">COMPRESSIBLE</a>) {</div>
<div class="line"><a name="l03856"></a><span class="lineno"> 3856</span>&#160; </div>
<div class="line"><a name="l03857"></a><span class="lineno"> 3857</span>&#160;      <span class="comment">/*--- Loop over the owned volume elements. ---*/</span></div>
<div class="line"><a name="l03858"></a><span class="lineno"> 3858</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++l) {</div>
<div class="line"><a name="l03859"></a><span class="lineno"> 3859</span>&#160; </div>
<div class="line"><a name="l03860"></a><span class="lineno"> 3860</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> charVel2Max = 0.0;</div>
<div class="line"><a name="l03861"></a><span class="lineno"> 3861</span>&#160; </div>
<div class="line"><a name="l03862"></a><span class="lineno"> 3862</span>&#160;        <span class="comment">/*--- Make a distinction between 2D and 3D for optimal performance. ---*/</span></div>
<div class="line"><a name="l03863"></a><span class="lineno"> 3863</span>&#160;        <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l03864"></a><span class="lineno"> 3864</span>&#160; </div>
<div class="line"><a name="l03865"></a><span class="lineno"> 3865</span>&#160;          <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l03866"></a><span class="lineno"> 3866</span>&#160;            <span class="comment">/*--- 2D simulation. Loop over the DOFs of this element</span></div>
<div class="line"><a name="l03867"></a><span class="lineno"> 3867</span>&#160;<span class="comment">                  and determine the maximum wave speed. ---*/</span></div>
<div class="line"><a name="l03868"></a><span class="lineno"> 3868</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++i) {</div>
<div class="line"><a name="l03869"></a><span class="lineno"> 3869</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data()</div>
<div class="line"><a name="l03870"></a><span class="lineno"> 3870</span>&#160;                                       + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i);</div>
<div class="line"><a name="l03871"></a><span class="lineno"> 3871</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data()</div>
<div class="line"><a name="l03872"></a><span class="lineno"> 3872</span>&#160;                                       + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03873"></a><span class="lineno"> 3873</span>&#160; </div>
<div class="line"><a name="l03874"></a><span class="lineno"> 3874</span>&#160;              <span class="comment">/* Compute the velocities and the internal energy per unit mass. */</span></div>
<div class="line"><a name="l03875"></a><span class="lineno"> 3875</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l03876"></a><span class="lineno"> 3876</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l03877"></a><span class="lineno"> 3877</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l03878"></a><span class="lineno"> 3878</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = DensityInv*solDOF[3] - 0.5*(u*u + v*v);</div>
<div class="line"><a name="l03879"></a><span class="lineno"> 3879</span>&#160; </div>
<div class="line"><a name="l03880"></a><span class="lineno"> 3880</span>&#160;              <span class="comment">/*--- Compute the maximum value of the wave speed. This is a rather</span></div>
<div class="line"><a name="l03881"></a><span class="lineno"> 3881</span>&#160;<span class="comment">                    conservative estimate. ---*/</span></div>
<div class="line"><a name="l03882"></a><span class="lineno"> 3882</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l03883"></a><span class="lineno"> 3883</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed2 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a8c0910de10905f2ddcf02f1a9bb7ff61">GetSoundSpeed2</a>();</div>
<div class="line"><a name="l03884"></a><span class="lineno"> 3884</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed  = sqrt(fabs(SoundSpeed2));</div>
<div class="line"><a name="l03885"></a><span class="lineno"> 3885</span>&#160; </div>
<div class="line"><a name="l03886"></a><span class="lineno"> 3886</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radx     = fabs(u-gridVel[0]) + SoundSpeed;</div>
<div class="line"><a name="l03887"></a><span class="lineno"> 3887</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rady     = fabs(v-gridVel[1]) + SoundSpeed;</div>
<div class="line"><a name="l03888"></a><span class="lineno"> 3888</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> charVel2 = radx*radx + rady*rady;</div>
<div class="line"><a name="l03889"></a><span class="lineno"> 3889</span>&#160; </div>
<div class="line"><a name="l03890"></a><span class="lineno"> 3890</span>&#160;              charVel2Max = max(charVel2Max, charVel2);</div>
<div class="line"><a name="l03891"></a><span class="lineno"> 3891</span>&#160;            }</div>
<div class="line"><a name="l03892"></a><span class="lineno"> 3892</span>&#160; </div>
<div class="line"><a name="l03893"></a><span class="lineno"> 3893</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03894"></a><span class="lineno"> 3894</span>&#160;          }</div>
<div class="line"><a name="l03895"></a><span class="lineno"> 3895</span>&#160; </div>
<div class="line"><a name="l03896"></a><span class="lineno"> 3896</span>&#160;          <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l03897"></a><span class="lineno"> 3897</span>&#160;            <span class="comment">/*--- 3D simulation. Loop over the DOFs of this element</span></div>
<div class="line"><a name="l03898"></a><span class="lineno"> 3898</span>&#160;<span class="comment">                  and determine the maximum wave speed. ---*/</span></div>
<div class="line"><a name="l03899"></a><span class="lineno"> 3899</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++i) {</div>
<div class="line"><a name="l03900"></a><span class="lineno"> 3900</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data()</div>
<div class="line"><a name="l03901"></a><span class="lineno"> 3901</span>&#160;                                      + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i);</div>
<div class="line"><a name="l03902"></a><span class="lineno"> 3902</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data()</div>
<div class="line"><a name="l03903"></a><span class="lineno"> 3903</span>&#160;                                       + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l03904"></a><span class="lineno"> 3904</span>&#160; </div>
<div class="line"><a name="l03905"></a><span class="lineno"> 3905</span>&#160;              <span class="comment">/* Compute the velocities and the internal energy per unit mass. */</span></div>
<div class="line"><a name="l03906"></a><span class="lineno"> 3906</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l03907"></a><span class="lineno"> 3907</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l03908"></a><span class="lineno"> 3908</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l03909"></a><span class="lineno"> 3909</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w            = DensityInv*solDOF[3];</div>
<div class="line"><a name="l03910"></a><span class="lineno"> 3910</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = DensityInv*solDOF[4] - 0.5*(u*u + v*v + w*w);</div>
<div class="line"><a name="l03911"></a><span class="lineno"> 3911</span>&#160; </div>
<div class="line"><a name="l03912"></a><span class="lineno"> 3912</span>&#160;              <span class="comment">/*--- Compute the maximum value of the wave speed. This is a rather</span></div>
<div class="line"><a name="l03913"></a><span class="lineno"> 3913</span>&#160;<span class="comment">                    conservative estimate. ---*/</span></div>
<div class="line"><a name="l03914"></a><span class="lineno"> 3914</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l03915"></a><span class="lineno"> 3915</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed2 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a8c0910de10905f2ddcf02f1a9bb7ff61">GetSoundSpeed2</a>();</div>
<div class="line"><a name="l03916"></a><span class="lineno"> 3916</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed  = sqrt(fabs(SoundSpeed2));</div>
<div class="line"><a name="l03917"></a><span class="lineno"> 3917</span>&#160; </div>
<div class="line"><a name="l03918"></a><span class="lineno"> 3918</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radx     = fabs(u-gridVel[0]) + SoundSpeed;</div>
<div class="line"><a name="l03919"></a><span class="lineno"> 3919</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rady     = fabs(v-gridVel[1]) + SoundSpeed;</div>
<div class="line"><a name="l03920"></a><span class="lineno"> 3920</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radz     = fabs(w-gridVel[2]) + SoundSpeed;</div>
<div class="line"><a name="l03921"></a><span class="lineno"> 3921</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> charVel2 = radx*radx + rady*rady + radz*radz;</div>
<div class="line"><a name="l03922"></a><span class="lineno"> 3922</span>&#160; </div>
<div class="line"><a name="l03923"></a><span class="lineno"> 3923</span>&#160;              charVel2Max = max(charVel2Max, charVel2);</div>
<div class="line"><a name="l03924"></a><span class="lineno"> 3924</span>&#160;            }</div>
<div class="line"><a name="l03925"></a><span class="lineno"> 3925</span>&#160; </div>
<div class="line"><a name="l03926"></a><span class="lineno"> 3926</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l03927"></a><span class="lineno"> 3927</span>&#160;          }</div>
<div class="line"><a name="l03928"></a><span class="lineno"> 3928</span>&#160;        }</div>
<div class="line"><a name="l03929"></a><span class="lineno"> 3929</span>&#160; </div>
<div class="line"><a name="l03930"></a><span class="lineno"> 3930</span>&#160;        <span class="comment">/*--- Compute the time step for the element and update the minimum and</span></div>
<div class="line"><a name="l03931"></a><span class="lineno"> 3931</span>&#160;<span class="comment">              maximum value. Take the factor for time accurate local time</span></div>
<div class="line"><a name="l03932"></a><span class="lineno"> 3932</span>&#160;<span class="comment">              stepping into account for the minimum and maximum. Note that in</span></div>
<div class="line"><a name="l03933"></a><span class="lineno"> 3933</span>&#160;<span class="comment">              the length scale the polynomial degree must be taken into account</span></div>
<div class="line"><a name="l03934"></a><span class="lineno"> 3934</span>&#160;<span class="comment">              for the high order element. ---*/</span></div>
<div class="line"><a name="l03935"></a><span class="lineno"> 3935</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l03936"></a><span class="lineno"> 3936</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l03937"></a><span class="lineno"> 3937</span>&#160;        <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l03938"></a><span class="lineno"> 3938</span>&#160; </div>
<div class="line"><a name="l03939"></a><span class="lineno"> 3939</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScaleInv = nPoly/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>;</div>
<div class="line"><a name="l03940"></a><span class="lineno"> 3940</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtInv       = lenScaleInv*sqrt(charVel2Max);</div>
<div class="line"><a name="l03941"></a><span class="lineno"> 3941</span>&#160; </div>
<div class="line"><a name="l03942"></a><span class="lineno"> 3942</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l] = CFL/dtInv;</div>
<div class="line"><a name="l03943"></a><span class="lineno"> 3943</span>&#160; </div>
<div class="line"><a name="l03944"></a><span class="lineno"> 3944</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtEff = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#aa9c40460f4f77c1d43a99e7a77e595ca">factTimeLevel</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l];</div>
<div class="line"><a name="l03945"></a><span class="lineno"> 3945</span>&#160;        <a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a> = min(<a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>, dtEff);</div>
<div class="line"><a name="l03946"></a><span class="lineno"> 3946</span>&#160;        <a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a> = max(<a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a>, dtEff);</div>
<div class="line"><a name="l03947"></a><span class="lineno"> 3947</span>&#160;      }</div>
<div class="line"><a name="l03948"></a><span class="lineno"> 3948</span>&#160;    }</div>
<div class="line"><a name="l03949"></a><span class="lineno"> 3949</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l03950"></a><span class="lineno"> 3950</span>&#160; </div>
<div class="line"><a name="l03951"></a><span class="lineno"> 3951</span>&#160;      <span class="comment">/*--- Incompressible solver. ---*/</span></div>
<div class="line"><a name="l03952"></a><span class="lineno"> 3952</span>&#160; </div>
<div class="line"><a name="l03953"></a><span class="lineno"> 3953</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;Incompressible solver not implemented yet&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l03954"></a><span class="lineno"> 3954</span>&#160;    }</div>
<div class="line"><a name="l03955"></a><span class="lineno"> 3955</span>&#160; </div>
<div class="line"><a name="l03956"></a><span class="lineno"> 3956</span>&#160;    <span class="comment">/*--- Compute the max and the min dt (in parallel). Note that we only</span></div>
<div class="line"><a name="l03957"></a><span class="lineno"> 3957</span>&#160;<span class="comment">          do this for steady calculations if the high verbosity is set, but we</span></div>
<div class="line"><a name="l03958"></a><span class="lineno"> 3958</span>&#160;<span class="comment">          always perform the reduction for unsteady calculations where the CFL</span></div>
<div class="line"><a name="l03959"></a><span class="lineno"> 3959</span>&#160;<span class="comment">          limit is used to set the global time step. ---*/</span></div>
<div class="line"><a name="l03960"></a><span class="lineno"> 3960</span>&#160;    <span class="keywordflow">if</span> ((config-&gt;<a class="code" href="class_c_config.html#aa878788c30e1c7c3ed4788e485bd2fb0">GetConsole_Output_Verb</a>() == <a class="code" href="option__structure_8hpp.html#ae40552e21f517bdde7c1a26de77b3e11a686b9a708a0e02450f0b19f485e7e96c">VERB_HIGH</a>) || time_stepping) {</div>
<div class="line"><a name="l03961"></a><span class="lineno"> 3961</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l03962"></a><span class="lineno"> 3962</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rbuf_time = <a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>;</div>
<div class="line"><a name="l03963"></a><span class="lineno"> 3963</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(&amp;rbuf_time, &amp;<a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#aa2fecfa16d35e8fa3894c512a527b73f">MPI_MIN</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l03964"></a><span class="lineno"> 3964</span>&#160; </div>
<div class="line"><a name="l03965"></a><span class="lineno"> 3965</span>&#160;      rbuf_time = <a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a>;</div>
<div class="line"><a name="l03966"></a><span class="lineno"> 3966</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(&amp;rbuf_time, &amp;<a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#a80d80987b473f4a13b0cc0384eddb51b">MPI_MAX</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l03967"></a><span class="lineno"> 3967</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l03968"></a><span class="lineno"> 3968</span>&#160;    }</div>
<div class="line"><a name="l03969"></a><span class="lineno"> 3969</span>&#160; </div>
<div class="line"><a name="l03970"></a><span class="lineno"> 3970</span>&#160;    <span class="comment">/*--- For explicit time stepping with an unsteady CFL imposed, use the</span></div>
<div class="line"><a name="l03971"></a><span class="lineno"> 3971</span>&#160;<span class="comment">          minimum delta time of the entire mesh. As Min_Delta_Time is scaled to</span></div>
<div class="line"><a name="l03972"></a><span class="lineno"> 3972</span>&#160;<span class="comment">          the time step of the largest time level, a correction must be used</span></div>
<div class="line"><a name="l03973"></a><span class="lineno"> 3973</span>&#160;<span class="comment">          for the time level when time accurate local time stepping is used. ---*/</span></div>
<div class="line"><a name="l03974"></a><span class="lineno"> 3974</span>&#160;    <span class="keywordflow">if</span> (time_stepping) {</div>
<div class="line"><a name="l03975"></a><span class="lineno"> 3975</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++l)</div>
<div class="line"><a name="l03976"></a><span class="lineno"> 3976</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l] = <a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].factTimeLevel;</div>
<div class="line"><a name="l03977"></a><span class="lineno"> 3977</span>&#160;    }</div>
<div class="line"><a name="l03978"></a><span class="lineno"> 3978</span>&#160;  }</div>
<div class="line"><a name="l03979"></a><span class="lineno"> 3979</span>&#160;}</div>
<div class="line"><a name="l03980"></a><span class="lineno"> 3980</span>&#160; </div>
<div class="line"><a name="l03981"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a5220631548af87d689c9b4acb38b7a1c"> 3981</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5220631548af87d689c9b4acb38b7a1c">CFEM_DG_EulerSolver::CheckTimeSynchronization</a>(<a class="code" href="class_c_config.html">CConfig</a>         *config,</div>
<div class="line"><a name="l03982"></a><span class="lineno"> 3982</span>&#160;                                                   <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TimeSync,</div>
<div class="line"><a name="l03983"></a><span class="lineno"> 3983</span>&#160;                                                   <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       &amp;timeEvolved,</div>
<div class="line"><a name="l03984"></a><span class="lineno"> 3984</span>&#160;                                                   <span class="keywordtype">bool</span>            &amp;syncTimeReached) {</div>
<div class="line"><a name="l03985"></a><span class="lineno"> 3985</span>&#160; </div>
<div class="line"><a name="l03986"></a><span class="lineno"> 3986</span>&#160;  <span class="comment">/* Check if this is the first time this check is carried out</span></div>
<div class="line"><a name="l03987"></a><span class="lineno"> 3987</span>&#160;<span class="comment">     and determine the new time evolved. */</span></div>
<div class="line"><a name="l03988"></a><span class="lineno"> 3988</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> firstTime = timeEvolved == 0.0;</div>
<div class="line"><a name="l03989"></a><span class="lineno"> 3989</span>&#160;  timeEvolved         += <a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>;</div>
<div class="line"><a name="l03990"></a><span class="lineno"> 3990</span>&#160; </div>
<div class="line"><a name="l03991"></a><span class="lineno"> 3991</span>&#160;  <span class="comment">/*--- Check for a (too) small a value for the synchronization time and</span></div>
<div class="line"><a name="l03992"></a><span class="lineno"> 3992</span>&#160;<span class="comment">        print a warning if this happens. ---*/</span></div>
<div class="line"><a name="l03993"></a><span class="lineno"> 3993</span>&#160;  <span class="keywordflow">if</span>(firstTime &amp;&amp; timeEvolved &gt;= 1.5*TimeSync) {</div>
<div class="line"><a name="l03994"></a><span class="lineno"> 3994</span>&#160; </div>
<div class="line"><a name="l03995"></a><span class="lineno"> 3995</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>) {</div>
<div class="line"><a name="l03996"></a><span class="lineno"> 3996</span>&#160;      cout &lt;&lt; endl &lt;&lt; <span class="stringliteral">&quot;              WARNING&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03997"></a><span class="lineno"> 3997</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;The specified synchronization time is &quot;</span> &lt;&lt; timeEvolved/TimeSync</div>
<div class="line"><a name="l03998"></a><span class="lineno"> 3998</span>&#160;           &lt;&lt; <span class="stringliteral">&quot; times smaller than the time step for stability&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l03999"></a><span class="lineno"> 3999</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;This is inefficient!!!!!&quot;</span> &lt;&lt; endl &lt;&lt; endl;</div>
<div class="line"><a name="l04000"></a><span class="lineno"> 4000</span>&#160;    }</div>
<div class="line"><a name="l04001"></a><span class="lineno"> 4001</span>&#160;  }</div>
<div class="line"><a name="l04002"></a><span class="lineno"> 4002</span>&#160; </div>
<div class="line"><a name="l04003"></a><span class="lineno"> 4003</span>&#160;  <span class="comment">/*--- If the current value of timeEvolved is larger or equal than the</span></div>
<div class="line"><a name="l04004"></a><span class="lineno"> 4004</span>&#160;<span class="comment">        synchronization time, syncTimeReached is set to true and a correction</span></div>
<div class="line"><a name="l04005"></a><span class="lineno"> 4005</span>&#160;<span class="comment">        to the time step is carried out. The factor for the time accurate local</span></div>
<div class="line"><a name="l04006"></a><span class="lineno"> 4006</span>&#160;<span class="comment">        time stepping must be taken into account. If the synchronization time</span></div>
<div class="line"><a name="l04007"></a><span class="lineno"> 4007</span>&#160;<span class="comment">        has not been reached yet, syncTimeReached is set to false. ---*/</span></div>
<div class="line"><a name="l04008"></a><span class="lineno"> 4008</span>&#160;  <span class="keywordflow">if</span>(timeEvolved &gt;= TimeSync) {</div>
<div class="line"><a name="l04009"></a><span class="lineno"> 4009</span>&#160;    syncTimeReached = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04010"></a><span class="lineno"> 4010</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> newDeltaTime = <a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a> + (TimeSync - timeEvolved);</div>
<div class="line"><a name="l04011"></a><span class="lineno"> 4011</span>&#160; </div>
<div class="line"><a name="l04012"></a><span class="lineno"> 4012</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++i)</div>
<div class="line"><a name="l04013"></a><span class="lineno"> 4013</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[i] = newDeltaTime/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[i].factTimeLevel;</div>
<div class="line"><a name="l04014"></a><span class="lineno"> 4014</span>&#160;  }</div>
<div class="line"><a name="l04015"></a><span class="lineno"> 4015</span>&#160;  <span class="keywordflow">else</span> syncTimeReached = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04016"></a><span class="lineno"> 4016</span>&#160;}</div>
<div class="line"><a name="l04017"></a><span class="lineno"> 4017</span>&#160; </div>
<div class="line"><a name="l04018"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a651cad1a94f2024c75a1a8be347e3375"> 4018</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a651cad1a94f2024c75a1a8be347e3375">CFEM_DG_EulerSolver::ProcessTaskList_DG</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry,  <a class="code" href="class_c_solver.html">CSolver</a> **solver_container,</div>
<div class="line"><a name="l04019"></a><span class="lineno"> 4019</span>&#160;                                             <a class="code" href="class_c_numerics.html">CNumerics</a> **numerics, <a class="code" href="class_c_config.html">CConfig</a> *config,</div>
<div class="line"><a name="l04020"></a><span class="lineno"> 4020</span>&#160;                                             <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh) {</div>
<div class="line"><a name="l04021"></a><span class="lineno"> 4021</span>&#160;  <span class="comment">/* Easier storage of the number of time levels.. */</span></div>
<div class="line"><a name="l04022"></a><span class="lineno"> 4022</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeLevels = config-&gt;<a class="code" href="class_c_config.html#a957e791919e7c6947131c06aedc7ff8d">GetnLevels_TimeAccurateLTS</a>();</div>
<div class="line"><a name="l04023"></a><span class="lineno"> 4023</span>&#160; </div>
<div class="line"><a name="l04024"></a><span class="lineno"> 4024</span>&#160;  <span class="comment">/* Define and initialize the bool vector, that indicates whether or</span></div>
<div class="line"><a name="l04025"></a><span class="lineno"> 4025</span>&#160;<span class="comment">     not the tasks from the list have been completed. */</span></div>
<div class="line"><a name="l04026"></a><span class="lineno"> 4026</span>&#160;  vector&lt;bool&gt; taskCompleted(tasksList.size(), <span class="keyword">false</span>);</div>
<div class="line"><a name="l04027"></a><span class="lineno"> 4027</span>&#160; </div>
<div class="line"><a name="l04028"></a><span class="lineno"> 4028</span>&#160;  <span class="comment">/* Allocate the memory for the work array and initialize it to zero to avoid</span></div>
<div class="line"><a name="l04029"></a><span class="lineno"> 4029</span>&#160;<span class="comment">     warnings in debug mode  about uninitialized memory when padding is applied. */</span></div>
<div class="line"><a name="l04030"></a><span class="lineno"> 4030</span>&#160;  vector&lt;su2double&gt; workArrayVec(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a95cef33ccbfa61def433d11ddef5745d">sizeWorkArray</a>, 0.0);</div>
<div class="line"><a name="l04031"></a><span class="lineno"> 4031</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *workArray = workArrayVec.data();</div>
<div class="line"><a name="l04032"></a><span class="lineno"> 4032</span>&#160; </div>
<div class="line"><a name="l04033"></a><span class="lineno"> 4033</span>&#160;  <span class="comment">/* While loop to carry out all the tasks in tasksList. */</span></div>
<div class="line"><a name="l04034"></a><span class="lineno"> 4034</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lowestIndexInList = 0;</div>
<div class="line"><a name="l04035"></a><span class="lineno"> 4035</span>&#160;  <span class="keywordflow">while</span>(lowestIndexInList &lt; tasksList.size()) {</div>
<div class="line"><a name="l04036"></a><span class="lineno"> 4036</span>&#160; </div>
<div class="line"><a name="l04037"></a><span class="lineno"> 4037</span>&#160;    <span class="comment">/* Find the next task that can be carried out. The outer loop is there</span></div>
<div class="line"><a name="l04038"></a><span class="lineno"> 4038</span>&#160;<span class="comment">       to make sure that a communication is completed in case there are no</span></div>
<div class="line"><a name="l04039"></a><span class="lineno"> 4039</span>&#160;<span class="comment">       other tasks */</span></div>
<div class="line"><a name="l04040"></a><span class="lineno"> 4040</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;2; ++j) {</div>
<div class="line"><a name="l04041"></a><span class="lineno"> 4041</span>&#160;      <span class="keywordtype">bool</span> taskCarriedOut = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04042"></a><span class="lineno"> 4042</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=lowestIndexInList; i&lt;tasksList.size(); ++i) {</div>
<div class="line"><a name="l04043"></a><span class="lineno"> 4043</span>&#160; </div>
<div class="line"><a name="l04044"></a><span class="lineno"> 4044</span>&#160;        <span class="comment">/* Determine whether or not it can be attempted to carry out</span></div>
<div class="line"><a name="l04045"></a><span class="lineno"> 4045</span>&#160;<span class="comment">           this task. */</span></div>
<div class="line"><a name="l04046"></a><span class="lineno"> 4046</span>&#160;        <span class="keywordtype">bool</span> taskCanBeCarriedOut = !taskCompleted[i];</div>
<div class="line"><a name="l04047"></a><span class="lineno"> 4047</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind=0; ind&lt;tasksList[i].nIndMustBeCompleted; ++ind) {</div>
<div class="line"><a name="l04048"></a><span class="lineno"> 4048</span>&#160;          <span class="keywordflow">if</span>( !taskCompleted[tasksList[i].indMustBeCompleted[ind]] )</div>
<div class="line"><a name="l04049"></a><span class="lineno"> 4049</span>&#160;            taskCanBeCarriedOut = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04050"></a><span class="lineno"> 4050</span>&#160;        }</div>
<div class="line"><a name="l04051"></a><span class="lineno"> 4051</span>&#160; </div>
<div class="line"><a name="l04052"></a><span class="lineno"> 4052</span>&#160;        <span class="keywordflow">if</span>( taskCanBeCarriedOut ) {</div>
<div class="line"><a name="l04053"></a><span class="lineno"> 4053</span>&#160; </div>
<div class="line"><a name="l04054"></a><span class="lineno"> 4054</span>&#160;          <span class="comment">/*--- Determine the actual task to be carried out and do so. The</span></div>
<div class="line"><a name="l04055"></a><span class="lineno"> 4055</span>&#160;<span class="comment">                only tasks that may fail are the completion of the non-blocking</span></div>
<div class="line"><a name="l04056"></a><span class="lineno"> 4056</span>&#160;<span class="comment">                communication. If that is the case the next task needs to be</span></div>
<div class="line"><a name="l04057"></a><span class="lineno"> 4057</span>&#160;<span class="comment">                found. ---*/</span></div>
<div class="line"><a name="l04058"></a><span class="lineno"> 4058</span>&#160;          <span class="keywordflow">switch</span>( tasksList[i].task ) {</div>
<div class="line"><a name="l04059"></a><span class="lineno"> 4059</span>&#160; </div>
<div class="line"><a name="l04060"></a><span class="lineno"> 4060</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a>: {</div>
<div class="line"><a name="l04061"></a><span class="lineno"> 4061</span>&#160; </div>
<div class="line"><a name="l04062"></a><span class="lineno"> 4062</span>&#160;              <span class="comment">/* Carry out the ADER predictor step for the elements whose</span></div>
<div class="line"><a name="l04063"></a><span class="lineno"> 4063</span>&#160;<span class="comment">                 solution must be communicated for this time level. */</span></div>
<div class="line"><a name="l04064"></a><span class="lineno"> 4064</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level   = tasksList[i].timeLevel;</div>
<div class="line"><a name="l04065"></a><span class="lineno"> 4065</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elemBeg = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level]</div>
<div class="line"><a name="l04066"></a><span class="lineno"> 4066</span>&#160;                                           + <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7f54ebf747f54031baaa79339ff5503f">nVolElemInternalPerTimeLevel</a>[level];</div>
<div class="line"><a name="l04067"></a><span class="lineno"> 4067</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elemEnd = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level+1];</div>
<div class="line"><a name="l04068"></a><span class="lineno"> 4068</span>&#160; </div>
<div class="line"><a name="l04069"></a><span class="lineno"> 4069</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a53f3bd445632823baa18657a29553842">ADER_DG_PredictorStep</a>(config, elemBeg, elemEnd, workArray);</div>
<div class="line"><a name="l04070"></a><span class="lineno"> 4070</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04071"></a><span class="lineno"> 4071</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04072"></a><span class="lineno"> 4072</span>&#160;            }</div>
<div class="line"><a name="l04073"></a><span class="lineno"> 4073</span>&#160; </div>
<div class="line"><a name="l04074"></a><span class="lineno"> 4074</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a36f92d9c7d2f67190ce5da2cc0dfb885">CTaskDefinition::ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS</a>: {</div>
<div class="line"><a name="l04075"></a><span class="lineno"> 4075</span>&#160; </div>
<div class="line"><a name="l04076"></a><span class="lineno"> 4076</span>&#160;              <span class="comment">/* Carry out the ADER predictor step for the elements whose</span></div>
<div class="line"><a name="l04077"></a><span class="lineno"> 4077</span>&#160;<span class="comment">                 solution must not be communicated for this time level. */</span></div>
<div class="line"><a name="l04078"></a><span class="lineno"> 4078</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level   = tasksList[i].timeLevel;</div>
<div class="line"><a name="l04079"></a><span class="lineno"> 4079</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elemBeg = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level];</div>
<div class="line"><a name="l04080"></a><span class="lineno"> 4080</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elemEnd = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level]</div>
<div class="line"><a name="l04081"></a><span class="lineno"> 4081</span>&#160;                                           + <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7f54ebf747f54031baaa79339ff5503f">nVolElemInternalPerTimeLevel</a>[level];</div>
<div class="line"><a name="l04082"></a><span class="lineno"> 4082</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a53f3bd445632823baa18657a29553842">ADER_DG_PredictorStep</a>(config, elemBeg, elemEnd, workArray);</div>
<div class="line"><a name="l04083"></a><span class="lineno"> 4083</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04084"></a><span class="lineno"> 4084</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04085"></a><span class="lineno"> 4085</span>&#160;            }</div>
<div class="line"><a name="l04086"></a><span class="lineno"> 4086</span>&#160; </div>
<div class="line"><a name="l04087"></a><span class="lineno"> 4087</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a38b0ce8cd837938d82de2e50ec9e2a2a">CTaskDefinition::INITIATE_MPI_COMMUNICATION</a>: {</div>
<div class="line"><a name="l04088"></a><span class="lineno"> 4088</span>&#160; </div>
<div class="line"><a name="l04089"></a><span class="lineno"> 4089</span>&#160;              <span class="comment">/* Start the MPI communication of the solution in the halo elements. */</span></div>
<div class="line"><a name="l04090"></a><span class="lineno"> 4090</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4dade05b74d3e36f5b2c91d0a6fa46">Initiate_MPI_Communication</a>(config, tasksList[i].timeLevel);</div>
<div class="line"><a name="l04091"></a><span class="lineno"> 4091</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04092"></a><span class="lineno"> 4092</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04093"></a><span class="lineno"> 4093</span>&#160;            }</div>
<div class="line"><a name="l04094"></a><span class="lineno"> 4094</span>&#160; </div>
<div class="line"><a name="l04095"></a><span class="lineno"> 4095</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a7c76da9a0dfec35be76a43ae8c059c9e">CTaskDefinition::COMPLETE_MPI_COMMUNICATION</a>: {</div>
<div class="line"><a name="l04096"></a><span class="lineno"> 4096</span>&#160; </div>
<div class="line"><a name="l04097"></a><span class="lineno"> 4097</span>&#160;              <span class="comment">/* Attempt to complete the MPI communication of the solution data.</span></div>
<div class="line"><a name="l04098"></a><span class="lineno"> 4098</span>&#160;<span class="comment">                 For j==0, SU2_MPI::Testall will be used, which returns false if</span></div>
<div class="line"><a name="l04099"></a><span class="lineno"> 4099</span>&#160;<span class="comment">                 not all requests can be completed. In that case the next task on</span></div>
<div class="line"><a name="l04100"></a><span class="lineno"> 4100</span>&#160;<span class="comment">                 the list is carried out. If j==1, this means that the next</span></div>
<div class="line"><a name="l04101"></a><span class="lineno"> 4101</span>&#160;<span class="comment">                 tasks are waiting for this communication to be completed and</span></div>
<div class="line"><a name="l04102"></a><span class="lineno"> 4102</span>&#160;<span class="comment">                 hence MPI_Waitall is used. */</span></div>
<div class="line"><a name="l04103"></a><span class="lineno"> 4103</span>&#160;              <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad3428a192cfff4925a3ce854866119de">Complete_MPI_Communication</a>(config, tasksList[i].timeLevel,</div>
<div class="line"><a name="l04104"></a><span class="lineno"> 4104</span>&#160;                                             j==1) )</div>
<div class="line"><a name="l04105"></a><span class="lineno"> 4105</span>&#160;                taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04106"></a><span class="lineno"> 4106</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04107"></a><span class="lineno"> 4107</span>&#160;            }</div>
<div class="line"><a name="l04108"></a><span class="lineno"> 4108</span>&#160; </div>
<div class="line"><a name="l04109"></a><span class="lineno"> 4109</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a223498245ffb57eb996c758cb9bcff43">CTaskDefinition::INITIATE_REVERSE_MPI_COMMUNICATION</a>: {</div>
<div class="line"><a name="l04110"></a><span class="lineno"> 4110</span>&#160; </div>
<div class="line"><a name="l04111"></a><span class="lineno"> 4111</span>&#160;              <span class="comment">/* Start the communication of the residuals, for which the</span></div>
<div class="line"><a name="l04112"></a><span class="lineno"> 4112</span>&#160;<span class="comment">                 reverse communication must be used. */</span></div>
<div class="line"><a name="l04113"></a><span class="lineno"> 4113</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a59148852103da2fb75a30e40f7ea4eb4">Initiate_MPI_ReverseCommunication</a>(config, tasksList[i].timeLevel);</div>
<div class="line"><a name="l04114"></a><span class="lineno"> 4114</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04115"></a><span class="lineno"> 4115</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04116"></a><span class="lineno"> 4116</span>&#160;            }</div>
<div class="line"><a name="l04117"></a><span class="lineno"> 4117</span>&#160; </div>
<div class="line"><a name="l04118"></a><span class="lineno"> 4118</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aecf3a269d02eb493020bceecf4262415">CTaskDefinition::COMPLETE_REVERSE_MPI_COMMUNICATION</a>: {</div>
<div class="line"><a name="l04119"></a><span class="lineno"> 4119</span>&#160; </div>
<div class="line"><a name="l04120"></a><span class="lineno"> 4120</span>&#160;              <span class="comment">/* Attempt to complete the MPI communication of the residual data.</span></div>
<div class="line"><a name="l04121"></a><span class="lineno"> 4121</span>&#160;<span class="comment">                 For j==0, SU2_MPI::Testall will be used, which returns false if</span></div>
<div class="line"><a name="l04122"></a><span class="lineno"> 4122</span>&#160;<span class="comment">                 not all requests can be completed. In that case the next task on</span></div>
<div class="line"><a name="l04123"></a><span class="lineno"> 4123</span>&#160;<span class="comment">                 the list is carried out. If j==1, this means that the next</span></div>
<div class="line"><a name="l04124"></a><span class="lineno"> 4124</span>&#160;<span class="comment">                 tasks are waiting for this communication to be completed and</span></div>
<div class="line"><a name="l04125"></a><span class="lineno"> 4125</span>&#160;<span class="comment">                 hence MPI_Waitall is used. */</span></div>
<div class="line"><a name="l04126"></a><span class="lineno"> 4126</span>&#160;              <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af5891c1fd8de49fe774a68cd7bc0b6ec">Complete_MPI_ReverseCommunication</a>(config, tasksList[i].timeLevel,</div>
<div class="line"><a name="l04127"></a><span class="lineno"> 4127</span>&#160;                                                    j==1) )</div>
<div class="line"><a name="l04128"></a><span class="lineno"> 4128</span>&#160;                taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04129"></a><span class="lineno"> 4129</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04130"></a><span class="lineno"> 4130</span>&#160;            }</div>
<div class="line"><a name="l04131"></a><span class="lineno"> 4131</span>&#160; </div>
<div class="line"><a name="l04132"></a><span class="lineno"> 4132</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ad0d58281f452d4daa9507dd35d948f3b">CTaskDefinition::ADER_TIME_INTERPOLATE_OWNED_ELEMENTS</a>: {</div>
<div class="line"><a name="l04133"></a><span class="lineno"> 4133</span>&#160; </div>
<div class="line"><a name="l04134"></a><span class="lineno"> 4134</span>&#160;              <span class="comment">/* Interpolate the predictor solution of the owned elements</span></div>
<div class="line"><a name="l04135"></a><span class="lineno"> 4135</span>&#160;<span class="comment">                 in time to the given time integration point for the</span></div>
<div class="line"><a name="l04136"></a><span class="lineno"> 4136</span>&#160;<span class="comment">                 given time level. */</span></div>
<div class="line"><a name="l04137"></a><span class="lineno"> 4137</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level = tasksList[i].timeLevel;</div>
<div class="line"><a name="l04138"></a><span class="lineno"> 4138</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nAdjElem = 0, *adjElem = NULL;</div>
<div class="line"><a name="l04139"></a><span class="lineno"> 4139</span>&#160;              <span class="keywordflow">if</span>(level &lt; (nTimeLevels-1)) {</div>
<div class="line"><a name="l04140"></a><span class="lineno"> 4140</span>&#160;                nAdjElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad1f55a7f9d7d977e9dbae3182131673f">ownedElemAdjLowTimeLevel</a>[level+1].size();</div>
<div class="line"><a name="l04141"></a><span class="lineno"> 4141</span>&#160;                adjElem  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad1f55a7f9d7d977e9dbae3182131673f">ownedElemAdjLowTimeLevel</a>[level+1].data();</div>
<div class="line"><a name="l04142"></a><span class="lineno"> 4142</span>&#160;              }</div>
<div class="line"><a name="l04143"></a><span class="lineno"> 4143</span>&#160; </div>
<div class="line"><a name="l04144"></a><span class="lineno"> 4144</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a541316bc7d1623f16e839578dc9a4aa9">ADER_DG_TimeInterpolatePredictorSol</a>(config, tasksList[i].intPointADER,</div>
<div class="line"><a name="l04145"></a><span class="lineno"> 4145</span>&#160;                                                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level],</div>
<div class="line"><a name="l04146"></a><span class="lineno"> 4146</span>&#160;                                                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level+1],</div>
<div class="line"><a name="l04147"></a><span class="lineno"> 4147</span>&#160;                                                  nAdjElem, adjElem,</div>
<div class="line"><a name="l04148"></a><span class="lineno"> 4148</span>&#160;                                                  tasksList[i].secondPartTimeIntADER,</div>
<div class="line"><a name="l04149"></a><span class="lineno"> 4149</span>&#160;                                                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[level].data());</div>
<div class="line"><a name="l04150"></a><span class="lineno"> 4150</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04151"></a><span class="lineno"> 4151</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04152"></a><span class="lineno"> 4152</span>&#160;            }</div>
<div class="line"><a name="l04153"></a><span class="lineno"> 4153</span>&#160; </div>
<div class="line"><a name="l04154"></a><span class="lineno"> 4154</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a8d40e9069e07e9a58bfaebe57d05bbbd">CTaskDefinition::ADER_TIME_INTERPOLATE_HALO_ELEMENTS</a>: {</div>
<div class="line"><a name="l04155"></a><span class="lineno"> 4155</span>&#160; </div>
<div class="line"><a name="l04156"></a><span class="lineno"> 4156</span>&#160;              <span class="comment">/* Interpolate the predictor solution of the halo elements</span></div>
<div class="line"><a name="l04157"></a><span class="lineno"> 4157</span>&#160;<span class="comment">                 in time to the given time integration point for the</span></div>
<div class="line"><a name="l04158"></a><span class="lineno"> 4158</span>&#160;<span class="comment">                 given time level. */</span></div>
<div class="line"><a name="l04159"></a><span class="lineno"> 4159</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level = tasksList[i].timeLevel;</div>
<div class="line"><a name="l04160"></a><span class="lineno"> 4160</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nAdjElem = 0, *adjElem = NULL;</div>
<div class="line"><a name="l04161"></a><span class="lineno"> 4161</span>&#160;              <span class="keywordflow">if</span>(level &lt; (nTimeLevels-1)) {</div>
<div class="line"><a name="l04162"></a><span class="lineno"> 4162</span>&#160;                nAdjElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4856180300943d0a34620292be9fb44c">haloElemAdjLowTimeLevel</a>[level+1].size();</div>
<div class="line"><a name="l04163"></a><span class="lineno"> 4163</span>&#160;                adjElem  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4856180300943d0a34620292be9fb44c">haloElemAdjLowTimeLevel</a>[level+1].data();</div>
<div class="line"><a name="l04164"></a><span class="lineno"> 4164</span>&#160;              }</div>
<div class="line"><a name="l04165"></a><span class="lineno"> 4165</span>&#160; </div>
<div class="line"><a name="l04166"></a><span class="lineno"> 4166</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a541316bc7d1623f16e839578dc9a4aa9">ADER_DG_TimeInterpolatePredictorSol</a>(config, tasksList[i].intPointADER,</div>
<div class="line"><a name="l04167"></a><span class="lineno"> 4167</span>&#160;                                                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[level],</div>
<div class="line"><a name="l04168"></a><span class="lineno"> 4168</span>&#160;                                                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[level+1],</div>
<div class="line"><a name="l04169"></a><span class="lineno"> 4169</span>&#160;                                                  nAdjElem, adjElem,</div>
<div class="line"><a name="l04170"></a><span class="lineno"> 4170</span>&#160;                                                  tasksList[i].secondPartTimeIntADER,</div>
<div class="line"><a name="l04171"></a><span class="lineno"> 4171</span>&#160;                                                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[level].data());</div>
<div class="line"><a name="l04172"></a><span class="lineno"> 4172</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04173"></a><span class="lineno"> 4173</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04174"></a><span class="lineno"> 4174</span>&#160;            }</div>
<div class="line"><a name="l04175"></a><span class="lineno"> 4175</span>&#160; </div>
<div class="line"><a name="l04176"></a><span class="lineno"> 4176</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9f1a6175c942a7aab7fe961d7b144779">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_OWNED_ELEMENTS</a>: {</div>
<div class="line"><a name="l04177"></a><span class="lineno"> 4177</span>&#160; </div>
<div class="line"><a name="l04178"></a><span class="lineno"> 4178</span>&#160;              <span class="comment">/*--- Compute the artificial viscosity for shock capturing in DG. ---*/</span></div>
<div class="line"><a name="l04179"></a><span class="lineno"> 4179</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level = tasksList[i].timeLevel;</div>
<div class="line"><a name="l04180"></a><span class="lineno"> 4180</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8811f2fe9d2efb93b2fcdedf228083d1">Shock_Capturing_DG</a>(config, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level],</div>
<div class="line"><a name="l04181"></a><span class="lineno"> 4181</span>&#160;                                 <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level+1], workArray);</div>
<div class="line"><a name="l04182"></a><span class="lineno"> 4182</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04183"></a><span class="lineno"> 4183</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04184"></a><span class="lineno"> 4184</span>&#160;            }</div>
<div class="line"><a name="l04185"></a><span class="lineno"> 4185</span>&#160; </div>
<div class="line"><a name="l04186"></a><span class="lineno"> 4186</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9e8d6353cb1f2eba954d362e17be57c0">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_HALO_ELEMENTS</a>: {</div>
<div class="line"><a name="l04187"></a><span class="lineno"> 4187</span>&#160; </div>
<div class="line"><a name="l04188"></a><span class="lineno"> 4188</span>&#160;              <span class="comment">/*--- Compute the artificial viscosity for shock capturing in DG. ---*/</span></div>
<div class="line"><a name="l04189"></a><span class="lineno"> 4189</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level = tasksList[i].timeLevel;</div>
<div class="line"><a name="l04190"></a><span class="lineno"> 4190</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8811f2fe9d2efb93b2fcdedf228083d1">Shock_Capturing_DG</a>(config, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[level],</div>
<div class="line"><a name="l04191"></a><span class="lineno"> 4191</span>&#160;                                 <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[level+1], workArray);</div>
<div class="line"><a name="l04192"></a><span class="lineno"> 4192</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04193"></a><span class="lineno"> 4193</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04194"></a><span class="lineno"> 4194</span>&#160;            }</div>
<div class="line"><a name="l04195"></a><span class="lineno"> 4195</span>&#160; </div>
<div class="line"><a name="l04196"></a><span class="lineno"> 4196</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74af3eb9ac3d402c19dc3d270edff6625aa">CTaskDefinition::VOLUME_RESIDUAL</a>: {</div>
<div class="line"><a name="l04197"></a><span class="lineno"> 4197</span>&#160; </div>
<div class="line"><a name="l04198"></a><span class="lineno"> 4198</span>&#160;              <span class="comment">/*--- Compute the volume portion of the residual. ---*/</span></div>
<div class="line"><a name="l04199"></a><span class="lineno"> 4199</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level = tasksList[i].timeLevel;</div>
<div class="line"><a name="l04200"></a><span class="lineno"> 4200</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ae6c2fff0649a4d8fd723ee9776778003">Volume_Residual</a>(config, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level],</div>
<div class="line"><a name="l04201"></a><span class="lineno"> 4201</span>&#160;                              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level+1], workArray);</div>
<div class="line"><a name="l04202"></a><span class="lineno"> 4202</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04203"></a><span class="lineno"> 4203</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04204"></a><span class="lineno"> 4204</span>&#160;            }</div>
<div class="line"><a name="l04205"></a><span class="lineno"> 4205</span>&#160; </div>
<div class="line"><a name="l04206"></a><span class="lineno"> 4206</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a4f83604f71f03a0535dbc845096bcfec">CTaskDefinition::SURFACE_RESIDUAL_OWNED_ELEMENTS</a>: {</div>
<div class="line"><a name="l04207"></a><span class="lineno"> 4207</span>&#160; </div>
<div class="line"><a name="l04208"></a><span class="lineno"> 4208</span>&#160;              <span class="comment">/* Compute the residual of the faces that only involve owned elements. */</span></div>
<div class="line"><a name="l04209"></a><span class="lineno"> 4209</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level = tasksList[i].timeLevel;</div>
<div class="line"><a name="l04210"></a><span class="lineno"> 4210</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af49be394a337648305708ce9d970d81a">startLocResInternalFacesLocalElem</a>[level];</div>
<div class="line"><a name="l04211"></a><span class="lineno"> 4211</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8875e58364f55e735fc3732f545d5f29">ResidualFaces</a>(config, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a275680d0b201cfb25fdaaeb9c2ca1d22">nMatchingInternalFacesLocalElem</a>[level],</div>
<div class="line"><a name="l04212"></a><span class="lineno"> 4212</span>&#160;                            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a275680d0b201cfb25fdaaeb9c2ca1d22">nMatchingInternalFacesLocalElem</a>[level+1],</div>
<div class="line"><a name="l04213"></a><span class="lineno"> 4213</span>&#160;                            indResFaces, numerics[<a class="code" href="option__structure_8hpp.html#adc962393ac6198eea617cc5384baf5e0">CONV_TERM</a>], workArray);</div>
<div class="line"><a name="l04214"></a><span class="lineno"> 4214</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04215"></a><span class="lineno"> 4215</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04216"></a><span class="lineno"> 4216</span>&#160;            }</div>
<div class="line"><a name="l04217"></a><span class="lineno"> 4217</span>&#160; </div>
<div class="line"><a name="l04218"></a><span class="lineno"> 4218</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aa5a84198558a8415e59d8179c9f9086b">CTaskDefinition::SURFACE_RESIDUAL_HALO_ELEMENTS</a>: {</div>
<div class="line"><a name="l04219"></a><span class="lineno"> 4219</span>&#160; </div>
<div class="line"><a name="l04220"></a><span class="lineno"> 4220</span>&#160;              <span class="comment">/* Compute the residual of the faces that involve a halo element. */</span></div>
<div class="line"><a name="l04221"></a><span class="lineno"> 4221</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level = tasksList[i].timeLevel;</div>
<div class="line"><a name="l04222"></a><span class="lineno"> 4222</span>&#160;              <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a56c65d7a358c016a7bb58dfcfc3999d7">startLocResInternalFacesWithHaloElem</a>[level];</div>
<div class="line"><a name="l04223"></a><span class="lineno"> 4223</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8875e58364f55e735fc3732f545d5f29">ResidualFaces</a>(config, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[level],</div>
<div class="line"><a name="l04224"></a><span class="lineno"> 4224</span>&#160;                            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">nMatchingInternalFacesWithHaloElem</a>[level+1],</div>
<div class="line"><a name="l04225"></a><span class="lineno"> 4225</span>&#160;                            indResFaces, numerics[<a class="code" href="option__structure_8hpp.html#adc962393ac6198eea617cc5384baf5e0">CONV_TERM</a>], workArray);</div>
<div class="line"><a name="l04226"></a><span class="lineno"> 4226</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04227"></a><span class="lineno"> 4227</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04228"></a><span class="lineno"> 4228</span>&#160;            }</div>
<div class="line"><a name="l04229"></a><span class="lineno"> 4229</span>&#160; </div>
<div class="line"><a name="l04230"></a><span class="lineno"> 4230</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a173b606ca522e3ac4103f4e43311e082">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_OWNED</a>: {</div>
<div class="line"><a name="l04231"></a><span class="lineno"> 4231</span>&#160; </div>
<div class="line"><a name="l04232"></a><span class="lineno"> 4232</span>&#160;              <span class="comment">/*--- Apply the boundary conditions that only depend on data</span></div>
<div class="line"><a name="l04233"></a><span class="lineno"> 4233</span>&#160;<span class="comment">                    of owned elements. ---*/</span></div>
<div class="line"><a name="l04234"></a><span class="lineno"> 4234</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ae37f8eba6d7793bc4edb5de6e26f992d">Boundary_Conditions</a>(tasksList[i].timeLevel, config, numerics, <span class="keyword">false</span>,</div>
<div class="line"><a name="l04235"></a><span class="lineno"> 4235</span>&#160;                                  workArray);</div>
<div class="line"><a name="l04236"></a><span class="lineno"> 4236</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04237"></a><span class="lineno"> 4237</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04238"></a><span class="lineno"> 4238</span>&#160;            }</div>
<div class="line"><a name="l04239"></a><span class="lineno"> 4239</span>&#160; </div>
<div class="line"><a name="l04240"></a><span class="lineno"> 4240</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac997ca4b8d79ba7a41fb51cb53c8458">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_HALO</a>: {</div>
<div class="line"><a name="l04241"></a><span class="lineno"> 4241</span>&#160; </div>
<div class="line"><a name="l04242"></a><span class="lineno"> 4242</span>&#160;              <span class="comment">/*--- Apply the boundary conditions that also depend on data</span></div>
<div class="line"><a name="l04243"></a><span class="lineno"> 4243</span>&#160;<span class="comment">                    of halo elements. ---*/</span></div>
<div class="line"><a name="l04244"></a><span class="lineno"> 4244</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ae37f8eba6d7793bc4edb5de6e26f992d">Boundary_Conditions</a>(tasksList[i].timeLevel, config, numerics, <span class="keyword">true</span>,</div>
<div class="line"><a name="l04245"></a><span class="lineno"> 4245</span>&#160;                                  workArray);</div>
<div class="line"><a name="l04246"></a><span class="lineno"> 4246</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04247"></a><span class="lineno"> 4247</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04248"></a><span class="lineno"> 4248</span>&#160;            }</div>
<div class="line"><a name="l04249"></a><span class="lineno"> 4249</span>&#160; </div>
<div class="line"><a name="l04250"></a><span class="lineno"> 4250</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a701f1f1d4796783265f1ca3c9b0ace32">CTaskDefinition::SUM_UP_RESIDUAL_CONTRIBUTIONS_OWNED_ELEMENTS</a>: {</div>
<div class="line"><a name="l04251"></a><span class="lineno"> 4251</span>&#160; </div>
<div class="line"><a name="l04252"></a><span class="lineno"> 4252</span>&#160;              <span class="comment">/* Create the final residual by summing up all contributions. */</span></div>
<div class="line"><a name="l04253"></a><span class="lineno"> 4253</span>&#160;              CreateFinalResidual(tasksList[i].timeLevel, <span class="keyword">true</span>);</div>
<div class="line"><a name="l04254"></a><span class="lineno"> 4254</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04255"></a><span class="lineno"> 4255</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04256"></a><span class="lineno"> 4256</span>&#160;            }</div>
<div class="line"><a name="l04257"></a><span class="lineno"> 4257</span>&#160; </div>
<div class="line"><a name="l04258"></a><span class="lineno"> 4258</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ad0a99da83dbd845544315fd5ba3ec874">CTaskDefinition::SUM_UP_RESIDUAL_CONTRIBUTIONS_HALO_ELEMENTS</a>: {</div>
<div class="line"><a name="l04259"></a><span class="lineno"> 4259</span>&#160; </div>
<div class="line"><a name="l04260"></a><span class="lineno"> 4260</span>&#160;              <span class="comment">/* Create the final residual by summing up all contributions. */</span></div>
<div class="line"><a name="l04261"></a><span class="lineno"> 4261</span>&#160;              CreateFinalResidual(tasksList[i].timeLevel, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04262"></a><span class="lineno"> 4262</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04263"></a><span class="lineno"> 4263</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04264"></a><span class="lineno"> 4264</span>&#160;            }</div>
<div class="line"><a name="l04265"></a><span class="lineno"> 4265</span>&#160; </div>
<div class="line"><a name="l04266"></a><span class="lineno"> 4266</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ae7a15d8f6916cb075308fdf330f8d7cd">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS</a>: {</div>
<div class="line"><a name="l04267"></a><span class="lineno"> 4267</span>&#160; </div>
<div class="line"><a name="l04268"></a><span class="lineno"> 4268</span>&#160;              <span class="comment">/* Accumulate the space time residuals for the owned elements</span></div>
<div class="line"><a name="l04269"></a><span class="lineno"> 4269</span>&#160;<span class="comment">                 for ADER-DG. */</span></div>
<div class="line"><a name="l04270"></a><span class="lineno"> 4270</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0a18dfd035e17379824d2a3a032d3ab3">AccumulateSpaceTimeResidualADEROwnedElem</a>(config, tasksList[i].timeLevel,</div>
<div class="line"><a name="l04271"></a><span class="lineno"> 4271</span>&#160;                                                       tasksList[i].intPointADER);</div>
<div class="line"><a name="l04272"></a><span class="lineno"> 4272</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04273"></a><span class="lineno"> 4273</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04274"></a><span class="lineno"> 4274</span>&#160;            }</div>
<div class="line"><a name="l04275"></a><span class="lineno"> 4275</span>&#160; </div>
<div class="line"><a name="l04276"></a><span class="lineno"> 4276</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a3bfecd203c9e27daa248a223ab8fa3cb">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_HALO_ELEMENTS</a>: {</div>
<div class="line"><a name="l04277"></a><span class="lineno"> 4277</span>&#160; </div>
<div class="line"><a name="l04278"></a><span class="lineno"> 4278</span>&#160;              <span class="comment">/* Accumulate the space time residuals for the halo elements</span></div>
<div class="line"><a name="l04279"></a><span class="lineno"> 4279</span>&#160;<span class="comment">                 for ADER-DG. */</span></div>
<div class="line"><a name="l04280"></a><span class="lineno"> 4280</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad69d3dd7fafb9203abbc9e876cbcd7a8">AccumulateSpaceTimeResidualADERHaloElem</a>(config, tasksList[i].timeLevel,</div>
<div class="line"><a name="l04281"></a><span class="lineno"> 4281</span>&#160;                                                      tasksList[i].intPointADER);</div>
<div class="line"><a name="l04282"></a><span class="lineno"> 4282</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04283"></a><span class="lineno"> 4283</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04284"></a><span class="lineno"> 4284</span>&#160;            }</div>
<div class="line"><a name="l04285"></a><span class="lineno"> 4285</span>&#160; </div>
<div class="line"><a name="l04286"></a><span class="lineno"> 4286</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74adde810be8601e9a6ee25b90abc35fbf1">CTaskDefinition::MULTIPLY_INVERSE_MASS_MATRIX</a>: {</div>
<div class="line"><a name="l04287"></a><span class="lineno"> 4287</span>&#160; </div>
<div class="line"><a name="l04288"></a><span class="lineno"> 4288</span>&#160;              <span class="comment">/*--- Multiply the residual by the (lumped) mass matrix, to obtain the final value. ---*/</span></div>
<div class="line"><a name="l04289"></a><span class="lineno"> 4289</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level = tasksList[i].timeLevel;</div>
<div class="line"><a name="l04290"></a><span class="lineno"> 4290</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">bool</span> useADER = config-&gt;<a class="code" href="class_c_config.html#aeec93abf99b07f5fd7505df58a5577ae">GetKind_TimeIntScheme</a>() == <a class="code" href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a>;</div>
<div class="line"><a name="l04291"></a><span class="lineno"> 4291</span>&#160;              MultiplyResidualByInverseMassMatrix(config, useADER,</div>
<div class="line"><a name="l04292"></a><span class="lineno"> 4292</span>&#160;                                                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level],</div>
<div class="line"><a name="l04293"></a><span class="lineno"> 4293</span>&#160;                                                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level+1],</div>
<div class="line"><a name="l04294"></a><span class="lineno"> 4294</span>&#160;                                                  workArray);</div>
<div class="line"><a name="l04295"></a><span class="lineno"> 4295</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04296"></a><span class="lineno"> 4296</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04297"></a><span class="lineno"> 4297</span>&#160;            }</div>
<div class="line"><a name="l04298"></a><span class="lineno"> 4298</span>&#160; </div>
<div class="line"><a name="l04299"></a><span class="lineno"> 4299</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a488a3ac4df1541941741ed605e6b7121">CTaskDefinition::ADER_UPDATE_SOLUTION</a>: {</div>
<div class="line"><a name="l04300"></a><span class="lineno"> 4300</span>&#160; </div>
<div class="line"><a name="l04301"></a><span class="lineno"> 4301</span>&#160;              <span class="comment">/*--- Perform the update step for ADER-DG. ---*/</span></div>
<div class="line"><a name="l04302"></a><span class="lineno"> 4302</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> level = tasksList[i].timeLevel;</div>
<div class="line"><a name="l04303"></a><span class="lineno"> 4303</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad581ff9821dc607597049b9d52ce5fdf">ADER_DG_Iteration</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level],</div>
<div class="line"><a name="l04304"></a><span class="lineno"> 4304</span>&#160;                                <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[level+1]);</div>
<div class="line"><a name="l04305"></a><span class="lineno"> 4305</span>&#160;              taskCarriedOut = taskCompleted[i] = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04306"></a><span class="lineno"> 4306</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04307"></a><span class="lineno"> 4307</span>&#160;            }</div>
<div class="line"><a name="l04308"></a><span class="lineno"> 4308</span>&#160; </div>
<div class="line"><a name="l04309"></a><span class="lineno"> 4309</span>&#160;            <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l04310"></a><span class="lineno"> 4310</span>&#160; </div>
<div class="line"><a name="l04311"></a><span class="lineno"> 4311</span>&#160;              cout &lt;&lt; <span class="stringliteral">&quot;Task not defined. This should not happen.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l04312"></a><span class="lineno"> 4312</span>&#160;              exit(1);</div>
<div class="line"><a name="l04313"></a><span class="lineno"> 4313</span>&#160;            }</div>
<div class="line"><a name="l04314"></a><span class="lineno"> 4314</span>&#160;          }</div>
<div class="line"><a name="l04315"></a><span class="lineno"> 4315</span>&#160;        }</div>
<div class="line"><a name="l04316"></a><span class="lineno"> 4316</span>&#160; </div>
<div class="line"><a name="l04317"></a><span class="lineno"> 4317</span>&#160;        <span class="comment">/* Break the inner loop if a task has been carried out. */</span></div>
<div class="line"><a name="l04318"></a><span class="lineno"> 4318</span>&#160;        <span class="keywordflow">if</span>( taskCarriedOut ) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04319"></a><span class="lineno"> 4319</span>&#160;      }</div>
<div class="line"><a name="l04320"></a><span class="lineno"> 4320</span>&#160; </div>
<div class="line"><a name="l04321"></a><span class="lineno"> 4321</span>&#160;      <span class="comment">/* Break the outer loop if a task has been carried out. */</span></div>
<div class="line"><a name="l04322"></a><span class="lineno"> 4322</span>&#160;      <span class="keywordflow">if</span>( taskCarriedOut ) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04323"></a><span class="lineno"> 4323</span>&#160;    }</div>
<div class="line"><a name="l04324"></a><span class="lineno"> 4324</span>&#160; </div>
<div class="line"><a name="l04325"></a><span class="lineno"> 4325</span>&#160;    <span class="comment">/* Update the value of lowestIndexInList. */</span></div>
<div class="line"><a name="l04326"></a><span class="lineno"> 4326</span>&#160;    <span class="keywordflow">for</span>(; lowestIndexInList &lt; tasksList.size(); ++lowestIndexInList)</div>
<div class="line"><a name="l04327"></a><span class="lineno"> 4327</span>&#160;      <span class="keywordflow">if</span>( !taskCompleted[lowestIndexInList] ) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04328"></a><span class="lineno"> 4328</span>&#160;  }</div>
<div class="line"><a name="l04329"></a><span class="lineno"> 4329</span>&#160;}</div>
<div class="line"><a name="l04330"></a><span class="lineno"> 4330</span>&#160; </div>
<div class="line"><a name="l04331"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a7f0da04d44069701db2228210b91c59e"> 4331</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7f0da04d44069701db2228210b91c59e">CFEM_DG_EulerSolver::ADER_SpaceTimeIntegration</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry,  <a class="code" href="class_c_solver.html">CSolver</a> **solver_container,</div>
<div class="line"><a name="l04332"></a><span class="lineno"> 4332</span>&#160;                                                    <a class="code" href="class_c_numerics.html">CNumerics</a> **numerics, <a class="code" href="class_c_config.html">CConfig</a> *config,</div>
<div class="line"><a name="l04333"></a><span class="lineno"> 4333</span>&#160;                                                    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> RunTime_EqSystem) {</div>
<div class="line"><a name="l04334"></a><span class="lineno"> 4334</span>&#160;  <span class="comment">/* Preprocessing. */</span></div>
<div class="line"><a name="l04335"></a><span class="lineno"> 4335</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aeb9ecebe3a3192fa6a00b0dcdf88d469">Preprocessing</a>(geometry, solver_container, config, iMesh, 0, RunTime_EqSystem, <span class="keyword">false</span>);</div>
<div class="line"><a name="l04336"></a><span class="lineno"> 4336</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a29c6daddcdecd116aaf32d40cd09f7c2">TolerancesADERPredictorStep</a>();</div>
<div class="line"><a name="l04337"></a><span class="lineno"> 4337</span>&#160; </div>
<div class="line"><a name="l04338"></a><span class="lineno"> 4338</span>&#160;  <span class="comment">/* Process the tasks list to carry out one ADER space time integration step. */</span></div>
<div class="line"><a name="l04339"></a><span class="lineno"> 4339</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a651cad1a94f2024c75a1a8be347e3375">ProcessTaskList_DG</a>(geometry, solver_container, numerics, config, iMesh);</div>
<div class="line"><a name="l04340"></a><span class="lineno"> 4340</span>&#160; </div>
<div class="line"><a name="l04341"></a><span class="lineno"> 4341</span>&#160;  <span class="comment">/* Postprocessing. */</span></div>
<div class="line"><a name="l04342"></a><span class="lineno"> 4342</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addf1215b06e5a8166f8d84979eb1ed2d">Postprocessing</a>(geometry, solver_container, config, iMesh);</div>
<div class="line"><a name="l04343"></a><span class="lineno"> 4343</span>&#160;}</div>
<div class="line"><a name="l04344"></a><span class="lineno"> 4344</span>&#160; </div>
<div class="line"><a name="l04345"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a29c6daddcdecd116aaf32d40cd09f7c2"> 4345</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a29c6daddcdecd116aaf32d40cd09f7c2">CFEM_DG_EulerSolver::TolerancesADERPredictorStep</a>(<span class="keywordtype">void</span>) {</div>
<div class="line"><a name="l04346"></a><span class="lineno"> 4346</span>&#160; </div>
<div class="line"><a name="l04347"></a><span class="lineno"> 4347</span>&#160;  <span class="comment">/* Determine the maximum values of the conservative variables of the</span></div>
<div class="line"><a name="l04348"></a><span class="lineno"> 4348</span>&#160;<span class="comment">     locally stored DOFs. Make a distinction between 2D and 3D for</span></div>
<div class="line"><a name="l04349"></a><span class="lineno"> 4349</span>&#160;<span class="comment">     performance reasons. */</span></div>
<div class="line"><a name="l04350"></a><span class="lineno"> 4350</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> URef[] = {0.0, 0.0, 0.0, 0.0, 0.0};</div>
<div class="line"><a name="l04351"></a><span class="lineno"> 4351</span>&#160; </div>
<div class="line"><a name="l04352"></a><span class="lineno"> 4352</span>&#160;  <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l04353"></a><span class="lineno"> 4353</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l04354"></a><span class="lineno"> 4354</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i) {</div>
<div class="line"><a name="l04355"></a><span class="lineno"> 4355</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04356"></a><span class="lineno"> 4356</span>&#160;        URef[0] = max(URef[0], fabs(solDOF[0]));</div>
<div class="line"><a name="l04357"></a><span class="lineno"> 4357</span>&#160;        URef[1] = max(URef[1], fabs(solDOF[1]));</div>
<div class="line"><a name="l04358"></a><span class="lineno"> 4358</span>&#160;        URef[2] = max(URef[2], fabs(solDOF[2]));</div>
<div class="line"><a name="l04359"></a><span class="lineno"> 4359</span>&#160;        URef[3] = max(URef[3], fabs(solDOF[3]));</div>
<div class="line"><a name="l04360"></a><span class="lineno"> 4360</span>&#160;      }</div>
<div class="line"><a name="l04361"></a><span class="lineno"> 4361</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04362"></a><span class="lineno"> 4362</span>&#160;    }</div>
<div class="line"><a name="l04363"></a><span class="lineno"> 4363</span>&#160; </div>
<div class="line"><a name="l04364"></a><span class="lineno"> 4364</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l04365"></a><span class="lineno"> 4365</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i) {</div>
<div class="line"><a name="l04366"></a><span class="lineno"> 4366</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04367"></a><span class="lineno"> 4367</span>&#160;        URef[0] = max(URef[0], fabs(solDOF[0]));</div>
<div class="line"><a name="l04368"></a><span class="lineno"> 4368</span>&#160;        URef[1] = max(URef[1], fabs(solDOF[1]));</div>
<div class="line"><a name="l04369"></a><span class="lineno"> 4369</span>&#160;        URef[2] = max(URef[2], fabs(solDOF[2]));</div>
<div class="line"><a name="l04370"></a><span class="lineno"> 4370</span>&#160;        URef[3] = max(URef[3], fabs(solDOF[3]));</div>
<div class="line"><a name="l04371"></a><span class="lineno"> 4371</span>&#160;        URef[4] = max(URef[3], fabs(solDOF[4]));</div>
<div class="line"><a name="l04372"></a><span class="lineno"> 4372</span>&#160;      }</div>
<div class="line"><a name="l04373"></a><span class="lineno"> 4373</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04374"></a><span class="lineno"> 4374</span>&#160;    }</div>
<div class="line"><a name="l04375"></a><span class="lineno"> 4375</span>&#160;  }</div>
<div class="line"><a name="l04376"></a><span class="lineno"> 4376</span>&#160; </div>
<div class="line"><a name="l04377"></a><span class="lineno"> 4377</span>&#160;  <span class="comment">/* Determine the maximum values on all ranks. */</span></div>
<div class="line"><a name="l04378"></a><span class="lineno"> 4378</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>.resize(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>);</div>
<div class="line"><a name="l04379"></a><span class="lineno"> 4379</span>&#160; </div>
<div class="line"><a name="l04380"></a><span class="lineno"> 4380</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l04381"></a><span class="lineno"> 4381</span>&#160;  <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(URef, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>.data(), <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#a80d80987b473f4a13b0cc0384eddb51b">MPI_MAX</a>,</div>
<div class="line"><a name="l04382"></a><span class="lineno"> 4382</span>&#160;                     <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l04383"></a><span class="lineno"> 4383</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l04384"></a><span class="lineno"> 4384</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++i) <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[i] = URef[i];</div>
<div class="line"><a name="l04385"></a><span class="lineno"> 4385</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l04386"></a><span class="lineno"> 4386</span>&#160; </div>
<div class="line"><a name="l04387"></a><span class="lineno"> 4387</span>&#160;  <span class="comment">/* Determine the maximum scale of the momentum variables and adapt the</span></div>
<div class="line"><a name="l04388"></a><span class="lineno"> 4388</span>&#160;<span class="comment">     corresponding values of TolSolADER accordingly. */</span></div>
<div class="line"><a name="l04389"></a><span class="lineno"> 4389</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> momRef = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[1];</div>
<div class="line"><a name="l04390"></a><span class="lineno"> 4390</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=2; i&lt;=<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++i) momRef = max(momRef, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[i]);</div>
<div class="line"><a name="l04391"></a><span class="lineno"> 4391</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=1; i&lt;=<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++i) <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[i] = momRef;</div>
<div class="line"><a name="l04392"></a><span class="lineno"> 4392</span>&#160; </div>
<div class="line"><a name="l04393"></a><span class="lineno"> 4393</span>&#160;  <span class="comment">/* Currently the maximum values of the conserved variables are stored.</span></div>
<div class="line"><a name="l04394"></a><span class="lineno"> 4394</span>&#160;<span class="comment">     Multiply by the relative tolerance to obtain the true tolerance values. */</span></div>
<div class="line"><a name="l04395"></a><span class="lineno"> 4395</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++i) <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[i] *= 1.e-6;</div>
<div class="line"><a name="l04396"></a><span class="lineno"> 4396</span>&#160;}</div>
<div class="line"><a name="l04397"></a><span class="lineno"> 4397</span>&#160; </div>
<div class="line"><a name="l04398"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a53f3bd445632823baa18657a29553842"> 4398</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a53f3bd445632823baa18657a29553842">CFEM_DG_EulerSolver::ADER_DG_PredictorStep</a>(<a class="code" href="class_c_config.html">CConfig</a>             *config,</div>
<div class="line"><a name="l04399"></a><span class="lineno"> 4399</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg,</div>
<div class="line"><a name="l04400"></a><span class="lineno"> 4400</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd,</div>
<div class="line"><a name="l04401"></a><span class="lineno"> 4401</span>&#160;                                                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>           *workArray) {</div>
<div class="line"><a name="l04402"></a><span class="lineno"> 4402</span>&#160; </div>
<div class="line"><a name="l04403"></a><span class="lineno"> 4403</span>&#160;  <span class="comment">/* Get the data of the ADER time integration scheme. */</span></div>
<div class="line"><a name="l04404"></a><span class="lineno"> 4404</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeDOFs              = config-&gt;<a class="code" href="class_c_config.html#ab110ba67babf383e40ac4896bc65a599">GetnTimeDOFsADER_DG</a>();</div>
<div class="line"><a name="l04405"></a><span class="lineno"> 4405</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeIntegrationPoints = config-&gt;<a class="code" href="class_c_config.html#ae7e9d4b942d0db4b72f461c180ade3a4">GetnTimeIntegrationADER_DG</a>();</div>
<div class="line"><a name="l04406"></a><span class="lineno"> 4406</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>     *timeIntegrationWeights = config-&gt;<a class="code" href="class_c_config.html#ab61a5a25dc9a2d37c22d4744d26b690d">GetWeightsIntegrationADER_DG</a>();</div>
<div class="line"><a name="l04407"></a><span class="lineno"> 4407</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span>          useAliasedPredictor     = config-&gt;<a class="code" href="class_c_config.html#a6a283ba2b1eacb99905f0e12636c8e15">GetKind_ADER_Predictor</a>() == <a class="code" href="option__structure_8hpp.html#a2a786c02917df4dda5cf6c49e01794fea5fa3210aba4e29bca6294a071fdf8086">ADER_ALIASED_PREDICTOR</a>;</div>
<div class="line"><a name="l04408"></a><span class="lineno"> 4408</span>&#160; </div>
<div class="line"><a name="l04409"></a><span class="lineno"> 4409</span>&#160;   <span class="comment">/* Determine the number of solution entities that are treated simultaneously</span></div>
<div class="line"><a name="l04410"></a><span class="lineno"> 4410</span>&#160;<span class="comment">      in the matrix products to obtain good gemm performance. A solution entity</span></div>
<div class="line"><a name="l04411"></a><span class="lineno"> 4411</span>&#160;<span class="comment">      can be a time integration point (to compute the fluxes) or a time DOF</span></div>
<div class="line"><a name="l04412"></a><span class="lineno"> 4412</span>&#160;<span class="comment">      in the actual iteration process. */</span></div>
<div class="line"><a name="l04413"></a><span class="lineno"> 4413</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad       = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l04414"></a><span class="lineno"> 4414</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeSimul = NPad/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04415"></a><span class="lineno"> 4415</span>&#160; </div>
<div class="line"><a name="l04416"></a><span class="lineno"> 4416</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l04417"></a><span class="lineno"> 4417</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l04418"></a><span class="lineno"> 4418</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l04419"></a><span class="lineno"> 4419</span>&#160; </div>
<div class="line"><a name="l04420"></a><span class="lineno"> 4420</span>&#160;  <span class="comment">/* Determine the number of time integration points that are treated</span></div>
<div class="line"><a name="l04421"></a><span class="lineno"> 4421</span>&#160;<span class="comment">     simultaneously for better gemm performance as well as the number of</span></div>
<div class="line"><a name="l04422"></a><span class="lineno"> 4422</span>&#160;<span class="comment">     loops to treat all time integration points. */</span></div>
<div class="line"><a name="l04423"></a><span class="lineno"> 4423</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeSimulLastInts = nTimeIntegrationPoints%nTimeSimul;</div>
<div class="line"><a name="l04424"></a><span class="lineno"> 4424</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeIntLoop       = nTimeIntegrationPoints/nTimeSimul;</div>
<div class="line"><a name="l04425"></a><span class="lineno"> 4425</span>&#160;  <span class="keywordflow">if</span>(nTimeSimulLastInts == 0) nTimeSimulLastInts = nTimeSimul;</div>
<div class="line"><a name="l04426"></a><span class="lineno"> 4426</span>&#160;  <span class="keywordflow">else</span>                        ++nTimeIntLoop;</div>
<div class="line"><a name="l04427"></a><span class="lineno"> 4427</span>&#160; </div>
<div class="line"><a name="l04428"></a><span class="lineno"> 4428</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPadLastInts = nTimeSimulLastInts*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04429"></a><span class="lineno"> 4429</span>&#160;  <span class="keywordflow">if</span>( NPadLastInts%NPadMin ) NPadLastInts += NPadMin - (NPadLastInts%NPadMin);</div>
<div class="line"><a name="l04430"></a><span class="lineno"> 4430</span>&#160; </div>
<div class="line"><a name="l04431"></a><span class="lineno"> 4431</span>&#160;  <span class="comment">/* Idem for the time DOFs. */</span></div>
<div class="line"><a name="l04432"></a><span class="lineno"> 4432</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeSimulLastDOFs = nTimeDOFs%nTimeSimul;</div>
<div class="line"><a name="l04433"></a><span class="lineno"> 4433</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeDOFLoop       = nTimeDOFs/nTimeSimul;</div>
<div class="line"><a name="l04434"></a><span class="lineno"> 4434</span>&#160;  <span class="keywordflow">if</span>(nTimeSimulLastDOFs == 0) nTimeSimulLastDOFs = nTimeSimul;</div>
<div class="line"><a name="l04435"></a><span class="lineno"> 4435</span>&#160;  <span class="keywordflow">else</span>                        ++nTimeDOFLoop;</div>
<div class="line"><a name="l04436"></a><span class="lineno"> 4436</span>&#160; </div>
<div class="line"><a name="l04437"></a><span class="lineno"> 4437</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPadLastDOFs = nTimeSimulLastDOFs*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04438"></a><span class="lineno"> 4438</span>&#160;  <span class="keywordflow">if</span>( NPadLastDOFs%NPadMin ) NPadLastDOFs += NPadMin - (NPadLastDOFs%NPadMin);</div>
<div class="line"><a name="l04439"></a><span class="lineno"> 4439</span>&#160; </div>
<div class="line"><a name="l04440"></a><span class="lineno"> 4440</span>&#160;  <span class="comment">/* Determine the total padded size to store the residual for all the</span></div>
<div class="line"><a name="l04441"></a><span class="lineno"> 4441</span>&#160;<span class="comment">     spatial and time DOFs. The residual is stored in such a way that a</span></div>
<div class="line"><a name="l04442"></a><span class="lineno"> 4442</span>&#160;<span class="comment">     memcpy is avoided when the multiplication with iteration matrix, i.e.</span></div>
<div class="line"><a name="l04443"></a><span class="lineno"> 4443</span>&#160;<span class="comment">     mass matrix, is carried out. */</span></div>
<div class="line"><a name="l04444"></a><span class="lineno"> 4444</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPadResTot = (nTimeDOFLoop-1)*NPad + NPadLastDOFs;</div>
<div class="line"><a name="l04445"></a><span class="lineno"> 4445</span>&#160; </div>
<div class="line"><a name="l04446"></a><span class="lineno"> 4446</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04447"></a><span class="lineno"> 4447</span>&#160;  <span class="comment">/*--- Loop over the given elemen range to compute the predictor solution.---*/</span></div>
<div class="line"><a name="l04448"></a><span class="lineno"> 4448</span>&#160;  <span class="comment">/*--- For the predictor solution only an integration over the element is ---*/</span></div>
<div class="line"><a name="l04449"></a><span class="lineno"> 4449</span>&#160;  <span class="comment">/*--- performed to obtain the weak formulation, i.e. no integration by   ---*/</span></div>
<div class="line"><a name="l04450"></a><span class="lineno"> 4450</span>&#160;  <span class="comment">/*--- parts. As a consequence there is no surface term and also no       ---*/</span></div>
<div class="line"><a name="l04451"></a><span class="lineno"> 4451</span>&#160;  <span class="comment">/*--- coupling with neighboring elements. This is also the reason why    ---*/</span></div>
<div class="line"><a name="l04452"></a><span class="lineno"> 4452</span>&#160;  <span class="comment">/*--- the ADER scheme is only conditionally stable.                      ---*/</span></div>
<div class="line"><a name="l04453"></a><span class="lineno"> 4453</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04454"></a><span class="lineno"> 4454</span>&#160; </div>
<div class="line"><a name="l04455"></a><span class="lineno"> 4455</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBeg; l&lt;elemEnd; ++l) {</div>
<div class="line"><a name="l04456"></a><span class="lineno"> 4456</span>&#160; </div>
<div class="line"><a name="l04457"></a><span class="lineno"> 4457</span>&#160;    <span class="comment">/* Easier storage of the number of spatial DOFs and the total</span></div>
<div class="line"><a name="l04458"></a><span class="lineno"> 4458</span>&#160;<span class="comment">       number of variables for this element per time level. */</span></div>
<div class="line"><a name="l04459"></a><span class="lineno"> 4459</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l04460"></a><span class="lineno"> 4460</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nVarNDOFs = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*nDOFs;</div>
<div class="line"><a name="l04461"></a><span class="lineno"> 4461</span>&#160; </div>
<div class="line"><a name="l04462"></a><span class="lineno"> 4462</span>&#160;    <span class="comment">/* Set the pointers for the working variables. */</span></div>
<div class="line"><a name="l04463"></a><span class="lineno"> 4463</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resInt  = workArray;</div>
<div class="line"><a name="l04464"></a><span class="lineno"> 4464</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solPred = resInt  + NPad*nDOFs;</div>
<div class="line"><a name="l04465"></a><span class="lineno"> 4465</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSol    = solPred + nVarNDOFs*nTimeDOFs;</div>
<div class="line"><a name="l04466"></a><span class="lineno"> 4466</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resTot  = dSol    + nVarNDOFs*nTimeDOFs;</div>
<div class="line"><a name="l04467"></a><span class="lineno"> 4467</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solInt  = resTot  + NPadResTot*nDOFs;</div>
<div class="line"><a name="l04468"></a><span class="lineno"> 4468</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solInt  + NPad*nDOFs;</div>
<div class="line"><a name="l04469"></a><span class="lineno"> 4469</span>&#160; </div>
<div class="line"><a name="l04470"></a><span class="lineno"> 4470</span>&#160;    <span class="comment">/* Initialize the predictor solution to the current solution. */</span></div>
<div class="line"><a name="l04471"></a><span class="lineno"> 4471</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>    *solCur = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l04472"></a><span class="lineno"> 4472</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = nVarNDOFs*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l04473"></a><span class="lineno"> 4473</span>&#160; </div>
<div class="line"><a name="l04474"></a><span class="lineno"> 4474</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nTimeDOFs; ++j) {</div>
<div class="line"><a name="l04475"></a><span class="lineno"> 4475</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solPredTimeInd = solPred + j*nVarNDOFs;</div>
<div class="line"><a name="l04476"></a><span class="lineno"> 4476</span>&#160;      memcpy(solPredTimeInd, solCur, nBytes);</div>
<div class="line"><a name="l04477"></a><span class="lineno"> 4477</span>&#160;    }</div>
<div class="line"><a name="l04478"></a><span class="lineno"> 4478</span>&#160; </div>
<div class="line"><a name="l04479"></a><span class="lineno"> 4479</span>&#160;    <span class="comment">/*-------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04480"></a><span class="lineno"> 4480</span>&#160;    <span class="comment">/*--- Iterative algorithm to compute the predictor solution for all     ---*/</span></div>
<div class="line"><a name="l04481"></a><span class="lineno"> 4481</span>&#160;    <span class="comment">/*--- the time DOFs of this element simultaneously.                     ---*/</span></div>
<div class="line"><a name="l04482"></a><span class="lineno"> 4482</span>&#160;    <span class="comment">/*-------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04483"></a><span class="lineno"> 4483</span>&#160; </div>
<div class="line"><a name="l04484"></a><span class="lineno"> 4484</span>&#160;    <span class="keywordflow">for</span>(;;) {</div>
<div class="line"><a name="l04485"></a><span class="lineno"> 4485</span>&#160; </div>
<div class="line"><a name="l04486"></a><span class="lineno"> 4486</span>&#160;      <span class="comment">/* Initialize the total residual to zero. */</span></div>
<div class="line"><a name="l04487"></a><span class="lineno"> 4487</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(NPadResTot*nDOFs); ++i) resTot[i] = 0.0;</div>
<div class="line"><a name="l04488"></a><span class="lineno"> 4488</span>&#160; </div>
<div class="line"><a name="l04489"></a><span class="lineno"> 4489</span>&#160;      <span class="comment">/* Loop, such that all time integration points are treated. Note that</span></div>
<div class="line"><a name="l04490"></a><span class="lineno"> 4490</span>&#160;<span class="comment">         inside this loop, several time integration points are treated</span></div>
<div class="line"><a name="l04491"></a><span class="lineno"> 4491</span>&#160;<span class="comment">         simultaneously. */</span></div>
<div class="line"><a name="l04492"></a><span class="lineno"> 4492</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeIntLoop=0; timeIntLoop&lt;nTimeIntLoop; ++timeIntLoop) {</div>
<div class="line"><a name="l04493"></a><span class="lineno"> 4493</span>&#160; </div>
<div class="line"><a name="l04494"></a><span class="lineno"> 4494</span>&#160;        <span class="comment">/* Determine the starting and ending time integration point, as well as</span></div>
<div class="line"><a name="l04495"></a><span class="lineno"> 4495</span>&#160;<span class="comment">           the value of the padding to be applied. */</span></div>
<div class="line"><a name="l04496"></a><span class="lineno"> 4496</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> intStart = timeIntLoop*nTimeSimul;</div>
<div class="line"><a name="l04497"></a><span class="lineno"> 4497</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> intEnd   = (timeIntLoop == (nTimeIntLoop-1)) ?</div>
<div class="line"><a name="l04498"></a><span class="lineno"> 4498</span>&#160;                                        intStart + nTimeSimulLastInts : intStart + nTimeSimul;</div>
<div class="line"><a name="l04499"></a><span class="lineno"> 4499</span>&#160; </div>
<div class="line"><a name="l04500"></a><span class="lineno"> 4500</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPadInt = (timeIntLoop == (nTimeIntLoop-1)) ? NPadLastInts : NPad;</div>
<div class="line"><a name="l04501"></a><span class="lineno"> 4501</span>&#160; </div>
<div class="line"><a name="l04502"></a><span class="lineno"> 4502</span>&#160;        <span class="comment">/*--------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04503"></a><span class="lineno"> 4503</span>&#160;        <span class="comment">/*--- Interpolate the predictor solution to the time integration   ---*/</span></div>
<div class="line"><a name="l04504"></a><span class="lineno"> 4504</span>&#160;        <span class="comment">/*--- points to be computed. It is possible, or even likely, that  ---*/</span></div>
<div class="line"><a name="l04505"></a><span class="lineno"> 4505</span>&#160;        <span class="comment">/*--- these integration points coincide with the locations of the  ---*/</span></div>
<div class="line"><a name="l04506"></a><span class="lineno"> 4506</span>&#160;        <span class="comment">/*--- time DOFs. When this is the case the interpolation boils     ---*/</span></div>
<div class="line"><a name="l04507"></a><span class="lineno"> 4507</span>&#160;        <span class="comment">/*--- down to a copy. Note that the solution of the integration    ---*/</span></div>
<div class="line"><a name="l04508"></a><span class="lineno"> 4508</span>&#160;        <span class="comment">/*--- points are stored such that a simultaneous treatment of the  ---*/</span></div>
<div class="line"><a name="l04509"></a><span class="lineno"> 4509</span>&#160;        <span class="comment">/*--- integration points is possible.                              ---*/</span></div>
<div class="line"><a name="l04510"></a><span class="lineno"> 4510</span>&#160;        <span class="comment">/*--------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04511"></a><span class="lineno"> 4511</span>&#160; </div>
<div class="line"><a name="l04512"></a><span class="lineno"> 4512</span>&#160;        <span class="comment">/* Initialize the interpolated solution to zero. */</span></div>
<div class="line"><a name="l04513"></a><span class="lineno"> 4513</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(NPadInt*nDOFs); ++i) solInt[i] = 0.0;</div>
<div class="line"><a name="l04514"></a><span class="lineno"> 4514</span>&#160; </div>
<div class="line"><a name="l04515"></a><span class="lineno"> 4515</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> intPoint=intStart; intPoint&lt;intEnd; ++intPoint) {</div>
<div class="line"><a name="l04516"></a><span class="lineno"> 4516</span>&#160; </div>
<div class="line"><a name="l04517"></a><span class="lineno"> 4517</span>&#160;          <span class="comment">/* Store the interpolation data for this time integration point. */</span></div>
<div class="line"><a name="l04518"></a><span class="lineno"> 4518</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *DOFToThisTimeInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a12a7b04efdba0f2488dc786a1261f1b0">timeInterpolDOFToIntegrationADER_DG</a></div>
<div class="line"><a name="l04519"></a><span class="lineno"> 4519</span>&#160;                                            + intPoint*nTimeDOFs;</div>
<div class="line"><a name="l04520"></a><span class="lineno"> 4520</span>&#160; </div>
<div class="line"><a name="l04521"></a><span class="lineno"> 4521</span>&#160;          <span class="comment">/* Set the pointer to the address of the 1st variable of the 1st DOF</span></div>
<div class="line"><a name="l04522"></a><span class="lineno"> 4522</span>&#160;<span class="comment">             for this integration point. In this way there is no need to</span></div>
<div class="line"><a name="l04523"></a><span class="lineno"> 4523</span>&#160;<span class="comment">             account for this offset in the actual interpolation loop. */</span></div>
<div class="line"><a name="l04524"></a><span class="lineno"> 4524</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solThisInt = solInt + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(intPoint - intStart);</div>
<div class="line"><a name="l04525"></a><span class="lineno"> 4525</span>&#160; </div>
<div class="line"><a name="l04526"></a><span class="lineno"> 4526</span>&#160;          <span class="comment">/* Carry out the actual interpolation. Make a distinction between</span></div>
<div class="line"><a name="l04527"></a><span class="lineno"> 4527</span>&#160;<span class="comment">             2D and 3D for performance reasons. */</span></div>
<div class="line"><a name="l04528"></a><span class="lineno"> 4528</span>&#160;          <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l04529"></a><span class="lineno"> 4529</span>&#160;            <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l04530"></a><span class="lineno"> 4530</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nTimeDOFs; ++j) {</div>
<div class="line"><a name="l04531"></a><span class="lineno"> 4531</span>&#160; </div>
<div class="line"><a name="l04532"></a><span class="lineno"> 4532</span>&#160;                <span class="keywordflow">if</span>(DOFToThisTimeInt[j] != 0.0) {</div>
<div class="line"><a name="l04533"></a><span class="lineno"> 4533</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indPredTime = j*nVarNDOFs;</div>
<div class="line"><a name="l04534"></a><span class="lineno"> 4534</span>&#160; </div>
<div class="line"><a name="l04535"></a><span class="lineno"> 4535</span>&#160;                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l04536"></a><span class="lineno"> 4536</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indSol  = i*NPadInt;</div>
<div class="line"><a name="l04537"></a><span class="lineno"> 4537</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indPred = indPredTime + i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04538"></a><span class="lineno"> 4538</span>&#160; </div>
<div class="line"><a name="l04539"></a><span class="lineno"> 4539</span>&#160;                    solThisInt[indSol]   += DOFToThisTimeInt[j]*solPred[indPred];</div>
<div class="line"><a name="l04540"></a><span class="lineno"> 4540</span>&#160;                    solThisInt[indSol+1] += DOFToThisTimeInt[j]*solPred[indPred+1];</div>
<div class="line"><a name="l04541"></a><span class="lineno"> 4541</span>&#160;                    solThisInt[indSol+2] += DOFToThisTimeInt[j]*solPred[indPred+2];</div>
<div class="line"><a name="l04542"></a><span class="lineno"> 4542</span>&#160;                    solThisInt[indSol+3] += DOFToThisTimeInt[j]*solPred[indPred+3];</div>
<div class="line"><a name="l04543"></a><span class="lineno"> 4543</span>&#160;                  }</div>
<div class="line"><a name="l04544"></a><span class="lineno"> 4544</span>&#160;                }</div>
<div class="line"><a name="l04545"></a><span class="lineno"> 4545</span>&#160;              }</div>
<div class="line"><a name="l04546"></a><span class="lineno"> 4546</span>&#160; </div>
<div class="line"><a name="l04547"></a><span class="lineno"> 4547</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04548"></a><span class="lineno"> 4548</span>&#160;            }</div>
<div class="line"><a name="l04549"></a><span class="lineno"> 4549</span>&#160; </div>
<div class="line"><a name="l04550"></a><span class="lineno"> 4550</span>&#160;            <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l04551"></a><span class="lineno"> 4551</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nTimeDOFs; ++j) {</div>
<div class="line"><a name="l04552"></a><span class="lineno"> 4552</span>&#160; </div>
<div class="line"><a name="l04553"></a><span class="lineno"> 4553</span>&#160;                <span class="keywordflow">if</span>(DOFToThisTimeInt[j] != 0.0) {</div>
<div class="line"><a name="l04554"></a><span class="lineno"> 4554</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indPredTime = j*nVarNDOFs;</div>
<div class="line"><a name="l04555"></a><span class="lineno"> 4555</span>&#160; </div>
<div class="line"><a name="l04556"></a><span class="lineno"> 4556</span>&#160;                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l04557"></a><span class="lineno"> 4557</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indSol  = i*NPadInt;</div>
<div class="line"><a name="l04558"></a><span class="lineno"> 4558</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indPred = indPredTime + i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04559"></a><span class="lineno"> 4559</span>&#160; </div>
<div class="line"><a name="l04560"></a><span class="lineno"> 4560</span>&#160;                    solThisInt[indSol]   += DOFToThisTimeInt[j]*solPred[indPred];</div>
<div class="line"><a name="l04561"></a><span class="lineno"> 4561</span>&#160;                    solThisInt[indSol+1] += DOFToThisTimeInt[j]*solPred[indPred+1];</div>
<div class="line"><a name="l04562"></a><span class="lineno"> 4562</span>&#160;                    solThisInt[indSol+2] += DOFToThisTimeInt[j]*solPred[indPred+2];</div>
<div class="line"><a name="l04563"></a><span class="lineno"> 4563</span>&#160;                    solThisInt[indSol+3] += DOFToThisTimeInt[j]*solPred[indPred+3];</div>
<div class="line"><a name="l04564"></a><span class="lineno"> 4564</span>&#160;                    solThisInt[indSol+4] += DOFToThisTimeInt[j]*solPred[indPred+4];</div>
<div class="line"><a name="l04565"></a><span class="lineno"> 4565</span>&#160;                  }</div>
<div class="line"><a name="l04566"></a><span class="lineno"> 4566</span>&#160;                }</div>
<div class="line"><a name="l04567"></a><span class="lineno"> 4567</span>&#160;              }</div>
<div class="line"><a name="l04568"></a><span class="lineno"> 4568</span>&#160; </div>
<div class="line"><a name="l04569"></a><span class="lineno"> 4569</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04570"></a><span class="lineno"> 4570</span>&#160;            }</div>
<div class="line"><a name="l04571"></a><span class="lineno"> 4571</span>&#160;          }</div>
<div class="line"><a name="l04572"></a><span class="lineno"> 4572</span>&#160;        }</div>
<div class="line"><a name="l04573"></a><span class="lineno"> 4573</span>&#160; </div>
<div class="line"><a name="l04574"></a><span class="lineno"> 4574</span>&#160;        <span class="comment">/*--------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04575"></a><span class="lineno"> 4575</span>&#160;        <span class="comment">/*--- Compute the spatial residual of the predictor step for the   ---*/</span></div>
<div class="line"><a name="l04576"></a><span class="lineno"> 4576</span>&#160;        <span class="comment">/*--- time integration points considered. A distinction is made    ---*/</span></div>
<div class="line"><a name="l04577"></a><span class="lineno"> 4577</span>&#160;        <span class="comment">/*--- between an aliased and a non-aliased evaluation of the       ---*/</span></div>
<div class="line"><a name="l04578"></a><span class="lineno"> 4578</span>&#160;        <span class="comment">/*--- predictor residual and between 2D and 3D. The latter is for  ---*/</span></div>
<div class="line"><a name="l04579"></a><span class="lineno"> 4579</span>&#160;        <span class="comment">/*--- performance reasons.                                         ---*/</span></div>
<div class="line"><a name="l04580"></a><span class="lineno"> 4580</span>&#160;        <span class="comment">/*--------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04581"></a><span class="lineno"> 4581</span>&#160; </div>
<div class="line"><a name="l04582"></a><span class="lineno"> 4582</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nIntSimul = intEnd - intStart;</div>
<div class="line"><a name="l04583"></a><span class="lineno"> 4583</span>&#160;        <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l04584"></a><span class="lineno"> 4584</span>&#160;          <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l04585"></a><span class="lineno"> 4585</span>&#160;            <span class="keywordflow">if</span>( useAliasedPredictor )</div>
<div class="line"><a name="l04586"></a><span class="lineno"> 4586</span>&#160;              ADER_DG_AliasedPredictorResidual_2D(config, &amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l], solInt,</div>
<div class="line"><a name="l04587"></a><span class="lineno"> 4587</span>&#160;                                                  nIntSimul, NPadInt, resInt, work);</div>
<div class="line"><a name="l04588"></a><span class="lineno"> 4588</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04589"></a><span class="lineno"> 4589</span>&#160;              ADER_DG_NonAliasedPredictorResidual_2D(config, &amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l], solInt,</div>
<div class="line"><a name="l04590"></a><span class="lineno"> 4590</span>&#160;                                                     nIntSimul, NPadInt, resInt, work);</div>
<div class="line"><a name="l04591"></a><span class="lineno"> 4591</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04592"></a><span class="lineno"> 4592</span>&#160;          }</div>
<div class="line"><a name="l04593"></a><span class="lineno"> 4593</span>&#160; </div>
<div class="line"><a name="l04594"></a><span class="lineno"> 4594</span>&#160;          <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l04595"></a><span class="lineno"> 4595</span>&#160;            <span class="keywordflow">if</span>( useAliasedPredictor )</div>
<div class="line"><a name="l04596"></a><span class="lineno"> 4596</span>&#160;              ADER_DG_AliasedPredictorResidual_3D(config, &amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l], solInt,</div>
<div class="line"><a name="l04597"></a><span class="lineno"> 4597</span>&#160;                                                  nIntSimul, NPadInt, resInt, work);</div>
<div class="line"><a name="l04598"></a><span class="lineno"> 4598</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l04599"></a><span class="lineno"> 4599</span>&#160;              ADER_DG_NonAliasedPredictorResidual_3D(config, &amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l], solInt,</div>
<div class="line"><a name="l04600"></a><span class="lineno"> 4600</span>&#160;                                                     nIntSimul, NPadInt, resInt, work);</div>
<div class="line"><a name="l04601"></a><span class="lineno"> 4601</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04602"></a><span class="lineno"> 4602</span>&#160;          }</div>
<div class="line"><a name="l04603"></a><span class="lineno"> 4603</span>&#160;        }</div>
<div class="line"><a name="l04604"></a><span class="lineno"> 4604</span>&#160; </div>
<div class="line"><a name="l04605"></a><span class="lineno"> 4605</span>&#160;        <span class="comment">/*--------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04606"></a><span class="lineno"> 4606</span>&#160;        <span class="comment">/*--- Update the total residual with the residual of the time      ---*/</span></div>
<div class="line"><a name="l04607"></a><span class="lineno"> 4607</span>&#160;        <span class="comment">/*--- integration points considered. Note the minus sign, because  ---*/</span></div>
<div class="line"><a name="l04608"></a><span class="lineno"> 4608</span>&#160;        <span class="comment">/*--- the residual is put on the RHS of the equation. Also note    ---*/</span></div>
<div class="line"><a name="l04609"></a><span class="lineno"> 4609</span>&#160;        <span class="comment">/*--- that the residuals are stored in such a way that a memcpy    ---*/</span></div>
<div class="line"><a name="l04610"></a><span class="lineno"> 4610</span>&#160;        <span class="comment">/*--- call is avoided when the multiplication takes place with the ---*/</span></div>
<div class="line"><a name="l04611"></a><span class="lineno"> 4611</span>&#160;        <span class="comment">/*--- iteration matrix (i.e. mass matrix) later on.                ---*/</span></div>
<div class="line"><a name="l04612"></a><span class="lineno"> 4612</span>&#160;        <span class="comment">/*--------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04613"></a><span class="lineno"> 4613</span>&#160; </div>
<div class="line"><a name="l04614"></a><span class="lineno"> 4614</span>&#160;        <span class="comment">/* Loop such that all time DOFs are treated. Note that in this loop</span></div>
<div class="line"><a name="l04615"></a><span class="lineno"> 4615</span>&#160;<span class="comment">           several time DOFs are treated simultaneously. */</span></div>
<div class="line"><a name="l04616"></a><span class="lineno"> 4616</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeDOFLoop=0; timeDOFLoop&lt;nTimeDOFLoop; ++timeDOFLoop) {</div>
<div class="line"><a name="l04617"></a><span class="lineno"> 4617</span>&#160; </div>
<div class="line"><a name="l04618"></a><span class="lineno"> 4618</span>&#160;          <span class="comment">/* Set the pointer where the residual for this chunk of time DOFs starts. */</span></div>
<div class="line"><a name="l04619"></a><span class="lineno"> 4619</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *res = resTot + timeDOFLoop*NPad*nDOFs;</div>
<div class="line"><a name="l04620"></a><span class="lineno"> 4620</span>&#160; </div>
<div class="line"><a name="l04621"></a><span class="lineno"> 4621</span>&#160;          <span class="comment">/* Determine the starting and ending time DOF, as well as</span></div>
<div class="line"><a name="l04622"></a><span class="lineno"> 4622</span>&#160;<span class="comment">             the value of the padding to be applied. */</span></div>
<div class="line"><a name="l04623"></a><span class="lineno"> 4623</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> DOFStart = timeDOFLoop*nTimeSimul;</div>
<div class="line"><a name="l04624"></a><span class="lineno"> 4624</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> DOFEnd   = (timeDOFLoop == (nTimeDOFLoop-1)) ?</div>
<div class="line"><a name="l04625"></a><span class="lineno"> 4625</span>&#160;                                          DOFStart + nTimeSimulLastDOFs : DOFStart + nTimeSimul;</div>
<div class="line"><a name="l04626"></a><span class="lineno"> 4626</span>&#160; </div>
<div class="line"><a name="l04627"></a><span class="lineno"> 4627</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPadDOF = (timeDOFLoop == (nTimeDOFLoop-1)) ? NPadLastDOFs : NPad;</div>
<div class="line"><a name="l04628"></a><span class="lineno"> 4628</span>&#160; </div>
<div class="line"><a name="l04629"></a><span class="lineno"> 4629</span>&#160;          <span class="comment">/* Loop over the time integration points that are treated simultaneously. */</span></div>
<div class="line"><a name="l04630"></a><span class="lineno"> 4630</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> intPoint=intStart; intPoint&lt;intEnd; ++intPoint) {</div>
<div class="line"><a name="l04631"></a><span class="lineno"> 4631</span>&#160; </div>
<div class="line"><a name="l04632"></a><span class="lineno"> 4632</span>&#160;            <span class="comment">/* Set the pointer to the address of the 1st residual of the 1st DOF</span></div>
<div class="line"><a name="l04633"></a><span class="lineno"> 4633</span>&#160;<span class="comment">               for this integration point. In this way there is no need to</span></div>
<div class="line"><a name="l04634"></a><span class="lineno"> 4634</span>&#160;<span class="comment">               account for this offset in the loop below. */</span></div>
<div class="line"><a name="l04635"></a><span class="lineno"> 4635</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resThisInt = resInt + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(intPoint - intStart);</div>
<div class="line"><a name="l04636"></a><span class="lineno"> 4636</span>&#160; </div>
<div class="line"><a name="l04637"></a><span class="lineno"> 4637</span>&#160;            <span class="comment">/* Store the interpolation data for this time integration point. */</span></div>
<div class="line"><a name="l04638"></a><span class="lineno"> 4638</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *DOFToThisTimeInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a12a7b04efdba0f2488dc786a1261f1b0">timeInterpolDOFToIntegrationADER_DG</a></div>
<div class="line"><a name="l04639"></a><span class="lineno"> 4639</span>&#160;                                              + intPoint*nTimeDOFs;</div>
<div class="line"><a name="l04640"></a><span class="lineno"> 4640</span>&#160; </div>
<div class="line"><a name="l04641"></a><span class="lineno"> 4641</span>&#160;            <span class="comment">/* Update the actual interpolation. Make a distinction between</span></div>
<div class="line"><a name="l04642"></a><span class="lineno"> 4642</span>&#160;<span class="comment">               2D and 3D for performance reasons. */</span></div>
<div class="line"><a name="l04643"></a><span class="lineno"> 4643</span>&#160;            <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l04644"></a><span class="lineno"> 4644</span>&#160;              <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l04645"></a><span class="lineno"> 4645</span>&#160; </div>
<div class="line"><a name="l04646"></a><span class="lineno"> 4646</span>&#160;                <span class="comment">/* Loop over the time DOFs for this time integration point and check</span></div>
<div class="line"><a name="l04647"></a><span class="lineno"> 4647</span>&#160;<span class="comment">                   if this time integration point contributes to the residual of</span></div>
<div class="line"><a name="l04648"></a><span class="lineno"> 4648</span>&#160;<span class="comment">                   this time DOF. */</span></div>
<div class="line"><a name="l04649"></a><span class="lineno"> 4649</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iTimeDOF=DOFStart; iTimeDOF&lt;DOFEnd; ++iTimeDOF) {</div>
<div class="line"><a name="l04650"></a><span class="lineno"> 4650</span>&#160;                  <span class="keywordflow">if</span>(DOFToThisTimeInt[iTimeDOF] != 0.0) {</div>
<div class="line"><a name="l04651"></a><span class="lineno"> 4651</span>&#160; </div>
<div class="line"><a name="l04652"></a><span class="lineno"> 4652</span>&#160;                    <span class="comment">/* Determine the index where the 1st residual of the 1st spatial</span></div>
<div class="line"><a name="l04653"></a><span class="lineno"> 4653</span>&#160;<span class="comment">                       DOF starts for this time DOF. Also determine the multiplication</span></div>
<div class="line"><a name="l04654"></a><span class="lineno"> 4654</span>&#160;<span class="comment">                       factor for this time DOF. The factor 0.5 is present, because</span></div>
<div class="line"><a name="l04655"></a><span class="lineno"> 4655</span>&#160;<span class="comment">                       the length of the interval in parameter space, [-1..1], is 2. */</span></div>
<div class="line"><a name="l04656"></a><span class="lineno"> 4656</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indResThisTimeDOF = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(iTimeDOF-DOFStart);</div>
<div class="line"><a name="l04657"></a><span class="lineno"> 4657</span>&#160;                    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w = 0.5*timeIntegrationWeights[intPoint]</div>
<div class="line"><a name="l04658"></a><span class="lineno"> 4658</span>&#160;                                      * <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l]*DOFToThisTimeInt[iTimeDOF];</div>
<div class="line"><a name="l04659"></a><span class="lineno"> 4659</span>&#160; </div>
<div class="line"><a name="l04660"></a><span class="lineno"> 4660</span>&#160;                    <span class="comment">/* Loop over the number of spatial DOFs to update their residuals. Note</span></div>
<div class="line"><a name="l04661"></a><span class="lineno"> 4661</span>&#160;<span class="comment">                       the minus sign, see the comment in the larger comment section above. */</span></div>
<div class="line"><a name="l04662"></a><span class="lineno"> 4662</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l04663"></a><span class="lineno"> 4663</span>&#160; </div>
<div class="line"><a name="l04664"></a><span class="lineno"> 4664</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indResThisInt = i*NPadInt;</div>
<div class="line"><a name="l04665"></a><span class="lineno"> 4665</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indResDOF     = indResThisTimeDOF + i*NPadDOF;</div>
<div class="line"><a name="l04666"></a><span class="lineno"> 4666</span>&#160; </div>
<div class="line"><a name="l04667"></a><span class="lineno"> 4667</span>&#160;                      res[indResDOF]   -= w*resThisInt[indResThisInt];</div>
<div class="line"><a name="l04668"></a><span class="lineno"> 4668</span>&#160;                      res[indResDOF+1] -= w*resThisInt[indResThisInt+1];</div>
<div class="line"><a name="l04669"></a><span class="lineno"> 4669</span>&#160;                      res[indResDOF+2] -= w*resThisInt[indResThisInt+2];</div>
<div class="line"><a name="l04670"></a><span class="lineno"> 4670</span>&#160;                      res[indResDOF+3] -= w*resThisInt[indResThisInt+3];</div>
<div class="line"><a name="l04671"></a><span class="lineno"> 4671</span>&#160;                    }</div>
<div class="line"><a name="l04672"></a><span class="lineno"> 4672</span>&#160;                  }</div>
<div class="line"><a name="l04673"></a><span class="lineno"> 4673</span>&#160;                }</div>
<div class="line"><a name="l04674"></a><span class="lineno"> 4674</span>&#160; </div>
<div class="line"><a name="l04675"></a><span class="lineno"> 4675</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04676"></a><span class="lineno"> 4676</span>&#160;              }</div>
<div class="line"><a name="l04677"></a><span class="lineno"> 4677</span>&#160; </div>
<div class="line"><a name="l04678"></a><span class="lineno"> 4678</span>&#160;              <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l04679"></a><span class="lineno"> 4679</span>&#160; </div>
<div class="line"><a name="l04680"></a><span class="lineno"> 4680</span>&#160;                <span class="comment">/* Loop over the time DOFs for this time integration point and check</span></div>
<div class="line"><a name="l04681"></a><span class="lineno"> 4681</span>&#160;<span class="comment">                   if this time integration point contributes to the residual of</span></div>
<div class="line"><a name="l04682"></a><span class="lineno"> 4682</span>&#160;<span class="comment">                   this time DOF. */</span></div>
<div class="line"><a name="l04683"></a><span class="lineno"> 4683</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iTimeDOF=DOFStart; iTimeDOF&lt;DOFEnd; ++iTimeDOF) {</div>
<div class="line"><a name="l04684"></a><span class="lineno"> 4684</span>&#160;                  <span class="keywordflow">if</span>(DOFToThisTimeInt[iTimeDOF] != 0.0) {</div>
<div class="line"><a name="l04685"></a><span class="lineno"> 4685</span>&#160; </div>
<div class="line"><a name="l04686"></a><span class="lineno"> 4686</span>&#160;                    <span class="comment">/* Determine the index where the 1st residual of the 1st spatial</span></div>
<div class="line"><a name="l04687"></a><span class="lineno"> 4687</span>&#160;<span class="comment">                       DOF starts for this time DOF. Also determine the multiplication</span></div>
<div class="line"><a name="l04688"></a><span class="lineno"> 4688</span>&#160;<span class="comment">                       factor for this time DOF. The factor 0.5 is present, because</span></div>
<div class="line"><a name="l04689"></a><span class="lineno"> 4689</span>&#160;<span class="comment">                       the length of the interval in parameter space, [-1..1], is 2. */</span></div>
<div class="line"><a name="l04690"></a><span class="lineno"> 4690</span>&#160;                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indResThisTimeDOF = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(iTimeDOF-DOFStart);</div>
<div class="line"><a name="l04691"></a><span class="lineno"> 4691</span>&#160;                    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w = 0.5*timeIntegrationWeights[intPoint]</div>
<div class="line"><a name="l04692"></a><span class="lineno"> 4692</span>&#160;                                      * <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l]*DOFToThisTimeInt[iTimeDOF];</div>
<div class="line"><a name="l04693"></a><span class="lineno"> 4693</span>&#160; </div>
<div class="line"><a name="l04694"></a><span class="lineno"> 4694</span>&#160;                    <span class="comment">/* Loop over the number of spatial DOFs to update their residuals. Note</span></div>
<div class="line"><a name="l04695"></a><span class="lineno"> 4695</span>&#160;<span class="comment">                       the minus sign, see the comment in the larger comment section above. */</span></div>
<div class="line"><a name="l04696"></a><span class="lineno"> 4696</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l04697"></a><span class="lineno"> 4697</span>&#160; </div>
<div class="line"><a name="l04698"></a><span class="lineno"> 4698</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indResThisInt = i*NPadInt;</div>
<div class="line"><a name="l04699"></a><span class="lineno"> 4699</span>&#160;                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indResDOF     = indResThisTimeDOF + i*NPadDOF;</div>
<div class="line"><a name="l04700"></a><span class="lineno"> 4700</span>&#160; </div>
<div class="line"><a name="l04701"></a><span class="lineno"> 4701</span>&#160;                      res[indResDOF]   -= w*resThisInt[indResThisInt];</div>
<div class="line"><a name="l04702"></a><span class="lineno"> 4702</span>&#160;                      res[indResDOF+1] -= w*resThisInt[indResThisInt+1];</div>
<div class="line"><a name="l04703"></a><span class="lineno"> 4703</span>&#160;                      res[indResDOF+2] -= w*resThisInt[indResThisInt+2];</div>
<div class="line"><a name="l04704"></a><span class="lineno"> 4704</span>&#160;                      res[indResDOF+3] -= w*resThisInt[indResThisInt+3];</div>
<div class="line"><a name="l04705"></a><span class="lineno"> 4705</span>&#160;                      res[indResDOF+4] -= w*resThisInt[indResThisInt+4];</div>
<div class="line"><a name="l04706"></a><span class="lineno"> 4706</span>&#160;                    }</div>
<div class="line"><a name="l04707"></a><span class="lineno"> 4707</span>&#160;                  }</div>
<div class="line"><a name="l04708"></a><span class="lineno"> 4708</span>&#160;                }</div>
<div class="line"><a name="l04709"></a><span class="lineno"> 4709</span>&#160; </div>
<div class="line"><a name="l04710"></a><span class="lineno"> 4710</span>&#160;                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04711"></a><span class="lineno"> 4711</span>&#160;              }</div>
<div class="line"><a name="l04712"></a><span class="lineno"> 4712</span>&#160;            }</div>
<div class="line"><a name="l04713"></a><span class="lineno"> 4713</span>&#160;          }</div>
<div class="line"><a name="l04714"></a><span class="lineno"> 4714</span>&#160;        }</div>
<div class="line"><a name="l04715"></a><span class="lineno"> 4715</span>&#160;      }</div>
<div class="line"><a name="l04716"></a><span class="lineno"> 4716</span>&#160; </div>
<div class="line"><a name="l04717"></a><span class="lineno"> 4717</span>&#160;      <span class="comment">/*----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04718"></a><span class="lineno"> 4718</span>&#160;      <span class="comment">/*--- Determine the updates of the solution of the time DOFs         ---*/</span></div>
<div class="line"><a name="l04719"></a><span class="lineno"> 4719</span>&#160;      <span class="comment">/*--- relative to the solution of the previous time step. This is    ---*/</span></div>
<div class="line"><a name="l04720"></a><span class="lineno"> 4720</span>&#160;      <span class="comment">/*--- accomplished by multiplying the total residual of the spatial  ---*/</span></div>
<div class="line"><a name="l04721"></a><span class="lineno"> 4721</span>&#160;      <span class="comment">/*--- DOFs in all time DOFs by the inverse of the mass matrix and an ---*/</span></div>
<div class="line"><a name="l04722"></a><span class="lineno"> 4722</span>&#160;      <span class="comment">/*--- appropriate weight (timeCoefADER_DG). The residual of the time ---*/</span></div>
<div class="line"><a name="l04723"></a><span class="lineno"> 4723</span>&#160;      <span class="comment">/*--- DOFs is stored such that multiple time DOFs can be treated     ---*/</span></div>
<div class="line"><a name="l04724"></a><span class="lineno"> 4724</span>&#160;      <span class="comment">/*--- simultaneously without the need for a memcpy. In this way the  ---*/</span></div>
<div class="line"><a name="l04725"></a><span class="lineno"> 4725</span>&#160;      <span class="comment">/*--- performance of the matrix multiplication is optimal.           ---*/</span></div>
<div class="line"><a name="l04726"></a><span class="lineno"> 4726</span>&#160;      <span class="comment">/*----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04727"></a><span class="lineno"> 4727</span>&#160; </div>
<div class="line"><a name="l04728"></a><span class="lineno"> 4728</span>&#160;      <span class="comment">/* Initialize the update to zero. */</span></div>
<div class="line"><a name="l04729"></a><span class="lineno"> 4729</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(nVarNDOFs*nTimeDOFs); ++i) dSol[i] = 0.0;</div>
<div class="line"><a name="l04730"></a><span class="lineno"> 4730</span>&#160; </div>
<div class="line"><a name="l04731"></a><span class="lineno"> 4731</span>&#160;      <span class="comment">/* Loop such that all time DOFs are treated. Note that in this loop</span></div>
<div class="line"><a name="l04732"></a><span class="lineno"> 4732</span>&#160;<span class="comment">         several time DOFs are treated simultaneously. */</span></div>
<div class="line"><a name="l04733"></a><span class="lineno"> 4733</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeDOFLoop=0; timeDOFLoop&lt;nTimeDOFLoop; ++timeDOFLoop) {</div>
<div class="line"><a name="l04734"></a><span class="lineno"> 4734</span>&#160; </div>
<div class="line"><a name="l04735"></a><span class="lineno"> 4735</span>&#160;        <span class="comment">/* Set the pointer where the residual for this chunk of time DOFs starts. */</span></div>
<div class="line"><a name="l04736"></a><span class="lineno"> 4736</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *res = resTot + timeDOFLoop*NPad*nDOFs;</div>
<div class="line"><a name="l04737"></a><span class="lineno"> 4737</span>&#160; </div>
<div class="line"><a name="l04738"></a><span class="lineno"> 4738</span>&#160;        <span class="comment">/* Determine the starting and ending time DOF, as well as</span></div>
<div class="line"><a name="l04739"></a><span class="lineno"> 4739</span>&#160;<span class="comment">           the value of the padding to be applied. */</span></div>
<div class="line"><a name="l04740"></a><span class="lineno"> 4740</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> DOFStart = timeDOFLoop*nTimeSimul;</div>
<div class="line"><a name="l04741"></a><span class="lineno"> 4741</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> DOFEnd   = (timeDOFLoop == (nTimeDOFLoop-1)) ?</div>
<div class="line"><a name="l04742"></a><span class="lineno"> 4742</span>&#160;                                        DOFStart + nTimeSimulLastDOFs : DOFStart + nTimeSimul;</div>
<div class="line"><a name="l04743"></a><span class="lineno"> 4743</span>&#160; </div>
<div class="line"><a name="l04744"></a><span class="lineno"> 4744</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPadDOF = (timeDOFLoop == (nTimeDOFLoop-1)) ? NPadLastDOFs : NPad;</div>
<div class="line"><a name="l04745"></a><span class="lineno"> 4745</span>&#160; </div>
<div class="line"><a name="l04746"></a><span class="lineno"> 4746</span>&#160;        <span class="comment">/* Carry out the multiplication with the inverse of the mass matrix.</span></div>
<div class="line"><a name="l04747"></a><span class="lineno"> 4747</span>&#160;<span class="comment">           The result is stored in resInt as temporary storage. */</span></div>
<div class="line"><a name="l04748"></a><span class="lineno"> 4748</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPadDOF, nDOFs, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].invMassMatrix.data(),</div>
<div class="line"><a name="l04749"></a><span class="lineno"> 4749</span>&#160;                            res, resInt, config);</div>
<div class="line"><a name="l04750"></a><span class="lineno"> 4750</span>&#160; </div>
<div class="line"><a name="l04751"></a><span class="lineno"> 4751</span>&#160;        <span class="comment">/* Make a distinction between 2D and 3D for performance reasons. */</span></div>
<div class="line"><a name="l04752"></a><span class="lineno"> 4752</span>&#160;        <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l04753"></a><span class="lineno"> 4753</span>&#160;          <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l04754"></a><span class="lineno"> 4754</span>&#160; </div>
<div class="line"><a name="l04755"></a><span class="lineno"> 4755</span>&#160;            <span class="comment">/* Loop over the time DOFs for this chunk of time DOFs. */</span></div>
<div class="line"><a name="l04756"></a><span class="lineno"> 4756</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iTimeDOF=DOFStart; iTimeDOF&lt;DOFEnd; ++iTimeDOF) {</div>
<div class="line"><a name="l04757"></a><span class="lineno"> 4757</span>&#160; </div>
<div class="line"><a name="l04758"></a><span class="lineno"> 4758</span>&#160;              <span class="comment">/* Index of the 1st entry of the 1st spatial DOF starts for this time DOF. */</span></div>
<div class="line"><a name="l04759"></a><span class="lineno"> 4759</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indResThisTimeDOF = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(iTimeDOF-DOFStart);</div>
<div class="line"><a name="l04760"></a><span class="lineno"> 4760</span>&#160; </div>
<div class="line"><a name="l04761"></a><span class="lineno"> 4761</span>&#160;              <span class="comment">/* Loop over all the time DOFs to compute the contribution of</span></div>
<div class="line"><a name="l04762"></a><span class="lineno"> 4762</span>&#160;<span class="comment">                 iTimeDOF to the update. */</span></div>
<div class="line"><a name="l04763"></a><span class="lineno"> 4763</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jTimeDOF=0; jTimeDOF&lt;nTimeDOFs; ++jTimeDOF) {</div>
<div class="line"><a name="l04764"></a><span class="lineno"> 4764</span>&#160; </div>
<div class="line"><a name="l04765"></a><span class="lineno"> 4765</span>&#160;                <span class="comment">/* Easier storage of the ADER coefficient of timeDOF jTimeDOF</span></div>
<div class="line"><a name="l04766"></a><span class="lineno"> 4766</span>&#160;<span class="comment">                   to the residual of iTimeDOF and determine the starting</span></div>
<div class="line"><a name="l04767"></a><span class="lineno"> 4767</span>&#160;<span class="comment">                   index for the update for timeDOF jTimeDOF. */</span></div>
<div class="line"><a name="l04768"></a><span class="lineno"> 4768</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> coefADER = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a353efc3b5e3478ca75ba6cb27acab9bb">timeCoefADER_DG</a>[jTimeDOF*nTimeDOFs+iTimeDOF];</div>
<div class="line"><a name="l04769"></a><span class="lineno"> 4769</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indDSolTimeInd = jTimeDOF*nVarNDOFs;</div>
<div class="line"><a name="l04770"></a><span class="lineno"> 4770</span>&#160; </div>
<div class="line"><a name="l04771"></a><span class="lineno"> 4771</span>&#160;                <span class="comment">/* Loop over the spatial DOFs for timeDOF jTimeDOF and update dSol. */</span></div>
<div class="line"><a name="l04772"></a><span class="lineno"> 4772</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l04773"></a><span class="lineno"> 4773</span>&#160; </div>
<div class="line"><a name="l04774"></a><span class="lineno"> 4774</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indResInt = indResThisTimeDOF + i*NPadDOF;</div>
<div class="line"><a name="l04775"></a><span class="lineno"> 4775</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indDSol   = indDSolTimeInd    + i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04776"></a><span class="lineno"> 4776</span>&#160; </div>
<div class="line"><a name="l04777"></a><span class="lineno"> 4777</span>&#160;                  dSol[indDSol]   += coefADER*resInt[indResInt];</div>
<div class="line"><a name="l04778"></a><span class="lineno"> 4778</span>&#160;                  dSol[indDSol+1] += coefADER*resInt[indResInt+1];</div>
<div class="line"><a name="l04779"></a><span class="lineno"> 4779</span>&#160;                  dSol[indDSol+2] += coefADER*resInt[indResInt+2];</div>
<div class="line"><a name="l04780"></a><span class="lineno"> 4780</span>&#160;                  dSol[indDSol+3] += coefADER*resInt[indResInt+3];</div>
<div class="line"><a name="l04781"></a><span class="lineno"> 4781</span>&#160;                }</div>
<div class="line"><a name="l04782"></a><span class="lineno"> 4782</span>&#160;              }</div>
<div class="line"><a name="l04783"></a><span class="lineno"> 4783</span>&#160;            }</div>
<div class="line"><a name="l04784"></a><span class="lineno"> 4784</span>&#160; </div>
<div class="line"><a name="l04785"></a><span class="lineno"> 4785</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04786"></a><span class="lineno"> 4786</span>&#160;          }</div>
<div class="line"><a name="l04787"></a><span class="lineno"> 4787</span>&#160; </div>
<div class="line"><a name="l04788"></a><span class="lineno"> 4788</span>&#160;          <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l04789"></a><span class="lineno"> 4789</span>&#160; </div>
<div class="line"><a name="l04790"></a><span class="lineno"> 4790</span>&#160;            <span class="comment">/* Loop over the time DOFs for this chunk of time DOFs. */</span></div>
<div class="line"><a name="l04791"></a><span class="lineno"> 4791</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iTimeDOF=DOFStart; iTimeDOF&lt;DOFEnd; ++iTimeDOF) {</div>
<div class="line"><a name="l04792"></a><span class="lineno"> 4792</span>&#160; </div>
<div class="line"><a name="l04793"></a><span class="lineno"> 4793</span>&#160;              <span class="comment">/* Index of the 1st entry of the 1st spatial DOF starts for this time DOF. */</span></div>
<div class="line"><a name="l04794"></a><span class="lineno"> 4794</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indResThisTimeDOF = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(iTimeDOF-DOFStart);</div>
<div class="line"><a name="l04795"></a><span class="lineno"> 4795</span>&#160; </div>
<div class="line"><a name="l04796"></a><span class="lineno"> 4796</span>&#160;              <span class="comment">/* Loop over all the time DOFs to compute the contribution of</span></div>
<div class="line"><a name="l04797"></a><span class="lineno"> 4797</span>&#160;<span class="comment">                 iTimeDOF to the update. */</span></div>
<div class="line"><a name="l04798"></a><span class="lineno"> 4798</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> jTimeDOF=0; jTimeDOF&lt;nTimeDOFs; ++jTimeDOF) {</div>
<div class="line"><a name="l04799"></a><span class="lineno"> 4799</span>&#160; </div>
<div class="line"><a name="l04800"></a><span class="lineno"> 4800</span>&#160;                <span class="comment">/* Easier storage of the ADER coefficient of timeDOF jTimeDOF</span></div>
<div class="line"><a name="l04801"></a><span class="lineno"> 4801</span>&#160;<span class="comment">                   to the residual of iTimeDOF and determine the starting</span></div>
<div class="line"><a name="l04802"></a><span class="lineno"> 4802</span>&#160;<span class="comment">                   index for the update for timeDOF jTimeDOF. */</span></div>
<div class="line"><a name="l04803"></a><span class="lineno"> 4803</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> coefADER = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a353efc3b5e3478ca75ba6cb27acab9bb">timeCoefADER_DG</a>[jTimeDOF*nTimeDOFs+iTimeDOF];</div>
<div class="line"><a name="l04804"></a><span class="lineno"> 4804</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indDSolTimeInd = jTimeDOF*nVarNDOFs;</div>
<div class="line"><a name="l04805"></a><span class="lineno"> 4805</span>&#160; </div>
<div class="line"><a name="l04806"></a><span class="lineno"> 4806</span>&#160;                <span class="comment">/* Loop over the spatial DOFs for timeDOF jTimeDOF and update dSol. */</span></div>
<div class="line"><a name="l04807"></a><span class="lineno"> 4807</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l04808"></a><span class="lineno"> 4808</span>&#160; </div>
<div class="line"><a name="l04809"></a><span class="lineno"> 4809</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indResInt = indResThisTimeDOF + i*NPadDOF;</div>
<div class="line"><a name="l04810"></a><span class="lineno"> 4810</span>&#160;                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> indDSol   = indDSolTimeInd    + i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04811"></a><span class="lineno"> 4811</span>&#160; </div>
<div class="line"><a name="l04812"></a><span class="lineno"> 4812</span>&#160;                  dSol[indDSol]   += coefADER*resInt[indResInt];</div>
<div class="line"><a name="l04813"></a><span class="lineno"> 4813</span>&#160;                  dSol[indDSol+1] += coefADER*resInt[indResInt+1];</div>
<div class="line"><a name="l04814"></a><span class="lineno"> 4814</span>&#160;                  dSol[indDSol+2] += coefADER*resInt[indResInt+2];</div>
<div class="line"><a name="l04815"></a><span class="lineno"> 4815</span>&#160;                  dSol[indDSol+3] += coefADER*resInt[indResInt+3];</div>
<div class="line"><a name="l04816"></a><span class="lineno"> 4816</span>&#160;                  dSol[indDSol+4] += coefADER*resInt[indResInt+4];</div>
<div class="line"><a name="l04817"></a><span class="lineno"> 4817</span>&#160;                } </div>
<div class="line"><a name="l04818"></a><span class="lineno"> 4818</span>&#160;              } </div>
<div class="line"><a name="l04819"></a><span class="lineno"> 4819</span>&#160;            } </div>
<div class="line"><a name="l04820"></a><span class="lineno"> 4820</span>&#160; </div>
<div class="line"><a name="l04821"></a><span class="lineno"> 4821</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04822"></a><span class="lineno"> 4822</span>&#160;          }</div>
<div class="line"><a name="l04823"></a><span class="lineno"> 4823</span>&#160;        }</div>
<div class="line"><a name="l04824"></a><span class="lineno"> 4824</span>&#160;      }</div>
<div class="line"><a name="l04825"></a><span class="lineno"> 4825</span>&#160; </div>
<div class="line"><a name="l04826"></a><span class="lineno"> 4826</span>&#160;      <span class="comment">/*----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04827"></a><span class="lineno"> 4827</span>&#160;      <span class="comment">/*--- Determine whether or not the iteration process is considered   ---*/</span></div>
<div class="line"><a name="l04828"></a><span class="lineno"> 4828</span>&#160;      <span class="comment">/*--- converged. Make a distinction between 2D and 3D for            ---*/</span></div>
<div class="line"><a name="l04829"></a><span class="lineno"> 4829</span>&#160;      <span class="comment">/*--- performance reasons.                                           ---*/</span></div>
<div class="line"><a name="l04830"></a><span class="lineno"> 4830</span>&#160;      <span class="comment">/*----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04831"></a><span class="lineno"> 4831</span>&#160; </div>
<div class="line"><a name="l04832"></a><span class="lineno"> 4832</span>&#160;      <span class="comment">/* Initialize converged to true. It will be overwritten below when one</span></div>
<div class="line"><a name="l04833"></a><span class="lineno"> 4833</span>&#160;<span class="comment">         or more DOFs in both space and time are not considered converged. */</span></div>
<div class="line"><a name="l04834"></a><span class="lineno"> 4834</span>&#160;      <span class="keywordtype">bool</span> converged = <span class="keyword">true</span>;</div>
<div class="line"><a name="l04835"></a><span class="lineno"> 4835</span>&#160; </div>
<div class="line"><a name="l04836"></a><span class="lineno"> 4836</span>&#160;      <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l04837"></a><span class="lineno"> 4837</span>&#160;        <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l04838"></a><span class="lineno"> 4838</span>&#160;          <span class="comment">/* 2D simulation. Loop over the time DOFs to determine the new</span></div>
<div class="line"><a name="l04839"></a><span class="lineno"> 4839</span>&#160;<span class="comment">             solution and to determine whether or not the iteration procedure</span></div>
<div class="line"><a name="l04840"></a><span class="lineno"> 4840</span>&#160;<span class="comment">             is considered converged. */</span></div>
<div class="line"><a name="l04841"></a><span class="lineno"> 4841</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nTimeDOFs; ++j) {</div>
<div class="line"><a name="l04842"></a><span class="lineno"> 4842</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *solTimeInd  = solPred + j*nVarNDOFs;</div>
<div class="line"><a name="l04843"></a><span class="lineno"> 4843</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolTimeInd = dSol    + j*nVarNDOFs;</div>
<div class="line"><a name="l04844"></a><span class="lineno"> 4844</span>&#160; </div>
<div class="line"><a name="l04845"></a><span class="lineno"> 4845</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l04846"></a><span class="lineno"> 4846</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> off = i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04847"></a><span class="lineno"> 4847</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *ssolCur = solCur + off;</div>
<div class="line"><a name="l04848"></a><span class="lineno"> 4848</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *ddSol   = dSolTimeInd + off;</div>
<div class="line"><a name="l04849"></a><span class="lineno"> 4849</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *ssol    = solTimeInd  + off;</div>
<div class="line"><a name="l04850"></a><span class="lineno"> 4850</span>&#160; </div>
<div class="line"><a name="l04851"></a><span class="lineno"> 4851</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> solOld;</div>
<div class="line"><a name="l04852"></a><span class="lineno"> 4852</span>&#160;              solOld  = ssol[0]; ssol[0] = ssolCur[0] + ddSol[0];</div>
<div class="line"><a name="l04853"></a><span class="lineno"> 4853</span>&#160;              solOld -= ssol[0]; <span class="keywordflow">if</span>(fabs(solOld) &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[0]) converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04854"></a><span class="lineno"> 4854</span>&#160; </div>
<div class="line"><a name="l04855"></a><span class="lineno"> 4855</span>&#160;              solOld  = ssol[1]; ssol[1] = ssolCur[1] + ddSol[1];</div>
<div class="line"><a name="l04856"></a><span class="lineno"> 4856</span>&#160;              solOld -= ssol[1]; <span class="keywordflow">if</span>(fabs(solOld) &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[1]) converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04857"></a><span class="lineno"> 4857</span>&#160; </div>
<div class="line"><a name="l04858"></a><span class="lineno"> 4858</span>&#160;              solOld  = ssol[2]; ssol[2] = ssolCur[2] + ddSol[2];</div>
<div class="line"><a name="l04859"></a><span class="lineno"> 4859</span>&#160;              solOld -= ssol[2]; <span class="keywordflow">if</span>(fabs(solOld) &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[2]) converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04860"></a><span class="lineno"> 4860</span>&#160; </div>
<div class="line"><a name="l04861"></a><span class="lineno"> 4861</span>&#160;              solOld  = ssol[3]; ssol[3] = ssolCur[3] + ddSol[3];</div>
<div class="line"><a name="l04862"></a><span class="lineno"> 4862</span>&#160;              solOld -= ssol[3]; <span class="keywordflow">if</span>(fabs(solOld) &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[3]) converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04863"></a><span class="lineno"> 4863</span>&#160;            }</div>
<div class="line"><a name="l04864"></a><span class="lineno"> 4864</span>&#160;          }</div>
<div class="line"><a name="l04865"></a><span class="lineno"> 4865</span>&#160; </div>
<div class="line"><a name="l04866"></a><span class="lineno"> 4866</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04867"></a><span class="lineno"> 4867</span>&#160;        }</div>
<div class="line"><a name="l04868"></a><span class="lineno"> 4868</span>&#160; </div>
<div class="line"><a name="l04869"></a><span class="lineno"> 4869</span>&#160;        <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l04870"></a><span class="lineno"> 4870</span>&#160;          <span class="comment">/* 3D simulation. Loop over the time DOFs to determine the new</span></div>
<div class="line"><a name="l04871"></a><span class="lineno"> 4871</span>&#160;<span class="comment">             solution and to determine whether or not the iteration procedure</span></div>
<div class="line"><a name="l04872"></a><span class="lineno"> 4872</span>&#160;<span class="comment">             is considered converged. */</span></div>
<div class="line"><a name="l04873"></a><span class="lineno"> 4873</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nTimeDOFs; ++j) {</div>
<div class="line"><a name="l04874"></a><span class="lineno"> 4874</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *solTimeInd  = solPred + j*nVarNDOFs;</div>
<div class="line"><a name="l04875"></a><span class="lineno"> 4875</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolTimeInd = dSol    + j*nVarNDOFs;</div>
<div class="line"><a name="l04876"></a><span class="lineno"> 4876</span>&#160; </div>
<div class="line"><a name="l04877"></a><span class="lineno"> 4877</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l04878"></a><span class="lineno"> 4878</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> off = i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04879"></a><span class="lineno"> 4879</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *ssolCur = solCur + off;</div>
<div class="line"><a name="l04880"></a><span class="lineno"> 4880</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *ddSol   = dSolTimeInd + off;</div>
<div class="line"><a name="l04881"></a><span class="lineno"> 4881</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *ssol    = solTimeInd  + off;</div>
<div class="line"><a name="l04882"></a><span class="lineno"> 4882</span>&#160; </div>
<div class="line"><a name="l04883"></a><span class="lineno"> 4883</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> solOld;</div>
<div class="line"><a name="l04884"></a><span class="lineno"> 4884</span>&#160;              solOld  = ssol[0]; ssol[0] = ssolCur[0] + ddSol[0];</div>
<div class="line"><a name="l04885"></a><span class="lineno"> 4885</span>&#160;              solOld -= ssol[0]; <span class="keywordflow">if</span>(fabs(solOld) &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[0]) converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04886"></a><span class="lineno"> 4886</span>&#160; </div>
<div class="line"><a name="l04887"></a><span class="lineno"> 4887</span>&#160;              solOld  = ssol[1]; ssol[1] = ssolCur[1] + ddSol[1];</div>
<div class="line"><a name="l04888"></a><span class="lineno"> 4888</span>&#160;              solOld -= ssol[1]; <span class="keywordflow">if</span>(fabs(solOld) &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[1]) converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04889"></a><span class="lineno"> 4889</span>&#160; </div>
<div class="line"><a name="l04890"></a><span class="lineno"> 4890</span>&#160;              solOld  = ssol[2]; ssol[2] = ssolCur[2] + ddSol[2];</div>
<div class="line"><a name="l04891"></a><span class="lineno"> 4891</span>&#160;              solOld -= ssol[2]; <span class="keywordflow">if</span>(fabs(solOld) &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[2]) converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04892"></a><span class="lineno"> 4892</span>&#160; </div>
<div class="line"><a name="l04893"></a><span class="lineno"> 4893</span>&#160;              solOld  = ssol[3]; ssol[3] = ssolCur[3] + ddSol[3];</div>
<div class="line"><a name="l04894"></a><span class="lineno"> 4894</span>&#160;              solOld -= ssol[3]; <span class="keywordflow">if</span>(fabs(solOld) &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[3]) converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04895"></a><span class="lineno"> 4895</span>&#160; </div>
<div class="line"><a name="l04896"></a><span class="lineno"> 4896</span>&#160;              solOld  = ssol[4]; ssol[4] = ssolCur[4] + ddSol[4];</div>
<div class="line"><a name="l04897"></a><span class="lineno"> 4897</span>&#160;              solOld -= ssol[4]; <span class="keywordflow">if</span>(fabs(solOld) &gt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">TolSolADER</a>[4]) converged = <span class="keyword">false</span>;</div>
<div class="line"><a name="l04898"></a><span class="lineno"> 4898</span>&#160;            }</div>
<div class="line"><a name="l04899"></a><span class="lineno"> 4899</span>&#160;          }</div>
<div class="line"><a name="l04900"></a><span class="lineno"> 4900</span>&#160; </div>
<div class="line"><a name="l04901"></a><span class="lineno"> 4901</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04902"></a><span class="lineno"> 4902</span>&#160;        }</div>
<div class="line"><a name="l04903"></a><span class="lineno"> 4903</span>&#160;      }</div>
<div class="line"><a name="l04904"></a><span class="lineno"> 4904</span>&#160; </div>
<div class="line"><a name="l04905"></a><span class="lineno"> 4905</span>&#160;      <span class="comment">/* Break the iteration loop if the solution is considered converged. */</span></div>
<div class="line"><a name="l04906"></a><span class="lineno"> 4906</span>&#160;      <span class="keywordflow">if</span>( converged ) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l04907"></a><span class="lineno"> 4907</span>&#160;    }</div>
<div class="line"><a name="l04908"></a><span class="lineno"> 4908</span>&#160; </div>
<div class="line"><a name="l04909"></a><span class="lineno"> 4909</span>&#160;    <span class="comment">/* Store the predictor solution in the correct location of</span></div>
<div class="line"><a name="l04910"></a><span class="lineno"> 4910</span>&#160;<span class="comment">       VecSolDOFsPredictorADER. */</span></div>
<div class="line"><a name="l04911"></a><span class="lineno"> 4911</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nTimeDOFs; ++j) {</div>
<div class="line"><a name="l04912"></a><span class="lineno"> 4912</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solADERPred = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a98849e262d69140a6a2d222d1a33de00">VecSolDOFsPredictorADER</a>.data()</div>
<div class="line"><a name="l04913"></a><span class="lineno"> 4913</span>&#160;                             + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(j*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a> + <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>);</div>
<div class="line"><a name="l04914"></a><span class="lineno"> 4914</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solPredTime = solPred + j*nVarNDOFs;</div>
<div class="line"><a name="l04915"></a><span class="lineno"> 4915</span>&#160; </div>
<div class="line"><a name="l04916"></a><span class="lineno"> 4916</span>&#160;      memcpy(solADERPred, solPredTime, nBytes);</div>
<div class="line"><a name="l04917"></a><span class="lineno"> 4917</span>&#160;    }</div>
<div class="line"><a name="l04918"></a><span class="lineno"> 4918</span>&#160;  }</div>
<div class="line"><a name="l04919"></a><span class="lineno"> 4919</span>&#160;}</div>
<div class="line"><a name="l04920"></a><span class="lineno"> 4920</span>&#160; </div>
<div class="line"><a name="l04921"></a><span class="lineno"> 4921</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::ADER_DG_AliasedPredictorResidual_2D(<a class="code" href="class_c_config.html">CConfig</a>              *config,</div>
<div class="line"><a name="l04922"></a><span class="lineno"> 4922</span>&#160;                                                              <a class="code" href="class_c_volume_element_f_e_m.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l04923"></a><span class="lineno"> 4923</span>&#160;                                                              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *sol,</div>
<div class="line"><a name="l04924"></a><span class="lineno"> 4924</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l04925"></a><span class="lineno"> 4925</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l04926"></a><span class="lineno"> 4926</span>&#160;                                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *res,</div>
<div class="line"><a name="l04927"></a><span class="lineno"> 4927</span>&#160;                                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *work) {</div>
<div class="line"><a name="l04928"></a><span class="lineno"> 4928</span>&#160; </div>
<div class="line"><a name="l04929"></a><span class="lineno"> 4929</span>&#160;  <span class="comment">/* Get the necessary information from the standard element. */</span></div>
<div class="line"><a name="l04930"></a><span class="lineno"> 4930</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l04931"></a><span class="lineno"> 4931</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l04932"></a><span class="lineno"> 4932</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l04933"></a><span class="lineno"> 4933</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisInt            = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a6fbf928e9b9fa2fd9dab46309e0ed6b6">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l04934"></a><span class="lineno"> 4934</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matDerBasisInt         = matBasisInt + nDOFs*nInt;</div>
<div class="line"><a name="l04935"></a><span class="lineno"> 4935</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFunctionsIntTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0d8111ae54b825086ea24a9241a361f1">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l04936"></a><span class="lineno"> 4936</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights                = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l04937"></a><span class="lineno"> 4937</span>&#160; </div>
<div class="line"><a name="l04938"></a><span class="lineno"> 4938</span>&#160;  <span class="comment">/* Set the pointers for fluxes in the DOFs, the gradient of the fluxes in</span></div>
<div class="line"><a name="l04939"></a><span class="lineno"> 4939</span>&#160;<span class="comment">     the integration points and the divergence of the fluxes in the integration</span></div>
<div class="line"><a name="l04940"></a><span class="lineno"> 4940</span>&#160;<span class="comment">     points. Note that the same array can be used for the first and last array,</span></div>
<div class="line"><a name="l04941"></a><span class="lineno"> 4941</span>&#160;<span class="comment">     because divFlux is only needed after the fluxes in the DOFs. */</span></div>
<div class="line"><a name="l04942"></a><span class="lineno"> 4942</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxXDOF     = work;</div>
<div class="line"><a name="l04943"></a><span class="lineno"> 4943</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxYDOF     = fluxXDOF + NPad*nDOFs;</div>
<div class="line"><a name="l04944"></a><span class="lineno"> 4944</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXInt = fluxYDOF + NPad*nDOFs;</div>
<div class="line"><a name="l04945"></a><span class="lineno"> 4945</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYInt = gradFluxXInt + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad*nInt;</div>
<div class="line"><a name="l04946"></a><span class="lineno"> 4946</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFlux      = work;</div>
<div class="line"><a name="l04947"></a><span class="lineno"> 4947</span>&#160; </div>
<div class="line"><a name="l04948"></a><span class="lineno"> 4948</span>&#160;  <span class="comment">/* Determine the offset between the r-derivatives and s-derivatives of</span></div>
<div class="line"><a name="l04949"></a><span class="lineno"> 4949</span>&#160;<span class="comment">     the fluxes. */</span></div>
<div class="line"><a name="l04950"></a><span class="lineno"> 4950</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l04951"></a><span class="lineno"> 4951</span>&#160; </div>
<div class="line"><a name="l04952"></a><span class="lineno"> 4952</span>&#160;  <span class="comment">/* Store the number of metric points per integration point for readability. */</span></div>
<div class="line"><a name="l04953"></a><span class="lineno"> 4953</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 5;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l04954"></a><span class="lineno"> 4954</span>&#160; </div>
<div class="line"><a name="l04955"></a><span class="lineno"> 4955</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04956"></a><span class="lineno"> 4956</span>&#160;  <span class="comment">/*---          Construct the Cartesian fluxes in the DOFs.               ---*/</span></div>
<div class="line"><a name="l04957"></a><span class="lineno"> 4957</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l04958"></a><span class="lineno"> 4958</span>&#160; </div>
<div class="line"><a name="l04959"></a><span class="lineno"> 4959</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l04960"></a><span class="lineno"> 4960</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l04961"></a><span class="lineno"> 4961</span>&#160; </div>
<div class="line"><a name="l04962"></a><span class="lineno"> 4962</span>&#160;    <span class="comment">/*--- Loop over the DOFs to compute the Cartesian fluxes in the DOFs. ---*/</span></div>
<div class="line"><a name="l04963"></a><span class="lineno"> 4963</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l04964"></a><span class="lineno"> 4964</span>&#160; </div>
<div class="line"><a name="l04965"></a><span class="lineno"> 4965</span>&#160;      <span class="comment">/* Set the pointers to the locations where the solution and the Cartesian</span></div>
<div class="line"><a name="l04966"></a><span class="lineno"> 4966</span>&#160;<span class="comment">         fluxes are stored for this DOF. */</span></div>
<div class="line"><a name="l04967"></a><span class="lineno"> 4967</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDOF = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l04968"></a><span class="lineno"> 4968</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF     = sol      + offDOF;</div>
<div class="line"><a name="l04969"></a><span class="lineno"> 4969</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxX            = fluxXDOF + offDOF;</div>
<div class="line"><a name="l04970"></a><span class="lineno"> 4970</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxY            = fluxYDOF + offDOF;</div>
<div class="line"><a name="l04971"></a><span class="lineno"> 4971</span>&#160; </div>
<div class="line"><a name="l04972"></a><span class="lineno"> 4972</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities at the location of the</span></div>
<div class="line"><a name="l04973"></a><span class="lineno"> 4973</span>&#160;<span class="comment">         solution DOFS. THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL</span></div>
<div class="line"><a name="l04974"></a><span class="lineno"> 4974</span>&#160;<span class="comment">         MOTION IS SPECIFIED, THE DATA FOR THIS DOF FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l04975"></a><span class="lineno"> 4975</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l04976"></a><span class="lineno"> 4976</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data() + 2*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l04977"></a><span class="lineno"> 4977</span>&#160; </div>
<div class="line"><a name="l04978"></a><span class="lineno"> 4978</span>&#160;      <span class="comment">/* Compute the velocities and pressure in this DOF. */</span></div>
<div class="line"><a name="l04979"></a><span class="lineno"> 4979</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l04980"></a><span class="lineno"> 4980</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l04981"></a><span class="lineno"> 4981</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l04982"></a><span class="lineno"> 4982</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = DensityInv*solDOF[3] - 0.5*(u*u + v*v);</div>
<div class="line"><a name="l04983"></a><span class="lineno"> 4983</span>&#160; </div>
<div class="line"><a name="l04984"></a><span class="lineno"> 4984</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l04985"></a><span class="lineno"> 4985</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l04986"></a><span class="lineno"> 4986</span>&#160; </div>
<div class="line"><a name="l04987"></a><span class="lineno"> 4987</span>&#160;      <span class="comment">/* The Cartesian fluxes in the x-direction. */</span></div>
<div class="line"><a name="l04988"></a><span class="lineno"> 4988</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> uRel = u - gridVel[0];</div>
<div class="line"><a name="l04989"></a><span class="lineno"> 4989</span>&#160;      fluxX[0] = solDOF[0]*uRel;</div>
<div class="line"><a name="l04990"></a><span class="lineno"> 4990</span>&#160;      fluxX[1] = solDOF[1]*uRel + Pressure;</div>
<div class="line"><a name="l04991"></a><span class="lineno"> 4991</span>&#160;      fluxX[2] = solDOF[2]*uRel;</div>
<div class="line"><a name="l04992"></a><span class="lineno"> 4992</span>&#160;      fluxX[3] = solDOF[3]*uRel + Pressure*u;</div>
<div class="line"><a name="l04993"></a><span class="lineno"> 4993</span>&#160; </div>
<div class="line"><a name="l04994"></a><span class="lineno"> 4994</span>&#160;      <span class="comment">/* The Cartesian fluxes in the y-direction. */</span></div>
<div class="line"><a name="l04995"></a><span class="lineno"> 4995</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vRel = v - gridVel[1];</div>
<div class="line"><a name="l04996"></a><span class="lineno"> 4996</span>&#160;      fluxY[0] = solDOF[0]*vRel;</div>
<div class="line"><a name="l04997"></a><span class="lineno"> 4997</span>&#160;      fluxY[1] = solDOF[1]*vRel;</div>
<div class="line"><a name="l04998"></a><span class="lineno"> 4998</span>&#160;      fluxY[2] = solDOF[2]*vRel + Pressure;</div>
<div class="line"><a name="l04999"></a><span class="lineno"> 4999</span>&#160;      fluxY[3] = solDOF[3]*vRel + Pressure*v;</div>
<div class="line"><a name="l05000"></a><span class="lineno"> 5000</span>&#160;    }</div>
<div class="line"><a name="l05001"></a><span class="lineno"> 5001</span>&#160;  }</div>
<div class="line"><a name="l05002"></a><span class="lineno"> 5002</span>&#160; </div>
<div class="line"><a name="l05003"></a><span class="lineno"> 5003</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05004"></a><span class="lineno"> 5004</span>&#160;  <span class="comment">/*--- Compute the derivatives of the Cartesian fluxes w.r.t. the         ---*/</span></div>
<div class="line"><a name="l05005"></a><span class="lineno"> 5005</span>&#160;  <span class="comment">/*--- parametric coordinates in the integration points.                  ---*/</span></div>
<div class="line"><a name="l05006"></a><span class="lineno"> 5006</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05007"></a><span class="lineno"> 5007</span>&#160; </div>
<div class="line"><a name="l05008"></a><span class="lineno"> 5008</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxXDOF, gradFluxXInt, config);</div>
<div class="line"><a name="l05009"></a><span class="lineno"> 5009</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxYDOF, gradFluxYInt, config);</div>
<div class="line"><a name="l05010"></a><span class="lineno"> 5010</span>&#160; </div>
<div class="line"><a name="l05011"></a><span class="lineno"> 5011</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05012"></a><span class="lineno"> 5012</span>&#160;  <span class="comment">/*--- Compute the divergence of the fluxes in the integration points,    ---*/</span></div>
<div class="line"><a name="l05013"></a><span class="lineno"> 5013</span>&#160;  <span class="comment">/*--- multiplied by the integration weight.                              ---*/</span></div>
<div class="line"><a name="l05014"></a><span class="lineno"> 5014</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05015"></a><span class="lineno"> 5015</span>&#160; </div>
<div class="line"><a name="l05016"></a><span class="lineno"> 5016</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l05017"></a><span class="lineno"> 5017</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l05018"></a><span class="lineno"> 5018</span>&#160; </div>
<div class="line"><a name="l05019"></a><span class="lineno"> 5019</span>&#160;    <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l05020"></a><span class="lineno"> 5020</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05021"></a><span class="lineno"> 5021</span>&#160; </div>
<div class="line"><a name="l05022"></a><span class="lineno"> 5022</span>&#160;      <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l05023"></a><span class="lineno"> 5023</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt  = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05024"></a><span class="lineno"> 5024</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXDr = gradFluxXInt + offInt;</div>
<div class="line"><a name="l05025"></a><span class="lineno"> 5025</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXDs = gradFluxXDr  + offDeriv;</div>
<div class="line"><a name="l05026"></a><span class="lineno"> 5026</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYDr = gradFluxYInt + offInt;</div>
<div class="line"><a name="l05027"></a><span class="lineno"> 5027</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYDs = gradFluxYDr  + offDeriv;</div>
<div class="line"><a name="l05028"></a><span class="lineno"> 5028</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *divFluxInt  = divFlux      + offInt;</div>
<div class="line"><a name="l05029"></a><span class="lineno"> 5029</span>&#160; </div>
<div class="line"><a name="l05030"></a><span class="lineno"> 5030</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l05031"></a><span class="lineno"> 5031</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l05032"></a><span class="lineno"> 5032</span>&#160;<span class="comment">         THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l05033"></a><span class="lineno"> 5033</span>&#160;<span class="comment">         BE TAKEN. */</span></div>
<div class="line"><a name="l05034"></a><span class="lineno"> 5034</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l05035"></a><span class="lineno"> 5035</span>&#160; </div>
<div class="line"><a name="l05036"></a><span class="lineno"> 5036</span>&#160;      <span class="comment">/* Compute the metric terms multiplied by the integration weight. Note that the</span></div>
<div class="line"><a name="l05037"></a><span class="lineno"> 5037</span>&#160;<span class="comment">         first term in the metric terms is the Jacobian. */</span></div>
<div class="line"><a name="l05038"></a><span class="lineno"> 5038</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdx = weights[i]*metricTerms[1];</div>
<div class="line"><a name="l05039"></a><span class="lineno"> 5039</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdy = weights[i]*metricTerms[2];</div>
<div class="line"><a name="l05040"></a><span class="lineno"> 5040</span>&#160; </div>
<div class="line"><a name="l05041"></a><span class="lineno"> 5041</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdx = weights[i]*metricTerms[3];</div>
<div class="line"><a name="l05042"></a><span class="lineno"> 5042</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdy = weights[i]*metricTerms[4];</div>
<div class="line"><a name="l05043"></a><span class="lineno"> 5043</span>&#160; </div>
<div class="line"><a name="l05044"></a><span class="lineno"> 5044</span>&#160;      <span class="comment">/* Compute the divergence of the fluxes, multiplied by the</span></div>
<div class="line"><a name="l05045"></a><span class="lineno"> 5045</span>&#160;<span class="comment">         integration weight. */</span></div>
<div class="line"><a name="l05046"></a><span class="lineno"> 5046</span>&#160;      divFluxInt[0] = gradFluxXDr[0]*wDrdx + gradFluxXDs[0]*wDsdx</div>
<div class="line"><a name="l05047"></a><span class="lineno"> 5047</span>&#160;                    + gradFluxYDr[0]*wDrdy + gradFluxYDs[0]*wDsdy;</div>
<div class="line"><a name="l05048"></a><span class="lineno"> 5048</span>&#160;      divFluxInt[1] = gradFluxXDr[1]*wDrdx + gradFluxXDs[1]*wDsdx</div>
<div class="line"><a name="l05049"></a><span class="lineno"> 5049</span>&#160;                    + gradFluxYDr[1]*wDrdy + gradFluxYDs[1]*wDsdy;</div>
<div class="line"><a name="l05050"></a><span class="lineno"> 5050</span>&#160;      divFluxInt[2] = gradFluxXDr[2]*wDrdx + gradFluxXDs[2]*wDsdx</div>
<div class="line"><a name="l05051"></a><span class="lineno"> 5051</span>&#160;                    + gradFluxYDr[2]*wDrdy + gradFluxYDs[2]*wDsdy;</div>
<div class="line"><a name="l05052"></a><span class="lineno"> 5052</span>&#160;      divFluxInt[3] = gradFluxXDr[3]*wDrdx + gradFluxXDs[3]*wDsdx</div>
<div class="line"><a name="l05053"></a><span class="lineno"> 5053</span>&#160;                    + gradFluxYDr[3]*wDrdy + gradFluxYDs[3]*wDsdy;</div>
<div class="line"><a name="l05054"></a><span class="lineno"> 5054</span>&#160;    }</div>
<div class="line"><a name="l05055"></a><span class="lineno"> 5055</span>&#160;  }</div>
<div class="line"><a name="l05056"></a><span class="lineno"> 5056</span>&#160; </div>
<div class="line"><a name="l05057"></a><span class="lineno"> 5057</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05058"></a><span class="lineno"> 5058</span>&#160;  <span class="comment">/*--- Add the body force to the divergence of the fluxes, if such a      ---*/</span></div>
<div class="line"><a name="l05059"></a><span class="lineno"> 5059</span>&#160;  <span class="comment">/*--- force is present.                                                  ---*/</span></div>
<div class="line"><a name="l05060"></a><span class="lineno"> 5060</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05061"></a><span class="lineno"> 5061</span>&#160; </div>
<div class="line"><a name="l05062"></a><span class="lineno"> 5062</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="class_c_config.html#a9af4200d2cd764653d2707da4acc7847">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l05063"></a><span class="lineno"> 5063</span>&#160; </div>
<div class="line"><a name="l05064"></a><span class="lineno"> 5064</span>&#160;    <span class="comment">/* Easier storage of the body force. */</span></div>
<div class="line"><a name="l05065"></a><span class="lineno"> 5065</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *body_force_vector = config-&gt;<a class="code" href="class_c_config.html#aa6f6ce87c87183da706c9e5521c1b812">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l05066"></a><span class="lineno"> 5066</span>&#160; </div>
<div class="line"><a name="l05067"></a><span class="lineno"> 5067</span>&#160;    <span class="comment">/* Compute the solution in the integration points of the element.</span></div>
<div class="line"><a name="l05068"></a><span class="lineno"> 5068</span>&#160;<span class="comment">       Use gradFluxYInt to store this solution. */</span></div>
<div class="line"><a name="l05069"></a><span class="lineno"> 5069</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solInt = gradFluxYInt;</div>
<div class="line"><a name="l05070"></a><span class="lineno"> 5070</span>&#160; </div>
<div class="line"><a name="l05071"></a><span class="lineno"> 5071</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt, NPad, nDOFs, matBasisInt, sol, solInt, config);</div>
<div class="line"><a name="l05072"></a><span class="lineno"> 5072</span>&#160; </div>
<div class="line"><a name="l05073"></a><span class="lineno"> 5073</span>&#160;    <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l05074"></a><span class="lineno"> 5074</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l05075"></a><span class="lineno"> 5075</span>&#160; </div>
<div class="line"><a name="l05076"></a><span class="lineno"> 5076</span>&#160;      <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l05077"></a><span class="lineno"> 5077</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05078"></a><span class="lineno"> 5078</span>&#160; </div>
<div class="line"><a name="l05079"></a><span class="lineno"> 5079</span>&#160;        <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l05080"></a><span class="lineno"> 5080</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt  = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05081"></a><span class="lineno"> 5081</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solThisInt = solInt  + offInt;</div>
<div class="line"><a name="l05082"></a><span class="lineno"> 5082</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *divFluxInt = divFlux + offInt;</div>
<div class="line"><a name="l05083"></a><span class="lineno"> 5083</span>&#160; </div>
<div class="line"><a name="l05084"></a><span class="lineno"> 5084</span>&#160;        <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l05085"></a><span class="lineno"> 5085</span>&#160;<span class="comment">           THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l05086"></a><span class="lineno"> 5086</span>&#160;<span class="comment">           THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l05087"></a><span class="lineno"> 5087</span>&#160;<span class="comment">           BE TAKEN. */</span></div>
<div class="line"><a name="l05088"></a><span class="lineno"> 5088</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l05089"></a><span class="lineno"> 5089</span>&#160; </div>
<div class="line"><a name="l05090"></a><span class="lineno"> 5090</span>&#160;        <span class="comment">/* Compute the velocities. */</span></div>
<div class="line"><a name="l05091"></a><span class="lineno"> 5091</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv = 1.0/solThisInt[0];</div>
<div class="line"><a name="l05092"></a><span class="lineno"> 5092</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u      = solThisInt[1]*rhoInv;</div>
<div class="line"><a name="l05093"></a><span class="lineno"> 5093</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v      = solThisInt[2]*rhoInv;</div>
<div class="line"><a name="l05094"></a><span class="lineno"> 5094</span>&#160; </div>
<div class="line"><a name="l05095"></a><span class="lineno"> 5095</span>&#160;        <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l05096"></a><span class="lineno"> 5096</span>&#160;<span class="comment">           equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l05097"></a><span class="lineno"> 5097</span>&#160;<span class="comment">           integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l05098"></a><span class="lineno"> 5098</span>&#160;<span class="comment">           the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l05099"></a><span class="lineno"> 5099</span>&#160;<span class="comment">           velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l05100"></a><span class="lineno"> 5100</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l05101"></a><span class="lineno"> 5101</span>&#160; </div>
<div class="line"><a name="l05102"></a><span class="lineno"> 5102</span>&#160;        divFluxInt[1] -= weightJac*body_force_vector[0];</div>
<div class="line"><a name="l05103"></a><span class="lineno"> 5103</span>&#160;        divFluxInt[2] -= weightJac*body_force_vector[1];</div>
<div class="line"><a name="l05104"></a><span class="lineno"> 5104</span>&#160;        divFluxInt[3] -= weightJac*(u*body_force_vector[0] + v*body_force_vector[1]);</div>
<div class="line"><a name="l05105"></a><span class="lineno"> 5105</span>&#160;      }</div>
<div class="line"><a name="l05106"></a><span class="lineno"> 5106</span>&#160;    }</div>
<div class="line"><a name="l05107"></a><span class="lineno"> 5107</span>&#160;  }</div>
<div class="line"><a name="l05108"></a><span class="lineno"> 5108</span>&#160; </div>
<div class="line"><a name="l05109"></a><span class="lineno"> 5109</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05110"></a><span class="lineno"> 5110</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l05111"></a><span class="lineno"> 5111</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l05112"></a><span class="lineno"> 5112</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05113"></a><span class="lineno"> 5113</span>&#160; </div>
<div class="line"><a name="l05114"></a><span class="lineno"> 5114</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l05115"></a><span class="lineno"> 5115</span>&#160;}</div>
<div class="line"><a name="l05116"></a><span class="lineno"> 5116</span>&#160; </div>
<div class="line"><a name="l05117"></a><span class="lineno"> 5117</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::ADER_DG_AliasedPredictorResidual_3D(<a class="code" href="class_c_config.html">CConfig</a>              *config,</div>
<div class="line"><a name="l05118"></a><span class="lineno"> 5118</span>&#160;                                                              <a class="code" href="class_c_volume_element_f_e_m.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l05119"></a><span class="lineno"> 5119</span>&#160;                                                              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *sol,</div>
<div class="line"><a name="l05120"></a><span class="lineno"> 5120</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l05121"></a><span class="lineno"> 5121</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l05122"></a><span class="lineno"> 5122</span>&#160;                                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *res,</div>
<div class="line"><a name="l05123"></a><span class="lineno"> 5123</span>&#160;                                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *work) {</div>
<div class="line"><a name="l05124"></a><span class="lineno"> 5124</span>&#160; </div>
<div class="line"><a name="l05125"></a><span class="lineno"> 5125</span>&#160;  <span class="comment">/* Get the necessary information from the standard element. */</span></div>
<div class="line"><a name="l05126"></a><span class="lineno"> 5126</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l05127"></a><span class="lineno"> 5127</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05128"></a><span class="lineno"> 5128</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l05129"></a><span class="lineno"> 5129</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisInt            = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a6fbf928e9b9fa2fd9dab46309e0ed6b6">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l05130"></a><span class="lineno"> 5130</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matDerBasisInt         = matBasisInt + nDOFs*nInt;</div>
<div class="line"><a name="l05131"></a><span class="lineno"> 5131</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFunctionsIntTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0d8111ae54b825086ea24a9241a361f1">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l05132"></a><span class="lineno"> 5132</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights                = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l05133"></a><span class="lineno"> 5133</span>&#160; </div>
<div class="line"><a name="l05134"></a><span class="lineno"> 5134</span>&#160;  <span class="comment">/* Set the pointers for fluxes in the DOFs, the gradient of the fluxes in</span></div>
<div class="line"><a name="l05135"></a><span class="lineno"> 5135</span>&#160;<span class="comment">     the integration points and the divergence of the fluxes in the integration</span></div>
<div class="line"><a name="l05136"></a><span class="lineno"> 5136</span>&#160;<span class="comment">     points. Note that the same array can be used for the first and last array,</span></div>
<div class="line"><a name="l05137"></a><span class="lineno"> 5137</span>&#160;<span class="comment">     because divFlux is only needed after the fluxes in the DOFs. */</span></div>
<div class="line"><a name="l05138"></a><span class="lineno"> 5138</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxXDOF     = work;</div>
<div class="line"><a name="l05139"></a><span class="lineno"> 5139</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxYDOF     = fluxXDOF + NPad*nDOFs;</div>
<div class="line"><a name="l05140"></a><span class="lineno"> 5140</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxZDOF     = fluxYDOF + NPad*nDOFs;</div>
<div class="line"><a name="l05141"></a><span class="lineno"> 5141</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXInt = fluxZDOF + NPad*nDOFs;</div>
<div class="line"><a name="l05142"></a><span class="lineno"> 5142</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYInt = gradFluxXInt + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad*nInt;</div>
<div class="line"><a name="l05143"></a><span class="lineno"> 5143</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxZInt = gradFluxYInt + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad*nInt;</div>
<div class="line"><a name="l05144"></a><span class="lineno"> 5144</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFlux      = work;</div>
<div class="line"><a name="l05145"></a><span class="lineno"> 5145</span>&#160; </div>
<div class="line"><a name="l05146"></a><span class="lineno"> 5146</span>&#160;  <span class="comment">/* Determine the offset between the r-derivatives and s-derivatives, which is</span></div>
<div class="line"><a name="l05147"></a><span class="lineno"> 5147</span>&#160;<span class="comment">     also the offset between s- and t-derivatives, of the fluxes. */</span></div>
<div class="line"><a name="l05148"></a><span class="lineno"> 5148</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l05149"></a><span class="lineno"> 5149</span>&#160; </div>
<div class="line"><a name="l05150"></a><span class="lineno"> 5150</span>&#160;  <span class="comment">/* Store the number of metric points per integration point for readability. */</span></div>
<div class="line"><a name="l05151"></a><span class="lineno"> 5151</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 10;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l05152"></a><span class="lineno"> 5152</span>&#160; </div>
<div class="line"><a name="l05153"></a><span class="lineno"> 5153</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05154"></a><span class="lineno"> 5154</span>&#160;  <span class="comment">/*---          Construct the Cartesian fluxes in the DOFs.               ---*/</span></div>
<div class="line"><a name="l05155"></a><span class="lineno"> 5155</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05156"></a><span class="lineno"> 5156</span>&#160; </div>
<div class="line"><a name="l05157"></a><span class="lineno"> 5157</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l05158"></a><span class="lineno"> 5158</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l05159"></a><span class="lineno"> 5159</span>&#160; </div>
<div class="line"><a name="l05160"></a><span class="lineno"> 5160</span>&#160;    <span class="comment">/*--- Loop over the DOFs to compute the Cartesian fluxes in the DOFs. ---*/</span></div>
<div class="line"><a name="l05161"></a><span class="lineno"> 5161</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l05162"></a><span class="lineno"> 5162</span>&#160; </div>
<div class="line"><a name="l05163"></a><span class="lineno"> 5163</span>&#160;      <span class="comment">/* Set the pointers to the locations where the solution and the Cartesian</span></div>
<div class="line"><a name="l05164"></a><span class="lineno"> 5164</span>&#160;<span class="comment">         fluxes are stored for this DOF. */</span></div>
<div class="line"><a name="l05165"></a><span class="lineno"> 5165</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDOF = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05166"></a><span class="lineno"> 5166</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF     = sol      + offDOF;</div>
<div class="line"><a name="l05167"></a><span class="lineno"> 5167</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxX            = fluxXDOF + offDOF;</div>
<div class="line"><a name="l05168"></a><span class="lineno"> 5168</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxY            = fluxYDOF + offDOF;</div>
<div class="line"><a name="l05169"></a><span class="lineno"> 5169</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxZ            = fluxZDOF + offDOF;</div>
<div class="line"><a name="l05170"></a><span class="lineno"> 5170</span>&#160; </div>
<div class="line"><a name="l05171"></a><span class="lineno"> 5171</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities at the location of the</span></div>
<div class="line"><a name="l05172"></a><span class="lineno"> 5172</span>&#160;<span class="comment">         solution DOFS. THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL</span></div>
<div class="line"><a name="l05173"></a><span class="lineno"> 5173</span>&#160;<span class="comment">         MOTION IS SPECIFIED, THE DATA FOR THIS DOF FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l05174"></a><span class="lineno"> 5174</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l05175"></a><span class="lineno"> 5175</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data() + 3*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l05176"></a><span class="lineno"> 5176</span>&#160; </div>
<div class="line"><a name="l05177"></a><span class="lineno"> 5177</span>&#160;      <span class="comment">/* Compute the velocities and pressure in this DOF. */</span></div>
<div class="line"><a name="l05178"></a><span class="lineno"> 5178</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l05179"></a><span class="lineno"> 5179</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l05180"></a><span class="lineno"> 5180</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l05181"></a><span class="lineno"> 5181</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w            = DensityInv*solDOF[3];</div>
<div class="line"><a name="l05182"></a><span class="lineno"> 5182</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = DensityInv*solDOF[4] - 0.5*(u*u + v*v + w*w);</div>
<div class="line"><a name="l05183"></a><span class="lineno"> 5183</span>&#160; </div>
<div class="line"><a name="l05184"></a><span class="lineno"> 5184</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l05185"></a><span class="lineno"> 5185</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l05186"></a><span class="lineno"> 5186</span>&#160; </div>
<div class="line"><a name="l05187"></a><span class="lineno"> 5187</span>&#160;      <span class="comment">/* The Cartesian fluxes in the x-direction. */</span></div>
<div class="line"><a name="l05188"></a><span class="lineno"> 5188</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> uRel = u - gridVel[0];</div>
<div class="line"><a name="l05189"></a><span class="lineno"> 5189</span>&#160;      fluxX[0] = solDOF[0]*uRel;</div>
<div class="line"><a name="l05190"></a><span class="lineno"> 5190</span>&#160;      fluxX[1] = solDOF[1]*uRel + Pressure;</div>
<div class="line"><a name="l05191"></a><span class="lineno"> 5191</span>&#160;      fluxX[2] = solDOF[2]*uRel;</div>
<div class="line"><a name="l05192"></a><span class="lineno"> 5192</span>&#160;      fluxX[3] = solDOF[3]*uRel;</div>
<div class="line"><a name="l05193"></a><span class="lineno"> 5193</span>&#160;      fluxX[4] = solDOF[4]*uRel + Pressure*u;</div>
<div class="line"><a name="l05194"></a><span class="lineno"> 5194</span>&#160; </div>
<div class="line"><a name="l05195"></a><span class="lineno"> 5195</span>&#160;      <span class="comment">/* The Cartesian fluxes in the y-direction. */</span></div>
<div class="line"><a name="l05196"></a><span class="lineno"> 5196</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vRel = v - gridVel[1];</div>
<div class="line"><a name="l05197"></a><span class="lineno"> 5197</span>&#160;      fluxY[0] = solDOF[0]*vRel;</div>
<div class="line"><a name="l05198"></a><span class="lineno"> 5198</span>&#160;      fluxY[1] = solDOF[1]*vRel;</div>
<div class="line"><a name="l05199"></a><span class="lineno"> 5199</span>&#160;      fluxY[2] = solDOF[2]*vRel + Pressure;</div>
<div class="line"><a name="l05200"></a><span class="lineno"> 5200</span>&#160;      fluxY[3] = solDOF[3]*vRel;</div>
<div class="line"><a name="l05201"></a><span class="lineno"> 5201</span>&#160;      fluxY[4] = solDOF[4]*vRel + Pressure*v;</div>
<div class="line"><a name="l05202"></a><span class="lineno"> 5202</span>&#160; </div>
<div class="line"><a name="l05203"></a><span class="lineno"> 5203</span>&#160;      <span class="comment">/* The Cartesian fluxes in the z-direction. */</span></div>
<div class="line"><a name="l05204"></a><span class="lineno"> 5204</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wRel = w - gridVel[2];</div>
<div class="line"><a name="l05205"></a><span class="lineno"> 5205</span>&#160;      fluxZ[0] = solDOF[0]*wRel;</div>
<div class="line"><a name="l05206"></a><span class="lineno"> 5206</span>&#160;      fluxZ[1] = solDOF[1]*wRel;</div>
<div class="line"><a name="l05207"></a><span class="lineno"> 5207</span>&#160;      fluxZ[2] = solDOF[2]*wRel;</div>
<div class="line"><a name="l05208"></a><span class="lineno"> 5208</span>&#160;      fluxZ[3] = solDOF[3]*wRel + Pressure;</div>
<div class="line"><a name="l05209"></a><span class="lineno"> 5209</span>&#160;      fluxZ[4] = solDOF[4]*wRel + Pressure*w;</div>
<div class="line"><a name="l05210"></a><span class="lineno"> 5210</span>&#160;    }</div>
<div class="line"><a name="l05211"></a><span class="lineno"> 5211</span>&#160;  }</div>
<div class="line"><a name="l05212"></a><span class="lineno"> 5212</span>&#160; </div>
<div class="line"><a name="l05213"></a><span class="lineno"> 5213</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05214"></a><span class="lineno"> 5214</span>&#160;  <span class="comment">/*--- Compute the derivatives of the Cartesian fluxes w.r.t. the         ---*/</span></div>
<div class="line"><a name="l05215"></a><span class="lineno"> 5215</span>&#160;  <span class="comment">/*--- parametric coordinates in the integration points.                  ---*/</span></div>
<div class="line"><a name="l05216"></a><span class="lineno"> 5216</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05217"></a><span class="lineno"> 5217</span>&#160; </div>
<div class="line"><a name="l05218"></a><span class="lineno"> 5218</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxXDOF, gradFluxXInt, config);</div>
<div class="line"><a name="l05219"></a><span class="lineno"> 5219</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxYDOF, gradFluxYInt, config);</div>
<div class="line"><a name="l05220"></a><span class="lineno"> 5220</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxZDOF, gradFluxZInt, config);</div>
<div class="line"><a name="l05221"></a><span class="lineno"> 5221</span>&#160; </div>
<div class="line"><a name="l05222"></a><span class="lineno"> 5222</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05223"></a><span class="lineno"> 5223</span>&#160;  <span class="comment">/*--- Compute the divergence of the fluxes in the integration points,    ---*/</span></div>
<div class="line"><a name="l05224"></a><span class="lineno"> 5224</span>&#160;  <span class="comment">/*--- multiplied by the integration weight.                              ---*/</span></div>
<div class="line"><a name="l05225"></a><span class="lineno"> 5225</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05226"></a><span class="lineno"> 5226</span>&#160; </div>
<div class="line"><a name="l05227"></a><span class="lineno"> 5227</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l05228"></a><span class="lineno"> 5228</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l05229"></a><span class="lineno"> 5229</span>&#160; </div>
<div class="line"><a name="l05230"></a><span class="lineno"> 5230</span>&#160;    <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l05231"></a><span class="lineno"> 5231</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05232"></a><span class="lineno"> 5232</span>&#160; </div>
<div class="line"><a name="l05233"></a><span class="lineno"> 5233</span>&#160;      <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l05234"></a><span class="lineno"> 5234</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt  = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05235"></a><span class="lineno"> 5235</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXDr = gradFluxXInt + offInt;</div>
<div class="line"><a name="l05236"></a><span class="lineno"> 5236</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXDs = gradFluxXDr  + offDeriv;</div>
<div class="line"><a name="l05237"></a><span class="lineno"> 5237</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXDt = gradFluxXDs  + offDeriv;</div>
<div class="line"><a name="l05238"></a><span class="lineno"> 5238</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYDr = gradFluxYInt + offInt;</div>
<div class="line"><a name="l05239"></a><span class="lineno"> 5239</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYDs = gradFluxYDr  + offDeriv;</div>
<div class="line"><a name="l05240"></a><span class="lineno"> 5240</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYDt = gradFluxYDs  + offDeriv;</div>
<div class="line"><a name="l05241"></a><span class="lineno"> 5241</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxZDr = gradFluxZInt + offInt;</div>
<div class="line"><a name="l05242"></a><span class="lineno"> 5242</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxZDs = gradFluxZDr  + offDeriv;</div>
<div class="line"><a name="l05243"></a><span class="lineno"> 5243</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxZDt = gradFluxZDs  + offDeriv;</div>
<div class="line"><a name="l05244"></a><span class="lineno"> 5244</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *divFluxInt  = divFlux      + offInt;</div>
<div class="line"><a name="l05245"></a><span class="lineno"> 5245</span>&#160; </div>
<div class="line"><a name="l05246"></a><span class="lineno"> 5246</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l05247"></a><span class="lineno"> 5247</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l05248"></a><span class="lineno"> 5248</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l05249"></a><span class="lineno"> 5249</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l05250"></a><span class="lineno"> 5250</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l05251"></a><span class="lineno"> 5251</span>&#160; </div>
<div class="line"><a name="l05252"></a><span class="lineno"> 5252</span>&#160;      <span class="comment">/* Compute the metric terms multiplied by the integration weight. Note that the</span></div>
<div class="line"><a name="l05253"></a><span class="lineno"> 5253</span>&#160;<span class="comment">         first term in the metric terms is the Jacobian. */</span></div>
<div class="line"><a name="l05254"></a><span class="lineno"> 5254</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdx = weights[i]*metricTerms[1];</div>
<div class="line"><a name="l05255"></a><span class="lineno"> 5255</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdy = weights[i]*metricTerms[2];</div>
<div class="line"><a name="l05256"></a><span class="lineno"> 5256</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdz = weights[i]*metricTerms[3];</div>
<div class="line"><a name="l05257"></a><span class="lineno"> 5257</span>&#160; </div>
<div class="line"><a name="l05258"></a><span class="lineno"> 5258</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdx = weights[i]*metricTerms[4];</div>
<div class="line"><a name="l05259"></a><span class="lineno"> 5259</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdy = weights[i]*metricTerms[5];</div>
<div class="line"><a name="l05260"></a><span class="lineno"> 5260</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdz = weights[i]*metricTerms[6];</div>
<div class="line"><a name="l05261"></a><span class="lineno"> 5261</span>&#160; </div>
<div class="line"><a name="l05262"></a><span class="lineno"> 5262</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdx = weights[i]*metricTerms[7];</div>
<div class="line"><a name="l05263"></a><span class="lineno"> 5263</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdy = weights[i]*metricTerms[8];</div>
<div class="line"><a name="l05264"></a><span class="lineno"> 5264</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdz = weights[i]*metricTerms[9];</div>
<div class="line"><a name="l05265"></a><span class="lineno"> 5265</span>&#160; </div>
<div class="line"><a name="l05266"></a><span class="lineno"> 5266</span>&#160;      <span class="comment">/* Compute the divergence of the fluxes, multiplied by the integration weight. */</span></div>
<div class="line"><a name="l05267"></a><span class="lineno"> 5267</span>&#160;      divFluxInt[0] = gradFluxXDr[0]*wDrdx + gradFluxXDs[0]*wDsdx + gradFluxXDt[0]*wDtdx</div>
<div class="line"><a name="l05268"></a><span class="lineno"> 5268</span>&#160;                    + gradFluxYDr[0]*wDrdy + gradFluxYDs[0]*wDsdy + gradFluxYDt[0]*wDtdy</div>
<div class="line"><a name="l05269"></a><span class="lineno"> 5269</span>&#160;                    + gradFluxZDr[0]*wDrdz + gradFluxZDs[0]*wDsdz + gradFluxZDt[0]*wDtdz;</div>
<div class="line"><a name="l05270"></a><span class="lineno"> 5270</span>&#160;      divFluxInt[1] = gradFluxXDr[1]*wDrdx + gradFluxXDs[1]*wDsdx + gradFluxXDt[1]*wDtdx</div>
<div class="line"><a name="l05271"></a><span class="lineno"> 5271</span>&#160;                    + gradFluxYDr[1]*wDrdy + gradFluxYDs[1]*wDsdy + gradFluxYDt[1]*wDtdy</div>
<div class="line"><a name="l05272"></a><span class="lineno"> 5272</span>&#160;                    + gradFluxZDr[1]*wDrdz + gradFluxZDs[1]*wDsdz + gradFluxZDt[1]*wDtdz;</div>
<div class="line"><a name="l05273"></a><span class="lineno"> 5273</span>&#160;      divFluxInt[2] = gradFluxXDr[2]*wDrdx + gradFluxXDs[2]*wDsdx + gradFluxXDt[2]*wDtdx</div>
<div class="line"><a name="l05274"></a><span class="lineno"> 5274</span>&#160;                    + gradFluxYDr[2]*wDrdy + gradFluxYDs[2]*wDsdy + gradFluxYDt[2]*wDtdy</div>
<div class="line"><a name="l05275"></a><span class="lineno"> 5275</span>&#160;                    + gradFluxZDr[2]*wDrdz + gradFluxZDs[2]*wDsdz + gradFluxZDt[2]*wDtdz;</div>
<div class="line"><a name="l05276"></a><span class="lineno"> 5276</span>&#160;      divFluxInt[3] = gradFluxXDr[3]*wDrdx + gradFluxXDs[3]*wDsdx + gradFluxXDt[3]*wDtdx</div>
<div class="line"><a name="l05277"></a><span class="lineno"> 5277</span>&#160;                    + gradFluxYDr[3]*wDrdy + gradFluxYDs[3]*wDsdy + gradFluxYDt[3]*wDtdy</div>
<div class="line"><a name="l05278"></a><span class="lineno"> 5278</span>&#160;                    + gradFluxZDr[3]*wDrdz + gradFluxZDs[3]*wDsdz + gradFluxZDt[3]*wDtdz;</div>
<div class="line"><a name="l05279"></a><span class="lineno"> 5279</span>&#160;      divFluxInt[4] = gradFluxXDr[4]*wDrdx + gradFluxXDs[4]*wDsdx + gradFluxXDt[4]*wDtdx</div>
<div class="line"><a name="l05280"></a><span class="lineno"> 5280</span>&#160;                    + gradFluxYDr[4]*wDrdy + gradFluxYDs[4]*wDsdy + gradFluxYDt[4]*wDtdy</div>
<div class="line"><a name="l05281"></a><span class="lineno"> 5281</span>&#160;                    + gradFluxZDr[4]*wDrdz + gradFluxZDs[4]*wDsdz + gradFluxZDt[4]*wDtdz;</div>
<div class="line"><a name="l05282"></a><span class="lineno"> 5282</span>&#160;    }</div>
<div class="line"><a name="l05283"></a><span class="lineno"> 5283</span>&#160;  }</div>
<div class="line"><a name="l05284"></a><span class="lineno"> 5284</span>&#160; </div>
<div class="line"><a name="l05285"></a><span class="lineno"> 5285</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05286"></a><span class="lineno"> 5286</span>&#160;  <span class="comment">/*--- Add the body force to the divergence of the fluxes, if such a      ---*/</span></div>
<div class="line"><a name="l05287"></a><span class="lineno"> 5287</span>&#160;  <span class="comment">/*--- force is present.                                                  ---*/</span></div>
<div class="line"><a name="l05288"></a><span class="lineno"> 5288</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05289"></a><span class="lineno"> 5289</span>&#160; </div>
<div class="line"><a name="l05290"></a><span class="lineno"> 5290</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="class_c_config.html#a9af4200d2cd764653d2707da4acc7847">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l05291"></a><span class="lineno"> 5291</span>&#160; </div>
<div class="line"><a name="l05292"></a><span class="lineno"> 5292</span>&#160;    <span class="comment">/* Easier storage of the body force. */</span></div>
<div class="line"><a name="l05293"></a><span class="lineno"> 5293</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *body_force_vector = config-&gt;<a class="code" href="class_c_config.html#aa6f6ce87c87183da706c9e5521c1b812">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l05294"></a><span class="lineno"> 5294</span>&#160; </div>
<div class="line"><a name="l05295"></a><span class="lineno"> 5295</span>&#160;    <span class="comment">/* Compute the solution in the integration points of the element.</span></div>
<div class="line"><a name="l05296"></a><span class="lineno"> 5296</span>&#160;<span class="comment">       Use gradFluxYInt to store this solution. */</span></div>
<div class="line"><a name="l05297"></a><span class="lineno"> 5297</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solInt = gradFluxYInt;</div>
<div class="line"><a name="l05298"></a><span class="lineno"> 5298</span>&#160; </div>
<div class="line"><a name="l05299"></a><span class="lineno"> 5299</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt, NPad, nDOFs, matBasisInt, sol, solInt, config);</div>
<div class="line"><a name="l05300"></a><span class="lineno"> 5300</span>&#160; </div>
<div class="line"><a name="l05301"></a><span class="lineno"> 5301</span>&#160;    <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l05302"></a><span class="lineno"> 5302</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l05303"></a><span class="lineno"> 5303</span>&#160; </div>
<div class="line"><a name="l05304"></a><span class="lineno"> 5304</span>&#160;      <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l05305"></a><span class="lineno"> 5305</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05306"></a><span class="lineno"> 5306</span>&#160; </div>
<div class="line"><a name="l05307"></a><span class="lineno"> 5307</span>&#160;        <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l05308"></a><span class="lineno"> 5308</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05309"></a><span class="lineno"> 5309</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solThisInt = solInt  + offInt;</div>
<div class="line"><a name="l05310"></a><span class="lineno"> 5310</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *divFluxInt = divFlux + offInt;</div>
<div class="line"><a name="l05311"></a><span class="lineno"> 5311</span>&#160; </div>
<div class="line"><a name="l05312"></a><span class="lineno"> 5312</span>&#160;        <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l05313"></a><span class="lineno"> 5313</span>&#160;<span class="comment">           THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l05314"></a><span class="lineno"> 5314</span>&#160;<span class="comment">           THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l05315"></a><span class="lineno"> 5315</span>&#160;<span class="comment">           BE TAKEN. */</span></div>
<div class="line"><a name="l05316"></a><span class="lineno"> 5316</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l05317"></a><span class="lineno"> 5317</span>&#160; </div>
<div class="line"><a name="l05318"></a><span class="lineno"> 5318</span>&#160;        <span class="comment">/* Compute the velocities. */</span></div>
<div class="line"><a name="l05319"></a><span class="lineno"> 5319</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv = 1.0/solThisInt[0];</div>
<div class="line"><a name="l05320"></a><span class="lineno"> 5320</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u      = solThisInt[1]*rhoInv;</div>
<div class="line"><a name="l05321"></a><span class="lineno"> 5321</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v      = solThisInt[2]*rhoInv;</div>
<div class="line"><a name="l05322"></a><span class="lineno"> 5322</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w      = solThisInt[3]*rhoInv;</div>
<div class="line"><a name="l05323"></a><span class="lineno"> 5323</span>&#160; </div>
<div class="line"><a name="l05324"></a><span class="lineno"> 5324</span>&#160;        <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l05325"></a><span class="lineno"> 5325</span>&#160;<span class="comment">           equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l05326"></a><span class="lineno"> 5326</span>&#160;<span class="comment">           integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l05327"></a><span class="lineno"> 5327</span>&#160;<span class="comment">           the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l05328"></a><span class="lineno"> 5328</span>&#160;<span class="comment">           velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l05329"></a><span class="lineno"> 5329</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l05330"></a><span class="lineno"> 5330</span>&#160; </div>
<div class="line"><a name="l05331"></a><span class="lineno"> 5331</span>&#160;        divFluxInt[1] -= weightJac*body_force_vector[0];</div>
<div class="line"><a name="l05332"></a><span class="lineno"> 5332</span>&#160;        divFluxInt[2] -= weightJac*body_force_vector[1];</div>
<div class="line"><a name="l05333"></a><span class="lineno"> 5333</span>&#160;        divFluxInt[3] -= weightJac*body_force_vector[2];</div>
<div class="line"><a name="l05334"></a><span class="lineno"> 5334</span>&#160;        divFluxInt[4] -= weightJac*(u*body_force_vector[0] + v*body_force_vector[1]</div>
<div class="line"><a name="l05335"></a><span class="lineno"> 5335</span>&#160;                       +            w*body_force_vector[2]);</div>
<div class="line"><a name="l05336"></a><span class="lineno"> 5336</span>&#160;      }</div>
<div class="line"><a name="l05337"></a><span class="lineno"> 5337</span>&#160;    }</div>
<div class="line"><a name="l05338"></a><span class="lineno"> 5338</span>&#160;  }</div>
<div class="line"><a name="l05339"></a><span class="lineno"> 5339</span>&#160; </div>
<div class="line"><a name="l05340"></a><span class="lineno"> 5340</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05341"></a><span class="lineno"> 5341</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l05342"></a><span class="lineno"> 5342</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l05343"></a><span class="lineno"> 5343</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05344"></a><span class="lineno"> 5344</span>&#160; </div>
<div class="line"><a name="l05345"></a><span class="lineno"> 5345</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l05346"></a><span class="lineno"> 5346</span>&#160;}</div>
<div class="line"><a name="l05347"></a><span class="lineno"> 5347</span>&#160; </div>
<div class="line"><a name="l05348"></a><span class="lineno"> 5348</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::ADER_DG_NonAliasedPredictorResidual_2D(<a class="code" href="class_c_config.html">CConfig</a>              *config,</div>
<div class="line"><a name="l05349"></a><span class="lineno"> 5349</span>&#160;                                                                 <a class="code" href="class_c_volume_element_f_e_m.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l05350"></a><span class="lineno"> 5350</span>&#160;                                                                 <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *sol,</div>
<div class="line"><a name="l05351"></a><span class="lineno"> 5351</span>&#160;                                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l05352"></a><span class="lineno"> 5352</span>&#160;                                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l05353"></a><span class="lineno"> 5353</span>&#160;                                                                 <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *res,</div>
<div class="line"><a name="l05354"></a><span class="lineno"> 5354</span>&#160;                                                                 <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *work) {</div>
<div class="line"><a name="l05355"></a><span class="lineno"> 5355</span>&#160; </div>
<div class="line"><a name="l05356"></a><span class="lineno"> 5356</span>&#160;  <span class="comment">/* Set the pointers for solAndGradInt and divFlux to work. The same array</span></div>
<div class="line"><a name="l05357"></a><span class="lineno"> 5357</span>&#160;<span class="comment">     can be used for both help arrays. */</span></div>
<div class="line"><a name="l05358"></a><span class="lineno"> 5358</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solAndGradInt = work;</div>
<div class="line"><a name="l05359"></a><span class="lineno"> 5359</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFlux       = work;</div>
<div class="line"><a name="l05360"></a><span class="lineno"> 5360</span>&#160; </div>
<div class="line"><a name="l05361"></a><span class="lineno"> 5361</span>&#160;  <span class="comment">/* Get the necessary information from the standard element. */</span></div>
<div class="line"><a name="l05362"></a><span class="lineno"> 5362</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l05363"></a><span class="lineno"> 5363</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05364"></a><span class="lineno"> 5364</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l05365"></a><span class="lineno"> 5365</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisInt            = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a6fbf928e9b9fa2fd9dab46309e0ed6b6">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l05366"></a><span class="lineno"> 5366</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFunctionsIntTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0d8111ae54b825086ea24a9241a361f1">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l05367"></a><span class="lineno"> 5367</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights                = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l05368"></a><span class="lineno"> 5368</span>&#160; </div>
<div class="line"><a name="l05369"></a><span class="lineno"> 5369</span>&#160;  <span class="comment">/* Check if a body force is present and set it accordingly. */</span></div>
<div class="line"><a name="l05370"></a><span class="lineno"> 5370</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> bodyForceX = 0.0, bodyForceY = 0.0;</div>
<div class="line"><a name="l05371"></a><span class="lineno"> 5371</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="class_c_config.html#a9af4200d2cd764653d2707da4acc7847">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l05372"></a><span class="lineno"> 5372</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *body_force_vector = config-&gt;<a class="code" href="class_c_config.html#aa6f6ce87c87183da706c9e5521c1b812">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l05373"></a><span class="lineno"> 5373</span>&#160;    bodyForceX = body_force_vector[0];</div>
<div class="line"><a name="l05374"></a><span class="lineno"> 5374</span>&#160;    bodyForceY = body_force_vector[1];</div>
<div class="line"><a name="l05375"></a><span class="lineno"> 5375</span>&#160;  }</div>
<div class="line"><a name="l05376"></a><span class="lineno"> 5376</span>&#160; </div>
<div class="line"><a name="l05377"></a><span class="lineno"> 5377</span>&#160;  <span class="comment">/* Determine the offset between the solution variables and the r-derivatives,</span></div>
<div class="line"><a name="l05378"></a><span class="lineno"> 5378</span>&#160;<span class="comment">     which is also the offset between the r- and s-derivatives. */</span></div>
<div class="line"><a name="l05379"></a><span class="lineno"> 5379</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l05380"></a><span class="lineno"> 5380</span>&#160; </div>
<div class="line"><a name="l05381"></a><span class="lineno"> 5381</span>&#160;  <span class="comment">/* Store the number of metric points per integration point for readability. */</span></div>
<div class="line"><a name="l05382"></a><span class="lineno"> 5382</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 5;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l05383"></a><span class="lineno"> 5383</span>&#160; </div>
<div class="line"><a name="l05384"></a><span class="lineno"> 5384</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05385"></a><span class="lineno"> 5385</span>&#160;  <span class="comment">/*--- Compute the solution and the derivatives w.r.t. the parametric     ---*/</span></div>
<div class="line"><a name="l05386"></a><span class="lineno"> 5386</span>&#160;  <span class="comment">/*--- coordinates in the integration points. The first argument in       ---*/</span></div>
<div class="line"><a name="l05387"></a><span class="lineno"> 5387</span>&#160;  <span class="comment">/*--- the call to blasFunctions-&gt;gemm is nInt*(nDim+1).                  ---*/</span></div>
<div class="line"><a name="l05388"></a><span class="lineno"> 5388</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05389"></a><span class="lineno"> 5389</span>&#160; </div>
<div class="line"><a name="l05390"></a><span class="lineno"> 5390</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*3, NPad, nDOFs, matBasisInt, sol, solAndGradInt, config);</div>
<div class="line"><a name="l05391"></a><span class="lineno"> 5391</span>&#160; </div>
<div class="line"><a name="l05392"></a><span class="lineno"> 5392</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05393"></a><span class="lineno"> 5393</span>&#160;  <span class="comment">/*--- Compute the divergence of the inviscid fluxes, multiplied by the   ---*/</span></div>
<div class="line"><a name="l05394"></a><span class="lineno"> 5394</span>&#160;  <span class="comment">/*--- integration weight in the integration points of the element.       ---*/</span></div>
<div class="line"><a name="l05395"></a><span class="lineno"> 5395</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05396"></a><span class="lineno"> 5396</span>&#160; </div>
<div class="line"><a name="l05397"></a><span class="lineno"> 5397</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l05398"></a><span class="lineno"> 5398</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l05399"></a><span class="lineno"> 5399</span>&#160; </div>
<div class="line"><a name="l05400"></a><span class="lineno"> 5400</span>&#160;    <span class="comment">/*--- Loop over the integration points. ---*/</span></div>
<div class="line"><a name="l05401"></a><span class="lineno"> 5401</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05402"></a><span class="lineno"> 5402</span>&#160; </div>
<div class="line"><a name="l05403"></a><span class="lineno"> 5403</span>&#160;      <span class="comment">/* Easier storage of the location where the solution, gradient data and</span></div>
<div class="line"><a name="l05404"></a><span class="lineno"> 5404</span>&#160;<span class="comment">         the divergence of this integration point starts. */</span></div>
<div class="line"><a name="l05405"></a><span class="lineno"> 5405</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt = NPad*i + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05406"></a><span class="lineno"> 5406</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol   = solAndGradInt + offInt;</div>
<div class="line"><a name="l05407"></a><span class="lineno"> 5407</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDr = sol     + offDeriv;</div>
<div class="line"><a name="l05408"></a><span class="lineno"> 5408</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDs = solDr   + offDeriv;</div>
<div class="line"><a name="l05409"></a><span class="lineno"> 5409</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFluxInt  = divFlux + offInt;</div>
<div class="line"><a name="l05410"></a><span class="lineno"> 5410</span>&#160; </div>
<div class="line"><a name="l05411"></a><span class="lineno"> 5411</span>&#160;      <span class="comment">/*--- Compute the velocities, pressure and total enthalpy</span></div>
<div class="line"><a name="l05412"></a><span class="lineno"> 5412</span>&#160;<span class="comment">            in this integration point. ---*/</span></div>
<div class="line"><a name="l05413"></a><span class="lineno"> 5413</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rho = sol[0];</div>
<div class="line"><a name="l05414"></a><span class="lineno"> 5414</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ru  = sol[1];</div>
<div class="line"><a name="l05415"></a><span class="lineno"> 5415</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rv  = sol[2];</div>
<div class="line"><a name="l05416"></a><span class="lineno"> 5416</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rE  = sol[3];</div>
<div class="line"><a name="l05417"></a><span class="lineno"> 5417</span>&#160; </div>
<div class="line"><a name="l05418"></a><span class="lineno"> 5418</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv       = 1.0/rho;</div>
<div class="line"><a name="l05419"></a><span class="lineno"> 5419</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = rhoInv*ru;</div>
<div class="line"><a name="l05420"></a><span class="lineno"> 5420</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = rhoInv*rv;</div>
<div class="line"><a name="l05421"></a><span class="lineno"> 5421</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kinEnergy    = 0.5*(u*u + v*v);</div>
<div class="line"><a name="l05422"></a><span class="lineno"> 5422</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = rhoInv*rE - kinEnergy;</div>
<div class="line"><a name="l05423"></a><span class="lineno"> 5423</span>&#160; </div>
<div class="line"><a name="l05424"></a><span class="lineno"> 5424</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(rho, StaticEnergy);</div>
<div class="line"><a name="l05425"></a><span class="lineno"> 5425</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l05426"></a><span class="lineno"> 5426</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Htot     = rhoInv*(rE + Pressure);</div>
<div class="line"><a name="l05427"></a><span class="lineno"> 5427</span>&#160; </div>
<div class="line"><a name="l05428"></a><span class="lineno"> 5428</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities in this integration point.</span></div>
<div class="line"><a name="l05429"></a><span class="lineno"> 5429</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l05430"></a><span class="lineno"> 5430</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l05431"></a><span class="lineno"> 5431</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l05432"></a><span class="lineno"> 5432</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + 2*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l05433"></a><span class="lineno"> 5433</span>&#160; </div>
<div class="line"><a name="l05434"></a><span class="lineno"> 5434</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l05435"></a><span class="lineno"> 5435</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l05436"></a><span class="lineno"> 5436</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l05437"></a><span class="lineno"> 5437</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l05438"></a><span class="lineno"> 5438</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l05439"></a><span class="lineno"> 5439</span>&#160; </div>
<div class="line"><a name="l05440"></a><span class="lineno"> 5440</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = metricTerms[1];</div>
<div class="line"><a name="l05441"></a><span class="lineno"> 5441</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = metricTerms[2];</div>
<div class="line"><a name="l05442"></a><span class="lineno"> 5442</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = metricTerms[3];</div>
<div class="line"><a name="l05443"></a><span class="lineno"> 5443</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = metricTerms[4];</div>
<div class="line"><a name="l05444"></a><span class="lineno"> 5444</span>&#160; </div>
<div class="line"><a name="l05445"></a><span class="lineno"> 5445</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l05446"></a><span class="lineno"> 5446</span>&#160;<span class="comment">         variables from the gradients in parametric coordinates and the</span></div>
<div class="line"><a name="l05447"></a><span class="lineno"> 5447</span>&#160;<span class="comment">         metric terms in this integration point. Note that these gradients</span></div>
<div class="line"><a name="l05448"></a><span class="lineno"> 5448</span>&#160;<span class="comment">         must be scaled with the Jacobian. This scaling is already present</span></div>
<div class="line"><a name="l05449"></a><span class="lineno"> 5449</span>&#160;<span class="comment">         in the metric terms. */</span></div>
<div class="line"><a name="l05450"></a><span class="lineno"> 5450</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodx = solDr[0]*drdx + solDs[0]*dsdx;</div>
<div class="line"><a name="l05451"></a><span class="lineno"> 5451</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudx  = solDr[1]*drdx + solDs[1]*dsdx;</div>
<div class="line"><a name="l05452"></a><span class="lineno"> 5452</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdx  = solDr[2]*drdx + solDs[2]*dsdx;</div>
<div class="line"><a name="l05453"></a><span class="lineno"> 5453</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdx  = solDr[3]*drdx + solDs[3]*dsdx;</div>
<div class="line"><a name="l05454"></a><span class="lineno"> 5454</span>&#160; </div>
<div class="line"><a name="l05455"></a><span class="lineno"> 5455</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhody = solDr[0]*drdy + solDs[0]*dsdy;</div>
<div class="line"><a name="l05456"></a><span class="lineno"> 5456</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudy  = solDr[1]*drdy + solDs[1]*dsdy;</div>
<div class="line"><a name="l05457"></a><span class="lineno"> 5457</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdy  = solDr[2]*drdy + solDs[2]*dsdy;</div>
<div class="line"><a name="l05458"></a><span class="lineno"> 5458</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdy  = solDr[3]*drdy + solDs[3]*dsdy;</div>
<div class="line"><a name="l05459"></a><span class="lineno"> 5459</span>&#160; </div>
<div class="line"><a name="l05460"></a><span class="lineno"> 5460</span>&#160;      <span class="comment">/*--- Compute the divergence of the grid velocity.</span></div>
<div class="line"><a name="l05461"></a><span class="lineno"> 5461</span>&#160;<span class="comment">            SET TO ZERO FOR NOW. THIS IS NOT CORRECT!!!!. ---*/</span></div>
<div class="line"><a name="l05462"></a><span class="lineno"> 5462</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> divGridVel = 0.0;  <span class="comment">// Must be multiplied by the Jacobian.</span></div>
<div class="line"><a name="l05463"></a><span class="lineno"> 5463</span>&#160; </div>
<div class="line"><a name="l05464"></a><span class="lineno"> 5464</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the pressure, scaled with</span></div>
<div class="line"><a name="l05465"></a><span class="lineno"> 5465</span>&#160;<span class="comment">         the Jacobian. */</span></div>
<div class="line"><a name="l05466"></a><span class="lineno"> 5466</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dpdx = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdx + kinEnergy*drhodx</div>
<div class="line"><a name="l05467"></a><span class="lineno"> 5467</span>&#160;                           -                  u*drudx - v*drvdx);</div>
<div class="line"><a name="l05468"></a><span class="lineno"> 5468</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dpdy = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdy + kinEnergy*drhody</div>
<div class="line"><a name="l05469"></a><span class="lineno"> 5469</span>&#160;                           -                  u*drudy - v*drvdy);</div>
<div class="line"><a name="l05470"></a><span class="lineno"> 5470</span>&#160; </div>
<div class="line"><a name="l05471"></a><span class="lineno"> 5471</span>&#160;      <span class="comment">/* Abbreviations, which make it easier to compute the divergence term. */</span></div>
<div class="line"><a name="l05472"></a><span class="lineno"> 5472</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv1 =    drudx  +   drvdy;</div>
<div class="line"><a name="l05473"></a><span class="lineno"> 5473</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2 = u* drhodx + v*drhody;</div>
<div class="line"><a name="l05474"></a><span class="lineno"> 5474</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv3 = u*(drEdx  + dpdx) + v*(drEdy + dpdy);</div>
<div class="line"><a name="l05475"></a><span class="lineno"> 5475</span>&#160; </div>
<div class="line"><a name="l05476"></a><span class="lineno"> 5476</span>&#160;      <span class="comment">/* Compute the divergence terms for this integration point,</span></div>
<div class="line"><a name="l05477"></a><span class="lineno"> 5477</span>&#160;<span class="comment">         multiplied by the integration weight. */</span></div>
<div class="line"><a name="l05478"></a><span class="lineno"> 5478</span>&#160;      divFluxInt[0] = weights[i]*(abv1 - rho*divGridVel</div>
<div class="line"><a name="l05479"></a><span class="lineno"> 5479</span>&#160;                    -             gridVel[0]*drhodx - gridVel[1]*drhody);</div>
<div class="line"><a name="l05480"></a><span class="lineno"> 5480</span>&#160;      divFluxInt[1] = weights[i]*(dpdx + u*(abv1 - abv2 + drudx) + v*drudy</div>
<div class="line"><a name="l05481"></a><span class="lineno"> 5481</span>&#160;                    -             ru*divGridVel - gridVel[0]*drudx - gridVel[1]*drudy);</div>
<div class="line"><a name="l05482"></a><span class="lineno"> 5482</span>&#160;      divFluxInt[2] = weights[i]*(dpdy + v*(abv1 - abv2 + drvdy) + u*drvdx</div>
<div class="line"><a name="l05483"></a><span class="lineno"> 5483</span>&#160;                    -             rv*divGridVel - gridVel[0]*drvdx - gridVel[1]*drvdy);</div>
<div class="line"><a name="l05484"></a><span class="lineno"> 5484</span>&#160;      divFluxInt[3] = weights[i]*(abv3 + Htot*(abv1 - abv2) - rE*divGridVel</div>
<div class="line"><a name="l05485"></a><span class="lineno"> 5485</span>&#160;                    -             gridVel[0]*drEdx - gridVel[1]*drEdy);</div>
<div class="line"><a name="l05486"></a><span class="lineno"> 5486</span>&#160; </div>
<div class="line"><a name="l05487"></a><span class="lineno"> 5487</span>&#160;      <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l05488"></a><span class="lineno"> 5488</span>&#160;<span class="comment">         equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l05489"></a><span class="lineno"> 5489</span>&#160;<span class="comment">         integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l05490"></a><span class="lineno"> 5490</span>&#160;<span class="comment">         the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l05491"></a><span class="lineno"> 5491</span>&#160;<span class="comment">         velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l05492"></a><span class="lineno"> 5492</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l05493"></a><span class="lineno"> 5493</span>&#160; </div>
<div class="line"><a name="l05494"></a><span class="lineno"> 5494</span>&#160;      divFluxInt[1] -= weightJac*bodyForceX;</div>
<div class="line"><a name="l05495"></a><span class="lineno"> 5495</span>&#160;      divFluxInt[2] -= weightJac*bodyForceY;</div>
<div class="line"><a name="l05496"></a><span class="lineno"> 5496</span>&#160;      divFluxInt[3] -= weightJac*(u*bodyForceX + v*bodyForceY);</div>
<div class="line"><a name="l05497"></a><span class="lineno"> 5497</span>&#160;    }</div>
<div class="line"><a name="l05498"></a><span class="lineno"> 5498</span>&#160;  }</div>
<div class="line"><a name="l05499"></a><span class="lineno"> 5499</span>&#160; </div>
<div class="line"><a name="l05500"></a><span class="lineno"> 5500</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05501"></a><span class="lineno"> 5501</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l05502"></a><span class="lineno"> 5502</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l05503"></a><span class="lineno"> 5503</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05504"></a><span class="lineno"> 5504</span>&#160; </div>
<div class="line"><a name="l05505"></a><span class="lineno"> 5505</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l05506"></a><span class="lineno"> 5506</span>&#160;}</div>
<div class="line"><a name="l05507"></a><span class="lineno"> 5507</span>&#160; </div>
<div class="line"><a name="l05508"></a><span class="lineno"> 5508</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::ADER_DG_NonAliasedPredictorResidual_3D(<a class="code" href="class_c_config.html">CConfig</a>              *config,</div>
<div class="line"><a name="l05509"></a><span class="lineno"> 5509</span>&#160;                                                                 <a class="code" href="class_c_volume_element_f_e_m.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l05510"></a><span class="lineno"> 5510</span>&#160;                                                                 <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *sol,</div>
<div class="line"><a name="l05511"></a><span class="lineno"> 5511</span>&#160;                                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l05512"></a><span class="lineno"> 5512</span>&#160;                                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l05513"></a><span class="lineno"> 5513</span>&#160;                                                                 <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *res,</div>
<div class="line"><a name="l05514"></a><span class="lineno"> 5514</span>&#160;                                                                 <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *work) {</div>
<div class="line"><a name="l05515"></a><span class="lineno"> 5515</span>&#160; </div>
<div class="line"><a name="l05516"></a><span class="lineno"> 5516</span>&#160;  <span class="comment">/* Set the pointers for solAndGradInt and divFlux to work. The same array</span></div>
<div class="line"><a name="l05517"></a><span class="lineno"> 5517</span>&#160;<span class="comment">     can be used for both help arrays. */</span></div>
<div class="line"><a name="l05518"></a><span class="lineno"> 5518</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solAndGradInt = work;</div>
<div class="line"><a name="l05519"></a><span class="lineno"> 5519</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFlux       = work;</div>
<div class="line"><a name="l05520"></a><span class="lineno"> 5520</span>&#160; </div>
<div class="line"><a name="l05521"></a><span class="lineno"> 5521</span>&#160;  <span class="comment">/*--- Get the necessary information from the standard element. ---*/</span></div>
<div class="line"><a name="l05522"></a><span class="lineno"> 5522</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l05523"></a><span class="lineno"> 5523</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05524"></a><span class="lineno"> 5524</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l05525"></a><span class="lineno"> 5525</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisInt            = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a6fbf928e9b9fa2fd9dab46309e0ed6b6">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l05526"></a><span class="lineno"> 5526</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFunctionsIntTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0d8111ae54b825086ea24a9241a361f1">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l05527"></a><span class="lineno"> 5527</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights                = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l05528"></a><span class="lineno"> 5528</span>&#160; </div>
<div class="line"><a name="l05529"></a><span class="lineno"> 5529</span>&#160;  <span class="comment">/* Check if a body force is present and set it accordingly. */</span></div>
<div class="line"><a name="l05530"></a><span class="lineno"> 5530</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> bodyForceX = 0.0, bodyForceY = 0.0, bodyForceZ = 0.0;</div>
<div class="line"><a name="l05531"></a><span class="lineno"> 5531</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="class_c_config.html#a9af4200d2cd764653d2707da4acc7847">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l05532"></a><span class="lineno"> 5532</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *body_force_vector = config-&gt;<a class="code" href="class_c_config.html#aa6f6ce87c87183da706c9e5521c1b812">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l05533"></a><span class="lineno"> 5533</span>&#160;    bodyForceX = body_force_vector[0];</div>
<div class="line"><a name="l05534"></a><span class="lineno"> 5534</span>&#160;    bodyForceY = body_force_vector[1];</div>
<div class="line"><a name="l05535"></a><span class="lineno"> 5535</span>&#160;    bodyForceZ = body_force_vector[2];</div>
<div class="line"><a name="l05536"></a><span class="lineno"> 5536</span>&#160;  }</div>
<div class="line"><a name="l05537"></a><span class="lineno"> 5537</span>&#160; </div>
<div class="line"><a name="l05538"></a><span class="lineno"> 5538</span>&#160;  <span class="comment">/* Determine the offset between the solution variables and the r-derivatives,</span></div>
<div class="line"><a name="l05539"></a><span class="lineno"> 5539</span>&#160;<span class="comment">     which is also the offset between the r- and s-derivatives and the offset</span></div>
<div class="line"><a name="l05540"></a><span class="lineno"> 5540</span>&#160;<span class="comment">     between s- and t-derivatives. */</span></div>
<div class="line"><a name="l05541"></a><span class="lineno"> 5541</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l05542"></a><span class="lineno"> 5542</span>&#160; </div>
<div class="line"><a name="l05543"></a><span class="lineno"> 5543</span>&#160;  <span class="comment">/* Store the number of metric points per integration point for readability. */</span></div>
<div class="line"><a name="l05544"></a><span class="lineno"> 5544</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 10;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l05545"></a><span class="lineno"> 5545</span>&#160; </div>
<div class="line"><a name="l05546"></a><span class="lineno"> 5546</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05547"></a><span class="lineno"> 5547</span>&#160;  <span class="comment">/*--- Compute the solution and the derivatives w.r.t. the parametric     ---*/</span></div>
<div class="line"><a name="l05548"></a><span class="lineno"> 5548</span>&#160;  <span class="comment">/*--- coordinates in the integration points. The first argument in       ---*/</span></div>
<div class="line"><a name="l05549"></a><span class="lineno"> 5549</span>&#160;  <span class="comment">/*--- the call to blasFunctions-&gt;gemm is nInt*(nDim+1).                  ---*/</span></div>
<div class="line"><a name="l05550"></a><span class="lineno"> 5550</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05551"></a><span class="lineno"> 5551</span>&#160; </div>
<div class="line"><a name="l05552"></a><span class="lineno"> 5552</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*4, NPad, nDOFs, matBasisInt, sol, solAndGradInt, config);</div>
<div class="line"><a name="l05553"></a><span class="lineno"> 5553</span>&#160; </div>
<div class="line"><a name="l05554"></a><span class="lineno"> 5554</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l05555"></a><span class="lineno"> 5555</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l05556"></a><span class="lineno"> 5556</span>&#160; </div>
<div class="line"><a name="l05557"></a><span class="lineno"> 5557</span>&#160;    <span class="comment">/* Set the pointers to the location where the solution and the divergence</span></div>
<div class="line"><a name="l05558"></a><span class="lineno"> 5558</span>&#160;<span class="comment">       of the 1st DOF of this entity is stored, such that this offset does not</span></div>
<div class="line"><a name="l05559"></a><span class="lineno"> 5559</span>&#160;<span class="comment">       need to be taken into account anymore in the loop over the integration</span></div>
<div class="line"><a name="l05560"></a><span class="lineno"> 5560</span>&#160;<span class="comment">       points below. */</span></div>
<div class="line"><a name="l05561"></a><span class="lineno"> 5561</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solAndGradEntity = solAndGradInt + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05562"></a><span class="lineno"> 5562</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *divFluxEntity    = divFlux       + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05563"></a><span class="lineno"> 5563</span>&#160; </div>
<div class="line"><a name="l05564"></a><span class="lineno"> 5564</span>&#160;    <span class="comment">/*--- Loop over the integration points. ---*/</span></div>
<div class="line"><a name="l05565"></a><span class="lineno"> 5565</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05566"></a><span class="lineno"> 5566</span>&#160; </div>
<div class="line"><a name="l05567"></a><span class="lineno"> 5567</span>&#160;      <span class="comment">/* Easier storage of the location where the solution and gradient data</span></div>
<div class="line"><a name="l05568"></a><span class="lineno"> 5568</span>&#160;<span class="comment">         of this integration point starts. */</span></div>
<div class="line"><a name="l05569"></a><span class="lineno"> 5569</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol   = solAndGradEntity + NPad*i;</div>
<div class="line"><a name="l05570"></a><span class="lineno"> 5570</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDr = sol   + offDeriv;</div>
<div class="line"><a name="l05571"></a><span class="lineno"> 5571</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDs = solDr + offDeriv;</div>
<div class="line"><a name="l05572"></a><span class="lineno"> 5572</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDt = solDs + offDeriv;</div>
<div class="line"><a name="l05573"></a><span class="lineno"> 5573</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFluxInt  = divFluxEntity + NPad*i;</div>
<div class="line"><a name="l05574"></a><span class="lineno"> 5574</span>&#160; </div>
<div class="line"><a name="l05575"></a><span class="lineno"> 5575</span>&#160;        <span class="comment">/*--- Compute the velocities, pressure and total enthalpy</span></div>
<div class="line"><a name="l05576"></a><span class="lineno"> 5576</span>&#160;<span class="comment">            in this integration point. ---*/</span></div>
<div class="line"><a name="l05577"></a><span class="lineno"> 5577</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rho = sol[0];</div>
<div class="line"><a name="l05578"></a><span class="lineno"> 5578</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ru  = sol[1];</div>
<div class="line"><a name="l05579"></a><span class="lineno"> 5579</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rv  = sol[2];</div>
<div class="line"><a name="l05580"></a><span class="lineno"> 5580</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rw  = sol[3];</div>
<div class="line"><a name="l05581"></a><span class="lineno"> 5581</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rE  = sol[4];</div>
<div class="line"><a name="l05582"></a><span class="lineno"> 5582</span>&#160; </div>
<div class="line"><a name="l05583"></a><span class="lineno"> 5583</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv       = 1.0/rho;</div>
<div class="line"><a name="l05584"></a><span class="lineno"> 5584</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = rhoInv*ru;</div>
<div class="line"><a name="l05585"></a><span class="lineno"> 5585</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = rhoInv*rv;</div>
<div class="line"><a name="l05586"></a><span class="lineno"> 5586</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w            = rhoInv*rw;</div>
<div class="line"><a name="l05587"></a><span class="lineno"> 5587</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kinEnergy    = 0.5*(u*u + v*v + w*w);</div>
<div class="line"><a name="l05588"></a><span class="lineno"> 5588</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = rhoInv*rE - kinEnergy;</div>
<div class="line"><a name="l05589"></a><span class="lineno"> 5589</span>&#160; </div>
<div class="line"><a name="l05590"></a><span class="lineno"> 5590</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(rho, StaticEnergy);</div>
<div class="line"><a name="l05591"></a><span class="lineno"> 5591</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l05592"></a><span class="lineno"> 5592</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Htot     = rhoInv*(rE + Pressure);</div>
<div class="line"><a name="l05593"></a><span class="lineno"> 5593</span>&#160; </div>
<div class="line"><a name="l05594"></a><span class="lineno"> 5594</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities in this integration point.</span></div>
<div class="line"><a name="l05595"></a><span class="lineno"> 5595</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l05596"></a><span class="lineno"> 5596</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l05597"></a><span class="lineno"> 5597</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l05598"></a><span class="lineno"> 5598</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + 3*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l05599"></a><span class="lineno"> 5599</span>&#160; </div>
<div class="line"><a name="l05600"></a><span class="lineno"> 5600</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l05601"></a><span class="lineno"> 5601</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l05602"></a><span class="lineno"> 5602</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l05603"></a><span class="lineno"> 5603</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l05604"></a><span class="lineno"> 5604</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l05605"></a><span class="lineno"> 5605</span>&#160; </div>
<div class="line"><a name="l05606"></a><span class="lineno"> 5606</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = metricTerms[1];</div>
<div class="line"><a name="l05607"></a><span class="lineno"> 5607</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = metricTerms[2];</div>
<div class="line"><a name="l05608"></a><span class="lineno"> 5608</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdz = metricTerms[3];</div>
<div class="line"><a name="l05609"></a><span class="lineno"> 5609</span>&#160; </div>
<div class="line"><a name="l05610"></a><span class="lineno"> 5610</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = metricTerms[4];</div>
<div class="line"><a name="l05611"></a><span class="lineno"> 5611</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = metricTerms[5];</div>
<div class="line"><a name="l05612"></a><span class="lineno"> 5612</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdz = metricTerms[6];</div>
<div class="line"><a name="l05613"></a><span class="lineno"> 5613</span>&#160; </div>
<div class="line"><a name="l05614"></a><span class="lineno"> 5614</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdx = metricTerms[7];</div>
<div class="line"><a name="l05615"></a><span class="lineno"> 5615</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdy = metricTerms[8];</div>
<div class="line"><a name="l05616"></a><span class="lineno"> 5616</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdz = metricTerms[9];</div>
<div class="line"><a name="l05617"></a><span class="lineno"> 5617</span>&#160; </div>
<div class="line"><a name="l05618"></a><span class="lineno"> 5618</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l05619"></a><span class="lineno"> 5619</span>&#160;<span class="comment">         variables from the gradients in parametric coordinates and the</span></div>
<div class="line"><a name="l05620"></a><span class="lineno"> 5620</span>&#160;<span class="comment">         metric terms in this integration point. Note that these gradients</span></div>
<div class="line"><a name="l05621"></a><span class="lineno"> 5621</span>&#160;<span class="comment">         must be scaled with the Jacobian. This scaling is already present</span></div>
<div class="line"><a name="l05622"></a><span class="lineno"> 5622</span>&#160;<span class="comment">         in the metric terms. */</span></div>
<div class="line"><a name="l05623"></a><span class="lineno"> 5623</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodx = solDr[0]*drdx + solDs[0]*dsdx + solDt[0]*dtdx;</div>
<div class="line"><a name="l05624"></a><span class="lineno"> 5624</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudx  = solDr[1]*drdx + solDs[1]*dsdx + solDt[1]*dtdx;</div>
<div class="line"><a name="l05625"></a><span class="lineno"> 5625</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdx  = solDr[2]*drdx + solDs[2]*dsdx + solDt[2]*dtdx;</div>
<div class="line"><a name="l05626"></a><span class="lineno"> 5626</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdx  = solDr[3]*drdx + solDs[3]*dsdx + solDt[3]*dtdx;</div>
<div class="line"><a name="l05627"></a><span class="lineno"> 5627</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdx  = solDr[4]*drdx + solDs[4]*dsdx + solDt[4]*dtdx;</div>
<div class="line"><a name="l05628"></a><span class="lineno"> 5628</span>&#160; </div>
<div class="line"><a name="l05629"></a><span class="lineno"> 5629</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhody = solDr[0]*drdy + solDs[0]*dsdy + solDs[0]*dtdy;</div>
<div class="line"><a name="l05630"></a><span class="lineno"> 5630</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudy  = solDr[1]*drdy + solDs[1]*dsdy + solDs[1]*dtdy;</div>
<div class="line"><a name="l05631"></a><span class="lineno"> 5631</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdy  = solDr[2]*drdy + solDs[2]*dsdy + solDs[2]*dtdy;</div>
<div class="line"><a name="l05632"></a><span class="lineno"> 5632</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdy  = solDr[3]*drdy + solDs[3]*dsdy + solDs[3]*dtdy;</div>
<div class="line"><a name="l05633"></a><span class="lineno"> 5633</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdy  = solDr[4]*drdy + solDs[4]*dsdy + solDs[4]*dtdy;</div>
<div class="line"><a name="l05634"></a><span class="lineno"> 5634</span>&#160; </div>
<div class="line"><a name="l05635"></a><span class="lineno"> 5635</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodz = solDr[0]*drdz + solDs[0]*dsdz + solDs[0]*dtdz;</div>
<div class="line"><a name="l05636"></a><span class="lineno"> 5636</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudz  = solDr[1]*drdz + solDs[1]*dsdz + solDs[1]*dtdz;</div>
<div class="line"><a name="l05637"></a><span class="lineno"> 5637</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdz  = solDr[2]*drdz + solDs[2]*dsdz + solDs[2]*dtdz;</div>
<div class="line"><a name="l05638"></a><span class="lineno"> 5638</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdz  = solDr[3]*drdz + solDs[3]*dsdz + solDs[3]*dtdz;</div>
<div class="line"><a name="l05639"></a><span class="lineno"> 5639</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdz  = solDr[4]*drdz + solDs[4]*dsdz + solDs[4]*dtdz;</div>
<div class="line"><a name="l05640"></a><span class="lineno"> 5640</span>&#160; </div>
<div class="line"><a name="l05641"></a><span class="lineno"> 5641</span>&#160;      <span class="comment">/*--- Compute the divergence of the grid velocity.</span></div>
<div class="line"><a name="l05642"></a><span class="lineno"> 5642</span>&#160;<span class="comment">            SET TO ZERO FOR NOW. THIS IS NOT CORRECT!!!!. ---*/</span></div>
<div class="line"><a name="l05643"></a><span class="lineno"> 5643</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> divGridVel = 0.0;   <span class="comment">// Must be multiplied by the Jacobian.</span></div>
<div class="line"><a name="l05644"></a><span class="lineno"> 5644</span>&#160; </div>
<div class="line"><a name="l05645"></a><span class="lineno"> 5645</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the pressure, scaled with</span></div>
<div class="line"><a name="l05646"></a><span class="lineno"> 5646</span>&#160;<span class="comment">         the Jacobian. */</span></div>
<div class="line"><a name="l05647"></a><span class="lineno"> 5647</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dpdx = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdx + kinEnergy*drhodx</div>
<div class="line"><a name="l05648"></a><span class="lineno"> 5648</span>&#160;                           -                  u*drudx - v*drvdx - w*drwdx);</div>
<div class="line"><a name="l05649"></a><span class="lineno"> 5649</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dpdy = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdy + kinEnergy*drhody</div>
<div class="line"><a name="l05650"></a><span class="lineno"> 5650</span>&#160;                           -                  u*drudy - v*drvdy - w*drwdy);</div>
<div class="line"><a name="l05651"></a><span class="lineno"> 5651</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dpdz = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdz + kinEnergy*drhodz</div>
<div class="line"><a name="l05652"></a><span class="lineno"> 5652</span>&#160;                           -                  u*drudz - v*drvdz - w*drwdz);</div>
<div class="line"><a name="l05653"></a><span class="lineno"> 5653</span>&#160; </div>
<div class="line"><a name="l05654"></a><span class="lineno"> 5654</span>&#160;      <span class="comment">/* Abbreviations, which make it easier to compute the divergence term. */</span></div>
<div class="line"><a name="l05655"></a><span class="lineno"> 5655</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv1 =    drudx  +   drvdy  +   drwdz;</div>
<div class="line"><a name="l05656"></a><span class="lineno"> 5656</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2 = u* drhodx + v*drhody + w*drhodz;</div>
<div class="line"><a name="l05657"></a><span class="lineno"> 5657</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv3 = u*(drEdx + dpdx) + v*(drEdy + dpdy) + w*(drEdz + dpdz);</div>
<div class="line"><a name="l05658"></a><span class="lineno"> 5658</span>&#160; </div>
<div class="line"><a name="l05659"></a><span class="lineno"> 5659</span>&#160;      <span class="comment">/* Compute the divergence terms for this integration point,</span></div>
<div class="line"><a name="l05660"></a><span class="lineno"> 5660</span>&#160;<span class="comment">         multiplied by the integration weight. */</span></div>
<div class="line"><a name="l05661"></a><span class="lineno"> 5661</span>&#160;      divFluxInt[0] = weights[i]*(abv1 - rho*divGridVel</div>
<div class="line"><a name="l05662"></a><span class="lineno"> 5662</span>&#160;                    -             gridVel[0]*drhodx - gridVel[1]*drhody - gridVel[2]*drhodz);</div>
<div class="line"><a name="l05663"></a><span class="lineno"> 5663</span>&#160;      divFluxInt[1] = weights[i]*(dpdx + u*(abv1 - abv2 + drudx) + v*drudy + w*drudz</div>
<div class="line"><a name="l05664"></a><span class="lineno"> 5664</span>&#160;                    -             ru*divGridVel - gridVel[0]*drudx - gridVel[1]*drudy - gridVel[2]*drudz);</div>
<div class="line"><a name="l05665"></a><span class="lineno"> 5665</span>&#160;      divFluxInt[2] = weights[i]*(dpdy + v*(abv1 - abv2 + drvdy) + u*drvdx + w*drvdz</div>
<div class="line"><a name="l05666"></a><span class="lineno"> 5666</span>&#160;                    -             rv*divGridVel - gridVel[0]*drvdx - gridVel[1]*drvdy - gridVel[2]*drvdz);</div>
<div class="line"><a name="l05667"></a><span class="lineno"> 5667</span>&#160;      divFluxInt[3] = weights[i]*(dpdz + w*(abv1 - abv2 + drwdz) + u*drwdx + v*drwdy</div>
<div class="line"><a name="l05668"></a><span class="lineno"> 5668</span>&#160;                    -             rw*divGridVel - gridVel[0]*drwdx - gridVel[1]*drwdy - gridVel[2]*drwdz);</div>
<div class="line"><a name="l05669"></a><span class="lineno"> 5669</span>&#160;      divFluxInt[4] = weights[i]*(abv3 + Htot*(abv1 - abv2) - rE*divGridVel</div>
<div class="line"><a name="l05670"></a><span class="lineno"> 5670</span>&#160;                    -             gridVel[0]*drEdx - gridVel[1]*drEdy - gridVel[2]*drEdz);</div>
<div class="line"><a name="l05671"></a><span class="lineno"> 5671</span>&#160; </div>
<div class="line"><a name="l05672"></a><span class="lineno"> 5672</span>&#160;      <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l05673"></a><span class="lineno"> 5673</span>&#160;<span class="comment">         equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l05674"></a><span class="lineno"> 5674</span>&#160;<span class="comment">         integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l05675"></a><span class="lineno"> 5675</span>&#160;<span class="comment">         the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l05676"></a><span class="lineno"> 5676</span>&#160;<span class="comment">         velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l05677"></a><span class="lineno"> 5677</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l05678"></a><span class="lineno"> 5678</span>&#160; </div>
<div class="line"><a name="l05679"></a><span class="lineno"> 5679</span>&#160;      divFluxInt[1] -= weightJac*bodyForceX;</div>
<div class="line"><a name="l05680"></a><span class="lineno"> 5680</span>&#160;      divFluxInt[2] -= weightJac*bodyForceY;</div>
<div class="line"><a name="l05681"></a><span class="lineno"> 5681</span>&#160;      divFluxInt[3] -= weightJac*bodyForceZ;</div>
<div class="line"><a name="l05682"></a><span class="lineno"> 5682</span>&#160;      divFluxInt[4] -= weightJac*(u*bodyForceX + v*bodyForceY + w*bodyForceZ);</div>
<div class="line"><a name="l05683"></a><span class="lineno"> 5683</span>&#160;    }</div>
<div class="line"><a name="l05684"></a><span class="lineno"> 5684</span>&#160;  }</div>
<div class="line"><a name="l05685"></a><span class="lineno"> 5685</span>&#160; </div>
<div class="line"><a name="l05686"></a><span class="lineno"> 5686</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05687"></a><span class="lineno"> 5687</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l05688"></a><span class="lineno"> 5688</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l05689"></a><span class="lineno"> 5689</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05690"></a><span class="lineno"> 5690</span>&#160; </div>
<div class="line"><a name="l05691"></a><span class="lineno"> 5691</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l05692"></a><span class="lineno"> 5692</span>&#160;}</div>
<div class="line"><a name="l05693"></a><span class="lineno"> 5693</span>&#160; </div>
<div class="line"><a name="l05694"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a541316bc7d1623f16e839578dc9a4aa9"> 5694</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a541316bc7d1623f16e839578dc9a4aa9">CFEM_DG_EulerSolver::ADER_DG_TimeInterpolatePredictorSol</a>(<a class="code" href="class_c_config.html">CConfig</a>             *config,</div>
<div class="line"><a name="l05695"></a><span class="lineno"> 5695</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iTime,</div>
<div class="line"><a name="l05696"></a><span class="lineno"> 5696</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elemBeg,</div>
<div class="line"><a name="l05697"></a><span class="lineno"> 5697</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elemEnd,</div>
<div class="line"><a name="l05698"></a><span class="lineno"> 5698</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  nAdjElem,</div>
<div class="line"><a name="l05699"></a><span class="lineno"> 5699</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  *adjElem,</div>
<div class="line"><a name="l05700"></a><span class="lineno"> 5700</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">bool</span>           secondPartTimeInt,</div>
<div class="line"><a name="l05701"></a><span class="lineno"> 5701</span>&#160;                                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *solTimeLevel) {</div>
<div class="line"><a name="l05702"></a><span class="lineno"> 5702</span>&#160; </div>
<div class="line"><a name="l05703"></a><span class="lineno"> 5703</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05704"></a><span class="lineno"> 5704</span>&#160;  <span class="comment">/*--- Step 1: Interpolate the solution to the given integration point    ---*/</span></div>
<div class="line"><a name="l05705"></a><span class="lineno"> 5705</span>&#160;  <span class="comment">/*---         for the element range elemBeg to elemEnd. These elements   ---*/</span></div>
<div class="line"><a name="l05706"></a><span class="lineno"> 5706</span>&#160;  <span class="comment">/*---         belong to the time level considered (not needed to know    ---*/</span></div>
<div class="line"><a name="l05707"></a><span class="lineno"> 5707</span>&#160;  <span class="comment">/*---         the actual value in this function) and are therefore       ---*/</span></div>
<div class="line"><a name="l05708"></a><span class="lineno"> 5708</span>&#160;  <span class="comment">/*---         continuous in memory.                                      ---*/</span></div>
<div class="line"><a name="l05709"></a><span class="lineno"> 5709</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05710"></a><span class="lineno"> 5710</span>&#160; </div>
<div class="line"><a name="l05711"></a><span class="lineno"> 5711</span>&#160;  <span class="comment">/* Easier storage of the interpolation coefficients for the current time</span></div>
<div class="line"><a name="l05712"></a><span class="lineno"> 5712</span>&#160;<span class="comment">     integration point (iTime) for the elements of this time interval. */</span></div>
<div class="line"><a name="l05713"></a><span class="lineno"> 5713</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeDOFs    = config-&gt;<a class="code" href="class_c_config.html#ab110ba67babf383e40ac4896bc65a599">GetnTimeDOFsADER_DG</a>();</div>
<div class="line"><a name="l05714"></a><span class="lineno"> 5714</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *DOFToThisTimeInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a12a7b04efdba0f2488dc786a1261f1b0">timeInterpolDOFToIntegrationADER_DG</a></div>
<div class="line"><a name="l05715"></a><span class="lineno"> 5715</span>&#160;                                    + iTime*nTimeDOFs;</div>
<div class="line"><a name="l05716"></a><span class="lineno"> 5716</span>&#160; </div>
<div class="line"><a name="l05717"></a><span class="lineno"> 5717</span>&#160;  <span class="comment">/* Loop over the element range of this time level. */</span></div>
<div class="line"><a name="l05718"></a><span class="lineno"> 5718</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBeg; l&lt;elemEnd; ++l) {</div>
<div class="line"><a name="l05719"></a><span class="lineno"> 5719</span>&#160; </div>
<div class="line"><a name="l05720"></a><span class="lineno"> 5720</span>&#160;    <span class="comment">/* Determine the number of solution variables for this element and</span></div>
<div class="line"><a name="l05721"></a><span class="lineno"> 5721</span>&#160;<span class="comment">       set the pointer where the solution variables for this element must be</span></div>
<div class="line"><a name="l05722"></a><span class="lineno"> 5722</span>&#160;<span class="comment">       stored in solTimeLevel. */</span></div>
<div class="line"><a name="l05723"></a><span class="lineno"> 5723</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSolVar = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l05724"></a><span class="lineno"> 5724</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>           *solDOFs = solTimeLevel + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l05725"></a><span class="lineno"> 5725</span>&#160; </div>
<div class="line"><a name="l05726"></a><span class="lineno"> 5726</span>&#160;    <span class="comment">/* Initialize the solution to zero. */</span></div>
<div class="line"><a name="l05727"></a><span class="lineno"> 5727</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nSolVar; ++i) solDOFs[i] = 0.0;</div>
<div class="line"><a name="l05728"></a><span class="lineno"> 5728</span>&#160; </div>
<div class="line"><a name="l05729"></a><span class="lineno"> 5729</span>&#160;    <span class="comment">/* Loop over the time DOFs, for which the predictor solution is present. */</span></div>
<div class="line"><a name="l05730"></a><span class="lineno"> 5730</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nTimeDOFs; ++j) {</div>
<div class="line"><a name="l05731"></a><span class="lineno"> 5731</span>&#160; </div>
<div class="line"><a name="l05732"></a><span class="lineno"> 5732</span>&#160;      <span class="comment">/* Add the contribution of this predictor solution to the interpolated solution. */</span></div>
<div class="line"><a name="l05733"></a><span class="lineno"> 5733</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solPred = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a98849e262d69140a6a2d222d1a33de00">VecSolDOFsPredictorADER</a>.data()</div>
<div class="line"><a name="l05734"></a><span class="lineno"> 5734</span>&#160;                               + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(j*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a> + <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>);</div>
<div class="line"><a name="l05735"></a><span class="lineno"> 5735</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nSolVar; ++i)</div>
<div class="line"><a name="l05736"></a><span class="lineno"> 5736</span>&#160;        solDOFs[i] += DOFToThisTimeInt[j]*solPred[i];</div>
<div class="line"><a name="l05737"></a><span class="lineno"> 5737</span>&#160;    }</div>
<div class="line"><a name="l05738"></a><span class="lineno"> 5738</span>&#160;  }</div>
<div class="line"><a name="l05739"></a><span class="lineno"> 5739</span>&#160; </div>
<div class="line"><a name="l05740"></a><span class="lineno"> 5740</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05741"></a><span class="lineno"> 5741</span>&#160;  <span class="comment">/*--- Step 2: Interpolate the solution to the given integration point    ---*/</span></div>
<div class="line"><a name="l05742"></a><span class="lineno"> 5742</span>&#160;  <span class="comment">/*---         for the elements of the next time level, which are         ---*/</span></div>
<div class="line"><a name="l05743"></a><span class="lineno"> 5743</span>&#160;  <span class="comment">/*---         adjacent to elements of the current time level. Note that  ---*/</span></div>
<div class="line"><a name="l05744"></a><span class="lineno"> 5744</span>&#160;  <span class="comment">/*---         these elements are not contiguous in memory.               ---*/</span></div>
<div class="line"><a name="l05745"></a><span class="lineno"> 5745</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05746"></a><span class="lineno"> 5746</span>&#160; </div>
<div class="line"><a name="l05747"></a><span class="lineno"> 5747</span>&#160;  <span class="comment">/* For the faces with adjacent elements of a higher time level, the time</span></div>
<div class="line"><a name="l05748"></a><span class="lineno"> 5748</span>&#160;<span class="comment">     integration takes place with twice the number of time integration points</span></div>
<div class="line"><a name="l05749"></a><span class="lineno"> 5749</span>&#160;<span class="comment">     from the perspective of the higher time level. Hence the integration points</span></div>
<div class="line"><a name="l05750"></a><span class="lineno"> 5750</span>&#160;<span class="comment">     iTime must be corrected if the state to be interpolated corresponds to the</span></div>
<div class="line"><a name="l05751"></a><span class="lineno"> 5751</span>&#160;<span class="comment">     second part of the time integration interval. Perform this correction and</span></div>
<div class="line"><a name="l05752"></a><span class="lineno"> 5752</span>&#160;<span class="comment">     determine the corresponding interpolation coefficients. */</span></div>
<div class="line"><a name="l05753"></a><span class="lineno"> 5753</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iiTime = iTime;</div>
<div class="line"><a name="l05754"></a><span class="lineno"> 5754</span>&#160;  <span class="keywordflow">if</span>( secondPartTimeInt ) iiTime += config-&gt;<a class="code" href="class_c_config.html#ae7e9d4b942d0db4b72f461c180ade3a4">GetnTimeIntegrationADER_DG</a>();</div>
<div class="line"><a name="l05755"></a><span class="lineno"> 5755</span>&#160; </div>
<div class="line"><a name="l05756"></a><span class="lineno"> 5756</span>&#160;  DOFToThisTimeInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a47bc2e588fd015b5b565e5b5263cf423">timeInterpolAdjDOFToIntegrationADER_DG</a> + iiTime*nTimeDOFs;</div>
<div class="line"><a name="l05757"></a><span class="lineno"> 5757</span>&#160; </div>
<div class="line"><a name="l05758"></a><span class="lineno"> 5758</span>&#160;  <span class="comment">/* Loop over the adjacent elements. */</span></div>
<div class="line"><a name="l05759"></a><span class="lineno"> 5759</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;nAdjElem; ++l) {</div>
<div class="line"><a name="l05760"></a><span class="lineno"> 5760</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll = adjElem[l];</div>
<div class="line"><a name="l05761"></a><span class="lineno"> 5761</span>&#160; </div>
<div class="line"><a name="l05762"></a><span class="lineno"> 5762</span>&#160;    <span class="comment">/* Determine the number of solution variables for this element and</span></div>
<div class="line"><a name="l05763"></a><span class="lineno"> 5763</span>&#160;<span class="comment">       set the pointer where the solution variables for this element must be</span></div>
<div class="line"><a name="l05764"></a><span class="lineno"> 5764</span>&#160;<span class="comment">       stored in solTimeLevel. */</span></div>
<div class="line"><a name="l05765"></a><span class="lineno"> 5765</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSolVar = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ll].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l05766"></a><span class="lineno"> 5766</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>           *solDOFs = solTimeLevel + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ll].<a class="code" href="class_c_volume_element_f_e_m.html#aca2a1ae12ad274b8c2494ffb69bd73f1">offsetDOFsSolPrevTimeLevel</a>;</div>
<div class="line"><a name="l05767"></a><span class="lineno"> 5767</span>&#160; </div>
<div class="line"><a name="l05768"></a><span class="lineno"> 5768</span>&#160;    <span class="comment">/* Initialize the solution to zero. */</span></div>
<div class="line"><a name="l05769"></a><span class="lineno"> 5769</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nSolVar; ++i) solDOFs[i] = 0.0;</div>
<div class="line"><a name="l05770"></a><span class="lineno"> 5770</span>&#160; </div>
<div class="line"><a name="l05771"></a><span class="lineno"> 5771</span>&#160;    <span class="comment">/* Loop over the time DOFs, for which the predictor solution is present. */</span></div>
<div class="line"><a name="l05772"></a><span class="lineno"> 5772</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nTimeDOFs; ++j) {</div>
<div class="line"><a name="l05773"></a><span class="lineno"> 5773</span>&#160; </div>
<div class="line"><a name="l05774"></a><span class="lineno"> 5774</span>&#160;      <span class="comment">/* Add the contribution of this predictor solution to the interpolated solution. */</span></div>
<div class="line"><a name="l05775"></a><span class="lineno"> 5775</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solPred = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a98849e262d69140a6a2d222d1a33de00">VecSolDOFsPredictorADER</a>.data()</div>
<div class="line"><a name="l05776"></a><span class="lineno"> 5776</span>&#160;                               + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(j*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">nDOFsLocTot</a> + <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ll].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>);</div>
<div class="line"><a name="l05777"></a><span class="lineno"> 5777</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nSolVar; ++i)</div>
<div class="line"><a name="l05778"></a><span class="lineno"> 5778</span>&#160;        solDOFs[i] += DOFToThisTimeInt[j]*solPred[i];</div>
<div class="line"><a name="l05779"></a><span class="lineno"> 5779</span>&#160;    }</div>
<div class="line"><a name="l05780"></a><span class="lineno"> 5780</span>&#160;  }</div>
<div class="line"><a name="l05781"></a><span class="lineno"> 5781</span>&#160;}</div>
<div class="line"><a name="l05782"></a><span class="lineno"> 5782</span>&#160; </div>
<div class="line"><a name="l05783"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a8811f2fe9d2efb93b2fcdedf228083d1"> 5783</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8811f2fe9d2efb93b2fcdedf228083d1">CFEM_DG_EulerSolver::Shock_Capturing_DG</a>(<a class="code" href="class_c_config.html">CConfig</a>             *config,</div>
<div class="line"><a name="l05784"></a><span class="lineno"> 5784</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg,</div>
<div class="line"><a name="l05785"></a><span class="lineno"> 5785</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd,</div>
<div class="line"><a name="l05786"></a><span class="lineno"> 5786</span>&#160;                                             <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>           *workArray) {</div>
<div class="line"><a name="l05787"></a><span class="lineno"> 5787</span>&#160; </div>
<div class="line"><a name="l05788"></a><span class="lineno"> 5788</span>&#160;  <span class="comment">/*--- Run shock capturing algorithm ---*/</span></div>
<div class="line"><a name="l05789"></a><span class="lineno"> 5789</span>&#160;  <span class="keywordflow">switch</span>( config-&gt;<a class="code" href="class_c_config.html#a2a41cb57187f164b7cbf220e47823116">GetKind_FEM_DG_Shock</a>() ) {</div>
<div class="line"><a name="l05790"></a><span class="lineno"> 5790</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a0e3c6990687ed4453e660b9db9181885ac157bdf0b85a40d2619cbc8bc1ae5fe2">NONE</a>:</div>
<div class="line"><a name="l05791"></a><span class="lineno"> 5791</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05792"></a><span class="lineno"> 5792</span>&#160;  }</div>
<div class="line"><a name="l05793"></a><span class="lineno"> 5793</span>&#160;}</div>
<div class="line"><a name="l05794"></a><span class="lineno"> 5794</span>&#160; </div>
<div class="line"><a name="l05795"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#ae6c2fff0649a4d8fd723ee9776778003"> 5795</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ae6c2fff0649a4d8fd723ee9776778003">CFEM_DG_EulerSolver::Volume_Residual</a>(<a class="code" href="class_c_config.html">CConfig</a>             *config,</div>
<div class="line"><a name="l05796"></a><span class="lineno"> 5796</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg,</div>
<div class="line"><a name="l05797"></a><span class="lineno"> 5797</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd,</div>
<div class="line"><a name="l05798"></a><span class="lineno"> 5798</span>&#160;                                          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>           *workArray) {</div>
<div class="line"><a name="l05799"></a><span class="lineno"> 5799</span>&#160; </div>
<div class="line"><a name="l05800"></a><span class="lineno"> 5800</span>&#160;  <span class="comment">/*--- Determine whether a body force term is present. ---*/</span></div>
<div class="line"><a name="l05801"></a><span class="lineno"> 5801</span>&#160;  <span class="keywordtype">bool</span> body_force = config-&gt;<a class="code" href="class_c_config.html#a9af4200d2cd764653d2707da4acc7847">GetBody_Force</a>();</div>
<div class="line"><a name="l05802"></a><span class="lineno"> 5802</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *body_force_vector = body_force ? config-&gt;<a class="code" href="class_c_config.html#aa6f6ce87c87183da706c9e5521c1b812">GetBody_Force_Vector</a>() : NULL;</div>
<div class="line"><a name="l05803"></a><span class="lineno"> 5803</span>&#160; </div>
<div class="line"><a name="l05804"></a><span class="lineno"> 5804</span>&#160;  <span class="comment">/* Determine the number of elements that are treated simultaneously</span></div>
<div class="line"><a name="l05805"></a><span class="lineno"> 5805</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l05806"></a><span class="lineno"> 5806</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l05807"></a><span class="lineno"> 5807</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nElemSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05808"></a><span class="lineno"> 5808</span>&#160; </div>
<div class="line"><a name="l05809"></a><span class="lineno"> 5809</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l05810"></a><span class="lineno"> 5810</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l05811"></a><span class="lineno"> 5811</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l05812"></a><span class="lineno"> 5812</span>&#160; </div>
<div class="line"><a name="l05813"></a><span class="lineno"> 5813</span>&#160;  <span class="comment">/* Set the number of bytes that must be copied in the memcpy calls. */</span></div>
<div class="line"><a name="l05814"></a><span class="lineno"> 5814</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l05815"></a><span class="lineno"> 5815</span>&#160; </div>
<div class="line"><a name="l05816"></a><span class="lineno"> 5816</span>&#160;  <span class="comment">/* Store the number of metric points per integration point, which depends</span></div>
<div class="line"><a name="l05817"></a><span class="lineno"> 5817</span>&#160;<span class="comment">     on the number of dimensions. */</span></div>
<div class="line"><a name="l05818"></a><span class="lineno"> 5818</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> + 1;</div>
<div class="line"><a name="l05819"></a><span class="lineno"> 5819</span>&#160; </div>
<div class="line"><a name="l05820"></a><span class="lineno"> 5820</span>&#160;  <span class="comment">/*--- Loop over the given element range to compute the contribution of the</span></div>
<div class="line"><a name="l05821"></a><span class="lineno"> 5821</span>&#160;<span class="comment">        volume integral in the DG FEM formulation to the residual. Multiple</span></div>
<div class="line"><a name="l05822"></a><span class="lineno"> 5822</span>&#160;<span class="comment">        elements are treated simultaneously to improve the performance</span></div>
<div class="line"><a name="l05823"></a><span class="lineno"> 5823</span>&#160;<span class="comment">        of the matrix multiplications. As a consequence, the update of the</span></div>
<div class="line"><a name="l05824"></a><span class="lineno"> 5824</span>&#160;<span class="comment">        counter l happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l05825"></a><span class="lineno"> 5825</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBeg; l&lt;elemEnd;) {</div>
<div class="line"><a name="l05826"></a><span class="lineno"> 5826</span>&#160; </div>
<div class="line"><a name="l05827"></a><span class="lineno"> 5827</span>&#160;    <span class="comment">/* Determine the end index for this chunk of elements and the padded</span></div>
<div class="line"><a name="l05828"></a><span class="lineno"> 5828</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l05829"></a><span class="lineno"> 5829</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l05830"></a><span class="lineno"> 5830</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l05831"></a><span class="lineno"> 5831</span>&#160; </div>
<div class="line"><a name="l05832"></a><span class="lineno"> 5832</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>, l, elemEnd, nElemSimul, nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l05833"></a><span class="lineno"> 5833</span>&#160; </div>
<div class="line"><a name="l05834"></a><span class="lineno"> 5834</span>&#160;    <span class="comment">/* Get the required data from the corresponding standard element. */</span></div>
<div class="line"><a name="l05835"></a><span class="lineno"> 5835</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt            = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l05836"></a><span class="lineno"> 5836</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs           = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l05837"></a><span class="lineno"> 5837</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisInt         = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a6fbf928e9b9fa2fd9dab46309e0ed6b6">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l05838"></a><span class="lineno"> 5838</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisIntTrans    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0d8111ae54b825086ea24a9241a361f1">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l05839"></a><span class="lineno"> 5839</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matDerBasisIntTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0889b7c7bd8849913fabb2b4053c4b7d">GetDerMatBasisFunctionsIntTrans</a>();</div>
<div class="line"><a name="l05840"></a><span class="lineno"> 5840</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights             = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l05841"></a><span class="lineno"> 5841</span>&#160; </div>
<div class="line"><a name="l05842"></a><span class="lineno"> 5842</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l05843"></a><span class="lineno"> 5843</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFs = workArray;</div>
<div class="line"><a name="l05844"></a><span class="lineno"> 5844</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sources = solDOFs + nDOFs*NPad;</div>
<div class="line"><a name="l05845"></a><span class="lineno"> 5845</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solInt  = sources + nInt *NPad;</div>
<div class="line"><a name="l05846"></a><span class="lineno"> 5846</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxes  = solInt  + nInt *NPad;</div>
<div class="line"><a name="l05847"></a><span class="lineno"> 5847</span>&#160; </div>
<div class="line"><a name="l05848"></a><span class="lineno"> 5848</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05849"></a><span class="lineno"> 5849</span>&#160;    <span class="comment">/*--- Step 1: Interpolate the solution to the integration points of    ---*/</span></div>
<div class="line"><a name="l05850"></a><span class="lineno"> 5850</span>&#160;    <span class="comment">/*---         the element.                                             ---*/</span></div>
<div class="line"><a name="l05851"></a><span class="lineno"> 5851</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05852"></a><span class="lineno"> 5852</span>&#160; </div>
<div class="line"><a name="l05853"></a><span class="lineno"> 5853</span>&#160;    <span class="comment">/* Copy the solution of the DOFs into solDOFs for this chunk of elements. */</span></div>
<div class="line"><a name="l05854"></a><span class="lineno"> 5854</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l05855"></a><span class="lineno"> 5855</span>&#160; </div>
<div class="line"><a name="l05856"></a><span class="lineno"> 5856</span>&#160;      <span class="comment">/* Easier storage of the solution variables for this element. */</span></div>
<div class="line"><a name="l05857"></a><span class="lineno"> 5857</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lInd = l + ll;</div>
<div class="line"><a name="l05858"></a><span class="lineno"> 5858</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l05859"></a><span class="lineno"> 5859</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFsElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l05860"></a><span class="lineno"> 5860</span>&#160;                                   + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l05861"></a><span class="lineno"> 5861</span>&#160; </div>
<div class="line"><a name="l05862"></a><span class="lineno"> 5862</span>&#160;      <span class="comment">/* Loop over the DOFs and copy the data. */</span></div>
<div class="line"><a name="l05863"></a><span class="lineno"> 5863</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05864"></a><span class="lineno"> 5864</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i)</div>
<div class="line"><a name="l05865"></a><span class="lineno"> 5865</span>&#160;        memcpy(solDOFs+i*NPad+llNVar, solDOFsElem+i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, nBytes);</div>
<div class="line"><a name="l05866"></a><span class="lineno"> 5866</span>&#160;    }</div>
<div class="line"><a name="l05867"></a><span class="lineno"> 5867</span>&#160; </div>
<div class="line"><a name="l05868"></a><span class="lineno"> 5868</span>&#160;    <span class="comment">/* Call the general function to carry out the matrix product to determine</span></div>
<div class="line"><a name="l05869"></a><span class="lineno"> 5869</span>&#160;<span class="comment">       the solution in the integration points of the chunk of elements. */</span></div>
<div class="line"><a name="l05870"></a><span class="lineno"> 5870</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt, NPad, nDOFs, matBasisInt, solDOFs, solInt, config);</div>
<div class="line"><a name="l05871"></a><span class="lineno"> 5871</span>&#160; </div>
<div class="line"><a name="l05872"></a><span class="lineno"> 5872</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05873"></a><span class="lineno"> 5873</span>&#160;    <span class="comment">/*--- Step 2: Compute the inviscid fluxes, multiplied by minus the     ---*/</span></div>
<div class="line"><a name="l05874"></a><span class="lineno"> 5874</span>&#160;    <span class="comment">/*---         integration weight, in the integration points.           ---*/</span></div>
<div class="line"><a name="l05875"></a><span class="lineno"> 5875</span>&#160;    <span class="comment">/*---         If needed, also the source terms are computed.           ---*/</span></div>
<div class="line"><a name="l05876"></a><span class="lineno"> 5876</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05877"></a><span class="lineno"> 5877</span>&#160; </div>
<div class="line"><a name="l05878"></a><span class="lineno"> 5878</span>&#160;    <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l05879"></a><span class="lineno"> 5879</span>&#160;<span class="comment">       in order to have the most efficient code. */</span></div>
<div class="line"><a name="l05880"></a><span class="lineno"> 5880</span>&#160;    <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l05881"></a><span class="lineno"> 5881</span>&#160; </div>
<div class="line"><a name="l05882"></a><span class="lineno"> 5882</span>&#160;      <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l05883"></a><span class="lineno"> 5883</span>&#160; </div>
<div class="line"><a name="l05884"></a><span class="lineno"> 5884</span>&#160;        <span class="comment">/* 2D simulation. Loop over the chunk of elements and loop over the</span></div>
<div class="line"><a name="l05885"></a><span class="lineno"> 5885</span>&#160;<span class="comment">           integration points of the elements to compute the fluxes. */</span></div>
<div class="line"><a name="l05886"></a><span class="lineno"> 5886</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l05887"></a><span class="lineno"> 5887</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05888"></a><span class="lineno"> 5888</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l05889"></a><span class="lineno"> 5889</span>&#160; </div>
<div class="line"><a name="l05890"></a><span class="lineno"> 5890</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05891"></a><span class="lineno"> 5891</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iNPad = i*NPad;</div>
<div class="line"><a name="l05892"></a><span class="lineno"> 5892</span>&#160; </div>
<div class="line"><a name="l05893"></a><span class="lineno"> 5893</span>&#160;            <span class="comment">/* Easier storage of the metric terms and grid velocities</span></div>
<div class="line"><a name="l05894"></a><span class="lineno"> 5894</span>&#160;<span class="comment">               in this integration point. */</span></div>
<div class="line"><a name="l05895"></a><span class="lineno"> 5895</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data()</div>
<div class="line"><a name="l05896"></a><span class="lineno"> 5896</span>&#160;                                         + i*nMetricPerPoint;</div>
<div class="line"><a name="l05897"></a><span class="lineno"> 5897</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Jac          = metricTerms[0];</div>
<div class="line"><a name="l05898"></a><span class="lineno"> 5898</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l05899"></a><span class="lineno"> 5899</span>&#160; </div>
<div class="line"><a name="l05900"></a><span class="lineno"> 5900</span>&#160;            <span class="comment">/* Compute the metric terms multiplied by minus the integration weight.</span></div>
<div class="line"><a name="l05901"></a><span class="lineno"> 5901</span>&#160;<span class="comment">               The minus sign comes from the integration by parts in the weak</span></div>
<div class="line"><a name="l05902"></a><span class="lineno"> 5902</span>&#160;<span class="comment">               formulation. */</span></div>
<div class="line"><a name="l05903"></a><span class="lineno"> 5903</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdx = -weights[i]*metricTerms[1];</div>
<div class="line"><a name="l05904"></a><span class="lineno"> 5904</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdy = -weights[i]*metricTerms[2];</div>
<div class="line"><a name="l05905"></a><span class="lineno"> 5905</span>&#160; </div>
<div class="line"><a name="l05906"></a><span class="lineno"> 5906</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdx = -weights[i]*metricTerms[3];</div>
<div class="line"><a name="l05907"></a><span class="lineno"> 5907</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdy = -weights[i]*metricTerms[4];</div>
<div class="line"><a name="l05908"></a><span class="lineno"> 5908</span>&#160; </div>
<div class="line"><a name="l05909"></a><span class="lineno"> 5909</span>&#160;            <span class="comment">/* Easier storage of the location where the solution data of this</span></div>
<div class="line"><a name="l05910"></a><span class="lineno"> 5910</span>&#160;<span class="comment">               integration point starts. */</span></div>
<div class="line"><a name="l05911"></a><span class="lineno"> 5911</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol = solInt + iNPad + llNVar;</div>
<div class="line"><a name="l05912"></a><span class="lineno"> 5912</span>&#160; </div>
<div class="line"><a name="l05913"></a><span class="lineno"> 5913</span>&#160;            <span class="comment">/*--- Compute the velocities and static energy in this integration point. ---*/</span></div>
<div class="line"><a name="l05914"></a><span class="lineno"> 5914</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv       = 1.0/sol[0];</div>
<div class="line"><a name="l05915"></a><span class="lineno"> 5915</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = sol[1]*rhoInv;</div>
<div class="line"><a name="l05916"></a><span class="lineno"> 5916</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = sol[2]*rhoInv;</div>
<div class="line"><a name="l05917"></a><span class="lineno"> 5917</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = sol[3]*rhoInv;</div>
<div class="line"><a name="l05918"></a><span class="lineno"> 5918</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - 0.5*(u*u + v*v);</div>
<div class="line"><a name="l05919"></a><span class="lineno"> 5919</span>&#160; </div>
<div class="line"><a name="l05920"></a><span class="lineno"> 5920</span>&#160;            <span class="comment">/*--- Compute the pressure. ---*/</span></div>
<div class="line"><a name="l05921"></a><span class="lineno"> 5921</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l05922"></a><span class="lineno"> 5922</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l05923"></a><span class="lineno"> 5923</span>&#160; </div>
<div class="line"><a name="l05924"></a><span class="lineno"> 5924</span>&#160;            <span class="comment">/* Compute the relative velocities w.r.t. the grid. */</span></div>
<div class="line"><a name="l05925"></a><span class="lineno"> 5925</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> uRel = u - gridVel[0];</div>
<div class="line"><a name="l05926"></a><span class="lineno"> 5926</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vRel = v - gridVel[1];</div>
<div class="line"><a name="l05927"></a><span class="lineno"> 5927</span>&#160; </div>
<div class="line"><a name="l05928"></a><span class="lineno"> 5928</span>&#160;            <span class="comment">/* Set the pointer for the fluxes in this integration point. */</span></div>
<div class="line"><a name="l05929"></a><span class="lineno"> 5929</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux = fluxes + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*iNPad + llNVar;</div>
<div class="line"><a name="l05930"></a><span class="lineno"> 5930</span>&#160; </div>
<div class="line"><a name="l05931"></a><span class="lineno"> 5931</span>&#160;            <span class="comment">/*--- Fluxes in r-direction. */</span></div>
<div class="line"><a name="l05932"></a><span class="lineno"> 5932</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Ur = uRel*wDrdx + vRel*wDrdy;</div>
<div class="line"><a name="l05933"></a><span class="lineno"> 5933</span>&#160; </div>
<div class="line"><a name="l05934"></a><span class="lineno"> 5934</span>&#160;            flux[0] = sol[0]*Ur;</div>
<div class="line"><a name="l05935"></a><span class="lineno"> 5935</span>&#160;            flux[1] = sol[1]*Ur + Pressure*wDrdx;</div>
<div class="line"><a name="l05936"></a><span class="lineno"> 5936</span>&#160;            flux[2] = sol[2]*Ur + Pressure*wDrdy;</div>
<div class="line"><a name="l05937"></a><span class="lineno"> 5937</span>&#160;            flux[3] = sol[3]*Ur + Pressure*(u*wDrdx + v*wDrdy);</div>
<div class="line"><a name="l05938"></a><span class="lineno"> 5938</span>&#160; </div>
<div class="line"><a name="l05939"></a><span class="lineno"> 5939</span>&#160;            <span class="comment">/*--- Fluxes in s-direction. */</span></div>
<div class="line"><a name="l05940"></a><span class="lineno"> 5940</span>&#160;            flux = flux + NPad;</div>
<div class="line"><a name="l05941"></a><span class="lineno"> 5941</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Us = uRel*wDsdx + vRel*wDsdy;</div>
<div class="line"><a name="l05942"></a><span class="lineno"> 5942</span>&#160; </div>
<div class="line"><a name="l05943"></a><span class="lineno"> 5943</span>&#160;            flux[0] = sol[0]*Us;</div>
<div class="line"><a name="l05944"></a><span class="lineno"> 5944</span>&#160;            flux[1] = sol[1]*Us + Pressure*wDsdx;</div>
<div class="line"><a name="l05945"></a><span class="lineno"> 5945</span>&#160;            flux[2] = sol[2]*Us + Pressure*wDsdy;</div>
<div class="line"><a name="l05946"></a><span class="lineno"> 5946</span>&#160;            flux[3] = sol[3]*Us + Pressure*(u*wDsdx + v*wDsdy);</div>
<div class="line"><a name="l05947"></a><span class="lineno"> 5947</span>&#160; </div>
<div class="line"><a name="l05948"></a><span class="lineno"> 5948</span>&#160;            <span class="comment">/*--- If needed, compute the body forces in this integration point.</span></div>
<div class="line"><a name="l05949"></a><span class="lineno"> 5949</span>&#160;<span class="comment">                  Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l05950"></a><span class="lineno"> 5950</span>&#160;<span class="comment">                  integration weight in order to be consistent with the</span></div>
<div class="line"><a name="l05951"></a><span class="lineno"> 5951</span>&#160;<span class="comment">                  formulation of the residual. Note that for the energy source</span></div>
<div class="line"><a name="l05952"></a><span class="lineno"> 5952</span>&#160;<span class="comment">                  term the absolute velocity must be taken and not the</span></div>
<div class="line"><a name="l05953"></a><span class="lineno"> 5953</span>&#160;<span class="comment">                  relative. ---*/</span></div>
<div class="line"><a name="l05954"></a><span class="lineno"> 5954</span>&#160;            <span class="keywordflow">if</span>( body_force ) {</div>
<div class="line"><a name="l05955"></a><span class="lineno"> 5955</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *source         = sources + iNPad + llNVar;</div>
<div class="line"><a name="l05956"></a><span class="lineno"> 5956</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*Jac;</div>
<div class="line"><a name="l05957"></a><span class="lineno"> 5957</span>&#160; </div>
<div class="line"><a name="l05958"></a><span class="lineno"> 5958</span>&#160;              source[0] =  0.0;</div>
<div class="line"><a name="l05959"></a><span class="lineno"> 5959</span>&#160;              source[1] = -weightJac*body_force_vector[0];</div>
<div class="line"><a name="l05960"></a><span class="lineno"> 5960</span>&#160;              source[2] = -weightJac*body_force_vector[1];</div>
<div class="line"><a name="l05961"></a><span class="lineno"> 5961</span>&#160;              source[3] = -weightJac*(u*body_force_vector[0] + v*body_force_vector[1]);</div>
<div class="line"><a name="l05962"></a><span class="lineno"> 5962</span>&#160;            }</div>
<div class="line"><a name="l05963"></a><span class="lineno"> 5963</span>&#160;          }</div>
<div class="line"><a name="l05964"></a><span class="lineno"> 5964</span>&#160;        }</div>
<div class="line"><a name="l05965"></a><span class="lineno"> 5965</span>&#160; </div>
<div class="line"><a name="l05966"></a><span class="lineno"> 5966</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l05967"></a><span class="lineno"> 5967</span>&#160;      }</div>
<div class="line"><a name="l05968"></a><span class="lineno"> 5968</span>&#160; </div>
<div class="line"><a name="l05969"></a><span class="lineno"> 5969</span>&#160;      <span class="comment">/*----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l05970"></a><span class="lineno"> 5970</span>&#160; </div>
<div class="line"><a name="l05971"></a><span class="lineno"> 5971</span>&#160;      <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l05972"></a><span class="lineno"> 5972</span>&#160; </div>
<div class="line"><a name="l05973"></a><span class="lineno"> 5973</span>&#160;        <span class="comment">/* 3D simulation. Loop over the chunk of elements and loop over the</span></div>
<div class="line"><a name="l05974"></a><span class="lineno"> 5974</span>&#160;<span class="comment">           integration points of the elements to compute the fluxes. */</span></div>
<div class="line"><a name="l05975"></a><span class="lineno"> 5975</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l05976"></a><span class="lineno"> 5976</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l05977"></a><span class="lineno"> 5977</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l05978"></a><span class="lineno"> 5978</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l05979"></a><span class="lineno"> 5979</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iNPad = i*NPad;</div>
<div class="line"><a name="l05980"></a><span class="lineno"> 5980</span>&#160; </div>
<div class="line"><a name="l05981"></a><span class="lineno"> 5981</span>&#160;            <span class="comment">/* Easier storage of the metric terms and grid velocities</span></div>
<div class="line"><a name="l05982"></a><span class="lineno"> 5982</span>&#160;<span class="comment">               in this integration point. */</span></div>
<div class="line"><a name="l05983"></a><span class="lineno"> 5983</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data()</div>
<div class="line"><a name="l05984"></a><span class="lineno"> 5984</span>&#160;                                         + i*nMetricPerPoint;</div>
<div class="line"><a name="l05985"></a><span class="lineno"> 5985</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Jac          = metricTerms[0];</div>
<div class="line"><a name="l05986"></a><span class="lineno"> 5986</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l05987"></a><span class="lineno"> 5987</span>&#160; </div>
<div class="line"><a name="l05988"></a><span class="lineno"> 5988</span>&#160;            <span class="comment">/* Compute the metric terms multiplied by minus the integration weight.</span></div>
<div class="line"><a name="l05989"></a><span class="lineno"> 5989</span>&#160;<span class="comment">               The minus sign comes from the integration by parts in the weak</span></div>
<div class="line"><a name="l05990"></a><span class="lineno"> 5990</span>&#160;<span class="comment">               formulation. */</span></div>
<div class="line"><a name="l05991"></a><span class="lineno"> 5991</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdx = -weights[i]*metricTerms[1];</div>
<div class="line"><a name="l05992"></a><span class="lineno"> 5992</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdy = -weights[i]*metricTerms[2];</div>
<div class="line"><a name="l05993"></a><span class="lineno"> 5993</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdz = -weights[i]*metricTerms[3];</div>
<div class="line"><a name="l05994"></a><span class="lineno"> 5994</span>&#160; </div>
<div class="line"><a name="l05995"></a><span class="lineno"> 5995</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdx = -weights[i]*metricTerms[4];</div>
<div class="line"><a name="l05996"></a><span class="lineno"> 5996</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdy = -weights[i]*metricTerms[5];</div>
<div class="line"><a name="l05997"></a><span class="lineno"> 5997</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdz = -weights[i]*metricTerms[6];</div>
<div class="line"><a name="l05998"></a><span class="lineno"> 5998</span>&#160; </div>
<div class="line"><a name="l05999"></a><span class="lineno"> 5999</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdx = -weights[i]*metricTerms[7];</div>
<div class="line"><a name="l06000"></a><span class="lineno"> 6000</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdy = -weights[i]*metricTerms[8];</div>
<div class="line"><a name="l06001"></a><span class="lineno"> 6001</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdz = -weights[i]*metricTerms[9];</div>
<div class="line"><a name="l06002"></a><span class="lineno"> 6002</span>&#160; </div>
<div class="line"><a name="l06003"></a><span class="lineno"> 6003</span>&#160;            <span class="comment">/* Easier storage of the location where the solution data of this</span></div>
<div class="line"><a name="l06004"></a><span class="lineno"> 6004</span>&#160;<span class="comment">               integration point starts. */</span></div>
<div class="line"><a name="l06005"></a><span class="lineno"> 6005</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol = solInt + iNPad + llNVar;</div>
<div class="line"><a name="l06006"></a><span class="lineno"> 6006</span>&#160; </div>
<div class="line"><a name="l06007"></a><span class="lineno"> 6007</span>&#160;            <span class="comment">/*--- Compute the velocities and static energy in this integration point. ---*/</span></div>
<div class="line"><a name="l06008"></a><span class="lineno"> 6008</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv       = 1.0/sol[0];</div>
<div class="line"><a name="l06009"></a><span class="lineno"> 6009</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = sol[1]*rhoInv;</div>
<div class="line"><a name="l06010"></a><span class="lineno"> 6010</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = sol[2]*rhoInv;</div>
<div class="line"><a name="l06011"></a><span class="lineno"> 6011</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w            = sol[3]*rhoInv;</div>
<div class="line"><a name="l06012"></a><span class="lineno"> 6012</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = sol[4]*rhoInv;</div>
<div class="line"><a name="l06013"></a><span class="lineno"> 6013</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - 0.5*(u*u + v*v + w*w);</div>
<div class="line"><a name="l06014"></a><span class="lineno"> 6014</span>&#160; </div>
<div class="line"><a name="l06015"></a><span class="lineno"> 6015</span>&#160;            <span class="comment">/*--- Compute the pressure. ---*/</span></div>
<div class="line"><a name="l06016"></a><span class="lineno"> 6016</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l06017"></a><span class="lineno"> 6017</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l06018"></a><span class="lineno"> 6018</span>&#160; </div>
<div class="line"><a name="l06019"></a><span class="lineno"> 6019</span>&#160;            <span class="comment">/* Compute the relative velocities w.r.t. the grid. */</span></div>
<div class="line"><a name="l06020"></a><span class="lineno"> 6020</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> uRel = u - gridVel[0];</div>
<div class="line"><a name="l06021"></a><span class="lineno"> 6021</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vRel = v - gridVel[1];</div>
<div class="line"><a name="l06022"></a><span class="lineno"> 6022</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wRel = w - gridVel[2];</div>
<div class="line"><a name="l06023"></a><span class="lineno"> 6023</span>&#160; </div>
<div class="line"><a name="l06024"></a><span class="lineno"> 6024</span>&#160;            <span class="comment">/* Set the pointer for the fluxes in this integration point. */</span></div>
<div class="line"><a name="l06025"></a><span class="lineno"> 6025</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux = fluxes + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*iNPad + llNVar;</div>
<div class="line"><a name="l06026"></a><span class="lineno"> 6026</span>&#160; </div>
<div class="line"><a name="l06027"></a><span class="lineno"> 6027</span>&#160;            <span class="comment">/*--- Fluxes in r-direction. */</span></div>
<div class="line"><a name="l06028"></a><span class="lineno"> 6028</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Ur = uRel*wDrdx + vRel*wDrdy + wRel*wDrdz;</div>
<div class="line"><a name="l06029"></a><span class="lineno"> 6029</span>&#160; </div>
<div class="line"><a name="l06030"></a><span class="lineno"> 6030</span>&#160;            flux[0] = sol[0]*Ur;</div>
<div class="line"><a name="l06031"></a><span class="lineno"> 6031</span>&#160;            flux[1] = sol[1]*Ur + Pressure*wDrdx;</div>
<div class="line"><a name="l06032"></a><span class="lineno"> 6032</span>&#160;            flux[2] = sol[2]*Ur + Pressure*wDrdy;</div>
<div class="line"><a name="l06033"></a><span class="lineno"> 6033</span>&#160;            flux[3] = sol[3]*Ur + Pressure*wDrdz;</div>
<div class="line"><a name="l06034"></a><span class="lineno"> 6034</span>&#160;            flux[4] = sol[4]*Ur + Pressure*(u*wDrdx + v*wDrdy + w*wDrdz);</div>
<div class="line"><a name="l06035"></a><span class="lineno"> 6035</span>&#160; </div>
<div class="line"><a name="l06036"></a><span class="lineno"> 6036</span>&#160;            <span class="comment">/*--- Fluxes in s-direction. */</span></div>
<div class="line"><a name="l06037"></a><span class="lineno"> 6037</span>&#160;            flux = flux + NPad;</div>
<div class="line"><a name="l06038"></a><span class="lineno"> 6038</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Us = uRel*wDsdx + vRel*wDsdy + wRel*wDsdz;</div>
<div class="line"><a name="l06039"></a><span class="lineno"> 6039</span>&#160; </div>
<div class="line"><a name="l06040"></a><span class="lineno"> 6040</span>&#160;            flux[0] = sol[0]*Us;</div>
<div class="line"><a name="l06041"></a><span class="lineno"> 6041</span>&#160;            flux[1] = sol[1]*Us + Pressure*wDsdx;</div>
<div class="line"><a name="l06042"></a><span class="lineno"> 6042</span>&#160;            flux[2] = sol[2]*Us + Pressure*wDsdy;</div>
<div class="line"><a name="l06043"></a><span class="lineno"> 6043</span>&#160;            flux[3] = sol[3]*Us + Pressure*wDsdz;</div>
<div class="line"><a name="l06044"></a><span class="lineno"> 6044</span>&#160;            flux[4] = sol[4]*Us + Pressure*(u*wDsdx + v*wDsdy + w*wDsdz);</div>
<div class="line"><a name="l06045"></a><span class="lineno"> 6045</span>&#160; </div>
<div class="line"><a name="l06046"></a><span class="lineno"> 6046</span>&#160;            <span class="comment">/*--- Fluxes in t-direction. */</span></div>
<div class="line"><a name="l06047"></a><span class="lineno"> 6047</span>&#160;            flux = flux + NPad;</div>
<div class="line"><a name="l06048"></a><span class="lineno"> 6048</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Ut = uRel*wDtdx + vRel*wDtdy + wRel*wDtdz;</div>
<div class="line"><a name="l06049"></a><span class="lineno"> 6049</span>&#160; </div>
<div class="line"><a name="l06050"></a><span class="lineno"> 6050</span>&#160;            flux[0] = sol[0]*Ut;</div>
<div class="line"><a name="l06051"></a><span class="lineno"> 6051</span>&#160;            flux[1] = sol[1]*Ut + Pressure*wDtdx;</div>
<div class="line"><a name="l06052"></a><span class="lineno"> 6052</span>&#160;            flux[2] = sol[2]*Ut + Pressure*wDtdy;</div>
<div class="line"><a name="l06053"></a><span class="lineno"> 6053</span>&#160;            flux[3] = sol[3]*Ut + Pressure*wDtdz;</div>
<div class="line"><a name="l06054"></a><span class="lineno"> 6054</span>&#160;            flux[4] = sol[4]*Ut + Pressure*(u*wDtdx + v*wDtdy + w*wDtdz);</div>
<div class="line"><a name="l06055"></a><span class="lineno"> 6055</span>&#160; </div>
<div class="line"><a name="l06056"></a><span class="lineno"> 6056</span>&#160;            <span class="comment">/*--- If needed, compute the body forces in this integration point.</span></div>
<div class="line"><a name="l06057"></a><span class="lineno"> 6057</span>&#160;<span class="comment">                  Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l06058"></a><span class="lineno"> 6058</span>&#160;<span class="comment">                  integration weight in order to be consistent with the</span></div>
<div class="line"><a name="l06059"></a><span class="lineno"> 6059</span>&#160;<span class="comment">                  formulation of the residual. Note that for the energy source</span></div>
<div class="line"><a name="l06060"></a><span class="lineno"> 6060</span>&#160;<span class="comment">                  term the absolute velocity must be taken and not the</span></div>
<div class="line"><a name="l06061"></a><span class="lineno"> 6061</span>&#160;<span class="comment">                  relative. ---*/</span></div>
<div class="line"><a name="l06062"></a><span class="lineno"> 6062</span>&#160;            <span class="keywordflow">if</span>( body_force ) {</div>
<div class="line"><a name="l06063"></a><span class="lineno"> 6063</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *source         = sources + iNPad + llNVar;</div>
<div class="line"><a name="l06064"></a><span class="lineno"> 6064</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*Jac;</div>
<div class="line"><a name="l06065"></a><span class="lineno"> 6065</span>&#160; </div>
<div class="line"><a name="l06066"></a><span class="lineno"> 6066</span>&#160;              source[0] =  0.0;</div>
<div class="line"><a name="l06067"></a><span class="lineno"> 6067</span>&#160;              source[1] = -weightJac*body_force_vector[0];</div>
<div class="line"><a name="l06068"></a><span class="lineno"> 6068</span>&#160;              source[2] = -weightJac*body_force_vector[1];</div>
<div class="line"><a name="l06069"></a><span class="lineno"> 6069</span>&#160;              source[3] = -weightJac*body_force_vector[2];</div>
<div class="line"><a name="l06070"></a><span class="lineno"> 6070</span>&#160;              source[4] = -weightJac*(u*body_force_vector[0] + v*body_force_vector[1]</div>
<div class="line"><a name="l06071"></a><span class="lineno"> 6071</span>&#160;                        +             w*body_force_vector[2]);</div>
<div class="line"><a name="l06072"></a><span class="lineno"> 6072</span>&#160;            }</div>
<div class="line"><a name="l06073"></a><span class="lineno"> 6073</span>&#160;          }</div>
<div class="line"><a name="l06074"></a><span class="lineno"> 6074</span>&#160;        }</div>
<div class="line"><a name="l06075"></a><span class="lineno"> 6075</span>&#160; </div>
<div class="line"><a name="l06076"></a><span class="lineno"> 6076</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06077"></a><span class="lineno"> 6077</span>&#160;      }</div>
<div class="line"><a name="l06078"></a><span class="lineno"> 6078</span>&#160;    }</div>
<div class="line"><a name="l06079"></a><span class="lineno"> 6079</span>&#160; </div>
<div class="line"><a name="l06080"></a><span class="lineno"> 6080</span>&#160;    <span class="comment">/* Initialize addSourceTerms to body_force. The value of addSourceTerms</span></div>
<div class="line"><a name="l06081"></a><span class="lineno"> 6081</span>&#160;<span class="comment">       is set to true when a manufactured solution is computed. */</span></div>
<div class="line"><a name="l06082"></a><span class="lineno"> 6082</span>&#160;    <span class="keywordtype">bool</span> addSourceTerms = body_force;</div>
<div class="line"><a name="l06083"></a><span class="lineno"> 6083</span>&#160; </div>
<div class="line"><a name="l06084"></a><span class="lineno"> 6084</span>&#160;<span class="preprocessor">#ifdef MANUFACTURED_SOLUTION</span></div>
<div class="line"><a name="l06085"></a><span class="lineno"> 6085</span>&#160; </div>
<div class="line"><a name="l06086"></a><span class="lineno"> 6086</span>&#160;    <span class="comment">/*--- For the manufactured solutions a source term must be added. If a</span></div>
<div class="line"><a name="l06087"></a><span class="lineno"> 6087</span>&#160;<span class="comment">          standard source term has not been specified, initialize the source</span></div>
<div class="line"><a name="l06088"></a><span class="lineno"> 6088</span>&#160;<span class="comment">          terms to zero and set addSourceTerms to true. ---*/</span></div>
<div class="line"><a name="l06089"></a><span class="lineno"> 6089</span>&#160;    addSourceTerms = <span class="keyword">true</span>;</div>
<div class="line"><a name="l06090"></a><span class="lineno"> 6090</span>&#160;    <span class="keywordflow">if</span>( !body_force ) {</div>
<div class="line"><a name="l06091"></a><span class="lineno"> 6091</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(nInt*NPad); ++i)</div>
<div class="line"><a name="l06092"></a><span class="lineno"> 6092</span>&#160;        sources[i] = 0.0;</div>
<div class="line"><a name="l06093"></a><span class="lineno"> 6093</span>&#160;    }</div>
<div class="line"><a name="l06094"></a><span class="lineno"> 6094</span>&#160; </div>
<div class="line"><a name="l06095"></a><span class="lineno"> 6095</span>&#160; </div>
<div class="line"><a name="l06096"></a><span class="lineno"> 6096</span>&#160;    <span class="comment">/* Easier storage of the gas constant. */</span></div>
<div class="line"><a name="l06097"></a><span class="lineno"> 6097</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RGas = config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l06098"></a><span class="lineno"> 6098</span>&#160; </div>
<div class="line"><a name="l06099"></a><span class="lineno"> 6099</span>&#160;    <span class="comment">/*--- Loop over the chunk of elements and its integration points. ---*/</span></div>
<div class="line"><a name="l06100"></a><span class="lineno"> 6100</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l06101"></a><span class="lineno"> 6101</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06102"></a><span class="lineno"> 6102</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l06103"></a><span class="lineno"> 6103</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l06104"></a><span class="lineno"> 6104</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iNPad = i*NPad;</div>
<div class="line"><a name="l06105"></a><span class="lineno"> 6105</span>&#160; </div>
<div class="line"><a name="l06106"></a><span class="lineno"> 6106</span>&#160;        <span class="comment">/* Determine the integration weight multiplied by the Jacobian. */</span></div>
<div class="line"><a name="l06107"></a><span class="lineno"> 6107</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data()</div>
<div class="line"><a name="l06108"></a><span class="lineno"> 6108</span>&#160;                                     + i*nMetricPerPoint;</div>
<div class="line"><a name="l06109"></a><span class="lineno"> 6109</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac    = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l06110"></a><span class="lineno"> 6110</span>&#160; </div>
<div class="line"><a name="l06111"></a><span class="lineno"> 6111</span>&#160;        <span class="comment">/* Set the pointer to the coordinates in this integration point and</span></div>
<div class="line"><a name="l06112"></a><span class="lineno"> 6112</span>&#160;<span class="comment">           call the function to compute the source terms for the manufactured</span></div>
<div class="line"><a name="l06113"></a><span class="lineno"> 6113</span>&#160;<span class="comment">           solution. Note that this is an inviscid computation, so for</span></div>
<div class="line"><a name="l06114"></a><span class="lineno"> 6114</span>&#160;<span class="comment">           viscosity and thermal conductivity a zero is passed. */</span></div>
<div class="line"><a name="l06115"></a><span class="lineno"> 6115</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a51a6fc4be49459ff00b9391ba87291cd">coorIntegrationPoints</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l06116"></a><span class="lineno"> 6116</span>&#160; </div>
<div class="line"><a name="l06117"></a><span class="lineno"> 6117</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> sourceMan[5];</div>
<div class="line"><a name="l06118"></a><span class="lineno"> 6118</span>&#160;        SourceTermManufacturedSolution(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>, RGas, 0.0, 0.0, coor, sourceMan);</div>
<div class="line"><a name="l06119"></a><span class="lineno"> 6119</span>&#160; </div>
<div class="line"><a name="l06120"></a><span class="lineno"> 6120</span>&#160;        <span class="comment">/*--- Subtract the source term of the manufactured solution, multiplied</span></div>
<div class="line"><a name="l06121"></a><span class="lineno"> 6121</span>&#160;<span class="comment">              by the appropriate weight, from the possibly earlier computed</span></div>
<div class="line"><a name="l06122"></a><span class="lineno"> 6122</span>&#160;<span class="comment">              source term. It is subtracted in order to be consistent with</span></div>
<div class="line"><a name="l06123"></a><span class="lineno"> 6123</span>&#160;<span class="comment">              the definition of the residual used in this code. ---*/</span></div>
<div class="line"><a name="l06124"></a><span class="lineno"> 6124</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *source = sources + iNPad + llNVar;</div>
<div class="line"><a name="l06125"></a><span class="lineno"> 6125</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++k)</div>
<div class="line"><a name="l06126"></a><span class="lineno"> 6126</span>&#160;          source[k] -= weightJac*sourceMan[k];</div>
<div class="line"><a name="l06127"></a><span class="lineno"> 6127</span>&#160;      }</div>
<div class="line"><a name="l06128"></a><span class="lineno"> 6128</span>&#160;    }</div>
<div class="line"><a name="l06129"></a><span class="lineno"> 6129</span>&#160; </div>
<div class="line"><a name="l06130"></a><span class="lineno"> 6130</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l06131"></a><span class="lineno"> 6131</span>&#160; </div>
<div class="line"><a name="l06132"></a><span class="lineno"> 6132</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06133"></a><span class="lineno"> 6133</span>&#160;    <span class="comment">/*--- Step 3: Compute the contribution to the residuals from the       ---*/</span></div>
<div class="line"><a name="l06134"></a><span class="lineno"> 6134</span>&#160;    <span class="comment">/*---         integration over the volume element.                     ---*/</span></div>
<div class="line"><a name="l06135"></a><span class="lineno"> 6135</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06136"></a><span class="lineno"> 6136</span>&#160; </div>
<div class="line"><a name="l06137"></a><span class="lineno"> 6137</span>&#160;    <span class="comment">/* Call the general function to carry out the matrix product.</span></div>
<div class="line"><a name="l06138"></a><span class="lineno"> 6138</span>&#160;<span class="comment">       Use solDOFs as a temporary storage for the matrix product. */</span></div>
<div class="line"><a name="l06139"></a><span class="lineno"> 6139</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, matDerBasisIntTrans, fluxes, solDOFs, config);</div>
<div class="line"><a name="l06140"></a><span class="lineno"> 6140</span>&#160; </div>
<div class="line"><a name="l06141"></a><span class="lineno"> 6141</span>&#160;    <span class="comment">/* Add the contribution from the source terms, if needed. Use solInt</span></div>
<div class="line"><a name="l06142"></a><span class="lineno"> 6142</span>&#160;<span class="comment">       as temporary storage for the matrix product. */</span></div>
<div class="line"><a name="l06143"></a><span class="lineno"> 6143</span>&#160;    <span class="keywordflow">if</span>( addSourceTerms ) {</div>
<div class="line"><a name="l06144"></a><span class="lineno"> 6144</span>&#160; </div>
<div class="line"><a name="l06145"></a><span class="lineno"> 6145</span>&#160;      <span class="comment">/* Call the general function to carry out the matrix product. */</span></div>
<div class="line"><a name="l06146"></a><span class="lineno"> 6146</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, matBasisIntTrans, sources, solInt, config);</div>
<div class="line"><a name="l06147"></a><span class="lineno"> 6147</span>&#160; </div>
<div class="line"><a name="l06148"></a><span class="lineno"> 6148</span>&#160;      <span class="comment">/* Add the residuals due to source terms to the volume residuals */</span></div>
<div class="line"><a name="l06149"></a><span class="lineno"> 6149</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(nDOFs*NPad); ++i)</div>
<div class="line"><a name="l06150"></a><span class="lineno"> 6150</span>&#160;        solDOFs[i] += solInt[i];</div>
<div class="line"><a name="l06151"></a><span class="lineno"> 6151</span>&#160;    }</div>
<div class="line"><a name="l06152"></a><span class="lineno"> 6152</span>&#160; </div>
<div class="line"><a name="l06153"></a><span class="lineno"> 6153</span>&#160;    <span class="comment">/* Loop over the elements in this chunk to store the residuals</span></div>
<div class="line"><a name="l06154"></a><span class="lineno"> 6154</span>&#160;<span class="comment">       in the appropriate locations. */</span></div>
<div class="line"><a name="l06155"></a><span class="lineno"> 6155</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l06156"></a><span class="lineno"> 6156</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06157"></a><span class="lineno"> 6157</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l06158"></a><span class="lineno"> 6158</span>&#160; </div>
<div class="line"><a name="l06159"></a><span class="lineno"> 6159</span>&#160;      <span class="comment">/* Easier storage of the residuals for this volume element. */</span></div>
<div class="line"><a name="l06160"></a><span class="lineno"> 6160</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *res = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l06161"></a><span class="lineno"> 6161</span>&#160; </div>
<div class="line"><a name="l06162"></a><span class="lineno"> 6162</span>&#160;      <span class="comment">/* Loop over the DOFs and copy the data. */</span></div>
<div class="line"><a name="l06163"></a><span class="lineno"> 6163</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i)</div>
<div class="line"><a name="l06164"></a><span class="lineno"> 6164</span>&#160;        memcpy(res+i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, solDOFs+i*NPad+llNVar, nBytes);</div>
<div class="line"><a name="l06165"></a><span class="lineno"> 6165</span>&#160;    }</div>
<div class="line"><a name="l06166"></a><span class="lineno"> 6166</span>&#160; </div>
<div class="line"><a name="l06167"></a><span class="lineno"> 6167</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l06168"></a><span class="lineno"> 6168</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l06169"></a><span class="lineno"> 6169</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l06170"></a><span class="lineno"> 6170</span>&#160;  }</div>
<div class="line"><a name="l06171"></a><span class="lineno"> 6171</span>&#160;}</div>
<div class="line"><a name="l06172"></a><span class="lineno"> 6172</span>&#160; </div>
<div class="line"><a name="l06173"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#ae37f8eba6d7793bc4edb5de6e26f992d"> 6173</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ae37f8eba6d7793bc4edb5de6e26f992d">CFEM_DG_EulerSolver::Boundary_Conditions</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel,</div>
<div class="line"><a name="l06174"></a><span class="lineno"> 6174</span>&#160;                                              <a class="code" href="class_c_config.html">CConfig</a>              *config,</div>
<div class="line"><a name="l06175"></a><span class="lineno"> 6175</span>&#160;                                              <a class="code" href="class_c_numerics.html">CNumerics</a>            **numerics,</div>
<div class="line"><a name="l06176"></a><span class="lineno"> 6176</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">bool</span>           haloInfoNeededForBC,</div>
<div class="line"><a name="l06177"></a><span class="lineno"> 6177</span>&#160;                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *workArray){</div>
<div class="line"><a name="l06178"></a><span class="lineno"> 6178</span>&#160; </div>
<div class="line"><a name="l06179"></a><span class="lineno"> 6179</span>&#160;  <span class="comment">/* Loop over all boundaries. */</span></div>
<div class="line"><a name="l06180"></a><span class="lineno"> 6180</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker = 0; iMarker &lt; config-&gt;<a class="code" href="class_c_config.html#a300c4884edfc0c2acf395036439004f4">GetnMarker_All</a>(); iMarker++) {</div>
<div class="line"><a name="l06181"></a><span class="lineno"> 6181</span>&#160; </div>
<div class="line"><a name="l06182"></a><span class="lineno"> 6182</span>&#160;    <span class="comment">/* Check if this boundary marker must be treated at all. */</span></div>
<div class="line"><a name="l06183"></a><span class="lineno"> 6183</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].haloInfoNeededForBC == haloInfoNeededForBC) {</div>
<div class="line"><a name="l06184"></a><span class="lineno"> 6184</span>&#160; </div>
<div class="line"><a name="l06185"></a><span class="lineno"> 6185</span>&#160;      <span class="comment">/* Determine the range of faces for this time level and test if any</span></div>
<div class="line"><a name="l06186"></a><span class="lineno"> 6186</span>&#160;<span class="comment">         surface element for this marker must be treated at all. */</span></div>
<div class="line"><a name="l06187"></a><span class="lineno"> 6187</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> surfElemBeg = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#ab955ab8e1e78b773c33cc1d1f705d7d4">nSurfElem</a>[timeLevel];</div>
<div class="line"><a name="l06188"></a><span class="lineno"> 6188</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> surfElemEnd = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#ab955ab8e1e78b773c33cc1d1f705d7d4">nSurfElem</a>[timeLevel+1];</div>
<div class="line"><a name="l06189"></a><span class="lineno"> 6189</span>&#160; </div>
<div class="line"><a name="l06190"></a><span class="lineno"> 6190</span>&#160;      <span class="keywordflow">if</span>(surfElemEnd &gt; surfElemBeg) {</div>
<div class="line"><a name="l06191"></a><span class="lineno"> 6191</span>&#160; </div>
<div class="line"><a name="l06192"></a><span class="lineno"> 6192</span>&#160;        <span class="comment">/* Set the starting position in the vector for the face residuals for</span></div>
<div class="line"><a name="l06193"></a><span class="lineno"> 6193</span>&#160;<span class="comment">           this boundary marker and time level and set the pointer to the boundary</span></div>
<div class="line"><a name="l06194"></a><span class="lineno"> 6194</span>&#160;<span class="comment">           faces for this boundary marker. */</span></div>
<div class="line"><a name="l06195"></a><span class="lineno"> 6195</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFaces = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data()</div>
<div class="line"><a name="l06196"></a><span class="lineno"> 6196</span>&#160;                            + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8d2f8c9a6a10df61413ba7a206a034da">startLocResFacesMarkers</a>[iMarker][timeLevel];</div>
<div class="line"><a name="l06197"></a><span class="lineno"> 6197</span>&#160; </div>
<div class="line"><a name="l06198"></a><span class="lineno"> 6198</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.data();</div>
<div class="line"><a name="l06199"></a><span class="lineno"> 6199</span>&#160; </div>
<div class="line"><a name="l06200"></a><span class="lineno"> 6200</span>&#160;        <span class="comment">/* Apply the appropriate boundary condition. */</span></div>
<div class="line"><a name="l06201"></a><span class="lineno"> 6201</span>&#160;        <span class="keywordflow">switch</span> (config-&gt;<a class="code" href="class_c_config.html#a57d43acc1457d2d27095ce006218862e">GetMarker_All_KindBC</a>(iMarker)) {</div>
<div class="line"><a name="l06202"></a><span class="lineno"> 6202</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba229d80524b666a7ebf409d3655255a1a">EULER_WALL</a>:</div>
<div class="line"><a name="l06203"></a><span class="lineno"> 6203</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8f81a6011b17cbb65c8be69d517e8faf">BC_Euler_Wall</a>(config, surfElemBeg, surfElemEnd, surfElem, resFaces,</div>
<div class="line"><a name="l06204"></a><span class="lineno"> 6204</span>&#160;                          numerics[<a class="code" href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a>], workArray);</div>
<div class="line"><a name="l06205"></a><span class="lineno"> 6205</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06206"></a><span class="lineno"> 6206</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba2017081e4aa73a6aef6fdd6b3a380fbf">FAR_FIELD</a>:</div>
<div class="line"><a name="l06207"></a><span class="lineno"> 6207</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a48b8a50d3e9deee07bd02a30249f6f6d">BC_Far_Field</a>(config, surfElemBeg, surfElemEnd, surfElem, resFaces,</div>
<div class="line"><a name="l06208"></a><span class="lineno"> 6208</span>&#160;                         numerics[<a class="code" href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a>], workArray);</div>
<div class="line"><a name="l06209"></a><span class="lineno"> 6209</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06210"></a><span class="lineno"> 6210</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba880ef9c3117aab907dc52253247e0c23">SYMMETRY_PLANE</a>:</div>
<div class="line"><a name="l06211"></a><span class="lineno"> 6211</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a002d30c9052117b77a33d1f290b1195b">BC_Sym_Plane</a>(config, surfElemBeg, surfElemEnd, surfElem, resFaces,</div>
<div class="line"><a name="l06212"></a><span class="lineno"> 6212</span>&#160;                         numerics[<a class="code" href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a>], workArray);</div>
<div class="line"><a name="l06213"></a><span class="lineno"> 6213</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06214"></a><span class="lineno"> 6214</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba8e57aa6eae14b4e84e2ebd0be0d385fb">SUPERSONIC_INLET</a>: <span class="comment">/* Use far field for this. When a more detailed state</span></div>
<div class="line"><a name="l06215"></a><span class="lineno"> 6215</span>&#160;<span class="comment">                                    needs to be specified, use a Riemann boundary. */</span></div>
<div class="line"><a name="l06216"></a><span class="lineno"> 6216</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a48b8a50d3e9deee07bd02a30249f6f6d">BC_Far_Field</a>(config, surfElemBeg, surfElemEnd, surfElem, resFaces,</div>
<div class="line"><a name="l06217"></a><span class="lineno"> 6217</span>&#160;                         numerics[<a class="code" href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a>], workArray);</div>
<div class="line"><a name="l06218"></a><span class="lineno"> 6218</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06219"></a><span class="lineno"> 6219</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820bacaed259788fb153495d0901f31e529bf">SUPERSONIC_OUTLET</a>:</div>
<div class="line"><a name="l06220"></a><span class="lineno"> 6220</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a99232a4f053e949762b0919a6c288c73">BC_Supersonic_Outlet</a>(config, surfElemBeg, surfElemEnd, surfElem, resFaces,</div>
<div class="line"><a name="l06221"></a><span class="lineno"> 6221</span>&#160;                                 numerics[<a class="code" href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a>], workArray);</div>
<div class="line"><a name="l06222"></a><span class="lineno"> 6222</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06223"></a><span class="lineno"> 6223</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba6dc1b159829aa7885fc905d3d81f28bd">INLET_FLOW</a>:</div>
<div class="line"><a name="l06224"></a><span class="lineno"> 6224</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ade8441a575543603f4e4218fb52e33a2">BC_Inlet</a>(config, surfElemBeg, surfElemEnd, surfElem, resFaces,</div>
<div class="line"><a name="l06225"></a><span class="lineno"> 6225</span>&#160;                     numerics[<a class="code" href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a>], iMarker, workArray);</div>
<div class="line"><a name="l06226"></a><span class="lineno"> 6226</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06227"></a><span class="lineno"> 6227</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba86e05bfda25f3af9a4a88a45551c1711">OUTLET_FLOW</a>:</div>
<div class="line"><a name="l06228"></a><span class="lineno"> 6228</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a869796e928f7618ea7f47d9ebc80cf76">BC_Outlet</a>(config, surfElemBeg, surfElemEnd, surfElem, resFaces,</div>
<div class="line"><a name="l06229"></a><span class="lineno"> 6229</span>&#160;                      numerics[<a class="code" href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a>], iMarker, workArray);</div>
<div class="line"><a name="l06230"></a><span class="lineno"> 6230</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06231"></a><span class="lineno"> 6231</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a>:</div>
<div class="line"><a name="l06232"></a><span class="lineno"> 6232</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab1f72e1efac556ea4cbb994142cbd555">BC_Isothermal_Wall</a>(config, surfElemBeg, surfElemEnd, surfElem, resFaces,</div>
<div class="line"><a name="l06233"></a><span class="lineno"> 6233</span>&#160;                               numerics[<a class="code" href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a>], iMarker, workArray);</div>
<div class="line"><a name="l06234"></a><span class="lineno"> 6234</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06235"></a><span class="lineno"> 6235</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a>:</div>
<div class="line"><a name="l06236"></a><span class="lineno"> 6236</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a93e6d09a155cd888a20b1875b77ce2be">BC_HeatFlux_Wall</a>(config, surfElemBeg, surfElemEnd, surfElem, resFaces,</div>
<div class="line"><a name="l06237"></a><span class="lineno"> 6237</span>&#160;                             numerics[<a class="code" href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a>], iMarker, workArray);</div>
<div class="line"><a name="l06238"></a><span class="lineno"> 6238</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06239"></a><span class="lineno"> 6239</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba7dce7f1da4453165b8d91c603393cac7">RIEMANN_BOUNDARY</a>:</div>
<div class="line"><a name="l06240"></a><span class="lineno"> 6240</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaff04081aba8d9e24f0e615161e8020f">BC_Riemann</a>(config, surfElemBeg, surfElemEnd, surfElem, resFaces,</div>
<div class="line"><a name="l06241"></a><span class="lineno"> 6241</span>&#160;                       numerics[<a class="code" href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a>], iMarker, workArray);</div>
<div class="line"><a name="l06242"></a><span class="lineno"> 6242</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06243"></a><span class="lineno"> 6243</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba11d18e3062791a329262ca35eba70a9e">CUSTOM_BOUNDARY</a>:</div>
<div class="line"><a name="l06244"></a><span class="lineno"> 6244</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0e63fc77fc810025d45bfd8e0bf4d6dd">BC_Custom</a>(config, surfElemBeg, surfElemEnd, surfElem, resFaces,</div>
<div class="line"><a name="l06245"></a><span class="lineno"> 6245</span>&#160;                      numerics[<a class="code" href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a>], workArray);</div>
<div class="line"><a name="l06246"></a><span class="lineno"> 6246</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06247"></a><span class="lineno"> 6247</span>&#160;          <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820baff3fbf5c45243583a13a7c1c78959953">PERIODIC_BOUNDARY</a>:  <span class="comment">// Nothing to be done for a periodic boundary.</span></div>
<div class="line"><a name="l06248"></a><span class="lineno"> 6248</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06249"></a><span class="lineno"> 6249</span>&#160;          <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l06250"></a><span class="lineno"> 6250</span>&#160;            <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;BC not implemented.&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l06251"></a><span class="lineno"> 6251</span>&#160;        }</div>
<div class="line"><a name="l06252"></a><span class="lineno"> 6252</span>&#160;      }</div>
<div class="line"><a name="l06253"></a><span class="lineno"> 6253</span>&#160;    }</div>
<div class="line"><a name="l06254"></a><span class="lineno"> 6254</span>&#160;  }</div>
<div class="line"><a name="l06255"></a><span class="lineno"> 6255</span>&#160;}</div>
<div class="line"><a name="l06256"></a><span class="lineno"> 6256</span>&#160; </div>
<div class="line"><a name="l06257"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a8875e58364f55e735fc3732f545d5f29"> 6257</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8875e58364f55e735fc3732f545d5f29">CFEM_DG_EulerSolver::ResidualFaces</a>(<a class="code" href="class_c_config.html">CConfig</a>             *config,</div>
<div class="line"><a name="l06258"></a><span class="lineno"> 6258</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indFaceBeg,</div>
<div class="line"><a name="l06259"></a><span class="lineno"> 6259</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indFaceEnd,</div>
<div class="line"><a name="l06260"></a><span class="lineno"> 6260</span>&#160;                                        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>       &amp;indResFaces,</div>
<div class="line"><a name="l06261"></a><span class="lineno"> 6261</span>&#160;                                        <a class="code" href="class_c_numerics.html">CNumerics</a>           *numerics,</div>
<div class="line"><a name="l06262"></a><span class="lineno"> 6262</span>&#160;                                        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>           *workArray) {</div>
<div class="line"><a name="l06263"></a><span class="lineno"> 6263</span>&#160; </div>
<div class="line"><a name="l06264"></a><span class="lineno"> 6264</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l06265"></a><span class="lineno"> 6265</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l06266"></a><span class="lineno"> 6266</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l06267"></a><span class="lineno"> 6267</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06268"></a><span class="lineno"> 6268</span>&#160; </div>
<div class="line"><a name="l06269"></a><span class="lineno"> 6269</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l06270"></a><span class="lineno"> 6270</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l06271"></a><span class="lineno"> 6271</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l06272"></a><span class="lineno"> 6272</span>&#160; </div>
<div class="line"><a name="l06273"></a><span class="lineno"> 6273</span>&#160;  <span class="comment">/* Set the number of bytes that must be copied in the memcpy calls. */</span></div>
<div class="line"><a name="l06274"></a><span class="lineno"> 6274</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l06275"></a><span class="lineno"> 6275</span>&#160; </div>
<div class="line"><a name="l06276"></a><span class="lineno"> 6276</span>&#160;  <span class="comment">/*--- Loop over the requested range of matching faces. Multiple faces</span></div>
<div class="line"><a name="l06277"></a><span class="lineno"> 6277</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l06278"></a><span class="lineno"> 6278</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l06279"></a><span class="lineno"> 6279</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l06280"></a><span class="lineno"> 6280</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=indFaceBeg; l&lt;indFaceEnd;) {</div>
<div class="line"><a name="l06281"></a><span class="lineno"> 6281</span>&#160; </div>
<div class="line"><a name="l06282"></a><span class="lineno"> 6282</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l06283"></a><span class="lineno"> 6283</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l06284"></a><span class="lineno"> 6284</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l06285"></a><span class="lineno"> 6285</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l06286"></a><span class="lineno"> 6286</span>&#160; </div>
<div class="line"><a name="l06287"></a><span class="lineno"> 6287</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>, l, indFaceEnd, nFaceSimul,</div>
<div class="line"><a name="l06288"></a><span class="lineno"> 6288</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l06289"></a><span class="lineno"> 6289</span>&#160; </div>
<div class="line"><a name="l06290"></a><span class="lineno"> 6290</span>&#160;    <span class="comment">/* Get the necessary data from the standard face. */</span></div>
<div class="line"><a name="l06291"></a><span class="lineno"> 6291</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l06292"></a><span class="lineno"> 6292</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l06293"></a><span class="lineno"> 6293</span>&#160; </div>
<div class="line"><a name="l06294"></a><span class="lineno"> 6294</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#acd4208ae47226c5917479d6a232b7584">GetNDOFsFaceSide0</a>();</div>
<div class="line"><a name="l06295"></a><span class="lineno"> 6295</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a0e3ff97b8c11ca92ede562565eec7041">GetNDOFsFaceSide1</a>();</div>
<div class="line"><a name="l06296"></a><span class="lineno"> 6296</span>&#160; </div>
<div class="line"><a name="l06297"></a><span class="lineno"> 6297</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l06298"></a><span class="lineno"> 6298</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l06299"></a><span class="lineno"> 6299</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*max(nInt, nDOFsFace0);</div>
<div class="line"><a name="l06300"></a><span class="lineno"> 6300</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxes  = solIntR + NPad*max(nInt, nDOFsFace1);</div>
<div class="line"><a name="l06301"></a><span class="lineno"> 6301</span>&#160; </div>
<div class="line"><a name="l06302"></a><span class="lineno"> 6302</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06303"></a><span class="lineno"> 6303</span>&#160;    <span class="comment">/*--- Step 1: Compute the inviscid fluxes in the integration points of ---*/</span></div>
<div class="line"><a name="l06304"></a><span class="lineno"> 6304</span>&#160;    <span class="comment">/*---         this matching face multiplied by the integration weight. ---*/</span></div>
<div class="line"><a name="l06305"></a><span class="lineno"> 6305</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06306"></a><span class="lineno"> 6306</span>&#160; </div>
<div class="line"><a name="l06307"></a><span class="lineno"> 6307</span>&#160;    <span class="comment">/* Compute the inviscid fluxes in the integration points. */</span></div>
<div class="line"><a name="l06308"></a><span class="lineno"> 6308</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab7546cb31b73191bbac2b338c88cfbc4">InviscidFluxesInternalMatchingFace</a>(config, l, lEnd, NPad,</div>
<div class="line"><a name="l06309"></a><span class="lineno"> 6309</span>&#160;                                       solIntL, solIntR, fluxes, numerics);</div>
<div class="line"><a name="l06310"></a><span class="lineno"> 6310</span>&#160; </div>
<div class="line"><a name="l06311"></a><span class="lineno"> 6311</span>&#160;    <span class="comment">/* Multiply the fluxes with the integration weight of the corresponding</span></div>
<div class="line"><a name="l06312"></a><span class="lineno"> 6312</span>&#160;<span class="comment">       integration point. */</span></div>
<div class="line"><a name="l06313"></a><span class="lineno"> 6313</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l06314"></a><span class="lineno"> 6314</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux = fluxes + i*NPad;</div>
<div class="line"><a name="l06315"></a><span class="lineno"> 6315</span>&#160; </div>
<div class="line"><a name="l06316"></a><span class="lineno"> 6316</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;NPad; ++j)</div>
<div class="line"><a name="l06317"></a><span class="lineno"> 6317</span>&#160;        flux[j] *= weights[i];</div>
<div class="line"><a name="l06318"></a><span class="lineno"> 6318</span>&#160;    }</div>
<div class="line"><a name="l06319"></a><span class="lineno"> 6319</span>&#160; </div>
<div class="line"><a name="l06320"></a><span class="lineno"> 6320</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06321"></a><span class="lineno"> 6321</span>&#160;    <span class="comment">/*--- Step 2: Compute the contribution to the residuals from the       ---*/</span></div>
<div class="line"><a name="l06322"></a><span class="lineno"> 6322</span>&#160;    <span class="comment">/*---         integration over this chunk of internal matching faces.  ---*/</span></div>
<div class="line"><a name="l06323"></a><span class="lineno"> 6323</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06324"></a><span class="lineno"> 6324</span>&#160; </div>
<div class="line"><a name="l06325"></a><span class="lineno"> 6325</span>&#160;    <span class="comment">/* Get the correct form of the basis functions needed for the matrix</span></div>
<div class="line"><a name="l06326"></a><span class="lineno"> 6326</span>&#160;<span class="comment">       multiplication to compute the residual. Use solIntL as a temporary</span></div>
<div class="line"><a name="l06327"></a><span class="lineno"> 6327</span>&#160;<span class="comment">       buffer to store this product. */</span></div>
<div class="line"><a name="l06328"></a><span class="lineno"> 6328</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFaceTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a5dec1874e302623d6c8fb57e7e34e960">GetBasisFaceIntegrationTransposeSide0</a>();</div>
<div class="line"><a name="l06329"></a><span class="lineno"> 6329</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resSide0 = solIntL;</div>
<div class="line"><a name="l06330"></a><span class="lineno"> 6330</span>&#160; </div>
<div class="line"><a name="l06331"></a><span class="lineno"> 6331</span>&#160;    <span class="comment">/* Call the general function to carry out the matrix product. */</span></div>
<div class="line"><a name="l06332"></a><span class="lineno"> 6332</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFsFace0, NPad, nInt, basisFaceTrans, fluxes, resSide0, config);</div>
<div class="line"><a name="l06333"></a><span class="lineno"> 6333</span>&#160; </div>
<div class="line"><a name="l06334"></a><span class="lineno"> 6334</span>&#160;    <span class="comment">/* Check if the number of DOFs on both sides of the face is different.</span></div>
<div class="line"><a name="l06335"></a><span class="lineno"> 6335</span>&#160;<span class="comment">       In that case also the matrix product with the basis functions on side 1</span></div>
<div class="line"><a name="l06336"></a><span class="lineno"> 6336</span>&#160;<span class="comment">       must be carried out. Use solIntR as a temporary buffer to store</span></div>
<div class="line"><a name="l06337"></a><span class="lineno"> 6337</span>&#160;<span class="comment">       this product. */</span></div>
<div class="line"><a name="l06338"></a><span class="lineno"> 6338</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resSide1 = solIntR;</div>
<div class="line"><a name="l06339"></a><span class="lineno"> 6339</span>&#160;    <span class="keywordflow">if</span>(nDOFsFace1 != nDOFsFace0) {</div>
<div class="line"><a name="l06340"></a><span class="lineno"> 6340</span>&#160;      basisFaceTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a90446ea5444c214ece32dc39dc40a2ae">GetBasisFaceIntegrationTransposeSide1</a>();</div>
<div class="line"><a name="l06341"></a><span class="lineno"> 6341</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFsFace1, NPad, nInt, basisFaceTrans, fluxes, resSide1, config);</div>
<div class="line"><a name="l06342"></a><span class="lineno"> 6342</span>&#160;    }</div>
<div class="line"><a name="l06343"></a><span class="lineno"> 6343</span>&#160; </div>
<div class="line"><a name="l06344"></a><span class="lineno"> 6344</span>&#160;    <span class="comment">/* Loop over the number of faces in this chunk. */</span></div>
<div class="line"><a name="l06345"></a><span class="lineno"> 6345</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l06346"></a><span class="lineno"> 6346</span>&#160; </div>
<div class="line"><a name="l06347"></a><span class="lineno"> 6347</span>&#160;      <span class="comment">/* Set the pointer in the residual array where the residual of side 0</span></div>
<div class="line"><a name="l06348"></a><span class="lineno"> 6348</span>&#160;<span class="comment">         and side 1 of this face must be stored. Update the counter. */</span></div>
<div class="line"><a name="l06349"></a><span class="lineno"> 6349</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFace0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + indResFaces*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06350"></a><span class="lineno"> 6350</span>&#160;      indResFaces        += nDOFsFace0;</div>
<div class="line"><a name="l06351"></a><span class="lineno"> 6351</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFace1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + indResFaces*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06352"></a><span class="lineno"> 6352</span>&#160;      indResFaces        += nDOFsFace1;</div>
<div class="line"><a name="l06353"></a><span class="lineno"> 6353</span>&#160; </div>
<div class="line"><a name="l06354"></a><span class="lineno"> 6354</span>&#160;      <span class="comment">/* Loop over the DOFs and copy the data for side 0. */</span></div>
<div class="line"><a name="l06355"></a><span class="lineno"> 6355</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsFace0; ++i)</div>
<div class="line"><a name="l06356"></a><span class="lineno"> 6356</span>&#160;        memcpy(resFace0+<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i, resSide0+NPad*i+<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*ll, nBytes);</div>
<div class="line"><a name="l06357"></a><span class="lineno"> 6357</span>&#160; </div>
<div class="line"><a name="l06358"></a><span class="lineno"> 6358</span>&#160;      <span class="comment">/* If the number of DOFs on both sides is the same, then the residual</span></div>
<div class="line"><a name="l06359"></a><span class="lineno"> 6359</span>&#160;<span class="comment">         of side 1 is obtained by simply negating the residual of side 0.</span></div>
<div class="line"><a name="l06360"></a><span class="lineno"> 6360</span>&#160;<span class="comment">         Otherwise a copy must be carried out and the residual negated,</span></div>
<div class="line"><a name="l06361"></a><span class="lineno"> 6361</span>&#160;<span class="comment">         because the normal is pointing into the adjacent element for side 1. */</span></div>
<div class="line"><a name="l06362"></a><span class="lineno"> 6362</span>&#160;      <span class="keywordflow">if</span>(nDOFsFace1 == nDOFsFace0) {</div>
<div class="line"><a name="l06363"></a><span class="lineno"> 6363</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*nDOFsFace1); ++i)</div>
<div class="line"><a name="l06364"></a><span class="lineno"> 6364</span>&#160;          resFace1[i] = -resFace0[i];</div>
<div class="line"><a name="l06365"></a><span class="lineno"> 6365</span>&#160;      }</div>
<div class="line"><a name="l06366"></a><span class="lineno"> 6366</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06367"></a><span class="lineno"> 6367</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsFace1; ++i)</div>
<div class="line"><a name="l06368"></a><span class="lineno"> 6368</span>&#160;          memcpy(resFace1+<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i, resSide1+NPad*i+<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*ll, nBytes);</div>
<div class="line"><a name="l06369"></a><span class="lineno"> 6369</span>&#160; </div>
<div class="line"><a name="l06370"></a><span class="lineno"> 6370</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*nDOFsFace1); ++i)</div>
<div class="line"><a name="l06371"></a><span class="lineno"> 6371</span>&#160;        resFace1[i] = -resFace1[i];</div>
<div class="line"><a name="l06372"></a><span class="lineno"> 6372</span>&#160;      }</div>
<div class="line"><a name="l06373"></a><span class="lineno"> 6373</span>&#160;    }</div>
<div class="line"><a name="l06374"></a><span class="lineno"> 6374</span>&#160; </div>
<div class="line"><a name="l06375"></a><span class="lineno"> 6375</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l06376"></a><span class="lineno"> 6376</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l06377"></a><span class="lineno"> 6377</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l06378"></a><span class="lineno"> 6378</span>&#160;  }</div>
<div class="line"><a name="l06379"></a><span class="lineno"> 6379</span>&#160;}</div>
<div class="line"><a name="l06380"></a><span class="lineno"> 6380</span>&#160; </div>
<div class="line"><a name="l06381"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#ab7546cb31b73191bbac2b338c88cfbc4"> 6381</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab7546cb31b73191bbac2b338c88cfbc4">CFEM_DG_EulerSolver::InviscidFluxesInternalMatchingFace</a>(</div>
<div class="line"><a name="l06382"></a><span class="lineno"> 6382</span>&#160;                                              <a class="code" href="class_c_config.html">CConfig</a>              *config,</div>
<div class="line"><a name="l06383"></a><span class="lineno"> 6383</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lBeg,</div>
<div class="line"><a name="l06384"></a><span class="lineno"> 6384</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lEnd,</div>
<div class="line"><a name="l06385"></a><span class="lineno"> 6385</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l06386"></a><span class="lineno"> 6386</span>&#160;                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *solIntL,</div>
<div class="line"><a name="l06387"></a><span class="lineno"> 6387</span>&#160;                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *solIntR,</div>
<div class="line"><a name="l06388"></a><span class="lineno"> 6388</span>&#160;                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *fluxes,</div>
<div class="line"><a name="l06389"></a><span class="lineno"> 6389</span>&#160;                                              <a class="code" href="class_c_numerics.html">CNumerics</a>            *numerics) {</div>
<div class="line"><a name="l06390"></a><span class="lineno"> 6390</span>&#160; </div>
<div class="line"><a name="l06391"></a><span class="lineno"> 6391</span>&#160;  <span class="comment">/* Set the pointer solFace to fluxes. This is just for readability, as the</span></div>
<div class="line"><a name="l06392"></a><span class="lineno"> 6392</span>&#160;<span class="comment">     same memory can be used for the storage of the solution of the DOFs of</span></div>
<div class="line"><a name="l06393"></a><span class="lineno"> 6393</span>&#160;<span class="comment">     the face and the fluxes. */</span></div>
<div class="line"><a name="l06394"></a><span class="lineno"> 6394</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solFace = fluxes;</div>
<div class="line"><a name="l06395"></a><span class="lineno"> 6395</span>&#160; </div>
<div class="line"><a name="l06396"></a><span class="lineno"> 6396</span>&#160;  <span class="comment">/* Number of bytes to be copied in the memcpy calls. */</span></div>
<div class="line"><a name="l06397"></a><span class="lineno"> 6397</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l06398"></a><span class="lineno"> 6398</span>&#160; </div>
<div class="line"><a name="l06399"></a><span class="lineno"> 6399</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06400"></a><span class="lineno"> 6400</span>&#160;  <span class="comment">/*--- Step 1: Interpolate the left state in the integration points of  ---*/</span></div>
<div class="line"><a name="l06401"></a><span class="lineno"> 6401</span>&#160;  <span class="comment">/*---         the face.                                                ---*/</span></div>
<div class="line"><a name="l06402"></a><span class="lineno"> 6402</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06403"></a><span class="lineno"> 6403</span>&#160; </div>
<div class="line"><a name="l06404"></a><span class="lineno"> 6404</span>&#160;  <span class="comment">/* Get the required information from the corresponding standard face,</span></div>
<div class="line"><a name="l06405"></a><span class="lineno"> 6405</span>&#160;<span class="comment">     which is the same for the chunk of faces considered. */</span></div>
<div class="line"><a name="l06406"></a><span class="lineno"> 6406</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[lBeg].<a class="code" href="class_c_internal_face_element_f_e_m.html#a6bd23e7c338057fe4aa5bed22b284323">indStandardElement</a>;</div>
<div class="line"><a name="l06407"></a><span class="lineno"> 6407</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt       = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l06408"></a><span class="lineno"> 6408</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#acd4208ae47226c5917479d6a232b7584">GetNDOFsFaceSide0</a>();</div>
<div class="line"><a name="l06409"></a><span class="lineno"> 6409</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>     *basisFace0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a606c7cbb5727b4c2750c6449f4349492">GetBasisFaceIntegrationSide0</a>();</div>
<div class="line"><a name="l06410"></a><span class="lineno"> 6410</span>&#160; </div>
<div class="line"><a name="l06411"></a><span class="lineno"> 6411</span>&#160;  <span class="comment">/* Determine the number of faces treated simultaneously and define the arrays</span></div>
<div class="line"><a name="l06412"></a><span class="lineno"> 6412</span>&#160;<span class="comment">     of pointers to be used later on in the call to ComputeInviscidFluxesFace. */</span></div>
<div class="line"><a name="l06413"></a><span class="lineno"> 6413</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llEnd = lEnd - lBeg;</div>
<div class="line"><a name="l06414"></a><span class="lineno"> 6414</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>* arrNorm[<a class="code" href="solver__direct__mean__fem_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>];</div>
<div class="line"><a name="l06415"></a><span class="lineno"> 6415</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>* arrGridVel[<a class="code" href="solver__direct__mean__fem_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>];</div>
<div class="line"><a name="l06416"></a><span class="lineno"> 6416</span>&#160; </div>
<div class="line"><a name="l06417"></a><span class="lineno"> 6417</span>&#160;  <span class="keywordflow">if</span>(llEnd &gt; <a class="code" href="solver__direct__mean__fem_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>)</div>
<div class="line"><a name="l06418"></a><span class="lineno"> 6418</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;SIZE_ARR_NORM is too small. Increase it or decrease ALIGNED_BYTES_MATMUL&quot;</span>,</div>
<div class="line"><a name="l06419"></a><span class="lineno"> 6419</span>&#160;                   <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l06420"></a><span class="lineno"> 6420</span>&#160; </div>
<div class="line"><a name="l06421"></a><span class="lineno"> 6421</span>&#160;  <span class="comment">/*--- Loop over the chunk of faces to copy the states in the DOFs</span></div>
<div class="line"><a name="l06422"></a><span class="lineno"> 6422</span>&#160;<span class="comment">        of the faces in the correct sequence. ---*/</span></div>
<div class="line"><a name="l06423"></a><span class="lineno"> 6423</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=lBeg; l&lt;lEnd; ++l) {</div>
<div class="line"><a name="l06424"></a><span class="lineno"> 6424</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll     = l-lBeg;</div>
<div class="line"><a name="l06425"></a><span class="lineno"> 6425</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06426"></a><span class="lineno"> 6426</span>&#160; </div>
<div class="line"><a name="l06427"></a><span class="lineno"> 6427</span>&#160;    <span class="comment">/* Store the pointer to the normal and grid velocity information of this</span></div>
<div class="line"><a name="l06428"></a><span class="lineno"> 6428</span>&#160;<span class="comment">       face. This is used later on in the call to ComputeInviscidFluxesFace. */</span></div>
<div class="line"><a name="l06429"></a><span class="lineno"> 6429</span>&#160;    arrNorm[ll]    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#ad986a0eec8bc2e27e76046f64cec1046">metricNormalsFace</a>.data();</div>
<div class="line"><a name="l06430"></a><span class="lineno"> 6430</span>&#160;    arrGridVel[ll] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#abe02962a6c79e9222e37282d146ad5a2">gridVelocities</a>.data();</div>
<div class="line"><a name="l06431"></a><span class="lineno"> 6431</span>&#160; </div>
<div class="line"><a name="l06432"></a><span class="lineno"> 6432</span>&#160;    <span class="comment">/* Determine the time level of the face. */</span></div>
<div class="line"><a name="l06433"></a><span class="lineno"> 6433</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elem0         = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l06434"></a><span class="lineno"> 6434</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elem1         = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l06435"></a><span class="lineno"> 6435</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevelFace = min(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].timeLevel,</div>
<div class="line"><a name="l06436"></a><span class="lineno"> 6436</span>&#160;                                             <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].timeLevel);</div>
<div class="line"><a name="l06437"></a><span class="lineno"> 6437</span>&#160; </div>
<div class="line"><a name="l06438"></a><span class="lineno"> 6438</span>&#160;    <span class="comment">/* The numbering of the DOFs is given for the entire grid. However, in the</span></div>
<div class="line"><a name="l06439"></a><span class="lineno"> 6439</span>&#160;<span class="comment">       working vectors for the solution a numbering per time level is used.</span></div>
<div class="line"><a name="l06440"></a><span class="lineno"> 6440</span>&#160;<span class="comment">       Therefore an offset must be applied, which can be obtained from the</span></div>
<div class="line"><a name="l06441"></a><span class="lineno"> 6441</span>&#160;<span class="comment">       corresponding volume element. Note that this offset is non-negative</span></div>
<div class="line"><a name="l06442"></a><span class="lineno"> 6442</span>&#160;<span class="comment">       and depends whether or not the element belongs to the same time</span></div>
<div class="line"><a name="l06443"></a><span class="lineno"> 6443</span>&#160;<span class="comment">       level as the face. */</span></div>
<div class="line"><a name="l06444"></a><span class="lineno"> 6444</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset;</div>
<div class="line"><a name="l06445"></a><span class="lineno"> 6445</span>&#160;    <span class="keywordflow">if</span>(timeLevelFace == <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].timeLevel)</div>
<div class="line"><a name="l06446"></a><span class="lineno"> 6446</span>&#160;      offset = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l06447"></a><span class="lineno"> 6447</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06448"></a><span class="lineno"> 6448</span>&#160;      offset = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].<a class="code" href="class_c_volume_element_f_e_m.html#aca2a1ae12ad274b8c2494ffb69bd73f1">offsetDOFsSolPrevTimeLevel</a>;</div>
<div class="line"><a name="l06449"></a><span class="lineno"> 6449</span>&#160; </div>
<div class="line"><a name="l06450"></a><span class="lineno"> 6450</span>&#160;    <span class="comment">/*--- Store the solution of the DOFs of side 0 of the face in contiguous</span></div>
<div class="line"><a name="l06451"></a><span class="lineno"> 6451</span>&#160;<span class="comment">          memory, such that the function blasFunctions-&gt;gemm can be used to</span></div>
<div class="line"><a name="l06452"></a><span class="lineno"> 6452</span>&#160;<span class="comment">          compute the left states in the integration points. ---*/</span></div>
<div class="line"><a name="l06453"></a><span class="lineno"> 6453</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFs = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#af43fe79ecbba91bb155dc13f7dfa8140">DOFsSolFaceSide0</a>.data();</div>
<div class="line"><a name="l06454"></a><span class="lineno"> 6454</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsFace0; ++i) {</div>
<div class="line"><a name="l06455"></a><span class="lineno"> 6455</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevelFace].data()</div>
<div class="line"><a name="l06456"></a><span class="lineno"> 6456</span>&#160;                              + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(DOFs[i] - offset);</div>
<div class="line"><a name="l06457"></a><span class="lineno"> 6457</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *sol    = solFace + NPad*i + llNVar;</div>
<div class="line"><a name="l06458"></a><span class="lineno"> 6458</span>&#160;      memcpy(sol, solDOF, nBytes);</div>
<div class="line"><a name="l06459"></a><span class="lineno"> 6459</span>&#160;    }</div>
<div class="line"><a name="l06460"></a><span class="lineno"> 6460</span>&#160;  }</div>
<div class="line"><a name="l06461"></a><span class="lineno"> 6461</span>&#160; </div>
<div class="line"><a name="l06462"></a><span class="lineno"> 6462</span>&#160;  <span class="comment">/* Compute the left states. Call the general function to</span></div>
<div class="line"><a name="l06463"></a><span class="lineno"> 6463</span>&#160;<span class="comment">     carry out the matrix product. */</span></div>
<div class="line"><a name="l06464"></a><span class="lineno"> 6464</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt, NPad, nDOFsFace0, basisFace0, solFace, solIntL, config);</div>
<div class="line"><a name="l06465"></a><span class="lineno"> 6465</span>&#160; </div>
<div class="line"><a name="l06466"></a><span class="lineno"> 6466</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06467"></a><span class="lineno"> 6467</span>&#160;  <span class="comment">/*--- Step 2: Interpolate the right state in the integration points of ---*/</span></div>
<div class="line"><a name="l06468"></a><span class="lineno"> 6468</span>&#160;  <span class="comment">/*---         the face.                                                ---*/</span></div>
<div class="line"><a name="l06469"></a><span class="lineno"> 6469</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06470"></a><span class="lineno"> 6470</span>&#160; </div>
<div class="line"><a name="l06471"></a><span class="lineno"> 6471</span>&#160;  <span class="comment">/* Get the required information from the corresponding standard face,</span></div>
<div class="line"><a name="l06472"></a><span class="lineno"> 6472</span>&#160;<span class="comment">     which is the same for the chunk of faces considered. */</span></div>
<div class="line"><a name="l06473"></a><span class="lineno"> 6473</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a0e3ff97b8c11ca92ede562565eec7041">GetNDOFsFaceSide1</a>();</div>
<div class="line"><a name="l06474"></a><span class="lineno"> 6474</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>     *basisFace1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a8c3ca9c06c4b57b2a946cb0a32be0e1e">GetBasisFaceIntegrationSide1</a>();</div>
<div class="line"><a name="l06475"></a><span class="lineno"> 6475</span>&#160; </div>
<div class="line"><a name="l06476"></a><span class="lineno"> 6476</span>&#160;  <span class="comment">/*--- Loop over the chunk of elements to copy the states in the DOFs</span></div>
<div class="line"><a name="l06477"></a><span class="lineno"> 6477</span>&#160;<span class="comment">        of the faces in the correct sequence. ---*/</span></div>
<div class="line"><a name="l06478"></a><span class="lineno"> 6478</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=lBeg; l&lt;lEnd; ++l) {</div>
<div class="line"><a name="l06479"></a><span class="lineno"> 6479</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll     = l-lBeg;</div>
<div class="line"><a name="l06480"></a><span class="lineno"> 6480</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06481"></a><span class="lineno"> 6481</span>&#160; </div>
<div class="line"><a name="l06482"></a><span class="lineno"> 6482</span>&#160;    <span class="comment">/* Determine the time level of the face. */</span></div>
<div class="line"><a name="l06483"></a><span class="lineno"> 6483</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elem0         = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l06484"></a><span class="lineno"> 6484</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elem1         = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l06485"></a><span class="lineno"> 6485</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevelFace = min(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem0].timeLevel,</div>
<div class="line"><a name="l06486"></a><span class="lineno"> 6486</span>&#160;                                             <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].timeLevel);</div>
<div class="line"><a name="l06487"></a><span class="lineno"> 6487</span>&#160; </div>
<div class="line"><a name="l06488"></a><span class="lineno"> 6488</span>&#160;    <span class="comment">/* Determine the offset between the numbering used in the DOFs of the face</span></div>
<div class="line"><a name="l06489"></a><span class="lineno"> 6489</span>&#160;<span class="comment">       and the numbering used in the working solution vectors, see above for a</span></div>
<div class="line"><a name="l06490"></a><span class="lineno"> 6490</span>&#160;<span class="comment">       more detailed explanation. */</span></div>
<div class="line"><a name="l06491"></a><span class="lineno"> 6491</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset;</div>
<div class="line"><a name="l06492"></a><span class="lineno"> 6492</span>&#160;    <span class="keywordflow">if</span>(timeLevelFace == <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].timeLevel)</div>
<div class="line"><a name="l06493"></a><span class="lineno"> 6493</span>&#160;      offset = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l06494"></a><span class="lineno"> 6494</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l06495"></a><span class="lineno"> 6495</span>&#160;      offset = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elem1].<a class="code" href="class_c_volume_element_f_e_m.html#aca2a1ae12ad274b8c2494ffb69bd73f1">offsetDOFsSolPrevTimeLevel</a>;</div>
<div class="line"><a name="l06496"></a><span class="lineno"> 6496</span>&#160; </div>
<div class="line"><a name="l06497"></a><span class="lineno"> 6497</span>&#160;    <span class="comment">/*--- Store the solution of the DOFs of side 1 of the face in contiguous</span></div>
<div class="line"><a name="l06498"></a><span class="lineno"> 6498</span>&#160;<span class="comment">          memory, such that the function blasFunctions-&gt;gemm can be used to</span></div>
<div class="line"><a name="l06499"></a><span class="lineno"> 6499</span>&#160;<span class="comment">          compute the left states in the integration points. ---*/</span></div>
<div class="line"><a name="l06500"></a><span class="lineno"> 6500</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFs = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[l].<a class="code" href="class_c_internal_face_element_f_e_m.html#ab2262d6fc255298ba8ac9f9c0685173c">DOFsSolFaceSide1</a>.data();</div>
<div class="line"><a name="l06501"></a><span class="lineno"> 6501</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsFace1; ++i) {</div>
<div class="line"><a name="l06502"></a><span class="lineno"> 6502</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevelFace].data()</div>
<div class="line"><a name="l06503"></a><span class="lineno"> 6503</span>&#160;                              + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(DOFs[i] - offset);</div>
<div class="line"><a name="l06504"></a><span class="lineno"> 6504</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *sol    = solFace + NPad*i + llNVar;</div>
<div class="line"><a name="l06505"></a><span class="lineno"> 6505</span>&#160;      memcpy(sol, solDOF, nBytes);</div>
<div class="line"><a name="l06506"></a><span class="lineno"> 6506</span>&#160;    }</div>
<div class="line"><a name="l06507"></a><span class="lineno"> 6507</span>&#160;  }</div>
<div class="line"><a name="l06508"></a><span class="lineno"> 6508</span>&#160; </div>
<div class="line"><a name="l06509"></a><span class="lineno"> 6509</span>&#160;  <span class="comment">/* Compute the right states. Call the general function to</span></div>
<div class="line"><a name="l06510"></a><span class="lineno"> 6510</span>&#160;<span class="comment">     carry out the matrix product. */</span></div>
<div class="line"><a name="l06511"></a><span class="lineno"> 6511</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt, NPad, nDOFsFace1, basisFace1, solFace, solIntR, config);</div>
<div class="line"><a name="l06512"></a><span class="lineno"> 6512</span>&#160; </div>
<div class="line"><a name="l06513"></a><span class="lineno"> 6513</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06514"></a><span class="lineno"> 6514</span>&#160;  <span class="comment">/*--- Step 3: Compute the fluxes in the integration points using the   ---*/</span></div>
<div class="line"><a name="l06515"></a><span class="lineno"> 6515</span>&#160;  <span class="comment">/*---         approximate Riemann solver.                              ---*/</span></div>
<div class="line"><a name="l06516"></a><span class="lineno"> 6516</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06517"></a><span class="lineno"> 6517</span>&#160; </div>
<div class="line"><a name="l06518"></a><span class="lineno"> 6518</span>&#160;  <span class="comment">/* General function to compute the fluxes in the integration points</span></div>
<div class="line"><a name="l06519"></a><span class="lineno"> 6519</span>&#160;<span class="comment">     of the faces. */</span></div>
<div class="line"><a name="l06520"></a><span class="lineno"> 6520</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4851d39829e12202592d85c36ea36489">ComputeInviscidFluxesFace</a>(config, llEnd, NPad, nInt, arrNorm, arrGridVel,</div>
<div class="line"><a name="l06521"></a><span class="lineno"> 6521</span>&#160;                            solIntL, solIntR, fluxes, numerics);</div>
<div class="line"><a name="l06522"></a><span class="lineno"> 6522</span>&#160;}</div>
<div class="line"><a name="l06523"></a><span class="lineno"> 6523</span>&#160; </div>
<div class="line"><a name="l06524"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a0a18dfd035e17379824d2a3a032d3ab3"> 6524</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0a18dfd035e17379824d2a3a032d3ab3">CFEM_DG_EulerSolver::AccumulateSpaceTimeResidualADEROwnedElem</a>(</div>
<div class="line"><a name="l06525"></a><span class="lineno"> 6525</span>&#160;                                                     <a class="code" href="class_c_config.html">CConfig</a>             *config,</div>
<div class="line"><a name="l06526"></a><span class="lineno"> 6526</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel,</div>
<div class="line"><a name="l06527"></a><span class="lineno"> 6527</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> intPoint) {</div>
<div class="line"><a name="l06528"></a><span class="lineno"> 6528</span>&#160; </div>
<div class="line"><a name="l06529"></a><span class="lineno"> 6529</span>&#160;  <span class="comment">/* Compute half the integration weight. The reason for doing this is that the</span></div>
<div class="line"><a name="l06530"></a><span class="lineno"> 6530</span>&#160;<span class="comment">     given integration weight is based on the normalized interval [-1..1], i.e.</span></div>
<div class="line"><a name="l06531"></a><span class="lineno"> 6531</span>&#160;<span class="comment">     a length of two. Also compute a quarter of the weight, which is necessary</span></div>
<div class="line"><a name="l06532"></a><span class="lineno"> 6532</span>&#160;<span class="comment">     to accumulate the face residuals of the DOFs of elements adjacent to</span></div>
<div class="line"><a name="l06533"></a><span class="lineno"> 6533</span>&#160;<span class="comment">     element of a lower time level. */</span></div>
<div class="line"><a name="l06534"></a><span class="lineno"> 6534</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *timeIntegrationWeights = config-&gt;<a class="code" href="class_c_config.html#ab61a5a25dc9a2d37c22d4744d26b690d">GetWeightsIntegrationADER_DG</a>();</div>
<div class="line"><a name="l06535"></a><span class="lineno"> 6535</span>&#160; </div>
<div class="line"><a name="l06536"></a><span class="lineno"> 6536</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> halfWeight  = 0.5 *timeIntegrationWeights[intPoint];</div>
<div class="line"><a name="l06537"></a><span class="lineno"> 6537</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> quartWeight = 0.25*timeIntegrationWeights[intPoint];</div>
<div class="line"><a name="l06538"></a><span class="lineno"> 6538</span>&#160; </div>
<div class="line"><a name="l06539"></a><span class="lineno"> 6539</span>&#160;  <span class="comment">/* Determine the owned element range that must be considered. */</span></div>
<div class="line"><a name="l06540"></a><span class="lineno"> 6540</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBegOwned = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[timeLevel];</div>
<div class="line"><a name="l06541"></a><span class="lineno"> 6541</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEndOwned = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[timeLevel+1];</div>
<div class="line"><a name="l06542"></a><span class="lineno"> 6542</span>&#160; </div>
<div class="line"><a name="l06543"></a><span class="lineno"> 6543</span>&#160;  <span class="comment">/* Add the residuals coming from the volume integral to VecTotResDOFsADER. */</span></div>
<div class="line"><a name="l06544"></a><span class="lineno"> 6544</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBegOwned; l&lt;elemEndOwned; ++l) {</div>
<div class="line"><a name="l06545"></a><span class="lineno"> 6545</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset  = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l06546"></a><span class="lineno"> 6546</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>    *res     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.data() + offset;</div>
<div class="line"><a name="l06547"></a><span class="lineno"> 6547</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *resADER = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">VecTotResDOFsADER</a>.data() + offset;</div>
<div class="line"><a name="l06548"></a><span class="lineno"> 6548</span>&#160; </div>
<div class="line"><a name="l06549"></a><span class="lineno"> 6549</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>); ++i)</div>
<div class="line"><a name="l06550"></a><span class="lineno"> 6550</span>&#160;      resADER[i] += halfWeight*res[i];</div>
<div class="line"><a name="l06551"></a><span class="lineno"> 6551</span>&#160;  }</div>
<div class="line"><a name="l06552"></a><span class="lineno"> 6552</span>&#160; </div>
<div class="line"><a name="l06553"></a><span class="lineno"> 6553</span>&#160;  <span class="comment">/* Add the residuals coming from the surface integral to VecTotResDOFsADER.</span></div>
<div class="line"><a name="l06554"></a><span class="lineno"> 6554</span>&#160;<span class="comment">     This part is from faces with the same time level as the element. */</span></div>
<div class="line"><a name="l06555"></a><span class="lineno"> 6555</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBegOwned; l&lt;elemEndOwned; ++l) {</div>
<div class="line"><a name="l06556"></a><span class="lineno"> 6556</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++i) {</div>
<div class="line"><a name="l06557"></a><span class="lineno"> 6557</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i;</div>
<div class="line"><a name="l06558"></a><span class="lineno"> 6558</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resADER = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">VecTotResDOFsADER</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*ii;</div>
<div class="line"><a name="l06559"></a><span class="lineno"> 6559</span>&#160; </div>
<div class="line"><a name="l06560"></a><span class="lineno"> 6560</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[ii]; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[ii+1]; ++j) {</div>
<div class="line"><a name="l06561"></a><span class="lineno"> 6561</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a85ca865434583283c6fa8da85f635b74">entriesResFaces</a>[j];</div>
<div class="line"><a name="l06562"></a><span class="lineno"> 6562</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++k)</div>
<div class="line"><a name="l06563"></a><span class="lineno"> 6563</span>&#160;          resADER[k] += halfWeight*resFace[k];</div>
<div class="line"><a name="l06564"></a><span class="lineno"> 6564</span>&#160;      }</div>
<div class="line"><a name="l06565"></a><span class="lineno"> 6565</span>&#160;    }</div>
<div class="line"><a name="l06566"></a><span class="lineno"> 6566</span>&#160;  }</div>
<div class="line"><a name="l06567"></a><span class="lineno"> 6567</span>&#160; </div>
<div class="line"><a name="l06568"></a><span class="lineno"> 6568</span>&#160;  <span class="comment">/* Check if this is not the last time level. */</span></div>
<div class="line"><a name="l06569"></a><span class="lineno"> 6569</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeLevels = config-&gt;<a class="code" href="class_c_config.html#a957e791919e7c6947131c06aedc7ff8d">GetnLevels_TimeAccurateLTS</a>();</div>
<div class="line"><a name="l06570"></a><span class="lineno"> 6570</span>&#160;  <span class="keywordflow">if</span>(timeLevel &lt; (nTimeLevels-1)) {</div>
<div class="line"><a name="l06571"></a><span class="lineno"> 6571</span>&#160; </div>
<div class="line"><a name="l06572"></a><span class="lineno"> 6572</span>&#160;    <span class="comment">/* There may exist faces of this time level, which have a neighboring</span></div>
<div class="line"><a name="l06573"></a><span class="lineno"> 6573</span>&#160;<span class="comment">       element of the next time level. The residuals of the DOFs of such</span></div>
<div class="line"><a name="l06574"></a><span class="lineno"> 6574</span>&#160;<span class="comment">       elements must be updated with the face residuals of the current</span></div>
<div class="line"><a name="l06575"></a><span class="lineno"> 6575</span>&#160;<span class="comment">       time level. However, on these elements the time step is twice as</span></div>
<div class="line"><a name="l06576"></a><span class="lineno"> 6576</span>&#160;<span class="comment">       large. This is taken into account by multiplying the face residual</span></div>
<div class="line"><a name="l06577"></a><span class="lineno"> 6577</span>&#160;<span class="comment">       with quartWeight when accumulating. */</span></div>
<div class="line"><a name="l06578"></a><span class="lineno"> 6578</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nAdjElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad1f55a7f9d7d977e9dbae3182131673f">ownedElemAdjLowTimeLevel</a>[timeLevel+1].size();</div>
<div class="line"><a name="l06579"></a><span class="lineno"> 6579</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *adjElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad1f55a7f9d7d977e9dbae3182131673f">ownedElemAdjLowTimeLevel</a>[timeLevel+1].data();</div>
<div class="line"><a name="l06580"></a><span class="lineno"> 6580</span>&#160; </div>
<div class="line"><a name="l06581"></a><span class="lineno"> 6581</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0; l&lt;nAdjElem; ++l) {</div>
<div class="line"><a name="l06582"></a><span class="lineno"> 6582</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll = adjElem[l];</div>
<div class="line"><a name="l06583"></a><span class="lineno"> 6583</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ll].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++i) {</div>
<div class="line"><a name="l06584"></a><span class="lineno"> 6584</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ll].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i;</div>
<div class="line"><a name="l06585"></a><span class="lineno"> 6585</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resADER = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">VecTotResDOFsADER</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*ii;</div>
<div class="line"><a name="l06586"></a><span class="lineno"> 6586</span>&#160; </div>
<div class="line"><a name="l06587"></a><span class="lineno"> 6587</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>[ii]; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>[ii+1]; ++j) {</div>
<div class="line"><a name="l06588"></a><span class="lineno"> 6588</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a114589ab188875a99b7879c4099eb757">entriesResAdjFaces</a>[j];</div>
<div class="line"><a name="l06589"></a><span class="lineno"> 6589</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++k)</div>
<div class="line"><a name="l06590"></a><span class="lineno"> 6590</span>&#160;            resADER[k] += quartWeight*resFace[k];</div>
<div class="line"><a name="l06591"></a><span class="lineno"> 6591</span>&#160;        }</div>
<div class="line"><a name="l06592"></a><span class="lineno"> 6592</span>&#160;      }</div>
<div class="line"><a name="l06593"></a><span class="lineno"> 6593</span>&#160;    }</div>
<div class="line"><a name="l06594"></a><span class="lineno"> 6594</span>&#160;  }</div>
<div class="line"><a name="l06595"></a><span class="lineno"> 6595</span>&#160;}</div>
<div class="line"><a name="l06596"></a><span class="lineno"> 6596</span>&#160; </div>
<div class="line"><a name="l06597"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#ad69d3dd7fafb9203abbc9e876cbcd7a8"> 6597</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad69d3dd7fafb9203abbc9e876cbcd7a8">CFEM_DG_EulerSolver::AccumulateSpaceTimeResidualADERHaloElem</a>(</div>
<div class="line"><a name="l06598"></a><span class="lineno"> 6598</span>&#160;                                                     <a class="code" href="class_c_config.html">CConfig</a>             *config,</div>
<div class="line"><a name="l06599"></a><span class="lineno"> 6599</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel,</div>
<div class="line"><a name="l06600"></a><span class="lineno"> 6600</span>&#160;                                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> intPoint) {</div>
<div class="line"><a name="l06601"></a><span class="lineno"> 6601</span>&#160; </div>
<div class="line"><a name="l06602"></a><span class="lineno"> 6602</span>&#160;  <span class="comment">/* Compute half the integration weight. The reason for doing this is that the</span></div>
<div class="line"><a name="l06603"></a><span class="lineno"> 6603</span>&#160;<span class="comment">     given integration weight is based on the normalized interval [-1..1], i.e.</span></div>
<div class="line"><a name="l06604"></a><span class="lineno"> 6604</span>&#160;<span class="comment">     a length of two. Also compute a quarter of the weight, which is necessary</span></div>
<div class="line"><a name="l06605"></a><span class="lineno"> 6605</span>&#160;<span class="comment">     to accumulate the face residuals of the DOFs of elements adjacent to</span></div>
<div class="line"><a name="l06606"></a><span class="lineno"> 6606</span>&#160;<span class="comment">     element of a lower time level. */</span></div>
<div class="line"><a name="l06607"></a><span class="lineno"> 6607</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *timeIntegrationWeights = config-&gt;<a class="code" href="class_c_config.html#ab61a5a25dc9a2d37c22d4744d26b690d">GetWeightsIntegrationADER_DG</a>();</div>
<div class="line"><a name="l06608"></a><span class="lineno"> 6608</span>&#160; </div>
<div class="line"><a name="l06609"></a><span class="lineno"> 6609</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> halfWeight  = 0.5 *timeIntegrationWeights[intPoint];</div>
<div class="line"><a name="l06610"></a><span class="lineno"> 6610</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> quartWeight = 0.25*timeIntegrationWeights[intPoint];</div>
<div class="line"><a name="l06611"></a><span class="lineno"> 6611</span>&#160; </div>
<div class="line"><a name="l06612"></a><span class="lineno"> 6612</span>&#160;  <span class="comment">/* Determine the halo element range that must be considered. */</span></div>
<div class="line"><a name="l06613"></a><span class="lineno"> 6613</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBegHalo = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[timeLevel];</div>
<div class="line"><a name="l06614"></a><span class="lineno"> 6614</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEndHalo = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[timeLevel+1];</div>
<div class="line"><a name="l06615"></a><span class="lineno"> 6615</span>&#160; </div>
<div class="line"><a name="l06616"></a><span class="lineno"> 6616</span>&#160;  <span class="comment">/* Add the residuals coming from the surface integral to VecTotResDOFsADER.</span></div>
<div class="line"><a name="l06617"></a><span class="lineno"> 6617</span>&#160;<span class="comment">     This part is from faces with the same time level as the element. */</span></div>
<div class="line"><a name="l06618"></a><span class="lineno"> 6618</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBegHalo; l&lt;elemEndHalo; ++l) {</div>
<div class="line"><a name="l06619"></a><span class="lineno"> 6619</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++i) {</div>
<div class="line"><a name="l06620"></a><span class="lineno"> 6620</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i;</div>
<div class="line"><a name="l06621"></a><span class="lineno"> 6621</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resADER = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">VecTotResDOFsADER</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*ii;</div>
<div class="line"><a name="l06622"></a><span class="lineno"> 6622</span>&#160; </div>
<div class="line"><a name="l06623"></a><span class="lineno"> 6623</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[ii]; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[ii+1]; ++j) {</div>
<div class="line"><a name="l06624"></a><span class="lineno"> 6624</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a85ca865434583283c6fa8da85f635b74">entriesResFaces</a>[j];</div>
<div class="line"><a name="l06625"></a><span class="lineno"> 6625</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++k)</div>
<div class="line"><a name="l06626"></a><span class="lineno"> 6626</span>&#160;          resADER[k] += halfWeight*resFace[k];</div>
<div class="line"><a name="l06627"></a><span class="lineno"> 6627</span>&#160;      }</div>
<div class="line"><a name="l06628"></a><span class="lineno"> 6628</span>&#160;    }</div>
<div class="line"><a name="l06629"></a><span class="lineno"> 6629</span>&#160;  }</div>
<div class="line"><a name="l06630"></a><span class="lineno"> 6630</span>&#160; </div>
<div class="line"><a name="l06631"></a><span class="lineno"> 6631</span>&#160;  <span class="comment">/* Check if this is not the last time level. */</span></div>
<div class="line"><a name="l06632"></a><span class="lineno"> 6632</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nTimeLevels = config-&gt;<a class="code" href="class_c_config.html#a957e791919e7c6947131c06aedc7ff8d">GetnLevels_TimeAccurateLTS</a>();</div>
<div class="line"><a name="l06633"></a><span class="lineno"> 6633</span>&#160;  <span class="keywordflow">if</span>(timeLevel &lt; (nTimeLevels-1)) {</div>
<div class="line"><a name="l06634"></a><span class="lineno"> 6634</span>&#160; </div>
<div class="line"><a name="l06635"></a><span class="lineno"> 6635</span>&#160;    <span class="comment">/* There may exist faces of this time level, which have a neighboring</span></div>
<div class="line"><a name="l06636"></a><span class="lineno"> 6636</span>&#160;<span class="comment">       element of the next time level. The residuals of the DOFs of such</span></div>
<div class="line"><a name="l06637"></a><span class="lineno"> 6637</span>&#160;<span class="comment">       elements must be updated with the face residuals of the current</span></div>
<div class="line"><a name="l06638"></a><span class="lineno"> 6638</span>&#160;<span class="comment">       time level. However, on these elements the time step is twice as</span></div>
<div class="line"><a name="l06639"></a><span class="lineno"> 6639</span>&#160;<span class="comment">       large. This is taken into account by multiplying the face residual</span></div>
<div class="line"><a name="l06640"></a><span class="lineno"> 6640</span>&#160;<span class="comment">       with quartWeight when accumulating. */</span></div>
<div class="line"><a name="l06641"></a><span class="lineno"> 6641</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nAdjElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4856180300943d0a34620292be9fb44c">haloElemAdjLowTimeLevel</a>[timeLevel+1].size();</div>
<div class="line"><a name="l06642"></a><span class="lineno"> 6642</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *adjElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4856180300943d0a34620292be9fb44c">haloElemAdjLowTimeLevel</a>[timeLevel+1].data();</div>
<div class="line"><a name="l06643"></a><span class="lineno"> 6643</span>&#160; </div>
<div class="line"><a name="l06644"></a><span class="lineno"> 6644</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l=0; l&lt;nAdjElem; ++l) {</div>
<div class="line"><a name="l06645"></a><span class="lineno"> 6645</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll = adjElem[l];</div>
<div class="line"><a name="l06646"></a><span class="lineno"> 6646</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ll].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++i) {</div>
<div class="line"><a name="l06647"></a><span class="lineno"> 6647</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[ll].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i;</div>
<div class="line"><a name="l06648"></a><span class="lineno"> 6648</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resADER = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">VecTotResDOFsADER</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*ii;</div>
<div class="line"><a name="l06649"></a><span class="lineno"> 6649</span>&#160; </div>
<div class="line"><a name="l06650"></a><span class="lineno"> 6650</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>[ii]; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">nEntriesResAdjFaces</a>[ii+1]; ++j) {</div>
<div class="line"><a name="l06651"></a><span class="lineno"> 6651</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a114589ab188875a99b7879c4099eb757">entriesResAdjFaces</a>[j];</div>
<div class="line"><a name="l06652"></a><span class="lineno"> 6652</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++k)</div>
<div class="line"><a name="l06653"></a><span class="lineno"> 6653</span>&#160;            resADER[k] += quartWeight*resFace[k];</div>
<div class="line"><a name="l06654"></a><span class="lineno"> 6654</span>&#160;        }</div>
<div class="line"><a name="l06655"></a><span class="lineno"> 6655</span>&#160;      }</div>
<div class="line"><a name="l06656"></a><span class="lineno"> 6656</span>&#160;    }</div>
<div class="line"><a name="l06657"></a><span class="lineno"> 6657</span>&#160;  }</div>
<div class="line"><a name="l06658"></a><span class="lineno"> 6658</span>&#160;}</div>
<div class="line"><a name="l06659"></a><span class="lineno"> 6659</span>&#160; </div>
<div class="line"><a name="l06660"></a><span class="lineno"> 6660</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::CreateFinalResidual(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel,</div>
<div class="line"><a name="l06661"></a><span class="lineno"> 6661</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">bool</span> ownedElements) {</div>
<div class="line"><a name="l06662"></a><span class="lineno"> 6662</span>&#160; </div>
<div class="line"><a name="l06663"></a><span class="lineno"> 6663</span>&#160;  <span class="comment">/* Determine the element range for which the final residual must</span></div>
<div class="line"><a name="l06664"></a><span class="lineno"> 6664</span>&#160;<span class="comment">     be created. */</span></div>
<div class="line"><a name="l06665"></a><span class="lineno"> 6665</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemStart, elemEnd;</div>
<div class="line"><a name="l06666"></a><span class="lineno"> 6666</span>&#160;  <span class="keywordflow">if</span>( ownedElements ) {</div>
<div class="line"><a name="l06667"></a><span class="lineno"> 6667</span>&#160;    elemStart = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[0];</div>
<div class="line"><a name="l06668"></a><span class="lineno"> 6668</span>&#160;    elemEnd   = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">nVolElemOwnedPerTimeLevel</a>[timeLevel+1];</div>
<div class="line"><a name="l06669"></a><span class="lineno"> 6669</span>&#160;  }</div>
<div class="line"><a name="l06670"></a><span class="lineno"> 6670</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06671"></a><span class="lineno"> 6671</span>&#160;    elemStart = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[0];</div>
<div class="line"><a name="l06672"></a><span class="lineno"> 6672</span>&#160;    elemEnd   = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">nVolElemHaloPerTimeLevel</a>[timeLevel+1];</div>
<div class="line"><a name="l06673"></a><span class="lineno"> 6673</span>&#160;  }</div>
<div class="line"><a name="l06674"></a><span class="lineno"> 6674</span>&#160; </div>
<div class="line"><a name="l06675"></a><span class="lineno"> 6675</span>&#160;  <span class="comment">/* For the halo elements the residual is initialized to zero. */</span></div>
<div class="line"><a name="l06676"></a><span class="lineno"> 6676</span>&#160;  <span class="keywordflow">if</span>( !ownedElements ) {</div>
<div class="line"><a name="l06677"></a><span class="lineno"> 6677</span>&#160; </div>
<div class="line"><a name="l06678"></a><span class="lineno"> 6678</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemStart; l&lt;elemEnd; ++l) {</div>
<div class="line"><a name="l06679"></a><span class="lineno"> 6679</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resDOFsElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l06680"></a><span class="lineno"> 6680</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>); ++i)</div>
<div class="line"><a name="l06681"></a><span class="lineno"> 6681</span>&#160;        resDOFsElem[i] = 0.0;</div>
<div class="line"><a name="l06682"></a><span class="lineno"> 6682</span>&#160;    }</div>
<div class="line"><a name="l06683"></a><span class="lineno"> 6683</span>&#160;  }</div>
<div class="line"><a name="l06684"></a><span class="lineno"> 6684</span>&#160; </div>
<div class="line"><a name="l06685"></a><span class="lineno"> 6685</span>&#160;  <span class="comment">/* Loop over the required element range. */</span></div>
<div class="line"><a name="l06686"></a><span class="lineno"> 6686</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemStart; l&lt;elemEnd; ++l) {</div>
<div class="line"><a name="l06687"></a><span class="lineno"> 6687</span>&#160; </div>
<div class="line"><a name="l06688"></a><span class="lineno"> 6688</span>&#160;    <span class="comment">/* Loop over the DOFs of this element. */</span></div>
<div class="line"><a name="l06689"></a><span class="lineno"> 6689</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].offsetDOFsSolLocal;</div>
<div class="line"><a name="l06690"></a><span class="lineno"> 6690</span>&#160;                      i&lt;(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>+<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>); ++i) {</div>
<div class="line"><a name="l06691"></a><span class="lineno"> 6691</span>&#160; </div>
<div class="line"><a name="l06692"></a><span class="lineno"> 6692</span>&#160;      <span class="comment">/* Create the final residual by summing up all contributions. */</span></div>
<div class="line"><a name="l06693"></a><span class="lineno"> 6693</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i;</div>
<div class="line"><a name="l06694"></a><span class="lineno"> 6694</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[i]; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">nEntriesResFaces</a>[i+1]; ++j) {</div>
<div class="line"><a name="l06695"></a><span class="lineno"> 6695</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a85ca865434583283c6fa8da85f635b74">entriesResFaces</a>[j];</div>
<div class="line"><a name="l06696"></a><span class="lineno"> 6696</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++k)</div>
<div class="line"><a name="l06697"></a><span class="lineno"> 6697</span>&#160;          resDOF[k] += resFace[k];</div>
<div class="line"><a name="l06698"></a><span class="lineno"> 6698</span>&#160;      }</div>
<div class="line"><a name="l06699"></a><span class="lineno"> 6699</span>&#160;    }</div>
<div class="line"><a name="l06700"></a><span class="lineno"> 6700</span>&#160;  }</div>
<div class="line"><a name="l06701"></a><span class="lineno"> 6701</span>&#160;}</div>
<div class="line"><a name="l06702"></a><span class="lineno"> 6702</span>&#160; </div>
<div class="line"><a name="l06703"></a><span class="lineno"> 6703</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::MultiplyResidualByInverseMassMatrix(</div>
<div class="line"><a name="l06704"></a><span class="lineno"> 6704</span>&#160;                                              <a class="code" href="class_c_config.html">CConfig</a>            *config,</div>
<div class="line"><a name="l06705"></a><span class="lineno"> 6705</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">bool</span>          useADER,</div>
<div class="line"><a name="l06706"></a><span class="lineno"> 6706</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg,</div>
<div class="line"><a name="l06707"></a><span class="lineno"> 6707</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd,</div>
<div class="line"><a name="l06708"></a><span class="lineno"> 6708</span>&#160;                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>           *workArray) {</div>
<div class="line"><a name="l06709"></a><span class="lineno"> 6709</span>&#160; </div>
<div class="line"><a name="l06710"></a><span class="lineno"> 6710</span>&#160;  <span class="comment">/*--- Set the reference to the correct residual. This depends</span></div>
<div class="line"><a name="l06711"></a><span class="lineno"> 6711</span>&#160;<span class="comment">        whether or not the ADER scheme is used. ---*/</span></div>
<div class="line"><a name="l06712"></a><span class="lineno"> 6712</span>&#160;  vector&lt;su2double&gt; &amp;VecRes = useADER ? <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">VecTotResDOFsADER</a> : <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>;</div>
<div class="line"><a name="l06713"></a><span class="lineno"> 6713</span>&#160; </div>
<div class="line"><a name="l06714"></a><span class="lineno"> 6714</span>&#160;  <span class="comment">/* Loop over the owned volume elements. */</span></div>
<div class="line"><a name="l06715"></a><span class="lineno"> 6715</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBeg; l&lt;elemEnd; ++l) {</div>
<div class="line"><a name="l06716"></a><span class="lineno"> 6716</span>&#160; </div>
<div class="line"><a name="l06717"></a><span class="lineno"> 6717</span>&#160;    <span class="comment">/* Easier storage of the residuals for this volume element. */</span></div>
<div class="line"><a name="l06718"></a><span class="lineno"> 6718</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *res = VecRes.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l06719"></a><span class="lineno"> 6719</span>&#160; </div>
<div class="line"><a name="l06720"></a><span class="lineno"> 6720</span>&#160;    <span class="comment">/* Check whether a multiplication must be carried out with the inverse of</span></div>
<div class="line"><a name="l06721"></a><span class="lineno"> 6721</span>&#160;<span class="comment">       the lumped mass matrix or the full mass matrix. Note that it is crucial</span></div>
<div class="line"><a name="l06722"></a><span class="lineno"> 6722</span>&#160;<span class="comment">       that the test is performed with the lumpedMassMatrix and not with</span></div>
<div class="line"><a name="l06723"></a><span class="lineno"> 6723</span>&#160;<span class="comment">       massMatrix. The reason is that for implicit time stepping schemes</span></div>
<div class="line"><a name="l06724"></a><span class="lineno"> 6724</span>&#160;<span class="comment">       both arrays may be in use. */</span></div>
<div class="line"><a name="l06725"></a><span class="lineno"> 6725</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].lumpedMassMatrix.size() ) {</div>
<div class="line"><a name="l06726"></a><span class="lineno"> 6726</span>&#160; </div>
<div class="line"><a name="l06727"></a><span class="lineno"> 6727</span>&#160;      <span class="comment">/* Multiply the residual with the inverse of the lumped mass matrix. */</span></div>
<div class="line"><a name="l06728"></a><span class="lineno"> 6728</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++i) {</div>
<div class="line"><a name="l06729"></a><span class="lineno"> 6729</span>&#160; </div>
<div class="line"><a name="l06730"></a><span class="lineno"> 6730</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resDOF = res + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i;</div>
<div class="line"><a name="l06731"></a><span class="lineno"> 6731</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lMInv   = 1.0/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#ac0f0a4de25e6201fc028247bd0cd40eb">lumpedMassMatrix</a>[i];</div>
<div class="line"><a name="l06732"></a><span class="lineno"> 6732</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++k) resDOF[k] *= lMInv;</div>
<div class="line"><a name="l06733"></a><span class="lineno"> 6733</span>&#160;      }</div>
<div class="line"><a name="l06734"></a><span class="lineno"> 6734</span>&#160;    }</div>
<div class="line"><a name="l06735"></a><span class="lineno"> 6735</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06736"></a><span class="lineno"> 6736</span>&#160; </div>
<div class="line"><a name="l06737"></a><span class="lineno"> 6737</span>&#160;      <span class="comment">/* Multiply the residual with the inverse of the mass matrix.</span></div>
<div class="line"><a name="l06738"></a><span class="lineno"> 6738</span>&#160;<span class="comment">         Use the array workArray as temporary storage. */</span></div>
<div class="line"><a name="l06739"></a><span class="lineno"> 6739</span>&#160;      memcpy(workArray, res, <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].nDOFsSol*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>));</div>
<div class="line"><a name="l06740"></a><span class="lineno"> 6740</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].nDOFsSol, <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].nDOFsSol,</div>
<div class="line"><a name="l06741"></a><span class="lineno"> 6741</span>&#160;                          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].invMassMatrix.data(), workArray, res, config);</div>
<div class="line"><a name="l06742"></a><span class="lineno"> 6742</span>&#160;    }</div>
<div class="line"><a name="l06743"></a><span class="lineno"> 6743</span>&#160;  }</div>
<div class="line"><a name="l06744"></a><span class="lineno"> 6744</span>&#160;}</div>
<div class="line"><a name="l06745"></a><span class="lineno"> 6745</span>&#160; </div>
<div class="line"><a name="l06746"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a5b3e068f83cbf3aeb8e6a4e02b4bf27b"> 6746</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5b3e068f83cbf3aeb8e6a4e02b4bf27b">CFEM_DG_EulerSolver::Pressure_Forces</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry, <a class="code" href="class_c_config.html">CConfig</a> *config) {</div>
<div class="line"><a name="l06747"></a><span class="lineno"> 6747</span>&#160; </div>
<div class="line"><a name="l06748"></a><span class="lineno"> 6748</span>&#160;  <span class="comment">/* Allocate the memory for the work array and initialize it to zero to avoid</span></div>
<div class="line"><a name="l06749"></a><span class="lineno"> 6749</span>&#160;<span class="comment">     warnings in debug mode  about uninitialized memory when padding is applied. */</span></div>
<div class="line"><a name="l06750"></a><span class="lineno"> 6750</span>&#160;  vector&lt;su2double&gt; workArrayVec(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a95cef33ccbfa61def433d11ddef5745d">sizeWorkArray</a>, 0.0);</div>
<div class="line"><a name="l06751"></a><span class="lineno"> 6751</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *workArray = workArrayVec.data();</div>
<div class="line"><a name="l06752"></a><span class="lineno"> 6752</span>&#160; </div>
<div class="line"><a name="l06753"></a><span class="lineno"> 6753</span>&#160;  <span class="comment">/* The number of bytes to copied in the memcpy calls. */</span></div>
<div class="line"><a name="l06754"></a><span class="lineno"> 6754</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l06755"></a><span class="lineno"> 6755</span>&#160; </div>
<div class="line"><a name="l06756"></a><span class="lineno"> 6756</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l06757"></a><span class="lineno"> 6757</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l06758"></a><span class="lineno"> 6758</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l06759"></a><span class="lineno"> 6759</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06760"></a><span class="lineno"> 6760</span>&#160; </div>
<div class="line"><a name="l06761"></a><span class="lineno"> 6761</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l06762"></a><span class="lineno"> 6762</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l06763"></a><span class="lineno"> 6763</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l06764"></a><span class="lineno"> 6764</span>&#160; </div>
<div class="line"><a name="l06765"></a><span class="lineno"> 6765</span>&#160;  <span class="comment">/*--- Get the information of the angle of attack, reference area, etc. ---*/</span></div>
<div class="line"><a name="l06766"></a><span class="lineno"> 6766</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Alpha        = config-&gt;<a class="code" href="class_c_config.html#a6020a5df7025ffb286f9b9f55f3f2773">GetAoA</a>()*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0;</div>
<div class="line"><a name="l06767"></a><span class="lineno"> 6767</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Beta         = config-&gt;<a class="code" href="class_c_config.html#a4305a79a4c74f13160c0dd8daae181ef">GetAoS</a>()*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0;</div>
<div class="line"><a name="l06768"></a><span class="lineno"> 6768</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RefArea      = config-&gt;<a class="code" href="class_c_config.html#ad1d22f6d4f0225e3281d826a4c866779">GetRefArea</a>();</div>
<div class="line"><a name="l06769"></a><span class="lineno"> 6769</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RefLength    = config-&gt;<a class="code" href="class_c_config.html#a63ce45e68b93f8f3f1de44a2abad67ef">GetRefLength</a>();</div>
<div class="line"><a name="l06770"></a><span class="lineno"> 6770</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Gas_Constant = config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l06771"></a><span class="lineno"> 6771</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *Origin      = config-&gt;<a class="code" href="class_c_config.html#a11302b0fc39a262419332a53e0a82c19">GetRefOriginMoment</a>(0);</div>
<div class="line"><a name="l06772"></a><span class="lineno"> 6772</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> grid_movement     = config-&gt;<a class="code" href="class_c_config.html#a65f49bf3888539804cc0ceac28a32923">GetGrid_Movement</a>();</div>
<div class="line"><a name="l06773"></a><span class="lineno"> 6773</span>&#160; </div>
<div class="line"><a name="l06774"></a><span class="lineno"> 6774</span>&#160;  <span class="comment">/*--- Evaluate reference values for non-dimensionalization.</span></div>
<div class="line"><a name="l06775"></a><span class="lineno"> 6775</span>&#160;<span class="comment">        For dynamic meshes, use the motion Mach number as a reference value</span></div>
<div class="line"><a name="l06776"></a><span class="lineno"> 6776</span>&#160;<span class="comment">        for computing the force coefficients. Otherwise, use the freestream</span></div>
<div class="line"><a name="l06777"></a><span class="lineno"> 6777</span>&#160;<span class="comment">        values, which is the standard convention. ---*/</span></div>
<div class="line"><a name="l06778"></a><span class="lineno"> 6778</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RefTemp     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a1f8fc98a188469be0d59e9053457bcaf">Temperature_Inf</a>;</div>
<div class="line"><a name="l06779"></a><span class="lineno"> 6779</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RefDensity  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa9c51b1803e120b62903c76d666f7dc2">Density_Inf</a>;</div>
<div class="line"><a name="l06780"></a><span class="lineno"> 6780</span>&#160; </div>
<div class="line"><a name="l06781"></a><span class="lineno"> 6781</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RefVel2;</div>
<div class="line"><a name="l06782"></a><span class="lineno"> 6782</span>&#160;  <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a name="l06783"></a><span class="lineno"> 6783</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Mach2Vel = sqrt(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*Gas_Constant*RefTemp);</div>
<div class="line"><a name="l06784"></a><span class="lineno"> 6784</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Mach_Motion = config-&gt;<a class="code" href="class_c_config.html#a84da3953107e3dad010e13227f1d84d0">GetMach_Motion</a>();</div>
<div class="line"><a name="l06785"></a><span class="lineno"> 6785</span>&#160;    RefVel2 = (Mach_Motion*Mach2Vel)*(Mach_Motion*Mach2Vel);</div>
<div class="line"><a name="l06786"></a><span class="lineno"> 6786</span>&#160;  }</div>
<div class="line"><a name="l06787"></a><span class="lineno"> 6787</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l06788"></a><span class="lineno"> 6788</span>&#160;    RefVel2 = 0.0;</div>
<div class="line"><a name="l06789"></a><span class="lineno"> 6789</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l06790"></a><span class="lineno"> 6790</span>&#160;      RefVel2 += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abb32d1dea64bec72ee273f0ceff0da6a">Velocity_Inf</a>[iDim]*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abb32d1dea64bec72ee273f0ceff0da6a">Velocity_Inf</a>[iDim];</div>
<div class="line"><a name="l06791"></a><span class="lineno"> 6791</span>&#160;  }</div>
<div class="line"><a name="l06792"></a><span class="lineno"> 6792</span>&#160; </div>
<div class="line"><a name="l06793"></a><span class="lineno"> 6793</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factor = 1.0/(0.5*RefDensity*RefArea*RefVel2);</div>
<div class="line"><a name="l06794"></a><span class="lineno"> 6794</span>&#160; </div>
<div class="line"><a name="l06795"></a><span class="lineno"> 6795</span>&#160;  <span class="comment">/*-- Variables initialization ---*/</span></div>
<div class="line"><a name="l06796"></a><span class="lineno"> 6796</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a> = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a> = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a92b0e3fa2d142ef6ed6c2ac4aafc9c04">Total_CSF</a> = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a973142a08d87ce2338d5c64f7f1e146b">Total_CEff</a> = 0.0;</div>
<div class="line"><a name="l06797"></a><span class="lineno"> 6797</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af47adcfc34283af5e61df0a69374e912">Total_CMx</a> = 0.0;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a54b44d56de430143b203dedb967e69d9">Total_CMy</a> = 0.0;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7924707aed377b385c0cd7019ae1ef71">Total_CMz</a> = 0.0;</div>
<div class="line"><a name="l06798"></a><span class="lineno"> 6798</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a215f5d64c363a662ee0cb31cbd4f13a1">Total_CFx</a> = 0.0;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6a9e78792a4e1dd0b5c27501105be895">Total_CFy</a> = 0.0;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3d32ed98538d3d4c345dd9c3a7d74c28">Total_CFz</a> = 0.0;</div>
<div class="line"><a name="l06799"></a><span class="lineno"> 6799</span>&#160; </div>
<div class="line"><a name="l06800"></a><span class="lineno"> 6800</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50d77fe3071118de657c0549bba78010">AllBound_CD_Inv</a>   = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af365d7212c43e1baeaa4cdef2e8f296e">AllBound_CL_Inv</a>  = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a455240c02f2946e2263089865256170b">AllBound_CSF_Inv</a> = 0.0;</div>
<div class="line"><a name="l06801"></a><span class="lineno"> 6801</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a672e33567a14a4de4cbc36e0dd1ed1a3">AllBound_CMx_Inv</a>  = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a57c08132a09947983dacf60feac90c5e">AllBound_CMy_Inv</a> = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a479dae53b587411629e2e2e42718f7a4">AllBound_CMz_Inv</a> = 0.0;</div>
<div class="line"><a name="l06802"></a><span class="lineno"> 6802</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a98a70e1cdcb69212d4ad0c8783bc6dee">AllBound_CFx_Inv</a>  = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a25cf9b1d594afcd4b3ef2f7538a885d1">AllBound_CFy_Inv</a> = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a88d4c52f65d715fc4fe957d18f05bc7a">AllBound_CFz_Inv</a> = 0.0;</div>
<div class="line"><a name="l06803"></a><span class="lineno"> 6803</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a33db005fb5a88393f688c9f29d8bc287">AllBound_CEff_Inv</a> = 0.0;</div>
<div class="line"><a name="l06804"></a><span class="lineno"> 6804</span>&#160; </div>
<div class="line"><a name="l06805"></a><span class="lineno"> 6805</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>(); ++iMarker_Monitoring) {</div>
<div class="line"><a name="l06806"></a><span class="lineno"> 6806</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a>[iMarker_Monitoring]  = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a>[iMarker_Monitoring]   = 0.0;</div>
<div class="line"><a name="l06807"></a><span class="lineno"> 6807</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">Surface_CSF_Inv</a>[iMarker_Monitoring] = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac4a8cda93a2c52067378ab6b4a46f469">Surface_CEff_Inv</a>[iMarker_Monitoring] = 0.0;</div>
<div class="line"><a name="l06808"></a><span class="lineno"> 6808</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">Surface_CFx_Inv</a>[iMarker_Monitoring] = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">Surface_CFy_Inv</a>[iMarker_Monitoring]  = 0.0;</div>
<div class="line"><a name="l06809"></a><span class="lineno"> 6809</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">Surface_CFz_Inv</a>[iMarker_Monitoring] = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">Surface_CMx_Inv</a>[iMarker_Monitoring]  = 0.0;</div>
<div class="line"><a name="l06810"></a><span class="lineno"> 6810</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">Surface_CMy_Inv</a>[iMarker_Monitoring] = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">Surface_CMz_Inv</a>[iMarker_Monitoring]  = 0.0;</div>
<div class="line"><a name="l06811"></a><span class="lineno"> 6811</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a>[iMarker_Monitoring]      = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a>[iMarker_Monitoring]       = 0.0;</div>
<div class="line"><a name="l06812"></a><span class="lineno"> 6812</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2a26031c6fd9824899ecb92125207b60">Surface_CSF</a>[iMarker_Monitoring]     = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d84d5e44c469d17b9024f44a93bb2bc">Surface_CEff</a>[iMarker_Monitoring]     = 0.0;</div>
<div class="line"><a name="l06813"></a><span class="lineno"> 6813</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3dde950e7512a05dc691db87cd8ca51f">Surface_CFx</a>[iMarker_Monitoring]     = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d7110b59eb940c5e354f2303946dcf2">Surface_CFy</a>[iMarker_Monitoring]      = 0.0;</div>
<div class="line"><a name="l06814"></a><span class="lineno"> 6814</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50202c322d1794f32fbfe7eff7617c25">Surface_CFz</a>[iMarker_Monitoring]     = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa2b0fa39f8b4853f27c537e30681d2c7">Surface_CMx</a>[iMarker_Monitoring]      = 0.0;</div>
<div class="line"><a name="l06815"></a><span class="lineno"> 6815</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a417c1b82a8a8b76d049cd48a796f68f3">Surface_CMy</a>[iMarker_Monitoring]     = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">Surface_CMz</a>[iMarker_Monitoring]      = 0.0;</div>
<div class="line"><a name="l06816"></a><span class="lineno"> 6816</span>&#160;  }</div>
<div class="line"><a name="l06817"></a><span class="lineno"> 6817</span>&#160; </div>
<div class="line"><a name="l06818"></a><span class="lineno"> 6818</span>&#160;  <span class="comment">/*--- Loop over the Euler and Navier-Stokes markers ---*/</span></div>
<div class="line"><a name="l06819"></a><span class="lineno"> 6819</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker=0; iMarker&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>; ++iMarker) {</div>
<div class="line"><a name="l06820"></a><span class="lineno"> 6820</span>&#160; </div>
<div class="line"><a name="l06821"></a><span class="lineno"> 6821</span>&#160;    <span class="comment">/* Check if this boundary must be monitored. */</span></div>
<div class="line"><a name="l06822"></a><span class="lineno"> 6822</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> Monitoring = config-&gt;<a class="code" href="class_c_config.html#a942619938b389de95268bce31434c276">GetMarker_All_Monitoring</a>(iMarker);</div>
<div class="line"><a name="l06823"></a><span class="lineno"> 6823</span>&#160;    <span class="keywordflow">if</span>(Monitoring == <a class="code" href="option__structure_8hpp.html#a0e3c6990687ed4453e660b9db9181885a99f136a862ba5c7d16967231c29f09d6">YES</a>) {</div>
<div class="line"><a name="l06824"></a><span class="lineno"> 6824</span>&#160; </div>
<div class="line"><a name="l06825"></a><span class="lineno"> 6825</span>&#160;      <span class="comment">/* Easier storage of the boundary condition. */</span></div>
<div class="line"><a name="l06826"></a><span class="lineno"> 6826</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> Boundary = config-&gt;<a class="code" href="class_c_config.html#a57d43acc1457d2d27095ce006218862e">GetMarker_All_KindBC</a>(iMarker);</div>
<div class="line"><a name="l06827"></a><span class="lineno"> 6827</span>&#160; </div>
<div class="line"><a name="l06828"></a><span class="lineno"> 6828</span>&#160;      <span class="comment">/*--- Obtain the origin for the moment computation for a particular marker ---*/</span></div>
<div class="line"><a name="l06829"></a><span class="lineno"> 6829</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>();</div>
<div class="line"><a name="l06830"></a><span class="lineno"> 6830</span>&#160;                       ++iMarker_Monitoring) {</div>
<div class="line"><a name="l06831"></a><span class="lineno"> 6831</span>&#160;        <span class="keywordtype">string</span> Monitoring_Tag = config-&gt;<a class="code" href="class_c_config.html#a5bf47083eec0b00543d3d8c387f41ab2">GetMarker_Monitoring_TagBound</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l06832"></a><span class="lineno"> 6832</span>&#160;        <span class="keywordtype">string</span> Marker_Tag     = config-&gt;<a class="code" href="class_c_config.html#a967e969a3beb24bb6e57d7036af003be">GetMarker_All_TagBound</a>(iMarker);</div>
<div class="line"><a name="l06833"></a><span class="lineno"> 6833</span>&#160;        <span class="keywordflow">if</span> (Marker_Tag == Monitoring_Tag)</div>
<div class="line"><a name="l06834"></a><span class="lineno"> 6834</span>&#160;          Origin = config-&gt;<a class="code" href="class_c_config.html#a11302b0fc39a262419332a53e0a82c19">GetRefOriginMoment</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l06835"></a><span class="lineno"> 6835</span>&#160;      }</div>
<div class="line"><a name="l06836"></a><span class="lineno"> 6836</span>&#160; </div>
<div class="line"><a name="l06837"></a><span class="lineno"> 6837</span>&#160;      <span class="comment">/* Check for a boundary for which the forces must be computed. */</span></div>
<div class="line"><a name="l06838"></a><span class="lineno"> 6838</span>&#160;      <span class="keywordflow">if</span>((Boundary == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba229d80524b666a7ebf409d3655255a1a">EULER_WALL</a>) || (Boundary == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a>) ||</div>
<div class="line"><a name="l06839"></a><span class="lineno"> 6839</span>&#160;         (Boundary == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a>)) {</div>
<div class="line"><a name="l06840"></a><span class="lineno"> 6840</span>&#160; </div>
<div class="line"><a name="l06841"></a><span class="lineno"> 6841</span>&#160;        <span class="comment">/*--- Initialization for this marker ---*/</span></div>
<div class="line"><a name="l06842"></a><span class="lineno"> 6842</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a>[iMarker] = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a>[iMarker] = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a069e21a1a7bb86994d97296c8be8482d">CSF_Inv</a>[iMarker] = 0.0;</div>
<div class="line"><a name="l06843"></a><span class="lineno"> 6843</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a777496791f91315cc44fa3bf90237738">CMx_Inv</a>[iMarker] = 0.0;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4ed349d7fd826d372ce1fe6119bfc1">CMy_Inv</a>[iMarker] = 0.0;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CMz_Inv</a>[iMarker] = 0.0;</div>
<div class="line"><a name="l06844"></a><span class="lineno"> 6844</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFx_Inv</a>[iMarker] = 0.0;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFy_Inv</a>[iMarker] = 0.0;   <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9e7a08fa34a5d46b21a127c5e0535a98">CFz_Inv</a>[iMarker] = 0.0;</div>
<div class="line"><a name="l06845"></a><span class="lineno"> 6845</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3490fa3bd85d5fade030b46f3d90fb51">CEff_Inv</a>[iMarker] = 0.0;</div>
<div class="line"><a name="l06846"></a><span class="lineno"> 6846</span>&#160; </div>
<div class="line"><a name="l06847"></a><span class="lineno"> 6847</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ForceInviscid[]  = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l06848"></a><span class="lineno"> 6848</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> MomentInviscid[] = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l06849"></a><span class="lineno"> 6849</span>&#160; </div>
<div class="line"><a name="l06850"></a><span class="lineno"> 6850</span>&#160;        <span class="comment">/* Easier storage of the boundary faces for this boundary marker. */</span></div>
<div class="line"><a name="l06851"></a><span class="lineno"> 6851</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      nSurfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.size();</div>
<div class="line"><a name="l06852"></a><span class="lineno"> 6852</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.data();</div>
<div class="line"><a name="l06853"></a><span class="lineno"> 6853</span>&#160; </div>
<div class="line"><a name="l06854"></a><span class="lineno"> 6854</span>&#160;        <span class="comment">/*--- Loop over the faces of this boundary. Multiple faces are treated</span></div>
<div class="line"><a name="l06855"></a><span class="lineno"> 6855</span>&#160;<span class="comment">              simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l06856"></a><span class="lineno"> 6856</span>&#160;<span class="comment">              multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l06857"></a><span class="lineno"> 6857</span>&#160;<span class="comment">              happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l06858"></a><span class="lineno"> 6858</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;nSurfElem;) {</div>
<div class="line"><a name="l06859"></a><span class="lineno"> 6859</span>&#160; </div>
<div class="line"><a name="l06860"></a><span class="lineno"> 6860</span>&#160;          <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l06861"></a><span class="lineno"> 6861</span>&#160;<span class="comment">             N value in the gemm computations. */</span></div>
<div class="line"><a name="l06862"></a><span class="lineno"> 6862</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l06863"></a><span class="lineno"> 6863</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l06864"></a><span class="lineno"> 6864</span>&#160; </div>
<div class="line"><a name="l06865"></a><span class="lineno"> 6865</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, nSurfElem, nFaceSimul,</div>
<div class="line"><a name="l06866"></a><span class="lineno"> 6866</span>&#160;                              nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l06867"></a><span class="lineno"> 6867</span>&#160; </div>
<div class="line"><a name="l06868"></a><span class="lineno"> 6868</span>&#160;          <span class="comment">/* Get the required information from the corresponding standard face. */</span></div>
<div class="line"><a name="l06869"></a><span class="lineno"> 6869</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l06870"></a><span class="lineno"> 6870</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a26266f4d68d95c22bbb949fe6d8f5db6">GetNDOFsFace</a>();</div>
<div class="line"><a name="l06871"></a><span class="lineno"> 6871</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a283dc8babad462022e4621afe0251929">GetBasisFaceIntegration</a>();</div>
<div class="line"><a name="l06872"></a><span class="lineno"> 6872</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights   = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l06873"></a><span class="lineno"> 6873</span>&#160; </div>
<div class="line"><a name="l06874"></a><span class="lineno"> 6874</span>&#160;          <span class="comment">/* Set the pointers for the local work arrays. */</span></div>
<div class="line"><a name="l06875"></a><span class="lineno"> 6875</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solInt    = workArray;</div>
<div class="line"><a name="l06876"></a><span class="lineno"> 6876</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *workArray = solInt + NPad*nInt;</div>
<div class="line"><a name="l06877"></a><span class="lineno"> 6877</span>&#160; </div>
<div class="line"><a name="l06878"></a><span class="lineno"> 6878</span>&#160;          <span class="comment">/* Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l06879"></a><span class="lineno"> 6879</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l06880"></a><span class="lineno"> 6880</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06881"></a><span class="lineno"> 6881</span>&#160; </div>
<div class="line"><a name="l06882"></a><span class="lineno"> 6882</span>&#160;            <span class="comment">/* Easier storage of the DOFs of the face. */</span></div>
<div class="line"><a name="l06883"></a><span class="lineno"> 6883</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFs = surfElem[l+ll].<a class="code" href="class_c_surface_element_f_e_m.html#aee91841e533b10cdbe3b3b09e98e3695">DOFsSolFace</a>.data();</div>
<div class="line"><a name="l06884"></a><span class="lineno"> 6884</span>&#160; </div>
<div class="line"><a name="l06885"></a><span class="lineno"> 6885</span>&#160;            <span class="comment">/* Copy the solution of the DOFs of the face such that it is</span></div>
<div class="line"><a name="l06886"></a><span class="lineno"> 6886</span>&#160;<span class="comment">               contiguous in memory. */</span></div>
<div class="line"><a name="l06887"></a><span class="lineno"> 6887</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l06888"></a><span class="lineno"> 6888</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*DOFs[i];</div>
<div class="line"><a name="l06889"></a><span class="lineno"> 6889</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *sol    = workArray + NPad*i + llNVar;</div>
<div class="line"><a name="l06890"></a><span class="lineno"> 6890</span>&#160;              memcpy(sol, solDOF, nBytes);</div>
<div class="line"><a name="l06891"></a><span class="lineno"> 6891</span>&#160;            }</div>
<div class="line"><a name="l06892"></a><span class="lineno"> 6892</span>&#160;          }</div>
<div class="line"><a name="l06893"></a><span class="lineno"> 6893</span>&#160; </div>
<div class="line"><a name="l06894"></a><span class="lineno"> 6894</span>&#160;          <span class="comment">/* Call the general function to carry out the matrix product to determine</span></div>
<div class="line"><a name="l06895"></a><span class="lineno"> 6895</span>&#160;<span class="comment">             the solution in the integration points. */</span></div>
<div class="line"><a name="l06896"></a><span class="lineno"> 6896</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt, NPad, nDOFs, basisFace, workArray, solInt, config);</div>
<div class="line"><a name="l06897"></a><span class="lineno"> 6897</span>&#160; </div>
<div class="line"><a name="l06898"></a><span class="lineno"> 6898</span>&#160;          <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l06899"></a><span class="lineno"> 6899</span>&#160;<span class="comment">             in order to have the most efficient code. */</span></div>
<div class="line"><a name="l06900"></a><span class="lineno"> 6900</span>&#160;          <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l06901"></a><span class="lineno"> 6901</span>&#160; </div>
<div class="line"><a name="l06902"></a><span class="lineno"> 6902</span>&#160;            <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l06903"></a><span class="lineno"> 6903</span>&#160; </div>
<div class="line"><a name="l06904"></a><span class="lineno"> 6904</span>&#160;              <span class="comment">/* Two dimensional simulation. Loop over the number of faces treated</span></div>
<div class="line"><a name="l06905"></a><span class="lineno"> 6905</span>&#160;<span class="comment">                 simultaneously. */</span></div>
<div class="line"><a name="l06906"></a><span class="lineno"> 6906</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l06907"></a><span class="lineno"> 6907</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06908"></a><span class="lineno"> 6908</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l06909"></a><span class="lineno"> 6909</span>&#160; </div>
<div class="line"><a name="l06910"></a><span class="lineno"> 6910</span>&#160;                <span class="comment">/* Loop over the integration points of this surface element. */</span></div>
<div class="line"><a name="l06911"></a><span class="lineno"> 6911</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l06912"></a><span class="lineno"> 6912</span>&#160; </div>
<div class="line"><a name="l06913"></a><span class="lineno"> 6913</span>&#160;                  <span class="comment">/* Easier storage of the solution, the normals and the coordinates</span></div>
<div class="line"><a name="l06914"></a><span class="lineno"> 6914</span>&#160;<span class="comment">                     for this integration point. */</span></div>
<div class="line"><a name="l06915"></a><span class="lineno"> 6915</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol     = solInt + i*NPad + llNVar;</div>
<div class="line"><a name="l06916"></a><span class="lineno"> 6916</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data()</div>
<div class="line"><a name="l06917"></a><span class="lineno"> 6917</span>&#160;                                           + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l06918"></a><span class="lineno"> 6918</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *Coord   = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data()</div>
<div class="line"><a name="l06919"></a><span class="lineno"> 6919</span>&#160;                                           + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l06920"></a><span class="lineno"> 6920</span>&#160; </div>
<div class="line"><a name="l06921"></a><span class="lineno"> 6921</span>&#160;                  <span class="comment">/*--- Compute the pressure in this integration point. ---*/</span></div>
<div class="line"><a name="l06922"></a><span class="lineno"> 6922</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/sol[0];</div>
<div class="line"><a name="l06923"></a><span class="lineno"> 6923</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = sol[1]*DensityInv;</div>
<div class="line"><a name="l06924"></a><span class="lineno"> 6924</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = sol[2]*DensityInv;</div>
<div class="line"><a name="l06925"></a><span class="lineno"> 6925</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = sol[3]*DensityInv - 0.5*(u*u + v*v);</div>
<div class="line"><a name="l06926"></a><span class="lineno"> 6926</span>&#160; </div>
<div class="line"><a name="l06927"></a><span class="lineno"> 6927</span>&#160;                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l06928"></a><span class="lineno"> 6928</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l06929"></a><span class="lineno"> 6929</span>&#160; </div>
<div class="line"><a name="l06930"></a><span class="lineno"> 6930</span>&#160;                  <span class="comment">/*-- Compute the vector from the reference point to the integration</span></div>
<div class="line"><a name="l06931"></a><span class="lineno"> 6931</span>&#160;<span class="comment">                       point and update the inviscid force. Note that the normal points</span></div>
<div class="line"><a name="l06932"></a><span class="lineno"> 6932</span>&#160;<span class="comment">                       into the geometry, hence no minus sign. ---*/</span></div>
<div class="line"><a name="l06933"></a><span class="lineno"> 6933</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DistX = Coord[0] - Origin[0];</div>
<div class="line"><a name="l06934"></a><span class="lineno"> 6934</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DistY = Coord[1] - Origin[1];</div>
<div class="line"><a name="l06935"></a><span class="lineno"> 6935</span>&#160; </div>
<div class="line"><a name="l06936"></a><span class="lineno"> 6936</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ForceMag = (Pressure - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a28853952a2d55f77b1826b10c5e608b5">Pressure_Inf</a>)*weights[i]</div>
<div class="line"><a name="l06937"></a><span class="lineno"> 6937</span>&#160;                                           * normals[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*factor;</div>
<div class="line"><a name="l06938"></a><span class="lineno"> 6938</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ForceX   = ForceMag*normals[0];</div>
<div class="line"><a name="l06939"></a><span class="lineno"> 6939</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ForceY   = ForceMag*normals[1];</div>
<div class="line"><a name="l06940"></a><span class="lineno"> 6940</span>&#160; </div>
<div class="line"><a name="l06941"></a><span class="lineno"> 6941</span>&#160;                  ForceInviscid[0] += ForceX;</div>
<div class="line"><a name="l06942"></a><span class="lineno"> 6942</span>&#160;                  ForceInviscid[1] += ForceY;</div>
<div class="line"><a name="l06943"></a><span class="lineno"> 6943</span>&#160; </div>
<div class="line"><a name="l06944"></a><span class="lineno"> 6944</span>&#160;                  <span class="comment">/*--- Update the inviscid moment. ---*/</span></div>
<div class="line"><a name="l06945"></a><span class="lineno"> 6945</span>&#160;                  MomentInviscid[2] += (ForceY*DistX - ForceX*DistY)/RefLength;</div>
<div class="line"><a name="l06946"></a><span class="lineno"> 6946</span>&#160;                }</div>
<div class="line"><a name="l06947"></a><span class="lineno"> 6947</span>&#160;              }</div>
<div class="line"><a name="l06948"></a><span class="lineno"> 6948</span>&#160; </div>
<div class="line"><a name="l06949"></a><span class="lineno"> 6949</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l06950"></a><span class="lineno"> 6950</span>&#160;            }</div>
<div class="line"><a name="l06951"></a><span class="lineno"> 6951</span>&#160; </div>
<div class="line"><a name="l06952"></a><span class="lineno"> 6952</span>&#160;            <span class="comment">/*----------------------------------------------------------------*/</span></div>
<div class="line"><a name="l06953"></a><span class="lineno"> 6953</span>&#160; </div>
<div class="line"><a name="l06954"></a><span class="lineno"> 6954</span>&#160;            <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l06955"></a><span class="lineno"> 6955</span>&#160; </div>
<div class="line"><a name="l06956"></a><span class="lineno"> 6956</span>&#160;              <span class="comment">/* Three dimensional simulation. Loop over the number of faces treated</span></div>
<div class="line"><a name="l06957"></a><span class="lineno"> 6957</span>&#160;<span class="comment">                 simultaneously. */</span></div>
<div class="line"><a name="l06958"></a><span class="lineno"> 6958</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l06959"></a><span class="lineno"> 6959</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l06960"></a><span class="lineno"> 6960</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l06961"></a><span class="lineno"> 6961</span>&#160; </div>
<div class="line"><a name="l06962"></a><span class="lineno"> 6962</span>&#160;                <span class="comment">/* Loop over the integration points of this surface element. */</span></div>
<div class="line"><a name="l06963"></a><span class="lineno"> 6963</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l06964"></a><span class="lineno"> 6964</span>&#160; </div>
<div class="line"><a name="l06965"></a><span class="lineno"> 6965</span>&#160;                  <span class="comment">/* Easier storage of the solution, the normals and the coordinates</span></div>
<div class="line"><a name="l06966"></a><span class="lineno"> 6966</span>&#160;<span class="comment">                     for this integration point. */</span></div>
<div class="line"><a name="l06967"></a><span class="lineno"> 6967</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol     = solInt + i*NPad + llNVar;</div>
<div class="line"><a name="l06968"></a><span class="lineno"> 6968</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data()</div>
<div class="line"><a name="l06969"></a><span class="lineno"> 6969</span>&#160;                                           + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l06970"></a><span class="lineno"> 6970</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *Coord   = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data()</div>
<div class="line"><a name="l06971"></a><span class="lineno"> 6971</span>&#160;                                           + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l06972"></a><span class="lineno"> 6972</span>&#160; </div>
<div class="line"><a name="l06973"></a><span class="lineno"> 6973</span>&#160;                  <span class="comment">/*--- Compute the pressure in this integration point. ---*/</span></div>
<div class="line"><a name="l06974"></a><span class="lineno"> 6974</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/sol[0];</div>
<div class="line"><a name="l06975"></a><span class="lineno"> 6975</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = sol[1]*DensityInv;</div>
<div class="line"><a name="l06976"></a><span class="lineno"> 6976</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = sol[2]*DensityInv;</div>
<div class="line"><a name="l06977"></a><span class="lineno"> 6977</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w            = sol[3]*DensityInv;</div>
<div class="line"><a name="l06978"></a><span class="lineno"> 6978</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = sol[4]*DensityInv - 0.5*(u*u + v*v + w*w);</div>
<div class="line"><a name="l06979"></a><span class="lineno"> 6979</span>&#160; </div>
<div class="line"><a name="l06980"></a><span class="lineno"> 6980</span>&#160;                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l06981"></a><span class="lineno"> 6981</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l06982"></a><span class="lineno"> 6982</span>&#160; </div>
<div class="line"><a name="l06983"></a><span class="lineno"> 6983</span>&#160;                  <span class="comment">/*-- Compute the vector from the reference point to the integration</span></div>
<div class="line"><a name="l06984"></a><span class="lineno"> 6984</span>&#160;<span class="comment">                       point and update the inviscid force. Note that the normal points</span></div>
<div class="line"><a name="l06985"></a><span class="lineno"> 6985</span>&#160;<span class="comment">                       into the geometry, hence no minus sign. ---*/</span></div>
<div class="line"><a name="l06986"></a><span class="lineno"> 6986</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DistX = Coord[0] - Origin[0];</div>
<div class="line"><a name="l06987"></a><span class="lineno"> 6987</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DistY = Coord[1] - Origin[1];</div>
<div class="line"><a name="l06988"></a><span class="lineno"> 6988</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DistZ = Coord[2] - Origin[2];</div>
<div class="line"><a name="l06989"></a><span class="lineno"> 6989</span>&#160; </div>
<div class="line"><a name="l06990"></a><span class="lineno"> 6990</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ForceMag = (Pressure - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a28853952a2d55f77b1826b10c5e608b5">Pressure_Inf</a>)*weights[i]</div>
<div class="line"><a name="l06991"></a><span class="lineno"> 6991</span>&#160;                                           * normals[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*factor;</div>
<div class="line"><a name="l06992"></a><span class="lineno"> 6992</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ForceX   = ForceMag*normals[0];</div>
<div class="line"><a name="l06993"></a><span class="lineno"> 6993</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ForceY   = ForceMag*normals[1];</div>
<div class="line"><a name="l06994"></a><span class="lineno"> 6994</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ForceZ   = ForceMag*normals[2];</div>
<div class="line"><a name="l06995"></a><span class="lineno"> 6995</span>&#160; </div>
<div class="line"><a name="l06996"></a><span class="lineno"> 6996</span>&#160;                  ForceInviscid[0] += ForceX;</div>
<div class="line"><a name="l06997"></a><span class="lineno"> 6997</span>&#160;                  ForceInviscid[1] += ForceY;</div>
<div class="line"><a name="l06998"></a><span class="lineno"> 6998</span>&#160;                  ForceInviscid[2] += ForceZ;</div>
<div class="line"><a name="l06999"></a><span class="lineno"> 6999</span>&#160; </div>
<div class="line"><a name="l07000"></a><span class="lineno"> 7000</span>&#160;                  <span class="comment">/*--- Update the inviscid moment. ---*/</span></div>
<div class="line"><a name="l07001"></a><span class="lineno"> 7001</span>&#160;                  MomentInviscid[0] += (ForceZ*DistY - ForceY*DistZ)/RefLength;</div>
<div class="line"><a name="l07002"></a><span class="lineno"> 7002</span>&#160;                  MomentInviscid[1] += (ForceX*DistZ - ForceZ*DistX)/RefLength;</div>
<div class="line"><a name="l07003"></a><span class="lineno"> 7003</span>&#160;                  MomentInviscid[2] += (ForceY*DistX - ForceX*DistY)/RefLength;</div>
<div class="line"><a name="l07004"></a><span class="lineno"> 7004</span>&#160;                }</div>
<div class="line"><a name="l07005"></a><span class="lineno"> 7005</span>&#160;              }</div>
<div class="line"><a name="l07006"></a><span class="lineno"> 7006</span>&#160; </div>
<div class="line"><a name="l07007"></a><span class="lineno"> 7007</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07008"></a><span class="lineno"> 7008</span>&#160;            }</div>
<div class="line"><a name="l07009"></a><span class="lineno"> 7009</span>&#160;          }</div>
<div class="line"><a name="l07010"></a><span class="lineno"> 7010</span>&#160; </div>
<div class="line"><a name="l07011"></a><span class="lineno"> 7011</span>&#160;          <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l07012"></a><span class="lineno"> 7012</span>&#160;<span class="comment">             current chunk. */</span></div>
<div class="line"><a name="l07013"></a><span class="lineno"> 7013</span>&#160;          l = lEnd;</div>
<div class="line"><a name="l07014"></a><span class="lineno"> 7014</span>&#160;        }</div>
<div class="line"><a name="l07015"></a><span class="lineno"> 7015</span>&#160; </div>
<div class="line"><a name="l07016"></a><span class="lineno"> 7016</span>&#160;        <span class="comment">/*--- Project forces and store the non-dimensional coefficients ---*/</span></div>
<div class="line"><a name="l07017"></a><span class="lineno"> 7017</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a name="l07018"></a><span class="lineno"> 7018</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a>[iMarker]  =  ForceInviscid[0]*cos(Alpha) + ForceInviscid[1]*sin(Alpha);</div>
<div class="line"><a name="l07019"></a><span class="lineno"> 7019</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a>[iMarker]  = -ForceInviscid[0]*sin(Alpha) + ForceInviscid[1]*cos(Alpha);</div>
<div class="line"><a name="l07020"></a><span class="lineno"> 7020</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3490fa3bd85d5fade030b46f3d90fb51">CEff_Inv</a>[iMarker]   =  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a>[iMarker] / (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a>[iMarker]+<a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l07021"></a><span class="lineno"> 7021</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CMz_Inv</a>[iMarker]    =  MomentInviscid[2];</div>
<div class="line"><a name="l07022"></a><span class="lineno"> 7022</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFx_Inv</a>[iMarker]    =  ForceInviscid[0];</div>
<div class="line"><a name="l07023"></a><span class="lineno"> 7023</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFy_Inv</a>[iMarker]    =  ForceInviscid[1];</div>
<div class="line"><a name="l07024"></a><span class="lineno"> 7024</span>&#160;        }</div>
<div class="line"><a name="l07025"></a><span class="lineno"> 7025</span>&#160;        <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) {</div>
<div class="line"><a name="l07026"></a><span class="lineno"> 7026</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a>[iMarker]   =  ForceInviscid[0]*cos(Alpha)*cos(Beta)</div>
<div class="line"><a name="l07027"></a><span class="lineno"> 7027</span>&#160;                            +  ForceInviscid[1]*sin(Beta)</div>
<div class="line"><a name="l07028"></a><span class="lineno"> 7028</span>&#160;                            +  ForceInviscid[2]*sin(Alpha)*cos(Beta);</div>
<div class="line"><a name="l07029"></a><span class="lineno"> 7029</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a>[iMarker]   = -ForceInviscid[0]*sin(Alpha) + ForceInviscid[2]*cos(Alpha);</div>
<div class="line"><a name="l07030"></a><span class="lineno"> 7030</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a069e21a1a7bb86994d97296c8be8482d">CSF_Inv</a>[iMarker]  = -ForceInviscid[0]*sin(Beta)*cos(Alpha)</div>
<div class="line"><a name="l07031"></a><span class="lineno"> 7031</span>&#160;                            +  ForceInviscid[1]*cos(Beta)</div>
<div class="line"><a name="l07032"></a><span class="lineno"> 7032</span>&#160;                            -  ForceInviscid[2]*sin(Beta)*sin(Alpha);</div>
<div class="line"><a name="l07033"></a><span class="lineno"> 7033</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3490fa3bd85d5fade030b46f3d90fb51">CEff_Inv</a>[iMarker] =  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a>[iMarker] / (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a>[iMarker] + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l07034"></a><span class="lineno"> 7034</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a777496791f91315cc44fa3bf90237738">CMx_Inv</a>[iMarker]  =  MomentInviscid[0];</div>
<div class="line"><a name="l07035"></a><span class="lineno"> 7035</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4ed349d7fd826d372ce1fe6119bfc1">CMy_Inv</a>[iMarker]  =  MomentInviscid[1];</div>
<div class="line"><a name="l07036"></a><span class="lineno"> 7036</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CMz_Inv</a>[iMarker]  =  MomentInviscid[2];</div>
<div class="line"><a name="l07037"></a><span class="lineno"> 7037</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFx_Inv</a>[iMarker]  =  ForceInviscid[0];</div>
<div class="line"><a name="l07038"></a><span class="lineno"> 7038</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFy_Inv</a>[iMarker]  =  ForceInviscid[1];</div>
<div class="line"><a name="l07039"></a><span class="lineno"> 7039</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9e7a08fa34a5d46b21a127c5e0535a98">CFz_Inv</a>[iMarker]  =  ForceInviscid[2];</div>
<div class="line"><a name="l07040"></a><span class="lineno"> 7040</span>&#160;        }</div>
<div class="line"><a name="l07041"></a><span class="lineno"> 7041</span>&#160; </div>
<div class="line"><a name="l07042"></a><span class="lineno"> 7042</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50d77fe3071118de657c0549bba78010">AllBound_CD_Inv</a>  += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a>[iMarker];</div>
<div class="line"><a name="l07043"></a><span class="lineno"> 7043</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af365d7212c43e1baeaa4cdef2e8f296e">AllBound_CL_Inv</a>  += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a>[iMarker];</div>
<div class="line"><a name="l07044"></a><span class="lineno"> 7044</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a455240c02f2946e2263089865256170b">AllBound_CSF_Inv</a> += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a069e21a1a7bb86994d97296c8be8482d">CSF_Inv</a>[iMarker];</div>
<div class="line"><a name="l07045"></a><span class="lineno"> 7045</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a33db005fb5a88393f688c9f29d8bc287">AllBound_CEff_Inv</a> = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af365d7212c43e1baeaa4cdef2e8f296e">AllBound_CL_Inv</a> / (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50d77fe3071118de657c0549bba78010">AllBound_CD_Inv</a> + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l07046"></a><span class="lineno"> 7046</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a672e33567a14a4de4cbc36e0dd1ed1a3">AllBound_CMx_Inv</a> += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a777496791f91315cc44fa3bf90237738">CMx_Inv</a>[iMarker];</div>
<div class="line"><a name="l07047"></a><span class="lineno"> 7047</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a57c08132a09947983dacf60feac90c5e">AllBound_CMy_Inv</a> += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4ed349d7fd826d372ce1fe6119bfc1">CMy_Inv</a>[iMarker];</div>
<div class="line"><a name="l07048"></a><span class="lineno"> 7048</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a479dae53b587411629e2e2e42718f7a4">AllBound_CMz_Inv</a> += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CMz_Inv</a>[iMarker];</div>
<div class="line"><a name="l07049"></a><span class="lineno"> 7049</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a98a70e1cdcb69212d4ad0c8783bc6dee">AllBound_CFx_Inv</a> += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFx_Inv</a>[iMarker];</div>
<div class="line"><a name="l07050"></a><span class="lineno"> 7050</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a25cf9b1d594afcd4b3ef2f7538a885d1">AllBound_CFy_Inv</a> += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFy_Inv</a>[iMarker];</div>
<div class="line"><a name="l07051"></a><span class="lineno"> 7051</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a88d4c52f65d715fc4fe957d18f05bc7a">AllBound_CFz_Inv</a> += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9e7a08fa34a5d46b21a127c5e0535a98">CFz_Inv</a>[iMarker];</div>
<div class="line"><a name="l07052"></a><span class="lineno"> 7052</span>&#160; </div>
<div class="line"><a name="l07053"></a><span class="lineno"> 7053</span>&#160;        <span class="comment">/*--- Compute the coefficients per surface ---*/</span></div>
<div class="line"><a name="l07054"></a><span class="lineno"> 7054</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>();</div>
<div class="line"><a name="l07055"></a><span class="lineno"> 7055</span>&#160;                         ++iMarker_Monitoring) {</div>
<div class="line"><a name="l07056"></a><span class="lineno"> 7056</span>&#160;          <span class="keywordtype">string</span> Monitoring_Tag = config-&gt;<a class="code" href="class_c_config.html#a5bf47083eec0b00543d3d8c387f41ab2">GetMarker_Monitoring_TagBound</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l07057"></a><span class="lineno"> 7057</span>&#160;          <span class="keywordtype">string</span> Marker_Tag = config-&gt;<a class="code" href="class_c_config.html#a967e969a3beb24bb6e57d7036af003be">GetMarker_All_TagBound</a>(iMarker);</div>
<div class="line"><a name="l07058"></a><span class="lineno"> 7058</span>&#160;          <span class="keywordflow">if</span> (Marker_Tag == Monitoring_Tag) {</div>
<div class="line"><a name="l07059"></a><span class="lineno"> 7059</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a>[iMarker_Monitoring]   += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CL_Inv</a>[iMarker];</div>
<div class="line"><a name="l07060"></a><span class="lineno"> 7060</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a>[iMarker_Monitoring]   += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CD_Inv</a>[iMarker];</div>
<div class="line"><a name="l07061"></a><span class="lineno"> 7061</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">Surface_CSF_Inv</a>[iMarker_Monitoring]  += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a069e21a1a7bb86994d97296c8be8482d">CSF_Inv</a>[iMarker];</div>
<div class="line"><a name="l07062"></a><span class="lineno"> 7062</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac4a8cda93a2c52067378ab6b4a46f469">Surface_CEff_Inv</a>[iMarker_Monitoring]  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a>[iMarker_Monitoring]</div>
<div class="line"><a name="l07063"></a><span class="lineno"> 7063</span>&#160;                                                  / (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a>[iMarker_Monitoring] + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l07064"></a><span class="lineno"> 7064</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">Surface_CFx_Inv</a>[iMarker_Monitoring]  += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFx_Inv</a>[iMarker];</div>
<div class="line"><a name="l07065"></a><span class="lineno"> 7065</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">Surface_CFy_Inv</a>[iMarker_Monitoring]  += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFy_Inv</a>[iMarker];</div>
<div class="line"><a name="l07066"></a><span class="lineno"> 7066</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">Surface_CFz_Inv</a>[iMarker_Monitoring]  += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9e7a08fa34a5d46b21a127c5e0535a98">CFz_Inv</a>[iMarker];</div>
<div class="line"><a name="l07067"></a><span class="lineno"> 7067</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">Surface_CMx_Inv</a>[iMarker_Monitoring]  += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a777496791f91315cc44fa3bf90237738">CMx_Inv</a>[iMarker];</div>
<div class="line"><a name="l07068"></a><span class="lineno"> 7068</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">Surface_CMy_Inv</a>[iMarker_Monitoring]  += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aef4ed349d7fd826d372ce1fe6119bfc1">CMy_Inv</a>[iMarker];</div>
<div class="line"><a name="l07069"></a><span class="lineno"> 7069</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">Surface_CMz_Inv</a>[iMarker_Monitoring]  += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CMz_Inv</a>[iMarker];</div>
<div class="line"><a name="l07070"></a><span class="lineno"> 7070</span>&#160;          }</div>
<div class="line"><a name="l07071"></a><span class="lineno"> 7071</span>&#160;        }</div>
<div class="line"><a name="l07072"></a><span class="lineno"> 7072</span>&#160;      }</div>
<div class="line"><a name="l07073"></a><span class="lineno"> 7073</span>&#160;    }</div>
<div class="line"><a name="l07074"></a><span class="lineno"> 7074</span>&#160;  }</div>
<div class="line"><a name="l07075"></a><span class="lineno"> 7075</span>&#160; </div>
<div class="line"><a name="l07076"></a><span class="lineno"> 7076</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l07077"></a><span class="lineno"> 7077</span>&#160; </div>
<div class="line"><a name="l07078"></a><span class="lineno"> 7078</span>&#160;  <span class="comment">/*--- Parallel mode. The data from all ranks must be gathered.</span></div>
<div class="line"><a name="l07079"></a><span class="lineno"> 7079</span>&#160;<span class="comment">        Determine the size of the communication buffer. ---*/</span></div>
<div class="line"><a name="l07080"></a><span class="lineno"> 7080</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nCommSize = 9*config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>() + 9;</div>
<div class="line"><a name="l07081"></a><span class="lineno"> 7081</span>&#160; </div>
<div class="line"><a name="l07082"></a><span class="lineno"> 7082</span>&#160;  <span class="comment">/*--- Define the communication buffers and store to local data in</span></div>
<div class="line"><a name="l07083"></a><span class="lineno"> 7083</span>&#160;<span class="comment">        the local buffer. ---*/</span></div>
<div class="line"><a name="l07084"></a><span class="lineno"> 7084</span>&#160;  vector&lt;su2double&gt; locBuf(nCommSize), globBuf(nCommSize);</div>
<div class="line"><a name="l07085"></a><span class="lineno"> 7085</span>&#160; </div>
<div class="line"><a name="l07086"></a><span class="lineno"> 7086</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = 0;</div>
<div class="line"><a name="l07087"></a><span class="lineno"> 7087</span>&#160;  locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50d77fe3071118de657c0549bba78010">AllBound_CD_Inv</a>;  locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af365d7212c43e1baeaa4cdef2e8f296e">AllBound_CL_Inv</a>;</div>
<div class="line"><a name="l07088"></a><span class="lineno"> 7088</span>&#160;  locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a455240c02f2946e2263089865256170b">AllBound_CSF_Inv</a>; locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a672e33567a14a4de4cbc36e0dd1ed1a3">AllBound_CMx_Inv</a>;</div>
<div class="line"><a name="l07089"></a><span class="lineno"> 7089</span>&#160;  locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a57c08132a09947983dacf60feac90c5e">AllBound_CMy_Inv</a>; locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a479dae53b587411629e2e2e42718f7a4">AllBound_CMz_Inv</a>;</div>
<div class="line"><a name="l07090"></a><span class="lineno"> 7090</span>&#160;  locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a98a70e1cdcb69212d4ad0c8783bc6dee">AllBound_CFx_Inv</a>; locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a25cf9b1d594afcd4b3ef2f7538a885d1">AllBound_CFy_Inv</a>;</div>
<div class="line"><a name="l07091"></a><span class="lineno"> 7091</span>&#160;  locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a88d4c52f65d715fc4fe957d18f05bc7a">AllBound_CFz_Inv</a>;</div>
<div class="line"><a name="l07092"></a><span class="lineno"> 7092</span>&#160; </div>
<div class="line"><a name="l07093"></a><span class="lineno"> 7093</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>(); ++i) {</div>
<div class="line"><a name="l07094"></a><span class="lineno"> 7094</span>&#160;    locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a>[i];  locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a>[i];</div>
<div class="line"><a name="l07095"></a><span class="lineno"> 7095</span>&#160;    locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">Surface_CSF_Inv</a>[i]; locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">Surface_CFx_Inv</a>[i];</div>
<div class="line"><a name="l07096"></a><span class="lineno"> 7096</span>&#160;    locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">Surface_CFy_Inv</a>[i]; locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">Surface_CFz_Inv</a>[i];</div>
<div class="line"><a name="l07097"></a><span class="lineno"> 7097</span>&#160;    locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">Surface_CMx_Inv</a>[i]; locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">Surface_CMy_Inv</a>[i];</div>
<div class="line"><a name="l07098"></a><span class="lineno"> 7098</span>&#160;    locBuf[ii++] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">Surface_CMz_Inv</a>[i];</div>
<div class="line"><a name="l07099"></a><span class="lineno"> 7099</span>&#160;  }</div>
<div class="line"><a name="l07100"></a><span class="lineno"> 7100</span>&#160; </div>
<div class="line"><a name="l07101"></a><span class="lineno"> 7101</span>&#160;  <span class="comment">/* Sum up all the data from all ranks. The result will be available on all ranks. */</span></div>
<div class="line"><a name="l07102"></a><span class="lineno"> 7102</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#aa878788c30e1c7c3ed4788e485bd2fb0">GetConsole_Output_Verb</a>() == <a class="code" href="option__structure_8hpp.html#ae40552e21f517bdde7c1a26de77b3e11a686b9a708a0e02450f0b19f485e7e96c">VERB_HIGH</a>) {</div>
<div class="line"><a name="l07103"></a><span class="lineno"> 7103</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(locBuf.data(), globBuf.data(), nCommSize, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>,</div>
<div class="line"><a name="l07104"></a><span class="lineno"> 7104</span>&#160;                       <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l07105"></a><span class="lineno"> 7105</span>&#160;  }</div>
<div class="line"><a name="l07106"></a><span class="lineno"> 7106</span>&#160; </div>
<div class="line"><a name="l07107"></a><span class="lineno"> 7107</span>&#160;  <span class="comment">/*--- Copy the data back from globBuf into the required variables. ---*/</span></div>
<div class="line"><a name="l07108"></a><span class="lineno"> 7108</span>&#160;  ii = 0;</div>
<div class="line"><a name="l07109"></a><span class="lineno"> 7109</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50d77fe3071118de657c0549bba78010">AllBound_CD_Inv</a>  = globBuf[ii++]; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af365d7212c43e1baeaa4cdef2e8f296e">AllBound_CL_Inv</a>  = globBuf[ii++];</div>
<div class="line"><a name="l07110"></a><span class="lineno"> 7110</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a455240c02f2946e2263089865256170b">AllBound_CSF_Inv</a> = globBuf[ii++]; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a672e33567a14a4de4cbc36e0dd1ed1a3">AllBound_CMx_Inv</a> = globBuf[ii++];</div>
<div class="line"><a name="l07111"></a><span class="lineno"> 7111</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a57c08132a09947983dacf60feac90c5e">AllBound_CMy_Inv</a> = globBuf[ii++]; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a479dae53b587411629e2e2e42718f7a4">AllBound_CMz_Inv</a> = globBuf[ii++];</div>
<div class="line"><a name="l07112"></a><span class="lineno"> 7112</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a98a70e1cdcb69212d4ad0c8783bc6dee">AllBound_CFx_Inv</a> = globBuf[ii++]; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a25cf9b1d594afcd4b3ef2f7538a885d1">AllBound_CFy_Inv</a> = globBuf[ii++];</div>
<div class="line"><a name="l07113"></a><span class="lineno"> 7113</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a88d4c52f65d715fc4fe957d18f05bc7a">AllBound_CFz_Inv</a> = globBuf[ii++];</div>
<div class="line"><a name="l07114"></a><span class="lineno"> 7114</span>&#160; </div>
<div class="line"><a name="l07115"></a><span class="lineno"> 7115</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a33db005fb5a88393f688c9f29d8bc287">AllBound_CEff_Inv</a> = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af365d7212c43e1baeaa4cdef2e8f296e">AllBound_CL_Inv</a>/(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50d77fe3071118de657c0549bba78010">AllBound_CD_Inv</a> + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l07116"></a><span class="lineno"> 7116</span>&#160; </div>
<div class="line"><a name="l07117"></a><span class="lineno"> 7117</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>(); ++i) {</div>
<div class="line"><a name="l07118"></a><span class="lineno"> 7118</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a>[i]  = globBuf[ii++]; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a>[i]  = globBuf[ii++];</div>
<div class="line"><a name="l07119"></a><span class="lineno"> 7119</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">Surface_CSF_Inv</a>[i] = globBuf[ii++]; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">Surface_CFx_Inv</a>[i] = globBuf[ii++];</div>
<div class="line"><a name="l07120"></a><span class="lineno"> 7120</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">Surface_CFy_Inv</a>[i] = globBuf[ii++]; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">Surface_CFz_Inv</a>[i] = globBuf[ii++];</div>
<div class="line"><a name="l07121"></a><span class="lineno"> 7121</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">Surface_CMx_Inv</a>[i] = globBuf[ii++]; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">Surface_CMy_Inv</a>[i] = globBuf[ii++];</div>
<div class="line"><a name="l07122"></a><span class="lineno"> 7122</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">Surface_CMz_Inv</a>[i] = globBuf[ii++];</div>
<div class="line"><a name="l07123"></a><span class="lineno"> 7123</span>&#160; </div>
<div class="line"><a name="l07124"></a><span class="lineno"> 7124</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac4a8cda93a2c52067378ab6b4a46f469">Surface_CEff_Inv</a>[i] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a>[i]/(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a>[i] + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l07125"></a><span class="lineno"> 7125</span>&#160;  }</div>
<div class="line"><a name="l07126"></a><span class="lineno"> 7126</span>&#160; </div>
<div class="line"><a name="l07127"></a><span class="lineno"> 7127</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l07128"></a><span class="lineno"> 7128</span>&#160; </div>
<div class="line"><a name="l07129"></a><span class="lineno"> 7129</span>&#160;  <span class="comment">/*--- Update the total coefficients (note that all the nodes have the same value) ---*/</span></div>
<div class="line"><a name="l07130"></a><span class="lineno"> 7130</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a>      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50d77fe3071118de657c0549bba78010">AllBound_CD_Inv</a>;</div>
<div class="line"><a name="l07131"></a><span class="lineno"> 7131</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a>      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af365d7212c43e1baeaa4cdef2e8f296e">AllBound_CL_Inv</a>;</div>
<div class="line"><a name="l07132"></a><span class="lineno"> 7132</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a92b0e3fa2d142ef6ed6c2ac4aafc9c04">Total_CSF</a> = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a455240c02f2946e2263089865256170b">AllBound_CSF_Inv</a>;</div>
<div class="line"><a name="l07133"></a><span class="lineno"> 7133</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a973142a08d87ce2338d5c64f7f1e146b">Total_CEff</a>       = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a> / (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a> + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l07134"></a><span class="lineno"> 7134</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af47adcfc34283af5e61df0a69374e912">Total_CMx</a>        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a672e33567a14a4de4cbc36e0dd1ed1a3">AllBound_CMx_Inv</a>;</div>
<div class="line"><a name="l07135"></a><span class="lineno"> 7135</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a54b44d56de430143b203dedb967e69d9">Total_CMy</a>        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a57c08132a09947983dacf60feac90c5e">AllBound_CMy_Inv</a>;</div>
<div class="line"><a name="l07136"></a><span class="lineno"> 7136</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7924707aed377b385c0cd7019ae1ef71">Total_CMz</a>        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a479dae53b587411629e2e2e42718f7a4">AllBound_CMz_Inv</a>;</div>
<div class="line"><a name="l07137"></a><span class="lineno"> 7137</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a215f5d64c363a662ee0cb31cbd4f13a1">Total_CFx</a>        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a98a70e1cdcb69212d4ad0c8783bc6dee">AllBound_CFx_Inv</a>;</div>
<div class="line"><a name="l07138"></a><span class="lineno"> 7138</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6a9e78792a4e1dd0b5c27501105be895">Total_CFy</a>        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a25cf9b1d594afcd4b3ef2f7538a885d1">AllBound_CFy_Inv</a>;</div>
<div class="line"><a name="l07139"></a><span class="lineno"> 7139</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3d32ed98538d3d4c345dd9c3a7d74c28">Total_CFz</a>        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a88d4c52f65d715fc4fe957d18f05bc7a">AllBound_CFz_Inv</a>;</div>
<div class="line"><a name="l07140"></a><span class="lineno"> 7140</span>&#160; </div>
<div class="line"><a name="l07141"></a><span class="lineno"> 7141</span>&#160;  <span class="comment">/*--- Update the total coefficients per surface (note that all the nodes have the same value)---*/</span></div>
<div class="line"><a name="l07142"></a><span class="lineno"> 7142</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>();</div>
<div class="line"><a name="l07143"></a><span class="lineno"> 7143</span>&#160;                   ++iMarker_Monitoring) {</div>
<div class="line"><a name="l07144"></a><span class="lineno"> 7144</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a>[iMarker_Monitoring]      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a>[iMarker_Monitoring];</div>
<div class="line"><a name="l07145"></a><span class="lineno"> 7145</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a>[iMarker_Monitoring]      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a>[iMarker_Monitoring];</div>
<div class="line"><a name="l07146"></a><span class="lineno"> 7146</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2a26031c6fd9824899ecb92125207b60">Surface_CSF</a>[iMarker_Monitoring] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">Surface_CSF_Inv</a>[iMarker_Monitoring];</div>
<div class="line"><a name="l07147"></a><span class="lineno"> 7147</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d84d5e44c469d17b9024f44a93bb2bc">Surface_CEff</a>[iMarker_Monitoring]       = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">Surface_CL_Inv</a>[iMarker_Monitoring]</div>
<div class="line"><a name="l07148"></a><span class="lineno"> 7148</span>&#160;                                           / (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">Surface_CD_Inv</a>[iMarker_Monitoring] + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l07149"></a><span class="lineno"> 7149</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3dde950e7512a05dc691db87cd8ca51f">Surface_CFx</a>[iMarker_Monitoring]        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">Surface_CFx_Inv</a>[iMarker_Monitoring];</div>
<div class="line"><a name="l07150"></a><span class="lineno"> 7150</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d7110b59eb940c5e354f2303946dcf2">Surface_CFy</a>[iMarker_Monitoring]        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">Surface_CFy_Inv</a>[iMarker_Monitoring];</div>
<div class="line"><a name="l07151"></a><span class="lineno"> 7151</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50202c322d1794f32fbfe7eff7617c25">Surface_CFz</a>[iMarker_Monitoring]        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">Surface_CFz_Inv</a>[iMarker_Monitoring];</div>
<div class="line"><a name="l07152"></a><span class="lineno"> 7152</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa2b0fa39f8b4853f27c537e30681d2c7">Surface_CMx</a>[iMarker_Monitoring]        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">Surface_CMx_Inv</a>[iMarker_Monitoring];</div>
<div class="line"><a name="l07153"></a><span class="lineno"> 7153</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a417c1b82a8a8b76d049cd48a796f68f3">Surface_CMy</a>[iMarker_Monitoring]        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">Surface_CMy_Inv</a>[iMarker_Monitoring];</div>
<div class="line"><a name="l07154"></a><span class="lineno"> 7154</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">Surface_CMz</a>[iMarker_Monitoring]        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">Surface_CMz_Inv</a>[iMarker_Monitoring];</div>
<div class="line"><a name="l07155"></a><span class="lineno"> 7155</span>&#160;  }</div>
<div class="line"><a name="l07156"></a><span class="lineno"> 7156</span>&#160;}</div>
<div class="line"><a name="l07157"></a><span class="lineno"> 7157</span>&#160; </div>
<div class="line"><a name="l07158"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a5f3702ec7e07a248211a10b94068af41"> 7158</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5f3702ec7e07a248211a10b94068af41">CFEM_DG_EulerSolver::ExplicitRK_Iteration</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry, <a class="code" href="class_c_solver.html">CSolver</a> **solver_container,</div>
<div class="line"><a name="l07159"></a><span class="lineno"> 7159</span>&#160;                                               <a class="code" href="class_c_config.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iRKStep) {</div>
<div class="line"><a name="l07160"></a><span class="lineno"> 7160</span>&#160; </div>
<div class="line"><a name="l07161"></a><span class="lineno"> 7161</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      RK_AlphaCoeff = config-&gt;<a class="code" href="class_c_config.html#a62305792633c8d0cb5ccd564d126fc0a">Get_Alpha_RKStep</a>(iRKStep);</div>
<div class="line"><a name="l07162"></a><span class="lineno"> 7162</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nRKStages     = config-&gt;<a class="code" href="class_c_config.html#ab3fc57386d5b28f678f79b49aed96e5b">GetnRKStep</a>();</div>
<div class="line"><a name="l07163"></a><span class="lineno"> 7163</span>&#160; </div>
<div class="line"><a name="l07164"></a><span class="lineno"> 7164</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l07165"></a><span class="lineno"> 7165</span>&#160;    <a class="code" href="class_c_solver.html#a6b74eb7a8bc01a4997c9844598f39d2f">SetRes_RMS</a>(iVar, 0.0);</div>
<div class="line"><a name="l07166"></a><span class="lineno"> 7166</span>&#160;    <a class="code" href="class_c_solver.html#adf14c8391575b286636b04e66f0b5ca7">SetRes_Max</a>(iVar, 0.0, 0);</div>
<div class="line"><a name="l07167"></a><span class="lineno"> 7167</span>&#160;  }</div>
<div class="line"><a name="l07168"></a><span class="lineno"> 7168</span>&#160; </div>
<div class="line"><a name="l07169"></a><span class="lineno"> 7169</span>&#160;  <span class="comment">/* Set the pointer to the array where the new state vector must be stored.</span></div>
<div class="line"><a name="l07170"></a><span class="lineno"> 7170</span>&#160;<span class="comment">     If this is the last RK step, the solution should be stored in</span></div>
<div class="line"><a name="l07171"></a><span class="lineno"> 7171</span>&#160;<span class="comment">     VecSolDOFs, such that a new time step can be taken. Otherwise, the</span></div>
<div class="line"><a name="l07172"></a><span class="lineno"> 7172</span>&#160;<span class="comment">     solution should be stored in the first time level of the working vectors</span></div>
<div class="line"><a name="l07173"></a><span class="lineno"> 7173</span>&#160;<span class="comment">     for the solution. Note that only one working vector will be present for a</span></div>
<div class="line"><a name="l07174"></a><span class="lineno"> 7174</span>&#160;<span class="comment">     RK scheme, because time accurate local time stepping is not possible yet</span></div>
<div class="line"><a name="l07175"></a><span class="lineno"> 7175</span>&#160;<span class="comment">     with RK schemes. */</span></div>
<div class="line"><a name="l07176"></a><span class="lineno"> 7176</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solNew;</div>
<div class="line"><a name="l07177"></a><span class="lineno"> 7177</span>&#160;  <span class="keywordflow">if</span>(iRKStep == (nRKStages-1)) solNew = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data();</div>
<div class="line"><a name="l07178"></a><span class="lineno"> 7178</span>&#160;  <span class="keywordflow">else</span>                         solNew = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[0].data();</div>
<div class="line"><a name="l07179"></a><span class="lineno"> 7179</span>&#160; </div>
<div class="line"><a name="l07180"></a><span class="lineno"> 7180</span>&#160;  <span class="comment">/*--- Update the solution by looping over the owned volume elements. ---*/</span></div>
<div class="line"><a name="l07181"></a><span class="lineno"> 7181</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++l) {</div>
<div class="line"><a name="l07182"></a><span class="lineno"> 7182</span>&#160; </div>
<div class="line"><a name="l07183"></a><span class="lineno"> 7183</span>&#160;    <span class="comment">/* Set the pointers for the residual and solution for this element. */</span></div>
<div class="line"><a name="l07184"></a><span class="lineno"> 7184</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset  = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l07185"></a><span class="lineno"> 7185</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *res        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.data() + offset;</div>
<div class="line"><a name="l07186"></a><span class="lineno"> 7186</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFsOld = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + offset;</div>
<div class="line"><a name="l07187"></a><span class="lineno"> 7187</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFs          = solNew            + offset;</div>
<div class="line"><a name="l07188"></a><span class="lineno"> 7188</span>&#160; </div>
<div class="line"><a name="l07189"></a><span class="lineno"> 7189</span>&#160;    <span class="comment">/* Loop over the DOFs for this element and update the solution and the L2 norm. */</span></div>
<div class="line"><a name="l07190"></a><span class="lineno"> 7190</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tmp = RK_AlphaCoeff*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l];</div>
<div class="line"><a name="l07191"></a><span class="lineno"> 7191</span>&#160; </div>
<div class="line"><a name="l07192"></a><span class="lineno"> 7192</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l07193"></a><span class="lineno"> 7193</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++j) {</div>
<div class="line"><a name="l07194"></a><span class="lineno"> 7194</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> globalIndex = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a740772246345edeefefc843e4b787d68">offsetDOFsSolGlobal</a> + j;</div>
<div class="line"><a name="l07195"></a><span class="lineno"> 7195</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a53ea2b1580c4f0c4da67a21cbeaf27b3">coorSolDOFs</a>.data() + j*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l07196"></a><span class="lineno"> 7196</span>&#160; </div>
<div class="line"><a name="l07197"></a><span class="lineno"> 7197</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar, ++i) {</div>
<div class="line"><a name="l07198"></a><span class="lineno"> 7198</span>&#160;        solDOFs[i] = solDOFsOld[i] - tmp*res[i];</div>
<div class="line"><a name="l07199"></a><span class="lineno"> 7199</span>&#160; </div>
<div class="line"><a name="l07200"></a><span class="lineno"> 7200</span>&#160;        <a class="code" href="class_c_solver.html#a41bc448daf37985882cb2cf27ab1ffd4">AddRes_RMS</a>(iVar, res[i]*res[i]);</div>
<div class="line"><a name="l07201"></a><span class="lineno"> 7201</span>&#160;        <a class="code" href="class_c_solver.html#a8068067ba1b56173c95d4799bfb48d9e">AddRes_Max</a>(iVar, fabs(res[i]), globalIndex, coor);</div>
<div class="line"><a name="l07202"></a><span class="lineno"> 7202</span>&#160;      }</div>
<div class="line"><a name="l07203"></a><span class="lineno"> 7203</span>&#160;    }</div>
<div class="line"><a name="l07204"></a><span class="lineno"> 7204</span>&#160;  }</div>
<div class="line"><a name="l07205"></a><span class="lineno"> 7205</span>&#160; </div>
<div class="line"><a name="l07206"></a><span class="lineno"> 7206</span>&#160;  <span class="comment">/*--- Compute the root mean square residual. Note that the SetResidual_RMS</span></div>
<div class="line"><a name="l07207"></a><span class="lineno"> 7207</span>&#160;<span class="comment">        function cannot be used, because that is for the FV solver.    ---*/</span></div>
<div class="line"><a name="l07208"></a><span class="lineno"> 7208</span>&#160; </div>
<div class="line"><a name="l07209"></a><span class="lineno"> 7209</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l07210"></a><span class="lineno"> 7210</span>&#160;  <span class="comment">/* Parallel mode. Disable the reduce for the residual to avoid overhead if requested. */</span></div>
<div class="line"><a name="l07211"></a><span class="lineno"> 7211</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#aa878788c30e1c7c3ed4788e485bd2fb0">GetConsole_Output_Verb</a>() == <a class="code" href="option__structure_8hpp.html#ae40552e21f517bdde7c1a26de77b3e11a686b9a708a0e02450f0b19f485e7e96c">VERB_HIGH</a>) {</div>
<div class="line"><a name="l07212"></a><span class="lineno"> 7212</span>&#160; </div>
<div class="line"><a name="l07213"></a><span class="lineno"> 7213</span>&#160;    <span class="comment">/*--- The local L2 norms must be added to obtain the</span></div>
<div class="line"><a name="l07214"></a><span class="lineno"> 7214</span>&#160;<span class="comment">          global value. Also check for divergence. ---*/</span></div>
<div class="line"><a name="l07215"></a><span class="lineno"> 7215</span>&#160;    vector&lt;su2double&gt; rbufRes(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>);</div>
<div class="line"><a name="l07216"></a><span class="lineno"> 7216</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(<a class="code" href="class_c_solver.html#a2eefc28ecb9b38a0776fc4f95efdb8ed">Residual_RMS</a>, rbufRes.data(), <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l07217"></a><span class="lineno"> 7217</span>&#160; </div>
<div class="line"><a name="l07218"></a><span class="lineno"> 7218</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l07219"></a><span class="lineno"> 7219</span>&#160;      <span class="keywordflow">if</span> (rbufRes[iVar] != rbufRes[iVar])</div>
<div class="line"><a name="l07220"></a><span class="lineno"> 7220</span>&#160;        <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;SU2 has diverged. (NaN detected)&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l07221"></a><span class="lineno"> 7221</span>&#160; </div>
<div class="line"><a name="l07222"></a><span class="lineno"> 7222</span>&#160;      <a class="code" href="class_c_solver.html#a6b74eb7a8bc01a4997c9844598f39d2f">SetRes_RMS</a>(iVar, max(<a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>*<a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>, sqrt(rbufRes[iVar]/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a34748ca6005136ee4ac1028624e7530c">nDOFsGlobal</a>)));</div>
<div class="line"><a name="l07223"></a><span class="lineno"> 7223</span>&#160;    }</div>
<div class="line"><a name="l07224"></a><span class="lineno"> 7224</span>&#160; </div>
<div class="line"><a name="l07225"></a><span class="lineno"> 7225</span>&#160;    <span class="comment">/*--- The global maximum norms must be obtained. ---*/</span></div>
<div class="line"><a name="l07226"></a><span class="lineno"> 7226</span>&#160;    rbufRes.resize(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>);</div>
<div class="line"><a name="l07227"></a><span class="lineno"> 7227</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a55195abbb7206e08a4933fa53cd41923">SU2_MPI::Allgather</a>(<a class="code" href="class_c_solver.html#a7fa2598a504eef695b0ae88db95b5c4b">Residual_Max</a>, <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, rbufRes.data(),</div>
<div class="line"><a name="l07228"></a><span class="lineno"> 7228</span>&#160;                       <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l07229"></a><span class="lineno"> 7229</span>&#160; </div>
<div class="line"><a name="l07230"></a><span class="lineno"> 7230</span>&#160;    vector&lt;unsigned long&gt; rbufPoint(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>);</div>
<div class="line"><a name="l07231"></a><span class="lineno"> 7231</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a55195abbb7206e08a4933fa53cd41923">SU2_MPI::Allgather</a>(<a class="code" href="class_c_solver.html#a75322711ff68e7268b0ef7b0cf03906f">Point_Max</a>, <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, rbufPoint.data(),</div>
<div class="line"><a name="l07232"></a><span class="lineno"> 7232</span>&#160;                       <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l07233"></a><span class="lineno"> 7233</span>&#160; </div>
<div class="line"><a name="l07234"></a><span class="lineno"> 7234</span>&#160;    vector&lt;su2double&gt; sbufCoor(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>);</div>
<div class="line"><a name="l07235"></a><span class="lineno"> 7235</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l07236"></a><span class="lineno"> 7236</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07237"></a><span class="lineno"> 7237</span>&#160;        sbufCoor[iVar*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+iDim] = <a class="code" href="class_c_solver.html#a63d2dfa86c11b820cd97620eac163a49">Point_Max_Coord</a>[iVar][iDim];</div>
<div class="line"><a name="l07238"></a><span class="lineno"> 7238</span>&#160;    }</div>
<div class="line"><a name="l07239"></a><span class="lineno"> 7239</span>&#160; </div>
<div class="line"><a name="l07240"></a><span class="lineno"> 7240</span>&#160;    vector&lt;su2double&gt; rbufCoor(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>);</div>
<div class="line"><a name="l07241"></a><span class="lineno"> 7241</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a55195abbb7206e08a4933fa53cd41923">SU2_MPI::Allgather</a>(sbufCoor.data(), <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, rbufCoor.data(),</div>
<div class="line"><a name="l07242"></a><span class="lineno"> 7242</span>&#160;                       <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l07243"></a><span class="lineno"> 7243</span>&#160; </div>
<div class="line"><a name="l07244"></a><span class="lineno"> 7244</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l07245"></a><span class="lineno"> 7245</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> proc=0; proc&lt;<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>; ++proc)</div>
<div class="line"><a name="l07246"></a><span class="lineno"> 7246</span>&#160;        <a class="code" href="class_c_solver.html#a8068067ba1b56173c95d4799bfb48d9e">AddRes_Max</a>(iVar, rbufRes[proc*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+iVar], rbufPoint[proc*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+iVar],</div>
<div class="line"><a name="l07247"></a><span class="lineno"> 7247</span>&#160;                   &amp;rbufCoor[proc*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+iVar*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>]);</div>
<div class="line"><a name="l07248"></a><span class="lineno"> 7248</span>&#160;    }</div>
<div class="line"><a name="l07249"></a><span class="lineno"> 7249</span>&#160;  }</div>
<div class="line"><a name="l07250"></a><span class="lineno"> 7250</span>&#160; </div>
<div class="line"><a name="l07251"></a><span class="lineno"> 7251</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l07252"></a><span class="lineno"> 7252</span>&#160;  <span class="comment">/*--- Sequential mode. Check for a divergence of the solver and compute</span></div>
<div class="line"><a name="l07253"></a><span class="lineno"> 7253</span>&#160;<span class="comment">        the L2-norm of the residuals. ---*/</span></div>
<div class="line"><a name="l07254"></a><span class="lineno"> 7254</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l07255"></a><span class="lineno"> 7255</span>&#160; </div>
<div class="line"><a name="l07256"></a><span class="lineno"> 7256</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a1c24b55e0849f7f6ba2f62d15d7e4f8e">GetRes_RMS</a>(iVar) != <a class="code" href="class_c_solver.html#a1c24b55e0849f7f6ba2f62d15d7e4f8e">GetRes_RMS</a>(iVar))</div>
<div class="line"><a name="l07257"></a><span class="lineno"> 7257</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;SU2 has diverged. (NaN detected)&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l07258"></a><span class="lineno"> 7258</span>&#160; </div>
<div class="line"><a name="l07259"></a><span class="lineno"> 7259</span>&#160;    <a class="code" href="class_c_solver.html#a6b74eb7a8bc01a4997c9844598f39d2f">SetRes_RMS</a>(iVar, max(<a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>*<a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>, sqrt(<a class="code" href="class_c_solver.html#a1c24b55e0849f7f6ba2f62d15d7e4f8e">GetRes_RMS</a>(iVar)/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a34748ca6005136ee4ac1028624e7530c">nDOFsGlobal</a>)));</div>
<div class="line"><a name="l07260"></a><span class="lineno"> 7260</span>&#160;  }</div>
<div class="line"><a name="l07261"></a><span class="lineno"> 7261</span>&#160; </div>
<div class="line"><a name="l07262"></a><span class="lineno"> 7262</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l07263"></a><span class="lineno"> 7263</span>&#160;}</div>
<div class="line"><a name="l07264"></a><span class="lineno"> 7264</span>&#160; </div>
<div class="line"><a name="l07265"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#add195fe8af6532465c2b677c7a625b3e"> 7265</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#add195fe8af6532465c2b677c7a625b3e">CFEM_DG_EulerSolver::ClassicalRK4_Iteration</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry, <a class="code" href="class_c_solver.html">CSolver</a> **solver_container,</div>
<div class="line"><a name="l07266"></a><span class="lineno"> 7266</span>&#160;                                               <a class="code" href="class_c_config.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iRKStep) {</div>
<div class="line"><a name="l07267"></a><span class="lineno"> 7267</span>&#160; </div>
<div class="line"><a name="l07268"></a><span class="lineno"> 7268</span>&#160;  <span class="comment">/*--- Hard-coded classical RK4 coefficients. Will be added to config. ---*/</span></div>
<div class="line"><a name="l07269"></a><span class="lineno"> 7269</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RK_FuncCoeff[4] = {1.0/6.0, 1.0/3.0, 1.0/3.0, 1.0/6.0};</div>
<div class="line"><a name="l07270"></a><span class="lineno"> 7270</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RK_TimeCoeff[4] = {0.5, 0.5, 1.0, 1.0};</div>
<div class="line"><a name="l07271"></a><span class="lineno"> 7271</span>&#160; </div>
<div class="line"><a name="l07272"></a><span class="lineno"> 7272</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l07273"></a><span class="lineno"> 7273</span>&#160;    <a class="code" href="class_c_solver.html#a6b74eb7a8bc01a4997c9844598f39d2f">SetRes_RMS</a>(iVar, 0.0);</div>
<div class="line"><a name="l07274"></a><span class="lineno"> 7274</span>&#160;    <a class="code" href="class_c_solver.html#adf14c8391575b286636b04e66f0b5ca7">SetRes_Max</a>(iVar, 0.0, 0);</div>
<div class="line"><a name="l07275"></a><span class="lineno"> 7275</span>&#160;  }</div>
<div class="line"><a name="l07276"></a><span class="lineno"> 7276</span>&#160; </div>
<div class="line"><a name="l07277"></a><span class="lineno"> 7277</span>&#160;  <span class="comment">/*--- Update the solution by looping over the owned volume elements. ---*/</span></div>
<div class="line"><a name="l07278"></a><span class="lineno"> 7278</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++l) {</div>
<div class="line"><a name="l07279"></a><span class="lineno"> 7279</span>&#160; </div>
<div class="line"><a name="l07280"></a><span class="lineno"> 7280</span>&#160;    <span class="comment">/* Set the pointers for the residual and solution for this element. */</span></div>
<div class="line"><a name="l07281"></a><span class="lineno"> 7281</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset  = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l07282"></a><span class="lineno"> 7282</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *res        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.data()    + offset;</div>
<div class="line"><a name="l07283"></a><span class="lineno"> 7283</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFsOld = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data()    + offset;</div>
<div class="line"><a name="l07284"></a><span class="lineno"> 7284</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFsNew       = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a492db7771aa00ca8a1b154931b7dd0ef">VecSolDOFsNew</a>.data() + offset;</div>
<div class="line"><a name="l07285"></a><span class="lineno"> 7285</span>&#160; </div>
<div class="line"><a name="l07286"></a><span class="lineno"> 7286</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFs;</div>
<div class="line"><a name="l07287"></a><span class="lineno"> 7287</span>&#160;    <span class="keywordflow">if</span>(iRKStep &lt; 3) solDOFs = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[0].data() + offset;</div>
<div class="line"><a name="l07288"></a><span class="lineno"> 7288</span>&#160;    <span class="keywordflow">else</span>            solDOFs = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data()        + offset;</div>
<div class="line"><a name="l07289"></a><span class="lineno"> 7289</span>&#160; </div>
<div class="line"><a name="l07290"></a><span class="lineno"> 7290</span>&#160;    <span class="comment">/* Loop over the DOFs for this element and update the solution and the L2 norm. */</span></div>
<div class="line"><a name="l07291"></a><span class="lineno"> 7291</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tmp_time = -1.0*RK_TimeCoeff[iRKStep]*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l];</div>
<div class="line"><a name="l07292"></a><span class="lineno"> 7292</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tmp_func = -1.0*RK_FuncCoeff[iRKStep]*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l];</div>
<div class="line"><a name="l07293"></a><span class="lineno"> 7293</span>&#160; </div>
<div class="line"><a name="l07294"></a><span class="lineno"> 7294</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0;</div>
<div class="line"><a name="l07295"></a><span class="lineno"> 7295</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>; ++j) {</div>
<div class="line"><a name="l07296"></a><span class="lineno"> 7296</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> globalIndex = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a740772246345edeefefc843e4b787d68">offsetDOFsSolGlobal</a> + j;</div>
<div class="line"><a name="l07297"></a><span class="lineno"> 7297</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a53ea2b1580c4f0c4da67a21cbeaf27b3">coorSolDOFs</a>.data() + j*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l07298"></a><span class="lineno"> 7298</span>&#160; </div>
<div class="line"><a name="l07299"></a><span class="lineno"> 7299</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar, ++i) {</div>
<div class="line"><a name="l07300"></a><span class="lineno"> 7300</span>&#160; </div>
<div class="line"><a name="l07301"></a><span class="lineno"> 7301</span>&#160;        <span class="keywordflow">if</span> (iRKStep &lt; 3) {</div>
<div class="line"><a name="l07302"></a><span class="lineno"> 7302</span>&#160;          solDOFsNew[i] += tmp_func*res[i];</div>
<div class="line"><a name="l07303"></a><span class="lineno"> 7303</span>&#160;          solDOFs[i]     = solDOFsOld[i] + tmp_time*res[i];</div>
<div class="line"><a name="l07304"></a><span class="lineno"> 7304</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l07305"></a><span class="lineno"> 7305</span>&#160;          solDOFs[i]     = solDOFsNew[i] + tmp_func*res[i];</div>
<div class="line"><a name="l07306"></a><span class="lineno"> 7306</span>&#160;        }</div>
<div class="line"><a name="l07307"></a><span class="lineno"> 7307</span>&#160; </div>
<div class="line"><a name="l07308"></a><span class="lineno"> 7308</span>&#160;        <a class="code" href="class_c_solver.html#a41bc448daf37985882cb2cf27ab1ffd4">AddRes_RMS</a>(iVar, res[i]*res[i]);</div>
<div class="line"><a name="l07309"></a><span class="lineno"> 7309</span>&#160;        <a class="code" href="class_c_solver.html#a8068067ba1b56173c95d4799bfb48d9e">AddRes_Max</a>(iVar, fabs(res[i]), globalIndex, coor);</div>
<div class="line"><a name="l07310"></a><span class="lineno"> 7310</span>&#160;      }</div>
<div class="line"><a name="l07311"></a><span class="lineno"> 7311</span>&#160;    }</div>
<div class="line"><a name="l07312"></a><span class="lineno"> 7312</span>&#160; </div>
<div class="line"><a name="l07313"></a><span class="lineno"> 7313</span>&#160;  }</div>
<div class="line"><a name="l07314"></a><span class="lineno"> 7314</span>&#160; </div>
<div class="line"><a name="l07315"></a><span class="lineno"> 7315</span>&#160;  <span class="comment">/*--- Compute the root mean square residual. Note that the SetResidual_RMS</span></div>
<div class="line"><a name="l07316"></a><span class="lineno"> 7316</span>&#160;<span class="comment">   function cannot be used, because that is for the FV solver.    ---*/</span></div>
<div class="line"><a name="l07317"></a><span class="lineno"> 7317</span>&#160; </div>
<div class="line"><a name="l07318"></a><span class="lineno"> 7318</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l07319"></a><span class="lineno"> 7319</span>&#160;  <span class="comment">/* Parallel mode. Disable the reduce for the residual to avoid overhead if requested. */</span></div>
<div class="line"><a name="l07320"></a><span class="lineno"> 7320</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#aa878788c30e1c7c3ed4788e485bd2fb0">GetConsole_Output_Verb</a>() == <a class="code" href="option__structure_8hpp.html#ae40552e21f517bdde7c1a26de77b3e11a686b9a708a0e02450f0b19f485e7e96c">VERB_HIGH</a>) {</div>
<div class="line"><a name="l07321"></a><span class="lineno"> 7321</span>&#160; </div>
<div class="line"><a name="l07322"></a><span class="lineno"> 7322</span>&#160;    <span class="comment">/*--- The local L2 norms must be added to obtain the</span></div>
<div class="line"><a name="l07323"></a><span class="lineno"> 7323</span>&#160;<span class="comment">          global value. Also check for divergence. ---*/</span></div>
<div class="line"><a name="l07324"></a><span class="lineno"> 7324</span>&#160;    vector&lt;su2double&gt; rbufRes(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>);</div>
<div class="line"><a name="l07325"></a><span class="lineno"> 7325</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(<a class="code" href="class_c_solver.html#a2eefc28ecb9b38a0776fc4f95efdb8ed">Residual_RMS</a>, rbufRes.data(), <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l07326"></a><span class="lineno"> 7326</span>&#160; </div>
<div class="line"><a name="l07327"></a><span class="lineno"> 7327</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l07328"></a><span class="lineno"> 7328</span>&#160;      <span class="keywordflow">if</span> (rbufRes[iVar] != rbufRes[iVar])</div>
<div class="line"><a name="l07329"></a><span class="lineno"> 7329</span>&#160;        <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;SU2 has diverged. (NaN detected)&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l07330"></a><span class="lineno"> 7330</span>&#160; </div>
<div class="line"><a name="l07331"></a><span class="lineno"> 7331</span>&#160;      <a class="code" href="class_c_solver.html#a6b74eb7a8bc01a4997c9844598f39d2f">SetRes_RMS</a>(iVar, max(<a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>*<a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>, sqrt(rbufRes[iVar]/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a34748ca6005136ee4ac1028624e7530c">nDOFsGlobal</a>)));</div>
<div class="line"><a name="l07332"></a><span class="lineno"> 7332</span>&#160;    }</div>
<div class="line"><a name="l07333"></a><span class="lineno"> 7333</span>&#160; </div>
<div class="line"><a name="l07334"></a><span class="lineno"> 7334</span>&#160;    <span class="comment">/*--- The global maximum norms must be obtained. ---*/</span></div>
<div class="line"><a name="l07335"></a><span class="lineno"> 7335</span>&#160;    rbufRes.resize(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>);</div>
<div class="line"><a name="l07336"></a><span class="lineno"> 7336</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a55195abbb7206e08a4933fa53cd41923">SU2_MPI::Allgather</a>(<a class="code" href="class_c_solver.html#a7fa2598a504eef695b0ae88db95b5c4b">Residual_Max</a>, <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, rbufRes.data(),</div>
<div class="line"><a name="l07337"></a><span class="lineno"> 7337</span>&#160;                       <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l07338"></a><span class="lineno"> 7338</span>&#160; </div>
<div class="line"><a name="l07339"></a><span class="lineno"> 7339</span>&#160;    vector&lt;unsigned long&gt; rbufPoint(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>);</div>
<div class="line"><a name="l07340"></a><span class="lineno"> 7340</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a55195abbb7206e08a4933fa53cd41923">SU2_MPI::Allgather</a>(<a class="code" href="class_c_solver.html#a75322711ff68e7268b0ef7b0cf03906f">Point_Max</a>, <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, rbufPoint.data(),</div>
<div class="line"><a name="l07341"></a><span class="lineno"> 7341</span>&#160;                       <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l07342"></a><span class="lineno"> 7342</span>&#160; </div>
<div class="line"><a name="l07343"></a><span class="lineno"> 7343</span>&#160;    vector&lt;su2double&gt; sbufCoor(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>);</div>
<div class="line"><a name="l07344"></a><span class="lineno"> 7344</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l07345"></a><span class="lineno"> 7345</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07346"></a><span class="lineno"> 7346</span>&#160;        sbufCoor[iVar*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+iDim] = <a class="code" href="class_c_solver.html#a63d2dfa86c11b820cd97620eac163a49">Point_Max_Coord</a>[iVar][iDim];</div>
<div class="line"><a name="l07347"></a><span class="lineno"> 7347</span>&#160;    }</div>
<div class="line"><a name="l07348"></a><span class="lineno"> 7348</span>&#160; </div>
<div class="line"><a name="l07349"></a><span class="lineno"> 7349</span>&#160;    vector&lt;su2double&gt; rbufCoor(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>);</div>
<div class="line"><a name="l07350"></a><span class="lineno"> 7350</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a55195abbb7206e08a4933fa53cd41923">SU2_MPI::Allgather</a>(sbufCoor.data(), <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, rbufCoor.data(),</div>
<div class="line"><a name="l07351"></a><span class="lineno"> 7351</span>&#160;                       <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l07352"></a><span class="lineno"> 7352</span>&#160; </div>
<div class="line"><a name="l07353"></a><span class="lineno"> 7353</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l07354"></a><span class="lineno"> 7354</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> proc=0; proc&lt;<a class="code" href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">size</a>; ++proc)</div>
<div class="line"><a name="l07355"></a><span class="lineno"> 7355</span>&#160;        <a class="code" href="class_c_solver.html#a8068067ba1b56173c95d4799bfb48d9e">AddRes_Max</a>(iVar, rbufRes[proc*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+iVar], rbufPoint[proc*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>+iVar],</div>
<div class="line"><a name="l07356"></a><span class="lineno"> 7356</span>&#160;                   &amp;rbufCoor[proc*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+iVar*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>]);</div>
<div class="line"><a name="l07357"></a><span class="lineno"> 7357</span>&#160;    }</div>
<div class="line"><a name="l07358"></a><span class="lineno"> 7358</span>&#160;  }</div>
<div class="line"><a name="l07359"></a><span class="lineno"> 7359</span>&#160; </div>
<div class="line"><a name="l07360"></a><span class="lineno"> 7360</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l07361"></a><span class="lineno"> 7361</span>&#160;  <span class="comment">/*--- Sequential mode. Check for a divergence of the solver and compute</span></div>
<div class="line"><a name="l07362"></a><span class="lineno"> 7362</span>&#160;<span class="comment">   the L2-norm of the residuals. ---*/</span></div>
<div class="line"><a name="l07363"></a><span class="lineno"> 7363</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar=0; iVar&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l07364"></a><span class="lineno"> 7364</span>&#160; </div>
<div class="line"><a name="l07365"></a><span class="lineno"> 7365</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="class_c_solver.html#a1c24b55e0849f7f6ba2f62d15d7e4f8e">GetRes_RMS</a>(iVar) != <a class="code" href="class_c_solver.html#a1c24b55e0849f7f6ba2f62d15d7e4f8e">GetRes_RMS</a>(iVar))</div>
<div class="line"><a name="l07366"></a><span class="lineno"> 7366</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;SU2 has diverged. (NaN detected)&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l07367"></a><span class="lineno"> 7367</span>&#160; </div>
<div class="line"><a name="l07368"></a><span class="lineno"> 7368</span>&#160;    <a class="code" href="class_c_solver.html#a6b74eb7a8bc01a4997c9844598f39d2f">SetRes_RMS</a>(iVar, max(<a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>*<a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>, sqrt(<a class="code" href="class_c_solver.html#a1c24b55e0849f7f6ba2f62d15d7e4f8e">GetRes_RMS</a>(iVar)/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a34748ca6005136ee4ac1028624e7530c">nDOFsGlobal</a>)));</div>
<div class="line"><a name="l07369"></a><span class="lineno"> 7369</span>&#160;  }</div>
<div class="line"><a name="l07370"></a><span class="lineno"> 7370</span>&#160; </div>
<div class="line"><a name="l07371"></a><span class="lineno"> 7371</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l07372"></a><span class="lineno"> 7372</span>&#160;}</div>
<div class="line"><a name="l07373"></a><span class="lineno"> 7373</span>&#160; </div>
<div class="line"><a name="l07374"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#ad581ff9821dc607597049b9d52ce5fdf"> 7374</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad581ff9821dc607597049b9d52ce5fdf">CFEM_DG_EulerSolver::ADER_DG_Iteration</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg,</div>
<div class="line"><a name="l07375"></a><span class="lineno"> 7375</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd) {</div>
<div class="line"><a name="l07376"></a><span class="lineno"> 7376</span>&#160; </div>
<div class="line"><a name="l07377"></a><span class="lineno"> 7377</span>&#160;  <span class="comment">/*--- Update the solution by looping over the given range</span></div>
<div class="line"><a name="l07378"></a><span class="lineno"> 7378</span>&#160;<span class="comment">        of volume elements. ---*/</span></div>
<div class="line"><a name="l07379"></a><span class="lineno"> 7379</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBeg; l&lt;elemEnd; ++l) {</div>
<div class="line"><a name="l07380"></a><span class="lineno"> 7380</span>&#160; </div>
<div class="line"><a name="l07381"></a><span class="lineno"> 7381</span>&#160;    <span class="comment">/* Set the pointers for the residual and solution for this element. */</span></div>
<div class="line"><a name="l07382"></a><span class="lineno"> 7382</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l07383"></a><span class="lineno"> 7383</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *res     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">VecTotResDOFsADER</a>.data() + offset;</div>
<div class="line"><a name="l07384"></a><span class="lineno"> 7384</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFs = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data()        + offset;</div>
<div class="line"><a name="l07385"></a><span class="lineno"> 7385</span>&#160; </div>
<div class="line"><a name="l07386"></a><span class="lineno"> 7386</span>&#160;    <span class="comment">/* Loop over the DOFs for this element and update the solution.</span></div>
<div class="line"><a name="l07387"></a><span class="lineno"> 7387</span>&#160;<span class="comment">       Initialize the residual to zero afterwards. */</span></div>
<div class="line"><a name="l07388"></a><span class="lineno"> 7388</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>); ++i) {</div>
<div class="line"><a name="l07389"></a><span class="lineno"> 7389</span>&#160;      solDOFs[i] -= <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l]*res[i];</div>
<div class="line"><a name="l07390"></a><span class="lineno"> 7390</span>&#160;      res[i]      = 0.0;</div>
<div class="line"><a name="l07391"></a><span class="lineno"> 7391</span>&#160;    }</div>
<div class="line"><a name="l07392"></a><span class="lineno"> 7392</span>&#160;  }</div>
<div class="line"><a name="l07393"></a><span class="lineno"> 7393</span>&#160;}</div>
<div class="line"><a name="l07394"></a><span class="lineno"> 7394</span>&#160; </div>
<div class="line"><a name="l07395"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a5d32e85923daf35ff0126d5f716ff9ec"> 7395</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5d32e85923daf35ff0126d5f716ff9ec">CFEM_DG_EulerSolver::BoundaryStates_Euler_Wall</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l07396"></a><span class="lineno"> 7396</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l07397"></a><span class="lineno"> 7397</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l07398"></a><span class="lineno"> 7398</span>&#160;                                                    <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l07399"></a><span class="lineno"> 7399</span>&#160;                                                    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *solIntL,</div>
<div class="line"><a name="l07400"></a><span class="lineno"> 7400</span>&#160;                                                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *solIntR) {</div>
<div class="line"><a name="l07401"></a><span class="lineno"> 7401</span>&#160; </div>
<div class="line"><a name="l07402"></a><span class="lineno"> 7402</span>&#160;  <span class="comment">/*--- Apply the inviscid wall boundary conditions to compute the right</span></div>
<div class="line"><a name="l07403"></a><span class="lineno"> 7403</span>&#160;<span class="comment">        state in the integration points. There are two options. Either the</span></div>
<div class="line"><a name="l07404"></a><span class="lineno"> 7404</span>&#160;<span class="comment">        normal velocity is negated or the normal velocity is set to zero,</span></div>
<div class="line"><a name="l07405"></a><span class="lineno"> 7405</span>&#160;<span class="comment">        relative to the grid motion. Some experiments are needed to see which</span></div>
<div class="line"><a name="l07406"></a><span class="lineno"> 7406</span>&#160;<span class="comment">        formulation gives better results. ---*/</span></div>
<div class="line"><a name="l07407"></a><span class="lineno"> 7407</span>&#160; </div>
<div class="line"><a name="l07408"></a><span class="lineno"> 7408</span>&#160;  <span class="comment">/* Get the required information from the standard element, which is the</span></div>
<div class="line"><a name="l07409"></a><span class="lineno"> 7409</span>&#160;<span class="comment">     same for all simultaneously treated faces. */</span></div>
<div class="line"><a name="l07410"></a><span class="lineno"> 7410</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind  = surfElem[0].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l07411"></a><span class="lineno"> 7411</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l07412"></a><span class="lineno"> 7412</span>&#160; </div>
<div class="line"><a name="l07413"></a><span class="lineno"> 7413</span>&#160;  <span class="comment">/* Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l07414"></a><span class="lineno"> 7414</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l07415"></a><span class="lineno"> 7415</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l07416"></a><span class="lineno"> 7416</span>&#160; </div>
<div class="line"><a name="l07417"></a><span class="lineno"> 7417</span>&#160;    <span class="comment">/* Loop over the integration points of the face. */</span></div>
<div class="line"><a name="l07418"></a><span class="lineno"> 7418</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l07419"></a><span class="lineno"> 7419</span>&#160; </div>
<div class="line"><a name="l07420"></a><span class="lineno"> 7420</span>&#160;      <span class="comment">/* Easier storage of the left and right solution, the normals and the</span></div>
<div class="line"><a name="l07421"></a><span class="lineno"> 7421</span>&#160;<span class="comment">         grid velocity for this integration point. */</span></div>
<div class="line"><a name="l07422"></a><span class="lineno"> 7422</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solIntL + i*NPad + llNVar;</div>
<div class="line"><a name="l07423"></a><span class="lineno"> 7423</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l07424"></a><span class="lineno"> 7424</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l07425"></a><span class="lineno"> 7425</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l07426"></a><span class="lineno"> 7426</span>&#160; </div>
<div class="line"><a name="l07427"></a><span class="lineno"> 7427</span>&#160;      <span class="comment">/* Compute the normal component of the momentum variables, relative</span></div>
<div class="line"><a name="l07428"></a><span class="lineno"> 7428</span>&#160;<span class="comment">         to the grid motion. */</span></div>
<div class="line"><a name="l07429"></a><span class="lineno"> 7429</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rVn = 0.0;</div>
<div class="line"><a name="l07430"></a><span class="lineno"> 7430</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07431"></a><span class="lineno"> 7431</span>&#160;        rVn += (UL[iDim+1]-UL[0]*gridVel[iDim])*normals[iDim];</div>
<div class="line"><a name="l07432"></a><span class="lineno"> 7432</span>&#160; </div>
<div class="line"><a name="l07433"></a><span class="lineno"> 7433</span>&#160;      <span class="comment">/* If the normal velocity must be mirrored instead of set to zero,</span></div>
<div class="line"><a name="l07434"></a><span class="lineno"> 7434</span>&#160;<span class="comment">         the normal component that must be subtracted must be doubled. If the</span></div>
<div class="line"><a name="l07435"></a><span class="lineno"> 7435</span>&#160;<span class="comment">         normal velocity must be set to zero, simply comment this line. */</span></div>
<div class="line"><a name="l07436"></a><span class="lineno"> 7436</span>&#160;      <span class="comment">//rVn *= 2.0;</span></div>
<div class="line"><a name="l07437"></a><span class="lineno"> 7437</span>&#160; </div>
<div class="line"><a name="l07438"></a><span class="lineno"> 7438</span>&#160;      <span class="comment">/* Set the right state. The initial value of the total energy is the</span></div>
<div class="line"><a name="l07439"></a><span class="lineno"> 7439</span>&#160;<span class="comment">         energy of the left state. */</span></div>
<div class="line"><a name="l07440"></a><span class="lineno"> 7440</span>&#160;      UR[0]      = UL[0];</div>
<div class="line"><a name="l07441"></a><span class="lineno"> 7441</span>&#160;      UR[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = UL[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1];</div>
<div class="line"><a name="l07442"></a><span class="lineno"> 7442</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07443"></a><span class="lineno"> 7443</span>&#160;        UR[iDim+1] = UL[iDim+1] - rVn*normals[iDim];</div>
<div class="line"><a name="l07444"></a><span class="lineno"> 7444</span>&#160; </div>
<div class="line"><a name="l07445"></a><span class="lineno"> 7445</span>&#160;      <span class="comment">/*--- Actually, only the internal energy of UR is equal to UL. If the</span></div>
<div class="line"><a name="l07446"></a><span class="lineno"> 7446</span>&#160;<span class="comment">            kinetic energy differs for UL and UR, the difference must be</span></div>
<div class="line"><a name="l07447"></a><span class="lineno"> 7447</span>&#160;<span class="comment">            subtracted from the total energy of UR to obtain the correct</span></div>
<div class="line"><a name="l07448"></a><span class="lineno"> 7448</span>&#160;<span class="comment">            value. ---*/</span></div>
<div class="line"><a name="l07449"></a><span class="lineno"> 7449</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv = 1.0/UL[0];</div>
<div class="line"><a name="l07450"></a><span class="lineno"> 7450</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> diffKin    = 0;</div>
<div class="line"><a name="l07451"></a><span class="lineno"> 7451</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=1; iDim&lt;=<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l07452"></a><span class="lineno"> 7452</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velL = DensityInv*UL[iDim];</div>
<div class="line"><a name="l07453"></a><span class="lineno"> 7453</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velR = DensityInv*UR[iDim];</div>
<div class="line"><a name="l07454"></a><span class="lineno"> 7454</span>&#160;        diffKin += velL*velL - velR*velR;</div>
<div class="line"><a name="l07455"></a><span class="lineno"> 7455</span>&#160;      }</div>
<div class="line"><a name="l07456"></a><span class="lineno"> 7456</span>&#160; </div>
<div class="line"><a name="l07457"></a><span class="lineno"> 7457</span>&#160;      UR[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] -= 0.5*UL[0]*diffKin;</div>
<div class="line"><a name="l07458"></a><span class="lineno"> 7458</span>&#160;    }</div>
<div class="line"><a name="l07459"></a><span class="lineno"> 7459</span>&#160;  }</div>
<div class="line"><a name="l07460"></a><span class="lineno"> 7460</span>&#160;}</div>
<div class="line"><a name="l07461"></a><span class="lineno"> 7461</span>&#160; </div>
<div class="line"><a name="l07462"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#af993f01423bbb8e24b8c2bb565bf55eb"> 7462</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af993f01423bbb8e24b8c2bb565bf55eb">CFEM_DG_EulerSolver::BoundaryStates_Inlet</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l07463"></a><span class="lineno"> 7463</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l07464"></a><span class="lineno"> 7464</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l07465"></a><span class="lineno"> 7465</span>&#160;                                               <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l07466"></a><span class="lineno"> 7466</span>&#160;                                               <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l07467"></a><span class="lineno"> 7467</span>&#160;                                               <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *solIntL,</div>
<div class="line"><a name="l07468"></a><span class="lineno"> 7468</span>&#160;                                               <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *solIntR) {</div>
<div class="line"><a name="l07469"></a><span class="lineno"> 7469</span>&#160; </div>
<div class="line"><a name="l07470"></a><span class="lineno"> 7470</span>&#160;  <span class="comment">/*--- Retrieve the specified total conditions for this inlet. ---*/</span></div>
<div class="line"><a name="l07471"></a><span class="lineno"> 7471</span>&#160;  <span class="keywordtype">string</span> Marker_Tag = config-&gt;<a class="code" href="class_c_config.html#a967e969a3beb24bb6e57d7036af003be">GetMarker_All_TagBound</a>(val_marker);</div>
<div class="line"><a name="l07472"></a><span class="lineno"> 7472</span>&#160; </div>
<div class="line"><a name="l07473"></a><span class="lineno"> 7473</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> P_Total   = config-&gt;<a class="code" href="class_c_config.html#a2f650d295acb30ca08709eafab7f01fb">GetInlet_Ptotal</a>(Marker_Tag);</div>
<div class="line"><a name="l07474"></a><span class="lineno"> 7474</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> T_Total   = config-&gt;<a class="code" href="class_c_config.html#a65fda2155cdc4ac10c448e4322e5d04e">GetInlet_Ttotal</a>(Marker_Tag);</div>
<div class="line"><a name="l07475"></a><span class="lineno"> 7475</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *Flow_Dir = config-&gt;<a class="code" href="class_c_config.html#a238624f1ee47bacb9d016b78071f3a87">GetInlet_FlowDir</a>(Marker_Tag);</div>
<div class="line"><a name="l07476"></a><span class="lineno"> 7476</span>&#160; </div>
<div class="line"><a name="l07477"></a><span class="lineno"> 7477</span>&#160;  <span class="comment">/*--- Non-dim. the inputs if necessary, and compute the total enthalpy. ---*/</span></div>
<div class="line"><a name="l07478"></a><span class="lineno"> 7478</span>&#160;  P_Total /= config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>();</div>
<div class="line"><a name="l07479"></a><span class="lineno"> 7479</span>&#160;  T_Total /= config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>();</div>
<div class="line"><a name="l07480"></a><span class="lineno"> 7480</span>&#160; </div>
<div class="line"><a name="l07481"></a><span class="lineno"> 7481</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Gas_Constant = config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l07482"></a><span class="lineno"> 7482</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> H_Total      = (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*Gas_Constant/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>)*T_Total;</div>
<div class="line"><a name="l07483"></a><span class="lineno"> 7483</span>&#160; </div>
<div class="line"><a name="l07484"></a><span class="lineno"> 7484</span>&#160;  <span class="comment">/* Get the required information from the standard element, which is the</span></div>
<div class="line"><a name="l07485"></a><span class="lineno"> 7485</span>&#160;<span class="comment">     same for all simultaneously treated faces. */</span></div>
<div class="line"><a name="l07486"></a><span class="lineno"> 7486</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind  = surfElem[0].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l07487"></a><span class="lineno"> 7487</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l07488"></a><span class="lineno"> 7488</span>&#160; </div>
<div class="line"><a name="l07489"></a><span class="lineno"> 7489</span>&#160;  <span class="comment">/* Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l07490"></a><span class="lineno"> 7490</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l07491"></a><span class="lineno"> 7491</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l07492"></a><span class="lineno"> 7492</span>&#160; </div>
<div class="line"><a name="l07493"></a><span class="lineno"> 7493</span>&#160;    <span class="comment">/* Loop over the integration points of the face. */</span></div>
<div class="line"><a name="l07494"></a><span class="lineno"> 7494</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l07495"></a><span class="lineno"> 7495</span>&#160; </div>
<div class="line"><a name="l07496"></a><span class="lineno"> 7496</span>&#160;      <span class="comment">/* Easier storage of the left and right solution and the normals</span></div>
<div class="line"><a name="l07497"></a><span class="lineno"> 7497</span>&#160;<span class="comment">         for this integration point. */</span></div>
<div class="line"><a name="l07498"></a><span class="lineno"> 7498</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solIntL + i*NPad + llNVar;</div>
<div class="line"><a name="l07499"></a><span class="lineno"> 7499</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l07500"></a><span class="lineno"> 7500</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l07501"></a><span class="lineno"> 7501</span>&#160; </div>
<div class="line"><a name="l07502"></a><span class="lineno"> 7502</span>&#160;      <span class="comment">/*--- Compute the normal velocity, the speed of sound squared and</span></div>
<div class="line"><a name="l07503"></a><span class="lineno"> 7503</span>&#160;<span class="comment">            the pressure in this integration point. ---*/</span></div>
<div class="line"><a name="l07504"></a><span class="lineno"> 7504</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv = 1.0/UL[0];</div>
<div class="line"><a name="l07505"></a><span class="lineno"> 7505</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> VelocityNormal = 0.0, Velocity2 = 0.0;</div>
<div class="line"><a name="l07506"></a><span class="lineno"> 7506</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l07507"></a><span class="lineno"> 7507</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel = UL[iDim+1]*DensityInv;</div>
<div class="line"><a name="l07508"></a><span class="lineno"> 7508</span>&#160;        VelocityNormal     += vel*normals[iDim];</div>
<div class="line"><a name="l07509"></a><span class="lineno"> 7509</span>&#160;        Velocity2          += vel*vel;</div>
<div class="line"><a name="l07510"></a><span class="lineno"> 7510</span>&#160;      }</div>
<div class="line"><a name="l07511"></a><span class="lineno"> 7511</span>&#160; </div>
<div class="line"><a name="l07512"></a><span class="lineno"> 7512</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = UL[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*DensityInv - 0.5*Velocity2;</div>
<div class="line"><a name="l07513"></a><span class="lineno"> 7513</span>&#160; </div>
<div class="line"><a name="l07514"></a><span class="lineno"> 7514</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(UL[0], StaticEnergy);</div>
<div class="line"><a name="l07515"></a><span class="lineno"> 7515</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed2 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a8c0910de10905f2ddcf02f1a9bb7ff61">GetSoundSpeed2</a>();</div>
<div class="line"><a name="l07516"></a><span class="lineno"> 7516</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l07517"></a><span class="lineno"> 7517</span>&#160; </div>
<div class="line"><a name="l07518"></a><span class="lineno"> 7518</span>&#160;      <span class="comment">/*--- Compute the Riemann invariant to be extrapolated. ---*/</span></div>
<div class="line"><a name="l07519"></a><span class="lineno"> 7519</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Riemann = 2.0*sqrt(SoundSpeed2)/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a> + VelocityNormal;</div>
<div class="line"><a name="l07520"></a><span class="lineno"> 7520</span>&#160; </div>
<div class="line"><a name="l07521"></a><span class="lineno"> 7521</span>&#160;      <span class="comment">/*--- Total speed of sound. The expression below is also valid for variable cp,</span></div>
<div class="line"><a name="l07522"></a><span class="lineno"> 7522</span>&#160;<span class="comment">            although a linearization around the value of the left state is performed. ---*/</span></div>
<div class="line"><a name="l07523"></a><span class="lineno"> 7523</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed_Total2 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(H_Total - DensityInv*(UL[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] + Pressure)</div>
<div class="line"><a name="l07524"></a><span class="lineno"> 7524</span>&#160;                                        +                  0.5*Velocity2) + SoundSpeed2;</div>
<div class="line"><a name="l07525"></a><span class="lineno"> 7525</span>&#160; </div>
<div class="line"><a name="l07526"></a><span class="lineno"> 7526</span>&#160;      <span class="comment">/*--- Dot product of normal and flow direction. This should be</span></div>
<div class="line"><a name="l07527"></a><span class="lineno"> 7527</span>&#160;<span class="comment">            negative due to outward facing boundary normal convention. ---*/</span></div>
<div class="line"><a name="l07528"></a><span class="lineno"> 7528</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> alpha = 0.0;</div>
<div class="line"><a name="l07529"></a><span class="lineno"> 7529</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07530"></a><span class="lineno"> 7530</span>&#160;        alpha += normals[iDim]*Flow_Dir[iDim];</div>
<div class="line"><a name="l07531"></a><span class="lineno"> 7531</span>&#160; </div>
<div class="line"><a name="l07532"></a><span class="lineno"> 7532</span>&#160;      <span class="comment">/*--- Coefficients in the quadratic equation for the magnitude of the velocity. ---*/</span></div>
<div class="line"><a name="l07533"></a><span class="lineno"> 7533</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> aa =  1.0 + 0.5*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*alpha*alpha;</div>
<div class="line"><a name="l07534"></a><span class="lineno"> 7534</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> bb = -1.0*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*alpha*Riemann;</div>
<div class="line"><a name="l07535"></a><span class="lineno"> 7535</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> cc =  0.5*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*Riemann*Riemann</div>
<div class="line"><a name="l07536"></a><span class="lineno"> 7536</span>&#160;                         -  2.0*SoundSpeed_Total2/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>;</div>
<div class="line"><a name="l07537"></a><span class="lineno"> 7537</span>&#160; </div>
<div class="line"><a name="l07538"></a><span class="lineno"> 7538</span>&#160;      <span class="comment">/*--- Solve the equation for the magnitude of the velocity. As this value</span></div>
<div class="line"><a name="l07539"></a><span class="lineno"> 7539</span>&#160;<span class="comment">            must be positive and both aa and bb are positive (alpha is negative and</span></div>
<div class="line"><a name="l07540"></a><span class="lineno"> 7540</span>&#160;<span class="comment">            Riemann is positive up till Mach = 5.0 or so, which is not really subsonic</span></div>
<div class="line"><a name="l07541"></a><span class="lineno"> 7541</span>&#160;<span class="comment">            anymore), it is clear which of the two possible solutions must be taken.</span></div>
<div class="line"><a name="l07542"></a><span class="lineno"> 7542</span>&#160;<span class="comment">            Some clipping is present, but this is normally not active. ---*/</span></div>
<div class="line"><a name="l07543"></a><span class="lineno"> 7543</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dd      = bb*bb - 4.0*aa*cc;   dd      = sqrt(max(0.0, dd));</div>
<div class="line"><a name="l07544"></a><span class="lineno"> 7544</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Vel_Mag = (-bb + dd)/(2.0*aa); Vel_Mag = max(0.0, Vel_Mag);</div>
<div class="line"><a name="l07545"></a><span class="lineno"> 7545</span>&#160;      Velocity2 = Vel_Mag*Vel_Mag;</div>
<div class="line"><a name="l07546"></a><span class="lineno"> 7546</span>&#160; </div>
<div class="line"><a name="l07547"></a><span class="lineno"> 7547</span>&#160;      <span class="comment">/*--- Compute speed of sound from total speed of sound eqn. ---*/</span></div>
<div class="line"><a name="l07548"></a><span class="lineno"> 7548</span>&#160;      SoundSpeed2 = SoundSpeed_Total2 - 0.5*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*Velocity2;</div>
<div class="line"><a name="l07549"></a><span class="lineno"> 7549</span>&#160; </div>
<div class="line"><a name="l07550"></a><span class="lineno"> 7550</span>&#160;      <span class="comment">/*--- Mach squared (cut between 0-1), use to adapt velocity ---*/</span></div>
<div class="line"><a name="l07551"></a><span class="lineno"> 7551</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Mach2 = Velocity2/SoundSpeed2; Mach2 = min(1.0, Mach2);</div>
<div class="line"><a name="l07552"></a><span class="lineno"> 7552</span>&#160; </div>
<div class="line"><a name="l07553"></a><span class="lineno"> 7553</span>&#160;      Velocity2 = Mach2*SoundSpeed2;</div>
<div class="line"><a name="l07554"></a><span class="lineno"> 7554</span>&#160;      Vel_Mag   = sqrt(Velocity2);</div>
<div class="line"><a name="l07555"></a><span class="lineno"> 7555</span>&#160; </div>
<div class="line"><a name="l07556"></a><span class="lineno"> 7556</span>&#160;      <span class="comment">/*--- Static temperature from the speed of sound relation. ---*/</span></div>
<div class="line"><a name="l07557"></a><span class="lineno"> 7557</span>&#160;      SoundSpeed2 = SoundSpeed_Total2 - 0.5*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*Velocity2;</div>
<div class="line"><a name="l07558"></a><span class="lineno"> 7558</span>&#160; </div>
<div class="line"><a name="l07559"></a><span class="lineno"> 7559</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Temperature = SoundSpeed2/(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*Gas_Constant);</div>
<div class="line"><a name="l07560"></a><span class="lineno"> 7560</span>&#160; </div>
<div class="line"><a name="l07561"></a><span class="lineno"> 7561</span>&#160;      <span class="comment">/*--- Static pressure using isentropic relation at a point ---*/</span></div>
<div class="line"><a name="l07562"></a><span class="lineno"> 7562</span>&#160;      Pressure = P_Total*pow((Temperature/T_Total), <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>);</div>
<div class="line"><a name="l07563"></a><span class="lineno"> 7563</span>&#160; </div>
<div class="line"><a name="l07564"></a><span class="lineno"> 7564</span>&#160;      <span class="comment">/*--- Density at the inlet from the gas law ---*/</span></div>
<div class="line"><a name="l07565"></a><span class="lineno"> 7565</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Density = Pressure/(Gas_Constant*Temperature);</div>
<div class="line"><a name="l07566"></a><span class="lineno"> 7566</span>&#160; </div>
<div class="line"><a name="l07567"></a><span class="lineno"> 7567</span>&#160;      <span class="comment">/*--- Store the conservative variables in UR. ---*/</span></div>
<div class="line"><a name="l07568"></a><span class="lineno"> 7568</span>&#160;      UR[0]      = Density;</div>
<div class="line"><a name="l07569"></a><span class="lineno"> 7569</span>&#160;      UR[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = Pressure/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a> + 0.5*Density*Velocity2;</div>
<div class="line"><a name="l07570"></a><span class="lineno"> 7570</span>&#160; </div>
<div class="line"><a name="l07571"></a><span class="lineno"> 7571</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07572"></a><span class="lineno"> 7572</span>&#160;        UR[iDim+1] = Density*Vel_Mag*Flow_Dir[iDim];</div>
<div class="line"><a name="l07573"></a><span class="lineno"> 7573</span>&#160;    }</div>
<div class="line"><a name="l07574"></a><span class="lineno"> 7574</span>&#160;  }</div>
<div class="line"><a name="l07575"></a><span class="lineno"> 7575</span>&#160;}</div>
<div class="line"><a name="l07576"></a><span class="lineno"> 7576</span>&#160; </div>
<div class="line"><a name="l07577"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a3233306f97b6173c5c109cae04a4c9be"> 7577</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3233306f97b6173c5c109cae04a4c9be">CFEM_DG_EulerSolver::BoundaryStates_Outlet</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l07578"></a><span class="lineno"> 7578</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l07579"></a><span class="lineno"> 7579</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l07580"></a><span class="lineno"> 7580</span>&#160;                                                <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l07581"></a><span class="lineno"> 7581</span>&#160;                                                <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l07582"></a><span class="lineno"> 7582</span>&#160;                                                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *solIntL,</div>
<div class="line"><a name="l07583"></a><span class="lineno"> 7583</span>&#160;                                                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *solIntR) {</div>
<div class="line"><a name="l07584"></a><span class="lineno"> 7584</span>&#160; </div>
<div class="line"><a name="l07585"></a><span class="lineno"> 7585</span>&#160;  <span class="comment">/*--- Retrieve the specified back pressure for this outlet.</span></div>
<div class="line"><a name="l07586"></a><span class="lineno"> 7586</span>&#160;<span class="comment">        Nondimensionalize, if necessary. ---*/</span></div>
<div class="line"><a name="l07587"></a><span class="lineno"> 7587</span>&#160;  <span class="keywordtype">string</span> Marker_Tag = config-&gt;<a class="code" href="class_c_config.html#a967e969a3beb24bb6e57d7036af003be">GetMarker_All_TagBound</a>(val_marker);</div>
<div class="line"><a name="l07588"></a><span class="lineno"> 7588</span>&#160; </div>
<div class="line"><a name="l07589"></a><span class="lineno"> 7589</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> P_Exit = config-&gt;<a class="code" href="class_c_config.html#a2fe0babb15a85eac009543a6915b2d33">GetOutlet_Pressure</a>(Marker_Tag);</div>
<div class="line"><a name="l07590"></a><span class="lineno"> 7590</span>&#160;  P_Exit = P_Exit/config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>();</div>
<div class="line"><a name="l07591"></a><span class="lineno"> 7591</span>&#160; </div>
<div class="line"><a name="l07592"></a><span class="lineno"> 7592</span>&#160;  <span class="comment">/* Get the required information from the standard element, which is the</span></div>
<div class="line"><a name="l07593"></a><span class="lineno"> 7593</span>&#160;<span class="comment">     same for all simultaneously treated faces. */</span></div>
<div class="line"><a name="l07594"></a><span class="lineno"> 7594</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind  = surfElem[0].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l07595"></a><span class="lineno"> 7595</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l07596"></a><span class="lineno"> 7596</span>&#160; </div>
<div class="line"><a name="l07597"></a><span class="lineno"> 7597</span>&#160;  <span class="comment">/* Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l07598"></a><span class="lineno"> 7598</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l07599"></a><span class="lineno"> 7599</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l07600"></a><span class="lineno"> 7600</span>&#160; </div>
<div class="line"><a name="l07601"></a><span class="lineno"> 7601</span>&#160;    <span class="comment">/* Loop over the integration points of the face. */</span></div>
<div class="line"><a name="l07602"></a><span class="lineno"> 7602</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l07603"></a><span class="lineno"> 7603</span>&#160; </div>
<div class="line"><a name="l07604"></a><span class="lineno"> 7604</span>&#160;      <span class="comment">/* Easier storage of the left and right solution and the normals</span></div>
<div class="line"><a name="l07605"></a><span class="lineno"> 7605</span>&#160;<span class="comment">         for this integration point. */</span></div>
<div class="line"><a name="l07606"></a><span class="lineno"> 7606</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solIntL + i*NPad + llNVar;</div>
<div class="line"><a name="l07607"></a><span class="lineno"> 7607</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l07608"></a><span class="lineno"> 7608</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l07609"></a><span class="lineno"> 7609</span>&#160; </div>
<div class="line"><a name="l07610"></a><span class="lineno"> 7610</span>&#160;      <span class="comment">/*--- Compute the normal velocity, the speed of sound squared and</span></div>
<div class="line"><a name="l07611"></a><span class="lineno"> 7611</span>&#160;<span class="comment">            the pressure in this integration point. ---*/</span></div>
<div class="line"><a name="l07612"></a><span class="lineno"> 7612</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv = 1.0/UL[0];</div>
<div class="line"><a name="l07613"></a><span class="lineno"> 7613</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> VelocityNormal = 0.0, Velocity2 = 0.0;</div>
<div class="line"><a name="l07614"></a><span class="lineno"> 7614</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l07615"></a><span class="lineno"> 7615</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel = UL[iDim+1]*DensityInv;</div>
<div class="line"><a name="l07616"></a><span class="lineno"> 7616</span>&#160;        VelocityNormal     += vel*normals[iDim];</div>
<div class="line"><a name="l07617"></a><span class="lineno"> 7617</span>&#160;        Velocity2          += vel*vel;</div>
<div class="line"><a name="l07618"></a><span class="lineno"> 7618</span>&#160;      }</div>
<div class="line"><a name="l07619"></a><span class="lineno"> 7619</span>&#160; </div>
<div class="line"><a name="l07620"></a><span class="lineno"> 7620</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = UL[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*DensityInv - 0.5*Velocity2;</div>
<div class="line"><a name="l07621"></a><span class="lineno"> 7621</span>&#160; </div>
<div class="line"><a name="l07622"></a><span class="lineno"> 7622</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(UL[0], StaticEnergy);</div>
<div class="line"><a name="l07623"></a><span class="lineno"> 7623</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed2 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a8c0910de10905f2ddcf02f1a9bb7ff61">GetSoundSpeed2</a>();</div>
<div class="line"><a name="l07624"></a><span class="lineno"> 7624</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l07625"></a><span class="lineno"> 7625</span>&#160; </div>
<div class="line"><a name="l07626"></a><span class="lineno"> 7626</span>&#160;      <span class="comment">/*--- Subsonic exit flow: there is one incoming characteristic,</span></div>
<div class="line"><a name="l07627"></a><span class="lineno"> 7627</span>&#160;<span class="comment">            therefore one variable can be specified (back pressure) and is used</span></div>
<div class="line"><a name="l07628"></a><span class="lineno"> 7628</span>&#160;<span class="comment">            to update the conservative variables. Compute the entropy and the</span></div>
<div class="line"><a name="l07629"></a><span class="lineno"> 7629</span>&#160;<span class="comment">            acoustic Riemann variable. These invariants, as well as the</span></div>
<div class="line"><a name="l07630"></a><span class="lineno"> 7630</span>&#160;<span class="comment">            tangential velocity components, are extrapolated. ---*/</span></div>
<div class="line"><a name="l07631"></a><span class="lineno"> 7631</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Entropy = Pressure*pow(DensityInv, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>);</div>
<div class="line"><a name="l07632"></a><span class="lineno"> 7632</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Riemann = 2.0*sqrt(SoundSpeed2)/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a> + VelocityNormal;</div>
<div class="line"><a name="l07633"></a><span class="lineno"> 7633</span>&#160; </div>
<div class="line"><a name="l07634"></a><span class="lineno"> 7634</span>&#160;      <span class="comment">/*--- Compute the density and normal velocity of the right state. ---*/</span></div>
<div class="line"><a name="l07635"></a><span class="lineno"> 7635</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Density    = pow(P_Exit/Entropy,1.0/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>);</div>
<div class="line"><a name="l07636"></a><span class="lineno"> 7636</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed = sqrt(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*P_Exit/Density);</div>
<div class="line"><a name="l07637"></a><span class="lineno"> 7637</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Vn_Exit    = Riemann - 2.0*SoundSpeed/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>;</div>
<div class="line"><a name="l07638"></a><span class="lineno"> 7638</span>&#160; </div>
<div class="line"><a name="l07639"></a><span class="lineno"> 7639</span>&#160;      <span class="comment">/*--- Store the conservative variables in UR. ---*/</span></div>
<div class="line"><a name="l07640"></a><span class="lineno"> 7640</span>&#160;      Velocity2 = 0.0;</div>
<div class="line"><a name="l07641"></a><span class="lineno"> 7641</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l07642"></a><span class="lineno"> 7642</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel = UL[iDim+1]*DensityInv</div>
<div class="line"><a name="l07643"></a><span class="lineno"> 7643</span>&#160;                            + (Vn_Exit-VelocityNormal)*normals[iDim];</div>
<div class="line"><a name="l07644"></a><span class="lineno"> 7644</span>&#160;        Velocity2 += vel*vel;</div>
<div class="line"><a name="l07645"></a><span class="lineno"> 7645</span>&#160;        UR[iDim+1] = Density*vel;</div>
<div class="line"><a name="l07646"></a><span class="lineno"> 7646</span>&#160;      }</div>
<div class="line"><a name="l07647"></a><span class="lineno"> 7647</span>&#160; </div>
<div class="line"><a name="l07648"></a><span class="lineno"> 7648</span>&#160;      UR[0]      = Density;</div>
<div class="line"><a name="l07649"></a><span class="lineno"> 7649</span>&#160;      UR[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = Pressure/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a> + 0.5*Density*Velocity2;</div>
<div class="line"><a name="l07650"></a><span class="lineno"> 7650</span>&#160;    }</div>
<div class="line"><a name="l07651"></a><span class="lineno"> 7651</span>&#160;  }</div>
<div class="line"><a name="l07652"></a><span class="lineno"> 7652</span>&#160;}</div>
<div class="line"><a name="l07653"></a><span class="lineno"> 7653</span>&#160; </div>
<div class="line"><a name="l07654"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a5bfdc0bca1daa8e5d716d4fc3c7f5867"> 7654</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5bfdc0bca1daa8e5d716d4fc3c7f5867">CFEM_DG_EulerSolver::BoundaryStates_Riemann</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l07655"></a><span class="lineno"> 7655</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l07656"></a><span class="lineno"> 7656</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l07657"></a><span class="lineno"> 7657</span>&#160;                                                 <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l07658"></a><span class="lineno"> 7658</span>&#160;                                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l07659"></a><span class="lineno"> 7659</span>&#160;                                                 <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *solIntL,</div>
<div class="line"><a name="l07660"></a><span class="lineno"> 7660</span>&#160;                                                 <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *solIntR) {</div>
<div class="line"><a name="l07661"></a><span class="lineno"> 7661</span>&#160; </div>
<div class="line"><a name="l07662"></a><span class="lineno"> 7662</span>&#160;  <span class="comment">/* Retrieve the corresponding string for this marker. */</span></div>
<div class="line"><a name="l07663"></a><span class="lineno"> 7663</span>&#160;  <span class="keywordtype">string</span> Marker_Tag = config-&gt;<a class="code" href="class_c_config.html#a967e969a3beb24bb6e57d7036af003be">GetMarker_All_TagBound</a>(val_marker);</div>
<div class="line"><a name="l07664"></a><span class="lineno"> 7664</span>&#160; </div>
<div class="line"><a name="l07665"></a><span class="lineno"> 7665</span>&#160;  <span class="comment">/* Determine the number of integration points for the face, which is</span></div>
<div class="line"><a name="l07666"></a><span class="lineno"> 7666</span>&#160;<span class="comment">     the same for all simultaneously treated faces. */</span></div>
<div class="line"><a name="l07667"></a><span class="lineno"> 7667</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind  = surfElem[0].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l07668"></a><span class="lineno"> 7668</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l07669"></a><span class="lineno"> 7669</span>&#160; </div>
<div class="line"><a name="l07670"></a><span class="lineno"> 7670</span>&#160;  <span class="comment">/*--- Make a distinction between the different type of boundary conditions</span></div>
<div class="line"><a name="l07671"></a><span class="lineno"> 7671</span>&#160;<span class="comment">        and set the initial guess of the right states in the integration</span></div>
<div class="line"><a name="l07672"></a><span class="lineno"> 7672</span>&#160;<span class="comment">        points of the face. ---*/</span></div>
<div class="line"><a name="l07673"></a><span class="lineno"> 7673</span>&#160;  <span class="keywordflow">switch</span>( config-&gt;<a class="code" href="class_c_config.html#a2da60a55b89307f3a0cc98aad0d84581">GetKind_Data_Riemann</a>(Marker_Tag) ) {</div>
<div class="line"><a name="l07674"></a><span class="lineno"> 7674</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a5d71f391b914291d278ea064ff1d630aa4e7c809b164ce0e69b9bf6b0de9c2be6">TOTAL_CONDITIONS_PT</a>: {</div>
<div class="line"><a name="l07675"></a><span class="lineno"> 7675</span>&#160; </div>
<div class="line"><a name="l07676"></a><span class="lineno"> 7676</span>&#160;      <span class="comment">/* Total conditions specified. Retrieve the non-dimensional total</span></div>
<div class="line"><a name="l07677"></a><span class="lineno"> 7677</span>&#160;<span class="comment">         pressure and temperature as well as the flow direction. */</span></div>
<div class="line"><a name="l07678"></a><span class="lineno"> 7678</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> P_Total   = config-&gt;<a class="code" href="class_c_config.html#ad12ed151b8d775fc13358c090d6ed028">GetRiemann_Var1</a>(Marker_Tag);</div>
<div class="line"><a name="l07679"></a><span class="lineno"> 7679</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> T_Total   = config-&gt;<a class="code" href="class_c_config.html#a0a57191f369bf048976ea80590688c3c">GetRiemann_Var2</a>(Marker_Tag);</div>
<div class="line"><a name="l07680"></a><span class="lineno"> 7680</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *Flow_Dir = config-&gt;<a class="code" href="class_c_config.html#a9045d1fd0c03ccf094f511b8c695529f">GetRiemann_FlowDir</a>(Marker_Tag);</div>
<div class="line"><a name="l07681"></a><span class="lineno"> 7681</span>&#160; </div>
<div class="line"><a name="l07682"></a><span class="lineno"> 7682</span>&#160;      P_Total /= config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>();</div>
<div class="line"><a name="l07683"></a><span class="lineno"> 7683</span>&#160;      T_Total /= config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>();</div>
<div class="line"><a name="l07684"></a><span class="lineno"> 7684</span>&#160; </div>
<div class="line"><a name="l07685"></a><span class="lineno"> 7685</span>&#160;      <span class="comment">/* Compute the total enthalpy and entropy from these values. */</span></div>
<div class="line"><a name="l07686"></a><span class="lineno"> 7686</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aba62ecbb521322a3c475561f84d77a1a">SetTDState_PT</a>(P_Total, T_Total);</div>
<div class="line"><a name="l07687"></a><span class="lineno"> 7687</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Enthalpy_e = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a99d4d8c322ea4f1072e0326f09154318">GetStaticEnergy</a>()</div>
<div class="line"><a name="l07688"></a><span class="lineno"> 7688</span>&#160;                                 + <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>()/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ab386408b4b890e3e27be7a28a740d1ae">GetDensity</a>();</div>
<div class="line"><a name="l07689"></a><span class="lineno"> 7689</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Entropy_e  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ae58726982aa144f14d097c86ae76e871">GetEntropy</a>();</div>
<div class="line"><a name="l07690"></a><span class="lineno"> 7690</span>&#160; </div>
<div class="line"><a name="l07691"></a><span class="lineno"> 7691</span>&#160;      <span class="comment">/* Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l07692"></a><span class="lineno"> 7692</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l07693"></a><span class="lineno"> 7693</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l07694"></a><span class="lineno"> 7694</span>&#160; </div>
<div class="line"><a name="l07695"></a><span class="lineno"> 7695</span>&#160;        <span class="comment">/* Loop over the integration points of the face. */</span></div>
<div class="line"><a name="l07696"></a><span class="lineno"> 7696</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l07697"></a><span class="lineno"> 7697</span>&#160; </div>
<div class="line"><a name="l07698"></a><span class="lineno"> 7698</span>&#160;          <span class="comment">/* Easier storage of the left and right solution</span></div>
<div class="line"><a name="l07699"></a><span class="lineno"> 7699</span>&#160;<span class="comment">             for this integration point. */</span></div>
<div class="line"><a name="l07700"></a><span class="lineno"> 7700</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL = solIntL + i*NPad + llNVar;</div>
<div class="line"><a name="l07701"></a><span class="lineno"> 7701</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *UR = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l07702"></a><span class="lineno"> 7702</span>&#160; </div>
<div class="line"><a name="l07703"></a><span class="lineno"> 7703</span>&#160;          <span class="comment">/* Compute the velocity squared of the left point. This value is</span></div>
<div class="line"><a name="l07704"></a><span class="lineno"> 7704</span>&#160;<span class="comment">             extrapolated and is therefore also the velocity of the right point. */</span></div>
<div class="line"><a name="l07705"></a><span class="lineno"> 7705</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv = 1.0/UL[0];</div>
<div class="line"><a name="l07706"></a><span class="lineno"> 7706</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Velocity2_e = 0.0;</div>
<div class="line"><a name="l07707"></a><span class="lineno"> 7707</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=1; iDim&lt;=<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l07708"></a><span class="lineno"> 7708</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel = UL[iDim]*DensityInv;</div>
<div class="line"><a name="l07709"></a><span class="lineno"> 7709</span>&#160;            Velocity2_e        += vel*vel;</div>
<div class="line"><a name="l07710"></a><span class="lineno"> 7710</span>&#160;          }</div>
<div class="line"><a name="l07711"></a><span class="lineno"> 7711</span>&#160; </div>
<div class="line"><a name="l07712"></a><span class="lineno"> 7712</span>&#160;          <span class="comment">/* Determine the static enthalpy, the density and the internal</span></div>
<div class="line"><a name="l07713"></a><span class="lineno"> 7713</span>&#160;<span class="comment">             and total energy per unit mass for the right state. */</span></div>
<div class="line"><a name="l07714"></a><span class="lineno"> 7714</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnthalpy_e = Enthalpy_e - 0.5*Velocity2_e;</div>
<div class="line"><a name="l07715"></a><span class="lineno"> 7715</span>&#160; </div>
<div class="line"><a name="l07716"></a><span class="lineno"> 7716</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a445de8d73576e76b0264c2fc7e3430ad">SetTDState_hs</a>(StaticEnthalpy_e, Entropy_e);</div>
<div class="line"><a name="l07717"></a><span class="lineno"> 7717</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Density_e = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ab386408b4b890e3e27be7a28a740d1ae">GetDensity</a>();</div>
<div class="line"><a name="l07718"></a><span class="lineno"> 7718</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy_e = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a99d4d8c322ea4f1072e0326f09154318">GetStaticEnergy</a>();</div>
<div class="line"><a name="l07719"></a><span class="lineno"> 7719</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Energy_e       = StaticEnergy_e + 0.5*Velocity2_e;</div>
<div class="line"><a name="l07720"></a><span class="lineno"> 7720</span>&#160; </div>
<div class="line"><a name="l07721"></a><span class="lineno"> 7721</span>&#160;          <span class="comment">/* Set the conservative variables of the right state. */</span></div>
<div class="line"><a name="l07722"></a><span class="lineno"> 7722</span>&#160;          UR[0]      = Density_e;</div>
<div class="line"><a name="l07723"></a><span class="lineno"> 7723</span>&#160;          UR[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = Density_e*Energy_e;</div>
<div class="line"><a name="l07724"></a><span class="lineno"> 7724</span>&#160; </div>
<div class="line"><a name="l07725"></a><span class="lineno"> 7725</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> momTot = Density_e*sqrt(Velocity2_e);</div>
<div class="line"><a name="l07726"></a><span class="lineno"> 7726</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07727"></a><span class="lineno"> 7727</span>&#160;            UR[iDim+1] = momTot*Flow_Dir[iDim];</div>
<div class="line"><a name="l07728"></a><span class="lineno"> 7728</span>&#160;        }</div>
<div class="line"><a name="l07729"></a><span class="lineno"> 7729</span>&#160;      }</div>
<div class="line"><a name="l07730"></a><span class="lineno"> 7730</span>&#160; </div>
<div class="line"><a name="l07731"></a><span class="lineno"> 7731</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07732"></a><span class="lineno"> 7732</span>&#160;    }</div>
<div class="line"><a name="l07733"></a><span class="lineno"> 7733</span>&#160; </div>
<div class="line"><a name="l07734"></a><span class="lineno"> 7734</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a5d71f391b914291d278ea064ff1d630aae3e034605bb816c85708093e4feba319">STATIC_SUPERSONIC_INFLOW_PT</a>: {</div>
<div class="line"><a name="l07735"></a><span class="lineno"> 7735</span>&#160; </div>
<div class="line"><a name="l07736"></a><span class="lineno"> 7736</span>&#160;      <span class="comment">/* Supersonic inlet with specified pressure, temperature and Mach</span></div>
<div class="line"><a name="l07737"></a><span class="lineno"> 7737</span>&#160;<span class="comment">         number. Retrieve the non-dimensional static pressure and</span></div>
<div class="line"><a name="l07738"></a><span class="lineno"> 7738</span>&#160;<span class="comment">         temperature as well as the three components of the Mach number. */</span></div>
<div class="line"><a name="l07739"></a><span class="lineno"> 7739</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> P_static = config-&gt;<a class="code" href="class_c_config.html#ad12ed151b8d775fc13358c090d6ed028">GetRiemann_Var1</a>(Marker_Tag);</div>
<div class="line"><a name="l07740"></a><span class="lineno"> 7740</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> T_static = config-&gt;<a class="code" href="class_c_config.html#a0a57191f369bf048976ea80590688c3c">GetRiemann_Var2</a>(Marker_Tag);</div>
<div class="line"><a name="l07741"></a><span class="lineno"> 7741</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *Mach    = config-&gt;<a class="code" href="class_c_config.html#a9045d1fd0c03ccf094f511b8c695529f">GetRiemann_FlowDir</a>(Marker_Tag);</div>
<div class="line"><a name="l07742"></a><span class="lineno"> 7742</span>&#160; </div>
<div class="line"><a name="l07743"></a><span class="lineno"> 7743</span>&#160;      P_static /= config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>();</div>
<div class="line"><a name="l07744"></a><span class="lineno"> 7744</span>&#160;      T_static /= config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>();</div>
<div class="line"><a name="l07745"></a><span class="lineno"> 7745</span>&#160; </div>
<div class="line"><a name="l07746"></a><span class="lineno"> 7746</span>&#160;      <span class="comment">/* Compute the prescribed density, static energy per unit mass</span></div>
<div class="line"><a name="l07747"></a><span class="lineno"> 7747</span>&#160;<span class="comment">         and speed of sound. */</span></div>
<div class="line"><a name="l07748"></a><span class="lineno"> 7748</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aba62ecbb521322a3c475561f84d77a1a">SetTDState_PT</a>(P_static, T_static);</div>
<div class="line"><a name="l07749"></a><span class="lineno"> 7749</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Density_e      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ab386408b4b890e3e27be7a28a740d1ae">GetDensity</a>();</div>
<div class="line"><a name="l07750"></a><span class="lineno"> 7750</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy_e = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a99d4d8c322ea4f1072e0326f09154318">GetStaticEnergy</a>();</div>
<div class="line"><a name="l07751"></a><span class="lineno"> 7751</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a4a2b307dfa2a545c632548c8d7c6e86c">GetSoundSpeed</a>();</div>
<div class="line"><a name="l07752"></a><span class="lineno"> 7752</span>&#160; </div>
<div class="line"><a name="l07753"></a><span class="lineno"> 7753</span>&#160;      <span class="comment">/* Determine the magnitude of the Mach number. */</span></div>
<div class="line"><a name="l07754"></a><span class="lineno"> 7754</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> MachMag = 0.0;</div>
<div class="line"><a name="l07755"></a><span class="lineno"> 7755</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07756"></a><span class="lineno"> 7756</span>&#160;        MachMag += Mach[iDim]*Mach[iDim];</div>
<div class="line"><a name="l07757"></a><span class="lineno"> 7757</span>&#160;      MachMag = sqrt(MachMag);</div>
<div class="line"><a name="l07758"></a><span class="lineno"> 7758</span>&#160; </div>
<div class="line"><a name="l07759"></a><span class="lineno"> 7759</span>&#160;      <span class="comment">/* Determine the magnitude of the velocity and the prescribed</span></div>
<div class="line"><a name="l07760"></a><span class="lineno"> 7760</span>&#160;<span class="comment">         conservative variables. */</span></div>
<div class="line"><a name="l07761"></a><span class="lineno"> 7761</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> VelMag = MachMag*SoundSpeed;</div>
<div class="line"><a name="l07762"></a><span class="lineno"> 7762</span>&#160; </div>
<div class="line"><a name="l07763"></a><span class="lineno"> 7763</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> UCons[5];</div>
<div class="line"><a name="l07764"></a><span class="lineno"> 7764</span>&#160;      UCons[0]      = Density_e;</div>
<div class="line"><a name="l07765"></a><span class="lineno"> 7765</span>&#160;      UCons[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = Density_e*(StaticEnergy_e + 0.5*VelMag*VelMag);</div>
<div class="line"><a name="l07766"></a><span class="lineno"> 7766</span>&#160; </div>
<div class="line"><a name="l07767"></a><span class="lineno"> 7767</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07768"></a><span class="lineno"> 7768</span>&#160;        UCons[iDim+1] = Density_e*Mach[iDim]*SoundSpeed;</div>
<div class="line"><a name="l07769"></a><span class="lineno"> 7769</span>&#160; </div>
<div class="line"><a name="l07770"></a><span class="lineno"> 7770</span>&#160;      <span class="comment">/* Loop over the number of faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l07771"></a><span class="lineno"> 7771</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l07772"></a><span class="lineno"> 7772</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l07773"></a><span class="lineno"> 7773</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l07774"></a><span class="lineno"> 7774</span>&#160; </div>
<div class="line"><a name="l07775"></a><span class="lineno"> 7775</span>&#160;        <span class="comment">/* Loop over the integration points and set the right state. */</span></div>
<div class="line"><a name="l07776"></a><span class="lineno"> 7776</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l07777"></a><span class="lineno"> 7777</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l07778"></a><span class="lineno"> 7778</span>&#160;          memcpy(UR, UCons, nBytes);</div>
<div class="line"><a name="l07779"></a><span class="lineno"> 7779</span>&#160;        }</div>
<div class="line"><a name="l07780"></a><span class="lineno"> 7780</span>&#160;      }</div>
<div class="line"><a name="l07781"></a><span class="lineno"> 7781</span>&#160; </div>
<div class="line"><a name="l07782"></a><span class="lineno"> 7782</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07783"></a><span class="lineno"> 7783</span>&#160;    }</div>
<div class="line"><a name="l07784"></a><span class="lineno"> 7784</span>&#160; </div>
<div class="line"><a name="l07785"></a><span class="lineno"> 7785</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a5d71f391b914291d278ea064ff1d630aa3220fb2c414b80589e6e55d1158b4d00">STATIC_SUPERSONIC_INFLOW_PD</a>: {</div>
<div class="line"><a name="l07786"></a><span class="lineno"> 7786</span>&#160; </div>
<div class="line"><a name="l07787"></a><span class="lineno"> 7787</span>&#160;      <span class="comment">/* Supersonic inlet with specified pressure, temperature and Mach</span></div>
<div class="line"><a name="l07788"></a><span class="lineno"> 7788</span>&#160;<span class="comment">         number. Retrieve the non-dimensional static pressure and</span></div>
<div class="line"><a name="l07789"></a><span class="lineno"> 7789</span>&#160;<span class="comment">         temperature as well as the three components of the Mach number. */</span></div>
<div class="line"><a name="l07790"></a><span class="lineno"> 7790</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> P_static   = config-&gt;<a class="code" href="class_c_config.html#ad12ed151b8d775fc13358c090d6ed028">GetRiemann_Var1</a>(Marker_Tag);</div>
<div class="line"><a name="l07791"></a><span class="lineno"> 7791</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Rho_static = config-&gt;<a class="code" href="class_c_config.html#a0a57191f369bf048976ea80590688c3c">GetRiemann_Var2</a>(Marker_Tag);</div>
<div class="line"><a name="l07792"></a><span class="lineno"> 7792</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *Mach      = config-&gt;<a class="code" href="class_c_config.html#a9045d1fd0c03ccf094f511b8c695529f">GetRiemann_FlowDir</a>(Marker_Tag);</div>
<div class="line"><a name="l07793"></a><span class="lineno"> 7793</span>&#160; </div>
<div class="line"><a name="l07794"></a><span class="lineno"> 7794</span>&#160;      P_static /= config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>();</div>
<div class="line"><a name="l07795"></a><span class="lineno"> 7795</span>&#160;      Rho_static /= config-&gt;<a class="code" href="class_c_config.html#a8cc3d7d06d995bf315cbed96412a9b7e">GetDensity_Ref</a>();</div>
<div class="line"><a name="l07796"></a><span class="lineno"> 7796</span>&#160; </div>
<div class="line"><a name="l07797"></a><span class="lineno"> 7797</span>&#160;      <span class="comment">/* Compute the prescribed pressure, static energy per unit mass</span></div>
<div class="line"><a name="l07798"></a><span class="lineno"> 7798</span>&#160;<span class="comment">         and speed of sound. */</span></div>
<div class="line"><a name="l07799"></a><span class="lineno"> 7799</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ad93e74a6cc6610e9c31c180040bda4e6">SetTDState_Prho</a>(P_static, Rho_static);</div>
<div class="line"><a name="l07800"></a><span class="lineno"> 7800</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Density_e      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ab386408b4b890e3e27be7a28a740d1ae">GetDensity</a>();</div>
<div class="line"><a name="l07801"></a><span class="lineno"> 7801</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy_e = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a99d4d8c322ea4f1072e0326f09154318">GetStaticEnergy</a>();</div>
<div class="line"><a name="l07802"></a><span class="lineno"> 7802</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a4a2b307dfa2a545c632548c8d7c6e86c">GetSoundSpeed</a>();</div>
<div class="line"><a name="l07803"></a><span class="lineno"> 7803</span>&#160; </div>
<div class="line"><a name="l07804"></a><span class="lineno"> 7804</span>&#160;      <span class="comment">/* Determine the magnitude of the Mach number. */</span></div>
<div class="line"><a name="l07805"></a><span class="lineno"> 7805</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> MachMag = 0.0;</div>
<div class="line"><a name="l07806"></a><span class="lineno"> 7806</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07807"></a><span class="lineno"> 7807</span>&#160;        MachMag += Mach[iDim]*Mach[iDim];</div>
<div class="line"><a name="l07808"></a><span class="lineno"> 7808</span>&#160;      MachMag = sqrt(MachMag);</div>
<div class="line"><a name="l07809"></a><span class="lineno"> 7809</span>&#160; </div>
<div class="line"><a name="l07810"></a><span class="lineno"> 7810</span>&#160;      <span class="comment">/* Determine the magnitude of the velocity and the prescribed</span></div>
<div class="line"><a name="l07811"></a><span class="lineno"> 7811</span>&#160;<span class="comment">         conservative variables. */</span></div>
<div class="line"><a name="l07812"></a><span class="lineno"> 7812</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> VelMag = MachMag*SoundSpeed;</div>
<div class="line"><a name="l07813"></a><span class="lineno"> 7813</span>&#160; </div>
<div class="line"><a name="l07814"></a><span class="lineno"> 7814</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> UCons[5];</div>
<div class="line"><a name="l07815"></a><span class="lineno"> 7815</span>&#160;      UCons[0]      = Density_e;</div>
<div class="line"><a name="l07816"></a><span class="lineno"> 7816</span>&#160;      UCons[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = Density_e*(StaticEnergy_e + 0.5*VelMag*VelMag);</div>
<div class="line"><a name="l07817"></a><span class="lineno"> 7817</span>&#160; </div>
<div class="line"><a name="l07818"></a><span class="lineno"> 7818</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07819"></a><span class="lineno"> 7819</span>&#160;        UCons[iDim+1] = Density_e*Mach[iDim]*SoundSpeed;</div>
<div class="line"><a name="l07820"></a><span class="lineno"> 7820</span>&#160; </div>
<div class="line"><a name="l07821"></a><span class="lineno"> 7821</span>&#160;      <span class="comment">/* Loop over the number of faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l07822"></a><span class="lineno"> 7822</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l07823"></a><span class="lineno"> 7823</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l07824"></a><span class="lineno"> 7824</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l07825"></a><span class="lineno"> 7825</span>&#160; </div>
<div class="line"><a name="l07826"></a><span class="lineno"> 7826</span>&#160;        <span class="comment">/* Loop over the integration points and set the right state. */</span></div>
<div class="line"><a name="l07827"></a><span class="lineno"> 7827</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l07828"></a><span class="lineno"> 7828</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l07829"></a><span class="lineno"> 7829</span>&#160;          memcpy(UR, UCons, nBytes);</div>
<div class="line"><a name="l07830"></a><span class="lineno"> 7830</span>&#160;        }</div>
<div class="line"><a name="l07831"></a><span class="lineno"> 7831</span>&#160;      }</div>
<div class="line"><a name="l07832"></a><span class="lineno"> 7832</span>&#160; </div>
<div class="line"><a name="l07833"></a><span class="lineno"> 7833</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07834"></a><span class="lineno"> 7834</span>&#160;    }</div>
<div class="line"><a name="l07835"></a><span class="lineno"> 7835</span>&#160; </div>
<div class="line"><a name="l07836"></a><span class="lineno"> 7836</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a5d71f391b914291d278ea064ff1d630aa79ad8580d95c49a84a083e789310407d">DENSITY_VELOCITY</a>: {</div>
<div class="line"><a name="l07837"></a><span class="lineno"> 7837</span>&#160; </div>
<div class="line"><a name="l07838"></a><span class="lineno"> 7838</span>&#160;      <span class="comment">/* Subsonic inlet with specified density, velocity magnitude and</span></div>
<div class="line"><a name="l07839"></a><span class="lineno"> 7839</span>&#160;<span class="comment">         flow direction. Retrieve the non-dimensional data. */</span></div>
<div class="line"><a name="l07840"></a><span class="lineno"> 7840</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Density_e = config-&gt;<a class="code" href="class_c_config.html#ad12ed151b8d775fc13358c090d6ed028">GetRiemann_Var1</a>(Marker_Tag);</div>
<div class="line"><a name="l07841"></a><span class="lineno"> 7841</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> VelMag_e  = config-&gt;<a class="code" href="class_c_config.html#a0a57191f369bf048976ea80590688c3c">GetRiemann_Var2</a>(Marker_Tag);</div>
<div class="line"><a name="l07842"></a><span class="lineno"> 7842</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *Flow_Dir = config-&gt;<a class="code" href="class_c_config.html#a9045d1fd0c03ccf094f511b8c695529f">GetRiemann_FlowDir</a>(Marker_Tag);</div>
<div class="line"><a name="l07843"></a><span class="lineno"> 7843</span>&#160; </div>
<div class="line"><a name="l07844"></a><span class="lineno"> 7844</span>&#160;      Density_e /= config-&gt;<a class="code" href="class_c_config.html#a8cc3d7d06d995bf315cbed96412a9b7e">GetDensity_Ref</a>();</div>
<div class="line"><a name="l07845"></a><span class="lineno"> 7845</span>&#160;      VelMag_e  /= config-&gt;<a class="code" href="class_c_config.html#a8f2c6f68c1e3756237596a7274e713f4">GetVelocity_Ref</a>();</div>
<div class="line"><a name="l07846"></a><span class="lineno"> 7846</span>&#160; </div>
<div class="line"><a name="l07847"></a><span class="lineno"> 7847</span>&#160;      <span class="comment">/* Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l07848"></a><span class="lineno"> 7848</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l07849"></a><span class="lineno"> 7849</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l07850"></a><span class="lineno"> 7850</span>&#160; </div>
<div class="line"><a name="l07851"></a><span class="lineno"> 7851</span>&#160;        <span class="comment">/* Loop over the integration points of the face. */</span></div>
<div class="line"><a name="l07852"></a><span class="lineno"> 7852</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l07853"></a><span class="lineno"> 7853</span>&#160; </div>
<div class="line"><a name="l07854"></a><span class="lineno"> 7854</span>&#160;          <span class="comment">/* Easier storage of the left and right solution</span></div>
<div class="line"><a name="l07855"></a><span class="lineno"> 7855</span>&#160;<span class="comment">             for this integration point. */</span></div>
<div class="line"><a name="l07856"></a><span class="lineno"> 7856</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL = solIntL + i*NPad + llNVar;</div>
<div class="line"><a name="l07857"></a><span class="lineno"> 7857</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *UR = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l07858"></a><span class="lineno"> 7858</span>&#160; </div>
<div class="line"><a name="l07859"></a><span class="lineno"> 7859</span>&#160;          <span class="comment">/* Compute the total energy per unit mass, which is extrapolated. */</span></div>
<div class="line"><a name="l07860"></a><span class="lineno"> 7860</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Energy_e = UL[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]/UL[0];</div>
<div class="line"><a name="l07861"></a><span class="lineno"> 7861</span>&#160; </div>
<div class="line"><a name="l07862"></a><span class="lineno"> 7862</span>&#160;          <span class="comment">/* Set the conservative variables of the right state. */</span></div>
<div class="line"><a name="l07863"></a><span class="lineno"> 7863</span>&#160;          UR[0]      = Density_e;</div>
<div class="line"><a name="l07864"></a><span class="lineno"> 7864</span>&#160;          UR[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = Density_e*Energy_e;</div>
<div class="line"><a name="l07865"></a><span class="lineno"> 7865</span>&#160; </div>
<div class="line"><a name="l07866"></a><span class="lineno"> 7866</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> momTot = Density_e*VelMag_e;</div>
<div class="line"><a name="l07867"></a><span class="lineno"> 7867</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l07868"></a><span class="lineno"> 7868</span>&#160;            UR[iDim+1] = momTot*Flow_Dir[iDim];</div>
<div class="line"><a name="l07869"></a><span class="lineno"> 7869</span>&#160;        }</div>
<div class="line"><a name="l07870"></a><span class="lineno"> 7870</span>&#160;      }</div>
<div class="line"><a name="l07871"></a><span class="lineno"> 7871</span>&#160; </div>
<div class="line"><a name="l07872"></a><span class="lineno"> 7872</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07873"></a><span class="lineno"> 7873</span>&#160;    }</div>
<div class="line"><a name="l07874"></a><span class="lineno"> 7874</span>&#160; </div>
<div class="line"><a name="l07875"></a><span class="lineno"> 7875</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a5d71f391b914291d278ea064ff1d630aab43a8babdd78cf02702bb2fb348a8026">STATIC_PRESSURE</a>: {</div>
<div class="line"><a name="l07876"></a><span class="lineno"> 7876</span>&#160; </div>
<div class="line"><a name="l07877"></a><span class="lineno"> 7877</span>&#160;      <span class="comment">/* Subsonic outlet with specified pressure.</span></div>
<div class="line"><a name="l07878"></a><span class="lineno"> 7878</span>&#160;<span class="comment">         Retrieve the non-dimensional data. */</span></div>
<div class="line"><a name="l07879"></a><span class="lineno"> 7879</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure_e = config-&gt;<a class="code" href="class_c_config.html#ad12ed151b8d775fc13358c090d6ed028">GetRiemann_Var1</a>(Marker_Tag)</div>
<div class="line"><a name="l07880"></a><span class="lineno"> 7880</span>&#160;                                 / config-&gt;<a class="code" href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">GetPressure_Ref</a>();</div>
<div class="line"><a name="l07881"></a><span class="lineno"> 7881</span>&#160; </div>
<div class="line"><a name="l07882"></a><span class="lineno"> 7882</span>&#160;      <span class="comment">/* Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l07883"></a><span class="lineno"> 7883</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l07884"></a><span class="lineno"> 7884</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l07885"></a><span class="lineno"> 7885</span>&#160; </div>
<div class="line"><a name="l07886"></a><span class="lineno"> 7886</span>&#160;        <span class="comment">/* Loop over the integration points of the face. */</span></div>
<div class="line"><a name="l07887"></a><span class="lineno"> 7887</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l07888"></a><span class="lineno"> 7888</span>&#160; </div>
<div class="line"><a name="l07889"></a><span class="lineno"> 7889</span>&#160;          <span class="comment">/* Easier storage of the left and right solution</span></div>
<div class="line"><a name="l07890"></a><span class="lineno"> 7890</span>&#160;<span class="comment">             for this integration point. */</span></div>
<div class="line"><a name="l07891"></a><span class="lineno"> 7891</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL = solIntL + i*NPad + llNVar;</div>
<div class="line"><a name="l07892"></a><span class="lineno"> 7892</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *UR = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l07893"></a><span class="lineno"> 7893</span>&#160; </div>
<div class="line"><a name="l07894"></a><span class="lineno"> 7894</span>&#160;          <span class="comment">/* Extrapolate the density and set the thermodynamic state. */</span></div>
<div class="line"><a name="l07895"></a><span class="lineno"> 7895</span>&#160;          UR[0] = UL[0];</div>
<div class="line"><a name="l07896"></a><span class="lineno"> 7896</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#ad93e74a6cc6610e9c31c180040bda4e6">SetTDState_Prho</a>(Pressure_e, UR[0]);</div>
<div class="line"><a name="l07897"></a><span class="lineno"> 7897</span>&#160; </div>
<div class="line"><a name="l07898"></a><span class="lineno"> 7898</span>&#160;          <span class="comment">/* Extrapolate the velocity. As the density is also extrapolated,</span></div>
<div class="line"><a name="l07899"></a><span class="lineno"> 7899</span>&#160;<span class="comment">             this means that the momentum variables are identical for UL and UR.</span></div>
<div class="line"><a name="l07900"></a><span class="lineno"> 7900</span>&#160;<span class="comment">             Also determine the velocity squared. */</span></div>
<div class="line"><a name="l07901"></a><span class="lineno"> 7901</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv = 1.0/UL[0];</div>
<div class="line"><a name="l07902"></a><span class="lineno"> 7902</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Velocity2_e = 0.0;</div>
<div class="line"><a name="l07903"></a><span class="lineno"> 7903</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=1; iDim&lt;=<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l07904"></a><span class="lineno"> 7904</span>&#160;            UR[iDim] = UL[iDim];</div>
<div class="line"><a name="l07905"></a><span class="lineno"> 7905</span>&#160; </div>
<div class="line"><a name="l07906"></a><span class="lineno"> 7906</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel = UL[iDim]*DensityInv;</div>
<div class="line"><a name="l07907"></a><span class="lineno"> 7907</span>&#160;            Velocity2_e        += vel*vel;</div>
<div class="line"><a name="l07908"></a><span class="lineno"> 7908</span>&#160;          }</div>
<div class="line"><a name="l07909"></a><span class="lineno"> 7909</span>&#160; </div>
<div class="line"><a name="l07910"></a><span class="lineno"> 7910</span>&#160;          <span class="comment">/* Compute the total energy per unit volume. */</span></div>
<div class="line"><a name="l07911"></a><span class="lineno"> 7911</span>&#160;          UR[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = UR[0]*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a99d4d8c322ea4f1072e0326f09154318">GetStaticEnergy</a>() + 0.5*Velocity2_e);</div>
<div class="line"><a name="l07912"></a><span class="lineno"> 7912</span>&#160;        }</div>
<div class="line"><a name="l07913"></a><span class="lineno"> 7913</span>&#160;      }</div>
<div class="line"><a name="l07914"></a><span class="lineno"> 7914</span>&#160; </div>
<div class="line"><a name="l07915"></a><span class="lineno"> 7915</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l07916"></a><span class="lineno"> 7916</span>&#160;    }</div>
<div class="line"><a name="l07917"></a><span class="lineno"> 7917</span>&#160; </div>
<div class="line"><a name="l07918"></a><span class="lineno"> 7918</span>&#160;    <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l07919"></a><span class="lineno"> 7919</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;Invalid Riemann input!&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l07920"></a><span class="lineno"> 7920</span>&#160;    }</div>
<div class="line"><a name="l07921"></a><span class="lineno"> 7921</span>&#160;  }</div>
<div class="line"><a name="l07922"></a><span class="lineno"> 7922</span>&#160; </div>
<div class="line"><a name="l07923"></a><span class="lineno"> 7923</span>&#160;<span class="comment">  /***************************************************************************/</span></div>
<div class="line"><a name="l07924"></a><span class="lineno"> 7924</span>&#160;  <span class="comment">/* Correction of the boundary state using a characteristic reconstruction. */</span></div>
<div class="line"><a name="l07925"></a><span class="lineno"> 7925</span>&#160;<span class="comment">  /***************************************************************************/</span></div>
<div class="line"><a name="l07926"></a><span class="lineno"> 7926</span>&#160; </div>
<div class="line"><a name="l07927"></a><span class="lineno"> 7927</span>&#160;  <span class="comment">/* Make a distinction between 2D and 3D. */</span></div>
<div class="line"><a name="l07928"></a><span class="lineno"> 7928</span>&#160;  <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l07929"></a><span class="lineno"> 7929</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l07930"></a><span class="lineno"> 7930</span>&#160; </div>
<div class="line"><a name="l07931"></a><span class="lineno"> 7931</span>&#160;      <span class="comment">/* Two-dimensional simulation.</span></div>
<div class="line"><a name="l07932"></a><span class="lineno"> 7932</span>&#160;<span class="comment">         Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l07933"></a><span class="lineno"> 7933</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l07934"></a><span class="lineno"> 7934</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l07935"></a><span class="lineno"> 7935</span>&#160; </div>
<div class="line"><a name="l07936"></a><span class="lineno"> 7936</span>&#160;        <span class="comment">/* Loop over the integration points of the face. */</span></div>
<div class="line"><a name="l07937"></a><span class="lineno"> 7937</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l07938"></a><span class="lineno"> 7938</span>&#160; </div>
<div class="line"><a name="l07939"></a><span class="lineno"> 7939</span>&#160;          <span class="comment">/* Easier storage of the left and right solution and the normals</span></div>
<div class="line"><a name="l07940"></a><span class="lineno"> 7940</span>&#160;<span class="comment">             for this integration point. */</span></div>
<div class="line"><a name="l07941"></a><span class="lineno"> 7941</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solIntL + i*NPad + llNVar;</div>
<div class="line"><a name="l07942"></a><span class="lineno"> 7942</span>&#160;                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l07943"></a><span class="lineno"> 7943</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l07944"></a><span class="lineno"> 7944</span>&#160; </div>
<div class="line"><a name="l07945"></a><span class="lineno"> 7945</span>&#160;          <span class="comment">/* Compute the difference in conservative variables. */</span></div>
<div class="line"><a name="l07946"></a><span class="lineno"> 7946</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dr  = UR[0] - UL[0];</div>
<div class="line"><a name="l07947"></a><span class="lineno"> 7947</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dru = UR[1] - UL[1];</div>
<div class="line"><a name="l07948"></a><span class="lineno"> 7948</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drv = UR[2] - UL[2];</div>
<div class="line"><a name="l07949"></a><span class="lineno"> 7949</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drE = UR[3] - UL[3];</div>
<div class="line"><a name="l07950"></a><span class="lineno"> 7950</span>&#160; </div>
<div class="line"><a name="l07951"></a><span class="lineno"> 7951</span>&#160;          <span class="comment">/* Compute the primitive variables of the left state. */</span></div>
<div class="line"><a name="l07952"></a><span class="lineno"> 7952</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tmp    = 1.0/UL[0];</div>
<div class="line"><a name="l07953"></a><span class="lineno"> 7953</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vxL    = tmp*UL[1];</div>
<div class="line"><a name="l07954"></a><span class="lineno"> 7954</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vyL    = tmp*UL[2];</div>
<div class="line"><a name="l07955"></a><span class="lineno"> 7955</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> alphaL = 0.5*(vxL*vxL + vyL*vyL);</div>
<div class="line"><a name="l07956"></a><span class="lineno"> 7956</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> eL     = tmp*UL[3] - alphaL;</div>
<div class="line"><a name="l07957"></a><span class="lineno"> 7957</span>&#160; </div>
<div class="line"><a name="l07958"></a><span class="lineno"> 7958</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nx  = normals[0];</div>
<div class="line"><a name="l07959"></a><span class="lineno"> 7959</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ny  = normals[1];</div>
<div class="line"><a name="l07960"></a><span class="lineno"> 7960</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnL = vxL*nx + vyL*ny;</div>
<div class="line"><a name="l07961"></a><span class="lineno"> 7961</span>&#160; </div>
<div class="line"><a name="l07962"></a><span class="lineno"> 7962</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(UL[0], eL);</div>
<div class="line"><a name="l07963"></a><span class="lineno"> 7963</span>&#160; </div>
<div class="line"><a name="l07964"></a><span class="lineno"> 7964</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> aL  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a4a2b307dfa2a545c632548c8d7c6e86c">GetSoundSpeed</a>();</div>
<div class="line"><a name="l07965"></a><span class="lineno"> 7965</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> a2L = aL*aL;</div>
<div class="line"><a name="l07966"></a><span class="lineno"> 7966</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pL  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l07967"></a><span class="lineno"> 7967</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> HL  = (UL[3] + pL)*tmp;</div>
<div class="line"><a name="l07968"></a><span class="lineno"> 7968</span>&#160; </div>
<div class="line"><a name="l07969"></a><span class="lineno"> 7969</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ovaL  = 1.0/aL;</div>
<div class="line"><a name="l07970"></a><span class="lineno"> 7970</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ova2L = 1.0/a2L;</div>
<div class="line"><a name="l07971"></a><span class="lineno"> 7971</span>&#160; </div>
<div class="line"><a name="l07972"></a><span class="lineno"> 7972</span>&#160;          <span class="comment">/* Compute the eigenvalues. */</span></div>
<div class="line"><a name="l07973"></a><span class="lineno"> 7973</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam1 = vnL + aL;</div>
<div class="line"><a name="l07974"></a><span class="lineno"> 7974</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam2 = vnL - aL;</div>
<div class="line"><a name="l07975"></a><span class="lineno"> 7975</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam3 = vnL;</div>
<div class="line"><a name="l07976"></a><span class="lineno"> 7976</span>&#160; </div>
<div class="line"><a name="l07977"></a><span class="lineno"> 7977</span>&#160;          <span class="comment">/* For the characteristic reconstruction, only the outgoing</span></div>
<div class="line"><a name="l07978"></a><span class="lineno"> 7978</span>&#160;<span class="comment">             characteristics (negative eigenvalues) must be taken into account.</span></div>
<div class="line"><a name="l07979"></a><span class="lineno"> 7979</span>&#160;<span class="comment">             Set the eigenvalues accordingly. */</span></div>
<div class="line"><a name="l07980"></a><span class="lineno"> 7980</span>&#160;          lam1 = (lam1 &lt; 0.0) ? 1.0 : 0.0;</div>
<div class="line"><a name="l07981"></a><span class="lineno"> 7981</span>&#160;          lam2 = (lam2 &lt; 0.0) ? 1.0 : 0.0;</div>
<div class="line"><a name="l07982"></a><span class="lineno"> 7982</span>&#160;          lam3 = (lam3 &lt; 0.0) ? 1.0 : 0.0;</div>
<div class="line"><a name="l07983"></a><span class="lineno"> 7983</span>&#160; </div>
<div class="line"><a name="l07984"></a><span class="lineno"> 7984</span>&#160;          <span class="comment">/* Some abbreviations, which occur quite often in the reconstruction. */</span></div>
<div class="line"><a name="l07985"></a><span class="lineno"> 7985</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv1 = 0.5*(lam1 + lam2);</div>
<div class="line"><a name="l07986"></a><span class="lineno"> 7986</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2 = 0.5*(lam1 - lam2);</div>
<div class="line"><a name="l07987"></a><span class="lineno"> 7987</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv3 = abv1 - lam3;</div>
<div class="line"><a name="l07988"></a><span class="lineno"> 7988</span>&#160; </div>
<div class="line"><a name="l07989"></a><span class="lineno"> 7989</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv4 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(alphaL*dr - vxL*dru - vyL*drv + drE);</div>
<div class="line"><a name="l07990"></a><span class="lineno"> 7990</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv5 = nx*dru + ny*drv - vnL*dr;</div>
<div class="line"><a name="l07991"></a><span class="lineno"> 7991</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv6 = abv3*abv4*ova2L + abv2*abv5*ovaL;</div>
<div class="line"><a name="l07992"></a><span class="lineno"> 7992</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv7 = abv2*abv4*ovaL  + abv3*abv5;</div>
<div class="line"><a name="l07993"></a><span class="lineno"> 7993</span>&#160; </div>
<div class="line"><a name="l07994"></a><span class="lineno"> 7994</span>&#160;          <span class="comment">/* Compute the right state. */</span></div>
<div class="line"><a name="l07995"></a><span class="lineno"> 7995</span>&#160;          UR[0] = UL[0] + lam3*dr  + abv6;</div>
<div class="line"><a name="l07996"></a><span class="lineno"> 7996</span>&#160;          UR[1] = UL[1] + lam3*dru + vxL*abv6 + nx*abv7;</div>
<div class="line"><a name="l07997"></a><span class="lineno"> 7997</span>&#160;          UR[2] = UL[2] + lam3*drv + vyL*abv6 + ny*abv7;</div>
<div class="line"><a name="l07998"></a><span class="lineno"> 7998</span>&#160;          UR[3] = UL[3] + lam3*drE + HL*abv6  + vnL*abv7;</div>
<div class="line"><a name="l07999"></a><span class="lineno"> 7999</span>&#160;        }</div>
<div class="line"><a name="l08000"></a><span class="lineno"> 8000</span>&#160;      }</div>
<div class="line"><a name="l08001"></a><span class="lineno"> 8001</span>&#160; </div>
<div class="line"><a name="l08002"></a><span class="lineno"> 8002</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08003"></a><span class="lineno"> 8003</span>&#160;    }</div>
<div class="line"><a name="l08004"></a><span class="lineno"> 8004</span>&#160; </div>
<div class="line"><a name="l08005"></a><span class="lineno"> 8005</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l08006"></a><span class="lineno"> 8006</span>&#160; </div>
<div class="line"><a name="l08007"></a><span class="lineno"> 8007</span>&#160;      <span class="comment">/* Three-dimensional simulation.</span></div>
<div class="line"><a name="l08008"></a><span class="lineno"> 8008</span>&#160;<span class="comment">         Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l08009"></a><span class="lineno"> 8009</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l08010"></a><span class="lineno"> 8010</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08011"></a><span class="lineno"> 8011</span>&#160; </div>
<div class="line"><a name="l08012"></a><span class="lineno"> 8012</span>&#160;        <span class="comment">/* Loop over the integration points of the face. */</span></div>
<div class="line"><a name="l08013"></a><span class="lineno"> 8013</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l08014"></a><span class="lineno"> 8014</span>&#160; </div>
<div class="line"><a name="l08015"></a><span class="lineno"> 8015</span>&#160;          <span class="comment">/* Easier storage of the left and right solution and the normals</span></div>
<div class="line"><a name="l08016"></a><span class="lineno"> 8016</span>&#160;<span class="comment">             for this integration point. */</span></div>
<div class="line"><a name="l08017"></a><span class="lineno"> 8017</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solIntL + i*NPad + llNVar;</div>
<div class="line"><a name="l08018"></a><span class="lineno"> 8018</span>&#160;                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l08019"></a><span class="lineno"> 8019</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l08020"></a><span class="lineno"> 8020</span>&#160; </div>
<div class="line"><a name="l08021"></a><span class="lineno"> 8021</span>&#160;          <span class="comment">/* Compute the difference in conservative variables. */</span></div>
<div class="line"><a name="l08022"></a><span class="lineno"> 8022</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dr  = UR[0] - UL[0];</div>
<div class="line"><a name="l08023"></a><span class="lineno"> 8023</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dru = UR[1] - UL[1];</div>
<div class="line"><a name="l08024"></a><span class="lineno"> 8024</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drv = UR[2] - UL[2];</div>
<div class="line"><a name="l08025"></a><span class="lineno"> 8025</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drw = UR[3] - UL[3];</div>
<div class="line"><a name="l08026"></a><span class="lineno"> 8026</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drE = UR[4] - UL[4];</div>
<div class="line"><a name="l08027"></a><span class="lineno"> 8027</span>&#160; </div>
<div class="line"><a name="l08028"></a><span class="lineno"> 8028</span>&#160;          <span class="comment">/* Compute the primitive variables of the left state. */</span></div>
<div class="line"><a name="l08029"></a><span class="lineno"> 8029</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tmp    = 1.0/UL[0];</div>
<div class="line"><a name="l08030"></a><span class="lineno"> 8030</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vxL    = tmp*UL[1];</div>
<div class="line"><a name="l08031"></a><span class="lineno"> 8031</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vyL    = tmp*UL[2];</div>
<div class="line"><a name="l08032"></a><span class="lineno"> 8032</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vzL    = tmp*UL[3];</div>
<div class="line"><a name="l08033"></a><span class="lineno"> 8033</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> alphaL = 0.5*(vxL*vxL + vyL*vyL + vzL*vzL);</div>
<div class="line"><a name="l08034"></a><span class="lineno"> 8034</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> eL     = tmp*UL[4] - alphaL;</div>
<div class="line"><a name="l08035"></a><span class="lineno"> 8035</span>&#160; </div>
<div class="line"><a name="l08036"></a><span class="lineno"> 8036</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nx  = normals[0];</div>
<div class="line"><a name="l08037"></a><span class="lineno"> 8037</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ny  = normals[1];</div>
<div class="line"><a name="l08038"></a><span class="lineno"> 8038</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nz  = normals[2];</div>
<div class="line"><a name="l08039"></a><span class="lineno"> 8039</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnL = vxL*nx + vyL*ny + vzL*nz;</div>
<div class="line"><a name="l08040"></a><span class="lineno"> 8040</span>&#160; </div>
<div class="line"><a name="l08041"></a><span class="lineno"> 8041</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(UL[0], eL);</div>
<div class="line"><a name="l08042"></a><span class="lineno"> 8042</span>&#160; </div>
<div class="line"><a name="l08043"></a><span class="lineno"> 8043</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> aL  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a4a2b307dfa2a545c632548c8d7c6e86c">GetSoundSpeed</a>();</div>
<div class="line"><a name="l08044"></a><span class="lineno"> 8044</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> a2L = aL*aL;</div>
<div class="line"><a name="l08045"></a><span class="lineno"> 8045</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pL  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l08046"></a><span class="lineno"> 8046</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> HL  = (UL[4] + pL)*tmp;</div>
<div class="line"><a name="l08047"></a><span class="lineno"> 8047</span>&#160; </div>
<div class="line"><a name="l08048"></a><span class="lineno"> 8048</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ovaL  = 1.0/aL;</div>
<div class="line"><a name="l08049"></a><span class="lineno"> 8049</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ova2L = 1.0/a2L;</div>
<div class="line"><a name="l08050"></a><span class="lineno"> 8050</span>&#160; </div>
<div class="line"><a name="l08051"></a><span class="lineno"> 8051</span>&#160;          <span class="comment">/* Compute the eigenvalues. */</span></div>
<div class="line"><a name="l08052"></a><span class="lineno"> 8052</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam1 = vnL + aL;</div>
<div class="line"><a name="l08053"></a><span class="lineno"> 8053</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam2 = vnL - aL;</div>
<div class="line"><a name="l08054"></a><span class="lineno"> 8054</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam3 = vnL;</div>
<div class="line"><a name="l08055"></a><span class="lineno"> 8055</span>&#160; </div>
<div class="line"><a name="l08056"></a><span class="lineno"> 8056</span>&#160;          <span class="comment">/* For the characteristic reconstruction, only the outgoing</span></div>
<div class="line"><a name="l08057"></a><span class="lineno"> 8057</span>&#160;<span class="comment">             characteristics (negative eigenvalues) must be taken into account.</span></div>
<div class="line"><a name="l08058"></a><span class="lineno"> 8058</span>&#160;<span class="comment">             Set the eigenvalues accordingly. */</span></div>
<div class="line"><a name="l08059"></a><span class="lineno"> 8059</span>&#160;          lam1 = (lam1 &lt; 0.0) ? 1.0 : 0.0;</div>
<div class="line"><a name="l08060"></a><span class="lineno"> 8060</span>&#160;          lam2 = (lam2 &lt; 0.0) ? 1.0 : 0.0;</div>
<div class="line"><a name="l08061"></a><span class="lineno"> 8061</span>&#160;          lam3 = (lam3 &lt; 0.0) ? 1.0 : 0.0;</div>
<div class="line"><a name="l08062"></a><span class="lineno"> 8062</span>&#160; </div>
<div class="line"><a name="l08063"></a><span class="lineno"> 8063</span>&#160;          <span class="comment">/* Some abbreviations, which occur quite often in the reconstruction. */</span></div>
<div class="line"><a name="l08064"></a><span class="lineno"> 8064</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv1 = 0.5*(lam1 + lam2);</div>
<div class="line"><a name="l08065"></a><span class="lineno"> 8065</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2 = 0.5*(lam1 - lam2);</div>
<div class="line"><a name="l08066"></a><span class="lineno"> 8066</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv3 = abv1 - lam3;</div>
<div class="line"><a name="l08067"></a><span class="lineno"> 8067</span>&#160; </div>
<div class="line"><a name="l08068"></a><span class="lineno"> 8068</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv4 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(alphaL*dr - vxL*dru - vyL*drv - vzL*drw + drE);</div>
<div class="line"><a name="l08069"></a><span class="lineno"> 8069</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv5 = nx*dru + ny*drv + nz*drw - vnL*dr;</div>
<div class="line"><a name="l08070"></a><span class="lineno"> 8070</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv6 = abv3*abv4*ova2L + abv2*abv5*ovaL;</div>
<div class="line"><a name="l08071"></a><span class="lineno"> 8071</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv7 = abv2*abv4*ovaL  + abv3*abv5;</div>
<div class="line"><a name="l08072"></a><span class="lineno"> 8072</span>&#160; </div>
<div class="line"><a name="l08073"></a><span class="lineno"> 8073</span>&#160;          <span class="comment">/* Compute the right state. */</span></div>
<div class="line"><a name="l08074"></a><span class="lineno"> 8074</span>&#160;          UR[0] = UL[0] + lam3*dr  + abv6;</div>
<div class="line"><a name="l08075"></a><span class="lineno"> 8075</span>&#160;          UR[1] = UL[1] + lam3*dru + vxL*abv6 + nx*abv7;</div>
<div class="line"><a name="l08076"></a><span class="lineno"> 8076</span>&#160;          UR[2] = UL[2] + lam3*drv + vyL*abv6 + ny*abv7;</div>
<div class="line"><a name="l08077"></a><span class="lineno"> 8077</span>&#160;          UR[3] = UL[3] + lam3*drw + vzL*abv6 + nz*abv7;</div>
<div class="line"><a name="l08078"></a><span class="lineno"> 8078</span>&#160;          UR[4] = UL[4] + lam3*drE + HL*abv6  + vnL*abv7;</div>
<div class="line"><a name="l08079"></a><span class="lineno"> 8079</span>&#160;        }</div>
<div class="line"><a name="l08080"></a><span class="lineno"> 8080</span>&#160;      }</div>
<div class="line"><a name="l08081"></a><span class="lineno"> 8081</span>&#160; </div>
<div class="line"><a name="l08082"></a><span class="lineno"> 8082</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08083"></a><span class="lineno"> 8083</span>&#160;    }</div>
<div class="line"><a name="l08084"></a><span class="lineno"> 8084</span>&#160;  }</div>
<div class="line"><a name="l08085"></a><span class="lineno"> 8085</span>&#160;}</div>
<div class="line"><a name="l08086"></a><span class="lineno"> 8086</span>&#160; </div>
<div class="line"><a name="l08087"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a8f81a6011b17cbb65c8be69d517e8faf"> 8087</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a8f81a6011b17cbb65c8be69d517e8faf">CFEM_DG_EulerSolver::BC_Euler_Wall</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l08088"></a><span class="lineno"> 8088</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l08089"></a><span class="lineno"> 8089</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l08090"></a><span class="lineno"> 8090</span>&#160;                                        <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l08091"></a><span class="lineno"> 8091</span>&#160;                                        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l08092"></a><span class="lineno"> 8092</span>&#160;                                        <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l08093"></a><span class="lineno"> 8093</span>&#160;                                        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l08094"></a><span class="lineno"> 8094</span>&#160; </div>
<div class="line"><a name="l08095"></a><span class="lineno"> 8095</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l08096"></a><span class="lineno"> 8096</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l08097"></a><span class="lineno"> 8097</span>&#160; </div>
<div class="line"><a name="l08098"></a><span class="lineno"> 8098</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l08099"></a><span class="lineno"> 8099</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l08100"></a><span class="lineno"> 8100</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l08101"></a><span class="lineno"> 8101</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08102"></a><span class="lineno"> 8102</span>&#160; </div>
<div class="line"><a name="l08103"></a><span class="lineno"> 8103</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l08104"></a><span class="lineno"> 8104</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l08105"></a><span class="lineno"> 8105</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l08106"></a><span class="lineno"> 8106</span>&#160; </div>
<div class="line"><a name="l08107"></a><span class="lineno"> 8107</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l08108"></a><span class="lineno"> 8108</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l08109"></a><span class="lineno"> 8109</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l08110"></a><span class="lineno"> 8110</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l08111"></a><span class="lineno"> 8111</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l08112"></a><span class="lineno"> 8112</span>&#160; </div>
<div class="line"><a name="l08113"></a><span class="lineno"> 8113</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l08114"></a><span class="lineno"> 8114</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l08115"></a><span class="lineno"> 8115</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l08116"></a><span class="lineno"> 8116</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l08117"></a><span class="lineno"> 8117</span>&#160; </div>
<div class="line"><a name="l08118"></a><span class="lineno"> 8118</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l08119"></a><span class="lineno"> 8119</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l08120"></a><span class="lineno"> 8120</span>&#160; </div>
<div class="line"><a name="l08121"></a><span class="lineno"> 8121</span>&#160;    <span class="comment">/* Get the necessary data from the standard face. */</span></div>
<div class="line"><a name="l08122"></a><span class="lineno"> 8122</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l08123"></a><span class="lineno"> 8123</span>&#160; </div>
<div class="line"><a name="l08124"></a><span class="lineno"> 8124</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l08125"></a><span class="lineno"> 8125</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l08126"></a><span class="lineno"> 8126</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l08127"></a><span class="lineno"> 8127</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l08128"></a><span class="lineno"> 8128</span>&#160; </div>
<div class="line"><a name="l08129"></a><span class="lineno"> 8129</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l08130"></a><span class="lineno"> 8130</span>&#160;<span class="comment">       faces. The array work is used as temporary storage inside the</span></div>
<div class="line"><a name="l08131"></a><span class="lineno"> 8131</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l08132"></a><span class="lineno"> 8132</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l08133"></a><span class="lineno"> 8133</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l08134"></a><span class="lineno"> 8134</span>&#160; </div>
<div class="line"><a name="l08135"></a><span class="lineno"> 8135</span>&#160;    <span class="comment">/* Compute the right state by applying the inviscid wall BC&#39;s. */</span></div>
<div class="line"><a name="l08136"></a><span class="lineno"> 8136</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5d32e85923daf35ff0126d5f716ff9ec">BoundaryStates_Euler_Wall</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l08137"></a><span class="lineno"> 8137</span>&#160;                              solIntL, solIntR);</div>
<div class="line"><a name="l08138"></a><span class="lineno"> 8138</span>&#160; </div>
<div class="line"><a name="l08139"></a><span class="lineno"> 8139</span>&#160;    <span class="comment">/* The remainder of the contribution of ths boundary faces to the residual</span></div>
<div class="line"><a name="l08140"></a><span class="lineno"> 8140</span>&#160;<span class="comment">       is the same for all boundary conditions. Hence a generic function can</span></div>
<div class="line"><a name="l08141"></a><span class="lineno"> 8141</span>&#160;<span class="comment">       be used to carry out this task. */</span></div>
<div class="line"><a name="l08142"></a><span class="lineno"> 8142</span>&#160;    ResidualInviscidBoundaryFace(config, llEnd, NPad, conv_numerics, &amp;surfElem[l],</div>
<div class="line"><a name="l08143"></a><span class="lineno"> 8143</span>&#160;                                 solIntL, solIntR, work, resFaces, indResFaces);</div>
<div class="line"><a name="l08144"></a><span class="lineno"> 8144</span>&#160; </div>
<div class="line"><a name="l08145"></a><span class="lineno"> 8145</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l08146"></a><span class="lineno"> 8146</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l08147"></a><span class="lineno"> 8147</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l08148"></a><span class="lineno"> 8148</span>&#160;  }</div>
<div class="line"><a name="l08149"></a><span class="lineno"> 8149</span>&#160;}</div>
<div class="line"><a name="l08150"></a><span class="lineno"> 8150</span>&#160; </div>
<div class="line"><a name="l08151"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a48b8a50d3e9deee07bd02a30249f6f6d"> 8151</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a48b8a50d3e9deee07bd02a30249f6f6d">CFEM_DG_EulerSolver::BC_Far_Field</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l08152"></a><span class="lineno"> 8152</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l08153"></a><span class="lineno"> 8153</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l08154"></a><span class="lineno"> 8154</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l08155"></a><span class="lineno"> 8155</span>&#160;                                       <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l08156"></a><span class="lineno"> 8156</span>&#160;                                       <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l08157"></a><span class="lineno"> 8157</span>&#160;                                       <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l08158"></a><span class="lineno"> 8158</span>&#160; </div>
<div class="line"><a name="l08159"></a><span class="lineno"> 8159</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l08160"></a><span class="lineno"> 8160</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l08161"></a><span class="lineno"> 8161</span>&#160; </div>
<div class="line"><a name="l08162"></a><span class="lineno"> 8162</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l08163"></a><span class="lineno"> 8163</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l08164"></a><span class="lineno"> 8164</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l08165"></a><span class="lineno"> 8165</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08166"></a><span class="lineno"> 8166</span>&#160; </div>
<div class="line"><a name="l08167"></a><span class="lineno"> 8167</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l08168"></a><span class="lineno"> 8168</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l08169"></a><span class="lineno"> 8169</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l08170"></a><span class="lineno"> 8170</span>&#160; </div>
<div class="line"><a name="l08171"></a><span class="lineno"> 8171</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l08172"></a><span class="lineno"> 8172</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l08173"></a><span class="lineno"> 8173</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l08174"></a><span class="lineno"> 8174</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l08175"></a><span class="lineno"> 8175</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l08176"></a><span class="lineno"> 8176</span>&#160; </div>
<div class="line"><a name="l08177"></a><span class="lineno"> 8177</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l08178"></a><span class="lineno"> 8178</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l08179"></a><span class="lineno"> 8179</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l08180"></a><span class="lineno"> 8180</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l08181"></a><span class="lineno"> 8181</span>&#160; </div>
<div class="line"><a name="l08182"></a><span class="lineno"> 8182</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l08183"></a><span class="lineno"> 8183</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l08184"></a><span class="lineno"> 8184</span>&#160; </div>
<div class="line"><a name="l08185"></a><span class="lineno"> 8185</span>&#160;    <span class="comment">/* Get the necessary data from the standard face. */</span></div>
<div class="line"><a name="l08186"></a><span class="lineno"> 8186</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l08187"></a><span class="lineno"> 8187</span>&#160; </div>
<div class="line"><a name="l08188"></a><span class="lineno"> 8188</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l08189"></a><span class="lineno"> 8189</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l08190"></a><span class="lineno"> 8190</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l08191"></a><span class="lineno"> 8191</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l08192"></a><span class="lineno"> 8192</span>&#160; </div>
<div class="line"><a name="l08193"></a><span class="lineno"> 8193</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l08194"></a><span class="lineno"> 8194</span>&#160;<span class="comment">       faces. The array work is used as temporary storage inside the</span></div>
<div class="line"><a name="l08195"></a><span class="lineno"> 8195</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l08196"></a><span class="lineno"> 8196</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l08197"></a><span class="lineno"> 8197</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l08198"></a><span class="lineno"> 8198</span>&#160; </div>
<div class="line"><a name="l08199"></a><span class="lineno"> 8199</span>&#160;    <span class="comment">/* Set the right state in the integration points to the free stream value. */</span></div>
<div class="line"><a name="l08200"></a><span class="lineno"> 8200</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l08201"></a><span class="lineno"> 8201</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08202"></a><span class="lineno"> 8202</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l08203"></a><span class="lineno"> 8203</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l08204"></a><span class="lineno"> 8204</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++j)</div>
<div class="line"><a name="l08205"></a><span class="lineno"> 8205</span>&#160;          UR[j] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[j];</div>
<div class="line"><a name="l08206"></a><span class="lineno"> 8206</span>&#160;      }</div>
<div class="line"><a name="l08207"></a><span class="lineno"> 8207</span>&#160;    }</div>
<div class="line"><a name="l08208"></a><span class="lineno"> 8208</span>&#160; </div>
<div class="line"><a name="l08209"></a><span class="lineno"> 8209</span>&#160;    <span class="comment">/* The remainder of the contribution of this boundary face to the residual</span></div>
<div class="line"><a name="l08210"></a><span class="lineno"> 8210</span>&#160;<span class="comment">       is the same for all boundary conditions. Hence a generic function can</span></div>
<div class="line"><a name="l08211"></a><span class="lineno"> 8211</span>&#160;<span class="comment">       be used to carry out this task. */</span></div>
<div class="line"><a name="l08212"></a><span class="lineno"> 8212</span>&#160;    ResidualInviscidBoundaryFace(config, llEnd, NPad, conv_numerics, &amp;surfElem[l],</div>
<div class="line"><a name="l08213"></a><span class="lineno"> 8213</span>&#160;                                 solIntL, solIntR, work, resFaces, indResFaces);</div>
<div class="line"><a name="l08214"></a><span class="lineno"> 8214</span>&#160; </div>
<div class="line"><a name="l08215"></a><span class="lineno"> 8215</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l08216"></a><span class="lineno"> 8216</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l08217"></a><span class="lineno"> 8217</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l08218"></a><span class="lineno"> 8218</span>&#160;  }</div>
<div class="line"><a name="l08219"></a><span class="lineno"> 8219</span>&#160;}</div>
<div class="line"><a name="l08220"></a><span class="lineno"> 8220</span>&#160; </div>
<div class="line"><a name="l08221"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a002d30c9052117b77a33d1f290b1195b"> 8221</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a002d30c9052117b77a33d1f290b1195b">CFEM_DG_EulerSolver::BC_Sym_Plane</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l08222"></a><span class="lineno"> 8222</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l08223"></a><span class="lineno"> 8223</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l08224"></a><span class="lineno"> 8224</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l08225"></a><span class="lineno"> 8225</span>&#160;                                       <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l08226"></a><span class="lineno"> 8226</span>&#160;                                       <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l08227"></a><span class="lineno"> 8227</span>&#160;                                       <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l08228"></a><span class="lineno"> 8228</span>&#160; </div>
<div class="line"><a name="l08229"></a><span class="lineno"> 8229</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l08230"></a><span class="lineno"> 8230</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l08231"></a><span class="lineno"> 8231</span>&#160; </div>
<div class="line"><a name="l08232"></a><span class="lineno"> 8232</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l08233"></a><span class="lineno"> 8233</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l08234"></a><span class="lineno"> 8234</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l08235"></a><span class="lineno"> 8235</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08236"></a><span class="lineno"> 8236</span>&#160; </div>
<div class="line"><a name="l08237"></a><span class="lineno"> 8237</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l08238"></a><span class="lineno"> 8238</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l08239"></a><span class="lineno"> 8239</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l08240"></a><span class="lineno"> 8240</span>&#160; </div>
<div class="line"><a name="l08241"></a><span class="lineno"> 8241</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l08242"></a><span class="lineno"> 8242</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l08243"></a><span class="lineno"> 8243</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l08244"></a><span class="lineno"> 8244</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l08245"></a><span class="lineno"> 8245</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l08246"></a><span class="lineno"> 8246</span>&#160; </div>
<div class="line"><a name="l08247"></a><span class="lineno"> 8247</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l08248"></a><span class="lineno"> 8248</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l08249"></a><span class="lineno"> 8249</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l08250"></a><span class="lineno"> 8250</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l08251"></a><span class="lineno"> 8251</span>&#160; </div>
<div class="line"><a name="l08252"></a><span class="lineno"> 8252</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l08253"></a><span class="lineno"> 8253</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l08254"></a><span class="lineno"> 8254</span>&#160; </div>
<div class="line"><a name="l08255"></a><span class="lineno"> 8255</span>&#160;    <span class="comment">/* Get the necessary data from the standard face. */</span></div>
<div class="line"><a name="l08256"></a><span class="lineno"> 8256</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l08257"></a><span class="lineno"> 8257</span>&#160; </div>
<div class="line"><a name="l08258"></a><span class="lineno"> 8258</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l08259"></a><span class="lineno"> 8259</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l08260"></a><span class="lineno"> 8260</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l08261"></a><span class="lineno"> 8261</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l08262"></a><span class="lineno"> 8262</span>&#160; </div>
<div class="line"><a name="l08263"></a><span class="lineno"> 8263</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l08264"></a><span class="lineno"> 8264</span>&#160;<span class="comment">       faces. The array work is used as temporary storage inside the</span></div>
<div class="line"><a name="l08265"></a><span class="lineno"> 8265</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l08266"></a><span class="lineno"> 8266</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l08267"></a><span class="lineno"> 8267</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l08268"></a><span class="lineno"> 8268</span>&#160; </div>
<div class="line"><a name="l08269"></a><span class="lineno"> 8269</span>&#160;    <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l08270"></a><span class="lineno"> 8270</span>&#160;<span class="comment">       in order to have the most efficient code. */</span></div>
<div class="line"><a name="l08271"></a><span class="lineno"> 8271</span>&#160;    <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l08272"></a><span class="lineno"> 8272</span>&#160; </div>
<div class="line"><a name="l08273"></a><span class="lineno"> 8273</span>&#160;      <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l08274"></a><span class="lineno"> 8274</span>&#160; </div>
<div class="line"><a name="l08275"></a><span class="lineno"> 8275</span>&#160;        <span class="comment">/* 2D simulation. Loop over the faces that are treated simultaneously</span></div>
<div class="line"><a name="l08276"></a><span class="lineno"> 8276</span>&#160;<span class="comment">           and the integration points to apply the symmetry condition. */</span></div>
<div class="line"><a name="l08277"></a><span class="lineno"> 8277</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l08278"></a><span class="lineno"> 8278</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08279"></a><span class="lineno"> 8279</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l08280"></a><span class="lineno"> 8280</span>&#160; </div>
<div class="line"><a name="l08281"></a><span class="lineno"> 8281</span>&#160;            <span class="comment">/* Easier storage of the left and right solution and the normals</span></div>
<div class="line"><a name="l08282"></a><span class="lineno"> 8282</span>&#160;<span class="comment">               for this integration point. */</span></div>
<div class="line"><a name="l08283"></a><span class="lineno"> 8283</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solIntL + NPad*i + llNVar;</div>
<div class="line"><a name="l08284"></a><span class="lineno"> 8284</span>&#160;                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solIntR + NPad*i + llNVar;</div>
<div class="line"><a name="l08285"></a><span class="lineno"> 8285</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[ll+l].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l08286"></a><span class="lineno"> 8286</span>&#160; </div>
<div class="line"><a name="l08287"></a><span class="lineno"> 8287</span>&#160;            <span class="comment">/* Compute twice the normal component of the momentum variables. The</span></div>
<div class="line"><a name="l08288"></a><span class="lineno"> 8288</span>&#160;<span class="comment">               factor 2 comes from the fact that the velocity must be mirrored. */</span></div>
<div class="line"><a name="l08289"></a><span class="lineno"> 8289</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rVn = 2.0*(UL[1]*normals[0] + UL[2]*normals[1]);</div>
<div class="line"><a name="l08290"></a><span class="lineno"> 8290</span>&#160; </div>
<div class="line"><a name="l08291"></a><span class="lineno"> 8291</span>&#160;            <span class="comment">/* Set the right state. Note that the total energy of the right state is</span></div>
<div class="line"><a name="l08292"></a><span class="lineno"> 8292</span>&#160;<span class="comment">               identical to the left state, because the magnitude of the velocity</span></div>
<div class="line"><a name="l08293"></a><span class="lineno"> 8293</span>&#160;<span class="comment">               remains the same. */</span></div>
<div class="line"><a name="l08294"></a><span class="lineno"> 8294</span>&#160;            UR[0] = UL[0];</div>
<div class="line"><a name="l08295"></a><span class="lineno"> 8295</span>&#160;            UR[1] = UL[1] - rVn*normals[0];</div>
<div class="line"><a name="l08296"></a><span class="lineno"> 8296</span>&#160;            UR[2] = UL[2] - rVn*normals[1];</div>
<div class="line"><a name="l08297"></a><span class="lineno"> 8297</span>&#160;            UR[3] = UL[3];</div>
<div class="line"><a name="l08298"></a><span class="lineno"> 8298</span>&#160;          }</div>
<div class="line"><a name="l08299"></a><span class="lineno"> 8299</span>&#160;        }</div>
<div class="line"><a name="l08300"></a><span class="lineno"> 8300</span>&#160; </div>
<div class="line"><a name="l08301"></a><span class="lineno"> 8301</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08302"></a><span class="lineno"> 8302</span>&#160;      }</div>
<div class="line"><a name="l08303"></a><span class="lineno"> 8303</span>&#160; </div>
<div class="line"><a name="l08304"></a><span class="lineno"> 8304</span>&#160;      <span class="comment">/*----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l08305"></a><span class="lineno"> 8305</span>&#160; </div>
<div class="line"><a name="l08306"></a><span class="lineno"> 8306</span>&#160;      <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l08307"></a><span class="lineno"> 8307</span>&#160; </div>
<div class="line"><a name="l08308"></a><span class="lineno"> 8308</span>&#160;        <span class="comment">/* 3D simulation. Loop over the faces that are treated simultaneously</span></div>
<div class="line"><a name="l08309"></a><span class="lineno"> 8309</span>&#160;<span class="comment">           and the integration points to apply the symmetry condition. */</span></div>
<div class="line"><a name="l08310"></a><span class="lineno"> 8310</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l08311"></a><span class="lineno"> 8311</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08312"></a><span class="lineno"> 8312</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l08313"></a><span class="lineno"> 8313</span>&#160; </div>
<div class="line"><a name="l08314"></a><span class="lineno"> 8314</span>&#160;            <span class="comment">/* Easier storage of the left and right solution and the normals</span></div>
<div class="line"><a name="l08315"></a><span class="lineno"> 8315</span>&#160;<span class="comment">               for this integration point. */</span></div>
<div class="line"><a name="l08316"></a><span class="lineno"> 8316</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solIntL + NPad*i + llNVar;</div>
<div class="line"><a name="l08317"></a><span class="lineno"> 8317</span>&#160;                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solIntR + NPad*i + llNVar;</div>
<div class="line"><a name="l08318"></a><span class="lineno"> 8318</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[ll+l].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l08319"></a><span class="lineno"> 8319</span>&#160; </div>
<div class="line"><a name="l08320"></a><span class="lineno"> 8320</span>&#160;            <span class="comment">/* Compute twice the normal component of the momentum variables. The</span></div>
<div class="line"><a name="l08321"></a><span class="lineno"> 8321</span>&#160;<span class="comment">               factor 2 comes from the fact that the velocity must be mirrored. */</span></div>
<div class="line"><a name="l08322"></a><span class="lineno"> 8322</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rVn = 2.0*(UL[1]*normals[0] + UL[2]*normals[1] + UL[3]*normals[2]);</div>
<div class="line"><a name="l08323"></a><span class="lineno"> 8323</span>&#160; </div>
<div class="line"><a name="l08324"></a><span class="lineno"> 8324</span>&#160;            <span class="comment">/* Set the right state. Note that the total energy of the right state is</span></div>
<div class="line"><a name="l08325"></a><span class="lineno"> 8325</span>&#160;<span class="comment">               identical to the left state, because the magnitude of the velocity</span></div>
<div class="line"><a name="l08326"></a><span class="lineno"> 8326</span>&#160;<span class="comment">               remains the same. */</span></div>
<div class="line"><a name="l08327"></a><span class="lineno"> 8327</span>&#160;            UR[0] = UL[0];</div>
<div class="line"><a name="l08328"></a><span class="lineno"> 8328</span>&#160;            UR[1] = UL[1] - rVn*normals[0];</div>
<div class="line"><a name="l08329"></a><span class="lineno"> 8329</span>&#160;            UR[2] = UL[2] - rVn*normals[1];</div>
<div class="line"><a name="l08330"></a><span class="lineno"> 8330</span>&#160;            UR[3] = UL[3] - rVn*normals[2];</div>
<div class="line"><a name="l08331"></a><span class="lineno"> 8331</span>&#160;            UR[4] = UL[4];</div>
<div class="line"><a name="l08332"></a><span class="lineno"> 8332</span>&#160;          }</div>
<div class="line"><a name="l08333"></a><span class="lineno"> 8333</span>&#160;        }</div>
<div class="line"><a name="l08334"></a><span class="lineno"> 8334</span>&#160; </div>
<div class="line"><a name="l08335"></a><span class="lineno"> 8335</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08336"></a><span class="lineno"> 8336</span>&#160;      }</div>
<div class="line"><a name="l08337"></a><span class="lineno"> 8337</span>&#160;    }</div>
<div class="line"><a name="l08338"></a><span class="lineno"> 8338</span>&#160; </div>
<div class="line"><a name="l08339"></a><span class="lineno"> 8339</span>&#160;    <span class="comment">/* The remainder of the contribution of this boundary face to the residual</span></div>
<div class="line"><a name="l08340"></a><span class="lineno"> 8340</span>&#160;<span class="comment">       is the same for all boundary conditions. Hence a generic function can</span></div>
<div class="line"><a name="l08341"></a><span class="lineno"> 8341</span>&#160;<span class="comment">       be used to carry out this task. */</span></div>
<div class="line"><a name="l08342"></a><span class="lineno"> 8342</span>&#160;    ResidualInviscidBoundaryFace(config, llEnd, NPad, conv_numerics, &amp;surfElem[l],</div>
<div class="line"><a name="l08343"></a><span class="lineno"> 8343</span>&#160;                                 solIntL, solIntR, work, resFaces, indResFaces);</div>
<div class="line"><a name="l08344"></a><span class="lineno"> 8344</span>&#160; </div>
<div class="line"><a name="l08345"></a><span class="lineno"> 8345</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l08346"></a><span class="lineno"> 8346</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l08347"></a><span class="lineno"> 8347</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l08348"></a><span class="lineno"> 8348</span>&#160;  }</div>
<div class="line"><a name="l08349"></a><span class="lineno"> 8349</span>&#160;}</div>
<div class="line"><a name="l08350"></a><span class="lineno"> 8350</span>&#160; </div>
<div class="line"><a name="l08351"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a99232a4f053e949762b0919a6c288c73"> 8351</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a99232a4f053e949762b0919a6c288c73">CFEM_DG_EulerSolver::BC_Supersonic_Outlet</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l08352"></a><span class="lineno"> 8352</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l08353"></a><span class="lineno"> 8353</span>&#160;                                               <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l08354"></a><span class="lineno"> 8354</span>&#160;                                               <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l08355"></a><span class="lineno"> 8355</span>&#160;                                               <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l08356"></a><span class="lineno"> 8356</span>&#160;                                               <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l08357"></a><span class="lineno"> 8357</span>&#160;                                               <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l08358"></a><span class="lineno"> 8358</span>&#160; </div>
<div class="line"><a name="l08359"></a><span class="lineno"> 8359</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l08360"></a><span class="lineno"> 8360</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l08361"></a><span class="lineno"> 8361</span>&#160; </div>
<div class="line"><a name="l08362"></a><span class="lineno"> 8362</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l08363"></a><span class="lineno"> 8363</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l08364"></a><span class="lineno"> 8364</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l08365"></a><span class="lineno"> 8365</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08366"></a><span class="lineno"> 8366</span>&#160; </div>
<div class="line"><a name="l08367"></a><span class="lineno"> 8367</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l08368"></a><span class="lineno"> 8368</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l08369"></a><span class="lineno"> 8369</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l08370"></a><span class="lineno"> 8370</span>&#160; </div>
<div class="line"><a name="l08371"></a><span class="lineno"> 8371</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l08372"></a><span class="lineno"> 8372</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l08373"></a><span class="lineno"> 8373</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l08374"></a><span class="lineno"> 8374</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l08375"></a><span class="lineno"> 8375</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l08376"></a><span class="lineno"> 8376</span>&#160; </div>
<div class="line"><a name="l08377"></a><span class="lineno"> 8377</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l08378"></a><span class="lineno"> 8378</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l08379"></a><span class="lineno"> 8379</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l08380"></a><span class="lineno"> 8380</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l08381"></a><span class="lineno"> 8381</span>&#160; </div>
<div class="line"><a name="l08382"></a><span class="lineno"> 8382</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l08383"></a><span class="lineno"> 8383</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l08384"></a><span class="lineno"> 8384</span>&#160; </div>
<div class="line"><a name="l08385"></a><span class="lineno"> 8385</span>&#160;    <span class="comment">/* Get the necessary data from the standard face. */</span></div>
<div class="line"><a name="l08386"></a><span class="lineno"> 8386</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l08387"></a><span class="lineno"> 8387</span>&#160; </div>
<div class="line"><a name="l08388"></a><span class="lineno"> 8388</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l08389"></a><span class="lineno"> 8389</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l08390"></a><span class="lineno"> 8390</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l08391"></a><span class="lineno"> 8391</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l08392"></a><span class="lineno"> 8392</span>&#160; </div>
<div class="line"><a name="l08393"></a><span class="lineno"> 8393</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l08394"></a><span class="lineno"> 8394</span>&#160;<span class="comment">       faces. The array work is used as temporary storage inside the</span></div>
<div class="line"><a name="l08395"></a><span class="lineno"> 8395</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l08396"></a><span class="lineno"> 8396</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l08397"></a><span class="lineno"> 8397</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l08398"></a><span class="lineno"> 8398</span>&#160; </div>
<div class="line"><a name="l08399"></a><span class="lineno"> 8399</span>&#160;    <span class="comment">/* Set the right state in the integration points to the left state, i.e.</span></div>
<div class="line"><a name="l08400"></a><span class="lineno"> 8400</span>&#160;<span class="comment">       no boundary condition is applied for a supersonic outlet. */</span></div>
<div class="line"><a name="l08401"></a><span class="lineno"> 8401</span>&#160;    memcpy(solIntR, solIntL, NPad*nInt*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>));</div>
<div class="line"><a name="l08402"></a><span class="lineno"> 8402</span>&#160; </div>
<div class="line"><a name="l08403"></a><span class="lineno"> 8403</span>&#160;    <span class="comment">/* The remainder of the contribution of this boundary face to the residual</span></div>
<div class="line"><a name="l08404"></a><span class="lineno"> 8404</span>&#160;<span class="comment">       is the same for all boundary conditions. Hence a generic function can</span></div>
<div class="line"><a name="l08405"></a><span class="lineno"> 8405</span>&#160;<span class="comment">       be used to carry out this task. */</span></div>
<div class="line"><a name="l08406"></a><span class="lineno"> 8406</span>&#160;    ResidualInviscidBoundaryFace(config, llEnd, NPad, conv_numerics, &amp;surfElem[l],</div>
<div class="line"><a name="l08407"></a><span class="lineno"> 8407</span>&#160;                                 solIntL, solIntR, work, resFaces, indResFaces);</div>
<div class="line"><a name="l08408"></a><span class="lineno"> 8408</span>&#160; </div>
<div class="line"><a name="l08409"></a><span class="lineno"> 8409</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l08410"></a><span class="lineno"> 8410</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l08411"></a><span class="lineno"> 8411</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l08412"></a><span class="lineno"> 8412</span>&#160;  }</div>
<div class="line"><a name="l08413"></a><span class="lineno"> 8413</span>&#160;}</div>
<div class="line"><a name="l08414"></a><span class="lineno"> 8414</span>&#160; </div>
<div class="line"><a name="l08415"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#ade8441a575543603f4e4218fb52e33a2"> 8415</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ade8441a575543603f4e4218fb52e33a2">CFEM_DG_EulerSolver::BC_Inlet</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l08416"></a><span class="lineno"> 8416</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l08417"></a><span class="lineno"> 8417</span>&#160;                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l08418"></a><span class="lineno"> 8418</span>&#160;                                   <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l08419"></a><span class="lineno"> 8419</span>&#160;                                   <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l08420"></a><span class="lineno"> 8420</span>&#160;                                   <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l08421"></a><span class="lineno"> 8421</span>&#160;                                   <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l08422"></a><span class="lineno"> 8422</span>&#160;                                   <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l08423"></a><span class="lineno"> 8423</span>&#160; </div>
<div class="line"><a name="l08424"></a><span class="lineno"> 8424</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l08425"></a><span class="lineno"> 8425</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l08426"></a><span class="lineno"> 8426</span>&#160; </div>
<div class="line"><a name="l08427"></a><span class="lineno"> 8427</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l08428"></a><span class="lineno"> 8428</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l08429"></a><span class="lineno"> 8429</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l08430"></a><span class="lineno"> 8430</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08431"></a><span class="lineno"> 8431</span>&#160; </div>
<div class="line"><a name="l08432"></a><span class="lineno"> 8432</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l08433"></a><span class="lineno"> 8433</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l08434"></a><span class="lineno"> 8434</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l08435"></a><span class="lineno"> 8435</span>&#160; </div>
<div class="line"><a name="l08436"></a><span class="lineno"> 8436</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l08437"></a><span class="lineno"> 8437</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l08438"></a><span class="lineno"> 8438</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l08439"></a><span class="lineno"> 8439</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l08440"></a><span class="lineno"> 8440</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l08441"></a><span class="lineno"> 8441</span>&#160; </div>
<div class="line"><a name="l08442"></a><span class="lineno"> 8442</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l08443"></a><span class="lineno"> 8443</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l08444"></a><span class="lineno"> 8444</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l08445"></a><span class="lineno"> 8445</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l08446"></a><span class="lineno"> 8446</span>&#160; </div>
<div class="line"><a name="l08447"></a><span class="lineno"> 8447</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l08448"></a><span class="lineno"> 8448</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l08449"></a><span class="lineno"> 8449</span>&#160; </div>
<div class="line"><a name="l08450"></a><span class="lineno"> 8450</span>&#160;    <span class="comment">/* Get the necessary data from the standard face. */</span></div>
<div class="line"><a name="l08451"></a><span class="lineno"> 8451</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l08452"></a><span class="lineno"> 8452</span>&#160; </div>
<div class="line"><a name="l08453"></a><span class="lineno"> 8453</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l08454"></a><span class="lineno"> 8454</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l08455"></a><span class="lineno"> 8455</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l08456"></a><span class="lineno"> 8456</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l08457"></a><span class="lineno"> 8457</span>&#160; </div>
<div class="line"><a name="l08458"></a><span class="lineno"> 8458</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l08459"></a><span class="lineno"> 8459</span>&#160;<span class="comment">       faces. The array work is used as temporary storage inside the</span></div>
<div class="line"><a name="l08460"></a><span class="lineno"> 8460</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l08461"></a><span class="lineno"> 8461</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l08462"></a><span class="lineno"> 8462</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l08463"></a><span class="lineno"> 8463</span>&#160; </div>
<div class="line"><a name="l08464"></a><span class="lineno"> 8464</span>&#160;    <span class="comment">/* Compute the right state by applying the subsonic inlet BC&#39;s. */</span></div>
<div class="line"><a name="l08465"></a><span class="lineno"> 8465</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af993f01423bbb8e24b8c2bb565bf55eb">BoundaryStates_Inlet</a>(config, llEnd, NPad, &amp;surfElem[l], val_marker, solIntL, solIntR);</div>
<div class="line"><a name="l08466"></a><span class="lineno"> 8466</span>&#160; </div>
<div class="line"><a name="l08467"></a><span class="lineno"> 8467</span>&#160;    <span class="comment">/* The remainder of the contribution of this boundary face to the residual</span></div>
<div class="line"><a name="l08468"></a><span class="lineno"> 8468</span>&#160;<span class="comment">       is the same for all boundary conditions. Hence a generic function can</span></div>
<div class="line"><a name="l08469"></a><span class="lineno"> 8469</span>&#160;<span class="comment">       be used to carry out this task. */</span></div>
<div class="line"><a name="l08470"></a><span class="lineno"> 8470</span>&#160;    ResidualInviscidBoundaryFace(config, llEnd, NPad, conv_numerics, &amp;surfElem[l],</div>
<div class="line"><a name="l08471"></a><span class="lineno"> 8471</span>&#160;                                 solIntL, solIntR, work, resFaces, indResFaces);</div>
<div class="line"><a name="l08472"></a><span class="lineno"> 8472</span>&#160; </div>
<div class="line"><a name="l08473"></a><span class="lineno"> 8473</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l08474"></a><span class="lineno"> 8474</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l08475"></a><span class="lineno"> 8475</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l08476"></a><span class="lineno"> 8476</span>&#160;  }</div>
<div class="line"><a name="l08477"></a><span class="lineno"> 8477</span>&#160;}</div>
<div class="line"><a name="l08478"></a><span class="lineno"> 8478</span>&#160; </div>
<div class="line"><a name="l08479"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a869796e928f7618ea7f47d9ebc80cf76"> 8479</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a869796e928f7618ea7f47d9ebc80cf76">CFEM_DG_EulerSolver::BC_Outlet</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l08480"></a><span class="lineno"> 8480</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l08481"></a><span class="lineno"> 8481</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l08482"></a><span class="lineno"> 8482</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l08483"></a><span class="lineno"> 8483</span>&#160;                                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l08484"></a><span class="lineno"> 8484</span>&#160;                                    <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l08485"></a><span class="lineno"> 8485</span>&#160;                                    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l08486"></a><span class="lineno"> 8486</span>&#160;                                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l08487"></a><span class="lineno"> 8487</span>&#160; </div>
<div class="line"><a name="l08488"></a><span class="lineno"> 8488</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l08489"></a><span class="lineno"> 8489</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l08490"></a><span class="lineno"> 8490</span>&#160; </div>
<div class="line"><a name="l08491"></a><span class="lineno"> 8491</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l08492"></a><span class="lineno"> 8492</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l08493"></a><span class="lineno"> 8493</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l08494"></a><span class="lineno"> 8494</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08495"></a><span class="lineno"> 8495</span>&#160; </div>
<div class="line"><a name="l08496"></a><span class="lineno"> 8496</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l08497"></a><span class="lineno"> 8497</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l08498"></a><span class="lineno"> 8498</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l08499"></a><span class="lineno"> 8499</span>&#160; </div>
<div class="line"><a name="l08500"></a><span class="lineno"> 8500</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l08501"></a><span class="lineno"> 8501</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l08502"></a><span class="lineno"> 8502</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l08503"></a><span class="lineno"> 8503</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l08504"></a><span class="lineno"> 8504</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l08505"></a><span class="lineno"> 8505</span>&#160; </div>
<div class="line"><a name="l08506"></a><span class="lineno"> 8506</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l08507"></a><span class="lineno"> 8507</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l08508"></a><span class="lineno"> 8508</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l08509"></a><span class="lineno"> 8509</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l08510"></a><span class="lineno"> 8510</span>&#160; </div>
<div class="line"><a name="l08511"></a><span class="lineno"> 8511</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l08512"></a><span class="lineno"> 8512</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l08513"></a><span class="lineno"> 8513</span>&#160; </div>
<div class="line"><a name="l08514"></a><span class="lineno"> 8514</span>&#160;    <span class="comment">/* Get the necessary data from the standard face. */</span></div>
<div class="line"><a name="l08515"></a><span class="lineno"> 8515</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l08516"></a><span class="lineno"> 8516</span>&#160; </div>
<div class="line"><a name="l08517"></a><span class="lineno"> 8517</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l08518"></a><span class="lineno"> 8518</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l08519"></a><span class="lineno"> 8519</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l08520"></a><span class="lineno"> 8520</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l08521"></a><span class="lineno"> 8521</span>&#160; </div>
<div class="line"><a name="l08522"></a><span class="lineno"> 8522</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l08523"></a><span class="lineno"> 8523</span>&#160;<span class="comment">       faces. The array work is used as temporary storage inside the</span></div>
<div class="line"><a name="l08524"></a><span class="lineno"> 8524</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l08525"></a><span class="lineno"> 8525</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l08526"></a><span class="lineno"> 8526</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l08527"></a><span class="lineno"> 8527</span>&#160; </div>
<div class="line"><a name="l08528"></a><span class="lineno"> 8528</span>&#160;    <span class="comment">/* Compute the right state by applying the subsonic inlet BC&#39;s. */</span></div>
<div class="line"><a name="l08529"></a><span class="lineno"> 8529</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3233306f97b6173c5c109cae04a4c9be">BoundaryStates_Outlet</a>(config, llEnd, NPad, &amp;surfElem[l], val_marker, solIntL, solIntR);</div>
<div class="line"><a name="l08530"></a><span class="lineno"> 8530</span>&#160; </div>
<div class="line"><a name="l08531"></a><span class="lineno"> 8531</span>&#160;    <span class="comment">/* The remainder of the contribution of this boundary face to the residual</span></div>
<div class="line"><a name="l08532"></a><span class="lineno"> 8532</span>&#160;<span class="comment">       is the same for all boundary conditions. Hence a generic function can</span></div>
<div class="line"><a name="l08533"></a><span class="lineno"> 8533</span>&#160;<span class="comment">       be used to carry out this task. */</span></div>
<div class="line"><a name="l08534"></a><span class="lineno"> 8534</span>&#160;    ResidualInviscidBoundaryFace(config, llEnd, NPad, conv_numerics, &amp;surfElem[l],</div>
<div class="line"><a name="l08535"></a><span class="lineno"> 8535</span>&#160;                                 solIntL, solIntR, work, resFaces, indResFaces);</div>
<div class="line"><a name="l08536"></a><span class="lineno"> 8536</span>&#160; </div>
<div class="line"><a name="l08537"></a><span class="lineno"> 8537</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l08538"></a><span class="lineno"> 8538</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l08539"></a><span class="lineno"> 8539</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l08540"></a><span class="lineno"> 8540</span>&#160;  }</div>
<div class="line"><a name="l08541"></a><span class="lineno"> 8541</span>&#160;}</div>
<div class="line"><a name="l08542"></a><span class="lineno"> 8542</span>&#160; </div>
<div class="line"><a name="l08543"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#aaff04081aba8d9e24f0e615161e8020f"> 8543</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aaff04081aba8d9e24f0e615161e8020f">CFEM_DG_EulerSolver::BC_Riemann</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l08544"></a><span class="lineno"> 8544</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l08545"></a><span class="lineno"> 8545</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l08546"></a><span class="lineno"> 8546</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l08547"></a><span class="lineno"> 8547</span>&#160;                                     <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l08548"></a><span class="lineno"> 8548</span>&#160;                                     <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l08549"></a><span class="lineno"> 8549</span>&#160;                                     <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l08550"></a><span class="lineno"> 8550</span>&#160;                                     <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l08551"></a><span class="lineno"> 8551</span>&#160; </div>
<div class="line"><a name="l08552"></a><span class="lineno"> 8552</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l08553"></a><span class="lineno"> 8553</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l08554"></a><span class="lineno"> 8554</span>&#160; </div>
<div class="line"><a name="l08555"></a><span class="lineno"> 8555</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l08556"></a><span class="lineno"> 8556</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l08557"></a><span class="lineno"> 8557</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l08558"></a><span class="lineno"> 8558</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08559"></a><span class="lineno"> 8559</span>&#160; </div>
<div class="line"><a name="l08560"></a><span class="lineno"> 8560</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l08561"></a><span class="lineno"> 8561</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l08562"></a><span class="lineno"> 8562</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l08563"></a><span class="lineno"> 8563</span>&#160; </div>
<div class="line"><a name="l08564"></a><span class="lineno"> 8564</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l08565"></a><span class="lineno"> 8565</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l08566"></a><span class="lineno"> 8566</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l08567"></a><span class="lineno"> 8567</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l08568"></a><span class="lineno"> 8568</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l08569"></a><span class="lineno"> 8569</span>&#160; </div>
<div class="line"><a name="l08570"></a><span class="lineno"> 8570</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l08571"></a><span class="lineno"> 8571</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l08572"></a><span class="lineno"> 8572</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l08573"></a><span class="lineno"> 8573</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l08574"></a><span class="lineno"> 8574</span>&#160; </div>
<div class="line"><a name="l08575"></a><span class="lineno"> 8575</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l08576"></a><span class="lineno"> 8576</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l08577"></a><span class="lineno"> 8577</span>&#160; </div>
<div class="line"><a name="l08578"></a><span class="lineno"> 8578</span>&#160;    <span class="comment">/* Get the necessary data from the standard face. */</span></div>
<div class="line"><a name="l08579"></a><span class="lineno"> 8579</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l08580"></a><span class="lineno"> 8580</span>&#160; </div>
<div class="line"><a name="l08581"></a><span class="lineno"> 8581</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l08582"></a><span class="lineno"> 8582</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l08583"></a><span class="lineno"> 8583</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l08584"></a><span class="lineno"> 8584</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l08585"></a><span class="lineno"> 8585</span>&#160; </div>
<div class="line"><a name="l08586"></a><span class="lineno"> 8586</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l08587"></a><span class="lineno"> 8587</span>&#160;<span class="comment">       faces. The array work is used as temporary storage inside the</span></div>
<div class="line"><a name="l08588"></a><span class="lineno"> 8588</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l08589"></a><span class="lineno"> 8589</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l08590"></a><span class="lineno"> 8590</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l08591"></a><span class="lineno"> 8591</span>&#160; </div>
<div class="line"><a name="l08592"></a><span class="lineno"> 8592</span>&#160;    <span class="comment">/* Compute the right state by applying the subsonic inlet BC&#39;s. */</span></div>
<div class="line"><a name="l08593"></a><span class="lineno"> 8593</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5bfdc0bca1daa8e5d716d4fc3c7f5867">BoundaryStates_Riemann</a>(config, llEnd, NPad, &amp;surfElem[l], val_marker, solIntL, solIntR);</div>
<div class="line"><a name="l08594"></a><span class="lineno"> 8594</span>&#160; </div>
<div class="line"><a name="l08595"></a><span class="lineno"> 8595</span>&#160;    <span class="comment">/* The remainder of the contribution of this boundary face to the residual</span></div>
<div class="line"><a name="l08596"></a><span class="lineno"> 8596</span>&#160;<span class="comment">       is the same for all boundary conditions. Hence a generic function can</span></div>
<div class="line"><a name="l08597"></a><span class="lineno"> 8597</span>&#160;<span class="comment">       be used to carry out this task. */</span></div>
<div class="line"><a name="l08598"></a><span class="lineno"> 8598</span>&#160;    ResidualInviscidBoundaryFace(config, llEnd, NPad, conv_numerics, &amp;surfElem[l],</div>
<div class="line"><a name="l08599"></a><span class="lineno"> 8599</span>&#160;                                 solIntL, solIntR, work, resFaces, indResFaces);</div>
<div class="line"><a name="l08600"></a><span class="lineno"> 8600</span>&#160; </div>
<div class="line"><a name="l08601"></a><span class="lineno"> 8601</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l08602"></a><span class="lineno"> 8602</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l08603"></a><span class="lineno"> 8603</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l08604"></a><span class="lineno"> 8604</span>&#160;  }</div>
<div class="line"><a name="l08605"></a><span class="lineno"> 8605</span>&#160;}</div>
<div class="line"><a name="l08606"></a><span class="lineno"> 8606</span>&#160; </div>
<div class="line"><a name="l08607"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a0e63fc77fc810025d45bfd8e0bf4d6dd"> 8607</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0e63fc77fc810025d45bfd8e0bf4d6dd">CFEM_DG_EulerSolver::BC_Custom</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l08608"></a><span class="lineno"> 8608</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l08609"></a><span class="lineno"> 8609</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l08610"></a><span class="lineno"> 8610</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l08611"></a><span class="lineno"> 8611</span>&#160;                                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l08612"></a><span class="lineno"> 8612</span>&#160;                                    <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l08613"></a><span class="lineno"> 8613</span>&#160;                                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l08614"></a><span class="lineno"> 8614</span>&#160; </div>
<div class="line"><a name="l08615"></a><span class="lineno"> 8615</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l08616"></a><span class="lineno"> 8616</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l08617"></a><span class="lineno"> 8617</span>&#160; </div>
<div class="line"><a name="l08618"></a><span class="lineno"> 8618</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l08619"></a><span class="lineno"> 8619</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l08620"></a><span class="lineno"> 8620</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l08621"></a><span class="lineno"> 8621</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08622"></a><span class="lineno"> 8622</span>&#160; </div>
<div class="line"><a name="l08623"></a><span class="lineno"> 8623</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l08624"></a><span class="lineno"> 8624</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l08625"></a><span class="lineno"> 8625</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l08626"></a><span class="lineno"> 8626</span>&#160; </div>
<div class="line"><a name="l08627"></a><span class="lineno"> 8627</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l08628"></a><span class="lineno"> 8628</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l08629"></a><span class="lineno"> 8629</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l08630"></a><span class="lineno"> 8630</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l08631"></a><span class="lineno"> 8631</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l08632"></a><span class="lineno"> 8632</span>&#160; </div>
<div class="line"><a name="l08633"></a><span class="lineno"> 8633</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l08634"></a><span class="lineno"> 8634</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l08635"></a><span class="lineno"> 8635</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l08636"></a><span class="lineno"> 8636</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l08637"></a><span class="lineno"> 8637</span>&#160; </div>
<div class="line"><a name="l08638"></a><span class="lineno"> 8638</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l08639"></a><span class="lineno"> 8639</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l08640"></a><span class="lineno"> 8640</span>&#160; </div>
<div class="line"><a name="l08641"></a><span class="lineno"> 8641</span>&#160;    <span class="comment">/* Get the necessary data from the standard face. */</span></div>
<div class="line"><a name="l08642"></a><span class="lineno"> 8642</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l08643"></a><span class="lineno"> 8643</span>&#160; </div>
<div class="line"><a name="l08644"></a><span class="lineno"> 8644</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l08645"></a><span class="lineno"> 8645</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l08646"></a><span class="lineno"> 8646</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l08647"></a><span class="lineno"> 8647</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l08648"></a><span class="lineno"> 8648</span>&#160; </div>
<div class="line"><a name="l08649"></a><span class="lineno"> 8649</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l08650"></a><span class="lineno"> 8650</span>&#160;<span class="comment">       faces. The array work is used as temporary storage inside the</span></div>
<div class="line"><a name="l08651"></a><span class="lineno"> 8651</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l08652"></a><span class="lineno"> 8652</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l08653"></a><span class="lineno"> 8653</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l08654"></a><span class="lineno"> 8654</span>&#160; </div>
<div class="line"><a name="l08655"></a><span class="lineno"> 8655</span>&#160;    <span class="comment">/*--- Loop over the number of simultaneously treated faces and integration points</span></div>
<div class="line"><a name="l08656"></a><span class="lineno"> 8656</span>&#160;<span class="comment">          to compute the right state via the customized boundary conditions. ---*/</span></div>
<div class="line"><a name="l08657"></a><span class="lineno"> 8657</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l08658"></a><span class="lineno"> 8658</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l08659"></a><span class="lineno"> 8659</span>&#160; </div>
<div class="line"><a name="l08660"></a><span class="lineno"> 8660</span>&#160;<span class="preprocessor">#ifdef RINGLEB</span></div>
<div class="line"><a name="l08661"></a><span class="lineno"> 8661</span>&#160; </div>
<div class="line"><a name="l08662"></a><span class="lineno"> 8662</span>&#160;        <span class="comment">/* Ringleb case. Specify the exact solution for the right solution.</span></div>
<div class="line"><a name="l08663"></a><span class="lineno"> 8663</span>&#160;<span class="comment">           First determine the pointer to the coordinates of this integration</span></div>
<div class="line"><a name="l08664"></a><span class="lineno"> 8664</span>&#160;<span class="comment">           point and the pointer to the solution. Afterwards call the function</span></div>
<div class="line"><a name="l08665"></a><span class="lineno"> 8665</span>&#160;<span class="comment">           RinglebSolution to do the actual job. */</span></div>
<div class="line"><a name="l08666"></a><span class="lineno"> 8666</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = surfElem[ll+l].<a class="code" href="class_c_surface_element_f_e_m.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l08667"></a><span class="lineno"> 8667</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR   = solIntR + NPad*i + ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08668"></a><span class="lineno"> 8668</span>&#160; </div>
<div class="line"><a name="l08669"></a><span class="lineno"> 8669</span>&#160;        RinglebSolution(coor, UR);</div>
<div class="line"><a name="l08670"></a><span class="lineno"> 8670</span>&#160; </div>
<div class="line"><a name="l08671"></a><span class="lineno"> 8671</span>&#160;<span class="preprocessor">#elif MANUFACTURED_SOLUTION</span></div>
<div class="line"><a name="l08672"></a><span class="lineno"> 8672</span>&#160; </div>
<div class="line"><a name="l08673"></a><span class="lineno"> 8673</span>&#160;        <span class="comment">/* Manufactured solution. Specify the exact solution for the right solution.</span></div>
<div class="line"><a name="l08674"></a><span class="lineno"> 8674</span>&#160;<span class="comment">           First determine the pointer to the coordinates of this integration</span></div>
<div class="line"><a name="l08675"></a><span class="lineno"> 8675</span>&#160;<span class="comment">           point and the pointer to the solution. Afterwards call the function</span></div>
<div class="line"><a name="l08676"></a><span class="lineno"> 8676</span>&#160;<span class="comment">           DetermineManufacturedSolution to do the actual job. */</span></div>
<div class="line"><a name="l08677"></a><span class="lineno"> 8677</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = surfElem[ll+l].<a class="code" href="class_c_surface_element_f_e_m.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l08678"></a><span class="lineno"> 8678</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR   = solIntR + NPad*i + ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08679"></a><span class="lineno"> 8679</span>&#160; </div>
<div class="line"><a name="l08680"></a><span class="lineno"> 8680</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RGas = config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l08681"></a><span class="lineno"> 8681</span>&#160;        DetermineManufacturedSolution(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>, RGas,  coor, UR);</div>
<div class="line"><a name="l08682"></a><span class="lineno"> 8682</span>&#160; </div>
<div class="line"><a name="l08683"></a><span class="lineno"> 8683</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l08684"></a><span class="lineno"> 8684</span>&#160;        <span class="comment">/* No compiler directive specified. Write an error message and exit. */</span></div>
<div class="line"><a name="l08685"></a><span class="lineno"> 8685</span>&#160;        <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;No or wrong compiler directive specified. This is necessary for customized boundary conditions.&quot;</span>,</div>
<div class="line"><a name="l08686"></a><span class="lineno"> 8686</span>&#160;                       <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l08687"></a><span class="lineno"> 8687</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l08688"></a><span class="lineno"> 8688</span>&#160;      }</div>
<div class="line"><a name="l08689"></a><span class="lineno"> 8689</span>&#160;    }</div>
<div class="line"><a name="l08690"></a><span class="lineno"> 8690</span>&#160; </div>
<div class="line"><a name="l08691"></a><span class="lineno"> 8691</span>&#160;    <span class="comment">/* The remainder of the contribution of this boundary face to the residual</span></div>
<div class="line"><a name="l08692"></a><span class="lineno"> 8692</span>&#160;<span class="comment">       is the same for all boundary conditions. Hence a generic function can</span></div>
<div class="line"><a name="l08693"></a><span class="lineno"> 8693</span>&#160;<span class="comment">       be used to carry out this task. */</span></div>
<div class="line"><a name="l08694"></a><span class="lineno"> 8694</span>&#160;    ResidualInviscidBoundaryFace(config, llEnd, NPad, conv_numerics, &amp;surfElem[l],</div>
<div class="line"><a name="l08695"></a><span class="lineno"> 8695</span>&#160;                                 solIntL, solIntR, work, resFaces, indResFaces);</div>
<div class="line"><a name="l08696"></a><span class="lineno"> 8696</span>&#160; </div>
<div class="line"><a name="l08697"></a><span class="lineno"> 8697</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l08698"></a><span class="lineno"> 8698</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l08699"></a><span class="lineno"> 8699</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l08700"></a><span class="lineno"> 8700</span>&#160;  }</div>
<div class="line"><a name="l08701"></a><span class="lineno"> 8701</span>&#160;}</div>
<div class="line"><a name="l08702"></a><span class="lineno"> 8702</span>&#160; </div>
<div class="line"><a name="l08703"></a><span class="lineno"> 8703</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::ResidualInviscidBoundaryFace(</div>
<div class="line"><a name="l08704"></a><span class="lineno"> 8704</span>&#160;                                      <a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l08705"></a><span class="lineno"> 8705</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l08706"></a><span class="lineno"> 8706</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l08707"></a><span class="lineno"> 8707</span>&#160;                                      <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l08708"></a><span class="lineno"> 8708</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l08709"></a><span class="lineno"> 8709</span>&#160;                                      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *solInt0,</div>
<div class="line"><a name="l08710"></a><span class="lineno"> 8710</span>&#160;                                      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *solInt1,</div>
<div class="line"><a name="l08711"></a><span class="lineno"> 8711</span>&#160;                                      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *fluxes,</div>
<div class="line"><a name="l08712"></a><span class="lineno"> 8712</span>&#160;                                      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l08713"></a><span class="lineno"> 8713</span>&#160;                                      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>            &amp;indResFaces) {</div>
<div class="line"><a name="l08714"></a><span class="lineno"> 8714</span>&#160; </div>
<div class="line"><a name="l08715"></a><span class="lineno"> 8715</span>&#160;  <span class="comment">/* Easier storage of the number of bytes to copy in the memcpy calls. */</span></div>
<div class="line"><a name="l08716"></a><span class="lineno"> 8716</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l08717"></a><span class="lineno"> 8717</span>&#160; </div>
<div class="line"><a name="l08718"></a><span class="lineno"> 8718</span>&#160;  <span class="comment">/*--- Get the required information from the standard face, which is the</span></div>
<div class="line"><a name="l08719"></a><span class="lineno"> 8719</span>&#160;<span class="comment">        same for all faces considered. ---*/</span></div>
<div class="line"><a name="l08720"></a><span class="lineno"> 8720</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind     = surfElem[0].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l08721"></a><span class="lineno"> 8721</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l08722"></a><span class="lineno"> 8722</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs   = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a26266f4d68d95c22bbb949fe6d8f5db6">GetNDOFsFace</a>();</div>
<div class="line"><a name="l08723"></a><span class="lineno"> 8723</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>     *weights = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l08724"></a><span class="lineno"> 8724</span>&#160; </div>
<div class="line"><a name="l08725"></a><span class="lineno"> 8725</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l08726"></a><span class="lineno"> 8726</span>&#160;  <span class="comment">/*--- Step 1: Compute the fluxes in the integration points using the   ---*/</span></div>
<div class="line"><a name="l08727"></a><span class="lineno"> 8727</span>&#160;  <span class="comment">/*---         approximate Riemann solver.                              ---*/</span></div>
<div class="line"><a name="l08728"></a><span class="lineno"> 8728</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l08729"></a><span class="lineno"> 8729</span>&#160; </div>
<div class="line"><a name="l08730"></a><span class="lineno"> 8730</span>&#160;  <span class="comment">/* Store the normals and grid velocities of the faces in an array of</span></div>
<div class="line"><a name="l08731"></a><span class="lineno"> 8731</span>&#160;<span class="comment">     pointers to be used in the call to ComputeInviscidFluxesFace. */</span></div>
<div class="line"><a name="l08732"></a><span class="lineno"> 8732</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>* arrNorm[<a class="code" href="solver__direct__mean__fem_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>];</div>
<div class="line"><a name="l08733"></a><span class="lineno"> 8733</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>* arrGridVel[<a class="code" href="solver__direct__mean__fem_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>];</div>
<div class="line"><a name="l08734"></a><span class="lineno"> 8734</span>&#160; </div>
<div class="line"><a name="l08735"></a><span class="lineno"> 8735</span>&#160;  <span class="keywordflow">if</span>(nFaceSimul &gt; <a class="code" href="solver__direct__mean__fem_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>)</div>
<div class="line"><a name="l08736"></a><span class="lineno"> 8736</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;SIZE_ARR_NORM is too small. Increase it or decrease ALIGNED_BYTES_MATMUL&quot;</span>,</div>
<div class="line"><a name="l08737"></a><span class="lineno"> 8737</span>&#160;                   <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l08738"></a><span class="lineno"> 8738</span>&#160; </div>
<div class="line"><a name="l08739"></a><span class="lineno"> 8739</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l08740"></a><span class="lineno"> 8740</span>&#160;    arrNorm[l]    = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data();</div>
<div class="line"><a name="l08741"></a><span class="lineno"> 8741</span>&#160;    arrGridVel[l] = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data();</div>
<div class="line"><a name="l08742"></a><span class="lineno"> 8742</span>&#160;  }</div>
<div class="line"><a name="l08743"></a><span class="lineno"> 8743</span>&#160; </div>
<div class="line"><a name="l08744"></a><span class="lineno"> 8744</span>&#160;  <span class="comment">/* General function to compute the inviscid fluxes, using an approximate</span></div>
<div class="line"><a name="l08745"></a><span class="lineno"> 8745</span>&#160;<span class="comment">     Riemann solver in the integration points. */</span></div>
<div class="line"><a name="l08746"></a><span class="lineno"> 8746</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4851d39829e12202592d85c36ea36489">ComputeInviscidFluxesFace</a>(config, nFaceSimul, NPad, nInt, arrNorm, arrGridVel,</div>
<div class="line"><a name="l08747"></a><span class="lineno"> 8747</span>&#160;                            solInt0, solInt1, fluxes, conv_numerics);</div>
<div class="line"><a name="l08748"></a><span class="lineno"> 8748</span>&#160; </div>
<div class="line"><a name="l08749"></a><span class="lineno"> 8749</span>&#160;  <span class="comment">/* Multiply the fluxes with the integration weight of the corresponding</span></div>
<div class="line"><a name="l08750"></a><span class="lineno"> 8750</span>&#160;<span class="comment">     integration point. */</span></div>
<div class="line"><a name="l08751"></a><span class="lineno"> 8751</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l08752"></a><span class="lineno"> 8752</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux = fluxes + i*NPad;</div>
<div class="line"><a name="l08753"></a><span class="lineno"> 8753</span>&#160; </div>
<div class="line"><a name="l08754"></a><span class="lineno"> 8754</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;NPad; ++j)</div>
<div class="line"><a name="l08755"></a><span class="lineno"> 8755</span>&#160;      flux[j] *= weights[i];</div>
<div class="line"><a name="l08756"></a><span class="lineno"> 8756</span>&#160;  }</div>
<div class="line"><a name="l08757"></a><span class="lineno"> 8757</span>&#160; </div>
<div class="line"><a name="l08758"></a><span class="lineno"> 8758</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l08759"></a><span class="lineno"> 8759</span>&#160;  <span class="comment">/*--- Step 2: Compute the contribution to the residuals from the       ---*/</span></div>
<div class="line"><a name="l08760"></a><span class="lineno"> 8760</span>&#160;  <span class="comment">/*---         integration over the surface element.                    ---*/</span></div>
<div class="line"><a name="l08761"></a><span class="lineno"> 8761</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l08762"></a><span class="lineno"> 8762</span>&#160; </div>
<div class="line"><a name="l08763"></a><span class="lineno"> 8763</span>&#160;  <span class="comment">/* Get the correct form of the basis functions needed for the matrix</span></div>
<div class="line"><a name="l08764"></a><span class="lineno"> 8764</span>&#160;<span class="comment">     multiplication to compute the residual. */</span></div>
<div class="line"><a name="l08765"></a><span class="lineno"> 8765</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFaceTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a2d12edcf4ade4e05af14d9c9f2fa6e07">GetBasisFaceIntegrationTranspose</a>();</div>
<div class="line"><a name="l08766"></a><span class="lineno"> 8766</span>&#160; </div>
<div class="line"><a name="l08767"></a><span class="lineno"> 8767</span>&#160;  <span class="comment">/* Call the general function to carry out the matrix product. Use solint0</span></div>
<div class="line"><a name="l08768"></a><span class="lineno"> 8768</span>&#160;<span class="comment">     as temporary storage for the result. */</span></div>
<div class="line"><a name="l08769"></a><span class="lineno"> 8769</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, basisFaceTrans, fluxes, solInt0, config);</div>
<div class="line"><a name="l08770"></a><span class="lineno"> 8770</span>&#160; </div>
<div class="line"><a name="l08771"></a><span class="lineno"> 8771</span>&#160;  <span class="comment">/* Loop over the number of simultaneously treated faces to store the</span></div>
<div class="line"><a name="l08772"></a><span class="lineno"> 8772</span>&#160;<span class="comment">     residual in the correct locations in resFaces. */</span></div>
<div class="line"><a name="l08773"></a><span class="lineno"> 8773</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l08774"></a><span class="lineno"> 8774</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08775"></a><span class="lineno"> 8775</span>&#160; </div>
<div class="line"><a name="l08776"></a><span class="lineno"> 8776</span>&#160;    <span class="comment">/* Easier storage of the position in the residual array for this face</span></div>
<div class="line"><a name="l08777"></a><span class="lineno"> 8777</span>&#160;<span class="comment">       and update the corresponding counter. */</span></div>
<div class="line"><a name="l08778"></a><span class="lineno"> 8778</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFace = resFaces + indResFaces*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08779"></a><span class="lineno"> 8779</span>&#160;    indResFaces       += nDOFs;</div>
<div class="line"><a name="l08780"></a><span class="lineno"> 8780</span>&#160; </div>
<div class="line"><a name="l08781"></a><span class="lineno"> 8781</span>&#160;    <span class="comment">/* Loop over the DOFs and copy the data. */</span></div>
<div class="line"><a name="l08782"></a><span class="lineno"> 8782</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i)</div>
<div class="line"><a name="l08783"></a><span class="lineno"> 8783</span>&#160;      memcpy(resFace+<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i, solInt0+NPad*i+llNVar, nBytes);</div>
<div class="line"><a name="l08784"></a><span class="lineno"> 8784</span>&#160;  }</div>
<div class="line"><a name="l08785"></a><span class="lineno"> 8785</span>&#160;}</div>
<div class="line"><a name="l08786"></a><span class="lineno"> 8786</span>&#160; </div>
<div class="line"><a name="l08787"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9"> 8787</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">CFEM_DG_EulerSolver::LeftStatesIntegrationPointsBoundaryFace</a>(</div>
<div class="line"><a name="l08788"></a><span class="lineno"> 8788</span>&#160;                                             <a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l08789"></a><span class="lineno"> 8789</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l08790"></a><span class="lineno"> 8790</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l08791"></a><span class="lineno"> 8791</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l08792"></a><span class="lineno"> 8792</span>&#160;                                             <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *solFace,</div>
<div class="line"><a name="l08793"></a><span class="lineno"> 8793</span>&#160;                                             <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *solIntL) {</div>
<div class="line"><a name="l08794"></a><span class="lineno"> 8794</span>&#160; </div>
<div class="line"><a name="l08795"></a><span class="lineno"> 8795</span>&#160;  <span class="comment">/* Get the required information from the corresponding standard face, which is the</span></div>
<div class="line"><a name="l08796"></a><span class="lineno"> 8796</span>&#160;<span class="comment">     same for all simultaneously treated faces. */</span></div>
<div class="line"><a name="l08797"></a><span class="lineno"> 8797</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind   = surfElem[0].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l08798"></a><span class="lineno"> 8798</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l08799"></a><span class="lineno"> 8799</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a26266f4d68d95c22bbb949fe6d8f5db6">GetNDOFsFace</a>();</div>
<div class="line"><a name="l08800"></a><span class="lineno"> 8800</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a283dc8babad462022e4621afe0251929">GetBasisFaceIntegration</a>();</div>
<div class="line"><a name="l08801"></a><span class="lineno"> 8801</span>&#160; </div>
<div class="line"><a name="l08802"></a><span class="lineno"> 8802</span>&#160;  <span class="comment">/* The number of bytes to copied in the memcpy calls. */</span></div>
<div class="line"><a name="l08803"></a><span class="lineno"> 8803</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l08804"></a><span class="lineno"> 8804</span>&#160; </div>
<div class="line"><a name="l08805"></a><span class="lineno"> 8805</span>&#160;  <span class="comment">/* Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l08806"></a><span class="lineno"> 8806</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l08807"></a><span class="lineno"> 8807</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08808"></a><span class="lineno"> 8808</span>&#160; </div>
<div class="line"><a name="l08809"></a><span class="lineno"> 8809</span>&#160;    <span class="comment">/* Easier storage of the DOFs of the face. */</span></div>
<div class="line"><a name="l08810"></a><span class="lineno"> 8810</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFs = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#aee91841e533b10cdbe3b3b09e98e3695">DOFsSolFace</a>.data();</div>
<div class="line"><a name="l08811"></a><span class="lineno"> 8811</span>&#160; </div>
<div class="line"><a name="l08812"></a><span class="lineno"> 8812</span>&#160;    <span class="comment">/* The numbering of the DOFs is given for the entire grid. However, in the</span></div>
<div class="line"><a name="l08813"></a><span class="lineno"> 8813</span>&#160;<span class="comment">       working vectors for the solution a numbering per time level is used.</span></div>
<div class="line"><a name="l08814"></a><span class="lineno"> 8814</span>&#160;<span class="comment">       Therefore an offset must be applied, which can be obtained from the</span></div>
<div class="line"><a name="l08815"></a><span class="lineno"> 8815</span>&#160;<span class="comment">       corresponding volume element. Note that this offset is non-negative. */</span></div>
<div class="line"><a name="l08816"></a><span class="lineno"> 8816</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  volID     = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>;</div>
<div class="line"><a name="l08817"></a><span class="lineno"> 8817</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[volID].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l08818"></a><span class="lineno"> 8818</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  offset    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[volID].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l08819"></a><span class="lineno"> 8819</span>&#160;                                   - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[volID].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l08820"></a><span class="lineno"> 8820</span>&#160; </div>
<div class="line"><a name="l08821"></a><span class="lineno"> 8821</span>&#160;    <span class="comment">/* Copy the solution of the DOFs of the face such that it is contiguous</span></div>
<div class="line"><a name="l08822"></a><span class="lineno"> 8822</span>&#160;<span class="comment">       in memory. */</span></div>
<div class="line"><a name="l08823"></a><span class="lineno"> 8823</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l08824"></a><span class="lineno"> 8824</span>&#160; </div>
<div class="line"><a name="l08825"></a><span class="lineno"> 8825</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(DOFs[i]-offset);</div>
<div class="line"><a name="l08826"></a><span class="lineno"> 8826</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *sol    = solFace + NPad*i + llNVar;</div>
<div class="line"><a name="l08827"></a><span class="lineno"> 8827</span>&#160;      memcpy(sol, solDOF, nBytes);</div>
<div class="line"><a name="l08828"></a><span class="lineno"> 8828</span>&#160;    }</div>
<div class="line"><a name="l08829"></a><span class="lineno"> 8829</span>&#160;  }</div>
<div class="line"><a name="l08830"></a><span class="lineno"> 8830</span>&#160; </div>
<div class="line"><a name="l08831"></a><span class="lineno"> 8831</span>&#160;  <span class="comment">/* Call the general function to carry out the matrix product. */</span></div>
<div class="line"><a name="l08832"></a><span class="lineno"> 8832</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt, NPad, nDOFs, basisFace, solFace, solIntL, config);</div>
<div class="line"><a name="l08833"></a><span class="lineno"> 8833</span>&#160;}</div>
<div class="line"><a name="l08834"></a><span class="lineno"> 8834</span>&#160; </div>
<div class="line"><a name="l08835"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#a4851d39829e12202592d85c36ea36489"> 8835</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4851d39829e12202592d85c36ea36489">CFEM_DG_EulerSolver::ComputeInviscidFluxesFace</a>(<a class="code" href="class_c_config.html">CConfig</a>              *config,</div>
<div class="line"><a name="l08836"></a><span class="lineno"> 8836</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul,</div>
<div class="line"><a name="l08837"></a><span class="lineno"> 8837</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l08838"></a><span class="lineno"> 8838</span>&#160;                                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  nPoints,</div>
<div class="line"><a name="l08839"></a><span class="lineno"> 8839</span>&#160;                                                    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *normalsFace[],</div>
<div class="line"><a name="l08840"></a><span class="lineno"> 8840</span>&#160;                                                    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *gridVelsFace[],</div>
<div class="line"><a name="l08841"></a><span class="lineno"> 8841</span>&#160;                                                    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *solL,</div>
<div class="line"><a name="l08842"></a><span class="lineno"> 8842</span>&#160;                                                    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *solR,</div>
<div class="line"><a name="l08843"></a><span class="lineno"> 8843</span>&#160;                                                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *fluxes,</div>
<div class="line"><a name="l08844"></a><span class="lineno"> 8844</span>&#160;                                                    <a class="code" href="class_c_numerics.html">CNumerics</a>            *numerics) {</div>
<div class="line"><a name="l08845"></a><span class="lineno"> 8845</span>&#160; </div>
<div class="line"><a name="l08846"></a><span class="lineno"> 8846</span>&#160;  <span class="comment">/* Easier storage of the specific heat ratio. */</span></div>
<div class="line"><a name="l08847"></a><span class="lineno"> 8847</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> gm1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>;</div>
<div class="line"><a name="l08848"></a><span class="lineno"> 8848</span>&#160; </div>
<div class="line"><a name="l08849"></a><span class="lineno"> 8849</span>&#160;  <span class="comment">/* Make a distinction between the several Riemann solvers. */</span></div>
<div class="line"><a name="l08850"></a><span class="lineno"> 8850</span>&#160;  <span class="keywordflow">switch</span>( config-&gt;<a class="code" href="class_c_config.html#ac5d613463ef0d7b01e66c4e33f586afb">GetRiemann_Solver_FEM</a>() ) {</div>
<div class="line"><a name="l08851"></a><span class="lineno"> 8851</span>&#160; </div>
<div class="line"><a name="l08852"></a><span class="lineno"> 8852</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a0e6f6eb4c523780ba375ff4b5ecb906aa93529177c2934ca4f60d82a6b1c85c67">ROE</a>: {</div>
<div class="line"><a name="l08853"></a><span class="lineno"> 8853</span>&#160; </div>
<div class="line"><a name="l08854"></a><span class="lineno"> 8854</span>&#160;      <span class="comment">/* Roe&#39;s approximate Riemann solver. Easier storage of the cut off</span></div>
<div class="line"><a name="l08855"></a><span class="lineno"> 8855</span>&#160;<span class="comment">         value for the entropy correction. */</span></div>
<div class="line"><a name="l08856"></a><span class="lineno"> 8856</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Delta = config-&gt;<a class="code" href="class_c_config.html#a0f7ace5ebf01fd50bcadab8b50b897c8">GetEntropyFix_Coeff</a>();</div>
<div class="line"><a name="l08857"></a><span class="lineno"> 8857</span>&#160; </div>
<div class="line"><a name="l08858"></a><span class="lineno"> 8858</span>&#160;      <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l08859"></a><span class="lineno"> 8859</span>&#160;<span class="comment">         in order to have the most efficient code. */</span></div>
<div class="line"><a name="l08860"></a><span class="lineno"> 8860</span>&#160;      <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l08861"></a><span class="lineno"> 8861</span>&#160; </div>
<div class="line"><a name="l08862"></a><span class="lineno"> 8862</span>&#160;        <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l08863"></a><span class="lineno"> 8863</span>&#160; </div>
<div class="line"><a name="l08864"></a><span class="lineno"> 8864</span>&#160;          <span class="comment">/* Two dimensional simulation. Loop over the number of faces treated</span></div>
<div class="line"><a name="l08865"></a><span class="lineno"> 8865</span>&#160;<span class="comment">             simultaneously. */</span></div>
<div class="line"><a name="l08866"></a><span class="lineno"> 8866</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l08867"></a><span class="lineno"> 8867</span>&#160; </div>
<div class="line"><a name="l08868"></a><span class="lineno"> 8868</span>&#160;            <span class="comment">/* Easier storage for some variables of this face. */</span></div>
<div class="line"><a name="l08869"></a><span class="lineno"> 8869</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals   = normalsFace[l];</div>
<div class="line"><a name="l08870"></a><span class="lineno"> 8870</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVels  = gridVelsFace[l];</div>
<div class="line"><a name="l08871"></a><span class="lineno"> 8871</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> lNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08872"></a><span class="lineno"> 8872</span>&#160; </div>
<div class="line"><a name="l08873"></a><span class="lineno"> 8873</span>&#160;            <span class="comment">/* Loop over the number of points for this face. */</span></div>
<div class="line"><a name="l08874"></a><span class="lineno"> 8874</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;nPoints; ++i) {</div>
<div class="line"><a name="l08875"></a><span class="lineno"> 8875</span>&#160; </div>
<div class="line"><a name="l08876"></a><span class="lineno"> 8876</span>&#160;              <span class="comment">/* Easier storage of the left and right solution, the face normals,</span></div>
<div class="line"><a name="l08877"></a><span class="lineno"> 8877</span>&#160;<span class="comment">                 the grid velocities and the flux vector for this point. */</span></div>
<div class="line"><a name="l08878"></a><span class="lineno"> 8878</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offPointer = i*NPad + lNVar;</div>
<div class="line"><a name="l08879"></a><span class="lineno"> 8879</span>&#160; </div>
<div class="line"><a name="l08880"></a><span class="lineno"> 8880</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solL + offPointer;</div>
<div class="line"><a name="l08881"></a><span class="lineno"> 8881</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solR + offPointer;</div>
<div class="line"><a name="l08882"></a><span class="lineno"> 8882</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *norm    = normals + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l08883"></a><span class="lineno"> 8883</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = gridVels + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l08884"></a><span class="lineno"> 8884</span>&#160;                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux    = fluxes + offPointer;</div>
<div class="line"><a name="l08885"></a><span class="lineno"> 8885</span>&#160; </div>
<div class="line"><a name="l08886"></a><span class="lineno"> 8886</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nx = norm[0], ny = norm[1], halfArea = 0.5*norm[2];</div>
<div class="line"><a name="l08887"></a><span class="lineno"> 8887</span>&#160; </div>
<div class="line"><a name="l08888"></a><span class="lineno"> 8888</span>&#160;              <span class="comment">/* Compute the normal grid velocity. */</span></div>
<div class="line"><a name="l08889"></a><span class="lineno"> 8889</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> gridVelNorm = gridVel[0]*nx + gridVel[1]*ny;</div>
<div class="line"><a name="l08890"></a><span class="lineno"> 8890</span>&#160; </div>
<div class="line"><a name="l08891"></a><span class="lineno"> 8891</span>&#160;              <span class="comment">/*--- Compute the primitive variables of the left and right state. ---*/</span></div>
<div class="line"><a name="l08892"></a><span class="lineno"> 8892</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tmp       = 1.0/UL[0];</div>
<div class="line"><a name="l08893"></a><span class="lineno"> 8893</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vxL = tmp*UL[1];</div>
<div class="line"><a name="l08894"></a><span class="lineno"> 8894</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vyL = tmp*UL[2];</div>
<div class="line"><a name="l08895"></a><span class="lineno"> 8895</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pL  = gm1*(UL[3] - 0.5*(vxL*UL[1] + vyL*UL[2]));</div>
<div class="line"><a name="l08896"></a><span class="lineno"> 8896</span>&#160; </div>
<div class="line"><a name="l08897"></a><span class="lineno"> 8897</span>&#160;              tmp                 = 1.0/UR[0];</div>
<div class="line"><a name="l08898"></a><span class="lineno"> 8898</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vxR = tmp*UR[1];</div>
<div class="line"><a name="l08899"></a><span class="lineno"> 8899</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vyR = tmp*UR[2];</div>
<div class="line"><a name="l08900"></a><span class="lineno"> 8900</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pR  = gm1*(UR[3] - 0.5*(vxR*UR[1] + vyR*UR[2]));</div>
<div class="line"><a name="l08901"></a><span class="lineno"> 8901</span>&#160; </div>
<div class="line"><a name="l08902"></a><span class="lineno"> 8902</span>&#160;              <span class="comment">/*--- Compute the difference of the conservative mean flow variables. ---*/</span></div>
<div class="line"><a name="l08903"></a><span class="lineno"> 8903</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dr  = UR[0] - UL[0];</div>
<div class="line"><a name="l08904"></a><span class="lineno"> 8904</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dru = UR[1] - UL[1];</div>
<div class="line"><a name="l08905"></a><span class="lineno"> 8905</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drv = UR[2] - UL[2];</div>
<div class="line"><a name="l08906"></a><span class="lineno"> 8906</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drE = UR[3] - UL[3];</div>
<div class="line"><a name="l08907"></a><span class="lineno"> 8907</span>&#160; </div>
<div class="line"><a name="l08908"></a><span class="lineno"> 8908</span>&#160;              <span class="comment">/*--- Compute the Roe average state. ---*/</span></div>
<div class="line"><a name="l08909"></a><span class="lineno"> 8909</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> zL = sqrt(UL[0]);</div>
<div class="line"><a name="l08910"></a><span class="lineno"> 8910</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> zR = sqrt(UR[0]);</div>
<div class="line"><a name="l08911"></a><span class="lineno"> 8911</span>&#160;              tmp                = 1.0/(zL + zR);</div>
<div class="line"><a name="l08912"></a><span class="lineno"> 8912</span>&#160; </div>
<div class="line"><a name="l08913"></a><span class="lineno"> 8913</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rHL = UL[3] + pL;</div>
<div class="line"><a name="l08914"></a><span class="lineno"> 8914</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rHR = UR[3] + pR;</div>
<div class="line"><a name="l08915"></a><span class="lineno"> 8915</span>&#160; </div>
<div class="line"><a name="l08916"></a><span class="lineno"> 8916</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> uAvg = tmp*(zL*vxL + zR*vxR);</div>
<div class="line"><a name="l08917"></a><span class="lineno"> 8917</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vAvg = tmp*(zL*vyL + zR*vyR);</div>
<div class="line"><a name="l08918"></a><span class="lineno"> 8918</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> HAvg = tmp*(rHL/zL + rHR/zR);</div>
<div class="line"><a name="l08919"></a><span class="lineno"> 8919</span>&#160; </div>
<div class="line"><a name="l08920"></a><span class="lineno"> 8920</span>&#160;              <span class="comment">/*--- Compute from the Roe average state some variables, which occur</span></div>
<div class="line"><a name="l08921"></a><span class="lineno"> 8921</span>&#160;<span class="comment">                    quite often in the matrix vector product to be computed. ---*/</span></div>
<div class="line"><a name="l08922"></a><span class="lineno"> 8922</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> alphaAvg = 0.5*(uAvg*uAvg + vAvg*vAvg);</div>
<div class="line"><a name="l08923"></a><span class="lineno"> 8923</span>&#160;              tmp                      = gm1*(HAvg - alphaAvg);</div>
<div class="line"><a name="l08924"></a><span class="lineno"> 8924</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> a2Avg    = fabs(tmp);</div>
<div class="line"><a name="l08925"></a><span class="lineno"> 8925</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> aAvg     = sqrt(a2Avg);</div>
<div class="line"><a name="l08926"></a><span class="lineno"> 8926</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnAvg    = uAvg*nx + vAvg*ny;</div>
<div class="line"><a name="l08927"></a><span class="lineno"> 8927</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> unAvg    = vnAvg - gridVelNorm;</div>
<div class="line"><a name="l08928"></a><span class="lineno"> 8928</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ovaAvg   = 1.0/aAvg;</div>
<div class="line"><a name="l08929"></a><span class="lineno"> 8929</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ova2Avg  = 1.0/a2Avg;</div>
<div class="line"><a name="l08930"></a><span class="lineno"> 8930</span>&#160; </div>
<div class="line"><a name="l08931"></a><span class="lineno"> 8931</span>&#160;              <span class="comment">/*--- Compute the absolute values of the three eigenvalues and</span></div>
<div class="line"><a name="l08932"></a><span class="lineno"> 8932</span>&#160;<span class="comment">                    apply the entropy correction. ---*/</span></div>
<div class="line"><a name="l08933"></a><span class="lineno"> 8933</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam1 = fabs(unAvg + aAvg);</div>
<div class="line"><a name="l08934"></a><span class="lineno"> 8934</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam2 = fabs(unAvg - aAvg);</div>
<div class="line"><a name="l08935"></a><span class="lineno"> 8935</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam3 = fabs(unAvg);</div>
<div class="line"><a name="l08936"></a><span class="lineno"> 8936</span>&#160; </div>
<div class="line"><a name="l08937"></a><span class="lineno"> 8937</span>&#160;              tmp  = Delta*max(lam1, lam2);</div>
<div class="line"><a name="l08938"></a><span class="lineno"> 8938</span>&#160;              lam1 = max(lam1, tmp);</div>
<div class="line"><a name="l08939"></a><span class="lineno"> 8939</span>&#160;              lam2 = max(lam2, tmp);</div>
<div class="line"><a name="l08940"></a><span class="lineno"> 8940</span>&#160;              lam3 = max(lam3, tmp);</div>
<div class="line"><a name="l08941"></a><span class="lineno"> 8941</span>&#160; </div>
<div class="line"><a name="l08942"></a><span class="lineno"> 8942</span>&#160;              <span class="comment">/*--- Some abbreviations, which occur quite often in the dissipation terms. ---*/</span></div>
<div class="line"><a name="l08943"></a><span class="lineno"> 8943</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv1 = 0.5*(lam1 + lam2);</div>
<div class="line"><a name="l08944"></a><span class="lineno"> 8944</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2 = 0.5*(lam1 - lam2);</div>
<div class="line"><a name="l08945"></a><span class="lineno"> 8945</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv3 = abv1 - lam3;</div>
<div class="line"><a name="l08946"></a><span class="lineno"> 8946</span>&#160; </div>
<div class="line"><a name="l08947"></a><span class="lineno"> 8947</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv4 = gm1*(alphaAvg*dr - uAvg*dru - vAvg*drv + drE);</div>
<div class="line"><a name="l08948"></a><span class="lineno"> 8948</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv5 = nx*dru + ny*drv - vnAvg*dr;</div>
<div class="line"><a name="l08949"></a><span class="lineno"> 8949</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv6 = abv3*abv4*ova2Avg + abv2*abv5*ovaAvg;</div>
<div class="line"><a name="l08950"></a><span class="lineno"> 8950</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv7 = abv2*abv4*ovaAvg  + abv3*abv5;</div>
<div class="line"><a name="l08951"></a><span class="lineno"> 8951</span>&#160; </div>
<div class="line"><a name="l08952"></a><span class="lineno"> 8952</span>&#160;              <span class="comment">/*--- Compute the Roe flux vector, which is 0.5*(FL + FR - |A|(UR-UL)). ---*/</span></div>
<div class="line"><a name="l08953"></a><span class="lineno"> 8953</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnL = vxL*nx + vyL*ny;</div>
<div class="line"><a name="l08954"></a><span class="lineno"> 8954</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnR = vxR*nx + vyR*ny;</div>
<div class="line"><a name="l08955"></a><span class="lineno"> 8955</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> unL = vnL - gridVelNorm;</div>
<div class="line"><a name="l08956"></a><span class="lineno"> 8956</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> unR = vnR - gridVelNorm;</div>
<div class="line"><a name="l08957"></a><span class="lineno"> 8957</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pa  = pL + pR;</div>
<div class="line"><a name="l08958"></a><span class="lineno"> 8958</span>&#160; </div>
<div class="line"><a name="l08959"></a><span class="lineno"> 8959</span>&#160;              flux[0] = halfArea*(UL[0]*unL + UR[0]*unR - (lam3*dr + abv6));</div>
<div class="line"><a name="l08960"></a><span class="lineno"> 8960</span>&#160;              flux[1] = halfArea*(UL[1]*unL + UR[1]*unR + pa*nx</div>
<div class="line"><a name="l08961"></a><span class="lineno"> 8961</span>&#160;                      -           (lam3*dru + uAvg*abv6 + nx*abv7));</div>
<div class="line"><a name="l08962"></a><span class="lineno"> 8962</span>&#160;              flux[2] = halfArea*(UL[2]*unL + UR[2]*unR + pa*ny</div>
<div class="line"><a name="l08963"></a><span class="lineno"> 8963</span>&#160;                      -           (lam3*drv + vAvg*abv6 + ny*abv7));</div>
<div class="line"><a name="l08964"></a><span class="lineno"> 8964</span>&#160;              flux[3] = halfArea*(UL[3]*unL + UR[3]*unR + pL*vnL + pR*vnR</div>
<div class="line"><a name="l08965"></a><span class="lineno"> 8965</span>&#160;                      -           (lam3*drE + HAvg*abv6 + vnAvg*abv7));</div>
<div class="line"><a name="l08966"></a><span class="lineno"> 8966</span>&#160;            }</div>
<div class="line"><a name="l08967"></a><span class="lineno"> 8967</span>&#160;          }</div>
<div class="line"><a name="l08968"></a><span class="lineno"> 8968</span>&#160; </div>
<div class="line"><a name="l08969"></a><span class="lineno"> 8969</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l08970"></a><span class="lineno"> 8970</span>&#160;        }</div>
<div class="line"><a name="l08971"></a><span class="lineno"> 8971</span>&#160; </div>
<div class="line"><a name="l08972"></a><span class="lineno"> 8972</span>&#160;        <span class="comment">/*--------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l08973"></a><span class="lineno"> 8973</span>&#160; </div>
<div class="line"><a name="l08974"></a><span class="lineno"> 8974</span>&#160;        <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l08975"></a><span class="lineno"> 8975</span>&#160; </div>
<div class="line"><a name="l08976"></a><span class="lineno"> 8976</span>&#160;          <span class="comment">/* Three dimensional simulation. Loop over the number of faces treated</span></div>
<div class="line"><a name="l08977"></a><span class="lineno"> 8977</span>&#160;<span class="comment">             simultaneously. */</span></div>
<div class="line"><a name="l08978"></a><span class="lineno"> 8978</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l08979"></a><span class="lineno"> 8979</span>&#160; </div>
<div class="line"><a name="l08980"></a><span class="lineno"> 8980</span>&#160;            <span class="comment">/* Easier storage for some variables of this face. */</span></div>
<div class="line"><a name="l08981"></a><span class="lineno"> 8981</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals   = normalsFace[l];</div>
<div class="line"><a name="l08982"></a><span class="lineno"> 8982</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVels  = gridVelsFace[l];</div>
<div class="line"><a name="l08983"></a><span class="lineno"> 8983</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> lNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l08984"></a><span class="lineno"> 8984</span>&#160; </div>
<div class="line"><a name="l08985"></a><span class="lineno"> 8985</span>&#160;            <span class="comment">/* Loop over the number of points for this face. */</span></div>
<div class="line"><a name="l08986"></a><span class="lineno"> 8986</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;nPoints; ++i) {</div>
<div class="line"><a name="l08987"></a><span class="lineno"> 8987</span>&#160; </div>
<div class="line"><a name="l08988"></a><span class="lineno"> 8988</span>&#160;              <span class="comment">/* Easier storage of the left and right solution, the face normals,</span></div>
<div class="line"><a name="l08989"></a><span class="lineno"> 8989</span>&#160;<span class="comment">                 the grid velocities and the flux vector for this point. */</span></div>
<div class="line"><a name="l08990"></a><span class="lineno"> 8990</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offPointer = i*NPad + lNVar;</div>
<div class="line"><a name="l08991"></a><span class="lineno"> 8991</span>&#160; </div>
<div class="line"><a name="l08992"></a><span class="lineno"> 8992</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solL + offPointer;</div>
<div class="line"><a name="l08993"></a><span class="lineno"> 8993</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solR + offPointer;</div>
<div class="line"><a name="l08994"></a><span class="lineno"> 8994</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *norm    = normals + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l08995"></a><span class="lineno"> 8995</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = gridVels + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l08996"></a><span class="lineno"> 8996</span>&#160;                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux    = fluxes + offPointer;</div>
<div class="line"><a name="l08997"></a><span class="lineno"> 8997</span>&#160; </div>
<div class="line"><a name="l08998"></a><span class="lineno"> 8998</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nx = norm[0], ny = norm[1], nz = norm[2];</div>
<div class="line"><a name="l08999"></a><span class="lineno"> 8999</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> halfArea = 0.5*norm[3];</div>
<div class="line"><a name="l09000"></a><span class="lineno"> 9000</span>&#160; </div>
<div class="line"><a name="l09001"></a><span class="lineno"> 9001</span>&#160;              <span class="comment">/* Compute the normal grid velocity. */</span></div>
<div class="line"><a name="l09002"></a><span class="lineno"> 9002</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> gridVelNorm = gridVel[0]*nx + gridVel[1]*ny + gridVel[2]*nz;</div>
<div class="line"><a name="l09003"></a><span class="lineno"> 9003</span>&#160; </div>
<div class="line"><a name="l09004"></a><span class="lineno"> 9004</span>&#160;              <span class="comment">/*--- Compute the primitive variables of the left and right state. ---*/</span></div>
<div class="line"><a name="l09005"></a><span class="lineno"> 9005</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tmp       = 1.0/UL[0];</div>
<div class="line"><a name="l09006"></a><span class="lineno"> 9006</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vxL = tmp*UL[1];</div>
<div class="line"><a name="l09007"></a><span class="lineno"> 9007</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vyL = tmp*UL[2];</div>
<div class="line"><a name="l09008"></a><span class="lineno"> 9008</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vzL = tmp*UL[3];</div>
<div class="line"><a name="l09009"></a><span class="lineno"> 9009</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pL  = gm1*(UL[4] - 0.5*(vxL*UL[1] + vyL*UL[2] + vzL*UL[3]));</div>
<div class="line"><a name="l09010"></a><span class="lineno"> 9010</span>&#160; </div>
<div class="line"><a name="l09011"></a><span class="lineno"> 9011</span>&#160;              tmp                 = 1.0/UR[0];</div>
<div class="line"><a name="l09012"></a><span class="lineno"> 9012</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vxR = tmp*UR[1];</div>
<div class="line"><a name="l09013"></a><span class="lineno"> 9013</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vyR = tmp*UR[2];</div>
<div class="line"><a name="l09014"></a><span class="lineno"> 9014</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vzR = tmp*UR[3];</div>
<div class="line"><a name="l09015"></a><span class="lineno"> 9015</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pR  = gm1*(UR[4] - 0.5*(vxR*UR[1] + vyR*UR[2] + vzR*UR[3]));</div>
<div class="line"><a name="l09016"></a><span class="lineno"> 9016</span>&#160; </div>
<div class="line"><a name="l09017"></a><span class="lineno"> 9017</span>&#160;              <span class="comment">/*--- Compute the difference of the conservative mean flow variables. ---*/</span></div>
<div class="line"><a name="l09018"></a><span class="lineno"> 9018</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dr  = UR[0] - UL[0];</div>
<div class="line"><a name="l09019"></a><span class="lineno"> 9019</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dru = UR[1] - UL[1];</div>
<div class="line"><a name="l09020"></a><span class="lineno"> 9020</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drv = UR[2] - UL[2];</div>
<div class="line"><a name="l09021"></a><span class="lineno"> 9021</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drw = UR[3] - UL[3];</div>
<div class="line"><a name="l09022"></a><span class="lineno"> 9022</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drE = UR[4] - UL[4];</div>
<div class="line"><a name="l09023"></a><span class="lineno"> 9023</span>&#160; </div>
<div class="line"><a name="l09024"></a><span class="lineno"> 9024</span>&#160;              <span class="comment">/*--- Compute the Roe average state. ---*/</span></div>
<div class="line"><a name="l09025"></a><span class="lineno"> 9025</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> zL = sqrt(UL[0]);</div>
<div class="line"><a name="l09026"></a><span class="lineno"> 9026</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> zR = sqrt(UR[0]);</div>
<div class="line"><a name="l09027"></a><span class="lineno"> 9027</span>&#160;              tmp                = 1.0/(zL + zR);</div>
<div class="line"><a name="l09028"></a><span class="lineno"> 9028</span>&#160; </div>
<div class="line"><a name="l09029"></a><span class="lineno"> 9029</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rHL = UL[4] + pL;</div>
<div class="line"><a name="l09030"></a><span class="lineno"> 9030</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rHR = UR[4] + pR;</div>
<div class="line"><a name="l09031"></a><span class="lineno"> 9031</span>&#160; </div>
<div class="line"><a name="l09032"></a><span class="lineno"> 9032</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> uAvg = tmp*(zL*vxL + zR*vxR);</div>
<div class="line"><a name="l09033"></a><span class="lineno"> 9033</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vAvg = tmp*(zL*vyL + zR*vyR);</div>
<div class="line"><a name="l09034"></a><span class="lineno"> 9034</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wAvg = tmp*(zL*vzL + zR*vzR);</div>
<div class="line"><a name="l09035"></a><span class="lineno"> 9035</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> HAvg = tmp*(rHL/zL + rHR/zR);</div>
<div class="line"><a name="l09036"></a><span class="lineno"> 9036</span>&#160; </div>
<div class="line"><a name="l09037"></a><span class="lineno"> 9037</span>&#160;              <span class="comment">/*--- Compute from the Roe average state some variables, which occur</span></div>
<div class="line"><a name="l09038"></a><span class="lineno"> 9038</span>&#160;<span class="comment">                    quite often in the matrix vector product to be computed. ---*/</span></div>
<div class="line"><a name="l09039"></a><span class="lineno"> 9039</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> alphaAvg = 0.5*(uAvg*uAvg + vAvg*vAvg + wAvg*wAvg);</div>
<div class="line"><a name="l09040"></a><span class="lineno"> 9040</span>&#160;              tmp                      = gm1*(HAvg - alphaAvg);</div>
<div class="line"><a name="l09041"></a><span class="lineno"> 9041</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> a2Avg    = fabs(tmp);</div>
<div class="line"><a name="l09042"></a><span class="lineno"> 9042</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> aAvg     = sqrt(a2Avg);</div>
<div class="line"><a name="l09043"></a><span class="lineno"> 9043</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnAvg    = uAvg*nx + vAvg*ny + wAvg*nz;</div>
<div class="line"><a name="l09044"></a><span class="lineno"> 9044</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> unAvg    = vnAvg - gridVelNorm;</div>
<div class="line"><a name="l09045"></a><span class="lineno"> 9045</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ovaAvg   = 1.0/aAvg;</div>
<div class="line"><a name="l09046"></a><span class="lineno"> 9046</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ova2Avg  = 1.0/a2Avg;</div>
<div class="line"><a name="l09047"></a><span class="lineno"> 9047</span>&#160; </div>
<div class="line"><a name="l09048"></a><span class="lineno"> 9048</span>&#160;              <span class="comment">/*--- Compute the absolute values of the three eigenvalues and</span></div>
<div class="line"><a name="l09049"></a><span class="lineno"> 9049</span>&#160;<span class="comment">                    apply the entropy correction. ---*/</span></div>
<div class="line"><a name="l09050"></a><span class="lineno"> 9050</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam1 = fabs(unAvg + aAvg);</div>
<div class="line"><a name="l09051"></a><span class="lineno"> 9051</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam2 = fabs(unAvg - aAvg);</div>
<div class="line"><a name="l09052"></a><span class="lineno"> 9052</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lam3 = fabs(unAvg);</div>
<div class="line"><a name="l09053"></a><span class="lineno"> 9053</span>&#160; </div>
<div class="line"><a name="l09054"></a><span class="lineno"> 9054</span>&#160;              tmp  = Delta*max(lam1, lam2);</div>
<div class="line"><a name="l09055"></a><span class="lineno"> 9055</span>&#160;              lam1 = max(lam1, tmp);</div>
<div class="line"><a name="l09056"></a><span class="lineno"> 9056</span>&#160;              lam2 = max(lam2, tmp);</div>
<div class="line"><a name="l09057"></a><span class="lineno"> 9057</span>&#160;              lam3 = max(lam3, tmp);</div>
<div class="line"><a name="l09058"></a><span class="lineno"> 9058</span>&#160; </div>
<div class="line"><a name="l09059"></a><span class="lineno"> 9059</span>&#160;              <span class="comment">/*--- Some abbreviations, which occur quite often in the dissipation terms. ---*/</span></div>
<div class="line"><a name="l09060"></a><span class="lineno"> 9060</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv1 = 0.5*(lam1 + lam2);</div>
<div class="line"><a name="l09061"></a><span class="lineno"> 9061</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2 = 0.5*(lam1 - lam2);</div>
<div class="line"><a name="l09062"></a><span class="lineno"> 9062</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv3 = abv1 - lam3;</div>
<div class="line"><a name="l09063"></a><span class="lineno"> 9063</span>&#160; </div>
<div class="line"><a name="l09064"></a><span class="lineno"> 9064</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv4 = gm1*(alphaAvg*dr - uAvg*dru - vAvg*drv -wAvg*drw + drE);</div>
<div class="line"><a name="l09065"></a><span class="lineno"> 9065</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv5 = nx*dru + ny*drv + nz*drw - vnAvg*dr;</div>
<div class="line"><a name="l09066"></a><span class="lineno"> 9066</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv6 = abv3*abv4*ova2Avg + abv2*abv5*ovaAvg;</div>
<div class="line"><a name="l09067"></a><span class="lineno"> 9067</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv7 = abv2*abv4*ovaAvg  + abv3*abv5;</div>
<div class="line"><a name="l09068"></a><span class="lineno"> 9068</span>&#160; </div>
<div class="line"><a name="l09069"></a><span class="lineno"> 9069</span>&#160;              <span class="comment">/*--- Compute the Roe flux vector, which is 0.5*(FL + FR - |A|(UR-UL)). ---*/</span></div>
<div class="line"><a name="l09070"></a><span class="lineno"> 9070</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnL = vxL*nx + vyL*ny + vzL*nz;</div>
<div class="line"><a name="l09071"></a><span class="lineno"> 9071</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnR = vxR*nx + vyR*ny + vzR*nz;</div>
<div class="line"><a name="l09072"></a><span class="lineno"> 9072</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> unL = vnL - gridVelNorm;</div>
<div class="line"><a name="l09073"></a><span class="lineno"> 9073</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> unR = vnR - gridVelNorm;</div>
<div class="line"><a name="l09074"></a><span class="lineno"> 9074</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pa  = pL + pR;</div>
<div class="line"><a name="l09075"></a><span class="lineno"> 9075</span>&#160; </div>
<div class="line"><a name="l09076"></a><span class="lineno"> 9076</span>&#160;              flux[0] = halfArea*(UL[0]*unL + UR[0]*unR - (lam3*dr + abv6));</div>
<div class="line"><a name="l09077"></a><span class="lineno"> 9077</span>&#160;              flux[1] = halfArea*(UL[1]*unL + UR[1]*unR + pa*nx</div>
<div class="line"><a name="l09078"></a><span class="lineno"> 9078</span>&#160;                      -           (lam3*dru + uAvg*abv6 + nx*abv7));</div>
<div class="line"><a name="l09079"></a><span class="lineno"> 9079</span>&#160;              flux[2] = halfArea*(UL[2]*unL + UR[2]*unR + pa*ny</div>
<div class="line"><a name="l09080"></a><span class="lineno"> 9080</span>&#160;                      -           (lam3*drv + vAvg*abv6 + ny*abv7));</div>
<div class="line"><a name="l09081"></a><span class="lineno"> 9081</span>&#160;              flux[3] = halfArea*(UL[3]*unL + UR[3]*unR + pa*nz</div>
<div class="line"><a name="l09082"></a><span class="lineno"> 9082</span>&#160;                      -           (lam3*drw + wAvg*abv6 + nz*abv7));</div>
<div class="line"><a name="l09083"></a><span class="lineno"> 9083</span>&#160;              flux[4] = halfArea*(UL[4]*unL + UR[4]*unR + pL*vnL + pR*vnR</div>
<div class="line"><a name="l09084"></a><span class="lineno"> 9084</span>&#160;                      -           (lam3*drE + HAvg*abv6 + vnAvg*abv7));</div>
<div class="line"><a name="l09085"></a><span class="lineno"> 9085</span>&#160;            }</div>
<div class="line"><a name="l09086"></a><span class="lineno"> 9086</span>&#160;          }</div>
<div class="line"><a name="l09087"></a><span class="lineno"> 9087</span>&#160; </div>
<div class="line"><a name="l09088"></a><span class="lineno"> 9088</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09089"></a><span class="lineno"> 9089</span>&#160;        }</div>
<div class="line"><a name="l09090"></a><span class="lineno"> 9090</span>&#160;      }</div>
<div class="line"><a name="l09091"></a><span class="lineno"> 9091</span>&#160; </div>
<div class="line"><a name="l09092"></a><span class="lineno"> 9092</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09093"></a><span class="lineno"> 9093</span>&#160;    }</div>
<div class="line"><a name="l09094"></a><span class="lineno"> 9094</span>&#160; </div>
<div class="line"><a name="l09095"></a><span class="lineno"> 9095</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l09096"></a><span class="lineno"> 9096</span>&#160; </div>
<div class="line"><a name="l09097"></a><span class="lineno"> 9097</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a0e6f6eb4c523780ba375ff4b5ecb906aa531fbaba650723322b74397cd70021c1">LAX_FRIEDRICH</a>: {</div>
<div class="line"><a name="l09098"></a><span class="lineno"> 9098</span>&#160; </div>
<div class="line"><a name="l09099"></a><span class="lineno"> 9099</span>&#160;      <span class="comment">/* Local Lax-Friedrich (Rusanov) flux Make a distinction between two and</span></div>
<div class="line"><a name="l09100"></a><span class="lineno"> 9100</span>&#160;<span class="comment">         three space dimensions in order to have the most efficient code. */</span></div>
<div class="line"><a name="l09101"></a><span class="lineno"> 9101</span>&#160;      <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l09102"></a><span class="lineno"> 9102</span>&#160; </div>
<div class="line"><a name="l09103"></a><span class="lineno"> 9103</span>&#160;        <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l09104"></a><span class="lineno"> 9104</span>&#160; </div>
<div class="line"><a name="l09105"></a><span class="lineno"> 9105</span>&#160;          <span class="comment">/* Two dimensional simulation. Loop over the number of faces treated</span></div>
<div class="line"><a name="l09106"></a><span class="lineno"> 9106</span>&#160;<span class="comment">             simultaneously. */</span></div>
<div class="line"><a name="l09107"></a><span class="lineno"> 9107</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l09108"></a><span class="lineno"> 9108</span>&#160; </div>
<div class="line"><a name="l09109"></a><span class="lineno"> 9109</span>&#160;            <span class="comment">/* Easier storage for some variables of this face. */</span></div>
<div class="line"><a name="l09110"></a><span class="lineno"> 9110</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals   = normalsFace[l];</div>
<div class="line"><a name="l09111"></a><span class="lineno"> 9111</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVels  = gridVelsFace[l];</div>
<div class="line"><a name="l09112"></a><span class="lineno"> 9112</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> lNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l09113"></a><span class="lineno"> 9113</span>&#160; </div>
<div class="line"><a name="l09114"></a><span class="lineno"> 9114</span>&#160;            <span class="comment">/* Loop over the number of points for this face. */</span></div>
<div class="line"><a name="l09115"></a><span class="lineno"> 9115</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;nPoints; ++i) {</div>
<div class="line"><a name="l09116"></a><span class="lineno"> 9116</span>&#160; </div>
<div class="line"><a name="l09117"></a><span class="lineno"> 9117</span>&#160;              <span class="comment">/* Easier storage of the left and right solution, the face normals,</span></div>
<div class="line"><a name="l09118"></a><span class="lineno"> 9118</span>&#160;<span class="comment">                 the grid velocities and the flux vector for this point. */</span></div>
<div class="line"><a name="l09119"></a><span class="lineno"> 9119</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offPointer = i*NPad + lNVar;</div>
<div class="line"><a name="l09120"></a><span class="lineno"> 9120</span>&#160; </div>
<div class="line"><a name="l09121"></a><span class="lineno"> 9121</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solL + offPointer;</div>
<div class="line"><a name="l09122"></a><span class="lineno"> 9122</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solR + offPointer;</div>
<div class="line"><a name="l09123"></a><span class="lineno"> 9123</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *norm    = normals + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l09124"></a><span class="lineno"> 9124</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = gridVels + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l09125"></a><span class="lineno"> 9125</span>&#160;                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux    = fluxes + offPointer;</div>
<div class="line"><a name="l09126"></a><span class="lineno"> 9126</span>&#160; </div>
<div class="line"><a name="l09127"></a><span class="lineno"> 9127</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nx = norm[0], ny = norm[1], halfArea = 0.5*norm[2];</div>
<div class="line"><a name="l09128"></a><span class="lineno"> 9128</span>&#160; </div>
<div class="line"><a name="l09129"></a><span class="lineno"> 9129</span>&#160;              <span class="comment">/* Compute the normal grid velocity. */</span></div>
<div class="line"><a name="l09130"></a><span class="lineno"> 9130</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> gridVelNorm = gridVel[0]*nx + gridVel[1]*ny;</div>
<div class="line"><a name="l09131"></a><span class="lineno"> 9131</span>&#160; </div>
<div class="line"><a name="l09132"></a><span class="lineno"> 9132</span>&#160;              <span class="comment">/*--- Compute the primitive variables of the left and right state. ---*/</span></div>
<div class="line"><a name="l09133"></a><span class="lineno"> 9133</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tmp       = 1.0/UL[0];</div>
<div class="line"><a name="l09134"></a><span class="lineno"> 9134</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vxL = tmp*UL[1];</div>
<div class="line"><a name="l09135"></a><span class="lineno"> 9135</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vyL = tmp*UL[2];</div>
<div class="line"><a name="l09136"></a><span class="lineno"> 9136</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pL  = gm1*(UL[3] - 0.5*(vxL*UL[1] + vyL*UL[2]));</div>
<div class="line"><a name="l09137"></a><span class="lineno"> 9137</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> a2L = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*pL*tmp;</div>
<div class="line"><a name="l09138"></a><span class="lineno"> 9138</span>&#160; </div>
<div class="line"><a name="l09139"></a><span class="lineno"> 9139</span>&#160;              tmp                 = 1.0/UR[0];</div>
<div class="line"><a name="l09140"></a><span class="lineno"> 9140</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vxR = tmp*UR[1];</div>
<div class="line"><a name="l09141"></a><span class="lineno"> 9141</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vyR = tmp*UR[2];</div>
<div class="line"><a name="l09142"></a><span class="lineno"> 9142</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pR  = gm1*(UR[3] - 0.5*(vxR*UR[1] + vyR*UR[2]));</div>
<div class="line"><a name="l09143"></a><span class="lineno"> 9143</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> a2R = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*pR*tmp;</div>
<div class="line"><a name="l09144"></a><span class="lineno"> 9144</span>&#160; </div>
<div class="line"><a name="l09145"></a><span class="lineno"> 9145</span>&#160;              <span class="comment">/*--- Compute the difference of the conservative mean flow variables. ---*/</span></div>
<div class="line"><a name="l09146"></a><span class="lineno"> 9146</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dr  = UR[0] - UL[0];</div>
<div class="line"><a name="l09147"></a><span class="lineno"> 9147</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dru = UR[1] - UL[1];</div>
<div class="line"><a name="l09148"></a><span class="lineno"> 9148</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drv = UR[2] - UL[2];</div>
<div class="line"><a name="l09149"></a><span class="lineno"> 9149</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drE = UR[3] - UL[3];</div>
<div class="line"><a name="l09150"></a><span class="lineno"> 9150</span>&#160; </div>
<div class="line"><a name="l09151"></a><span class="lineno"> 9151</span>&#160;              <span class="comment">/*--- Compute the spectral radii of the left and right state</span></div>
<div class="line"><a name="l09152"></a><span class="lineno"> 9152</span>&#160;<span class="comment">                    and take the maximum for the dissipation terms. ---*/</span></div>
<div class="line"><a name="l09153"></a><span class="lineno"> 9153</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnL = vxL*nx + vyL*ny;</div>
<div class="line"><a name="l09154"></a><span class="lineno"> 9154</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnR = vxR*nx + vyR*ny;</div>
<div class="line"><a name="l09155"></a><span class="lineno"> 9155</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> unL = vnL - gridVelNorm;</div>
<div class="line"><a name="l09156"></a><span class="lineno"> 9156</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> unR = vnR - gridVelNorm;</div>
<div class="line"><a name="l09157"></a><span class="lineno"> 9157</span>&#160; </div>
<div class="line"><a name="l09158"></a><span class="lineno"> 9158</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radL = fabs(unL) + sqrt(fabs(a2L));</div>
<div class="line"><a name="l09159"></a><span class="lineno"> 9159</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radR = fabs(unR) + sqrt(fabs(a2R));</div>
<div class="line"><a name="l09160"></a><span class="lineno"> 9160</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rad  = max(radL, radR);</div>
<div class="line"><a name="l09161"></a><span class="lineno"> 9161</span>&#160; </div>
<div class="line"><a name="l09162"></a><span class="lineno"> 9162</span>&#160;              <span class="comment">/*--- Compute the flux vector, which is 0.5*(FL + FR - rad(UR-UL)). ---*/</span></div>
<div class="line"><a name="l09163"></a><span class="lineno"> 9163</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pa = pL + pR;</div>
<div class="line"><a name="l09164"></a><span class="lineno"> 9164</span>&#160; </div>
<div class="line"><a name="l09165"></a><span class="lineno"> 9165</span>&#160;              flux[0] = halfArea*(UL[0]*unL + UR[0]*unR - rad*dr);</div>
<div class="line"><a name="l09166"></a><span class="lineno"> 9166</span>&#160;              flux[1] = halfArea*(UL[1]*unL + UR[1]*unR + pa*nx - rad*dru);</div>
<div class="line"><a name="l09167"></a><span class="lineno"> 9167</span>&#160;              flux[2] = halfArea*(UL[2]*unL + UR[2]*unR + pa*ny - rad*drv);</div>
<div class="line"><a name="l09168"></a><span class="lineno"> 9168</span>&#160;              flux[3] = halfArea*(UL[3]*unL + UR[3]*unR + pL*vnL + pR*vnR - rad*drE);</div>
<div class="line"><a name="l09169"></a><span class="lineno"> 9169</span>&#160;            }</div>
<div class="line"><a name="l09170"></a><span class="lineno"> 9170</span>&#160;          }</div>
<div class="line"><a name="l09171"></a><span class="lineno"> 9171</span>&#160; </div>
<div class="line"><a name="l09172"></a><span class="lineno"> 9172</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09173"></a><span class="lineno"> 9173</span>&#160;        }</div>
<div class="line"><a name="l09174"></a><span class="lineno"> 9174</span>&#160; </div>
<div class="line"><a name="l09175"></a><span class="lineno"> 9175</span>&#160;        <span class="comment">/*--------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l09176"></a><span class="lineno"> 9176</span>&#160; </div>
<div class="line"><a name="l09177"></a><span class="lineno"> 9177</span>&#160;        <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l09178"></a><span class="lineno"> 9178</span>&#160; </div>
<div class="line"><a name="l09179"></a><span class="lineno"> 9179</span>&#160;          <span class="comment">/* Three dimensional simulation. Loop over the number of faces treated</span></div>
<div class="line"><a name="l09180"></a><span class="lineno"> 9180</span>&#160;<span class="comment">             simultaneously. */</span></div>
<div class="line"><a name="l09181"></a><span class="lineno"> 9181</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l09182"></a><span class="lineno"> 9182</span>&#160; </div>
<div class="line"><a name="l09183"></a><span class="lineno"> 9183</span>&#160;            <span class="comment">/* Easier storage for some variables of this face. */</span></div>
<div class="line"><a name="l09184"></a><span class="lineno"> 9184</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals   = normalsFace[l];</div>
<div class="line"><a name="l09185"></a><span class="lineno"> 9185</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVels  = gridVelsFace[l];</div>
<div class="line"><a name="l09186"></a><span class="lineno"> 9186</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> lNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l09187"></a><span class="lineno"> 9187</span>&#160; </div>
<div class="line"><a name="l09188"></a><span class="lineno"> 9188</span>&#160;            <span class="comment">/* Loop over the number of points for this face. */</span></div>
<div class="line"><a name="l09189"></a><span class="lineno"> 9189</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;nPoints; ++i) {</div>
<div class="line"><a name="l09190"></a><span class="lineno"> 9190</span>&#160; </div>
<div class="line"><a name="l09191"></a><span class="lineno"> 9191</span>&#160;              <span class="comment">/* Easier storage of the left and right solution, the face normals,</span></div>
<div class="line"><a name="l09192"></a><span class="lineno"> 9192</span>&#160;<span class="comment">                 the grid velocities and the flux vector for this point. */</span></div>
<div class="line"><a name="l09193"></a><span class="lineno"> 9193</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offPointer = i*NPad + lNVar;</div>
<div class="line"><a name="l09194"></a><span class="lineno"> 9194</span>&#160; </div>
<div class="line"><a name="l09195"></a><span class="lineno"> 9195</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solL + offPointer;</div>
<div class="line"><a name="l09196"></a><span class="lineno"> 9196</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solR + offPointer;</div>
<div class="line"><a name="l09197"></a><span class="lineno"> 9197</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *norm    = normals + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l09198"></a><span class="lineno"> 9198</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = gridVels + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l09199"></a><span class="lineno"> 9199</span>&#160;                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux    = fluxes + offPointer;</div>
<div class="line"><a name="l09200"></a><span class="lineno"> 9200</span>&#160; </div>
<div class="line"><a name="l09201"></a><span class="lineno"> 9201</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nx = norm[0], ny = norm[1], nz = norm[2];</div>
<div class="line"><a name="l09202"></a><span class="lineno"> 9202</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> halfArea = 0.5*norm[3];</div>
<div class="line"><a name="l09203"></a><span class="lineno"> 9203</span>&#160; </div>
<div class="line"><a name="l09204"></a><span class="lineno"> 9204</span>&#160;              <span class="comment">/* Compute the normal grid velocity. */</span></div>
<div class="line"><a name="l09205"></a><span class="lineno"> 9205</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> gridVelNorm = gridVel[0]*nx + gridVel[1]*ny + gridVel[2]*nz;</div>
<div class="line"><a name="l09206"></a><span class="lineno"> 9206</span>&#160; </div>
<div class="line"><a name="l09207"></a><span class="lineno"> 9207</span>&#160;              <span class="comment">/*--- Compute the primitive variables of the left and right state. ---*/</span></div>
<div class="line"><a name="l09208"></a><span class="lineno"> 9208</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tmp       = 1.0/UL[0];</div>
<div class="line"><a name="l09209"></a><span class="lineno"> 9209</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vxL = tmp*UL[1];</div>
<div class="line"><a name="l09210"></a><span class="lineno"> 9210</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vyL = tmp*UL[2];</div>
<div class="line"><a name="l09211"></a><span class="lineno"> 9211</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vzL = tmp*UL[3];</div>
<div class="line"><a name="l09212"></a><span class="lineno"> 9212</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pL  = gm1*(UL[4] - 0.5*(vxL*UL[1] + vyL*UL[2] + vzL*UL[3]));</div>
<div class="line"><a name="l09213"></a><span class="lineno"> 9213</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> a2L = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*pL*tmp;</div>
<div class="line"><a name="l09214"></a><span class="lineno"> 9214</span>&#160; </div>
<div class="line"><a name="l09215"></a><span class="lineno"> 9215</span>&#160;              tmp                 = 1.0/UR[0];</div>
<div class="line"><a name="l09216"></a><span class="lineno"> 9216</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vxR = tmp*UR[1];</div>
<div class="line"><a name="l09217"></a><span class="lineno"> 9217</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vyR = tmp*UR[2];</div>
<div class="line"><a name="l09218"></a><span class="lineno"> 9218</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vzR = tmp*UR[3];</div>
<div class="line"><a name="l09219"></a><span class="lineno"> 9219</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pR  = gm1*(UR[4] - 0.5*(vxR*UR[1] + vyR*UR[2] + vzR*UR[3]));</div>
<div class="line"><a name="l09220"></a><span class="lineno"> 9220</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> a2R = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*pR*tmp;</div>
<div class="line"><a name="l09221"></a><span class="lineno"> 9221</span>&#160; </div>
<div class="line"><a name="l09222"></a><span class="lineno"> 9222</span>&#160;              <span class="comment">/*--- Compute the difference of the conservative mean flow variables. ---*/</span></div>
<div class="line"><a name="l09223"></a><span class="lineno"> 9223</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dr  = UR[0] - UL[0];</div>
<div class="line"><a name="l09224"></a><span class="lineno"> 9224</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dru = UR[1] - UL[1];</div>
<div class="line"><a name="l09225"></a><span class="lineno"> 9225</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drv = UR[2] - UL[2];</div>
<div class="line"><a name="l09226"></a><span class="lineno"> 9226</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drw = UR[3] - UL[3];</div>
<div class="line"><a name="l09227"></a><span class="lineno"> 9227</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drE = UR[4] - UL[4];</div>
<div class="line"><a name="l09228"></a><span class="lineno"> 9228</span>&#160; </div>
<div class="line"><a name="l09229"></a><span class="lineno"> 9229</span>&#160;              <span class="comment">/*--- Compute the spectral radii of the left and right state</span></div>
<div class="line"><a name="l09230"></a><span class="lineno"> 9230</span>&#160;<span class="comment">                    and take the maximum for the dissipation terms. ---*/</span></div>
<div class="line"><a name="l09231"></a><span class="lineno"> 9231</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnL = vxL*nx + vyL*ny + vzL*nz;</div>
<div class="line"><a name="l09232"></a><span class="lineno"> 9232</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vnR = vxR*nx + vyR*ny + vzR*nz;</div>
<div class="line"><a name="l09233"></a><span class="lineno"> 9233</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> unL = vnL - gridVelNorm;</div>
<div class="line"><a name="l09234"></a><span class="lineno"> 9234</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> unR = vnR - gridVelNorm;</div>
<div class="line"><a name="l09235"></a><span class="lineno"> 9235</span>&#160; </div>
<div class="line"><a name="l09236"></a><span class="lineno"> 9236</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radL = fabs(unL) + sqrt(fabs(a2L));</div>
<div class="line"><a name="l09237"></a><span class="lineno"> 9237</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radR = fabs(unR) + sqrt(fabs(a2R));</div>
<div class="line"><a name="l09238"></a><span class="lineno"> 9238</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rad  = max(radL, radR);</div>
<div class="line"><a name="l09239"></a><span class="lineno"> 9239</span>&#160; </div>
<div class="line"><a name="l09240"></a><span class="lineno"> 9240</span>&#160;              <span class="comment">/*--- Compute the flux vector, which is 0.5*(FL + FR - rad(UR-UL)). ---*/</span></div>
<div class="line"><a name="l09241"></a><span class="lineno"> 9241</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pa = pL + pR;</div>
<div class="line"><a name="l09242"></a><span class="lineno"> 9242</span>&#160; </div>
<div class="line"><a name="l09243"></a><span class="lineno"> 9243</span>&#160;              flux[0] = halfArea*(UL[0]*unL + UR[0]*unR - rad*dr);</div>
<div class="line"><a name="l09244"></a><span class="lineno"> 9244</span>&#160;              flux[1] = halfArea*(UL[1]*unL + UR[1]*unR + pa*nx - rad*dru);</div>
<div class="line"><a name="l09245"></a><span class="lineno"> 9245</span>&#160;              flux[2] = halfArea*(UL[2]*unL + UR[2]*unR + pa*ny - rad*drv);</div>
<div class="line"><a name="l09246"></a><span class="lineno"> 9246</span>&#160;              flux[3] = halfArea*(UL[3]*unL + UR[3]*unR + pa*nz - rad*drw);</div>
<div class="line"><a name="l09247"></a><span class="lineno"> 9247</span>&#160;              flux[4] = halfArea*(UL[4]*unL + UR[4]*unR + pL*vnL + pR*vnR - rad*drE);</div>
<div class="line"><a name="l09248"></a><span class="lineno"> 9248</span>&#160;            }</div>
<div class="line"><a name="l09249"></a><span class="lineno"> 9249</span>&#160;          }</div>
<div class="line"><a name="l09250"></a><span class="lineno"> 9250</span>&#160; </div>
<div class="line"><a name="l09251"></a><span class="lineno"> 9251</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09252"></a><span class="lineno"> 9252</span>&#160;        }</div>
<div class="line"><a name="l09253"></a><span class="lineno"> 9253</span>&#160;      }</div>
<div class="line"><a name="l09254"></a><span class="lineno"> 9254</span>&#160; </div>
<div class="line"><a name="l09255"></a><span class="lineno"> 9255</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09256"></a><span class="lineno"> 9256</span>&#160;    }</div>
<div class="line"><a name="l09257"></a><span class="lineno"> 9257</span>&#160; </div>
<div class="line"><a name="l09258"></a><span class="lineno"> 9258</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l09259"></a><span class="lineno"> 9259</span>&#160; </div>
<div class="line"><a name="l09260"></a><span class="lineno"> 9260</span>&#160;    <span class="keywordflow">default</span>: {</div>
<div class="line"><a name="l09261"></a><span class="lineno"> 9261</span>&#160; </div>
<div class="line"><a name="l09262"></a><span class="lineno"> 9262</span>&#160;      <span class="comment">/* Riemann solver not explicitly implemented. Fall back to the</span></div>
<div class="line"><a name="l09263"></a><span class="lineno"> 9263</span>&#160;<span class="comment">         implementation via numerics. This is not efficient. */</span></div>
<div class="line"><a name="l09264"></a><span class="lineno"> 9264</span>&#160; </div>
<div class="line"><a name="l09265"></a><span class="lineno"> 9265</span>&#160;      <span class="comment">/*--- Data for loading into the CNumerics Riemann solvers.</span></div>
<div class="line"><a name="l09266"></a><span class="lineno"> 9266</span>&#160;<span class="comment">       This is temporary and not efficient.. just replicating exactly</span></div>
<div class="line"><a name="l09267"></a><span class="lineno"> 9267</span>&#160;<span class="comment">       the arrays we typically have in order to avoid bugs. We can</span></div>
<div class="line"><a name="l09268"></a><span class="lineno"> 9268</span>&#160;<span class="comment">       probably be more clever with pointers, etc. ---*/</span></div>
<div class="line"><a name="l09269"></a><span class="lineno"> 9269</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Normal[3];</div>
<div class="line"><a name="l09270"></a><span class="lineno"> 9270</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Prim_L[8];</div>
<div class="line"><a name="l09271"></a><span class="lineno"> 9271</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Prim_R[8];</div>
<div class="line"><a name="l09272"></a><span class="lineno"> 9272</span>&#160; </div>
<div class="line"><a name="l09273"></a><span class="lineno"> 9273</span>&#160;      <a class="code" href="class_c_solver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a> = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>*[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l09274"></a><span class="lineno"> 9274</span>&#160;      <a class="code" href="class_c_solver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a> = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>*[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l09275"></a><span class="lineno"> 9275</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar = 0; iVar &lt; <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++iVar) {</div>
<div class="line"><a name="l09276"></a><span class="lineno"> 9276</span>&#160;        <a class="code" href="class_c_solver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a>[iVar] = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l09277"></a><span class="lineno"> 9277</span>&#160;        <a class="code" href="class_c_solver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[iVar] = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>];</div>
<div class="line"><a name="l09278"></a><span class="lineno"> 9278</span>&#160;      }</div>
<div class="line"><a name="l09279"></a><span class="lineno"> 9279</span>&#160; </div>
<div class="line"><a name="l09280"></a><span class="lineno"> 9280</span>&#160;      <span class="comment">/* Loop over the number of faces treated simultaneously. */</span></div>
<div class="line"><a name="l09281"></a><span class="lineno"> 9281</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l09282"></a><span class="lineno"> 9282</span>&#160; </div>
<div class="line"><a name="l09283"></a><span class="lineno"> 9283</span>&#160;        <span class="comment">/* Easier storage for some variables of this face. */</span></div>
<div class="line"><a name="l09284"></a><span class="lineno"> 9284</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals   = normalsFace[l];</div>
<div class="line"><a name="l09285"></a><span class="lineno"> 9285</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVels  = gridVelsFace[l];</div>
<div class="line"><a name="l09286"></a><span class="lineno"> 9286</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> lNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l09287"></a><span class="lineno"> 9287</span>&#160; </div>
<div class="line"><a name="l09288"></a><span class="lineno"> 9288</span>&#160;        <span class="comment">/* Loop over the number of points for this face. */</span></div>
<div class="line"><a name="l09289"></a><span class="lineno"> 9289</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;nPoints; ++i) {</div>
<div class="line"><a name="l09290"></a><span class="lineno"> 9290</span>&#160; </div>
<div class="line"><a name="l09291"></a><span class="lineno"> 9291</span>&#160;          <span class="comment">/* Easier storage of the left and right solution, the face normals,</span></div>
<div class="line"><a name="l09292"></a><span class="lineno"> 9292</span>&#160;<span class="comment">             the grid velocities and the flux vector for this point. */</span></div>
<div class="line"><a name="l09293"></a><span class="lineno"> 9293</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offPointer = i*NPad + lNVar;</div>
<div class="line"><a name="l09294"></a><span class="lineno"> 9294</span>&#160; </div>
<div class="line"><a name="l09295"></a><span class="lineno"> 9295</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solL + offPointer;</div>
<div class="line"><a name="l09296"></a><span class="lineno"> 9296</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solR + offPointer;</div>
<div class="line"><a name="l09297"></a><span class="lineno"> 9297</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *norm    = normals + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l09298"></a><span class="lineno"> 9298</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = gridVels + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l09299"></a><span class="lineno"> 9299</span>&#160;                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux    = fluxes + offPointer;</div>
<div class="line"><a name="l09300"></a><span class="lineno"> 9300</span>&#160; </div>
<div class="line"><a name="l09301"></a><span class="lineno"> 9301</span>&#160;          <span class="comment">/*--- Store and load the normal into numerics. ---*/</span></div>
<div class="line"><a name="l09302"></a><span class="lineno"> 9302</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim = 0; iDim &lt; <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l09303"></a><span class="lineno"> 9303</span>&#160;            Normal[iDim] = norm[iDim]*norm[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l09304"></a><span class="lineno"> 9304</span>&#160;          numerics-&gt;<a class="code" href="class_c_numerics.html#a41903d97957f351cd9ee63ca404985b1">SetNormal</a>(Normal);</div>
<div class="line"><a name="l09305"></a><span class="lineno"> 9305</span>&#160; </div>
<div class="line"><a name="l09306"></a><span class="lineno"> 9306</span>&#160;          <span class="comment">/*--- Load the grid velocities into numerics. ---*/</span></div>
<div class="line"><a name="l09307"></a><span class="lineno"> 9307</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vGrid[] = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l09308"></a><span class="lineno"> 9308</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l09309"></a><span class="lineno"> 9309</span>&#160;            vGrid[iDim] = gridVel[iDim];</div>
<div class="line"><a name="l09310"></a><span class="lineno"> 9310</span>&#160;          numerics-&gt;<a class="code" href="class_c_numerics.html#ae15b9e4ad2008444365109c434e24207">SetGridVel</a>(vGrid, vGrid);</div>
<div class="line"><a name="l09311"></a><span class="lineno"> 9311</span>&#160; </div>
<div class="line"><a name="l09312"></a><span class="lineno"> 9312</span>&#160;          <span class="comment">/*--- Prepare the primitive states for the numerics class. Note</span></div>
<div class="line"><a name="l09313"></a><span class="lineno"> 9313</span>&#160;<span class="comment">           that for the FV solver, we have the following primitive</span></div>
<div class="line"><a name="l09314"></a><span class="lineno"> 9314</span>&#160;<span class="comment">           variable ordering: Compressible flow, primitive variables nDim+5,</span></div>
<div class="line"><a name="l09315"></a><span class="lineno"> 9315</span>&#160;<span class="comment">           (T, vx, vy, vz, P, rho, h, c, lamMu, eddyMu, ThCond, Cp) ---*/</span></div>
<div class="line"><a name="l09316"></a><span class="lineno"> 9316</span>&#160; </div>
<div class="line"><a name="l09317"></a><span class="lineno"> 9317</span>&#160;          <span class="comment">/*--- Left primitive state ---*/</span></div>
<div class="line"><a name="l09318"></a><span class="lineno"> 9318</span>&#160;          Prim_L[0] = 0.0;                                        <span class="comment">// Temperature (unused)</span></div>
<div class="line"><a name="l09319"></a><span class="lineno"> 9319</span>&#160;          Prim_L[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = gm1*UL[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1];</div>
<div class="line"><a name="l09320"></a><span class="lineno"> 9320</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim = 0; iDim &lt; <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l09321"></a><span class="lineno"> 9321</span>&#160;            Prim_L[iDim+1]  = UL[iDim+1]/UL[0];                   <span class="comment">// Velocities</span></div>
<div class="line"><a name="l09322"></a><span class="lineno"> 9322</span>&#160;            Prim_L[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] -= gm1*0.5*Prim_L[iDim+1]*UL[iDim+1];  <span class="comment">// Pressure</span></div>
<div class="line"><a name="l09323"></a><span class="lineno"> 9323</span>&#160;          }</div>
<div class="line"><a name="l09324"></a><span class="lineno"> 9324</span>&#160;          Prim_L[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+2] = UL[0];                                 <span class="comment">// Density</span></div>
<div class="line"><a name="l09325"></a><span class="lineno"> 9325</span>&#160;          Prim_L[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+3] = (UL[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] + Prim_L[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]) / UL[0]; <span class="comment">// Enthalpy</span></div>
<div class="line"><a name="l09326"></a><span class="lineno"> 9326</span>&#160; </div>
<div class="line"><a name="l09327"></a><span class="lineno"> 9327</span>&#160;          <span class="comment">/*--- Right primitive state ---*/</span></div>
<div class="line"><a name="l09328"></a><span class="lineno"> 9328</span>&#160;          Prim_R[0] = 0.0;                                        <span class="comment">// Temperature (unused)</span></div>
<div class="line"><a name="l09329"></a><span class="lineno"> 9329</span>&#160;          Prim_R[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = gm1*UR[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1];</div>
<div class="line"><a name="l09330"></a><span class="lineno"> 9330</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim = 0; iDim &lt; <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; iDim++) {</div>
<div class="line"><a name="l09331"></a><span class="lineno"> 9331</span>&#160;            Prim_R[iDim+1]  = UR[iDim+1]/UR[0];                   <span class="comment">// Velocities</span></div>
<div class="line"><a name="l09332"></a><span class="lineno"> 9332</span>&#160;            Prim_R[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] -= gm1*0.5*Prim_R[iDim+1]*UR[iDim+1];  <span class="comment">// Pressure</span></div>
<div class="line"><a name="l09333"></a><span class="lineno"> 9333</span>&#160;          }</div>
<div class="line"><a name="l09334"></a><span class="lineno"> 9334</span>&#160;          Prim_R[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+2] = UR[0];                                 <span class="comment">// Density</span></div>
<div class="line"><a name="l09335"></a><span class="lineno"> 9335</span>&#160;          Prim_R[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+3] = (UR[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] + Prim_R[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]) / UR[0]; <span class="comment">// Enthalpy</span></div>
<div class="line"><a name="l09336"></a><span class="lineno"> 9336</span>&#160; </div>
<div class="line"><a name="l09337"></a><span class="lineno"> 9337</span>&#160;          <span class="comment">/*--- Load the primitive states into the numerics class. ---*/</span></div>
<div class="line"><a name="l09338"></a><span class="lineno"> 9338</span>&#160;          numerics-&gt;<a class="code" href="class_c_numerics.html#af72b17d397adf09beed2e99e2daf895c">SetPrimitive</a>(Prim_L, Prim_R);</div>
<div class="line"><a name="l09339"></a><span class="lineno"> 9339</span>&#160; </div>
<div class="line"><a name="l09340"></a><span class="lineno"> 9340</span>&#160;          <span class="comment">/*--- Now simply call the ComputeResidual() function to calculate</span></div>
<div class="line"><a name="l09341"></a><span class="lineno"> 9341</span>&#160;<span class="comment">           the flux using the chosen approximate Riemann solver. Note that</span></div>
<div class="line"><a name="l09342"></a><span class="lineno"> 9342</span>&#160;<span class="comment">           the Jacobian arrays here are just dummies for now (no implicit). ---*/</span></div>
<div class="line"><a name="l09343"></a><span class="lineno"> 9343</span>&#160;          numerics-&gt;<a class="code" href="class_c_numerics.html#abe734316e0047f463f059fd77a281958">ComputeResidual</a>(flux, <a class="code" href="class_c_solver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a>, <a class="code" href="class_c_solver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>, config);</div>
<div class="line"><a name="l09344"></a><span class="lineno"> 9344</span>&#160;        }</div>
<div class="line"><a name="l09345"></a><span class="lineno"> 9345</span>&#160;      }</div>
<div class="line"><a name="l09346"></a><span class="lineno"> 9346</span>&#160; </div>
<div class="line"><a name="l09347"></a><span class="lineno"> 9347</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar = 0; iVar &lt; <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) {</div>
<div class="line"><a name="l09348"></a><span class="lineno"> 9348</span>&#160;        <span class="keyword">delete</span> [] <a class="code" href="class_c_solver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a>[iVar];</div>
<div class="line"><a name="l09349"></a><span class="lineno"> 9349</span>&#160;        <span class="keyword">delete</span> [] <a class="code" href="class_c_solver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>[iVar];</div>
<div class="line"><a name="l09350"></a><span class="lineno"> 9350</span>&#160;      }</div>
<div class="line"><a name="l09351"></a><span class="lineno"> 9351</span>&#160;      <span class="keyword">delete</span> [] <a class="code" href="class_c_solver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a>;</div>
<div class="line"><a name="l09352"></a><span class="lineno"> 9352</span>&#160;      <span class="keyword">delete</span> [] <a class="code" href="class_c_solver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a>;</div>
<div class="line"><a name="l09353"></a><span class="lineno"> 9353</span>&#160; </div>
<div class="line"><a name="l09354"></a><span class="lineno"> 9354</span>&#160;      <a class="code" href="class_c_solver.html#a223a1270fee36d9c742e806a47b0ffb3">Jacobian_i</a> = NULL;</div>
<div class="line"><a name="l09355"></a><span class="lineno"> 9355</span>&#160;      <a class="code" href="class_c_solver.html#a11fe70fe56043dd44dd79b7d9aa358f0">Jacobian_j</a> = NULL;</div>
<div class="line"><a name="l09356"></a><span class="lineno"> 9356</span>&#160;    }</div>
<div class="line"><a name="l09357"></a><span class="lineno"> 9357</span>&#160;  }</div>
<div class="line"><a name="l09358"></a><span class="lineno"> 9358</span>&#160;}</div>
<div class="line"><a name="l09359"></a><span class="lineno"> 9359</span>&#160; </div>
<div class="line"><a name="l09360"></a><span class="lineno"> 9360</span>&#160;<span class="preprocessor">#ifdef RINGLEB</span></div>
<div class="line"><a name="l09361"></a><span class="lineno"> 9361</span>&#160; </div>
<div class="line"><a name="l09362"></a><span class="lineno"> 9362</span>&#160;<span class="keywordtype">void</span> CFEM_DG_EulerSolver::RinglebSolution(<span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor,</div>
<div class="line"><a name="l09363"></a><span class="lineno"> 9363</span>&#160;                                                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol) {</div>
<div class="line"><a name="l09364"></a><span class="lineno"> 9364</span>&#160; </div>
<div class="line"><a name="l09365"></a><span class="lineno"> 9365</span>&#160;  <span class="comment">/* Compute several expononts involving Gamma. */</span></div>
<div class="line"><a name="l09366"></a><span class="lineno"> 9366</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> gm1     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>;</div>
<div class="line"><a name="l09367"></a><span class="lineno"> 9367</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tovgm1  = 2.0/gm1;</div>
<div class="line"><a name="l09368"></a><span class="lineno"> 9368</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tgovgm1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*tovgm1;</div>
<div class="line"><a name="l09369"></a><span class="lineno"> 9369</span>&#160; </div>
<div class="line"><a name="l09370"></a><span class="lineno"> 9370</span>&#160;  <span class="comment">/* Easier storage of the coordinates and abbreviate y*y. */</span></div>
<div class="line"><a name="l09371"></a><span class="lineno"> 9371</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> x  = coor[0], y = coor[1];</div>
<div class="line"><a name="l09372"></a><span class="lineno"> 9372</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> y2 = y*y;</div>
<div class="line"><a name="l09373"></a><span class="lineno"> 9373</span>&#160; </div>
<div class="line"><a name="l09374"></a><span class="lineno"> 9374</span>&#160;  <span class="comment">/* Initial guess for q (velocity magnitude) and k (streamline parameter). */</span></div>
<div class="line"><a name="l09375"></a><span class="lineno"> 9375</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> k = 1.2;</div>
<div class="line"><a name="l09376"></a><span class="lineno"> 9376</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> q = 1.0;</div>
<div class="line"><a name="l09377"></a><span class="lineno"> 9377</span>&#160; </div>
<div class="line"><a name="l09378"></a><span class="lineno"> 9378</span>&#160;  <span class="comment">/* Newton algorithm to solve for the variables q and k for the given x and y. */</span></div>
<div class="line"><a name="l09379"></a><span class="lineno"> 9379</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> iterMax = 500;</div>
<div class="line"><a name="l09380"></a><span class="lineno"> 9380</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> duMaxPrev = 10.0;</div>
<div class="line"><a name="l09381"></a><span class="lineno"> 9381</span>&#160; </div>
<div class="line"><a name="l09382"></a><span class="lineno"> 9382</span>&#160;  <span class="keywordtype">int</span> iter;</div>
<div class="line"><a name="l09383"></a><span class="lineno"> 9383</span>&#160;  <span class="keywordflow">for</span>(iter=0; iter&lt;iterMax; ++iter) {</div>
<div class="line"><a name="l09384"></a><span class="lineno"> 9384</span>&#160; </div>
<div class="line"><a name="l09385"></a><span class="lineno"> 9385</span>&#160;    <span class="comment">/* Compute the speed of sound, the density, the parameter JJ</span></div>
<div class="line"><a name="l09386"></a><span class="lineno"> 9386</span>&#160;<span class="comment">       and its derivatives w.r.t. q. */</span></div>
<div class="line"><a name="l09387"></a><span class="lineno"> 9387</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> a   = sqrt(1.0 - 0.5*gm1*q*q);</div>
<div class="line"><a name="l09388"></a><span class="lineno"> 9388</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rho = pow(a,tovgm1);</div>
<div class="line"><a name="l09389"></a><span class="lineno"> 9389</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> JJ  = 1.0/a + 1.0/(3.0*a*a*a) + 1.0/(5.0*a*a*a*a*a)</div>
<div class="line"><a name="l09390"></a><span class="lineno"> 9390</span>&#160;                        - 0.5*log((1.0+a)/(1.0-a));</div>
<div class="line"><a name="l09391"></a><span class="lineno"> 9391</span>&#160; </div>
<div class="line"><a name="l09392"></a><span class="lineno"> 9392</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dadq   = -0.5*gm1*q/a;</div>
<div class="line"><a name="l09393"></a><span class="lineno"> 9393</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodq =  2.0*rho*dadq/(gm1*a);</div>
<div class="line"><a name="l09394"></a><span class="lineno"> 9394</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dJJdq  =  dadq/(pow(a,6)*(a*a-1.0));</div>
<div class="line"><a name="l09395"></a><span class="lineno"> 9395</span>&#160; </div>
<div class="line"><a name="l09396"></a><span class="lineno"> 9396</span>&#160;    <span class="comment">/* Determine the values of the nonlinear equations to solve</span></div>
<div class="line"><a name="l09397"></a><span class="lineno"> 9397</span>&#160;<span class="comment">       and its corresponding Jacobian matrix. */</span></div>
<div class="line"><a name="l09398"></a><span class="lineno"> 9398</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> y2c = (k*k - q*q)/(k*k*k*k*rho*rho*q*q);</div>
<div class="line"><a name="l09399"></a><span class="lineno"> 9399</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> f[] = {(2.0/(k*k) - 1.0/(q*q))/(2.0*rho) - 0.5*JJ - x,</div>
<div class="line"><a name="l09400"></a><span class="lineno"> 9400</span>&#160;                           y2c - y2};</div>
<div class="line"><a name="l09401"></a><span class="lineno"> 9401</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Jac[2][2];</div>
<div class="line"><a name="l09402"></a><span class="lineno"> 9402</span>&#160;    Jac[0][0] = -(1.0/(k*k) - 0.50/(q*q))*drhodq/(rho*rho)</div>
<div class="line"><a name="l09403"></a><span class="lineno"> 9403</span>&#160;              + 1.0/(rho*q*q*q) - 0.5*dJJdq;</div>
<div class="line"><a name="l09404"></a><span class="lineno"> 9404</span>&#160;    Jac[0][1] = -2.0/(rho*k*k*k);</div>
<div class="line"><a name="l09405"></a><span class="lineno"> 9405</span>&#160;    Jac[1][0] = -2.0/(k*k*rho*rho*q*q*q) - 2.0*y2c*drhodq/rho;</div>
<div class="line"><a name="l09406"></a><span class="lineno"> 9406</span>&#160;    Jac[1][1] = (4.0*q*q - 2.0*k*k)/(k*k*k*k*k*rho*rho*q*q);</div>
<div class="line"><a name="l09407"></a><span class="lineno"> 9407</span>&#160; </div>
<div class="line"><a name="l09408"></a><span class="lineno"> 9408</span>&#160;    <span class="comment">/* Determine the update dU. */</span></div>
<div class="line"><a name="l09409"></a><span class="lineno"> 9409</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> det  = Jac[0][0]*Jac[1][1] - Jac[0][1]*Jac[1][0];</div>
<div class="line"><a name="l09410"></a><span class="lineno"> 9410</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dU[] = {(f[0]*Jac[1][1] - f[1]*Jac[0][1])/det,</div>
<div class="line"><a name="l09411"></a><span class="lineno"> 9411</span>&#160;                            (f[1]*Jac[0][0] - f[0]*Jac[1][0])/det};</div>
<div class="line"><a name="l09412"></a><span class="lineno"> 9412</span>&#160; </div>
<div class="line"><a name="l09413"></a><span class="lineno"> 9413</span>&#160;    <span class="comment">/* Determine the underrelaxation coefficient alp. */</span></div>
<div class="line"><a name="l09414"></a><span class="lineno"> 9414</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dUMax = max(fabs(dU[0]), fabs(dU[1]));</div>
<div class="line"><a name="l09415"></a><span class="lineno"> 9415</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> alp = 1.0;</div>
<div class="line"><a name="l09416"></a><span class="lineno"> 9416</span>&#160;    <span class="keywordflow">if</span>(     dUMax &gt; 1.0) alp = 0.04;</div>
<div class="line"><a name="l09417"></a><span class="lineno"> 9417</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(dUMax &gt; 0.1) alp = 0.2;</div>
<div class="line"><a name="l09418"></a><span class="lineno"> 9418</span>&#160; </div>
<div class="line"><a name="l09419"></a><span class="lineno"> 9419</span>&#160;    <span class="comment">/* Update q and k. */</span></div>
<div class="line"><a name="l09420"></a><span class="lineno"> 9420</span>&#160;    q -= alp*dU[0];</div>
<div class="line"><a name="l09421"></a><span class="lineno"> 9421</span>&#160;    k -= alp*dU[1];</div>
<div class="line"><a name="l09422"></a><span class="lineno"> 9422</span>&#160; </div>
<div class="line"><a name="l09423"></a><span class="lineno"> 9423</span>&#160;    <span class="comment">/* Convergence check, which is independent of the precision used. */</span></div>
<div class="line"><a name="l09424"></a><span class="lineno"> 9424</span>&#160;    <span class="keywordflow">if</span>((dUMax &lt; 1.e-3) &amp;&amp; (dUMax &gt;= duMaxPrev)) <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09425"></a><span class="lineno"> 9425</span>&#160;    duMaxPrev = dUMax;</div>
<div class="line"><a name="l09426"></a><span class="lineno"> 9426</span>&#160;  }</div>
<div class="line"><a name="l09427"></a><span class="lineno"> 9427</span>&#160; </div>
<div class="line"><a name="l09428"></a><span class="lineno"> 9428</span>&#160;  <span class="comment">/* Check if the Newton algorithm actually converged. */</span></div>
<div class="line"><a name="l09429"></a><span class="lineno"> 9429</span>&#160;  <span class="keywordflow">if</span>(iter == iterMax) {</div>
<div class="line"><a name="l09430"></a><span class="lineno"> 9430</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;In function CFEM_DG_EulerSolver::RinglebSolution: &quot;</span></div>
<div class="line"><a name="l09431"></a><span class="lineno"> 9431</span>&#160;         &lt;&lt; <span class="stringliteral">&quot;Newton algorithm did not converge.&quot;</span> &lt;&lt; endl &lt;&lt; flush;</div>
<div class="line"><a name="l09432"></a><span class="lineno"> 9432</span>&#160;    exit(1);</div>
<div class="line"><a name="l09433"></a><span class="lineno"> 9433</span>&#160;  }</div>
<div class="line"><a name="l09434"></a><span class="lineno"> 9434</span>&#160; </div>
<div class="line"><a name="l09435"></a><span class="lineno"> 9435</span>&#160;  <span class="comment">/* Compute the speed of sound, density and pressure. */</span></div>
<div class="line"><a name="l09436"></a><span class="lineno"> 9436</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> a   = sqrt(1.0 - 0.5*gm1*q*q);</div>
<div class="line"><a name="l09437"></a><span class="lineno"> 9437</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rho = pow(a,tovgm1);</div>
<div class="line"><a name="l09438"></a><span class="lineno"> 9438</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> p   = pow(a,tgovgm1)/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>;</div>
<div class="line"><a name="l09439"></a><span class="lineno"> 9439</span>&#160; </div>
<div class="line"><a name="l09440"></a><span class="lineno"> 9440</span>&#160;  <span class="comment">/* Determine the derivative of x w.r.t. q and ydxdq. */</span></div>
<div class="line"><a name="l09441"></a><span class="lineno"> 9441</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dadq   = -0.5*gm1*q/a;</div>
<div class="line"><a name="l09442"></a><span class="lineno"> 9442</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodq =  2.0*rho*dadq/(gm1*a);</div>
<div class="line"><a name="l09443"></a><span class="lineno"> 9443</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dJJdq  =  dadq/(pow(a,6)*(a*a-1.0));</div>
<div class="line"><a name="l09444"></a><span class="lineno"> 9444</span>&#160; </div>
<div class="line"><a name="l09445"></a><span class="lineno"> 9445</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dxdq  = -(1.0/(k*k) - 0.5/(q*q))*drhodq/(rho*rho)</div>
<div class="line"><a name="l09446"></a><span class="lineno"> 9446</span>&#160;                        +   1.0/(rho*q*q*q) - 0.5*dJJdq;</div>
<div class="line"><a name="l09447"></a><span class="lineno"> 9447</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ydxdq = y*dxdq;</div>
<div class="line"><a name="l09448"></a><span class="lineno"> 9448</span>&#160; </div>
<div class="line"><a name="l09449"></a><span class="lineno"> 9449</span>&#160;  <span class="comment">/* Determine the derivative of 1/2 y2 w.r.t. q, which is ydydq. The reason is</span></div>
<div class="line"><a name="l09450"></a><span class="lineno"> 9450</span>&#160;<span class="comment">     that ydydq is always well defined, while dydyq is singular for y = 0. */</span></div>
<div class="line"><a name="l09451"></a><span class="lineno"> 9451</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ydydq = drhodq*(q*q-k*k)/(k*k*k*k*rho*rho*rho*q*q)</div>
<div class="line"><a name="l09452"></a><span class="lineno"> 9452</span>&#160;                        - 1.0/(k*k*rho*rho*q*q*q);</div>
<div class="line"><a name="l09453"></a><span class="lineno"> 9453</span>&#160; </div>
<div class="line"><a name="l09454"></a><span class="lineno"> 9454</span>&#160;  <span class="comment">/* Determine the direction of the streamline. */</span></div>
<div class="line"><a name="l09455"></a><span class="lineno"> 9455</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vecLen = sqrt(ydxdq*ydxdq + ydydq*ydydq);</div>
<div class="line"><a name="l09456"></a><span class="lineno"> 9456</span>&#160; </div>
<div class="line"><a name="l09457"></a><span class="lineno"> 9457</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velDir[] = {ydxdq/vecLen, ydydq/vecLen};</div>
<div class="line"><a name="l09458"></a><span class="lineno"> 9458</span>&#160;  <span class="keywordflow">if</span>(velDir[1] &gt; 0.0){velDir[0] = -velDir[0]; velDir[1] = -velDir[1];}</div>
<div class="line"><a name="l09459"></a><span class="lineno"> 9459</span>&#160; </div>
<div class="line"><a name="l09460"></a><span class="lineno"> 9460</span>&#160;  <span class="comment">/* Compute the conservative variables. Note that both 2D and 3D</span></div>
<div class="line"><a name="l09461"></a><span class="lineno"> 9461</span>&#160;<span class="comment">     cases are treated correctly. */</span></div>
<div class="line"><a name="l09462"></a><span class="lineno"> 9462</span>&#160;  sol[0]      = rho;</div>
<div class="line"><a name="l09463"></a><span class="lineno"> 9463</span>&#160;  sol[1]      = rho*q*velDir[0];</div>
<div class="line"><a name="l09464"></a><span class="lineno"> 9464</span>&#160;  sol[2]      = rho*q*velDir[1];</div>
<div class="line"><a name="l09465"></a><span class="lineno"> 9465</span>&#160;  sol[3]      = 0.0;</div>
<div class="line"><a name="l09466"></a><span class="lineno"> 9466</span>&#160;  sol[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] = p/gm1 + 0.5*rho*q*q;</div>
<div class="line"><a name="l09467"></a><span class="lineno"> 9467</span>&#160;}</div>
<div class="line"><a name="l09468"></a><span class="lineno"> 9468</span>&#160; </div>
<div class="line"><a name="l09469"></a><span class="lineno"> 9469</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l09470"></a><span class="lineno"> 9470</span>&#160; </div>
<div class="line"><a name="l09471"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___euler_solver.html#aa7f0f59d70754d0b2abb8face8f8398d"> 9471</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa7f0f59d70754d0b2abb8face8f8398d">CFEM_DG_EulerSolver::LoadRestart</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> **geometry, <a class="code" href="class_c_solver.html">CSolver</a> ***solver, <a class="code" href="class_c_config.html">CConfig</a> *config, <span class="keywordtype">int</span> val_iter, <span class="keywordtype">bool</span> val_update_geo) {</div>
<div class="line"><a name="l09472"></a><span class="lineno"> 9472</span>&#160; </div>
<div class="line"><a name="l09473"></a><span class="lineno"> 9473</span>&#160;  <span class="comment">/*--- Restart the solution from file information ---*/</span></div>
<div class="line"><a name="l09474"></a><span class="lineno"> 9474</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iVar;</div>
<div class="line"><a name="l09475"></a><span class="lineno"> 9475</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> index;</div>
<div class="line"><a name="l09476"></a><span class="lineno"> 9476</span>&#160; </div>
<div class="line"><a name="l09477"></a><span class="lineno"> 9477</span>&#160;  <span class="keywordtype">string</span> UnstExt, text_line;</div>
<div class="line"><a name="l09478"></a><span class="lineno"> 9478</span>&#160;  ifstream restart_file;</div>
<div class="line"><a name="l09479"></a><span class="lineno"> 9479</span>&#160; </div>
<div class="line"><a name="l09480"></a><span class="lineno"> 9480</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> compressible = (config-&gt;<a class="code" href="class_c_config.html#a66ca7e620390a81cd49cd0a00716128e">GetKind_Regime</a>() == <a class="code" href="option__structure_8hpp.html#a3d92e0a004752d2ef55cf6c1e2e3d6f0a20621ea72bb142dc0c8bf116a257516a">COMPRESSIBLE</a>);</div>
<div class="line"><a name="l09481"></a><span class="lineno"> 9481</span>&#160; </div>
<div class="line"><a name="l09482"></a><span class="lineno"> 9482</span>&#160;  <span class="keywordtype">string</span> restart_filename = config-&gt;<a class="code" href="class_c_config.html#ad91f3fcd28080a11685432e760221c1d">GetSolution_FlowFileName</a>();</div>
<div class="line"><a name="l09483"></a><span class="lineno"> 9483</span>&#160; </div>
<div class="line"><a name="l09484"></a><span class="lineno"> 9484</span>&#160;  <span class="keywordtype">int</span> counter = 0;</div>
<div class="line"><a name="l09485"></a><span class="lineno"> 9485</span>&#160;  <span class="keywordtype">long</span> iPoint_Local = 0; <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> iPoint_Global = 0;</div>
<div class="line"><a name="l09486"></a><span class="lineno"> 9486</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> rbuf_NotMatching = 0;</div>
<div class="line"><a name="l09487"></a><span class="lineno"> 9487</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nDOF_Read = 0;</div>
<div class="line"><a name="l09488"></a><span class="lineno"> 9488</span>&#160; </div>
<div class="line"><a name="l09489"></a><span class="lineno"> 9489</span>&#160;  <span class="comment">/*--- Skip coordinates ---*/</span></div>
<div class="line"><a name="l09490"></a><span class="lineno"> 9490</span>&#160; </div>
<div class="line"><a name="l09491"></a><span class="lineno"> 9491</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> skipVars = geometry[<a class="code" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>]-&gt;<a class="code" href="class_c_geometry.html#a2af01006c0c4f74ba089582f1a3587fe">GetnDim</a>();</div>
<div class="line"><a name="l09492"></a><span class="lineno"> 9492</span>&#160; </div>
<div class="line"><a name="l09493"></a><span class="lineno"> 9493</span>&#160;  <span class="comment">/*--- Read the restart data from either an ASCII or binary SU2 file. ---*/</span></div>
<div class="line"><a name="l09494"></a><span class="lineno"> 9494</span>&#160; </div>
<div class="line"><a name="l09495"></a><span class="lineno"> 9495</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#a37f4ffc9f97f54715ea40e411e60670f">GetRead_Binary_Restart</a>()) {</div>
<div class="line"><a name="l09496"></a><span class="lineno"> 9496</span>&#160;    <a class="code" href="class_c_solver.html#a7eb29d1b014277fe6fdba3a276acc67d">Read_SU2_Restart_Binary</a>(geometry[<a class="code" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>], config, restart_filename);</div>
<div class="line"><a name="l09497"></a><span class="lineno"> 9497</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09498"></a><span class="lineno"> 9498</span>&#160;    <a class="code" href="class_c_solver.html#ac5d5660eff53510f678a3aa122130585">Read_SU2_Restart_ASCII</a>(geometry[<a class="code" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>], config, restart_filename);</div>
<div class="line"><a name="l09499"></a><span class="lineno"> 9499</span>&#160;  }</div>
<div class="line"><a name="l09500"></a><span class="lineno"> 9500</span>&#160; </div>
<div class="line"><a name="l09501"></a><span class="lineno"> 9501</span>&#160;  <span class="comment">/*--- Load data from the restart into correct containers. ---*/</span></div>
<div class="line"><a name="l09502"></a><span class="lineno"> 9502</span>&#160; </div>
<div class="line"><a name="l09503"></a><span class="lineno"> 9503</span>&#160;  counter = 0;</div>
<div class="line"><a name="l09504"></a><span class="lineno"> 9504</span>&#160;  <span class="keywordflow">for</span> (iPoint_Global = 0; iPoint_Global &lt; geometry[<a class="code" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>]-&gt;<a class="code" href="class_c_geometry.html#a22f1fbc70d2133f1d1924cc7b56caee9">GetGlobal_nPointDomain</a>(); iPoint_Global++) {</div>
<div class="line"><a name="l09505"></a><span class="lineno"> 9505</span>&#160; </div>
<div class="line"><a name="l09506"></a><span class="lineno"> 9506</span>&#160;    <span class="comment">/*--- Retrieve local index. If this node from the restart file lives</span></div>
<div class="line"><a name="l09507"></a><span class="lineno"> 9507</span>&#160;<span class="comment">     on the current processor, we will load and instantiate the vars. ---*/</span></div>
<div class="line"><a name="l09508"></a><span class="lineno"> 9508</span>&#160; </div>
<div class="line"><a name="l09509"></a><span class="lineno"> 9509</span>&#160;    iPoint_Local = geometry[<a class="code" href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a>]-&gt;<a class="code" href="class_c_geometry.html#af8c9098e9da9a7c6c86d7316fe76230f">GetGlobal_to_Local_Point</a>(iPoint_Global);</div>
<div class="line"><a name="l09510"></a><span class="lineno"> 9510</span>&#160; </div>
<div class="line"><a name="l09511"></a><span class="lineno"> 9511</span>&#160;    <span class="keywordflow">if</span> (iPoint_Local &gt; -1) {</div>
<div class="line"><a name="l09512"></a><span class="lineno"> 9512</span>&#160; </div>
<div class="line"><a name="l09513"></a><span class="lineno"> 9513</span>&#160;      <span class="comment">/*--- We need to store this point&#39;s data, so jump to the correct</span></div>
<div class="line"><a name="l09514"></a><span class="lineno"> 9514</span>&#160;<span class="comment">       offset in the buffer of data from the restart file and load it. ---*/</span></div>
<div class="line"><a name="l09515"></a><span class="lineno"> 9515</span>&#160; </div>
<div class="line"><a name="l09516"></a><span class="lineno"> 9516</span>&#160;      index = counter*<a class="code" href="class_c_solver.html#a4b5582eaad51ea3d30bd8952e3e61ee9">Restart_Vars</a>[1] + skipVars;</div>
<div class="line"><a name="l09517"></a><span class="lineno"> 9517</span>&#160;      <span class="keywordflow">for</span> (iVar = 0; iVar &lt; <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; iVar++) {</div>
<div class="line"><a name="l09518"></a><span class="lineno"> 9518</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*iPoint_Local+iVar] = <a class="code" href="class_c_solver.html#accab22fb55e07508cf8be5a3b5f4fa02">Restart_Data</a>[index+iVar];</div>
<div class="line"><a name="l09519"></a><span class="lineno"> 9519</span>&#160;      }</div>
<div class="line"><a name="l09520"></a><span class="lineno"> 9520</span>&#160;      <span class="comment">/*--- Update the local counter nDOF_Read. ---*/</span></div>
<div class="line"><a name="l09521"></a><span class="lineno"> 9521</span>&#160;      ++nDOF_Read;</div>
<div class="line"><a name="l09522"></a><span class="lineno"> 9522</span>&#160; </div>
<div class="line"><a name="l09523"></a><span class="lineno"> 9523</span>&#160;      <span class="comment">/*--- Increment the overall counter for how many points have been loaded. ---*/</span></div>
<div class="line"><a name="l09524"></a><span class="lineno"> 9524</span>&#160;      counter++;</div>
<div class="line"><a name="l09525"></a><span class="lineno"> 9525</span>&#160;    }</div>
<div class="line"><a name="l09526"></a><span class="lineno"> 9526</span>&#160; </div>
<div class="line"><a name="l09527"></a><span class="lineno"> 9527</span>&#160;  }</div>
<div class="line"><a name="l09528"></a><span class="lineno"> 9528</span>&#160; </div>
<div class="line"><a name="l09529"></a><span class="lineno"> 9529</span>&#160;  <span class="comment">/*--- Detect a wrong solution file ---*/</span></div>
<div class="line"><a name="l09530"></a><span class="lineno"> 9530</span>&#160;  <span class="keywordflow">if</span>(nDOF_Read &lt; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>) rbuf_NotMatching = 1;</div>
<div class="line"><a name="l09531"></a><span class="lineno"> 9531</span>&#160; </div>
<div class="line"><a name="l09532"></a><span class="lineno"> 9532</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l09533"></a><span class="lineno"> 9533</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> sbuf_NotMatching = rbuf_NotMatching;</div>
<div class="line"><a name="l09534"></a><span class="lineno"> 9534</span>&#160;  <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(&amp;sbuf_NotMatching, &amp;rbuf_NotMatching, 1, <a class="code" href="mpi__structure_8hpp.html#acdbf7a6bf241b33828d6d38aac098c0f">MPI_UNSIGNED_SHORT</a>, <a class="code" href="mpi__structure_8hpp.html#a80d80987b473f4a13b0cc0384eddb51b">MPI_MAX</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l09535"></a><span class="lineno"> 9535</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l09536"></a><span class="lineno"> 9536</span>&#160; </div>
<div class="line"><a name="l09537"></a><span class="lineno"> 9537</span>&#160;  <span class="keywordflow">if</span> (rbuf_NotMatching != 0)</div>
<div class="line"><a name="l09538"></a><span class="lineno"> 9538</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="keywordtype">string</span>(<span class="stringliteral">&quot;The solution file &quot;</span>) + restart_filename.data() +</div>
<div class="line"><a name="l09539"></a><span class="lineno"> 9539</span>&#160;                   <span class="keywordtype">string</span>(<span class="stringliteral">&quot; doesn&#39;t match with the mesh file!\n&quot;</span>) +</div>
<div class="line"><a name="l09540"></a><span class="lineno"> 9540</span>&#160;                   <span class="keywordtype">string</span>(<span class="stringliteral">&quot;It could be empty lines at the end of the file.&quot;</span>),</div>
<div class="line"><a name="l09541"></a><span class="lineno"> 9541</span>&#160;                   <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l09542"></a><span class="lineno"> 9542</span>&#160; </div>
<div class="line"><a name="l09543"></a><span class="lineno"> 9543</span>&#160;  <span class="comment">/*--- Check that the initial solution is physical, report any non-physical nodes ---*/</span></div>
<div class="line"><a name="l09544"></a><span class="lineno"> 9544</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBadDOFs = 0;</div>
<div class="line"><a name="l09545"></a><span class="lineno"> 9545</span>&#160; </div>
<div class="line"><a name="l09546"></a><span class="lineno"> 9546</span>&#160;  <span class="keywordflow">if</span>( compressible ) {</div>
<div class="line"><a name="l09547"></a><span class="lineno"> 9547</span>&#160; </div>
<div class="line"><a name="l09548"></a><span class="lineno"> 9548</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> i=0; i&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">nDOFsLocOwned</a>; ++i) {</div>
<div class="line"><a name="l09549"></a><span class="lineno"> 9549</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i;</div>
<div class="line"><a name="l09550"></a><span class="lineno"> 9550</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv = 1.0/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>[ii];</div>
<div class="line"><a name="l09551"></a><span class="lineno"> 9551</span>&#160; </div>
<div class="line"><a name="l09552"></a><span class="lineno"> 9552</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Velocity2 = 0.0;</div>
<div class="line"><a name="l09553"></a><span class="lineno"> 9553</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=1; iDim&lt;=<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l09554"></a><span class="lineno"> 9554</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>[ii+iDim]*DensityInv;</div>
<div class="line"><a name="l09555"></a><span class="lineno"> 9555</span>&#160;        Velocity2 += vel*vel;</div>
<div class="line"><a name="l09556"></a><span class="lineno"> 9556</span>&#160;      }</div>
<div class="line"><a name="l09557"></a><span class="lineno"> 9557</span>&#160; </div>
<div class="line"><a name="l09558"></a><span class="lineno"> 9558</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>[ii+<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*DensityInv - 0.5*Velocity2;</div>
<div class="line"><a name="l09559"></a><span class="lineno"> 9559</span>&#160; </div>
<div class="line"><a name="l09560"></a><span class="lineno"> 9560</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>[ii], StaticEnergy);</div>
<div class="line"><a name="l09561"></a><span class="lineno"> 9561</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l09562"></a><span class="lineno"> 9562</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Temperature = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aeba3f29d27211ff50acad59477105969">GetTemperature</a>();</div>
<div class="line"><a name="l09563"></a><span class="lineno"> 9563</span>&#160; </div>
<div class="line"><a name="l09564"></a><span class="lineno"> 9564</span>&#160;      <span class="comment">/*--- Use the values at the infinity if the state is not physical. ---*/</span></div>
<div class="line"><a name="l09565"></a><span class="lineno"> 9565</span>&#160;      <span class="keywordflow">if</span>((Pressure &lt; 0.0) || (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>[ii] &lt; 0.0) || (Temperature &lt; 0.0)) {</div>
<div class="line"><a name="l09566"></a><span class="lineno"> 9566</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++j) {</div>
<div class="line"><a name="l09567"></a><span class="lineno"> 9567</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>[ii+j] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[j];</div>
<div class="line"><a name="l09568"></a><span class="lineno"> 9568</span>&#160;        }</div>
<div class="line"><a name="l09569"></a><span class="lineno"> 9569</span>&#160; </div>
<div class="line"><a name="l09570"></a><span class="lineno"> 9570</span>&#160;        ++nBadDOFs;</div>
<div class="line"><a name="l09571"></a><span class="lineno"> 9571</span>&#160;      }</div>
<div class="line"><a name="l09572"></a><span class="lineno"> 9572</span>&#160;    }</div>
<div class="line"><a name="l09573"></a><span class="lineno"> 9573</span>&#160;  }</div>
<div class="line"><a name="l09574"></a><span class="lineno"> 9574</span>&#160; </div>
<div class="line"><a name="l09575"></a><span class="lineno"> 9575</span>&#160;  <span class="comment">/*--- Warning message about non-physical points ---*/</span></div>
<div class="line"><a name="l09576"></a><span class="lineno"> 9576</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#aa878788c30e1c7c3ed4788e485bd2fb0">GetConsole_Output_Verb</a>() == <a class="code" href="option__structure_8hpp.html#ae40552e21f517bdde7c1a26de77b3e11a686b9a708a0e02450f0b19f485e7e96c">VERB_HIGH</a>) {</div>
<div class="line"><a name="l09577"></a><span class="lineno"> 9577</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l09578"></a><span class="lineno"> 9578</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBadDOFsLoc = nBadDOFs;</div>
<div class="line"><a name="l09579"></a><span class="lineno"> 9579</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a860dfcee07be04be175e06d342e0fc68">SU2_MPI::Reduce</a>(&amp;nBadDOFsLoc, &amp;nBadDOFs, 1, <a class="code" href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a>, <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l09580"></a><span class="lineno"> 9580</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l09581"></a><span class="lineno"> 9581</span>&#160; </div>
<div class="line"><a name="l09582"></a><span class="lineno"> 9582</span>&#160;    <span class="keywordflow">if</span>((<a class="code" href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">rank</a> == <a class="code" href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a>) &amp;&amp; (nBadDOFs != 0))</div>
<div class="line"><a name="l09583"></a><span class="lineno"> 9583</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;Warning. The initial solution contains &quot;</span>&lt;&lt; nBadDOFs &lt;&lt; <span class="stringliteral">&quot; DOFs that are not physical.&quot;</span> &lt;&lt; endl;</div>
<div class="line"><a name="l09584"></a><span class="lineno"> 9584</span>&#160;  }</div>
<div class="line"><a name="l09585"></a><span class="lineno"> 9585</span>&#160; </div>
<div class="line"><a name="l09586"></a><span class="lineno"> 9586</span>&#160;  <span class="comment">/*--- Delete the class memory that is used to load the restart. ---*/</span></div>
<div class="line"><a name="l09587"></a><span class="lineno"> 9587</span>&#160; </div>
<div class="line"><a name="l09588"></a><span class="lineno"> 9588</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_solver.html#a4b5582eaad51ea3d30bd8952e3e61ee9">Restart_Vars</a> != NULL) <span class="keyword">delete</span> [] <a class="code" href="class_c_solver.html#a4b5582eaad51ea3d30bd8952e3e61ee9">Restart_Vars</a>;</div>
<div class="line"><a name="l09589"></a><span class="lineno"> 9589</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_solver.html#accab22fb55e07508cf8be5a3b5f4fa02">Restart_Data</a> != NULL) <span class="keyword">delete</span> [] <a class="code" href="class_c_solver.html#accab22fb55e07508cf8be5a3b5f4fa02">Restart_Data</a>;</div>
<div class="line"><a name="l09590"></a><span class="lineno"> 9590</span>&#160;  <a class="code" href="class_c_solver.html#a4b5582eaad51ea3d30bd8952e3e61ee9">Restart_Vars</a> = NULL; <a class="code" href="class_c_solver.html#accab22fb55e07508cf8be5a3b5f4fa02">Restart_Data</a> = NULL;</div>
<div class="line"><a name="l09591"></a><span class="lineno"> 9591</span>&#160; </div>
<div class="line"><a name="l09592"></a><span class="lineno"> 9592</span>&#160;}</div>
<div class="line"><a name="l09593"></a><span class="lineno"> 9593</span>&#160; </div>
<div class="line"><a name="l09594"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a29c1a5c8d0afd5b82ff19c6f6f64a75b"> 9594</a></span>&#160;<a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a29c1a5c8d0afd5b82ff19c6f6f64a75b">CFEM_DG_NSSolver::CFEM_DG_NSSolver</a>(<span class="keywordtype">void</span>) : <a class="code" href="class_c_f_e_m___d_g___euler_solver.html">CFEM_DG_EulerSolver</a>() {</div>
<div class="line"><a name="l09595"></a><span class="lineno"> 9595</span>&#160; </div>
<div class="line"><a name="l09596"></a><span class="lineno"> 9596</span>&#160;  <span class="comment">/*--- Basic array initialization ---*/</span></div>
<div class="line"><a name="l09597"></a><span class="lineno"> 9597</span>&#160;  CD_Visc  = NULL; CL_Visc  = NULL; CSF_Visc = NULL; CEff_Visc = NULL;</div>
<div class="line"><a name="l09598"></a><span class="lineno"> 9598</span>&#160;  CMx_Visc = NULL; CMy_Visc = NULL; CMz_Visc = NULL;</div>
<div class="line"><a name="l09599"></a><span class="lineno"> 9599</span>&#160;  CFx_Visc = NULL; CFy_Visc = NULL; CFz_Visc = NULL;</div>
<div class="line"><a name="l09600"></a><span class="lineno"> 9600</span>&#160; </div>
<div class="line"><a name="l09601"></a><span class="lineno"> 9601</span>&#160;  <span class="comment">/*--- Surface-based array initialization ---*/</span></div>
<div class="line"><a name="l09602"></a><span class="lineno"> 9602</span>&#160;  Surface_CL_Visc  = NULL; Surface_CD_Visc  = NULL; Surface_CSF_Visc = NULL; Surface_CEff_Visc = NULL;</div>
<div class="line"><a name="l09603"></a><span class="lineno"> 9603</span>&#160;  Surface_CFx_Visc = NULL; Surface_CFy_Visc = NULL; Surface_CFz_Visc = NULL;</div>
<div class="line"><a name="l09604"></a><span class="lineno"> 9604</span>&#160;  Surface_CMx_Visc = NULL; Surface_CMy_Visc = NULL; Surface_CMz_Visc = NULL;</div>
<div class="line"><a name="l09605"></a><span class="lineno"> 9605</span>&#160;  MaxHeatFlux_Visc = NULL; Heat_Visc = NULL;</div>
<div class="line"><a name="l09606"></a><span class="lineno"> 9606</span>&#160; </div>
<div class="line"><a name="l09607"></a><span class="lineno"> 9607</span>&#160;  <span class="comment">/*--- Set the SGS model to NULL and indicate that no SGS model is used. ---*/</span></div>
<div class="line"><a name="l09608"></a><span class="lineno"> 9608</span>&#160;  SGSModel     = NULL;</div>
<div class="line"><a name="l09609"></a><span class="lineno"> 9609</span>&#160;  SGSModelUsed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l09610"></a><span class="lineno"> 9610</span>&#160;}</div>
<div class="line"><a name="l09611"></a><span class="lineno"> 9611</span>&#160; </div>
<div class="line"><a name="l09612"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#ac5a18ef33fc677c41a8f25d05eea1318"> 9612</a></span>&#160;<a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a29c1a5c8d0afd5b82ff19c6f6f64a75b">CFEM_DG_NSSolver::CFEM_DG_NSSolver</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry, <a class="code" href="class_c_config.html">CConfig</a> *config, <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh)</div>
<div class="line"><a name="l09613"></a><span class="lineno"> 9613</span>&#160; : <a class="code" href="class_c_f_e_m___d_g___euler_solver.html">CFEM_DG_EulerSolver</a>(geometry, config, iMesh) {</div>
<div class="line"><a name="l09614"></a><span class="lineno"> 9614</span>&#160; </div>
<div class="line"><a name="l09615"></a><span class="lineno"> 9615</span>&#160;  <span class="comment">/*--- Array initialization ---*/</span></div>
<div class="line"><a name="l09616"></a><span class="lineno"> 9616</span>&#160;  CD_Visc = NULL;  CL_Visc = NULL;  CSF_Visc = NULL; CEff_Visc = NULL;</div>
<div class="line"><a name="l09617"></a><span class="lineno"> 9617</span>&#160;  CMx_Visc = NULL; CMy_Visc = NULL; CMz_Visc = NULL;</div>
<div class="line"><a name="l09618"></a><span class="lineno"> 9618</span>&#160;  CFx_Visc = NULL; CFy_Visc = NULL; CFz_Visc = NULL;</div>
<div class="line"><a name="l09619"></a><span class="lineno"> 9619</span>&#160; </div>
<div class="line"><a name="l09620"></a><span class="lineno"> 9620</span>&#160;  Surface_CL_Visc  = NULL; Surface_CD_Visc = NULL;  Surface_CSF_Visc = NULL; Surface_CEff_Visc = NULL;</div>
<div class="line"><a name="l09621"></a><span class="lineno"> 9621</span>&#160;  Surface_CFx_Visc = NULL; Surface_CFy_Visc = NULL; Surface_CFz_Visc = NULL;</div>
<div class="line"><a name="l09622"></a><span class="lineno"> 9622</span>&#160;  Surface_CMx_Visc = NULL; Surface_CMy_Visc = NULL; Surface_CMz_Visc = NULL;</div>
<div class="line"><a name="l09623"></a><span class="lineno"> 9623</span>&#160;  MaxHeatFlux_Visc = NULL; Heat_Visc = NULL;</div>
<div class="line"><a name="l09624"></a><span class="lineno"> 9624</span>&#160; </div>
<div class="line"><a name="l09625"></a><span class="lineno"> 9625</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#add6a32199a4a6df9ade18f1c4fe325d1">Cauchy_Serie</a> = NULL;</div>
<div class="line"><a name="l09626"></a><span class="lineno"> 9626</span>&#160; </div>
<div class="line"><a name="l09627"></a><span class="lineno"> 9627</span>&#160;  <span class="comment">/*--- Initialize the solution and right hand side vectors for storing</span></div>
<div class="line"><a name="l09628"></a><span class="lineno"> 9628</span>&#160;<span class="comment">   the residuals and updating the solution (always needed even for</span></div>
<div class="line"><a name="l09629"></a><span class="lineno"> 9629</span>&#160;<span class="comment">   explicit schemes). ---*/</span></div>
<div class="line"><a name="l09630"></a><span class="lineno"> 9630</span>&#160; </div>
<div class="line"><a name="l09631"></a><span class="lineno"> 9631</span>&#160;  <span class="comment">//LinSysSol.Initialize(nPoint, nPointDomain, nVar, 0.0);</span></div>
<div class="line"><a name="l09632"></a><span class="lineno"> 9632</span>&#160;  <span class="comment">//LinSysRes.Initialize(nPoint, nPointDomain, nVar, 0.0);</span></div>
<div class="line"><a name="l09633"></a><span class="lineno"> 9633</span>&#160; </div>
<div class="line"><a name="l09634"></a><span class="lineno"> 9634</span>&#160;  <span class="comment">/*--- Non dimensional coefficients ---*/</span></div>
<div class="line"><a name="l09635"></a><span class="lineno"> 9635</span>&#160;  CD_Visc       = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09636"></a><span class="lineno"> 9636</span>&#160;  CL_Visc       = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09637"></a><span class="lineno"> 9637</span>&#160;  CSF_Visc      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09638"></a><span class="lineno"> 9638</span>&#160;  CMx_Visc      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09639"></a><span class="lineno"> 9639</span>&#160;  CMy_Visc      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09640"></a><span class="lineno"> 9640</span>&#160;  CMz_Visc      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09641"></a><span class="lineno"> 9641</span>&#160;  CEff_Visc     = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09642"></a><span class="lineno"> 9642</span>&#160;  CFx_Visc      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09643"></a><span class="lineno"> 9643</span>&#160;  CFy_Visc      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09644"></a><span class="lineno"> 9644</span>&#160;  CFz_Visc      = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09645"></a><span class="lineno"> 9645</span>&#160; </div>
<div class="line"><a name="l09646"></a><span class="lineno"> 9646</span>&#160;  Surface_CL_Visc   = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l09647"></a><span class="lineno"> 9647</span>&#160;  Surface_CD_Visc   = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l09648"></a><span class="lineno"> 9648</span>&#160;  Surface_CSF_Visc  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l09649"></a><span class="lineno"> 9649</span>&#160;  Surface_CEff_Visc = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l09650"></a><span class="lineno"> 9650</span>&#160;  Surface_CFx_Visc  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l09651"></a><span class="lineno"> 9651</span>&#160;  Surface_CFy_Visc  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l09652"></a><span class="lineno"> 9652</span>&#160;  Surface_CFz_Visc  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l09653"></a><span class="lineno"> 9653</span>&#160;  Surface_CMx_Visc  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l09654"></a><span class="lineno"> 9654</span>&#160;  Surface_CMy_Visc  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l09655"></a><span class="lineno"> 9655</span>&#160;  Surface_CMz_Visc  = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>()];</div>
<div class="line"><a name="l09656"></a><span class="lineno"> 9656</span>&#160; </div>
<div class="line"><a name="l09657"></a><span class="lineno"> 9657</span>&#160;  Heat_Visc        = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09658"></a><span class="lineno"> 9658</span>&#160;  MaxHeatFlux_Visc = <span class="keyword">new</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>[<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>];</div>
<div class="line"><a name="l09659"></a><span class="lineno"> 9659</span>&#160; </div>
<div class="line"><a name="l09660"></a><span class="lineno"> 9660</span>&#160;  <span class="comment">/*--- Init total coefficients ---*/</span></div>
<div class="line"><a name="l09661"></a><span class="lineno"> 9661</span>&#160; </div>
<div class="line"><a name="l09662"></a><span class="lineno"> 9662</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a>   = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a>  = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a92b0e3fa2d142ef6ed6c2ac4aafc9c04">Total_CSF</a> = 0.0;</div>
<div class="line"><a name="l09663"></a><span class="lineno"> 9663</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af47adcfc34283af5e61df0a69374e912">Total_CMx</a>  = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a54b44d56de430143b203dedb967e69d9">Total_CMy</a> = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7924707aed377b385c0cd7019ae1ef71">Total_CMz</a> = 0.0;</div>
<div class="line"><a name="l09664"></a><span class="lineno"> 9664</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a973142a08d87ce2338d5c64f7f1e146b">Total_CEff</a> = 0.0;</div>
<div class="line"><a name="l09665"></a><span class="lineno"> 9665</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a215f5d64c363a662ee0cb31cbd4f13a1">Total_CFx</a>  = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6a9e78792a4e1dd0b5c27501105be895">Total_CFy</a> = 0.0; <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3d32ed98538d3d4c345dd9c3a7d74c28">Total_CFz</a> = 0.0;</div>
<div class="line"><a name="l09666"></a><span class="lineno"> 9666</span>&#160; </div>
<div class="line"><a name="l09667"></a><span class="lineno"> 9667</span>&#160;  <span class="comment">/*--- Read farfield conditions from config ---*/</span></div>
<div class="line"><a name="l09668"></a><span class="lineno"> 9668</span>&#160; </div>
<div class="line"><a name="l09669"></a><span class="lineno"> 9669</span>&#160;  Viscosity_Inf = config-&gt;<a class="code" href="class_c_config.html#a2ede918fd25217170b85049ddf07408b">GetViscosity_FreeStreamND</a>();</div>
<div class="line"><a name="l09670"></a><span class="lineno"> 9670</span>&#160;  Prandtl_Lam   = config-&gt;<a class="code" href="class_c_config.html#a619cb1400d6c944e83ad0ffe82deb021">GetPrandtl_Lam</a>();</div>
<div class="line"><a name="l09671"></a><span class="lineno"> 9671</span>&#160;  Prandtl_Turb  = config-&gt;<a class="code" href="class_c_config.html#a2fca6d5964fb443f9d517df57659ccbc">GetPrandtl_Turb</a>();</div>
<div class="line"><a name="l09672"></a><span class="lineno"> 9672</span>&#160;  Tke_Inf       = config-&gt;<a class="code" href="class_c_config.html#af782fd344d8cbaac0d99eee409266c35">GetTke_FreeStreamND</a>();</div>
<div class="line"><a name="l09673"></a><span class="lineno"> 9673</span>&#160; </div>
<div class="line"><a name="l09674"></a><span class="lineno"> 9674</span>&#160;  <span class="comment">/*--- Set the SGS model in case an LES simulation is carried out ---*/</span></div>
<div class="line"><a name="l09675"></a><span class="lineno"> 9675</span>&#160; </div>
<div class="line"><a name="l09676"></a><span class="lineno"> 9676</span>&#160;  <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a0e2628fc803f14ec6179427ee02e8655">GetKind_Solver</a>() == <a class="code" href="option__structure_8hpp.html#a7e93bda08563596859d4d82f0ab516acad2cab85bb44510e289b85c4d94ac478a">FEM_LES</a>) {</div>
<div class="line"><a name="l09677"></a><span class="lineno"> 9677</span>&#160; </div>
<div class="line"><a name="l09678"></a><span class="lineno"> 9678</span>&#160;    <span class="comment">/* Make a distinction between the SGS models used and set SGSModel and</span></div>
<div class="line"><a name="l09679"></a><span class="lineno"> 9679</span>&#160;<span class="comment">       SGSModelUsed accordingly. */</span></div>
<div class="line"><a name="l09680"></a><span class="lineno"> 9680</span>&#160;    <span class="keywordflow">switch</span>( config-&gt;<a class="code" href="class_c_config.html#a5eb88779f285d4d51e4fea690d060d27">GetKind_SGS_Model</a>() ) {</div>
<div class="line"><a name="l09681"></a><span class="lineno"> 9681</span>&#160; </div>
<div class="line"><a name="l09682"></a><span class="lineno"> 9682</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ae397fe76319f131641386b93affbecb4aab4eea6b795ac144f4d01fdba5b09ead">IMPLICIT_LES</a>:</div>
<div class="line"><a name="l09683"></a><span class="lineno"> 9683</span>&#160;        SGSModel     = NULL;</div>
<div class="line"><a name="l09684"></a><span class="lineno"> 9684</span>&#160;        SGSModelUsed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l09685"></a><span class="lineno"> 9685</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09686"></a><span class="lineno"> 9686</span>&#160; </div>
<div class="line"><a name="l09687"></a><span class="lineno"> 9687</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ae397fe76319f131641386b93affbecb4ab0a1c23d76a86fa25af680205c74aad0">SMAGORINSKY</a>:</div>
<div class="line"><a name="l09688"></a><span class="lineno"> 9688</span>&#160;        SGSModel     = <span class="keyword">new</span> <a class="code" href="class_c_smagorinsky_model.html">CSmagorinskyModel</a>;</div>
<div class="line"><a name="l09689"></a><span class="lineno"> 9689</span>&#160;        SGSModelUsed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l09690"></a><span class="lineno"> 9690</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09691"></a><span class="lineno"> 9691</span>&#160; </div>
<div class="line"><a name="l09692"></a><span class="lineno"> 9692</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ae397fe76319f131641386b93affbecb4aebe1b12794696d7a9825edf3a36a4e37">WALE</a>:</div>
<div class="line"><a name="l09693"></a><span class="lineno"> 9693</span>&#160;        SGSModel     = <span class="keyword">new</span> <a class="code" href="class_c_w_a_l_e_model.html">CWALEModel</a>;</div>
<div class="line"><a name="l09694"></a><span class="lineno"> 9694</span>&#160;        SGSModelUsed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l09695"></a><span class="lineno"> 9695</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09696"></a><span class="lineno"> 9696</span>&#160; </div>
<div class="line"><a name="l09697"></a><span class="lineno"> 9697</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#ae397fe76319f131641386b93affbecb4a52921cb45f445c9b3ed0a770a8bcb5bc">VREMAN</a>:</div>
<div class="line"><a name="l09698"></a><span class="lineno"> 9698</span>&#160;        SGSModel     = <span class="keyword">new</span> <a class="code" href="class_c_vreman_model.html">CVremanModel</a>;</div>
<div class="line"><a name="l09699"></a><span class="lineno"> 9699</span>&#160;        SGSModelUsed = <span class="keyword">true</span>;</div>
<div class="line"><a name="l09700"></a><span class="lineno"> 9700</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l09701"></a><span class="lineno"> 9701</span>&#160; </div>
<div class="line"><a name="l09702"></a><span class="lineno"> 9702</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l09703"></a><span class="lineno"> 9703</span>&#160;        <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;Unknown SGS model encountered&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l09704"></a><span class="lineno"> 9704</span>&#160;    }</div>
<div class="line"><a name="l09705"></a><span class="lineno"> 9705</span>&#160;  }</div>
<div class="line"><a name="l09706"></a><span class="lineno"> 9706</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09707"></a><span class="lineno"> 9707</span>&#160; </div>
<div class="line"><a name="l09708"></a><span class="lineno"> 9708</span>&#160;    <span class="comment">/* No LES, so no SGS model needed.</span></div>
<div class="line"><a name="l09709"></a><span class="lineno"> 9709</span>&#160;<span class="comment">       Set the pointer to NULL and the boolean to false. */</span></div>
<div class="line"><a name="l09710"></a><span class="lineno"> 9710</span>&#160;    SGSModel     = NULL;</div>
<div class="line"><a name="l09711"></a><span class="lineno"> 9711</span>&#160;    SGSModelUsed = <span class="keyword">false</span>;</div>
<div class="line"><a name="l09712"></a><span class="lineno"> 9712</span>&#160;  }</div>
<div class="line"><a name="l09713"></a><span class="lineno"> 9713</span>&#160;}</div>
<div class="line"><a name="l09714"></a><span class="lineno"> 9714</span>&#160; </div>
<div class="line"><a name="l09715"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#ae3273efca4ed1059dde23d2ace51491a"> 9715</a></span>&#160;<a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#ae3273efca4ed1059dde23d2ace51491a">CFEM_DG_NSSolver::~CFEM_DG_NSSolver</a>(<span class="keywordtype">void</span>) {</div>
<div class="line"><a name="l09716"></a><span class="lineno"> 9716</span>&#160; </div>
<div class="line"><a name="l09717"></a><span class="lineno"> 9717</span>&#160;  <span class="keywordflow">if</span> (CD_Visc != NULL)       <span class="keyword">delete</span> [] CD_Visc;</div>
<div class="line"><a name="l09718"></a><span class="lineno"> 9718</span>&#160;  <span class="keywordflow">if</span> (CL_Visc != NULL)       <span class="keyword">delete</span> [] CL_Visc;</div>
<div class="line"><a name="l09719"></a><span class="lineno"> 9719</span>&#160;  <span class="keywordflow">if</span> (CSF_Visc != NULL)      <span class="keyword">delete</span> [] CSF_Visc;</div>
<div class="line"><a name="l09720"></a><span class="lineno"> 9720</span>&#160;  <span class="keywordflow">if</span> (CMx_Visc != NULL)      <span class="keyword">delete</span> [] CMx_Visc;</div>
<div class="line"><a name="l09721"></a><span class="lineno"> 9721</span>&#160;  <span class="keywordflow">if</span> (CMy_Visc != NULL)      <span class="keyword">delete</span> [] CMy_Visc;</div>
<div class="line"><a name="l09722"></a><span class="lineno"> 9722</span>&#160;  <span class="keywordflow">if</span> (CMz_Visc != NULL)      <span class="keyword">delete</span> [] CMz_Visc;</div>
<div class="line"><a name="l09723"></a><span class="lineno"> 9723</span>&#160;  <span class="keywordflow">if</span> (CFx_Visc != NULL)      <span class="keyword">delete</span> [] CFx_Visc;</div>
<div class="line"><a name="l09724"></a><span class="lineno"> 9724</span>&#160;  <span class="keywordflow">if</span> (CFy_Visc != NULL)      <span class="keyword">delete</span> [] CFy_Visc;</div>
<div class="line"><a name="l09725"></a><span class="lineno"> 9725</span>&#160;  <span class="keywordflow">if</span> (CFz_Visc != NULL)      <span class="keyword">delete</span> [] CFz_Visc;</div>
<div class="line"><a name="l09726"></a><span class="lineno"> 9726</span>&#160;  <span class="keywordflow">if</span> (CEff_Visc != NULL)     <span class="keyword">delete</span> [] CEff_Visc;</div>
<div class="line"><a name="l09727"></a><span class="lineno"> 9727</span>&#160; </div>
<div class="line"><a name="l09728"></a><span class="lineno"> 9728</span>&#160;  <span class="keywordflow">if</span> (Surface_CL_Visc != NULL)   <span class="keyword">delete</span> [] Surface_CL_Visc;</div>
<div class="line"><a name="l09729"></a><span class="lineno"> 9729</span>&#160;  <span class="keywordflow">if</span> (Surface_CD_Visc != NULL)   <span class="keyword">delete</span> [] Surface_CD_Visc;</div>
<div class="line"><a name="l09730"></a><span class="lineno"> 9730</span>&#160;  <span class="keywordflow">if</span> (Surface_CSF_Visc != NULL)  <span class="keyword">delete</span> [] Surface_CSF_Visc;</div>
<div class="line"><a name="l09731"></a><span class="lineno"> 9731</span>&#160;  <span class="keywordflow">if</span> (Surface_CEff_Visc != NULL) <span class="keyword">delete</span> [] Surface_CEff_Visc;</div>
<div class="line"><a name="l09732"></a><span class="lineno"> 9732</span>&#160;  <span class="keywordflow">if</span> (Surface_CFx_Visc != NULL)  <span class="keyword">delete</span> [] Surface_CFx_Visc;</div>
<div class="line"><a name="l09733"></a><span class="lineno"> 9733</span>&#160;  <span class="keywordflow">if</span> (Surface_CFy_Visc != NULL)  <span class="keyword">delete</span> [] Surface_CFy_Visc;</div>
<div class="line"><a name="l09734"></a><span class="lineno"> 9734</span>&#160;  <span class="keywordflow">if</span> (Surface_CFz_Visc != NULL)  <span class="keyword">delete</span> [] Surface_CFz_Visc;</div>
<div class="line"><a name="l09735"></a><span class="lineno"> 9735</span>&#160;  <span class="keywordflow">if</span> (Surface_CMx_Visc != NULL)  <span class="keyword">delete</span> [] Surface_CMx_Visc;</div>
<div class="line"><a name="l09736"></a><span class="lineno"> 9736</span>&#160;  <span class="keywordflow">if</span> (Surface_CMy_Visc != NULL)  <span class="keyword">delete</span> [] Surface_CMy_Visc;</div>
<div class="line"><a name="l09737"></a><span class="lineno"> 9737</span>&#160;  <span class="keywordflow">if</span> (Surface_CMz_Visc != NULL)  <span class="keyword">delete</span> [] Surface_CMz_Visc;</div>
<div class="line"><a name="l09738"></a><span class="lineno"> 9738</span>&#160; </div>
<div class="line"><a name="l09739"></a><span class="lineno"> 9739</span>&#160;  <span class="keywordflow">if</span> (Heat_Visc        != NULL)  <span class="keyword">delete</span> [] Heat_Visc;</div>
<div class="line"><a name="l09740"></a><span class="lineno"> 9740</span>&#160;  <span class="keywordflow">if</span> (MaxHeatFlux_Visc != NULL)  <span class="keyword">delete</span> [] MaxHeatFlux_Visc;</div>
<div class="line"><a name="l09741"></a><span class="lineno"> 9741</span>&#160; </div>
<div class="line"><a name="l09742"></a><span class="lineno"> 9742</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#add6a32199a4a6df9ade18f1c4fe325d1">Cauchy_Serie</a> != NULL) <span class="keyword">delete</span> [] <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#add6a32199a4a6df9ade18f1c4fe325d1">Cauchy_Serie</a>;</div>
<div class="line"><a name="l09743"></a><span class="lineno"> 9743</span>&#160; </div>
<div class="line"><a name="l09744"></a><span class="lineno"> 9744</span>&#160;  <span class="keywordflow">if</span>( SGSModel ) <span class="keyword">delete</span> SGSModel;</div>
<div class="line"><a name="l09745"></a><span class="lineno"> 9745</span>&#160;}</div>
<div class="line"><a name="l09746"></a><span class="lineno"> 9746</span>&#160; </div>
<div class="line"><a name="l09747"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a15cec95ab40ebb36ee69bc5f58840cf3"> 9747</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a15cec95ab40ebb36ee69bc5f58840cf3">CFEM_DG_NSSolver::Friction_Forces</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry, <a class="code" href="class_c_config.html">CConfig</a> *config) {</div>
<div class="line"><a name="l09748"></a><span class="lineno"> 9748</span>&#160; </div>
<div class="line"><a name="l09749"></a><span class="lineno"> 9749</span>&#160;  <span class="comment">/* Allocate the memory for the work array and initialize it to zero to avoid</span></div>
<div class="line"><a name="l09750"></a><span class="lineno"> 9750</span>&#160;<span class="comment">     warnings in debug mode  about uninitialized memory when padding is applied. */</span></div>
<div class="line"><a name="l09751"></a><span class="lineno"> 9751</span>&#160;  vector&lt;su2double&gt; workArrayVec(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a95cef33ccbfa61def433d11ddef5745d">sizeWorkArray</a>, 0.0);</div>
<div class="line"><a name="l09752"></a><span class="lineno"> 9752</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *workArray = workArrayVec.data();</div>
<div class="line"><a name="l09753"></a><span class="lineno"> 9753</span>&#160; </div>
<div class="line"><a name="l09754"></a><span class="lineno"> 9754</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l09755"></a><span class="lineno"> 9755</span>&#160;  <span class="comment">/*--- The skin friction is computed using the laminar viscosity and      ---*/</span></div>
<div class="line"><a name="l09756"></a><span class="lineno"> 9756</span>&#160;  <span class="comment">/*--- velocity gradients. This is correct when integration to the wall   ---*/</span></div>
<div class="line"><a name="l09757"></a><span class="lineno"> 9757</span>&#160;  <span class="comment">/*--- is performed, but not when wall functions are used. Hence, this    ---*/</span></div>
<div class="line"><a name="l09758"></a><span class="lineno"> 9758</span>&#160;  <span class="comment">/*--- function must be modified when wall functions are implemented.     ---*/</span></div>
<div class="line"><a name="l09759"></a><span class="lineno"> 9759</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l09760"></a><span class="lineno"> 9760</span>&#160; </div>
<div class="line"><a name="l09761"></a><span class="lineno"> 9761</span>&#160;  <span class="comment">/* The number of bytes to copied in the memcpy calls. */</span></div>
<div class="line"><a name="l09762"></a><span class="lineno"> 9762</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l09763"></a><span class="lineno"> 9763</span>&#160; </div>
<div class="line"><a name="l09764"></a><span class="lineno"> 9764</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l09765"></a><span class="lineno"> 9765</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l09766"></a><span class="lineno"> 9766</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l09767"></a><span class="lineno"> 9767</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l09768"></a><span class="lineno"> 9768</span>&#160; </div>
<div class="line"><a name="l09769"></a><span class="lineno"> 9769</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l09770"></a><span class="lineno"> 9770</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l09771"></a><span class="lineno"> 9771</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l09772"></a><span class="lineno"> 9772</span>&#160; </div>
<div class="line"><a name="l09773"></a><span class="lineno"> 9773</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector. */</span></div>
<div class="line"><a name="l09774"></a><span class="lineno"> 9774</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Lam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l09775"></a><span class="lineno"> 9775</span>&#160; </div>
<div class="line"><a name="l09776"></a><span class="lineno"> 9776</span>&#160;  <span class="comment">/*--- Get the information of the angle of attack, reference area, etc. ---*/</span></div>
<div class="line"><a name="l09777"></a><span class="lineno"> 9777</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Alpha        = config-&gt;<a class="code" href="class_c_config.html#a6020a5df7025ffb286f9b9f55f3f2773">GetAoA</a>()*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0;</div>
<div class="line"><a name="l09778"></a><span class="lineno"> 9778</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Beta         = config-&gt;<a class="code" href="class_c_config.html#a4305a79a4c74f13160c0dd8daae181ef">GetAoS</a>()*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0;</div>
<div class="line"><a name="l09779"></a><span class="lineno"> 9779</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RefArea      = config-&gt;<a class="code" href="class_c_config.html#ad1d22f6d4f0225e3281d826a4c866779">GetRefArea</a>();</div>
<div class="line"><a name="l09780"></a><span class="lineno"> 9780</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RefLength    = config-&gt;<a class="code" href="class_c_config.html#a63ce45e68b93f8f3f1de44a2abad67ef">GetRefLength</a>();</div>
<div class="line"><a name="l09781"></a><span class="lineno"> 9781</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Gas_Constant = config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l09782"></a><span class="lineno"> 9782</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *Origin      = config-&gt;<a class="code" href="class_c_config.html#a11302b0fc39a262419332a53e0a82c19">GetRefOriginMoment</a>(0);</div>
<div class="line"><a name="l09783"></a><span class="lineno"> 9783</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> grid_movement     = config-&gt;<a class="code" href="class_c_config.html#a65f49bf3888539804cc0ceac28a32923">GetGrid_Movement</a>();</div>
<div class="line"><a name="l09784"></a><span class="lineno"> 9784</span>&#160; </div>
<div class="line"><a name="l09785"></a><span class="lineno"> 9785</span>&#160;<span class="comment">/*--- Evaluate reference values for non-dimensionalization.</span></div>
<div class="line"><a name="l09786"></a><span class="lineno"> 9786</span>&#160;<span class="comment">        For dynamic meshes, use the motion Mach number as a reference value</span></div>
<div class="line"><a name="l09787"></a><span class="lineno"> 9787</span>&#160;<span class="comment">        for computing the force coefficients. Otherwise, use the freestream</span></div>
<div class="line"><a name="l09788"></a><span class="lineno"> 9788</span>&#160;<span class="comment">        values, which is the standard convention. ---*/</span></div>
<div class="line"><a name="l09789"></a><span class="lineno"> 9789</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RefTemp     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a1f8fc98a188469be0d59e9053457bcaf">Temperature_Inf</a>;</div>
<div class="line"><a name="l09790"></a><span class="lineno"> 9790</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RefDensity  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa9c51b1803e120b62903c76d666f7dc2">Density_Inf</a>;</div>
<div class="line"><a name="l09791"></a><span class="lineno"> 9791</span>&#160; </div>
<div class="line"><a name="l09792"></a><span class="lineno"> 9792</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RefVel2;</div>
<div class="line"><a name="l09793"></a><span class="lineno"> 9793</span>&#160;  <span class="keywordflow">if</span> (grid_movement) {</div>
<div class="line"><a name="l09794"></a><span class="lineno"> 9794</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Mach2Vel = sqrt(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>*Gas_Constant*RefTemp);</div>
<div class="line"><a name="l09795"></a><span class="lineno"> 9795</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Mach_Motion = config-&gt;<a class="code" href="class_c_config.html#a84da3953107e3dad010e13227f1d84d0">GetMach_Motion</a>();</div>
<div class="line"><a name="l09796"></a><span class="lineno"> 9796</span>&#160;    RefVel2 = (Mach_Motion*Mach2Vel)*(Mach_Motion*Mach2Vel);</div>
<div class="line"><a name="l09797"></a><span class="lineno"> 9797</span>&#160;  }</div>
<div class="line"><a name="l09798"></a><span class="lineno"> 9798</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l09799"></a><span class="lineno"> 9799</span>&#160;    RefVel2 = 0.0;</div>
<div class="line"><a name="l09800"></a><span class="lineno"> 9800</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim)</div>
<div class="line"><a name="l09801"></a><span class="lineno"> 9801</span>&#160;      RefVel2 += <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abb32d1dea64bec72ee273f0ceff0da6a">Velocity_Inf</a>[iDim]*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#abb32d1dea64bec72ee273f0ceff0da6a">Velocity_Inf</a>[iDim];</div>
<div class="line"><a name="l09802"></a><span class="lineno"> 9802</span>&#160;  }</div>
<div class="line"><a name="l09803"></a><span class="lineno"> 9803</span>&#160; </div>
<div class="line"><a name="l09804"></a><span class="lineno"> 9804</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factor = 1.0/(0.5*RefDensity*RefArea*RefVel2);</div>
<div class="line"><a name="l09805"></a><span class="lineno"> 9805</span>&#160; </div>
<div class="line"><a name="l09806"></a><span class="lineno"> 9806</span>&#160;  <span class="comment">/*--- Variables initialization ---*/</span></div>
<div class="line"><a name="l09807"></a><span class="lineno"> 9807</span>&#160;  AllBound_CD_Visc = 0.0;  AllBound_CL_Visc  = 0.0; AllBound_CSF_Visc = 0.0;</div>
<div class="line"><a name="l09808"></a><span class="lineno"> 9808</span>&#160;  AllBound_CMx_Visc = 0.0; AllBound_CMy_Visc = 0.0; AllBound_CMz_Visc = 0.0;</div>
<div class="line"><a name="l09809"></a><span class="lineno"> 9809</span>&#160;  AllBound_CFx_Visc = 0.0; AllBound_CFy_Visc = 0.0; AllBound_CFz_Visc = 0.0;</div>
<div class="line"><a name="l09810"></a><span class="lineno"> 9810</span>&#160; </div>
<div class="line"><a name="l09811"></a><span class="lineno"> 9811</span>&#160;  AllBound_HeatFlux_Visc = 0.0; AllBound_MaxHeatFlux_Visc = 0.0; AllBound_CEff_Visc = 0.0;</div>
<div class="line"><a name="l09812"></a><span class="lineno"> 9812</span>&#160; </div>
<div class="line"><a name="l09813"></a><span class="lineno"> 9813</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>(); ++iMarker_Monitoring) {</div>
<div class="line"><a name="l09814"></a><span class="lineno"> 9814</span>&#160;    Surface_CL_Visc[iMarker_Monitoring]  = 0.0; Surface_CD_Visc[iMarker_Monitoring]   = 0.0;</div>
<div class="line"><a name="l09815"></a><span class="lineno"> 9815</span>&#160;    Surface_CSF_Visc[iMarker_Monitoring] = 0.0; Surface_CEff_Visc[iMarker_Monitoring] = 0.0;</div>
<div class="line"><a name="l09816"></a><span class="lineno"> 9816</span>&#160;    Surface_CFx_Visc[iMarker_Monitoring] = 0.0; Surface_CFy_Visc[iMarker_Monitoring]  = 0.0;</div>
<div class="line"><a name="l09817"></a><span class="lineno"> 9817</span>&#160;    Surface_CFz_Visc[iMarker_Monitoring] = 0.0; Surface_CMx_Visc[iMarker_Monitoring]  = 0.0;</div>
<div class="line"><a name="l09818"></a><span class="lineno"> 9818</span>&#160;    Surface_CMy_Visc[iMarker_Monitoring] = 0.0; Surface_CMz_Visc[iMarker_Monitoring]  = 0.0;</div>
<div class="line"><a name="l09819"></a><span class="lineno"> 9819</span>&#160;  }</div>
<div class="line"><a name="l09820"></a><span class="lineno"> 9820</span>&#160; </div>
<div class="line"><a name="l09821"></a><span class="lineno"> 9821</span>&#160;  <span class="comment">/*--- Loop over the Navier-Stokes markers ---*/</span></div>
<div class="line"><a name="l09822"></a><span class="lineno"> 9822</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker=0; iMarker&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">nMarker</a>; ++iMarker) {</div>
<div class="line"><a name="l09823"></a><span class="lineno"> 9823</span>&#160; </div>
<div class="line"><a name="l09824"></a><span class="lineno"> 9824</span>&#160;    <span class="comment">/* Check if this boundary must be monitored. */</span></div>
<div class="line"><a name="l09825"></a><span class="lineno"> 9825</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> Monitoring = config-&gt;<a class="code" href="class_c_config.html#a942619938b389de95268bce31434c276">GetMarker_All_Monitoring</a>(iMarker);</div>
<div class="line"><a name="l09826"></a><span class="lineno"> 9826</span>&#160;    <span class="keywordflow">if</span>(Monitoring == <a class="code" href="option__structure_8hpp.html#a0e3c6990687ed4453e660b9db9181885a99f136a862ba5c7d16967231c29f09d6">YES</a>) {</div>
<div class="line"><a name="l09827"></a><span class="lineno"> 9827</span>&#160; </div>
<div class="line"><a name="l09828"></a><span class="lineno"> 9828</span>&#160;      <span class="comment">/* Easier storage of the boundary condition. */</span></div>
<div class="line"><a name="l09829"></a><span class="lineno"> 9829</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> Boundary = config-&gt;<a class="code" href="class_c_config.html#a57d43acc1457d2d27095ce006218862e">GetMarker_All_KindBC</a>(iMarker);</div>
<div class="line"><a name="l09830"></a><span class="lineno"> 9830</span>&#160; </div>
<div class="line"><a name="l09831"></a><span class="lineno"> 9831</span>&#160;      <span class="comment">/*--- Obtain the origin for the moment computation for a particular marker ---*/</span></div>
<div class="line"><a name="l09832"></a><span class="lineno"> 9832</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>();</div>
<div class="line"><a name="l09833"></a><span class="lineno"> 9833</span>&#160;                       ++iMarker_Monitoring) {</div>
<div class="line"><a name="l09834"></a><span class="lineno"> 9834</span>&#160;        <span class="keywordtype">string</span> Monitoring_Tag = config-&gt;<a class="code" href="class_c_config.html#a5bf47083eec0b00543d3d8c387f41ab2">GetMarker_Monitoring_TagBound</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l09835"></a><span class="lineno"> 9835</span>&#160;        <span class="keywordtype">string</span> Marker_Tag     = config-&gt;<a class="code" href="class_c_config.html#a967e969a3beb24bb6e57d7036af003be">GetMarker_All_TagBound</a>(iMarker);</div>
<div class="line"><a name="l09836"></a><span class="lineno"> 9836</span>&#160;        <span class="keywordflow">if</span> (Marker_Tag == Monitoring_Tag)</div>
<div class="line"><a name="l09837"></a><span class="lineno"> 9837</span>&#160;          Origin = config-&gt;<a class="code" href="class_c_config.html#a11302b0fc39a262419332a53e0a82c19">GetRefOriginMoment</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l09838"></a><span class="lineno"> 9838</span>&#160;      }</div>
<div class="line"><a name="l09839"></a><span class="lineno"> 9839</span>&#160; </div>
<div class="line"><a name="l09840"></a><span class="lineno"> 9840</span>&#160;      <span class="comment">/* Check for a boundary for which the viscous forces must be computed. */</span></div>
<div class="line"><a name="l09841"></a><span class="lineno"> 9841</span>&#160;      <span class="keywordflow">if</span>((Boundary == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a>) || (Boundary == <a class="code" href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a>)) {</div>
<div class="line"><a name="l09842"></a><span class="lineno"> 9842</span>&#160; </div>
<div class="line"><a name="l09843"></a><span class="lineno"> 9843</span>&#160;        <span class="comment">/*--- Forces initialization at each Marker ---*/</span></div>
<div class="line"><a name="l09844"></a><span class="lineno"> 9844</span>&#160;        CD_Visc[iMarker]  = 0.0; CL_Visc[iMarker]  = 0.0; CSF_Visc[iMarker] = 0.0;</div>
<div class="line"><a name="l09845"></a><span class="lineno"> 9845</span>&#160;        CMx_Visc[iMarker] = 0.0; CMy_Visc[iMarker] = 0.0; CMz_Visc[iMarker] = 0.0;</div>
<div class="line"><a name="l09846"></a><span class="lineno"> 9846</span>&#160;        CFx_Visc[iMarker] = 0.0; CFy_Visc[iMarker] = 0.0; CFz_Visc[iMarker] = 0.0;</div>
<div class="line"><a name="l09847"></a><span class="lineno"> 9847</span>&#160; </div>
<div class="line"><a name="l09848"></a><span class="lineno"> 9848</span>&#160;        Heat_Visc[iMarker]  = 0.0; MaxHeatFlux_Visc[iMarker] = 0.0; CEff_Visc[iMarker] = 0.0;</div>
<div class="line"><a name="l09849"></a><span class="lineno"> 9849</span>&#160; </div>
<div class="line"><a name="l09850"></a><span class="lineno"> 9850</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ForceViscous[]  = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l09851"></a><span class="lineno"> 9851</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> MomentViscous[] = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l09852"></a><span class="lineno"> 9852</span>&#160; </div>
<div class="line"><a name="l09853"></a><span class="lineno"> 9853</span>&#160;        <span class="comment">/* Easier storage of the boundary faces for this boundary marker. */</span></div>
<div class="line"><a name="l09854"></a><span class="lineno"> 9854</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      nSurfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.size();</div>
<div class="line"><a name="l09855"></a><span class="lineno"> 9855</span>&#160;        <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[iMarker].<a class="code" href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">surfElem</a>.data();</div>
<div class="line"><a name="l09856"></a><span class="lineno"> 9856</span>&#160; </div>
<div class="line"><a name="l09857"></a><span class="lineno"> 9857</span>&#160;        <span class="comment">/*--- Loop over the faces of this boundary. Multiple faces are treated</span></div>
<div class="line"><a name="l09858"></a><span class="lineno"> 9858</span>&#160;<span class="comment">              simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l09859"></a><span class="lineno"> 9859</span>&#160;<span class="comment">              multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l09860"></a><span class="lineno"> 9860</span>&#160;<span class="comment">              happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l09861"></a><span class="lineno"> 9861</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;nSurfElem;) {</div>
<div class="line"><a name="l09862"></a><span class="lineno"> 9862</span>&#160; </div>
<div class="line"><a name="l09863"></a><span class="lineno"> 9863</span>&#160;          <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l09864"></a><span class="lineno"> 9864</span>&#160;<span class="comment">             N value in the gemm computations. */</span></div>
<div class="line"><a name="l09865"></a><span class="lineno"> 9865</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l09866"></a><span class="lineno"> 9866</span>&#160;          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l09867"></a><span class="lineno"> 9867</span>&#160; </div>
<div class="line"><a name="l09868"></a><span class="lineno"> 9868</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, nSurfElem, nFaceSimul,</div>
<div class="line"><a name="l09869"></a><span class="lineno"> 9869</span>&#160;                              nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l09870"></a><span class="lineno"> 9870</span>&#160; </div>
<div class="line"><a name="l09871"></a><span class="lineno"> 9871</span>&#160;          <span class="comment">/* Get the required information from the corresponding standard face. */</span></div>
<div class="line"><a name="l09872"></a><span class="lineno"> 9872</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l09873"></a><span class="lineno"> 9873</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a26266f4d68d95c22bbb949fe6d8f5db6">GetNDOFsFace</a>();</div>
<div class="line"><a name="l09874"></a><span class="lineno"> 9874</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#aad6afe2fa8d35697a57dfc22a7542176">GetNDOFsElem</a>();</div>
<div class="line"><a name="l09875"></a><span class="lineno"> 9875</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFace     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a283dc8babad462022e4621afe0251929">GetBasisFaceIntegration</a>();</div>
<div class="line"><a name="l09876"></a><span class="lineno"> 9876</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *derBasisElem  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#af348ced10e1bc0d2a33992de84c13127">GetMatDerBasisElemIntegration</a>();</div>
<div class="line"><a name="l09877"></a><span class="lineno"> 9877</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights       = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l09878"></a><span class="lineno"> 9878</span>&#160; </div>
<div class="line"><a name="l09879"></a><span class="lineno"> 9879</span>&#160;          <span class="comment">/* Set the pointers for the local work arrays. */</span></div>
<div class="line"><a name="l09880"></a><span class="lineno"> 9880</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solInt     = workArray;</div>
<div class="line"><a name="l09881"></a><span class="lineno"> 9881</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradSolInt = solInt     + NPad*nInt;</div>
<div class="line"><a name="l09882"></a><span class="lineno"> 9882</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solCopy    = gradSolInt + NPad*nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l09883"></a><span class="lineno"> 9883</span>&#160; </div>
<div class="line"><a name="l09884"></a><span class="lineno"> 9884</span>&#160;          <span class="comment">/* Loop over the faces that are treated simultaneously. */</span></div>
<div class="line"><a name="l09885"></a><span class="lineno"> 9885</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l09886"></a><span class="lineno"> 9886</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l09887"></a><span class="lineno"> 9887</span>&#160; </div>
<div class="line"><a name="l09888"></a><span class="lineno"> 9888</span>&#160;            <span class="comment">/* Easier storage of the DOFs of the face. */</span></div>
<div class="line"><a name="l09889"></a><span class="lineno"> 9889</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFs = surfElem[l+ll].<a class="code" href="class_c_surface_element_f_e_m.html#aee91841e533b10cdbe3b3b09e98e3695">DOFsSolFace</a>.data();</div>
<div class="line"><a name="l09890"></a><span class="lineno"> 9890</span>&#160; </div>
<div class="line"><a name="l09891"></a><span class="lineno"> 9891</span>&#160;            <span class="comment">/* Copy the solution of the DOFs of the face such that it is</span></div>
<div class="line"><a name="l09892"></a><span class="lineno"> 9892</span>&#160;<span class="comment">               contiguous in memory. */</span></div>
<div class="line"><a name="l09893"></a><span class="lineno"> 9893</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsFace; ++i) {</div>
<div class="line"><a name="l09894"></a><span class="lineno"> 9894</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*DOFs[i];</div>
<div class="line"><a name="l09895"></a><span class="lineno"> 9895</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *sol    = solCopy + NPad*i + llNVar;</div>
<div class="line"><a name="l09896"></a><span class="lineno"> 9896</span>&#160;              memcpy(sol, solDOF, nBytes);</div>
<div class="line"><a name="l09897"></a><span class="lineno"> 9897</span>&#160;            }</div>
<div class="line"><a name="l09898"></a><span class="lineno"> 9898</span>&#160;          }</div>
<div class="line"><a name="l09899"></a><span class="lineno"> 9899</span>&#160; </div>
<div class="line"><a name="l09900"></a><span class="lineno"> 9900</span>&#160;          <span class="comment">/* Call the general function to carry out the matrix product to determine</span></div>
<div class="line"><a name="l09901"></a><span class="lineno"> 9901</span>&#160;<span class="comment">             the solution in the integration points. */</span></div>
<div class="line"><a name="l09902"></a><span class="lineno"> 9902</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt, NPad, nDOFsFace, basisFace, solCopy, solInt, config);</div>
<div class="line"><a name="l09903"></a><span class="lineno"> 9903</span>&#160; </div>
<div class="line"><a name="l09904"></a><span class="lineno"> 9904</span>&#160;          <span class="comment">/*--- Store the solution of the DOFs of the adjacent elements in contiguous</span></div>
<div class="line"><a name="l09905"></a><span class="lineno"> 9905</span>&#160;<span class="comment">                memory such that the function blasFunctions-&gt;gemm can be used to compute</span></div>
<div class="line"><a name="l09906"></a><span class="lineno"> 9906</span>&#160;<span class="comment">                the gradients solution variables in the integration points of the face. ---*/</span></div>
<div class="line"><a name="l09907"></a><span class="lineno"> 9907</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l09908"></a><span class="lineno"> 9908</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l09909"></a><span class="lineno"> 9909</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l09910"></a><span class="lineno"> 9910</span>&#160; </div>
<div class="line"><a name="l09911"></a><span class="lineno"> 9911</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem; ++i) {</div>
<div class="line"><a name="l09912"></a><span class="lineno"> 9912</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#abdf9f21e0435e853d60d7faeecbb5e2f">DOFsSolElement</a>[i];</div>
<div class="line"><a name="l09913"></a><span class="lineno"> 9913</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *sol    = solCopy + NPad*i + llNVar;</div>
<div class="line"><a name="l09914"></a><span class="lineno"> 9914</span>&#160;              memcpy(sol, solDOF, nBytes);</div>
<div class="line"><a name="l09915"></a><span class="lineno"> 9915</span>&#160;            }</div>
<div class="line"><a name="l09916"></a><span class="lineno"> 9916</span>&#160;          }</div>
<div class="line"><a name="l09917"></a><span class="lineno"> 9917</span>&#160; </div>
<div class="line"><a name="l09918"></a><span class="lineno"> 9918</span>&#160;          <span class="comment">/* Compute the gradients in the integration points. Call the general function to</span></div>
<div class="line"><a name="l09919"></a><span class="lineno"> 9919</span>&#160;<span class="comment">             carry out the matrix product. */</span></div>
<div class="line"><a name="l09920"></a><span class="lineno"> 9920</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFsElem, derBasisElem, solCopy, gradSolInt, config);</div>
<div class="line"><a name="l09921"></a><span class="lineno"> 9921</span>&#160; </div>
<div class="line"><a name="l09922"></a><span class="lineno"> 9922</span>&#160;          <span class="comment">/* Determine the offset between r- and -s-derivatives, which is also the</span></div>
<div class="line"><a name="l09923"></a><span class="lineno"> 9923</span>&#160;<span class="comment">             offset between s- and t-derivatives. */</span></div>
<div class="line"><a name="l09924"></a><span class="lineno"> 9924</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l09925"></a><span class="lineno"> 9925</span>&#160; </div>
<div class="line"><a name="l09926"></a><span class="lineno"> 9926</span>&#160;          <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l09927"></a><span class="lineno"> 9927</span>&#160;<span class="comment">             in order to have the most efficient code. */</span></div>
<div class="line"><a name="l09928"></a><span class="lineno"> 9928</span>&#160;          <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l09929"></a><span class="lineno"> 9929</span>&#160; </div>
<div class="line"><a name="l09930"></a><span class="lineno"> 9930</span>&#160;            <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l09931"></a><span class="lineno"> 9931</span>&#160; </div>
<div class="line"><a name="l09932"></a><span class="lineno"> 9932</span>&#160;              <span class="comment">/* Two dimensional simulation. Loop over the number of faces treated</span></div>
<div class="line"><a name="l09933"></a><span class="lineno"> 9933</span>&#160;<span class="comment">                 simultaneously. */</span></div>
<div class="line"><a name="l09934"></a><span class="lineno"> 9934</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l09935"></a><span class="lineno"> 9935</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l09936"></a><span class="lineno"> 9936</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l09937"></a><span class="lineno"> 9937</span>&#160; </div>
<div class="line"><a name="l09938"></a><span class="lineno"> 9938</span>&#160;                <span class="comment">/* Loop over the integration points of this surface element. */</span></div>
<div class="line"><a name="l09939"></a><span class="lineno"> 9939</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l09940"></a><span class="lineno"> 9940</span>&#160; </div>
<div class="line"><a name="l09941"></a><span class="lineno"> 9941</span>&#160;                  <span class="comment">/* Easier storage of the solution, its gradients, the normals,</span></div>
<div class="line"><a name="l09942"></a><span class="lineno"> 9942</span>&#160;<span class="comment">                     the metric terms and the coordinates of this integration point. */</span></div>
<div class="line"><a name="l09943"></a><span class="lineno"> 9943</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol         = solInt     + i*NPad + llNVar;</div>
<div class="line"><a name="l09944"></a><span class="lineno"> 9944</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDr    = gradSolInt + i*NPad + llNVar;</div>
<div class="line"><a name="l09945"></a><span class="lineno"> 9945</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDs    = solDOFDr   + offDeriv;</div>
<div class="line"><a name="l09946"></a><span class="lineno"> 9946</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals     = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data()</div>
<div class="line"><a name="l09947"></a><span class="lineno"> 9947</span>&#160;                                               + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l09948"></a><span class="lineno"> 9948</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a49f9ee99ed3a8a6c5c895050f29169d8">metricCoorDerivFace</a>.data()</div>
<div class="line"><a name="l09949"></a><span class="lineno"> 9949</span>&#160;                                               + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l09950"></a><span class="lineno"> 9950</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *Coord       = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data()</div>
<div class="line"><a name="l09951"></a><span class="lineno"> 9951</span>&#160;                                               + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l09952"></a><span class="lineno"> 9952</span>&#160; </div>
<div class="line"><a name="l09953"></a><span class="lineno"> 9953</span>&#160;                  <span class="comment">/* Easier storage of the metric terms. */</span></div>
<div class="line"><a name="l09954"></a><span class="lineno"> 9954</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l09955"></a><span class="lineno"> 9955</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l09956"></a><span class="lineno"> 9956</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = metricTerms[2];</div>
<div class="line"><a name="l09957"></a><span class="lineno"> 9957</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = metricTerms[3];</div>
<div class="line"><a name="l09958"></a><span class="lineno"> 9958</span>&#160; </div>
<div class="line"><a name="l09959"></a><span class="lineno"> 9959</span>&#160;                  <span class="comment">/* Compute the Cartesian gradients of the solution. */</span></div>
<div class="line"><a name="l09960"></a><span class="lineno"> 9960</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx;</div>
<div class="line"><a name="l09961"></a><span class="lineno"> 9961</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudx  = solDOFDr[1]*drdx + solDOFDs[1]*dsdx;</div>
<div class="line"><a name="l09962"></a><span class="lineno"> 9962</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdx  = solDOFDr[2]*drdx + solDOFDs[2]*dsdx;</div>
<div class="line"><a name="l09963"></a><span class="lineno"> 9963</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdx  = solDOFDr[3]*drdx + solDOFDs[3]*dsdx;</div>
<div class="line"><a name="l09964"></a><span class="lineno"> 9964</span>&#160; </div>
<div class="line"><a name="l09965"></a><span class="lineno"> 9965</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy;</div>
<div class="line"><a name="l09966"></a><span class="lineno"> 9966</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudy  = solDOFDr[1]*drdy + solDOFDs[1]*dsdy;</div>
<div class="line"><a name="l09967"></a><span class="lineno"> 9967</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdy  = solDOFDr[2]*drdy + solDOFDs[2]*dsdy;</div>
<div class="line"><a name="l09968"></a><span class="lineno"> 9968</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdy  = solDOFDr[3]*drdy + solDOFDs[3]*dsdy;</div>
<div class="line"><a name="l09969"></a><span class="lineno"> 9969</span>&#160; </div>
<div class="line"><a name="l09970"></a><span class="lineno"> 9970</span>&#160;                  <span class="comment">/* Compute the velocities and static energy in this</span></div>
<div class="line"><a name="l09971"></a><span class="lineno"> 9971</span>&#160;<span class="comment">                     integration point. */</span></div>
<div class="line"><a name="l09972"></a><span class="lineno"> 9972</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/sol[0];</div>
<div class="line"><a name="l09973"></a><span class="lineno"> 9973</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = DensityInv*sol[1];</div>
<div class="line"><a name="l09974"></a><span class="lineno"> 9974</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = DensityInv*sol[2];</div>
<div class="line"><a name="l09975"></a><span class="lineno"> 9975</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = DensityInv*sol[3];</div>
<div class="line"><a name="l09976"></a><span class="lineno"> 9976</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - 0.5*(u*u + v*v);</div>
<div class="line"><a name="l09977"></a><span class="lineno"> 9977</span>&#160; </div>
<div class="line"><a name="l09978"></a><span class="lineno"> 9978</span>&#160;                  <span class="comment">/* Compute the Cartesian gradients of the velocities and</span></div>
<div class="line"><a name="l09979"></a><span class="lineno"> 9979</span>&#160;<span class="comment">                     static energy in this integration point and also the</span></div>
<div class="line"><a name="l09980"></a><span class="lineno"> 9980</span>&#160;<span class="comment">                     divergence of the velocity. */</span></div>
<div class="line"><a name="l09981"></a><span class="lineno"> 9981</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = DensityInv*(drudx - u*drhodx);</div>
<div class="line"><a name="l09982"></a><span class="lineno"> 9982</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = DensityInv*(drudy - u*drhody);</div>
<div class="line"><a name="l09983"></a><span class="lineno"> 9983</span>&#160; </div>
<div class="line"><a name="l09984"></a><span class="lineno"> 9984</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = DensityInv*(drvdx - v*drhodx);</div>
<div class="line"><a name="l09985"></a><span class="lineno"> 9985</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = DensityInv*(drvdy - v*drhody);</div>
<div class="line"><a name="l09986"></a><span class="lineno"> 9986</span>&#160; </div>
<div class="line"><a name="l09987"></a><span class="lineno"> 9987</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergydx = DensityInv*(drEdx - TotalEnergy*drhodx)</div>
<div class="line"><a name="l09988"></a><span class="lineno"> 9988</span>&#160;                                                  - u*dudx - v*dvdx;</div>
<div class="line"><a name="l09989"></a><span class="lineno"> 9989</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergydy = DensityInv*(drEdy - TotalEnergy*drhody)</div>
<div class="line"><a name="l09990"></a><span class="lineno"> 9990</span>&#160;                                                  - u*dudy - v*dvdy;</div>
<div class="line"><a name="l09991"></a><span class="lineno"> 9991</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> divVel = dudx + dvdy;</div>
<div class="line"><a name="l09992"></a><span class="lineno"> 9992</span>&#160; </div>
<div class="line"><a name="l09993"></a><span class="lineno"> 9993</span>&#160;                  <span class="comment">/* Compute the laminar viscosity. */</span></div>
<div class="line"><a name="l09994"></a><span class="lineno"> 9994</span>&#160;                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l09995"></a><span class="lineno"> 9995</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l09996"></a><span class="lineno"> 9996</span>&#160; </div>
<div class="line"><a name="l09997"></a><span class="lineno"> 9997</span>&#160;                  <span class="comment">/* Set the value of the second viscosity and compute the</span></div>
<div class="line"><a name="l09998"></a><span class="lineno"> 9998</span>&#160;<span class="comment">                     divergence term in the viscous normal stresses. */</span></div>
<div class="line"><a name="l09999"></a><span class="lineno"> 9999</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*ViscosityLam;</div>
<div class="line"><a name="l10000"></a><span class="lineno">10000</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l10001"></a><span class="lineno">10001</span>&#160; </div>
<div class="line"><a name="l10002"></a><span class="lineno">10002</span>&#160;                  <span class="comment">/* Compute the viscous stress tensor and the normal flux.</span></div>
<div class="line"><a name="l10003"></a><span class="lineno">10003</span>&#160;<span class="comment">                     Note that there is a plus sign for the heat flux, because</span></div>
<div class="line"><a name="l10004"></a><span class="lineno">10004</span>&#160;<span class="comment">                     the normal points into the geometry. */</span></div>
<div class="line"><a name="l10005"></a><span class="lineno">10005</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxx = 2.0*ViscosityLam*dudx + lamDivTerm;</div>
<div class="line"><a name="l10006"></a><span class="lineno">10006</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyy = 2.0*ViscosityLam*dvdy + lamDivTerm;</div>
<div class="line"><a name="l10007"></a><span class="lineno">10007</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxy = ViscosityLam*(dudy + dvdx);</div>
<div class="line"><a name="l10008"></a><span class="lineno">10008</span>&#160; </div>
<div class="line"><a name="l10009"></a><span class="lineno">10009</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qHeatNorm = ViscosityLam*factHeatFlux_Lam</div>
<div class="line"><a name="l10010"></a><span class="lineno">10010</span>&#160;                                            * (dStaticEnergydx*normals[0]</div>
<div class="line"><a name="l10011"></a><span class="lineno">10011</span>&#160;                                            +  dStaticEnergydy*normals[1]);</div>
<div class="line"><a name="l10012"></a><span class="lineno">10012</span>&#160; </div>
<div class="line"><a name="l10013"></a><span class="lineno">10013</span>&#160;                  <span class="comment">/* Update the viscous force and moment. Note that the normal</span></div>
<div class="line"><a name="l10014"></a><span class="lineno">10014</span>&#160;<span class="comment">                     points into the geometry, hence the minus sign for the stress. */</span></div>
<div class="line"><a name="l10015"></a><span class="lineno">10015</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> scaleFac =  weights[i]*normals[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*factor;</div>
<div class="line"><a name="l10016"></a><span class="lineno">10016</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Fx       = -scaleFac*(tauxx*normals[0] + tauxy*normals[1]);</div>
<div class="line"><a name="l10017"></a><span class="lineno">10017</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Fy       = -scaleFac*(tauxy*normals[0] + tauyy*normals[1]);</div>
<div class="line"><a name="l10018"></a><span class="lineno">10018</span>&#160; </div>
<div class="line"><a name="l10019"></a><span class="lineno">10019</span>&#160;                  ForceViscous[0] += Fx;</div>
<div class="line"><a name="l10020"></a><span class="lineno">10020</span>&#160;                  ForceViscous[1] += Fy;</div>
<div class="line"><a name="l10021"></a><span class="lineno">10021</span>&#160; </div>
<div class="line"><a name="l10022"></a><span class="lineno">10022</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dx = Coord[0] - Origin[0];</div>
<div class="line"><a name="l10023"></a><span class="lineno">10023</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dy = Coord[1] - Origin[1];</div>
<div class="line"><a name="l10024"></a><span class="lineno">10024</span>&#160; </div>
<div class="line"><a name="l10025"></a><span class="lineno">10025</span>&#160;                  MomentViscous[2] += (Fy*dx - Fx*dy)/RefLength;</div>
<div class="line"><a name="l10026"></a><span class="lineno">10026</span>&#160; </div>
<div class="line"><a name="l10027"></a><span class="lineno">10027</span>&#160;                  <span class="comment">/* Update the heat flux and maximum heat flux for this marker. */</span></div>
<div class="line"><a name="l10028"></a><span class="lineno">10028</span>&#160;                  Heat_Visc[iMarker] += qHeatNorm*weights[i]*normals[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l10029"></a><span class="lineno">10029</span>&#160;                  MaxHeatFlux_Visc[iMarker] = max(MaxHeatFlux_Visc[iMarker], fabs(qHeatNorm));</div>
<div class="line"><a name="l10030"></a><span class="lineno">10030</span>&#160;                }</div>
<div class="line"><a name="l10031"></a><span class="lineno">10031</span>&#160;              }</div>
<div class="line"><a name="l10032"></a><span class="lineno">10032</span>&#160; </div>
<div class="line"><a name="l10033"></a><span class="lineno">10033</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l10034"></a><span class="lineno">10034</span>&#160;            }</div>
<div class="line"><a name="l10035"></a><span class="lineno">10035</span>&#160; </div>
<div class="line"><a name="l10036"></a><span class="lineno">10036</span>&#160;            <span class="comment">/*------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l10037"></a><span class="lineno">10037</span>&#160; </div>
<div class="line"><a name="l10038"></a><span class="lineno">10038</span>&#160;            <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l10039"></a><span class="lineno">10039</span>&#160; </div>
<div class="line"><a name="l10040"></a><span class="lineno">10040</span>&#160;              <span class="comment">/* Three dimensional simulation. Loop over the number of faces treated</span></div>
<div class="line"><a name="l10041"></a><span class="lineno">10041</span>&#160;<span class="comment">                 simultaneously. */</span></div>
<div class="line"><a name="l10042"></a><span class="lineno">10042</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l10043"></a><span class="lineno">10043</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l10044"></a><span class="lineno">10044</span>&#160;                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l10045"></a><span class="lineno">10045</span>&#160; </div>
<div class="line"><a name="l10046"></a><span class="lineno">10046</span>&#160;                <span class="comment">/* Loop over the integration points of this surface element. */</span></div>
<div class="line"><a name="l10047"></a><span class="lineno">10047</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l10048"></a><span class="lineno">10048</span>&#160; </div>
<div class="line"><a name="l10049"></a><span class="lineno">10049</span>&#160;                  <span class="comment">/* Easier storage of the solution, its gradients, the normals,</span></div>
<div class="line"><a name="l10050"></a><span class="lineno">10050</span>&#160;<span class="comment">                     the metric terms and the coordinates of this integration point. */</span></div>
<div class="line"><a name="l10051"></a><span class="lineno">10051</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol         = solInt     + i*NPad + llNVar;</div>
<div class="line"><a name="l10052"></a><span class="lineno">10052</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDr    = gradSolInt + i*NPad + llNVar;</div>
<div class="line"><a name="l10053"></a><span class="lineno">10053</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDs    = solDOFDr   + offDeriv;</div>
<div class="line"><a name="l10054"></a><span class="lineno">10054</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDt    = solDOFDs   + offDeriv;</div>
<div class="line"><a name="l10055"></a><span class="lineno">10055</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals     = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data()</div>
<div class="line"><a name="l10056"></a><span class="lineno">10056</span>&#160;                                               + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l10057"></a><span class="lineno">10057</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a49f9ee99ed3a8a6c5c895050f29169d8">metricCoorDerivFace</a>.data()</div>
<div class="line"><a name="l10058"></a><span class="lineno">10058</span>&#160;                                               + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l10059"></a><span class="lineno">10059</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *Coord       = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data()</div>
<div class="line"><a name="l10060"></a><span class="lineno">10060</span>&#160;                                               + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l10061"></a><span class="lineno">10061</span>&#160; </div>
<div class="line"><a name="l10062"></a><span class="lineno">10062</span>&#160;                  <span class="comment">/* Easier storage of the metric terms. */</span></div>
<div class="line"><a name="l10063"></a><span class="lineno">10063</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l10064"></a><span class="lineno">10064</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l10065"></a><span class="lineno">10065</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdz = metricTerms[2];</div>
<div class="line"><a name="l10066"></a><span class="lineno">10066</span>&#160; </div>
<div class="line"><a name="l10067"></a><span class="lineno">10067</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = metricTerms[3];</div>
<div class="line"><a name="l10068"></a><span class="lineno">10068</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = metricTerms[4];</div>
<div class="line"><a name="l10069"></a><span class="lineno">10069</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdz = metricTerms[5];</div>
<div class="line"><a name="l10070"></a><span class="lineno">10070</span>&#160; </div>
<div class="line"><a name="l10071"></a><span class="lineno">10071</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdx = metricTerms[6];</div>
<div class="line"><a name="l10072"></a><span class="lineno">10072</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdy = metricTerms[7];</div>
<div class="line"><a name="l10073"></a><span class="lineno">10073</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdz = metricTerms[8];</div>
<div class="line"><a name="l10074"></a><span class="lineno">10074</span>&#160; </div>
<div class="line"><a name="l10075"></a><span class="lineno">10075</span>&#160;                  <span class="comment">/* Compute the Cartesian gradients of the solution. */</span></div>
<div class="line"><a name="l10076"></a><span class="lineno">10076</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx + solDOFDt[0]*dtdx;</div>
<div class="line"><a name="l10077"></a><span class="lineno">10077</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudx  = solDOFDr[1]*drdx + solDOFDs[1]*dsdx + solDOFDt[1]*dtdx;</div>
<div class="line"><a name="l10078"></a><span class="lineno">10078</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdx  = solDOFDr[2]*drdx + solDOFDs[2]*dsdx + solDOFDt[2]*dtdx;</div>
<div class="line"><a name="l10079"></a><span class="lineno">10079</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdx  = solDOFDr[3]*drdx + solDOFDs[3]*dsdx + solDOFDt[3]*dtdx;</div>
<div class="line"><a name="l10080"></a><span class="lineno">10080</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdx  = solDOFDr[4]*drdx + solDOFDs[4]*dsdx + solDOFDt[4]*dtdx;</div>
<div class="line"><a name="l10081"></a><span class="lineno">10081</span>&#160; </div>
<div class="line"><a name="l10082"></a><span class="lineno">10082</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy + solDOFDt[0]*dtdy;</div>
<div class="line"><a name="l10083"></a><span class="lineno">10083</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudy  = solDOFDr[1]*drdy + solDOFDs[1]*dsdy + solDOFDt[1]*dtdy;</div>
<div class="line"><a name="l10084"></a><span class="lineno">10084</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdy  = solDOFDr[2]*drdy + solDOFDs[2]*dsdy + solDOFDt[2]*dtdy;</div>
<div class="line"><a name="l10085"></a><span class="lineno">10085</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdy  = solDOFDr[3]*drdy + solDOFDs[3]*dsdy + solDOFDt[3]*dtdy;</div>
<div class="line"><a name="l10086"></a><span class="lineno">10086</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdy  = solDOFDr[4]*drdy + solDOFDs[4]*dsdy + solDOFDt[4]*dtdy;</div>
<div class="line"><a name="l10087"></a><span class="lineno">10087</span>&#160; </div>
<div class="line"><a name="l10088"></a><span class="lineno">10088</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodz = solDOFDr[0]*drdz + solDOFDs[0]*dsdz + solDOFDt[0]*dtdz;</div>
<div class="line"><a name="l10089"></a><span class="lineno">10089</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudz  = solDOFDr[1]*drdz + solDOFDs[1]*dsdz + solDOFDt[1]*dtdz;</div>
<div class="line"><a name="l10090"></a><span class="lineno">10090</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdz  = solDOFDr[2]*drdz + solDOFDs[2]*dsdz + solDOFDt[2]*dtdz;</div>
<div class="line"><a name="l10091"></a><span class="lineno">10091</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdz  = solDOFDr[3]*drdz + solDOFDs[3]*dsdz + solDOFDt[3]*dtdz;</div>
<div class="line"><a name="l10092"></a><span class="lineno">10092</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdz  = solDOFDr[4]*drdz + solDOFDs[4]*dsdz + solDOFDt[4]*dtdz;</div>
<div class="line"><a name="l10093"></a><span class="lineno">10093</span>&#160; </div>
<div class="line"><a name="l10094"></a><span class="lineno">10094</span>&#160;                  <span class="comment">/* Compute the velocities and static energy in this</span></div>
<div class="line"><a name="l10095"></a><span class="lineno">10095</span>&#160;<span class="comment">                     integration point. */</span></div>
<div class="line"><a name="l10096"></a><span class="lineno">10096</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/sol[0];</div>
<div class="line"><a name="l10097"></a><span class="lineno">10097</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = DensityInv*sol[1];</div>
<div class="line"><a name="l10098"></a><span class="lineno">10098</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = DensityInv*sol[2];</div>
<div class="line"><a name="l10099"></a><span class="lineno">10099</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w            = DensityInv*sol[3];</div>
<div class="line"><a name="l10100"></a><span class="lineno">10100</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = DensityInv*sol[4];</div>
<div class="line"><a name="l10101"></a><span class="lineno">10101</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - 0.5*(u*u + v*v + w*w);</div>
<div class="line"><a name="l10102"></a><span class="lineno">10102</span>&#160; </div>
<div class="line"><a name="l10103"></a><span class="lineno">10103</span>&#160;                  <span class="comment">/* Compute the Cartesian gradients of the velocities and</span></div>
<div class="line"><a name="l10104"></a><span class="lineno">10104</span>&#160;<span class="comment">                     static energy in this integration point and also the</span></div>
<div class="line"><a name="l10105"></a><span class="lineno">10105</span>&#160;<span class="comment">                     divergence of the velocity. */</span></div>
<div class="line"><a name="l10106"></a><span class="lineno">10106</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = DensityInv*(drudx - u*drhodx);</div>
<div class="line"><a name="l10107"></a><span class="lineno">10107</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = DensityInv*(drudy - u*drhody);</div>
<div class="line"><a name="l10108"></a><span class="lineno">10108</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudz = DensityInv*(drudz - u*drhodz);</div>
<div class="line"><a name="l10109"></a><span class="lineno">10109</span>&#160; </div>
<div class="line"><a name="l10110"></a><span class="lineno">10110</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = DensityInv*(drvdx - v*drhodx);</div>
<div class="line"><a name="l10111"></a><span class="lineno">10111</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = DensityInv*(drvdy - v*drhody);</div>
<div class="line"><a name="l10112"></a><span class="lineno">10112</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdz = DensityInv*(drvdz - v*drhodz);</div>
<div class="line"><a name="l10113"></a><span class="lineno">10113</span>&#160; </div>
<div class="line"><a name="l10114"></a><span class="lineno">10114</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdx = DensityInv*(drwdx - w*drhodx);</div>
<div class="line"><a name="l10115"></a><span class="lineno">10115</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdy = DensityInv*(drwdy - w*drhody);</div>
<div class="line"><a name="l10116"></a><span class="lineno">10116</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdz = DensityInv*(drwdz - w*drhodz);</div>
<div class="line"><a name="l10117"></a><span class="lineno">10117</span>&#160; </div>
<div class="line"><a name="l10118"></a><span class="lineno">10118</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergydx = DensityInv*(drEdx - TotalEnergy*drhodx)</div>
<div class="line"><a name="l10119"></a><span class="lineno">10119</span>&#160;                                                  - u*dudx - v*dvdx - w*dwdx;</div>
<div class="line"><a name="l10120"></a><span class="lineno">10120</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergydy = DensityInv*(drEdy - TotalEnergy*drhody)</div>
<div class="line"><a name="l10121"></a><span class="lineno">10121</span>&#160;                                                  - u*dudy - v*dvdy - w*dwdy;</div>
<div class="line"><a name="l10122"></a><span class="lineno">10122</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergydz = DensityInv*(drEdz - TotalEnergy*drhodz)</div>
<div class="line"><a name="l10123"></a><span class="lineno">10123</span>&#160;                                                  - u*dudz - v*dvdz - w*dwdz;</div>
<div class="line"><a name="l10124"></a><span class="lineno">10124</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> divVel = dudx + dvdy + dwdz;</div>
<div class="line"><a name="l10125"></a><span class="lineno">10125</span>&#160; </div>
<div class="line"><a name="l10126"></a><span class="lineno">10126</span>&#160;                  <span class="comment">/* Compute the laminar viscosity. */</span></div>
<div class="line"><a name="l10127"></a><span class="lineno">10127</span>&#160;                  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l10128"></a><span class="lineno">10128</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l10129"></a><span class="lineno">10129</span>&#160; </div>
<div class="line"><a name="l10130"></a><span class="lineno">10130</span>&#160;                  <span class="comment">/* Set the value of the second viscosity and compute the</span></div>
<div class="line"><a name="l10131"></a><span class="lineno">10131</span>&#160;<span class="comment">                     divergence term in the viscous normal stresses. */</span></div>
<div class="line"><a name="l10132"></a><span class="lineno">10132</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*ViscosityLam;</div>
<div class="line"><a name="l10133"></a><span class="lineno">10133</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l10134"></a><span class="lineno">10134</span>&#160; </div>
<div class="line"><a name="l10135"></a><span class="lineno">10135</span>&#160;                  <span class="comment">/* Compute the viscous stress tensor and the normal flux.</span></div>
<div class="line"><a name="l10136"></a><span class="lineno">10136</span>&#160;<span class="comment">                     Note that there is a plus sign for the heat flux, because</span></div>
<div class="line"><a name="l10137"></a><span class="lineno">10137</span>&#160;<span class="comment">                     the normal points into the geometry. */</span></div>
<div class="line"><a name="l10138"></a><span class="lineno">10138</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxx = 2.0*ViscosityLam*dudx + lamDivTerm;</div>
<div class="line"><a name="l10139"></a><span class="lineno">10139</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyy = 2.0*ViscosityLam*dvdy + lamDivTerm;</div>
<div class="line"><a name="l10140"></a><span class="lineno">10140</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauzz = 2.0*ViscosityLam*dwdz + lamDivTerm;</div>
<div class="line"><a name="l10141"></a><span class="lineno">10141</span>&#160; </div>
<div class="line"><a name="l10142"></a><span class="lineno">10142</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxy = ViscosityLam*(dudy + dvdx);</div>
<div class="line"><a name="l10143"></a><span class="lineno">10143</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxz = ViscosityLam*(dudz + dwdx);</div>
<div class="line"><a name="l10144"></a><span class="lineno">10144</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyz = ViscosityLam*(dvdz + dwdy);</div>
<div class="line"><a name="l10145"></a><span class="lineno">10145</span>&#160; </div>
<div class="line"><a name="l10146"></a><span class="lineno">10146</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qHeatNorm = ViscosityLam*factHeatFlux_Lam</div>
<div class="line"><a name="l10147"></a><span class="lineno">10147</span>&#160;                                            * (dStaticEnergydx*normals[0]</div>
<div class="line"><a name="l10148"></a><span class="lineno">10148</span>&#160;                                            +  dStaticEnergydy*normals[1]</div>
<div class="line"><a name="l10149"></a><span class="lineno">10149</span>&#160;                                            +  dStaticEnergydz*normals[2]);</div>
<div class="line"><a name="l10150"></a><span class="lineno">10150</span>&#160; </div>
<div class="line"><a name="l10151"></a><span class="lineno">10151</span>&#160;                  <span class="comment">/* Update the viscous force and moment. Note that the normal</span></div>
<div class="line"><a name="l10152"></a><span class="lineno">10152</span>&#160;<span class="comment">                     points into the geometry, hence the minus sign for the stress. */</span></div>
<div class="line"><a name="l10153"></a><span class="lineno">10153</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> scaleFac =  weights[i]*normals[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*factor;</div>
<div class="line"><a name="l10154"></a><span class="lineno">10154</span>&#160; </div>
<div class="line"><a name="l10155"></a><span class="lineno">10155</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Fx = -scaleFac*(tauxx*normals[0] + tauxy*normals[1]</div>
<div class="line"><a name="l10156"></a><span class="lineno">10156</span>&#160;                                     +            tauxz*normals[2]);</div>
<div class="line"><a name="l10157"></a><span class="lineno">10157</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Fy = -scaleFac*(tauxy*normals[0] + tauyy*normals[1]</div>
<div class="line"><a name="l10158"></a><span class="lineno">10158</span>&#160;                                     +            tauyz*normals[2]);</div>
<div class="line"><a name="l10159"></a><span class="lineno">10159</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Fz = -scaleFac*(tauxz*normals[0] + tauyz*normals[1]</div>
<div class="line"><a name="l10160"></a><span class="lineno">10160</span>&#160;                                     +            tauzz*normals[2]);</div>
<div class="line"><a name="l10161"></a><span class="lineno">10161</span>&#160; </div>
<div class="line"><a name="l10162"></a><span class="lineno">10162</span>&#160;                  ForceViscous[0] += Fx;</div>
<div class="line"><a name="l10163"></a><span class="lineno">10163</span>&#160;                  ForceViscous[1] += Fy;</div>
<div class="line"><a name="l10164"></a><span class="lineno">10164</span>&#160;                  ForceViscous[2] += Fz;</div>
<div class="line"><a name="l10165"></a><span class="lineno">10165</span>&#160; </div>
<div class="line"><a name="l10166"></a><span class="lineno">10166</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dx = Coord[0] - Origin[0];</div>
<div class="line"><a name="l10167"></a><span class="lineno">10167</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dy = Coord[1] - Origin[1];</div>
<div class="line"><a name="l10168"></a><span class="lineno">10168</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dz = Coord[2] - Origin[2];</div>
<div class="line"><a name="l10169"></a><span class="lineno">10169</span>&#160; </div>
<div class="line"><a name="l10170"></a><span class="lineno">10170</span>&#160;                  MomentViscous[0] += (Fz*dy - Fy*dz)/RefLength;</div>
<div class="line"><a name="l10171"></a><span class="lineno">10171</span>&#160;                  MomentViscous[1] += (Fx*dz - Fz*dx)/RefLength;</div>
<div class="line"><a name="l10172"></a><span class="lineno">10172</span>&#160;                  MomentViscous[2] += (Fy*dx - Fx*dy)/RefLength;</div>
<div class="line"><a name="l10173"></a><span class="lineno">10173</span>&#160; </div>
<div class="line"><a name="l10174"></a><span class="lineno">10174</span>&#160;                  <span class="comment">/* Update the heat flux and maximum heat flux for this marker. */</span></div>
<div class="line"><a name="l10175"></a><span class="lineno">10175</span>&#160;                  Heat_Visc[iMarker] += qHeatNorm*weights[i]*normals[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>];</div>
<div class="line"><a name="l10176"></a><span class="lineno">10176</span>&#160;                  MaxHeatFlux_Visc[iMarker] = max(MaxHeatFlux_Visc[iMarker], fabs(qHeatNorm));</div>
<div class="line"><a name="l10177"></a><span class="lineno">10177</span>&#160;                }</div>
<div class="line"><a name="l10178"></a><span class="lineno">10178</span>&#160;              }</div>
<div class="line"><a name="l10179"></a><span class="lineno">10179</span>&#160; </div>
<div class="line"><a name="l10180"></a><span class="lineno">10180</span>&#160;              <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l10181"></a><span class="lineno">10181</span>&#160;            }</div>
<div class="line"><a name="l10182"></a><span class="lineno">10182</span>&#160;          }</div>
<div class="line"><a name="l10183"></a><span class="lineno">10183</span>&#160; </div>
<div class="line"><a name="l10184"></a><span class="lineno">10184</span>&#160;          <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l10185"></a><span class="lineno">10185</span>&#160;<span class="comment">             current chunk. */</span></div>
<div class="line"><a name="l10186"></a><span class="lineno">10186</span>&#160;          l = lEnd;</div>
<div class="line"><a name="l10187"></a><span class="lineno">10187</span>&#160;        }</div>
<div class="line"><a name="l10188"></a><span class="lineno">10188</span>&#160; </div>
<div class="line"><a name="l10189"></a><span class="lineno">10189</span>&#160;        <span class="comment">/*--- Project forces and store the non-dimensional coefficients ---*/</span></div>
<div class="line"><a name="l10190"></a><span class="lineno">10190</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 2) {</div>
<div class="line"><a name="l10191"></a><span class="lineno">10191</span>&#160;          CD_Visc[iMarker]   =  ForceViscous[0]*cos(Alpha) + ForceViscous[1]*sin(Alpha);</div>
<div class="line"><a name="l10192"></a><span class="lineno">10192</span>&#160;          CL_Visc[iMarker]   = -ForceViscous[0]*sin(Alpha) + ForceViscous[1]*cos(Alpha);</div>
<div class="line"><a name="l10193"></a><span class="lineno">10193</span>&#160;          CEff_Visc[iMarker] = CL_Visc[iMarker] / (CD_Visc[iMarker]+<a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l10194"></a><span class="lineno">10194</span>&#160;          CMz_Visc[iMarker]  = MomentViscous[2];</div>
<div class="line"><a name="l10195"></a><span class="lineno">10195</span>&#160;          CFx_Visc[iMarker]  = ForceViscous[0];</div>
<div class="line"><a name="l10196"></a><span class="lineno">10196</span>&#160;          CFy_Visc[iMarker]  = ForceViscous[1];</div>
<div class="line"><a name="l10197"></a><span class="lineno">10197</span>&#160;        }</div>
<div class="line"><a name="l10198"></a><span class="lineno">10198</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> == 3) {</div>
<div class="line"><a name="l10199"></a><span class="lineno">10199</span>&#160;          CD_Visc[iMarker]   =  ForceViscous[0]*cos(Alpha)*cos(Beta)</div>
<div class="line"><a name="l10200"></a><span class="lineno">10200</span>&#160;                             +  ForceViscous[1]*sin(Beta)</div>
<div class="line"><a name="l10201"></a><span class="lineno">10201</span>&#160;                             +  ForceViscous[2]*sin(Alpha)*cos(Beta);</div>
<div class="line"><a name="l10202"></a><span class="lineno">10202</span>&#160;          CL_Visc[iMarker]   = -ForceViscous[0]*sin(Alpha) + ForceViscous[2]*cos(Alpha);</div>
<div class="line"><a name="l10203"></a><span class="lineno">10203</span>&#160;          CSF_Visc[iMarker]  = -ForceViscous[0]*sin(Beta)*cos(Alpha)</div>
<div class="line"><a name="l10204"></a><span class="lineno">10204</span>&#160;                             +  ForceViscous[1]*cos(Beta)</div>
<div class="line"><a name="l10205"></a><span class="lineno">10205</span>&#160;                             -  ForceViscous[2]*sin(Beta)*sin(Alpha);</div>
<div class="line"><a name="l10206"></a><span class="lineno">10206</span>&#160;          CEff_Visc[iMarker] = CL_Visc[iMarker]/(CD_Visc[iMarker] + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l10207"></a><span class="lineno">10207</span>&#160;          CMx_Visc[iMarker]  = MomentViscous[0];</div>
<div class="line"><a name="l10208"></a><span class="lineno">10208</span>&#160;          CMy_Visc[iMarker]  = MomentViscous[1];</div>
<div class="line"><a name="l10209"></a><span class="lineno">10209</span>&#160;          CMz_Visc[iMarker]  = MomentViscous[2];</div>
<div class="line"><a name="l10210"></a><span class="lineno">10210</span>&#160;          CFx_Visc[iMarker]  = ForceViscous[0];</div>
<div class="line"><a name="l10211"></a><span class="lineno">10211</span>&#160;          CFy_Visc[iMarker]  = ForceViscous[1];</div>
<div class="line"><a name="l10212"></a><span class="lineno">10212</span>&#160;          CFz_Visc[iMarker]  = ForceViscous[2];</div>
<div class="line"><a name="l10213"></a><span class="lineno">10213</span>&#160;        }</div>
<div class="line"><a name="l10214"></a><span class="lineno">10214</span>&#160; </div>
<div class="line"><a name="l10215"></a><span class="lineno">10215</span>&#160;        AllBound_CD_Visc   += CD_Visc[iMarker];</div>
<div class="line"><a name="l10216"></a><span class="lineno">10216</span>&#160;        AllBound_CL_Visc   += CL_Visc[iMarker];</div>
<div class="line"><a name="l10217"></a><span class="lineno">10217</span>&#160;        AllBound_CSF_Visc  += CSF_Visc[iMarker];</div>
<div class="line"><a name="l10218"></a><span class="lineno">10218</span>&#160;        AllBound_CMx_Visc  += CMx_Visc[iMarker];</div>
<div class="line"><a name="l10219"></a><span class="lineno">10219</span>&#160;        AllBound_CMy_Visc  += CMy_Visc[iMarker];</div>
<div class="line"><a name="l10220"></a><span class="lineno">10220</span>&#160;        AllBound_CMz_Visc  += CMz_Visc[iMarker];</div>
<div class="line"><a name="l10221"></a><span class="lineno">10221</span>&#160;        AllBound_CFx_Visc  += CFx_Visc[iMarker];</div>
<div class="line"><a name="l10222"></a><span class="lineno">10222</span>&#160;        AllBound_CFy_Visc  += CFy_Visc[iMarker];</div>
<div class="line"><a name="l10223"></a><span class="lineno">10223</span>&#160;        AllBound_CFz_Visc  += CFz_Visc[iMarker];</div>
<div class="line"><a name="l10224"></a><span class="lineno">10224</span>&#160; </div>
<div class="line"><a name="l10225"></a><span class="lineno">10225</span>&#160;        AllBound_HeatFlux_Visc   += Heat_Visc[iMarker];</div>
<div class="line"><a name="l10226"></a><span class="lineno">10226</span>&#160;        AllBound_MaxHeatFlux_Visc = max(AllBound_MaxHeatFlux_Visc,</div>
<div class="line"><a name="l10227"></a><span class="lineno">10227</span>&#160;                                        MaxHeatFlux_Visc[iMarker]);</div>
<div class="line"><a name="l10228"></a><span class="lineno">10228</span>&#160; </div>
<div class="line"><a name="l10229"></a><span class="lineno">10229</span>&#160;        <span class="comment">/*--- Compute the coefficients per surface ---*/</span></div>
<div class="line"><a name="l10230"></a><span class="lineno">10230</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>();</div>
<div class="line"><a name="l10231"></a><span class="lineno">10231</span>&#160;                         ++iMarker_Monitoring) {</div>
<div class="line"><a name="l10232"></a><span class="lineno">10232</span>&#160;          <span class="keywordtype">string</span> Monitoring_Tag = config-&gt;<a class="code" href="class_c_config.html#a5bf47083eec0b00543d3d8c387f41ab2">GetMarker_Monitoring_TagBound</a>(iMarker_Monitoring);</div>
<div class="line"><a name="l10233"></a><span class="lineno">10233</span>&#160;          <span class="keywordtype">string</span> Marker_Tag = config-&gt;<a class="code" href="class_c_config.html#a967e969a3beb24bb6e57d7036af003be">GetMarker_All_TagBound</a>(iMarker);</div>
<div class="line"><a name="l10234"></a><span class="lineno">10234</span>&#160;          <span class="keywordflow">if</span> (Marker_Tag == Monitoring_Tag) {</div>
<div class="line"><a name="l10235"></a><span class="lineno">10235</span>&#160;            Surface_CL_Visc[iMarker_Monitoring]   += CL_Visc[iMarker];</div>
<div class="line"><a name="l10236"></a><span class="lineno">10236</span>&#160;            Surface_CD_Visc[iMarker_Monitoring]   += CD_Visc[iMarker];</div>
<div class="line"><a name="l10237"></a><span class="lineno">10237</span>&#160;            Surface_CSF_Visc[iMarker_Monitoring]  += CSF_Visc[iMarker];</div>
<div class="line"><a name="l10238"></a><span class="lineno">10238</span>&#160;            Surface_CEff_Visc[iMarker_Monitoring] += CEff_Visc[iMarker];</div>
<div class="line"><a name="l10239"></a><span class="lineno">10239</span>&#160;            Surface_CFx_Visc[iMarker_Monitoring]  += CFx_Visc[iMarker];</div>
<div class="line"><a name="l10240"></a><span class="lineno">10240</span>&#160;            Surface_CFy_Visc[iMarker_Monitoring]  += CFy_Visc[iMarker];</div>
<div class="line"><a name="l10241"></a><span class="lineno">10241</span>&#160;            Surface_CFz_Visc[iMarker_Monitoring]  += CFz_Visc[iMarker];</div>
<div class="line"><a name="l10242"></a><span class="lineno">10242</span>&#160;            Surface_CMx_Visc[iMarker_Monitoring]  += CMx_Visc[iMarker];</div>
<div class="line"><a name="l10243"></a><span class="lineno">10243</span>&#160;            Surface_CMy_Visc[iMarker_Monitoring]  += CMy_Visc[iMarker];</div>
<div class="line"><a name="l10244"></a><span class="lineno">10244</span>&#160;            Surface_CMz_Visc[iMarker_Monitoring]  += CMz_Visc[iMarker];</div>
<div class="line"><a name="l10245"></a><span class="lineno">10245</span>&#160;          }</div>
<div class="line"><a name="l10246"></a><span class="lineno">10246</span>&#160;        }</div>
<div class="line"><a name="l10247"></a><span class="lineno">10247</span>&#160;      }</div>
<div class="line"><a name="l10248"></a><span class="lineno">10248</span>&#160;    }</div>
<div class="line"><a name="l10249"></a><span class="lineno">10249</span>&#160;  }</div>
<div class="line"><a name="l10250"></a><span class="lineno">10250</span>&#160; </div>
<div class="line"><a name="l10251"></a><span class="lineno">10251</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l10252"></a><span class="lineno">10252</span>&#160; </div>
<div class="line"><a name="l10253"></a><span class="lineno">10253</span>&#160;  <span class="comment">/*--- Parallel mode. The data from all ranks must be gathered.</span></div>
<div class="line"><a name="l10254"></a><span class="lineno">10254</span>&#160;<span class="comment">        Determine the size of the communication buffer. ---*/</span></div>
<div class="line"><a name="l10255"></a><span class="lineno">10255</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nCommSize = 9*config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>() + 10;</div>
<div class="line"><a name="l10256"></a><span class="lineno">10256</span>&#160; </div>
<div class="line"><a name="l10257"></a><span class="lineno">10257</span>&#160;  <span class="comment">/*--- Define the communication buffers and store to local data in</span></div>
<div class="line"><a name="l10258"></a><span class="lineno">10258</span>&#160;<span class="comment">        the local buffer. ---*/</span></div>
<div class="line"><a name="l10259"></a><span class="lineno">10259</span>&#160;  vector&lt;su2double&gt; locBuf(nCommSize), globBuf(nCommSize);</div>
<div class="line"><a name="l10260"></a><span class="lineno">10260</span>&#160; </div>
<div class="line"><a name="l10261"></a><span class="lineno">10261</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ii = 0;</div>
<div class="line"><a name="l10262"></a><span class="lineno">10262</span>&#160;  locBuf[ii++] = AllBound_CD_Visc;  locBuf[ii++] = AllBound_CL_Visc;</div>
<div class="line"><a name="l10263"></a><span class="lineno">10263</span>&#160;  locBuf[ii++] = AllBound_CSF_Visc; locBuf[ii++] = AllBound_CMx_Visc;</div>
<div class="line"><a name="l10264"></a><span class="lineno">10264</span>&#160;  locBuf[ii++] = AllBound_CMy_Visc; locBuf[ii++] = AllBound_CMz_Visc;</div>
<div class="line"><a name="l10265"></a><span class="lineno">10265</span>&#160;  locBuf[ii++] = AllBound_CFx_Visc; locBuf[ii++] = AllBound_CFy_Visc;</div>
<div class="line"><a name="l10266"></a><span class="lineno">10266</span>&#160;  locBuf[ii++] = AllBound_CFz_Visc; locBuf[ii++] = AllBound_HeatFlux_Visc;</div>
<div class="line"><a name="l10267"></a><span class="lineno">10267</span>&#160; </div>
<div class="line"><a name="l10268"></a><span class="lineno">10268</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>(); ++i) {</div>
<div class="line"><a name="l10269"></a><span class="lineno">10269</span>&#160;    locBuf[ii++] = Surface_CL_Visc[i];  locBuf[ii++] = Surface_CD_Visc[i];</div>
<div class="line"><a name="l10270"></a><span class="lineno">10270</span>&#160;    locBuf[ii++] = Surface_CSF_Visc[i]; locBuf[ii++] = Surface_CFx_Visc[i];</div>
<div class="line"><a name="l10271"></a><span class="lineno">10271</span>&#160;    locBuf[ii++] = Surface_CFy_Visc[i]; locBuf[ii++] = Surface_CFz_Visc[i];</div>
<div class="line"><a name="l10272"></a><span class="lineno">10272</span>&#160;    locBuf[ii++] = Surface_CMx_Visc[i]; locBuf[ii++] = Surface_CMy_Visc[i];</div>
<div class="line"><a name="l10273"></a><span class="lineno">10273</span>&#160;    locBuf[ii++] = Surface_CMz_Visc[i];</div>
<div class="line"><a name="l10274"></a><span class="lineno">10274</span>&#160;  }</div>
<div class="line"><a name="l10275"></a><span class="lineno">10275</span>&#160; </div>
<div class="line"><a name="l10276"></a><span class="lineno">10276</span>&#160;  <span class="comment">/* Sum up all the data from all ranks. The result will be available on all ranks. */</span></div>
<div class="line"><a name="l10277"></a><span class="lineno">10277</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#aa878788c30e1c7c3ed4788e485bd2fb0">GetConsole_Output_Verb</a>() == <a class="code" href="option__structure_8hpp.html#ae40552e21f517bdde7c1a26de77b3e11a686b9a708a0e02450f0b19f485e7e96c">VERB_HIGH</a>) {</div>
<div class="line"><a name="l10278"></a><span class="lineno">10278</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(locBuf.data(), globBuf.data(), nCommSize, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>,</div>
<div class="line"><a name="l10279"></a><span class="lineno">10279</span>&#160;                       <a class="code" href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l10280"></a><span class="lineno">10280</span>&#160;  }</div>
<div class="line"><a name="l10281"></a><span class="lineno">10281</span>&#160; </div>
<div class="line"><a name="l10282"></a><span class="lineno">10282</span>&#160;  <span class="comment">/*--- Copy the data back from globBuf into the required variables. ---*/</span></div>
<div class="line"><a name="l10283"></a><span class="lineno">10283</span>&#160;  ii = 0;</div>
<div class="line"><a name="l10284"></a><span class="lineno">10284</span>&#160;  AllBound_CD_Visc  = globBuf[ii++]; AllBound_CL_Visc       = globBuf[ii++];</div>
<div class="line"><a name="l10285"></a><span class="lineno">10285</span>&#160;  AllBound_CSF_Visc = globBuf[ii++]; AllBound_CMx_Visc      = globBuf[ii++];</div>
<div class="line"><a name="l10286"></a><span class="lineno">10286</span>&#160;  AllBound_CMy_Visc = globBuf[ii++]; AllBound_CMz_Visc      = globBuf[ii++];</div>
<div class="line"><a name="l10287"></a><span class="lineno">10287</span>&#160;  AllBound_CFx_Visc = globBuf[ii++]; AllBound_CFy_Visc      = globBuf[ii++];</div>
<div class="line"><a name="l10288"></a><span class="lineno">10288</span>&#160;  AllBound_CFz_Visc = globBuf[ii++]; AllBound_HeatFlux_Visc = globBuf[ii++];</div>
<div class="line"><a name="l10289"></a><span class="lineno">10289</span>&#160; </div>
<div class="line"><a name="l10290"></a><span class="lineno">10290</span>&#160;  AllBound_CEff_Visc = AllBound_CL_Visc/(AllBound_CD_Visc + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l10291"></a><span class="lineno">10291</span>&#160; </div>
<div class="line"><a name="l10292"></a><span class="lineno">10292</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>(); ++i) {</div>
<div class="line"><a name="l10293"></a><span class="lineno">10293</span>&#160;    Surface_CL_Visc[i]  = globBuf[ii++]; Surface_CD_Visc[i]  = globBuf[ii++];</div>
<div class="line"><a name="l10294"></a><span class="lineno">10294</span>&#160;    Surface_CSF_Visc[i] = globBuf[ii++]; Surface_CFx_Visc[i] = globBuf[ii++];</div>
<div class="line"><a name="l10295"></a><span class="lineno">10295</span>&#160;    Surface_CFy_Visc[i] = globBuf[ii++]; Surface_CFz_Visc[i] = globBuf[ii++];</div>
<div class="line"><a name="l10296"></a><span class="lineno">10296</span>&#160;    Surface_CMx_Visc[i] = globBuf[ii++]; Surface_CMy_Visc[i] = globBuf[ii++];</div>
<div class="line"><a name="l10297"></a><span class="lineno">10297</span>&#160;    Surface_CMz_Visc[i] = globBuf[ii++];</div>
<div class="line"><a name="l10298"></a><span class="lineno">10298</span>&#160; </div>
<div class="line"><a name="l10299"></a><span class="lineno">10299</span>&#160;    Surface_CEff_Visc[i] = Surface_CL_Visc[i]/(Surface_CD_Visc[i] + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l10300"></a><span class="lineno">10300</span>&#160;  }</div>
<div class="line"><a name="l10301"></a><span class="lineno">10301</span>&#160; </div>
<div class="line"><a name="l10302"></a><span class="lineno">10302</span>&#160;  <span class="comment">/* Determine the maximum heat flux over all ranks. */</span></div>
<div class="line"><a name="l10303"></a><span class="lineno">10303</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> localMax = AllBound_MaxHeatFlux_Visc;</div>
<div class="line"><a name="l10304"></a><span class="lineno">10304</span>&#160;  <span class="keywordflow">if</span> (config-&gt;<a class="code" href="class_c_config.html#aa878788c30e1c7c3ed4788e485bd2fb0">GetConsole_Output_Verb</a>() == <a class="code" href="option__structure_8hpp.html#ae40552e21f517bdde7c1a26de77b3e11a686b9a708a0e02450f0b19f485e7e96c">VERB_HIGH</a>) {</div>
<div class="line"><a name="l10305"></a><span class="lineno">10305</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(&amp;localMax, &amp;AllBound_MaxHeatFlux_Visc, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>,</div>
<div class="line"><a name="l10306"></a><span class="lineno">10306</span>&#160;                       <a class="code" href="mpi__structure_8hpp.html#a80d80987b473f4a13b0cc0384eddb51b">MPI_MAX</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l10307"></a><span class="lineno">10307</span>&#160;  }</div>
<div class="line"><a name="l10308"></a><span class="lineno">10308</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l10309"></a><span class="lineno">10309</span>&#160; </div>
<div class="line"><a name="l10310"></a><span class="lineno">10310</span>&#160;  <span class="comment">/*--- Update the total coefficients (note that all the nodes have the same value)---*/</span></div>
<div class="line"><a name="l10311"></a><span class="lineno">10311</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a>   += AllBound_CD_Visc;</div>
<div class="line"><a name="l10312"></a><span class="lineno">10312</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a>   += AllBound_CL_Visc;</div>
<div class="line"><a name="l10313"></a><span class="lineno">10313</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a92b0e3fa2d142ef6ed6c2ac4aafc9c04">Total_CSF</a>  += AllBound_CSF_Visc;</div>
<div class="line"><a name="l10314"></a><span class="lineno">10314</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a973142a08d87ce2338d5c64f7f1e146b">Total_CEff</a>  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a0e61340858f57929e2697e19f730c260">Total_CL</a> / (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad6c3809edcd555e6387d36a6a0b6550d">Total_CD</a> + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l10315"></a><span class="lineno">10315</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af47adcfc34283af5e61df0a69374e912">Total_CMx</a>  += AllBound_CMx_Visc;</div>
<div class="line"><a name="l10316"></a><span class="lineno">10316</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a54b44d56de430143b203dedb967e69d9">Total_CMy</a>  += AllBound_CMy_Visc;</div>
<div class="line"><a name="l10317"></a><span class="lineno">10317</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7924707aed377b385c0cd7019ae1ef71">Total_CMz</a>  += AllBound_CMz_Visc;</div>
<div class="line"><a name="l10318"></a><span class="lineno">10318</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a215f5d64c363a662ee0cb31cbd4f13a1">Total_CFx</a>  += AllBound_CFx_Visc;</div>
<div class="line"><a name="l10319"></a><span class="lineno">10319</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6a9e78792a4e1dd0b5c27501105be895">Total_CFy</a>  += AllBound_CFy_Visc;</div>
<div class="line"><a name="l10320"></a><span class="lineno">10320</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3d32ed98538d3d4c345dd9c3a7d74c28">Total_CFz</a>  += AllBound_CFz_Visc;</div>
<div class="line"><a name="l10321"></a><span class="lineno">10321</span>&#160; </div>
<div class="line"><a name="l10322"></a><span class="lineno">10322</span>&#160;  <span class="comment">/*--- Update the total coefficients per surface (note that all the nodes have the same value)---*/</span></div>
<div class="line"><a name="l10323"></a><span class="lineno">10323</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMarker_Monitoring=0; iMarker_Monitoring&lt;config-&gt;<a class="code" href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">GetnMarker_Monitoring</a>();</div>
<div class="line"><a name="l10324"></a><span class="lineno">10324</span>&#160;                    ++iMarker_Monitoring) {</div>
<div class="line"><a name="l10325"></a><span class="lineno">10325</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a>[iMarker_Monitoring]   += Surface_CL_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l10326"></a><span class="lineno">10326</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a>[iMarker_Monitoring]   += Surface_CD_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l10327"></a><span class="lineno">10327</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2a26031c6fd9824899ecb92125207b60">Surface_CSF</a>[iMarker_Monitoring]  += Surface_CSF_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l10328"></a><span class="lineno">10328</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d84d5e44c469d17b9024f44a93bb2bc">Surface_CEff</a>[iMarker_Monitoring]  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">Surface_CL</a>[iMarker_Monitoring] / (<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f443708e1245051148ad5a009120325">Surface_CD</a>[iMarker_Monitoring] + <a class="code" href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a>);</div>
<div class="line"><a name="l10329"></a><span class="lineno">10329</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3dde950e7512a05dc691db87cd8ca51f">Surface_CFx</a>[iMarker_Monitoring]  += Surface_CFx_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l10330"></a><span class="lineno">10330</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7d7110b59eb940c5e354f2303946dcf2">Surface_CFy</a>[iMarker_Monitoring]  += Surface_CFy_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l10331"></a><span class="lineno">10331</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a50202c322d1794f32fbfe7eff7617c25">Surface_CFz</a>[iMarker_Monitoring]  += Surface_CFz_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l10332"></a><span class="lineno">10332</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa2b0fa39f8b4853f27c537e30681d2c7">Surface_CMx</a>[iMarker_Monitoring]  += Surface_CMx_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l10333"></a><span class="lineno">10333</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a417c1b82a8a8b76d049cd48a796f68f3">Surface_CMy</a>[iMarker_Monitoring]  += Surface_CMy_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l10334"></a><span class="lineno">10334</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">Surface_CMz</a>[iMarker_Monitoring]  += Surface_CMz_Visc[iMarker_Monitoring];</div>
<div class="line"><a name="l10335"></a><span class="lineno">10335</span>&#160;  }</div>
<div class="line"><a name="l10336"></a><span class="lineno">10336</span>&#160;}</div>
<div class="line"><a name="l10337"></a><span class="lineno">10337</span>&#160; </div>
<div class="line"><a name="l10338"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a993de2bb61a532e9d1508bae98dd3a12">10338</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a993de2bb61a532e9d1508bae98dd3a12">CFEM_DG_NSSolver::SetTime_Step</a>(<a class="code" href="class_c_geometry.html">CGeometry</a> *geometry, <a class="code" href="class_c_solver.html">CSolver</a> **solver_container, <a class="code" href="class_c_config.html">CConfig</a> *config,</div>
<div class="line"><a name="l10339"></a><span class="lineno">10339</span>&#160;                                    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iMesh, <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> Iteration) {</div>
<div class="line"><a name="l10340"></a><span class="lineno">10340</span>&#160; </div>
<div class="line"><a name="l10341"></a><span class="lineno">10341</span>&#160;  <span class="comment">/* Check whether or not a time stepping scheme is used. */</span></div>
<div class="line"><a name="l10342"></a><span class="lineno">10342</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> time_stepping = config-&gt;<a class="code" href="class_c_config.html#a45e95664235928d911e7c3876fe078b3">GetUnsteady_Simulation</a>() == <a class="code" href="option__structure_8hpp.html#a67e195cd9919c129a4abecd5dec5d9d0ad914f117053e185f2adaab9780d9a50d">TIME_STEPPING</a>;</div>
<div class="line"><a name="l10343"></a><span class="lineno">10343</span>&#160; </div>
<div class="line"><a name="l10344"></a><span class="lineno">10344</span>&#160;  <span class="comment">/* Allocate the memory for the work array and initialize it to zero to avoid</span></div>
<div class="line"><a name="l10345"></a><span class="lineno">10345</span>&#160;<span class="comment">     warnings in debug mode  about uninitialized memory when padding is applied. */</span></div>
<div class="line"><a name="l10346"></a><span class="lineno">10346</span>&#160;  vector&lt;su2double&gt; workArrayVec(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a95cef33ccbfa61def433d11ddef5745d">sizeWorkArray</a>, 0.0);</div>
<div class="line"><a name="l10347"></a><span class="lineno">10347</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *workArray = workArrayVec.data();</div>
<div class="line"><a name="l10348"></a><span class="lineno">10348</span>&#160; </div>
<div class="line"><a name="l10349"></a><span class="lineno">10349</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector, namely the ratio of</span></div>
<div class="line"><a name="l10350"></a><span class="lineno">10350</span>&#160;<span class="comment">     thermal conductivity and viscosity. */</span></div>
<div class="line"><a name="l10351"></a><span class="lineno">10351</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Lam  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l10352"></a><span class="lineno">10352</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Turb = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l10353"></a><span class="lineno">10353</span>&#160; </div>
<div class="line"><a name="l10354"></a><span class="lineno">10354</span>&#160;  <span class="comment">/* Constant ratio of the second viscosity and the viscosity itself. */</span></div>
<div class="line"><a name="l10355"></a><span class="lineno">10355</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambdaOverMu = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>;</div>
<div class="line"><a name="l10356"></a><span class="lineno">10356</span>&#160; </div>
<div class="line"><a name="l10357"></a><span class="lineno">10357</span>&#160;  <span class="comment">/* The eigenvalues of the viscous Jacobian, scaled by the kinematic viscosity,</span></div>
<div class="line"><a name="l10358"></a><span class="lineno">10358</span>&#160;<span class="comment">     are 1.0, 2.0 + lambdaOverMu and kOverCv/Mu. The last is variable due to the</span></div>
<div class="line"><a name="l10359"></a><span class="lineno">10359</span>&#160;<span class="comment">     possible presence of an eddy viscosity, but the first two are constant and</span></div>
<div class="line"><a name="l10360"></a><span class="lineno">10360</span>&#160;<span class="comment">     the maximum can be determined. */</span></div>
<div class="line"><a name="l10361"></a><span class="lineno">10361</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radOverNuTerm = max(1.0, 2.0+lambdaOverMu);</div>
<div class="line"><a name="l10362"></a><span class="lineno">10362</span>&#160; </div>
<div class="line"><a name="l10363"></a><span class="lineno">10363</span>&#160;  <span class="comment">/* Store the number of metric points per DOF, which depends</span></div>
<div class="line"><a name="l10364"></a><span class="lineno">10364</span>&#160;<span class="comment">     on the number of dimensions. */</span></div>
<div class="line"><a name="l10365"></a><span class="lineno">10365</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> + 1;</div>
<div class="line"><a name="l10366"></a><span class="lineno">10366</span>&#160; </div>
<div class="line"><a name="l10367"></a><span class="lineno">10367</span>&#160;  <span class="comment">/* Determine the number of elements that are treated simultaneously</span></div>
<div class="line"><a name="l10368"></a><span class="lineno">10368</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l10369"></a><span class="lineno">10369</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l10370"></a><span class="lineno">10370</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nElemSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l10371"></a><span class="lineno">10371</span>&#160; </div>
<div class="line"><a name="l10372"></a><span class="lineno">10372</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l10373"></a><span class="lineno">10373</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l10374"></a><span class="lineno">10374</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l10375"></a><span class="lineno">10375</span>&#160; </div>
<div class="line"><a name="l10376"></a><span class="lineno">10376</span>&#160;  <span class="comment">/* Set the number of bytes that must be copied in the memcpy calls. */</span></div>
<div class="line"><a name="l10377"></a><span class="lineno">10377</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l10378"></a><span class="lineno">10378</span>&#160; </div>
<div class="line"><a name="l10379"></a><span class="lineno">10379</span>&#160;  <span class="comment">/* Initialize the minimum and maximum time step. */</span></div>
<div class="line"><a name="l10380"></a><span class="lineno">10380</span>&#160;  <a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a> = 1.e25; <a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a> = 0.0;</div>
<div class="line"><a name="l10381"></a><span class="lineno">10381</span>&#160; </div>
<div class="line"><a name="l10382"></a><span class="lineno">10382</span>&#160;  <span class="comment">/* Easier storage of the CFL number. Note that if we are using explicit</span></div>
<div class="line"><a name="l10383"></a><span class="lineno">10383</span>&#160;<span class="comment">   time stepping, the regular CFL condition has been overwritten with the</span></div>
<div class="line"><a name="l10384"></a><span class="lineno">10384</span>&#160;<span class="comment">   unsteady CFL condition in the config post-processing (if non-zero). */</span></div>
<div class="line"><a name="l10385"></a><span class="lineno">10385</span>&#160; </div>
<div class="line"><a name="l10386"></a><span class="lineno">10386</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> CFL = config-&gt;<a class="code" href="class_c_config.html#a5a509e57de00494a1cb92e011c1c0dbc">GetCFL</a>(iMesh);</div>
<div class="line"><a name="l10387"></a><span class="lineno">10387</span>&#160; </div>
<div class="line"><a name="l10388"></a><span class="lineno">10388</span>&#160;  <span class="comment">/*--- Explicit time stepping with imposed time step (eventually will</span></div>
<div class="line"><a name="l10389"></a><span class="lineno">10389</span>&#160;<span class="comment">   allow for local time stepping with this value imposed as the time</span></div>
<div class="line"><a name="l10390"></a><span class="lineno">10390</span>&#160;<span class="comment">   for syncing the cells). If the unsteady CFL is set to zero (default),</span></div>
<div class="line"><a name="l10391"></a><span class="lineno">10391</span>&#160;<span class="comment">   it uses the defined unsteady time step, otherwise it computes the time</span></div>
<div class="line"><a name="l10392"></a><span class="lineno">10392</span>&#160;<span class="comment">   step based on the provided unsteady CFL. Note that the regular CFL</span></div>
<div class="line"><a name="l10393"></a><span class="lineno">10393</span>&#160;<span class="comment">   option in the config is always ignored with time stepping. ---*/</span></div>
<div class="line"><a name="l10394"></a><span class="lineno">10394</span>&#160;  <span class="keywordflow">if</span> (time_stepping &amp;&amp; (config-&gt;<a class="code" href="class_c_config.html#a19a4294421a26b0562de1677d6b219ef">GetUnst_CFL</a>() == 0.0)) {</div>
<div class="line"><a name="l10395"></a><span class="lineno">10395</span>&#160; </div>
<div class="line"><a name="l10396"></a><span class="lineno">10396</span>&#160;    <span class="comment">/*--- Loop over the owned volume elements and set the fixed dt. ---*/</span></div>
<div class="line"><a name="l10397"></a><span class="lineno">10397</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++l)</div>
<div class="line"><a name="l10398"></a><span class="lineno">10398</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l] = config-&gt;<a class="code" href="class_c_config.html#a417b45d0da107126e803258901f57920">GetDelta_UnstTimeND</a>();</div>
<div class="line"><a name="l10399"></a><span class="lineno">10399</span>&#160; </div>
<div class="line"><a name="l10400"></a><span class="lineno">10400</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10401"></a><span class="lineno">10401</span>&#160; </div>
<div class="line"><a name="l10402"></a><span class="lineno">10402</span>&#160;    <span class="comment">/*--- Check for a compressible solver. ---*/</span></div>
<div class="line"><a name="l10403"></a><span class="lineno">10403</span>&#160;    <span class="keywordflow">if</span>(config-&gt;<a class="code" href="class_c_config.html#a66ca7e620390a81cd49cd0a00716128e">GetKind_Regime</a>() == <a class="code" href="option__structure_8hpp.html#a3d92e0a004752d2ef55cf6c1e2e3d6f0a20621ea72bb142dc0c8bf116a257516a">COMPRESSIBLE</a>) {</div>
<div class="line"><a name="l10404"></a><span class="lineno">10404</span>&#160; </div>
<div class="line"><a name="l10405"></a><span class="lineno">10405</span>&#160;      <span class="comment">/*--- Loop over the owned volume elements. Multiple elements are treated</span></div>
<div class="line"><a name="l10406"></a><span class="lineno">10406</span>&#160;<span class="comment">            simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l10407"></a><span class="lineno">10407</span>&#160;<span class="comment">            multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l10408"></a><span class="lineno">10408</span>&#160;<span class="comment">            happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l10409"></a><span class="lineno">10409</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>;) {</div>
<div class="line"><a name="l10410"></a><span class="lineno">10410</span>&#160; </div>
<div class="line"><a name="l10411"></a><span class="lineno">10411</span>&#160;        <span class="comment">/* Determine the end index for this chunk of elements and the padded</span></div>
<div class="line"><a name="l10412"></a><span class="lineno">10412</span>&#160;<span class="comment">           N value in the gemm computations. */</span></div>
<div class="line"><a name="l10413"></a><span class="lineno">10413</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l10414"></a><span class="lineno">10414</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l10415"></a><span class="lineno">10415</span>&#160; </div>
<div class="line"><a name="l10416"></a><span class="lineno">10416</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>, l, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>, nElemSimul, nPadMin,</div>
<div class="line"><a name="l10417"></a><span class="lineno">10417</span>&#160;                            lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l10418"></a><span class="lineno">10418</span>&#160; </div>
<div class="line"><a name="l10419"></a><span class="lineno">10419</span>&#160;        <span class="comment">/* Get the required data from the corresponding standard element. */</span></div>
<div class="line"><a name="l10420"></a><span class="lineno">10420</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs          = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l10421"></a><span class="lineno">10421</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matDerBasisSolDOFs = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#afaac8e4c875c81435a55a298d20492a7">GetMatDerBasisFunctionsSolDOFs</a>();</div>
<div class="line"><a name="l10422"></a><span class="lineno">10422</span>&#160; </div>
<div class="line"><a name="l10423"></a><span class="lineno">10423</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l10424"></a><span class="lineno">10424</span>&#160;        <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l10425"></a><span class="lineno">10425</span>&#160; </div>
<div class="line"><a name="l10426"></a><span class="lineno">10426</span>&#160;        <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l10427"></a><span class="lineno">10427</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFs     = workArray;</div>
<div class="line"><a name="l10428"></a><span class="lineno">10428</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradSolDOFs = solDOFs + nDOFs*NPad;</div>
<div class="line"><a name="l10429"></a><span class="lineno">10429</span>&#160; </div>
<div class="line"><a name="l10430"></a><span class="lineno">10430</span>&#160;        <span class="comment">/* Determine the offset between the r-derivatives and s-derivatives, which is</span></div>
<div class="line"><a name="l10431"></a><span class="lineno">10431</span>&#160;<span class="comment">           also the offset between s- and t-derivatives, of the solution in the DOFs. */</span></div>
<div class="line"><a name="l10432"></a><span class="lineno">10432</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivSol = NPad*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l10433"></a><span class="lineno">10433</span>&#160; </div>
<div class="line"><a name="l10434"></a><span class="lineno">10434</span>&#160;        <span class="comment">/*--- Compute the gradients of the conserved variables if a subgrid</span></div>
<div class="line"><a name="l10435"></a><span class="lineno">10435</span>&#160;<span class="comment">              scale model for LES is used. ---*/</span></div>
<div class="line"><a name="l10436"></a><span class="lineno">10436</span>&#160;        <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l10437"></a><span class="lineno">10437</span>&#160; </div>
<div class="line"><a name="l10438"></a><span class="lineno">10438</span>&#160;          <span class="comment">/* Copy the solution of the DOFs into solDOFs for this chunk of elements. */</span></div>
<div class="line"><a name="l10439"></a><span class="lineno">10439</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l10440"></a><span class="lineno">10440</span>&#160; </div>
<div class="line"><a name="l10441"></a><span class="lineno">10441</span>&#160;            <span class="comment">/* Easier storage of the solution of this element. */</span></div>
<div class="line"><a name="l10442"></a><span class="lineno">10442</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lInd = l + ll;</div>
<div class="line"><a name="l10443"></a><span class="lineno">10443</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l10444"></a><span class="lineno">10444</span>&#160; </div>
<div class="line"><a name="l10445"></a><span class="lineno">10445</span>&#160;            <span class="comment">/* Loop over the DOFs and copy the data. */</span></div>
<div class="line"><a name="l10446"></a><span class="lineno">10446</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l10447"></a><span class="lineno">10447</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i)</div>
<div class="line"><a name="l10448"></a><span class="lineno">10448</span>&#160;              memcpy(solDOFs+i*NPad+llNVar, sol+i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, nBytes);</div>
<div class="line"><a name="l10449"></a><span class="lineno">10449</span>&#160;          }</div>
<div class="line"><a name="l10450"></a><span class="lineno">10450</span>&#160; </div>
<div class="line"><a name="l10451"></a><span class="lineno">10451</span>&#160;          <span class="comment">/* Call the general function to carry out the matrix product to determine</span></div>
<div class="line"><a name="l10452"></a><span class="lineno">10452</span>&#160;<span class="comment">             the gradients in the DOFs of this chunk of elements. */</span></div>
<div class="line"><a name="l10453"></a><span class="lineno">10453</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisSolDOFs, solDOFs, gradSolDOFs, config);</div>
<div class="line"><a name="l10454"></a><span class="lineno">10454</span>&#160;        }</div>
<div class="line"><a name="l10455"></a><span class="lineno">10455</span>&#160; </div>
<div class="line"><a name="l10456"></a><span class="lineno">10456</span>&#160;        <span class="comment">/*--- Make a distinction between 2D and 3D for optimal performance. ---*/</span></div>
<div class="line"><a name="l10457"></a><span class="lineno">10457</span>&#160;        <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l10458"></a><span class="lineno">10458</span>&#160; </div>
<div class="line"><a name="l10459"></a><span class="lineno">10459</span>&#160;          <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l10460"></a><span class="lineno">10460</span>&#160; </div>
<div class="line"><a name="l10461"></a><span class="lineno">10461</span>&#160;            <span class="comment">/*--- 2D simulation. Loop over the chunk of elements. ---*/</span></div>
<div class="line"><a name="l10462"></a><span class="lineno">10462</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l10463"></a><span class="lineno">10463</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l10464"></a><span class="lineno">10464</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l10465"></a><span class="lineno">10465</span>&#160; </div>
<div class="line"><a name="l10466"></a><span class="lineno">10466</span>&#160;              <span class="comment">/* Compute the length scale of this element and initialize the</span></div>
<div class="line"><a name="l10467"></a><span class="lineno">10467</span>&#160;<span class="comment">                 inviscid and viscous spectral radii to zero. */</span></div>
<div class="line"><a name="l10468"></a><span class="lineno">10468</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScaleInv = nPoly/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>;</div>
<div class="line"><a name="l10469"></a><span class="lineno">10469</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale    = 1.0/lenScaleInv;</div>
<div class="line"><a name="l10470"></a><span class="lineno">10470</span>&#160; </div>
<div class="line"><a name="l10471"></a><span class="lineno">10471</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> charVel2Max = 0.0, radViscMax = 0.0;</div>
<div class="line"><a name="l10472"></a><span class="lineno">10472</span>&#160; </div>
<div class="line"><a name="l10473"></a><span class="lineno">10473</span>&#160;              <span class="comment">/* Loop over the DOFs of the element to determine the time step. */</span></div>
<div class="line"><a name="l10474"></a><span class="lineno">10474</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l10475"></a><span class="lineno">10475</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data()</div>
<div class="line"><a name="l10476"></a><span class="lineno">10476</span>&#160;                                         + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i);</div>
<div class="line"><a name="l10477"></a><span class="lineno">10477</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data()</div>
<div class="line"><a name="l10478"></a><span class="lineno">10478</span>&#160;                                         + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l10479"></a><span class="lineno">10479</span>&#160; </div>
<div class="line"><a name="l10480"></a><span class="lineno">10480</span>&#160;                <span class="comment">/* Compute the velocities and the internal energy per unit mass. */</span></div>
<div class="line"><a name="l10481"></a><span class="lineno">10481</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l10482"></a><span class="lineno">10482</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l10483"></a><span class="lineno">10483</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l10484"></a><span class="lineno">10484</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = DensityInv*solDOF[3] - 0.5*(u*u + v*v);</div>
<div class="line"><a name="l10485"></a><span class="lineno">10485</span>&#160; </div>
<div class="line"><a name="l10486"></a><span class="lineno">10486</span>&#160;                <span class="comment">/*--- Compute the maximum value of the wave speed. This is a rather</span></div>
<div class="line"><a name="l10487"></a><span class="lineno">10487</span>&#160;<span class="comment">                      conservative estimate. ---*/</span></div>
<div class="line"><a name="l10488"></a><span class="lineno">10488</span>&#160;                <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l10489"></a><span class="lineno">10489</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed2 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a8c0910de10905f2ddcf02f1a9bb7ff61">GetSoundSpeed2</a>();</div>
<div class="line"><a name="l10490"></a><span class="lineno">10490</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed  = sqrt(fabs(SoundSpeed2));</div>
<div class="line"><a name="l10491"></a><span class="lineno">10491</span>&#160; </div>
<div class="line"><a name="l10492"></a><span class="lineno">10492</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radx     = fabs(u-gridVel[0]) + SoundSpeed;</div>
<div class="line"><a name="l10493"></a><span class="lineno">10493</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rady     = fabs(v-gridVel[1]) + SoundSpeed;</div>
<div class="line"><a name="l10494"></a><span class="lineno">10494</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> charVel2 = radx*radx + rady*rady;</div>
<div class="line"><a name="l10495"></a><span class="lineno">10495</span>&#160; </div>
<div class="line"><a name="l10496"></a><span class="lineno">10496</span>&#160;                charVel2Max = max(charVel2Max, charVel2);</div>
<div class="line"><a name="l10497"></a><span class="lineno">10497</span>&#160; </div>
<div class="line"><a name="l10498"></a><span class="lineno">10498</span>&#160;                <span class="comment">/* Compute the laminar kinematic viscosity and check if an eddy</span></div>
<div class="line"><a name="l10499"></a><span class="lineno">10499</span>&#160;<span class="comment">                   viscosity must be determined. */</span></div>
<div class="line"><a name="l10500"></a><span class="lineno">10500</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> muLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l10501"></a><span class="lineno">10501</span>&#160;                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> muTurb      = 0.0;</div>
<div class="line"><a name="l10502"></a><span class="lineno">10502</span>&#160; </div>
<div class="line"><a name="l10503"></a><span class="lineno">10503</span>&#160;                <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l10504"></a><span class="lineno">10504</span>&#160; </div>
<div class="line"><a name="l10505"></a><span class="lineno">10505</span>&#160;                  <span class="comment">/* Set the pointers to the locations where the gradients</span></div>
<div class="line"><a name="l10506"></a><span class="lineno">10506</span>&#160;<span class="comment">                     of this DOF start. */</span></div>
<div class="line"><a name="l10507"></a><span class="lineno">10507</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDr = gradSolDOFs + i*NPad + llNVar;</div>
<div class="line"><a name="l10508"></a><span class="lineno">10508</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDs = solDOFDr    + offDerivSol;</div>
<div class="line"><a name="l10509"></a><span class="lineno">10509</span>&#160; </div>
<div class="line"><a name="l10510"></a><span class="lineno">10510</span>&#160;                  <span class="comment">/* Compute the true value of the metric terms in this DOF. Note that in</span></div>
<div class="line"><a name="l10511"></a><span class="lineno">10511</span>&#160;<span class="comment">                     metricTerms the metric terms scaled by the Jacobian are stored. */</span></div>
<div class="line"><a name="l10512"></a><span class="lineno">10512</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#ae6c47cde654970b624c84f026f604a67">metricTermsSolDOFs</a>.data()</div>
<div class="line"><a name="l10513"></a><span class="lineno">10513</span>&#160;                                               + i*nMetricPerPoint;</div>
<div class="line"><a name="l10514"></a><span class="lineno">10514</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> JacInv       = 1.0/metricTerms[0];</div>
<div class="line"><a name="l10515"></a><span class="lineno">10515</span>&#160; </div>
<div class="line"><a name="l10516"></a><span class="lineno">10516</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l10517"></a><span class="lineno">10517</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l10518"></a><span class="lineno">10518</span>&#160; </div>
<div class="line"><a name="l10519"></a><span class="lineno">10519</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = JacInv*metricTerms[3];</div>
<div class="line"><a name="l10520"></a><span class="lineno">10520</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = JacInv*metricTerms[4];</div>
<div class="line"><a name="l10521"></a><span class="lineno">10521</span>&#160; </div>
<div class="line"><a name="l10522"></a><span class="lineno">10522</span>&#160;                  <span class="comment">/*--- Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l10523"></a><span class="lineno">10523</span>&#160;<span class="comment">                        variables from the gradients in parametric coordinates and the metric</span></div>
<div class="line"><a name="l10524"></a><span class="lineno">10524</span>&#160;<span class="comment">                        terms in this DOF. ---*/</span></div>
<div class="line"><a name="l10525"></a><span class="lineno">10525</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx;</div>
<div class="line"><a name="l10526"></a><span class="lineno">10526</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudx  = solDOFDr[1]*drdx + solDOFDs[1]*dsdx;</div>
<div class="line"><a name="l10527"></a><span class="lineno">10527</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdx  = solDOFDr[2]*drdx + solDOFDs[2]*dsdx;</div>
<div class="line"><a name="l10528"></a><span class="lineno">10528</span>&#160; </div>
<div class="line"><a name="l10529"></a><span class="lineno">10529</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy;</div>
<div class="line"><a name="l10530"></a><span class="lineno">10530</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudy  = solDOFDr[1]*drdy + solDOFDs[1]*dsdy;</div>
<div class="line"><a name="l10531"></a><span class="lineno">10531</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdy  = solDOFDr[2]*drdy + solDOFDs[2]*dsdy;</div>
<div class="line"><a name="l10532"></a><span class="lineno">10532</span>&#160; </div>
<div class="line"><a name="l10533"></a><span class="lineno">10533</span>&#160;                  <span class="comment">/*--- Compute the Cartesian gradients of the velocities. ---*/</span></div>
<div class="line"><a name="l10534"></a><span class="lineno">10534</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = DensityInv*(drudx - u*drhodx);</div>
<div class="line"><a name="l10535"></a><span class="lineno">10535</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = DensityInv*(drvdx - v*drhodx);</div>
<div class="line"><a name="l10536"></a><span class="lineno">10536</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = DensityInv*(drudy - u*drhody);</div>
<div class="line"><a name="l10537"></a><span class="lineno">10537</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = DensityInv*(drvdy - v*drhody);</div>
<div class="line"><a name="l10538"></a><span class="lineno">10538</span>&#160; </div>
<div class="line"><a name="l10539"></a><span class="lineno">10539</span>&#160;                  <span class="comment">/* Compute the eddy viscosity. */</span></div>
<div class="line"><a name="l10540"></a><span class="lineno">10540</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dist = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a6adc8d7d1588b7747b8f278fcd73b58f">wallDistanceSolDOFs</a>[i];</div>
<div class="line"><a name="l10541"></a><span class="lineno">10541</span>&#160;                  muTurb = SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#aebef9146565169091059c7b1a0fb926d">ComputeEddyViscosity_2D</a>(solDOF[0], dudx, dudy,</div>
<div class="line"><a name="l10542"></a><span class="lineno">10542</span>&#160;                                                             dvdx, dvdy, lenScale,</div>
<div class="line"><a name="l10543"></a><span class="lineno">10543</span>&#160;                                                             dist);</div>
<div class="line"><a name="l10544"></a><span class="lineno">10544</span>&#160;                }</div>
<div class="line"><a name="l10545"></a><span class="lineno">10545</span>&#160; </div>
<div class="line"><a name="l10546"></a><span class="lineno">10546</span>&#160;                <span class="comment">/*--- Determine the viscous spectral radius. ---*/</span></div>
<div class="line"><a name="l10547"></a><span class="lineno">10547</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> mu           = muLam + muTurb;</div>
<div class="line"><a name="l10548"></a><span class="lineno">10548</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kOverCv      = muLam*factHeatFlux_Lam</div>
<div class="line"><a name="l10549"></a><span class="lineno">10549</span>&#160;                                             + muTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l10550"></a><span class="lineno">10550</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux = kOverCv/mu;</div>
<div class="line"><a name="l10551"></a><span class="lineno">10551</span>&#160; </div>
<div class="line"><a name="l10552"></a><span class="lineno">10552</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radVisc = DensityInv*mu*max(radOverNuTerm, factHeatFlux);</div>
<div class="line"><a name="l10553"></a><span class="lineno">10553</span>&#160; </div>
<div class="line"><a name="l10554"></a><span class="lineno">10554</span>&#160;                <span class="comment">/* Update the maximum value of the viscous spectral radius. */</span></div>
<div class="line"><a name="l10555"></a><span class="lineno">10555</span>&#160;                radViscMax = max(radViscMax, radVisc);</div>
<div class="line"><a name="l10556"></a><span class="lineno">10556</span>&#160;              }</div>
<div class="line"><a name="l10557"></a><span class="lineno">10557</span>&#160; </div>
<div class="line"><a name="l10558"></a><span class="lineno">10558</span>&#160;              <span class="comment">/*--- Compute the time step for the element and update the minimum and</span></div>
<div class="line"><a name="l10559"></a><span class="lineno">10559</span>&#160;<span class="comment">                    maximum value. Take the factor for time accurate local time</span></div>
<div class="line"><a name="l10560"></a><span class="lineno">10560</span>&#160;<span class="comment">                    stepping into account for the minimum and maximum. ---*/</span></div>
<div class="line"><a name="l10561"></a><span class="lineno">10561</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtInv = lenScaleInv*(sqrt(charVel2Max) + radViscMax*lenScaleInv);</div>
<div class="line"><a name="l10562"></a><span class="lineno">10562</span>&#160; </div>
<div class="line"><a name="l10563"></a><span class="lineno">10563</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[lInd] = CFL/dtInv;</div>
<div class="line"><a name="l10564"></a><span class="lineno">10564</span>&#160; </div>
<div class="line"><a name="l10565"></a><span class="lineno">10565</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtEff = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#aa9c40460f4f77c1d43a99e7a77e595ca">factTimeLevel</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[lInd];</div>
<div class="line"><a name="l10566"></a><span class="lineno">10566</span>&#160;              <a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a> = min(<a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>, dtEff);</div>
<div class="line"><a name="l10567"></a><span class="lineno">10567</span>&#160;              <a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a> = max(<a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a>, dtEff);</div>
<div class="line"><a name="l10568"></a><span class="lineno">10568</span>&#160;            }</div>
<div class="line"><a name="l10569"></a><span class="lineno">10569</span>&#160; </div>
<div class="line"><a name="l10570"></a><span class="lineno">10570</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l10571"></a><span class="lineno">10571</span>&#160;          }</div>
<div class="line"><a name="l10572"></a><span class="lineno">10572</span>&#160; </div>
<div class="line"><a name="l10573"></a><span class="lineno">10573</span>&#160;          <span class="comment">/*------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l10574"></a><span class="lineno">10574</span>&#160; </div>
<div class="line"><a name="l10575"></a><span class="lineno">10575</span>&#160;          <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l10576"></a><span class="lineno">10576</span>&#160; </div>
<div class="line"><a name="l10577"></a><span class="lineno">10577</span>&#160;            <span class="comment">/*--- 3D simulation. Loop over the chunk of elements. ---*/</span></div>
<div class="line"><a name="l10578"></a><span class="lineno">10578</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l10579"></a><span class="lineno">10579</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l10580"></a><span class="lineno">10580</span>&#160;              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l10581"></a><span class="lineno">10581</span>&#160; </div>
<div class="line"><a name="l10582"></a><span class="lineno">10582</span>&#160;              <span class="comment">/* Compute the length scale of this element and initialize the</span></div>
<div class="line"><a name="l10583"></a><span class="lineno">10583</span>&#160;<span class="comment">                 inviscid and viscous spectral radii to zero. */</span></div>
<div class="line"><a name="l10584"></a><span class="lineno">10584</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScaleInv = nPoly/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>;</div>
<div class="line"><a name="l10585"></a><span class="lineno">10585</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale    = 1.0/lenScaleInv;</div>
<div class="line"><a name="l10586"></a><span class="lineno">10586</span>&#160; </div>
<div class="line"><a name="l10587"></a><span class="lineno">10587</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> charVel2Max = 0.0, radViscMax = 0.0;</div>
<div class="line"><a name="l10588"></a><span class="lineno">10588</span>&#160; </div>
<div class="line"><a name="l10589"></a><span class="lineno">10589</span>&#160;              <span class="comment">/* Loop over the DOFs of the element to determine the time step. */</span></div>
<div class="line"><a name="l10590"></a><span class="lineno">10590</span>&#160;              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l10591"></a><span class="lineno">10591</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">VecSolDOFs</a>.data()</div>
<div class="line"><a name="l10592"></a><span class="lineno">10592</span>&#160;                                         + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a> + i);</div>
<div class="line"><a name="l10593"></a><span class="lineno">10593</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data()</div>
<div class="line"><a name="l10594"></a><span class="lineno">10594</span>&#160;                                         + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l10595"></a><span class="lineno">10595</span>&#160; </div>
<div class="line"><a name="l10596"></a><span class="lineno">10596</span>&#160;                <span class="comment">/* Compute the velocities and the internal energy per unit mass. */</span></div>
<div class="line"><a name="l10597"></a><span class="lineno">10597</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l10598"></a><span class="lineno">10598</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l10599"></a><span class="lineno">10599</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l10600"></a><span class="lineno">10600</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w            = DensityInv*solDOF[3];</div>
<div class="line"><a name="l10601"></a><span class="lineno">10601</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = DensityInv*solDOF[4] - 0.5*(u*u + v*v + w*w);</div>
<div class="line"><a name="l10602"></a><span class="lineno">10602</span>&#160; </div>
<div class="line"><a name="l10603"></a><span class="lineno">10603</span>&#160;                <span class="comment">/*--- Compute the maximum value of the wave speed. This is a rather</span></div>
<div class="line"><a name="l10604"></a><span class="lineno">10604</span>&#160;<span class="comment">                      conservative estimate. ---*/</span></div>
<div class="line"><a name="l10605"></a><span class="lineno">10605</span>&#160;                <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l10606"></a><span class="lineno">10606</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed2 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a8c0910de10905f2ddcf02f1a9bb7ff61">GetSoundSpeed2</a>();</div>
<div class="line"><a name="l10607"></a><span class="lineno">10607</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> SoundSpeed  = sqrt(fabs(SoundSpeed2));</div>
<div class="line"><a name="l10608"></a><span class="lineno">10608</span>&#160; </div>
<div class="line"><a name="l10609"></a><span class="lineno">10609</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radx     = fabs(u-gridVel[0]) + SoundSpeed;</div>
<div class="line"><a name="l10610"></a><span class="lineno">10610</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rady     = fabs(v-gridVel[1]) + SoundSpeed;</div>
<div class="line"><a name="l10611"></a><span class="lineno">10611</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radz     = fabs(w-gridVel[2]) + SoundSpeed;</div>
<div class="line"><a name="l10612"></a><span class="lineno">10612</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> charVel2 = radx*radx + rady*rady + radz*radz;</div>
<div class="line"><a name="l10613"></a><span class="lineno">10613</span>&#160; </div>
<div class="line"><a name="l10614"></a><span class="lineno">10614</span>&#160;                charVel2Max = max(charVel2Max, charVel2);</div>
<div class="line"><a name="l10615"></a><span class="lineno">10615</span>&#160; </div>
<div class="line"><a name="l10616"></a><span class="lineno">10616</span>&#160;                <span class="comment">/* Compute the laminar kinematic viscosity and check if an eddy</span></div>
<div class="line"><a name="l10617"></a><span class="lineno">10617</span>&#160;<span class="comment">                   viscosity must be determined. */</span></div>
<div class="line"><a name="l10618"></a><span class="lineno">10618</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> muLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l10619"></a><span class="lineno">10619</span>&#160;                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> muTurb      = 0.0;</div>
<div class="line"><a name="l10620"></a><span class="lineno">10620</span>&#160; </div>
<div class="line"><a name="l10621"></a><span class="lineno">10621</span>&#160;                <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l10622"></a><span class="lineno">10622</span>&#160; </div>
<div class="line"><a name="l10623"></a><span class="lineno">10623</span>&#160;                  <span class="comment">/* Set the pointers to the locations where the gradients</span></div>
<div class="line"><a name="l10624"></a><span class="lineno">10624</span>&#160;<span class="comment">                     of this DOF start. */</span></div>
<div class="line"><a name="l10625"></a><span class="lineno">10625</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDr = gradSolDOFs + i*NPad + llNVar;</div>
<div class="line"><a name="l10626"></a><span class="lineno">10626</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDs = solDOFDr    + offDerivSol;</div>
<div class="line"><a name="l10627"></a><span class="lineno">10627</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDt = solDOFDs    + offDerivSol;</div>
<div class="line"><a name="l10628"></a><span class="lineno">10628</span>&#160; </div>
<div class="line"><a name="l10629"></a><span class="lineno">10629</span>&#160;                  <span class="comment">/* Compute the true value of the metric terms in this DOF. Note that in</span></div>
<div class="line"><a name="l10630"></a><span class="lineno">10630</span>&#160;<span class="comment">                     metricTerms the metric terms scaled by the Jacobian are stored. */</span></div>
<div class="line"><a name="l10631"></a><span class="lineno">10631</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#ae6c47cde654970b624c84f026f604a67">metricTermsSolDOFs</a>.data()</div>
<div class="line"><a name="l10632"></a><span class="lineno">10632</span>&#160;                                               + i*nMetricPerPoint;</div>
<div class="line"><a name="l10633"></a><span class="lineno">10633</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> JacInv       = 1.0/metricTerms[0];</div>
<div class="line"><a name="l10634"></a><span class="lineno">10634</span>&#160; </div>
<div class="line"><a name="l10635"></a><span class="lineno">10635</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l10636"></a><span class="lineno">10636</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l10637"></a><span class="lineno">10637</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdz = JacInv*metricTerms[3];</div>
<div class="line"><a name="l10638"></a><span class="lineno">10638</span>&#160; </div>
<div class="line"><a name="l10639"></a><span class="lineno">10639</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = JacInv*metricTerms[4];</div>
<div class="line"><a name="l10640"></a><span class="lineno">10640</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = JacInv*metricTerms[5];</div>
<div class="line"><a name="l10641"></a><span class="lineno">10641</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdz = JacInv*metricTerms[6];</div>
<div class="line"><a name="l10642"></a><span class="lineno">10642</span>&#160; </div>
<div class="line"><a name="l10643"></a><span class="lineno">10643</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdx = JacInv*metricTerms[7];</div>
<div class="line"><a name="l10644"></a><span class="lineno">10644</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdy = JacInv*metricTerms[8];</div>
<div class="line"><a name="l10645"></a><span class="lineno">10645</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdz = JacInv*metricTerms[9];</div>
<div class="line"><a name="l10646"></a><span class="lineno">10646</span>&#160; </div>
<div class="line"><a name="l10647"></a><span class="lineno">10647</span>&#160;                  <span class="comment">/*--- Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l10648"></a><span class="lineno">10648</span>&#160;<span class="comment">                        variables from the gradients in parametric coordinates and the metric</span></div>
<div class="line"><a name="l10649"></a><span class="lineno">10649</span>&#160;<span class="comment">                        terms in this DOF. ---*/</span></div>
<div class="line"><a name="l10650"></a><span class="lineno">10650</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx + solDOFDt[0]*dtdx;</div>
<div class="line"><a name="l10651"></a><span class="lineno">10651</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drux   = solDOFDr[1]*drdx + solDOFDs[1]*dsdx + solDOFDt[1]*dtdx;</div>
<div class="line"><a name="l10652"></a><span class="lineno">10652</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvx   = solDOFDr[2]*drdx + solDOFDs[2]*dsdx + solDOFDt[2]*dtdx;</div>
<div class="line"><a name="l10653"></a><span class="lineno">10653</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwx   = solDOFDr[3]*drdx + solDOFDs[3]*dsdx + solDOFDt[3]*dtdx;</div>
<div class="line"><a name="l10654"></a><span class="lineno">10654</span>&#160; </div>
<div class="line"><a name="l10655"></a><span class="lineno">10655</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy + solDOFDt[0]*dtdy;</div>
<div class="line"><a name="l10656"></a><span class="lineno">10656</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> druy   = solDOFDr[1]*drdy + solDOFDs[1]*dsdy + solDOFDt[1]*dtdy;</div>
<div class="line"><a name="l10657"></a><span class="lineno">10657</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvy   = solDOFDr[2]*drdy + solDOFDs[2]*dsdy + solDOFDt[2]*dtdy;</div>
<div class="line"><a name="l10658"></a><span class="lineno">10658</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwy   = solDOFDr[3]*drdy + solDOFDs[3]*dsdy + solDOFDt[3]*dtdy;</div>
<div class="line"><a name="l10659"></a><span class="lineno">10659</span>&#160; </div>
<div class="line"><a name="l10660"></a><span class="lineno">10660</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodz = solDOFDr[0]*drdz + solDOFDs[0]*dsdz + solDOFDt[0]*dtdz;</div>
<div class="line"><a name="l10661"></a><span class="lineno">10661</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> druz   = solDOFDr[1]*drdz + solDOFDs[1]*dsdz + solDOFDt[1]*dtdz;</div>
<div class="line"><a name="l10662"></a><span class="lineno">10662</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvz   = solDOFDr[2]*drdz + solDOFDs[2]*dsdz + solDOFDt[2]*dtdz;</div>
<div class="line"><a name="l10663"></a><span class="lineno">10663</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwz   = solDOFDr[3]*drdz + solDOFDs[3]*dsdz + solDOFDt[3]*dtdz;</div>
<div class="line"><a name="l10664"></a><span class="lineno">10664</span>&#160; </div>
<div class="line"><a name="l10665"></a><span class="lineno">10665</span>&#160;                  <span class="comment">/*--- Compute the Cartesian gradients of the velocities. ---*/</span></div>
<div class="line"><a name="l10666"></a><span class="lineno">10666</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = DensityInv*(drux - u*drhodx);</div>
<div class="line"><a name="l10667"></a><span class="lineno">10667</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = DensityInv*(druy - u*drhody);</div>
<div class="line"><a name="l10668"></a><span class="lineno">10668</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudz = DensityInv*(druz - u*drhodz);</div>
<div class="line"><a name="l10669"></a><span class="lineno">10669</span>&#160; </div>
<div class="line"><a name="l10670"></a><span class="lineno">10670</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = DensityInv*(drvx - v*drhodx);</div>
<div class="line"><a name="l10671"></a><span class="lineno">10671</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = DensityInv*(drvy - v*drhody);</div>
<div class="line"><a name="l10672"></a><span class="lineno">10672</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdz = DensityInv*(drvz - v*drhodz);</div>
<div class="line"><a name="l10673"></a><span class="lineno">10673</span>&#160; </div>
<div class="line"><a name="l10674"></a><span class="lineno">10674</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdx = DensityInv*(drwx - w*drhodx);</div>
<div class="line"><a name="l10675"></a><span class="lineno">10675</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdy = DensityInv*(drwy - w*drhody);</div>
<div class="line"><a name="l10676"></a><span class="lineno">10676</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdz = DensityInv*(drwz - w*drhodz);</div>
<div class="line"><a name="l10677"></a><span class="lineno">10677</span>&#160; </div>
<div class="line"><a name="l10678"></a><span class="lineno">10678</span>&#160;                  <span class="comment">/* Compute the eddy viscosity. */</span></div>
<div class="line"><a name="l10679"></a><span class="lineno">10679</span>&#160;                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dist = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a6adc8d7d1588b7747b8f278fcd73b58f">wallDistanceSolDOFs</a>[i];</div>
<div class="line"><a name="l10680"></a><span class="lineno">10680</span>&#160;                  muTurb = SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#a6017e86477c7d39b542d82a3b2b9f1cd">ComputeEddyViscosity_3D</a>(solDOF[0], dudx, dudy, dudz,</div>
<div class="line"><a name="l10681"></a><span class="lineno">10681</span>&#160;                                                             dvdx, dvdy, dvdz, dwdx, dwdy,</div>
<div class="line"><a name="l10682"></a><span class="lineno">10682</span>&#160;                                                             dwdz, lenScale, dist);</div>
<div class="line"><a name="l10683"></a><span class="lineno">10683</span>&#160;                }</div>
<div class="line"><a name="l10684"></a><span class="lineno">10684</span>&#160; </div>
<div class="line"><a name="l10685"></a><span class="lineno">10685</span>&#160;                <span class="comment">/*--- Determine the viscous spectral radius. ---*/</span></div>
<div class="line"><a name="l10686"></a><span class="lineno">10686</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> mu           = muLam + muTurb;</div>
<div class="line"><a name="l10687"></a><span class="lineno">10687</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kOverCv      = muLam*factHeatFlux_Lam</div>
<div class="line"><a name="l10688"></a><span class="lineno">10688</span>&#160;                                             + muTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l10689"></a><span class="lineno">10689</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux = kOverCv/mu;</div>
<div class="line"><a name="l10690"></a><span class="lineno">10690</span>&#160; </div>
<div class="line"><a name="l10691"></a><span class="lineno">10691</span>&#160;                <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radVisc = DensityInv*mu*max(radOverNuTerm, factHeatFlux);</div>
<div class="line"><a name="l10692"></a><span class="lineno">10692</span>&#160; </div>
<div class="line"><a name="l10693"></a><span class="lineno">10693</span>&#160;                <span class="comment">/* Update the maximum value of the viscous spectral radius. */</span></div>
<div class="line"><a name="l10694"></a><span class="lineno">10694</span>&#160;                radViscMax = max(radViscMax, radVisc);</div>
<div class="line"><a name="l10695"></a><span class="lineno">10695</span>&#160;              }</div>
<div class="line"><a name="l10696"></a><span class="lineno">10696</span>&#160; </div>
<div class="line"><a name="l10697"></a><span class="lineno">10697</span>&#160;              <span class="comment">/*--- Compute the time step for the element and update the minimum and</span></div>
<div class="line"><a name="l10698"></a><span class="lineno">10698</span>&#160;<span class="comment">                    maximum value. Take the factor for time accurate local time</span></div>
<div class="line"><a name="l10699"></a><span class="lineno">10699</span>&#160;<span class="comment">                    stepping into account for the minimum and maximum. ---*/</span></div>
<div class="line"><a name="l10700"></a><span class="lineno">10700</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtInv = lenScaleInv*(sqrt(charVel2Max) + radViscMax*lenScaleInv);</div>
<div class="line"><a name="l10701"></a><span class="lineno">10701</span>&#160; </div>
<div class="line"><a name="l10702"></a><span class="lineno">10702</span>&#160;              <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[lInd] = CFL/dtInv;</div>
<div class="line"><a name="l10703"></a><span class="lineno">10703</span>&#160; </div>
<div class="line"><a name="l10704"></a><span class="lineno">10704</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtEff = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#aa9c40460f4f77c1d43a99e7a77e595ca">factTimeLevel</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[lInd];</div>
<div class="line"><a name="l10705"></a><span class="lineno">10705</span>&#160;              <a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a> = min(<a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>, dtEff);</div>
<div class="line"><a name="l10706"></a><span class="lineno">10706</span>&#160;              <a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a> = max(<a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a>, dtEff);</div>
<div class="line"><a name="l10707"></a><span class="lineno">10707</span>&#160;            }</div>
<div class="line"><a name="l10708"></a><span class="lineno">10708</span>&#160; </div>
<div class="line"><a name="l10709"></a><span class="lineno">10709</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l10710"></a><span class="lineno">10710</span>&#160;          }</div>
<div class="line"><a name="l10711"></a><span class="lineno">10711</span>&#160;        }</div>
<div class="line"><a name="l10712"></a><span class="lineno">10712</span>&#160; </div>
<div class="line"><a name="l10713"></a><span class="lineno">10713</span>&#160;        <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l10714"></a><span class="lineno">10714</span>&#160;<span class="comment">           current chunk. */</span></div>
<div class="line"><a name="l10715"></a><span class="lineno">10715</span>&#160;        l = lEnd;</div>
<div class="line"><a name="l10716"></a><span class="lineno">10716</span>&#160;      }</div>
<div class="line"><a name="l10717"></a><span class="lineno">10717</span>&#160;    }</div>
<div class="line"><a name="l10718"></a><span class="lineno">10718</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l10719"></a><span class="lineno">10719</span>&#160; </div>
<div class="line"><a name="l10720"></a><span class="lineno">10720</span>&#160;      <span class="comment">/*--- Incompressible solver. ---*/</span></div>
<div class="line"><a name="l10721"></a><span class="lineno">10721</span>&#160; </div>
<div class="line"><a name="l10722"></a><span class="lineno">10722</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;Incompressible solver not implemented yet&quot;</span>, <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l10723"></a><span class="lineno">10723</span>&#160;    }</div>
<div class="line"><a name="l10724"></a><span class="lineno">10724</span>&#160; </div>
<div class="line"><a name="l10725"></a><span class="lineno">10725</span>&#160;    <span class="comment">/*--- Compute the max and the min dt (in parallel). Note that we only</span></div>
<div class="line"><a name="l10726"></a><span class="lineno">10726</span>&#160;<span class="comment">     do this for steady calculations if the high verbosity is set, but we</span></div>
<div class="line"><a name="l10727"></a><span class="lineno">10727</span>&#160;<span class="comment">     always perform the reduction for unsteady calculations where the CFL</span></div>
<div class="line"><a name="l10728"></a><span class="lineno">10728</span>&#160;<span class="comment">     limit is used to set the global time step. ---*/</span></div>
<div class="line"><a name="l10729"></a><span class="lineno">10729</span>&#160;    <span class="keywordflow">if</span> ((config-&gt;<a class="code" href="class_c_config.html#aa878788c30e1c7c3ed4788e485bd2fb0">GetConsole_Output_Verb</a>() == <a class="code" href="option__structure_8hpp.html#ae40552e21f517bdde7c1a26de77b3e11a686b9a708a0e02450f0b19f485e7e96c">VERB_HIGH</a>) || time_stepping) {</div>
<div class="line"><a name="l10730"></a><span class="lineno">10730</span>&#160;<span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><a name="l10731"></a><span class="lineno">10731</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rbuf_time = <a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>;</div>
<div class="line"><a name="l10732"></a><span class="lineno">10732</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(&amp;rbuf_time, &amp;<a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#aa2fecfa16d35e8fa3894c512a527b73f">MPI_MIN</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l10733"></a><span class="lineno">10733</span>&#160; </div>
<div class="line"><a name="l10734"></a><span class="lineno">10734</span>&#160;      rbuf_time = <a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a>;</div>
<div class="line"><a name="l10735"></a><span class="lineno">10735</span>&#160;      <a class="code" href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">SU2_MPI::Allreduce</a>(&amp;rbuf_time, &amp;<a class="code" href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">Max_Delta_Time</a>, 1, <a class="code" href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a>, <a class="code" href="mpi__structure_8hpp.html#a80d80987b473f4a13b0cc0384eddb51b">MPI_MAX</a>, <a class="code" href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a>);</div>
<div class="line"><a name="l10736"></a><span class="lineno">10736</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l10737"></a><span class="lineno">10737</span>&#160;    }</div>
<div class="line"><a name="l10738"></a><span class="lineno">10738</span>&#160; </div>
<div class="line"><a name="l10739"></a><span class="lineno">10739</span>&#160;    <span class="comment">/*--- For explicit time stepping with an unsteady CFL imposed, use the</span></div>
<div class="line"><a name="l10740"></a><span class="lineno">10740</span>&#160;<span class="comment">          minimum delta time of the entire mesh. As Min_Delta_Time is scaled to</span></div>
<div class="line"><a name="l10741"></a><span class="lineno">10741</span>&#160;<span class="comment">          the time step of the largest time level, a correction must be used</span></div>
<div class="line"><a name="l10742"></a><span class="lineno">10742</span>&#160;<span class="comment">          for the time level when time accurate local time stepping is used. ---*/</span></div>
<div class="line"><a name="l10743"></a><span class="lineno">10743</span>&#160;    <span class="keywordflow">if</span> (time_stepping) {</div>
<div class="line"><a name="l10744"></a><span class="lineno">10744</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=0; l&lt;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">nVolElemOwned</a>; ++l)</div>
<div class="line"><a name="l10745"></a><span class="lineno">10745</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">VecDeltaTime</a>[l] = <a class="code" href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">Min_Delta_Time</a>/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].factTimeLevel;</div>
<div class="line"><a name="l10746"></a><span class="lineno">10746</span>&#160;    }</div>
<div class="line"><a name="l10747"></a><span class="lineno">10747</span>&#160;  }</div>
<div class="line"><a name="l10748"></a><span class="lineno">10748</span>&#160;}</div>
<div class="line"><a name="l10749"></a><span class="lineno">10749</span>&#160; </div>
<div class="line"><a name="l10750"></a><span class="lineno">10750</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ADER_DG_AliasedPredictorResidual_2D(<a class="code" href="class_c_config.html">CConfig</a>              *config,</div>
<div class="line"><a name="l10751"></a><span class="lineno">10751</span>&#160;                                                           <a class="code" href="class_c_volume_element_f_e_m.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l10752"></a><span class="lineno">10752</span>&#160;                                                           <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *sol,</div>
<div class="line"><a name="l10753"></a><span class="lineno">10753</span>&#160;                                                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l10754"></a><span class="lineno">10754</span>&#160;                                                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l10755"></a><span class="lineno">10755</span>&#160;                                                           <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *res,</div>
<div class="line"><a name="l10756"></a><span class="lineno">10756</span>&#160;                                                           <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *work) {</div>
<div class="line"><a name="l10757"></a><span class="lineno">10757</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector. */</span></div>
<div class="line"><a name="l10758"></a><span class="lineno">10758</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Lam  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l10759"></a><span class="lineno">10759</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Turb = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l10760"></a><span class="lineno">10760</span>&#160; </div>
<div class="line"><a name="l10761"></a><span class="lineno">10761</span>&#160;  <span class="comment">/* Get the necessary information from the standard element. */</span></div>
<div class="line"><a name="l10762"></a><span class="lineno">10762</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l10763"></a><span class="lineno">10763</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l10764"></a><span class="lineno">10764</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l10765"></a><span class="lineno">10765</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisInt            = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a6fbf928e9b9fa2fd9dab46309e0ed6b6">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l10766"></a><span class="lineno">10766</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matDerBasisInt         = matBasisInt + nDOFs*nInt;</div>
<div class="line"><a name="l10767"></a><span class="lineno">10767</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matDerBasisSolDOFs     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#afaac8e4c875c81435a55a298d20492a7">GetMatDerBasisFunctionsSolDOFs</a>();</div>
<div class="line"><a name="l10768"></a><span class="lineno">10768</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFunctionsIntTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0d8111ae54b825086ea24a9241a361f1">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l10769"></a><span class="lineno">10769</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights                = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l10770"></a><span class="lineno">10770</span>&#160; </div>
<div class="line"><a name="l10771"></a><span class="lineno">10771</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l10772"></a><span class="lineno">10772</span>&#160;  <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l10773"></a><span class="lineno">10773</span>&#160; </div>
<div class="line"><a name="l10774"></a><span class="lineno">10774</span>&#160;  <span class="comment">/* Compute the length scale of the current element for the LES. */</span></div>
<div class="line"><a name="l10775"></a><span class="lineno">10775</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l10776"></a><span class="lineno">10776</span>&#160; </div>
<div class="line"><a name="l10777"></a><span class="lineno">10777</span>&#160;  <span class="comment">/* Set the pointers for fluxes in the DOFs, the gradient of the fluxes in</span></div>
<div class="line"><a name="l10778"></a><span class="lineno">10778</span>&#160;<span class="comment">     the integration points, the gradient of the solution in the DOFs and the</span></div>
<div class="line"><a name="l10779"></a><span class="lineno">10779</span>&#160;<span class="comment">     divergence of the fluxes in the integration points. Note that some pointers</span></div>
<div class="line"><a name="l10780"></a><span class="lineno">10780</span>&#160;<span class="comment">     point to the same physical location. This is because this memory can be</span></div>
<div class="line"><a name="l10781"></a><span class="lineno">10781</span>&#160;<span class="comment">     used for different purposes. */</span></div>
<div class="line"><a name="l10782"></a><span class="lineno">10782</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxXDOF     = work;</div>
<div class="line"><a name="l10783"></a><span class="lineno">10783</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxYDOF     = fluxXDOF + NPad*nDOFs;</div>
<div class="line"><a name="l10784"></a><span class="lineno">10784</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXInt = fluxYDOF + NPad*nDOFs;</div>
<div class="line"><a name="l10785"></a><span class="lineno">10785</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYInt = gradFluxXInt + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad*nInt;</div>
<div class="line"><a name="l10786"></a><span class="lineno">10786</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradSolDOFs  = gradFluxXInt;</div>
<div class="line"><a name="l10787"></a><span class="lineno">10787</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFlux      = work;</div>
<div class="line"><a name="l10788"></a><span class="lineno">10788</span>&#160; </div>
<div class="line"><a name="l10789"></a><span class="lineno">10789</span>&#160;  <span class="comment">/* Determine the offset between the r-derivatives and s-derivatives of the</span></div>
<div class="line"><a name="l10790"></a><span class="lineno">10790</span>&#160;<span class="comment">     fluxes in the integration points and the offset between the r-derivatives</span></div>
<div class="line"><a name="l10791"></a><span class="lineno">10791</span>&#160;<span class="comment">     and s-derivatives of the solution in the DOFs. */</span></div>
<div class="line"><a name="l10792"></a><span class="lineno">10792</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivSol    = NPad*nDOFs;</div>
<div class="line"><a name="l10793"></a><span class="lineno">10793</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivFluxes = NPad*nInt;</div>
<div class="line"><a name="l10794"></a><span class="lineno">10794</span>&#160; </div>
<div class="line"><a name="l10795"></a><span class="lineno">10795</span>&#160;  <span class="comment">/* Store the number of metric points per integration point for readability. */</span></div>
<div class="line"><a name="l10796"></a><span class="lineno">10796</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 5;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l10797"></a><span class="lineno">10797</span>&#160; </div>
<div class="line"><a name="l10798"></a><span class="lineno">10798</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l10799"></a><span class="lineno">10799</span>&#160;  <span class="comment">/*---          Construct the Cartesian fluxes in the DOFs.               ---*/</span></div>
<div class="line"><a name="l10800"></a><span class="lineno">10800</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l10801"></a><span class="lineno">10801</span>&#160; </div>
<div class="line"><a name="l10802"></a><span class="lineno">10802</span>&#160;  <span class="comment">/* Compute the derivatives of the solution variables w.r.t. the parametric</span></div>
<div class="line"><a name="l10803"></a><span class="lineno">10803</span>&#160;<span class="comment">     coordinates in the DOFs. */</span></div>
<div class="line"><a name="l10804"></a><span class="lineno">10804</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisSolDOFs, sol, gradSolDOFs, config);</div>
<div class="line"><a name="l10805"></a><span class="lineno">10805</span>&#160; </div>
<div class="line"><a name="l10806"></a><span class="lineno">10806</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l10807"></a><span class="lineno">10807</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l10808"></a><span class="lineno">10808</span>&#160; </div>
<div class="line"><a name="l10809"></a><span class="lineno">10809</span>&#160;    <span class="comment">/*--- Loop over the DOFs to compute the Cartesian fluxes in the DOFs. ---*/</span></div>
<div class="line"><a name="l10810"></a><span class="lineno">10810</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l10811"></a><span class="lineno">10811</span>&#160; </div>
<div class="line"><a name="l10812"></a><span class="lineno">10812</span>&#160;      <span class="comment">/* Set the pointers for the solution, its gradients and the fluxes</span></div>
<div class="line"><a name="l10813"></a><span class="lineno">10813</span>&#160;<span class="comment">         for this DOF. */</span></div>
<div class="line"><a name="l10814"></a><span class="lineno">10814</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDOF = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l10815"></a><span class="lineno">10815</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF     = sol         + offDOF;</div>
<div class="line"><a name="l10816"></a><span class="lineno">10816</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDr   = gradSolDOFs + offDOF;</div>
<div class="line"><a name="l10817"></a><span class="lineno">10817</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDs   = solDOFDr    + offDerivSol;</div>
<div class="line"><a name="l10818"></a><span class="lineno">10818</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxX            = fluxXDOF    + offDOF;</div>
<div class="line"><a name="l10819"></a><span class="lineno">10819</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxY            = fluxYDOF    + offDOF;</div>
<div class="line"><a name="l10820"></a><span class="lineno">10820</span>&#160; </div>
<div class="line"><a name="l10821"></a><span class="lineno">10821</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities at the location of the</span></div>
<div class="line"><a name="l10822"></a><span class="lineno">10822</span>&#160;<span class="comment">         solution DOFS. THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL</span></div>
<div class="line"><a name="l10823"></a><span class="lineno">10823</span>&#160;<span class="comment">         MOTION IS SPECIFIED, THE DATA FOR THIS DOF FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l10824"></a><span class="lineno">10824</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l10825"></a><span class="lineno">10825</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data() + 2*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l10826"></a><span class="lineno">10826</span>&#160; </div>
<div class="line"><a name="l10827"></a><span class="lineno">10827</span>&#160;      <span class="comment">/* Compute the true value of the metric terms in this DOF. Note that in</span></div>
<div class="line"><a name="l10828"></a><span class="lineno">10828</span>&#160;<span class="comment">         metricTerms the metric terms scaled by the Jacobian are stored. THIS</span></div>
<div class="line"><a name="l10829"></a><span class="lineno">10829</span>&#160;<span class="comment">         IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED, THE</span></div>
<div class="line"><a name="l10830"></a><span class="lineno">10830</span>&#160;<span class="comment">         DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l10831"></a><span class="lineno">10831</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#ae6c47cde654970b624c84f026f604a67">metricTermsSolDOFs</a>.data()</div>
<div class="line"><a name="l10832"></a><span class="lineno">10832</span>&#160;                                   + i*nMetricPerPoint;</div>
<div class="line"><a name="l10833"></a><span class="lineno">10833</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> JacInv       = 1.0/metricTerms[0];</div>
<div class="line"><a name="l10834"></a><span class="lineno">10834</span>&#160; </div>
<div class="line"><a name="l10835"></a><span class="lineno">10835</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l10836"></a><span class="lineno">10836</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l10837"></a><span class="lineno">10837</span>&#160; </div>
<div class="line"><a name="l10838"></a><span class="lineno">10838</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = JacInv*metricTerms[3];</div>
<div class="line"><a name="l10839"></a><span class="lineno">10839</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = JacInv*metricTerms[4];</div>
<div class="line"><a name="l10840"></a><span class="lineno">10840</span>&#160; </div>
<div class="line"><a name="l10841"></a><span class="lineno">10841</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the independent solution variables</span></div>
<div class="line"><a name="l10842"></a><span class="lineno">10842</span>&#160;<span class="comment">         from the gradients in parametric coordinates and the metric terms. */</span></div>
<div class="line"><a name="l10843"></a><span class="lineno">10843</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx;</div>
<div class="line"><a name="l10844"></a><span class="lineno">10844</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudx  = solDOFDr[1]*drdx + solDOFDs[1]*dsdx;</div>
<div class="line"><a name="l10845"></a><span class="lineno">10845</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdx  = solDOFDr[2]*drdx + solDOFDs[2]*dsdx;</div>
<div class="line"><a name="l10846"></a><span class="lineno">10846</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdx  = solDOFDr[3]*drdx + solDOFDs[3]*dsdx;</div>
<div class="line"><a name="l10847"></a><span class="lineno">10847</span>&#160; </div>
<div class="line"><a name="l10848"></a><span class="lineno">10848</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy;</div>
<div class="line"><a name="l10849"></a><span class="lineno">10849</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudy  = solDOFDr[1]*drdy + solDOFDs[1]*dsdy;</div>
<div class="line"><a name="l10850"></a><span class="lineno">10850</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdy  = solDOFDr[2]*drdy + solDOFDs[2]*dsdy;</div>
<div class="line"><a name="l10851"></a><span class="lineno">10851</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdy  = solDOFDr[3]*drdy + solDOFDs[3]*dsdy;</div>
<div class="line"><a name="l10852"></a><span class="lineno">10852</span>&#160; </div>
<div class="line"><a name="l10853"></a><span class="lineno">10853</span>&#160;      <span class="comment">/* Compute the velocities, pressure and laminar viscosity in this DOF. */</span></div>
<div class="line"><a name="l10854"></a><span class="lineno">10854</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l10855"></a><span class="lineno">10855</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l10856"></a><span class="lineno">10856</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l10857"></a><span class="lineno">10857</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = DensityInv*solDOF[3];</div>
<div class="line"><a name="l10858"></a><span class="lineno">10858</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - 0.5*(u*u + v*v);</div>
<div class="line"><a name="l10859"></a><span class="lineno">10859</span>&#160; </div>
<div class="line"><a name="l10860"></a><span class="lineno">10860</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l10861"></a><span class="lineno">10861</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l10862"></a><span class="lineno">10862</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l10863"></a><span class="lineno">10863</span>&#160; </div>
<div class="line"><a name="l10864"></a><span class="lineno">10864</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the velocities and static energy. */</span></div>
<div class="line"><a name="l10865"></a><span class="lineno">10865</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = DensityInv*(drudx - u*drhodx);</div>
<div class="line"><a name="l10866"></a><span class="lineno">10866</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = DensityInv*(drvdx - v*drhodx);</div>
<div class="line"><a name="l10867"></a><span class="lineno">10867</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = DensityInv*(drudy - u*drhody);</div>
<div class="line"><a name="l10868"></a><span class="lineno">10868</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = DensityInv*(drvdy - v*drhody);</div>
<div class="line"><a name="l10869"></a><span class="lineno">10869</span>&#160; </div>
<div class="line"><a name="l10870"></a><span class="lineno">10870</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dedx = DensityInv*(drEdx - TotalEnergy*drhodx) - u*dudx - v*dvdx;</div>
<div class="line"><a name="l10871"></a><span class="lineno">10871</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dedy = DensityInv*(drEdy - TotalEnergy*drhody) - u*dudy - v*dvdy;</div>
<div class="line"><a name="l10872"></a><span class="lineno">10872</span>&#160; </div>
<div class="line"><a name="l10873"></a><span class="lineno">10873</span>&#160;      <span class="comment">/* Compute the eddy viscosity, if needed, and the total viscosity. */</span></div>
<div class="line"><a name="l10874"></a><span class="lineno">10874</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l10875"></a><span class="lineno">10875</span>&#160;      <span class="keywordflow">if</span>( SGSModelUsed )</div>
<div class="line"><a name="l10876"></a><span class="lineno">10876</span>&#160;        ViscosityTurb = SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#aebef9146565169091059c7b1a0fb926d">ComputeEddyViscosity_2D</a>(solDOF[0], dudx, dudy,</div>
<div class="line"><a name="l10877"></a><span class="lineno">10877</span>&#160;                                                          dvdx, dvdy, lenScale,</div>
<div class="line"><a name="l10878"></a><span class="lineno">10878</span>&#160;                                                          elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a6adc8d7d1588b7747b8f278fcd73b58f">wallDistanceSolDOFs</a>[i]);</div>
<div class="line"><a name="l10879"></a><span class="lineno">10879</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l10880"></a><span class="lineno">10880</span>&#160; </div>
<div class="line"><a name="l10881"></a><span class="lineno">10881</span>&#160;      <span class="comment">/* Compute the total thermal conductivity divided by Cv. */</span></div>
<div class="line"><a name="l10882"></a><span class="lineno">10882</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l10883"></a><span class="lineno">10883</span>&#160;                              + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l10884"></a><span class="lineno">10884</span>&#160; </div>
<div class="line"><a name="l10885"></a><span class="lineno">10885</span>&#160;      <span class="comment">/* Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l10886"></a><span class="lineno">10886</span>&#160;<span class="comment">         term in the viscous normal stresses. */</span></div>
<div class="line"><a name="l10887"></a><span class="lineno">10887</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l10888"></a><span class="lineno">10888</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lamDivTerm =  lambda*(dudx + dvdy);</div>
<div class="line"><a name="l10889"></a><span class="lineno">10889</span>&#160; </div>
<div class="line"><a name="l10890"></a><span class="lineno">10890</span>&#160;      <span class="comment">/* Compute the viscous stress tensor. */</span></div>
<div class="line"><a name="l10891"></a><span class="lineno">10891</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l10892"></a><span class="lineno">10892</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l10893"></a><span class="lineno">10893</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l10894"></a><span class="lineno">10894</span>&#160; </div>
<div class="line"><a name="l10895"></a><span class="lineno">10895</span>&#160;      <span class="comment">/* The Cartesian fluxes in the x-direction. */</span></div>
<div class="line"><a name="l10896"></a><span class="lineno">10896</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> uRel = u - gridVel[0];</div>
<div class="line"><a name="l10897"></a><span class="lineno">10897</span>&#160;      fluxX[0] = solDOF[0]*uRel;</div>
<div class="line"><a name="l10898"></a><span class="lineno">10898</span>&#160;      fluxX[1] = solDOF[1]*uRel + Pressure - tauxx;</div>
<div class="line"><a name="l10899"></a><span class="lineno">10899</span>&#160;      fluxX[2] = solDOF[2]*uRel - tauxy;</div>
<div class="line"><a name="l10900"></a><span class="lineno">10900</span>&#160;      fluxX[3] = solDOF[3]*uRel + Pressure*u - kOverCv*dedx - u*tauxx - v*tauxy;;</div>
<div class="line"><a name="l10901"></a><span class="lineno">10901</span>&#160; </div>
<div class="line"><a name="l10902"></a><span class="lineno">10902</span>&#160;      <span class="comment">/* The Cartesian fluxes in the y-direction. */</span></div>
<div class="line"><a name="l10903"></a><span class="lineno">10903</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vRel = v - gridVel[1];</div>
<div class="line"><a name="l10904"></a><span class="lineno">10904</span>&#160;      fluxY[0] = solDOF[0]*vRel;</div>
<div class="line"><a name="l10905"></a><span class="lineno">10905</span>&#160;      fluxY[1] = solDOF[1]*vRel - tauxy;</div>
<div class="line"><a name="l10906"></a><span class="lineno">10906</span>&#160;      fluxY[2] = solDOF[2]*vRel + Pressure - tauyy;</div>
<div class="line"><a name="l10907"></a><span class="lineno">10907</span>&#160;      fluxY[3] = solDOF[3]*vRel + Pressure*v - kOverCv*dedy - u*tauxy - v*tauyy;</div>
<div class="line"><a name="l10908"></a><span class="lineno">10908</span>&#160;    }</div>
<div class="line"><a name="l10909"></a><span class="lineno">10909</span>&#160;  }</div>
<div class="line"><a name="l10910"></a><span class="lineno">10910</span>&#160; </div>
<div class="line"><a name="l10911"></a><span class="lineno">10911</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l10912"></a><span class="lineno">10912</span>&#160;  <span class="comment">/*--- Compute the derivatives of the Cartesian fluxes w.r.t. the         ---*/</span></div>
<div class="line"><a name="l10913"></a><span class="lineno">10913</span>&#160;  <span class="comment">/*--- parametric coordinates in the integration points.                  ---*/</span></div>
<div class="line"><a name="l10914"></a><span class="lineno">10914</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l10915"></a><span class="lineno">10915</span>&#160; </div>
<div class="line"><a name="l10916"></a><span class="lineno">10916</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxXDOF, gradFluxXInt, config);</div>
<div class="line"><a name="l10917"></a><span class="lineno">10917</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxYDOF, gradFluxYInt, config);</div>
<div class="line"><a name="l10918"></a><span class="lineno">10918</span>&#160; </div>
<div class="line"><a name="l10919"></a><span class="lineno">10919</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l10920"></a><span class="lineno">10920</span>&#160;  <span class="comment">/*--- Compute the divergence of the fluxes in the integration points,    ---*/</span></div>
<div class="line"><a name="l10921"></a><span class="lineno">10921</span>&#160;  <span class="comment">/*--- multiplied by the integration weight.                              ---*/</span></div>
<div class="line"><a name="l10922"></a><span class="lineno">10922</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l10923"></a><span class="lineno">10923</span>&#160; </div>
<div class="line"><a name="l10924"></a><span class="lineno">10924</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l10925"></a><span class="lineno">10925</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l10926"></a><span class="lineno">10926</span>&#160; </div>
<div class="line"><a name="l10927"></a><span class="lineno">10927</span>&#160;    <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l10928"></a><span class="lineno">10928</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l10929"></a><span class="lineno">10929</span>&#160; </div>
<div class="line"><a name="l10930"></a><span class="lineno">10930</span>&#160;      <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l10931"></a><span class="lineno">10931</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt  = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l10932"></a><span class="lineno">10932</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXDr = gradFluxXInt + offInt;</div>
<div class="line"><a name="l10933"></a><span class="lineno">10933</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXDs = gradFluxXDr  + offDerivFluxes;</div>
<div class="line"><a name="l10934"></a><span class="lineno">10934</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYDr = gradFluxYInt + offInt;</div>
<div class="line"><a name="l10935"></a><span class="lineno">10935</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYDs = gradFluxYDr  + offDerivFluxes;</div>
<div class="line"><a name="l10936"></a><span class="lineno">10936</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *divFluxInt  = divFlux      + offInt;</div>
<div class="line"><a name="l10937"></a><span class="lineno">10937</span>&#160; </div>
<div class="line"><a name="l10938"></a><span class="lineno">10938</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l10939"></a><span class="lineno">10939</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l10940"></a><span class="lineno">10940</span>&#160;<span class="comment">         THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l10941"></a><span class="lineno">10941</span>&#160;<span class="comment">         BE TAKEN. */</span></div>
<div class="line"><a name="l10942"></a><span class="lineno">10942</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l10943"></a><span class="lineno">10943</span>&#160; </div>
<div class="line"><a name="l10944"></a><span class="lineno">10944</span>&#160;      <span class="comment">/* Compute the metric terms multiplied by the integration weight. Note that the</span></div>
<div class="line"><a name="l10945"></a><span class="lineno">10945</span>&#160;<span class="comment">         first term in the metric terms is the Jacobian. */</span></div>
<div class="line"><a name="l10946"></a><span class="lineno">10946</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdx = weights[i]*metricTerms[1];</div>
<div class="line"><a name="l10947"></a><span class="lineno">10947</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdy = weights[i]*metricTerms[2];</div>
<div class="line"><a name="l10948"></a><span class="lineno">10948</span>&#160; </div>
<div class="line"><a name="l10949"></a><span class="lineno">10949</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdx = weights[i]*metricTerms[3];</div>
<div class="line"><a name="l10950"></a><span class="lineno">10950</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdy = weights[i]*metricTerms[4];</div>
<div class="line"><a name="l10951"></a><span class="lineno">10951</span>&#160; </div>
<div class="line"><a name="l10952"></a><span class="lineno">10952</span>&#160;      <span class="comment">/* Compute the divergence of the fluxes, multiplied by the</span></div>
<div class="line"><a name="l10953"></a><span class="lineno">10953</span>&#160;<span class="comment">         integration weight. */</span></div>
<div class="line"><a name="l10954"></a><span class="lineno">10954</span>&#160;      divFluxInt[0] = gradFluxXDr[0]*wDrdx + gradFluxXDs[0]*wDsdx</div>
<div class="line"><a name="l10955"></a><span class="lineno">10955</span>&#160;                    + gradFluxYDr[0]*wDrdy + gradFluxYDs[0]*wDsdy;</div>
<div class="line"><a name="l10956"></a><span class="lineno">10956</span>&#160;      divFluxInt[1] = gradFluxXDr[1]*wDrdx + gradFluxXDs[1]*wDsdx</div>
<div class="line"><a name="l10957"></a><span class="lineno">10957</span>&#160;                    + gradFluxYDr[1]*wDrdy + gradFluxYDs[1]*wDsdy;</div>
<div class="line"><a name="l10958"></a><span class="lineno">10958</span>&#160;      divFluxInt[2] = gradFluxXDr[2]*wDrdx + gradFluxXDs[2]*wDsdx</div>
<div class="line"><a name="l10959"></a><span class="lineno">10959</span>&#160;                    + gradFluxYDr[2]*wDrdy + gradFluxYDs[2]*wDsdy;</div>
<div class="line"><a name="l10960"></a><span class="lineno">10960</span>&#160;      divFluxInt[3] = gradFluxXDr[3]*wDrdx + gradFluxXDs[3]*wDsdx</div>
<div class="line"><a name="l10961"></a><span class="lineno">10961</span>&#160;                    + gradFluxYDr[3]*wDrdy + gradFluxYDs[3]*wDsdy;</div>
<div class="line"><a name="l10962"></a><span class="lineno">10962</span>&#160;    }</div>
<div class="line"><a name="l10963"></a><span class="lineno">10963</span>&#160;  }</div>
<div class="line"><a name="l10964"></a><span class="lineno">10964</span>&#160; </div>
<div class="line"><a name="l10965"></a><span class="lineno">10965</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l10966"></a><span class="lineno">10966</span>&#160;  <span class="comment">/*--- Add the body force to the divergence of the fluxes, if such a      ---*/</span></div>
<div class="line"><a name="l10967"></a><span class="lineno">10967</span>&#160;  <span class="comment">/*--- force is present.                                                  ---*/</span></div>
<div class="line"><a name="l10968"></a><span class="lineno">10968</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l10969"></a><span class="lineno">10969</span>&#160; </div>
<div class="line"><a name="l10970"></a><span class="lineno">10970</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="class_c_config.html#a9af4200d2cd764653d2707da4acc7847">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l10971"></a><span class="lineno">10971</span>&#160; </div>
<div class="line"><a name="l10972"></a><span class="lineno">10972</span>&#160;    <span class="comment">/* Easier storage of the body force. */</span></div>
<div class="line"><a name="l10973"></a><span class="lineno">10973</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *body_force_vector = config-&gt;<a class="code" href="class_c_config.html#aa6f6ce87c87183da706c9e5521c1b812">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l10974"></a><span class="lineno">10974</span>&#160; </div>
<div class="line"><a name="l10975"></a><span class="lineno">10975</span>&#160;    <span class="comment">/* Compute the solution in the integration points of the element.</span></div>
<div class="line"><a name="l10976"></a><span class="lineno">10976</span>&#160;<span class="comment">       Use gradFluxYInt to store this solution. */</span></div>
<div class="line"><a name="l10977"></a><span class="lineno">10977</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solInt = gradFluxYInt;</div>
<div class="line"><a name="l10978"></a><span class="lineno">10978</span>&#160; </div>
<div class="line"><a name="l10979"></a><span class="lineno">10979</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt, NPad, nDOFs, matBasisInt, sol, solInt, config);</div>
<div class="line"><a name="l10980"></a><span class="lineno">10980</span>&#160; </div>
<div class="line"><a name="l10981"></a><span class="lineno">10981</span>&#160;    <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l10982"></a><span class="lineno">10982</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l10983"></a><span class="lineno">10983</span>&#160; </div>
<div class="line"><a name="l10984"></a><span class="lineno">10984</span>&#160;      <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l10985"></a><span class="lineno">10985</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l10986"></a><span class="lineno">10986</span>&#160; </div>
<div class="line"><a name="l10987"></a><span class="lineno">10987</span>&#160;        <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l10988"></a><span class="lineno">10988</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l10989"></a><span class="lineno">10989</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solThisInt = solInt  + offInt;</div>
<div class="line"><a name="l10990"></a><span class="lineno">10990</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *divFluxInt = divFlux + offInt;</div>
<div class="line"><a name="l10991"></a><span class="lineno">10991</span>&#160; </div>
<div class="line"><a name="l10992"></a><span class="lineno">10992</span>&#160;        <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l10993"></a><span class="lineno">10993</span>&#160;<span class="comment">           THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l10994"></a><span class="lineno">10994</span>&#160;<span class="comment">           THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l10995"></a><span class="lineno">10995</span>&#160;<span class="comment">           BE TAKEN. */</span></div>
<div class="line"><a name="l10996"></a><span class="lineno">10996</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l10997"></a><span class="lineno">10997</span>&#160; </div>
<div class="line"><a name="l10998"></a><span class="lineno">10998</span>&#160;        <span class="comment">/* Compute the velocities. */</span></div>
<div class="line"><a name="l10999"></a><span class="lineno">10999</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv = 1.0/solThisInt[0];</div>
<div class="line"><a name="l11000"></a><span class="lineno">11000</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u      = solThisInt[1]*rhoInv;</div>
<div class="line"><a name="l11001"></a><span class="lineno">11001</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v      = solThisInt[2]*rhoInv;</div>
<div class="line"><a name="l11002"></a><span class="lineno">11002</span>&#160; </div>
<div class="line"><a name="l11003"></a><span class="lineno">11003</span>&#160;        <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l11004"></a><span class="lineno">11004</span>&#160;<span class="comment">           equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l11005"></a><span class="lineno">11005</span>&#160;<span class="comment">           integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l11006"></a><span class="lineno">11006</span>&#160;<span class="comment">           the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l11007"></a><span class="lineno">11007</span>&#160;<span class="comment">           velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l11008"></a><span class="lineno">11008</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l11009"></a><span class="lineno">11009</span>&#160; </div>
<div class="line"><a name="l11010"></a><span class="lineno">11010</span>&#160;        divFluxInt[1] -= weightJac*body_force_vector[0];</div>
<div class="line"><a name="l11011"></a><span class="lineno">11011</span>&#160;        divFluxInt[2] -= weightJac*body_force_vector[1];</div>
<div class="line"><a name="l11012"></a><span class="lineno">11012</span>&#160;        divFluxInt[3] -= weightJac*(u*body_force_vector[0] + v*body_force_vector[1]);</div>
<div class="line"><a name="l11013"></a><span class="lineno">11013</span>&#160;      }</div>
<div class="line"><a name="l11014"></a><span class="lineno">11014</span>&#160;    }</div>
<div class="line"><a name="l11015"></a><span class="lineno">11015</span>&#160;  }</div>
<div class="line"><a name="l11016"></a><span class="lineno">11016</span>&#160; </div>
<div class="line"><a name="l11017"></a><span class="lineno">11017</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11018"></a><span class="lineno">11018</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l11019"></a><span class="lineno">11019</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l11020"></a><span class="lineno">11020</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11021"></a><span class="lineno">11021</span>&#160; </div>
<div class="line"><a name="l11022"></a><span class="lineno">11022</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l11023"></a><span class="lineno">11023</span>&#160;}</div>
<div class="line"><a name="l11024"></a><span class="lineno">11024</span>&#160; </div>
<div class="line"><a name="l11025"></a><span class="lineno">11025</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ADER_DG_AliasedPredictorResidual_3D(<a class="code" href="class_c_config.html">CConfig</a>              *config,</div>
<div class="line"><a name="l11026"></a><span class="lineno">11026</span>&#160;                                                           <a class="code" href="class_c_volume_element_f_e_m.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l11027"></a><span class="lineno">11027</span>&#160;                                                           <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *sol,</div>
<div class="line"><a name="l11028"></a><span class="lineno">11028</span>&#160;                                                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l11029"></a><span class="lineno">11029</span>&#160;                                                           <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l11030"></a><span class="lineno">11030</span>&#160;                                                           <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *res,</div>
<div class="line"><a name="l11031"></a><span class="lineno">11031</span>&#160;                                                           <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *work) {</div>
<div class="line"><a name="l11032"></a><span class="lineno">11032</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector. */</span></div>
<div class="line"><a name="l11033"></a><span class="lineno">11033</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Lam  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l11034"></a><span class="lineno">11034</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Turb = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l11035"></a><span class="lineno">11035</span>&#160; </div>
<div class="line"><a name="l11036"></a><span class="lineno">11036</span>&#160;  <span class="comment">/*--- Get the necessary information from the standard element. ---*/</span></div>
<div class="line"><a name="l11037"></a><span class="lineno">11037</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l11038"></a><span class="lineno">11038</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l11039"></a><span class="lineno">11039</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l11040"></a><span class="lineno">11040</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisInt            = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a6fbf928e9b9fa2fd9dab46309e0ed6b6">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l11041"></a><span class="lineno">11041</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matDerBasisInt         = matBasisInt + nDOFs*nInt;</div>
<div class="line"><a name="l11042"></a><span class="lineno">11042</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matDerBasisSolDOFs     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#afaac8e4c875c81435a55a298d20492a7">GetMatDerBasisFunctionsSolDOFs</a>();</div>
<div class="line"><a name="l11043"></a><span class="lineno">11043</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFunctionsIntTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0d8111ae54b825086ea24a9241a361f1">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l11044"></a><span class="lineno">11044</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights                = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l11045"></a><span class="lineno">11045</span>&#160; </div>
<div class="line"><a name="l11046"></a><span class="lineno">11046</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l11047"></a><span class="lineno">11047</span>&#160;  <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l11048"></a><span class="lineno">11048</span>&#160; </div>
<div class="line"><a name="l11049"></a><span class="lineno">11049</span>&#160;  <span class="comment">/* Compute the length scale of the current element for the LES. */</span></div>
<div class="line"><a name="l11050"></a><span class="lineno">11050</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l11051"></a><span class="lineno">11051</span>&#160; </div>
<div class="line"><a name="l11052"></a><span class="lineno">11052</span>&#160;  <span class="comment">/* Set the pointers for fluxes in the DOFs, the gradient of the fluxes in</span></div>
<div class="line"><a name="l11053"></a><span class="lineno">11053</span>&#160;<span class="comment">     the integration points, the gradient of the solution in the DOFs and the</span></div>
<div class="line"><a name="l11054"></a><span class="lineno">11054</span>&#160;<span class="comment">     divergence of the fluxes in the integration points. Note that some pointers</span></div>
<div class="line"><a name="l11055"></a><span class="lineno">11055</span>&#160;<span class="comment">     point to the same physical location. This is because this memory can be</span></div>
<div class="line"><a name="l11056"></a><span class="lineno">11056</span>&#160;<span class="comment">     used for different purposes. */</span></div>
<div class="line"><a name="l11057"></a><span class="lineno">11057</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxXDOF     = work;</div>
<div class="line"><a name="l11058"></a><span class="lineno">11058</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxYDOF     = fluxXDOF + NPad*nDOFs;</div>
<div class="line"><a name="l11059"></a><span class="lineno">11059</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxZDOF     = fluxYDOF + NPad*nDOFs;</div>
<div class="line"><a name="l11060"></a><span class="lineno">11060</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXInt = fluxZDOF + NPad*nDOFs;</div>
<div class="line"><a name="l11061"></a><span class="lineno">11061</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYInt = gradFluxXInt + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad*nInt;</div>
<div class="line"><a name="l11062"></a><span class="lineno">11062</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxZInt = gradFluxYInt + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad*nInt;</div>
<div class="line"><a name="l11063"></a><span class="lineno">11063</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradSolDOFs  = gradFluxXInt;</div>
<div class="line"><a name="l11064"></a><span class="lineno">11064</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFlux      = work;</div>
<div class="line"><a name="l11065"></a><span class="lineno">11065</span>&#160; </div>
<div class="line"><a name="l11066"></a><span class="lineno">11066</span>&#160;  <span class="comment">/* Determine the offset between the r-derivatives and s-derivatives of the</span></div>
<div class="line"><a name="l11067"></a><span class="lineno">11067</span>&#160;<span class="comment">     fluxes in the integration points and the offset between the r-derivatives</span></div>
<div class="line"><a name="l11068"></a><span class="lineno">11068</span>&#160;<span class="comment">     and s-derivatives of the solution in the DOFs. */</span></div>
<div class="line"><a name="l11069"></a><span class="lineno">11069</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivSol    = NPad*nDOFs;</div>
<div class="line"><a name="l11070"></a><span class="lineno">11070</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivFluxes = NPad*nInt;</div>
<div class="line"><a name="l11071"></a><span class="lineno">11071</span>&#160; </div>
<div class="line"><a name="l11072"></a><span class="lineno">11072</span>&#160;  <span class="comment">/* Store the number of metric points per integration point/DOF for readability. */</span></div>
<div class="line"><a name="l11073"></a><span class="lineno">11073</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 10;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l11074"></a><span class="lineno">11074</span>&#160; </div>
<div class="line"><a name="l11075"></a><span class="lineno">11075</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11076"></a><span class="lineno">11076</span>&#160;  <span class="comment">/*---          Construct the Cartesian fluxes in the DOFs.               ---*/</span></div>
<div class="line"><a name="l11077"></a><span class="lineno">11077</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11078"></a><span class="lineno">11078</span>&#160; </div>
<div class="line"><a name="l11079"></a><span class="lineno">11079</span>&#160;  <span class="comment">/* Compute the derivatives of the solution variables w.r.t. the parametric</span></div>
<div class="line"><a name="l11080"></a><span class="lineno">11080</span>&#160;<span class="comment">     coordinates in the DOFs. */</span></div>
<div class="line"><a name="l11081"></a><span class="lineno">11081</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisSolDOFs, sol, gradSolDOFs, config);</div>
<div class="line"><a name="l11082"></a><span class="lineno">11082</span>&#160; </div>
<div class="line"><a name="l11083"></a><span class="lineno">11083</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l11084"></a><span class="lineno">11084</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l11085"></a><span class="lineno">11085</span>&#160; </div>
<div class="line"><a name="l11086"></a><span class="lineno">11086</span>&#160;    <span class="comment">/*--- Loop over the DOFs to compute the Cartesian fluxes in the DOFs. ---*/</span></div>
<div class="line"><a name="l11087"></a><span class="lineno">11087</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l11088"></a><span class="lineno">11088</span>&#160; </div>
<div class="line"><a name="l11089"></a><span class="lineno">11089</span>&#160;      <span class="comment">/* Set the pointers for the solution, its gradients and the fluxes</span></div>
<div class="line"><a name="l11090"></a><span class="lineno">11090</span>&#160;<span class="comment">         for this DOF. */</span></div>
<div class="line"><a name="l11091"></a><span class="lineno">11091</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDOF = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l11092"></a><span class="lineno">11092</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF     = sol         + offDOF;</div>
<div class="line"><a name="l11093"></a><span class="lineno">11093</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDr   = gradSolDOFs + offDOF;</div>
<div class="line"><a name="l11094"></a><span class="lineno">11094</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDs   = solDOFDr    + offDerivSol;</div>
<div class="line"><a name="l11095"></a><span class="lineno">11095</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFDt   = solDOFDs    + offDerivSol;</div>
<div class="line"><a name="l11096"></a><span class="lineno">11096</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxX            = fluxXDOF    + offDOF;</div>
<div class="line"><a name="l11097"></a><span class="lineno">11097</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxY            = fluxYDOF    + offDOF;</div>
<div class="line"><a name="l11098"></a><span class="lineno">11098</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxZ            = fluxZDOF    + offDOF;</div>
<div class="line"><a name="l11099"></a><span class="lineno">11099</span>&#160; </div>
<div class="line"><a name="l11100"></a><span class="lineno">11100</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities at the location of the</span></div>
<div class="line"><a name="l11101"></a><span class="lineno">11101</span>&#160;<span class="comment">         solution DOFS. THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL</span></div>
<div class="line"><a name="l11102"></a><span class="lineno">11102</span>&#160;<span class="comment">         MOTION IS SPECIFIED, THE DATA FOR THIS DOF FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l11103"></a><span class="lineno">11103</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l11104"></a><span class="lineno">11104</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data() + 3*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l11105"></a><span class="lineno">11105</span>&#160; </div>
<div class="line"><a name="l11106"></a><span class="lineno">11106</span>&#160;      <span class="comment">/* Compute the true value of the metric terms in this DOF. Note that in</span></div>
<div class="line"><a name="l11107"></a><span class="lineno">11107</span>&#160;<span class="comment">         metricTerms the metric terms scaled by the Jacobian are stored. THIS</span></div>
<div class="line"><a name="l11108"></a><span class="lineno">11108</span>&#160;<span class="comment">         IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED, THE</span></div>
<div class="line"><a name="l11109"></a><span class="lineno">11109</span>&#160;<span class="comment">         DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l11110"></a><span class="lineno">11110</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#ae6c47cde654970b624c84f026f604a67">metricTermsSolDOFs</a>.data()</div>
<div class="line"><a name="l11111"></a><span class="lineno">11111</span>&#160;                                   + i*nMetricPerPoint;</div>
<div class="line"><a name="l11112"></a><span class="lineno">11112</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> JacInv       = 1.0/metricTerms[0];</div>
<div class="line"><a name="l11113"></a><span class="lineno">11113</span>&#160; </div>
<div class="line"><a name="l11114"></a><span class="lineno">11114</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l11115"></a><span class="lineno">11115</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l11116"></a><span class="lineno">11116</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdz = JacInv*metricTerms[3];</div>
<div class="line"><a name="l11117"></a><span class="lineno">11117</span>&#160; </div>
<div class="line"><a name="l11118"></a><span class="lineno">11118</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = JacInv*metricTerms[4];</div>
<div class="line"><a name="l11119"></a><span class="lineno">11119</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = JacInv*metricTerms[5];</div>
<div class="line"><a name="l11120"></a><span class="lineno">11120</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdz = JacInv*metricTerms[6];</div>
<div class="line"><a name="l11121"></a><span class="lineno">11121</span>&#160; </div>
<div class="line"><a name="l11122"></a><span class="lineno">11122</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdx = JacInv*metricTerms[7];</div>
<div class="line"><a name="l11123"></a><span class="lineno">11123</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdy = JacInv*metricTerms[8];</div>
<div class="line"><a name="l11124"></a><span class="lineno">11124</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdz = JacInv*metricTerms[9];</div>
<div class="line"><a name="l11125"></a><span class="lineno">11125</span>&#160; </div>
<div class="line"><a name="l11126"></a><span class="lineno">11126</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the independent solution variables</span></div>
<div class="line"><a name="l11127"></a><span class="lineno">11127</span>&#160;<span class="comment">         from the gradients in parametric coordinates and the metric terms. */</span></div>
<div class="line"><a name="l11128"></a><span class="lineno">11128</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodx = solDOFDr[0]*drdx + solDOFDs[0]*dsdx + solDOFDt[0]*dtdx;</div>
<div class="line"><a name="l11129"></a><span class="lineno">11129</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudx  = solDOFDr[1]*drdx + solDOFDs[1]*dsdx + solDOFDt[1]*dtdx;</div>
<div class="line"><a name="l11130"></a><span class="lineno">11130</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdx  = solDOFDr[2]*drdx + solDOFDs[2]*dsdx + solDOFDt[2]*dtdx;</div>
<div class="line"><a name="l11131"></a><span class="lineno">11131</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdx  = solDOFDr[3]*drdx + solDOFDs[3]*dsdx + solDOFDt[3]*dtdx;</div>
<div class="line"><a name="l11132"></a><span class="lineno">11132</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdx  = solDOFDr[4]*drdx + solDOFDs[4]*dsdx + solDOFDt[4]*dtdx;</div>
<div class="line"><a name="l11133"></a><span class="lineno">11133</span>&#160; </div>
<div class="line"><a name="l11134"></a><span class="lineno">11134</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhody = solDOFDr[0]*drdy + solDOFDs[0]*dsdy + solDOFDt[0]*dtdy;</div>
<div class="line"><a name="l11135"></a><span class="lineno">11135</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudy  = solDOFDr[1]*drdy + solDOFDs[1]*dsdy + solDOFDt[1]*dtdy;</div>
<div class="line"><a name="l11136"></a><span class="lineno">11136</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdy  = solDOFDr[2]*drdy + solDOFDs[2]*dsdy + solDOFDt[2]*dtdy;</div>
<div class="line"><a name="l11137"></a><span class="lineno">11137</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdy  = solDOFDr[3]*drdy + solDOFDs[3]*dsdy + solDOFDt[3]*dtdy;</div>
<div class="line"><a name="l11138"></a><span class="lineno">11138</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdy  = solDOFDr[4]*drdy + solDOFDs[4]*dsdy + solDOFDt[4]*dtdy;</div>
<div class="line"><a name="l11139"></a><span class="lineno">11139</span>&#160; </div>
<div class="line"><a name="l11140"></a><span class="lineno">11140</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodz = solDOFDr[0]*drdz + solDOFDs[0]*dsdz + solDOFDt[0]*dtdz;</div>
<div class="line"><a name="l11141"></a><span class="lineno">11141</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudz  = solDOFDr[1]*drdz + solDOFDs[1]*dsdz + solDOFDt[1]*dtdz;</div>
<div class="line"><a name="l11142"></a><span class="lineno">11142</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdz  = solDOFDr[2]*drdz + solDOFDs[2]*dsdz + solDOFDt[2]*dtdz;</div>
<div class="line"><a name="l11143"></a><span class="lineno">11143</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdz  = solDOFDr[3]*drdz + solDOFDs[3]*dsdz + solDOFDt[3]*dtdz;</div>
<div class="line"><a name="l11144"></a><span class="lineno">11144</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdz  = solDOFDr[4]*drdz + solDOFDs[4]*dsdz + solDOFDt[4]*dtdz;</div>
<div class="line"><a name="l11145"></a><span class="lineno">11145</span>&#160; </div>
<div class="line"><a name="l11146"></a><span class="lineno">11146</span>&#160;      <span class="comment">/* Compute the velocities, pressure and laminar viscosity in this DOF. */</span></div>
<div class="line"><a name="l11147"></a><span class="lineno">11147</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv   = 1.0/solDOF[0];</div>
<div class="line"><a name="l11148"></a><span class="lineno">11148</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = DensityInv*solDOF[1];</div>
<div class="line"><a name="l11149"></a><span class="lineno">11149</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = DensityInv*solDOF[2];</div>
<div class="line"><a name="l11150"></a><span class="lineno">11150</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w            = DensityInv*solDOF[3];</div>
<div class="line"><a name="l11151"></a><span class="lineno">11151</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = DensityInv*solDOF[4];</div>
<div class="line"><a name="l11152"></a><span class="lineno">11152</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - 0.5*(u*u + v*v + w*w);</div>
<div class="line"><a name="l11153"></a><span class="lineno">11153</span>&#160; </div>
<div class="line"><a name="l11154"></a><span class="lineno">11154</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(solDOF[0], StaticEnergy);</div>
<div class="line"><a name="l11155"></a><span class="lineno">11155</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l11156"></a><span class="lineno">11156</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l11157"></a><span class="lineno">11157</span>&#160; </div>
<div class="line"><a name="l11158"></a><span class="lineno">11158</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the velocities and static energy. */</span></div>
<div class="line"><a name="l11159"></a><span class="lineno">11159</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = DensityInv*(drudx - u*drhodx);</div>
<div class="line"><a name="l11160"></a><span class="lineno">11160</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = DensityInv*(drudy - u*drhody);</div>
<div class="line"><a name="l11161"></a><span class="lineno">11161</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudz = DensityInv*(drudz - u*drhodz);</div>
<div class="line"><a name="l11162"></a><span class="lineno">11162</span>&#160; </div>
<div class="line"><a name="l11163"></a><span class="lineno">11163</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = DensityInv*(drvdx - v*drhodx);</div>
<div class="line"><a name="l11164"></a><span class="lineno">11164</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = DensityInv*(drvdy - v*drhody);</div>
<div class="line"><a name="l11165"></a><span class="lineno">11165</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdz = DensityInv*(drvdz - v*drhodz);</div>
<div class="line"><a name="l11166"></a><span class="lineno">11166</span>&#160; </div>
<div class="line"><a name="l11167"></a><span class="lineno">11167</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdx = DensityInv*(drwdx - w*drhodx);</div>
<div class="line"><a name="l11168"></a><span class="lineno">11168</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdy = DensityInv*(drwdy - w*drhody);</div>
<div class="line"><a name="l11169"></a><span class="lineno">11169</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdz = DensityInv*(drwdz - w*drhodz);</div>
<div class="line"><a name="l11170"></a><span class="lineno">11170</span>&#160; </div>
<div class="line"><a name="l11171"></a><span class="lineno">11171</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dedx = DensityInv*(drEdx - TotalEnergy*drhodx) - u*dudx - v*dvdx - w*dwdx;</div>
<div class="line"><a name="l11172"></a><span class="lineno">11172</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dedy = DensityInv*(drEdy - TotalEnergy*drhody) - u*dudy - v*dvdy - w*dwdy;</div>
<div class="line"><a name="l11173"></a><span class="lineno">11173</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dedz = DensityInv*(drEdz - TotalEnergy*drhodz) - u*dudz - v*dvdz - w*dwdz;</div>
<div class="line"><a name="l11174"></a><span class="lineno">11174</span>&#160; </div>
<div class="line"><a name="l11175"></a><span class="lineno">11175</span>&#160;      <span class="comment">/* Compute the eddy viscosity, if needed, and the total viscosity. */</span></div>
<div class="line"><a name="l11176"></a><span class="lineno">11176</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l11177"></a><span class="lineno">11177</span>&#160;      <span class="keywordflow">if</span>( SGSModelUsed )</div>
<div class="line"><a name="l11178"></a><span class="lineno">11178</span>&#160;        ViscosityTurb = SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#a6017e86477c7d39b542d82a3b2b9f1cd">ComputeEddyViscosity_3D</a>(solDOF[0], dudx, dudy, dudz,</div>
<div class="line"><a name="l11179"></a><span class="lineno">11179</span>&#160;                                                          dvdx, dvdy, dvdz, dwdx,</div>
<div class="line"><a name="l11180"></a><span class="lineno">11180</span>&#160;                                                          dwdy, dwdz, lenScale,</div>
<div class="line"><a name="l11181"></a><span class="lineno">11181</span>&#160;                                                          elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a6adc8d7d1588b7747b8f278fcd73b58f">wallDistanceSolDOFs</a>[i]);</div>
<div class="line"><a name="l11182"></a><span class="lineno">11182</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l11183"></a><span class="lineno">11183</span>&#160; </div>
<div class="line"><a name="l11184"></a><span class="lineno">11184</span>&#160;      <span class="comment">/* Compute the total thermal conductivity divided by Cv. */</span></div>
<div class="line"><a name="l11185"></a><span class="lineno">11185</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l11186"></a><span class="lineno">11186</span>&#160;                              + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l11187"></a><span class="lineno">11187</span>&#160; </div>
<div class="line"><a name="l11188"></a><span class="lineno">11188</span>&#160;      <span class="comment">/* Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l11189"></a><span class="lineno">11189</span>&#160;<span class="comment">         term in the viscous normal stresses. */</span></div>
<div class="line"><a name="l11190"></a><span class="lineno">11190</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l11191"></a><span class="lineno">11191</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lamDivTerm =  lambda*(dudx + dvdy + dwdz);</div>
<div class="line"><a name="l11192"></a><span class="lineno">11192</span>&#160; </div>
<div class="line"><a name="l11193"></a><span class="lineno">11193</span>&#160;      <span class="comment">/* Compute the viscous stress tensor. */</span></div>
<div class="line"><a name="l11194"></a><span class="lineno">11194</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l11195"></a><span class="lineno">11195</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l11196"></a><span class="lineno">11196</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauzz = 2.0*Viscosity*dwdz + lamDivTerm;</div>
<div class="line"><a name="l11197"></a><span class="lineno">11197</span>&#160; </div>
<div class="line"><a name="l11198"></a><span class="lineno">11198</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l11199"></a><span class="lineno">11199</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxz = Viscosity*(dudz + dwdx);</div>
<div class="line"><a name="l11200"></a><span class="lineno">11200</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyz = Viscosity*(dvdz + dwdy);</div>
<div class="line"><a name="l11201"></a><span class="lineno">11201</span>&#160; </div>
<div class="line"><a name="l11202"></a><span class="lineno">11202</span>&#160;      <span class="comment">/* The Cartesian fluxes in the x-direction. */</span></div>
<div class="line"><a name="l11203"></a><span class="lineno">11203</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> uRel = u - gridVel[0];</div>
<div class="line"><a name="l11204"></a><span class="lineno">11204</span>&#160;      fluxX[0] = solDOF[0]*uRel;</div>
<div class="line"><a name="l11205"></a><span class="lineno">11205</span>&#160;      fluxX[1] = solDOF[1]*uRel + Pressure - tauxx;</div>
<div class="line"><a name="l11206"></a><span class="lineno">11206</span>&#160;      fluxX[2] = solDOF[2]*uRel - tauxy;</div>
<div class="line"><a name="l11207"></a><span class="lineno">11207</span>&#160;      fluxX[3] = solDOF[3]*uRel - tauxz;</div>
<div class="line"><a name="l11208"></a><span class="lineno">11208</span>&#160;      fluxX[4] = solDOF[4]*uRel + Pressure*u - kOverCv*dedx - u*tauxx - v*tauxy - w*tauxz;</div>
<div class="line"><a name="l11209"></a><span class="lineno">11209</span>&#160; </div>
<div class="line"><a name="l11210"></a><span class="lineno">11210</span>&#160;      <span class="comment">/* The Cartesian fluxes in the y-direction. */</span></div>
<div class="line"><a name="l11211"></a><span class="lineno">11211</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vRel = v - gridVel[1];</div>
<div class="line"><a name="l11212"></a><span class="lineno">11212</span>&#160;      fluxY[0] = solDOF[0]*vRel;</div>
<div class="line"><a name="l11213"></a><span class="lineno">11213</span>&#160;      fluxY[1] = solDOF[1]*vRel - tauxy;</div>
<div class="line"><a name="l11214"></a><span class="lineno">11214</span>&#160;      fluxY[2] = solDOF[2]*vRel + Pressure - tauyy;</div>
<div class="line"><a name="l11215"></a><span class="lineno">11215</span>&#160;      fluxY[3] = solDOF[3]*vRel - tauyz;</div>
<div class="line"><a name="l11216"></a><span class="lineno">11216</span>&#160;      fluxY[4] = solDOF[4]*vRel + Pressure*v - kOverCv*dedy - u*tauxy - v*tauyy - w*tauyz;</div>
<div class="line"><a name="l11217"></a><span class="lineno">11217</span>&#160; </div>
<div class="line"><a name="l11218"></a><span class="lineno">11218</span>&#160;      <span class="comment">/* The Cartesian fluxes in the z-direction. */</span></div>
<div class="line"><a name="l11219"></a><span class="lineno">11219</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wRel = w - gridVel[2];</div>
<div class="line"><a name="l11220"></a><span class="lineno">11220</span>&#160;      fluxZ[0] = solDOF[0]*wRel;</div>
<div class="line"><a name="l11221"></a><span class="lineno">11221</span>&#160;      fluxZ[1] = solDOF[1]*wRel - tauxz;</div>
<div class="line"><a name="l11222"></a><span class="lineno">11222</span>&#160;      fluxZ[2] = solDOF[2]*wRel - tauyz;</div>
<div class="line"><a name="l11223"></a><span class="lineno">11223</span>&#160;      fluxZ[3] = solDOF[3]*wRel + Pressure - tauzz;</div>
<div class="line"><a name="l11224"></a><span class="lineno">11224</span>&#160;      fluxZ[4] = solDOF[4]*wRel + Pressure*w - kOverCv*dedz - u*tauxz - v*tauyz - w*tauzz;</div>
<div class="line"><a name="l11225"></a><span class="lineno">11225</span>&#160;    }</div>
<div class="line"><a name="l11226"></a><span class="lineno">11226</span>&#160;  }</div>
<div class="line"><a name="l11227"></a><span class="lineno">11227</span>&#160; </div>
<div class="line"><a name="l11228"></a><span class="lineno">11228</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11229"></a><span class="lineno">11229</span>&#160;  <span class="comment">/*--- Compute the derivatives of the Cartesian fluxes w.r.t. the         ---*/</span></div>
<div class="line"><a name="l11230"></a><span class="lineno">11230</span>&#160;  <span class="comment">/*--- parametric coordinates in the integration points.                  ---*/</span></div>
<div class="line"><a name="l11231"></a><span class="lineno">11231</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11232"></a><span class="lineno">11232</span>&#160; </div>
<div class="line"><a name="l11233"></a><span class="lineno">11233</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxXDOF, gradFluxXInt, config);</div>
<div class="line"><a name="l11234"></a><span class="lineno">11234</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxYDOF, gradFluxYInt, config);</div>
<div class="line"><a name="l11235"></a><span class="lineno">11235</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFs, matDerBasisInt, fluxZDOF, gradFluxZInt, config);</div>
<div class="line"><a name="l11236"></a><span class="lineno">11236</span>&#160; </div>
<div class="line"><a name="l11237"></a><span class="lineno">11237</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11238"></a><span class="lineno">11238</span>&#160;  <span class="comment">/*--- Compute the divergence of the fluxes in the integration points,    ---*/</span></div>
<div class="line"><a name="l11239"></a><span class="lineno">11239</span>&#160;  <span class="comment">/*--- multiplied by the integration weight.                              ---*/</span></div>
<div class="line"><a name="l11240"></a><span class="lineno">11240</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11241"></a><span class="lineno">11241</span>&#160; </div>
<div class="line"><a name="l11242"></a><span class="lineno">11242</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l11243"></a><span class="lineno">11243</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l11244"></a><span class="lineno">11244</span>&#160; </div>
<div class="line"><a name="l11245"></a><span class="lineno">11245</span>&#160;    <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l11246"></a><span class="lineno">11246</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l11247"></a><span class="lineno">11247</span>&#160; </div>
<div class="line"><a name="l11248"></a><span class="lineno">11248</span>&#160;      <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l11249"></a><span class="lineno">11249</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt  = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l11250"></a><span class="lineno">11250</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXDr = gradFluxXInt + offInt;</div>
<div class="line"><a name="l11251"></a><span class="lineno">11251</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXDs = gradFluxXDr  + offDerivFluxes;</div>
<div class="line"><a name="l11252"></a><span class="lineno">11252</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxXDt = gradFluxXDs  + offDerivFluxes;</div>
<div class="line"><a name="l11253"></a><span class="lineno">11253</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYDr = gradFluxYInt + offInt;</div>
<div class="line"><a name="l11254"></a><span class="lineno">11254</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYDs = gradFluxYDr  + offDerivFluxes;</div>
<div class="line"><a name="l11255"></a><span class="lineno">11255</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxYDt = gradFluxYDs  + offDerivFluxes;</div>
<div class="line"><a name="l11256"></a><span class="lineno">11256</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxZDr = gradFluxZInt + offInt;</div>
<div class="line"><a name="l11257"></a><span class="lineno">11257</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxZDs = gradFluxZDr  + offDerivFluxes;</div>
<div class="line"><a name="l11258"></a><span class="lineno">11258</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradFluxZDt = gradFluxZDs  + offDerivFluxes;</div>
<div class="line"><a name="l11259"></a><span class="lineno">11259</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *divFluxInt  = divFlux      + offInt;</div>
<div class="line"><a name="l11260"></a><span class="lineno">11260</span>&#160; </div>
<div class="line"><a name="l11261"></a><span class="lineno">11261</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l11262"></a><span class="lineno">11262</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l11263"></a><span class="lineno">11263</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l11264"></a><span class="lineno">11264</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l11265"></a><span class="lineno">11265</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l11266"></a><span class="lineno">11266</span>&#160; </div>
<div class="line"><a name="l11267"></a><span class="lineno">11267</span>&#160;      <span class="comment">/* Compute the metric terms multiplied by the integration weight. Note that the</span></div>
<div class="line"><a name="l11268"></a><span class="lineno">11268</span>&#160;<span class="comment">         first term in the metric terms is the Jacobian. */</span></div>
<div class="line"><a name="l11269"></a><span class="lineno">11269</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdx = weights[i]*metricTerms[1];</div>
<div class="line"><a name="l11270"></a><span class="lineno">11270</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdy = weights[i]*metricTerms[2];</div>
<div class="line"><a name="l11271"></a><span class="lineno">11271</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdz = weights[i]*metricTerms[3];</div>
<div class="line"><a name="l11272"></a><span class="lineno">11272</span>&#160; </div>
<div class="line"><a name="l11273"></a><span class="lineno">11273</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdx = weights[i]*metricTerms[4];</div>
<div class="line"><a name="l11274"></a><span class="lineno">11274</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdy = weights[i]*metricTerms[5];</div>
<div class="line"><a name="l11275"></a><span class="lineno">11275</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdz = weights[i]*metricTerms[6];</div>
<div class="line"><a name="l11276"></a><span class="lineno">11276</span>&#160; </div>
<div class="line"><a name="l11277"></a><span class="lineno">11277</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdx = weights[i]*metricTerms[7];</div>
<div class="line"><a name="l11278"></a><span class="lineno">11278</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdy = weights[i]*metricTerms[8];</div>
<div class="line"><a name="l11279"></a><span class="lineno">11279</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdz = weights[i]*metricTerms[9];</div>
<div class="line"><a name="l11280"></a><span class="lineno">11280</span>&#160; </div>
<div class="line"><a name="l11281"></a><span class="lineno">11281</span>&#160;      <span class="comment">/* Compute the divergence of the fluxes, multiplied by the integration weight. */</span></div>
<div class="line"><a name="l11282"></a><span class="lineno">11282</span>&#160;      divFluxInt[0] = gradFluxXDr[0]*wDrdx + gradFluxXDs[0]*wDsdx + gradFluxXDt[0]*wDtdx</div>
<div class="line"><a name="l11283"></a><span class="lineno">11283</span>&#160;                    + gradFluxYDr[0]*wDrdy + gradFluxYDs[0]*wDsdy + gradFluxYDt[0]*wDtdy</div>
<div class="line"><a name="l11284"></a><span class="lineno">11284</span>&#160;                    + gradFluxZDr[0]*wDrdz + gradFluxZDs[0]*wDsdz + gradFluxZDt[0]*wDtdz;</div>
<div class="line"><a name="l11285"></a><span class="lineno">11285</span>&#160;      divFluxInt[1] = gradFluxXDr[1]*wDrdx + gradFluxXDs[1]*wDsdx + gradFluxXDt[1]*wDtdx</div>
<div class="line"><a name="l11286"></a><span class="lineno">11286</span>&#160;                    + gradFluxYDr[1]*wDrdy + gradFluxYDs[1]*wDsdy + gradFluxYDt[1]*wDtdy</div>
<div class="line"><a name="l11287"></a><span class="lineno">11287</span>&#160;                    + gradFluxZDr[1]*wDrdz + gradFluxZDs[1]*wDsdz + gradFluxZDt[1]*wDtdz;</div>
<div class="line"><a name="l11288"></a><span class="lineno">11288</span>&#160;      divFluxInt[2] = gradFluxXDr[2]*wDrdx + gradFluxXDs[2]*wDsdx + gradFluxXDt[2]*wDtdx</div>
<div class="line"><a name="l11289"></a><span class="lineno">11289</span>&#160;                    + gradFluxYDr[2]*wDrdy + gradFluxYDs[2]*wDsdy + gradFluxYDt[2]*wDtdy</div>
<div class="line"><a name="l11290"></a><span class="lineno">11290</span>&#160;                    + gradFluxZDr[2]*wDrdz + gradFluxZDs[2]*wDsdz + gradFluxZDt[2]*wDtdz;</div>
<div class="line"><a name="l11291"></a><span class="lineno">11291</span>&#160;      divFluxInt[3] = gradFluxXDr[3]*wDrdx + gradFluxXDs[3]*wDsdx + gradFluxXDt[3]*wDtdx</div>
<div class="line"><a name="l11292"></a><span class="lineno">11292</span>&#160;                    + gradFluxYDr[3]*wDrdy + gradFluxYDs[3]*wDsdy + gradFluxYDt[3]*wDtdy</div>
<div class="line"><a name="l11293"></a><span class="lineno">11293</span>&#160;                    + gradFluxZDr[3]*wDrdz + gradFluxZDs[3]*wDsdz + gradFluxZDt[3]*wDtdz;</div>
<div class="line"><a name="l11294"></a><span class="lineno">11294</span>&#160;      divFluxInt[4] = gradFluxXDr[4]*wDrdx + gradFluxXDs[4]*wDsdx + gradFluxXDt[4]*wDtdx</div>
<div class="line"><a name="l11295"></a><span class="lineno">11295</span>&#160;                    + gradFluxYDr[4]*wDrdy + gradFluxYDs[4]*wDsdy + gradFluxYDt[4]*wDtdy</div>
<div class="line"><a name="l11296"></a><span class="lineno">11296</span>&#160;                    + gradFluxZDr[4]*wDrdz + gradFluxZDs[4]*wDsdz + gradFluxZDt[4]*wDtdz;</div>
<div class="line"><a name="l11297"></a><span class="lineno">11297</span>&#160;    }</div>
<div class="line"><a name="l11298"></a><span class="lineno">11298</span>&#160;  }</div>
<div class="line"><a name="l11299"></a><span class="lineno">11299</span>&#160; </div>
<div class="line"><a name="l11300"></a><span class="lineno">11300</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11301"></a><span class="lineno">11301</span>&#160;  <span class="comment">/*--- Add the body force to the divergence of the fluxes, if such a      ---*/</span></div>
<div class="line"><a name="l11302"></a><span class="lineno">11302</span>&#160;  <span class="comment">/*--- force is present.                                                  ---*/</span></div>
<div class="line"><a name="l11303"></a><span class="lineno">11303</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11304"></a><span class="lineno">11304</span>&#160; </div>
<div class="line"><a name="l11305"></a><span class="lineno">11305</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="class_c_config.html#a9af4200d2cd764653d2707da4acc7847">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l11306"></a><span class="lineno">11306</span>&#160; </div>
<div class="line"><a name="l11307"></a><span class="lineno">11307</span>&#160;    <span class="comment">/* Easier storage of the body force. */</span></div>
<div class="line"><a name="l11308"></a><span class="lineno">11308</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *body_force_vector = config-&gt;<a class="code" href="class_c_config.html#aa6f6ce87c87183da706c9e5521c1b812">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l11309"></a><span class="lineno">11309</span>&#160; </div>
<div class="line"><a name="l11310"></a><span class="lineno">11310</span>&#160;    <span class="comment">/* Compute the solution in the integration points of the element.</span></div>
<div class="line"><a name="l11311"></a><span class="lineno">11311</span>&#160;<span class="comment">       Use gradFluxYInt to store this solution. */</span></div>
<div class="line"><a name="l11312"></a><span class="lineno">11312</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solInt = gradFluxYInt;</div>
<div class="line"><a name="l11313"></a><span class="lineno">11313</span>&#160; </div>
<div class="line"><a name="l11314"></a><span class="lineno">11314</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt, NPad, nDOFs, matBasisInt, sol, solInt, config);</div>
<div class="line"><a name="l11315"></a><span class="lineno">11315</span>&#160; </div>
<div class="line"><a name="l11316"></a><span class="lineno">11316</span>&#160;    <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l11317"></a><span class="lineno">11317</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l11318"></a><span class="lineno">11318</span>&#160; </div>
<div class="line"><a name="l11319"></a><span class="lineno">11319</span>&#160;      <span class="comment">/*--- Loop over the integration points of the element. ---*/</span></div>
<div class="line"><a name="l11320"></a><span class="lineno">11320</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l11321"></a><span class="lineno">11321</span>&#160; </div>
<div class="line"><a name="l11322"></a><span class="lineno">11322</span>&#160;        <span class="comment">/* Set the pointers for this integration point. */</span></div>
<div class="line"><a name="l11323"></a><span class="lineno">11323</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt = i*NPad + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l11324"></a><span class="lineno">11324</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solThisInt = solInt  + offInt;</div>
<div class="line"><a name="l11325"></a><span class="lineno">11325</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *divFluxInt = divFlux + offInt;</div>
<div class="line"><a name="l11326"></a><span class="lineno">11326</span>&#160; </div>
<div class="line"><a name="l11327"></a><span class="lineno">11327</span>&#160;        <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l11328"></a><span class="lineno">11328</span>&#160;<span class="comment">           THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l11329"></a><span class="lineno">11329</span>&#160;<span class="comment">           THE DATA FOR THIS DOF FOR THE CURRENT TIME INTEGRATION POINT MUST</span></div>
<div class="line"><a name="l11330"></a><span class="lineno">11330</span>&#160;<span class="comment">           BE TAKEN. */</span></div>
<div class="line"><a name="l11331"></a><span class="lineno">11331</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l11332"></a><span class="lineno">11332</span>&#160; </div>
<div class="line"><a name="l11333"></a><span class="lineno">11333</span>&#160;        <span class="comment">/* Compute the velocities. */</span></div>
<div class="line"><a name="l11334"></a><span class="lineno">11334</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv = 1.0/solThisInt[0];</div>
<div class="line"><a name="l11335"></a><span class="lineno">11335</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u      = solThisInt[1]*rhoInv;</div>
<div class="line"><a name="l11336"></a><span class="lineno">11336</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v      = solThisInt[2]*rhoInv;</div>
<div class="line"><a name="l11337"></a><span class="lineno">11337</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w      = solThisInt[3]*rhoInv;</div>
<div class="line"><a name="l11338"></a><span class="lineno">11338</span>&#160; </div>
<div class="line"><a name="l11339"></a><span class="lineno">11339</span>&#160;        <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l11340"></a><span class="lineno">11340</span>&#160;<span class="comment">           equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l11341"></a><span class="lineno">11341</span>&#160;<span class="comment">           integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l11342"></a><span class="lineno">11342</span>&#160;<span class="comment">           the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l11343"></a><span class="lineno">11343</span>&#160;<span class="comment">           velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l11344"></a><span class="lineno">11344</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l11345"></a><span class="lineno">11345</span>&#160; </div>
<div class="line"><a name="l11346"></a><span class="lineno">11346</span>&#160;        divFluxInt[1] -= weightJac*body_force_vector[0];</div>
<div class="line"><a name="l11347"></a><span class="lineno">11347</span>&#160;        divFluxInt[2] -= weightJac*body_force_vector[1];</div>
<div class="line"><a name="l11348"></a><span class="lineno">11348</span>&#160;        divFluxInt[3] -= weightJac*body_force_vector[2];</div>
<div class="line"><a name="l11349"></a><span class="lineno">11349</span>&#160;        divFluxInt[4] -= weightJac*(u*body_force_vector[0] + v*body_force_vector[1]</div>
<div class="line"><a name="l11350"></a><span class="lineno">11350</span>&#160;                       +            w*body_force_vector[2]);</div>
<div class="line"><a name="l11351"></a><span class="lineno">11351</span>&#160;      }</div>
<div class="line"><a name="l11352"></a><span class="lineno">11352</span>&#160;    }</div>
<div class="line"><a name="l11353"></a><span class="lineno">11353</span>&#160;  }</div>
<div class="line"><a name="l11354"></a><span class="lineno">11354</span>&#160; </div>
<div class="line"><a name="l11355"></a><span class="lineno">11355</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11356"></a><span class="lineno">11356</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l11357"></a><span class="lineno">11357</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l11358"></a><span class="lineno">11358</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11359"></a><span class="lineno">11359</span>&#160; </div>
<div class="line"><a name="l11360"></a><span class="lineno">11360</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l11361"></a><span class="lineno">11361</span>&#160;}</div>
<div class="line"><a name="l11362"></a><span class="lineno">11362</span>&#160; </div>
<div class="line"><a name="l11363"></a><span class="lineno">11363</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ADER_DG_NonAliasedPredictorResidual_2D(<a class="code" href="class_c_config.html">CConfig</a>              *config,</div>
<div class="line"><a name="l11364"></a><span class="lineno">11364</span>&#160;                                                              <a class="code" href="class_c_volume_element_f_e_m.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l11365"></a><span class="lineno">11365</span>&#160;                                                              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *sol,</div>
<div class="line"><a name="l11366"></a><span class="lineno">11366</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l11367"></a><span class="lineno">11367</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l11368"></a><span class="lineno">11368</span>&#160;                                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *res,</div>
<div class="line"><a name="l11369"></a><span class="lineno">11369</span>&#160;                                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *work) {</div>
<div class="line"><a name="l11370"></a><span class="lineno">11370</span>&#160; </div>
<div class="line"><a name="l11371"></a><span class="lineno">11371</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector, the inverse of</span></div>
<div class="line"><a name="l11372"></a><span class="lineno">11372</span>&#160;<span class="comment">     the specific heat at constant volume and ratio lambdaOverMu. */</span></div>
<div class="line"><a name="l11373"></a><span class="lineno">11373</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Lam  =  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l11374"></a><span class="lineno">11374</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Turb =  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l11375"></a><span class="lineno">11375</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Gas_Constant      =  config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l11376"></a><span class="lineno">11376</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> CvInv             =  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>/Gas_Constant;</div>
<div class="line"><a name="l11377"></a><span class="lineno">11377</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambdaOverMu      = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>;</div>
<div class="line"><a name="l11378"></a><span class="lineno">11378</span>&#160; </div>
<div class="line"><a name="l11379"></a><span class="lineno">11379</span>&#160;  <span class="comment">/*--- Get the necessary information from the standard element. ---*/</span></div>
<div class="line"><a name="l11380"></a><span class="lineno">11380</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l11381"></a><span class="lineno">11381</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l11382"></a><span class="lineno">11382</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l11383"></a><span class="lineno">11383</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisInt            = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a6fbf928e9b9fa2fd9dab46309e0ed6b6">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l11384"></a><span class="lineno">11384</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *mat2ndDerBasisInt      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#ae4776b34ee12f735df9c227c10149160">GetMat2ndDerBasisFunctionsInt</a>();</div>
<div class="line"><a name="l11385"></a><span class="lineno">11385</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFunctionsIntTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0d8111ae54b825086ea24a9241a361f1">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l11386"></a><span class="lineno">11386</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights                = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l11387"></a><span class="lineno">11387</span>&#160; </div>
<div class="line"><a name="l11388"></a><span class="lineno">11388</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l11389"></a><span class="lineno">11389</span>&#160;  <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l11390"></a><span class="lineno">11390</span>&#160; </div>
<div class="line"><a name="l11391"></a><span class="lineno">11391</span>&#160;  <span class="comment">/* Check if a body force is present and set it accordingly. */</span></div>
<div class="line"><a name="l11392"></a><span class="lineno">11392</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> bodyForceX = 0.0, bodyForceY = 0.0;</div>
<div class="line"><a name="l11393"></a><span class="lineno">11393</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="class_c_config.html#a9af4200d2cd764653d2707da4acc7847">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l11394"></a><span class="lineno">11394</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *body_force_vector = config-&gt;<a class="code" href="class_c_config.html#aa6f6ce87c87183da706c9e5521c1b812">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l11395"></a><span class="lineno">11395</span>&#160;    bodyForceX = body_force_vector[0];</div>
<div class="line"><a name="l11396"></a><span class="lineno">11396</span>&#160;    bodyForceY = body_force_vector[1];</div>
<div class="line"><a name="l11397"></a><span class="lineno">11397</span>&#160;  }</div>
<div class="line"><a name="l11398"></a><span class="lineno">11398</span>&#160; </div>
<div class="line"><a name="l11399"></a><span class="lineno">11399</span>&#160;  <span class="comment">/* Compute the length scale of the current element for the LES. */</span></div>
<div class="line"><a name="l11400"></a><span class="lineno">11400</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l11401"></a><span class="lineno">11401</span>&#160; </div>
<div class="line"><a name="l11402"></a><span class="lineno">11402</span>&#160;  <span class="comment">/* Set the pointers for solAndGradInt and divFlux to work. The same array</span></div>
<div class="line"><a name="l11403"></a><span class="lineno">11403</span>&#160;<span class="comment">     can be used for both help arrays. */</span></div>
<div class="line"><a name="l11404"></a><span class="lineno">11404</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solAndGradInt = work;</div>
<div class="line"><a name="l11405"></a><span class="lineno">11405</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFlux       = work;</div>
<div class="line"><a name="l11406"></a><span class="lineno">11406</span>&#160; </div>
<div class="line"><a name="l11407"></a><span class="lineno">11407</span>&#160;  <span class="comment">/* Determine the offset between the solution variables and the r-derivatives,</span></div>
<div class="line"><a name="l11408"></a><span class="lineno">11408</span>&#160;<span class="comment">     which is also the offset between the r- and s-derivatives in the</span></div>
<div class="line"><a name="l11409"></a><span class="lineno">11409</span>&#160;<span class="comment">     integration points. */</span></div>
<div class="line"><a name="l11410"></a><span class="lineno">11410</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivInt = NPad*nInt;</div>
<div class="line"><a name="l11411"></a><span class="lineno">11411</span>&#160; </div>
<div class="line"><a name="l11412"></a><span class="lineno">11412</span>&#160;  <span class="comment">/* Set the pointer for the second derivatives such that they are stored</span></div>
<div class="line"><a name="l11413"></a><span class="lineno">11413</span>&#160;<span class="comment">     after the first derivatives. */</span></div>
<div class="line"><a name="l11414"></a><span class="lineno">11414</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *secDerSol = solAndGradInt + 3*NPad*nInt;   <span class="comment">/*(nDim+1)*NPad*nInt. */</span></div>
<div class="line"><a name="l11415"></a><span class="lineno">11415</span>&#160; </div>
<div class="line"><a name="l11416"></a><span class="lineno">11416</span>&#160;  <span class="comment">/* Store the number of metric points per integration point for readability. */</span></div>
<div class="line"><a name="l11417"></a><span class="lineno">11417</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 5;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l11418"></a><span class="lineno">11418</span>&#160; </div>
<div class="line"><a name="l11419"></a><span class="lineno">11419</span>&#160;  <span class="comment">/* Store the number of additional metric points per integration point, which</span></div>
<div class="line"><a name="l11420"></a><span class="lineno">11420</span>&#160;<span class="comment">     are needed to compute the second derivatives. These terms take the</span></div>
<div class="line"><a name="l11421"></a><span class="lineno">11421</span>&#160;<span class="comment">     non-constant metric into account. */</span></div>
<div class="line"><a name="l11422"></a><span class="lineno">11422</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetric2ndDerPerPoint = 6; <span class="comment">/*nDim*(nDim + nDim*(nDim-1)/2). */</span></div>
<div class="line"><a name="l11423"></a><span class="lineno">11423</span>&#160; </div>
<div class="line"><a name="l11424"></a><span class="lineno">11424</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11425"></a><span class="lineno">11425</span>&#160;  <span class="comment">/*--- Interpolate the solution variables to the integration points and   ---*/</span></div>
<div class="line"><a name="l11426"></a><span class="lineno">11426</span>&#160;  <span class="comment">/*--- also determine the first and second derivatives of these variables ---*/</span></div>
<div class="line"><a name="l11427"></a><span class="lineno">11427</span>&#160;  <span class="comment">/*--- in the integration points. All derivatives are w.r.t. the          ---*/</span></div>
<div class="line"><a name="l11428"></a><span class="lineno">11428</span>&#160;  <span class="comment">/*--- parametric coordinates.                                            ---*/</span></div>
<div class="line"><a name="l11429"></a><span class="lineno">11429</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11430"></a><span class="lineno">11430</span>&#160; </div>
<div class="line"><a name="l11431"></a><span class="lineno">11431</span>&#160;  <span class="comment">/* Compute the solution and the derivatives w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l11432"></a><span class="lineno">11432</span>&#160;<span class="comment">     in the integration points. The first argument is nInt*(nDim+1). */</span></div>
<div class="line"><a name="l11433"></a><span class="lineno">11433</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*3, NPad, nDOFs, matBasisInt, sol, solAndGradInt, config);</div>
<div class="line"><a name="l11434"></a><span class="lineno">11434</span>&#160; </div>
<div class="line"><a name="l11435"></a><span class="lineno">11435</span>&#160;  <span class="comment">/* Compute the second derivatives w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l11436"></a><span class="lineno">11436</span>&#160;<span class="comment">     in the integration points. */</span></div>
<div class="line"><a name="l11437"></a><span class="lineno">11437</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*3, NPad, nDOFs, mat2ndDerBasisInt, sol, secDerSol, config);</div>
<div class="line"><a name="l11438"></a><span class="lineno">11438</span>&#160; </div>
<div class="line"><a name="l11439"></a><span class="lineno">11439</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11440"></a><span class="lineno">11440</span>&#160;  <span class="comment">/*--- Compute the divergence of viscous fluxes, multiplied by the        ---*/</span></div>
<div class="line"><a name="l11441"></a><span class="lineno">11441</span>&#160;  <span class="comment">/*--- integration weight in the integration points of the element.       ---*/</span></div>
<div class="line"><a name="l11442"></a><span class="lineno">11442</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11443"></a><span class="lineno">11443</span>&#160; </div>
<div class="line"><a name="l11444"></a><span class="lineno">11444</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l11445"></a><span class="lineno">11445</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l11446"></a><span class="lineno">11446</span>&#160; </div>
<div class="line"><a name="l11447"></a><span class="lineno">11447</span>&#160;    <span class="comment">/*--- Loop over the integration points. ---*/</span></div>
<div class="line"><a name="l11448"></a><span class="lineno">11448</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l11449"></a><span class="lineno">11449</span>&#160; </div>
<div class="line"><a name="l11450"></a><span class="lineno">11450</span>&#160;      <span class="comment">/* Easier storage of the locations where the solution and the gradient</span></div>
<div class="line"><a name="l11451"></a><span class="lineno">11451</span>&#160;<span class="comment">         data of this integration point start. */</span></div>
<div class="line"><a name="l11452"></a><span class="lineno">11452</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt = NPad*i + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l11453"></a><span class="lineno">11453</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol   = solAndGradInt + offInt;</div>
<div class="line"><a name="l11454"></a><span class="lineno">11454</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDr = sol   + offDerivInt;</div>
<div class="line"><a name="l11455"></a><span class="lineno">11455</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDs = solDr + offDerivInt;</div>
<div class="line"><a name="l11456"></a><span class="lineno">11456</span>&#160; </div>
<div class="line"><a name="l11457"></a><span class="lineno">11457</span>&#160;      <span class="comment">/* Easier storage of the locations where the second derivatives are</span></div>
<div class="line"><a name="l11458"></a><span class="lineno">11458</span>&#160;<span class="comment">         stored for this integration point. */</span></div>
<div class="line"><a name="l11459"></a><span class="lineno">11459</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDrDr = secDerSol + offInt;</div>
<div class="line"><a name="l11460"></a><span class="lineno">11460</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDrDs = solDrDr   + offDerivInt;</div>
<div class="line"><a name="l11461"></a><span class="lineno">11461</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDsDs = solDrDs   + offDerivInt;</div>
<div class="line"><a name="l11462"></a><span class="lineno">11462</span>&#160; </div>
<div class="line"><a name="l11463"></a><span class="lineno">11463</span>&#160;      <span class="comment">/* Compute the velocities, pressure and total enthalpy</span></div>
<div class="line"><a name="l11464"></a><span class="lineno">11464</span>&#160;<span class="comment">         in this integration point. */</span></div>
<div class="line"><a name="l11465"></a><span class="lineno">11465</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rho = sol[0];</div>
<div class="line"><a name="l11466"></a><span class="lineno">11466</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ru  = sol[1];</div>
<div class="line"><a name="l11467"></a><span class="lineno">11467</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rv  = sol[2];</div>
<div class="line"><a name="l11468"></a><span class="lineno">11468</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rE  = sol[3];</div>
<div class="line"><a name="l11469"></a><span class="lineno">11469</span>&#160; </div>
<div class="line"><a name="l11470"></a><span class="lineno">11470</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv       = 1.0/rho;</div>
<div class="line"><a name="l11471"></a><span class="lineno">11471</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = rhoInv*ru;</div>
<div class="line"><a name="l11472"></a><span class="lineno">11472</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = rhoInv*rv;</div>
<div class="line"><a name="l11473"></a><span class="lineno">11473</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kinEnergy    = 0.5*(u*u + v*v);</div>
<div class="line"><a name="l11474"></a><span class="lineno">11474</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = rhoInv*rE;</div>
<div class="line"><a name="l11475"></a><span class="lineno">11475</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - kinEnergy;</div>
<div class="line"><a name="l11476"></a><span class="lineno">11476</span>&#160; </div>
<div class="line"><a name="l11477"></a><span class="lineno">11477</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(rho, StaticEnergy);</div>
<div class="line"><a name="l11478"></a><span class="lineno">11478</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l11479"></a><span class="lineno">11479</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Htot     = rhoInv*(rE + Pressure);</div>
<div class="line"><a name="l11480"></a><span class="lineno">11480</span>&#160; </div>
<div class="line"><a name="l11481"></a><span class="lineno">11481</span>&#160;      <span class="comment">/* Compute the laminar viscosity and its derivative w.r.t. temperature. */</span></div>
<div class="line"><a name="l11482"></a><span class="lineno">11482</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l11483"></a><span class="lineno">11483</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscLamdT   = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#abe5c1bbc7a5822be2ca700a296a0090a">GetdmudT_rho</a>();</div>
<div class="line"><a name="l11484"></a><span class="lineno">11484</span>&#160; </div>
<div class="line"><a name="l11485"></a><span class="lineno">11485</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities in this integration point.</span></div>
<div class="line"><a name="l11486"></a><span class="lineno">11486</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l11487"></a><span class="lineno">11487</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l11488"></a><span class="lineno">11488</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l11489"></a><span class="lineno">11489</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + 2*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l11490"></a><span class="lineno">11490</span>&#160; </div>
<div class="line"><a name="l11491"></a><span class="lineno">11491</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l11492"></a><span class="lineno">11492</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l11493"></a><span class="lineno">11493</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l11494"></a><span class="lineno">11494</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l11495"></a><span class="lineno">11495</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l11496"></a><span class="lineno">11496</span>&#160; </div>
<div class="line"><a name="l11497"></a><span class="lineno">11497</span>&#160;      <span class="comment">/* Compute the true metric terms. Note in metricTerms the actual metric</span></div>
<div class="line"><a name="l11498"></a><span class="lineno">11498</span>&#160;<span class="comment">         terms multiplied by the Jacobian are stored. */</span></div>
<div class="line"><a name="l11499"></a><span class="lineno">11499</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Jac    = metricTerms[0];</div>
<div class="line"><a name="l11500"></a><span class="lineno">11500</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> JacInv = 1.0/Jac;</div>
<div class="line"><a name="l11501"></a><span class="lineno">11501</span>&#160; </div>
<div class="line"><a name="l11502"></a><span class="lineno">11502</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l11503"></a><span class="lineno">11503</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l11504"></a><span class="lineno">11504</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = JacInv*metricTerms[3];</div>
<div class="line"><a name="l11505"></a><span class="lineno">11505</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = JacInv*metricTerms[4];</div>
<div class="line"><a name="l11506"></a><span class="lineno">11506</span>&#160; </div>
<div class="line"><a name="l11507"></a><span class="lineno">11507</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l11508"></a><span class="lineno">11508</span>&#160;<span class="comment">         variables from the gradients in parametric coordinates and the</span></div>
<div class="line"><a name="l11509"></a><span class="lineno">11509</span>&#160;<span class="comment">         metric terms in this integration point. */</span></div>
<div class="line"><a name="l11510"></a><span class="lineno">11510</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodx = solDr[0]*drdx + solDs[0]*dsdx;</div>
<div class="line"><a name="l11511"></a><span class="lineno">11511</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudx  = solDr[1]*drdx + solDs[1]*dsdx;</div>
<div class="line"><a name="l11512"></a><span class="lineno">11512</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdx  = solDr[2]*drdx + solDs[2]*dsdx;</div>
<div class="line"><a name="l11513"></a><span class="lineno">11513</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdx  = solDr[3]*drdx + solDs[3]*dsdx;</div>
<div class="line"><a name="l11514"></a><span class="lineno">11514</span>&#160; </div>
<div class="line"><a name="l11515"></a><span class="lineno">11515</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhody = solDr[0]*drdy + solDs[0]*dsdy;</div>
<div class="line"><a name="l11516"></a><span class="lineno">11516</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudy  = solDr[1]*drdy + solDs[1]*dsdy;</div>
<div class="line"><a name="l11517"></a><span class="lineno">11517</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdy  = solDr[2]*drdy + solDs[2]*dsdy;</div>
<div class="line"><a name="l11518"></a><span class="lineno">11518</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdy  = solDr[3]*drdy + solDs[3]*dsdy;</div>
<div class="line"><a name="l11519"></a><span class="lineno">11519</span>&#160; </div>
<div class="line"><a name="l11520"></a><span class="lineno">11520</span>&#160;      <span class="comment">/* Pointer to the necessary additional metric terms needed to compute</span></div>
<div class="line"><a name="l11521"></a><span class="lineno">11521</span>&#160;<span class="comment">         the Cartesian second derivatives for this integration point.</span></div>
<div class="line"><a name="l11522"></a><span class="lineno">11522</span>&#160;<span class="comment">         HIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l11523"></a><span class="lineno">11523</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l11524"></a><span class="lineno">11524</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l11525"></a><span class="lineno">11525</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms2ndDer = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a4dce50854c91ee9d721a72bbadd50254">metricTerms2ndDer</a>.data()</div>
<div class="line"><a name="l11526"></a><span class="lineno">11526</span>&#160;                                         + i*nMetric2ndDerPerPoint;</div>
<div class="line"><a name="l11527"></a><span class="lineno">11527</span>&#160; </div>
<div class="line"><a name="l11528"></a><span class="lineno">11528</span>&#160;      <span class="comment">/* Compute the Cartesian second derivatives of the independent solution</span></div>
<div class="line"><a name="l11529"></a><span class="lineno">11529</span>&#160;<span class="comment">         variables from the gradients and second derivatives in parametric</span></div>
<div class="line"><a name="l11530"></a><span class="lineno">11530</span>&#160;<span class="comment">         coordinates and the metric terms and its derivatives w.r.t. the</span></div>
<div class="line"><a name="l11531"></a><span class="lineno">11531</span>&#160;<span class="comment">         parametric coordinates. */</span></div>
<div class="line"><a name="l11532"></a><span class="lineno">11532</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rhodxdx = solDrDr[0]*drdx*drdx + solDsDs[0]*dsdx*dsdx</div>
<div class="line"><a name="l11533"></a><span class="lineno">11533</span>&#160;                                + 2.0*solDrDs[0]*drdx*dsdx</div>
<div class="line"><a name="l11534"></a><span class="lineno">11534</span>&#160;                                + solDr[0]*metricTerms2ndDer[0] + solDs[0]*metricTerms2ndDer[1];</div>
<div class="line"><a name="l11535"></a><span class="lineno">11535</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rudxdx  = solDrDr[1]*drdx*drdx + solDsDs[1]*dsdx*dsdx</div>
<div class="line"><a name="l11536"></a><span class="lineno">11536</span>&#160;                                + 2.0*solDrDs[1]*drdx*dsdx</div>
<div class="line"><a name="l11537"></a><span class="lineno">11537</span>&#160;                                + solDr[1]*metricTerms2ndDer[0] + solDs[1]*metricTerms2ndDer[1];</div>
<div class="line"><a name="l11538"></a><span class="lineno">11538</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rvdxdx  = solDrDr[2]*drdx*drdx + solDsDs[2]*dsdx*dsdx</div>
<div class="line"><a name="l11539"></a><span class="lineno">11539</span>&#160;                                + 2.0*solDrDs[2]*drdx*dsdx</div>
<div class="line"><a name="l11540"></a><span class="lineno">11540</span>&#160;                                + solDr[2]*metricTerms2ndDer[0] + solDs[2]*metricTerms2ndDer[1];</div>
<div class="line"><a name="l11541"></a><span class="lineno">11541</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rEdxdx  = solDrDr[3]*drdx*drdx + solDsDs[3]*dsdx*dsdx</div>
<div class="line"><a name="l11542"></a><span class="lineno">11542</span>&#160;                                + 2.0*solDrDs[3]*drdx*dsdx</div>
<div class="line"><a name="l11543"></a><span class="lineno">11543</span>&#160;                                + solDr[3]*metricTerms2ndDer[0] + solDs[3]*metricTerms2ndDer[1];</div>
<div class="line"><a name="l11544"></a><span class="lineno">11544</span>&#160; </div>
<div class="line"><a name="l11545"></a><span class="lineno">11545</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rhodydy = solDrDr[0]*drdy*drdy + solDsDs[0]*dsdy*dsdy</div>
<div class="line"><a name="l11546"></a><span class="lineno">11546</span>&#160;                                + 2.0*solDrDs[0]*drdy*dsdy</div>
<div class="line"><a name="l11547"></a><span class="lineno">11547</span>&#160;                                + solDr[0]*metricTerms2ndDer[4] + solDs[0]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l11548"></a><span class="lineno">11548</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rudydy  = solDrDr[1]*drdy*drdy + solDsDs[1]*dsdy*dsdy</div>
<div class="line"><a name="l11549"></a><span class="lineno">11549</span>&#160;                                + 2.0*solDrDs[1]*drdy*dsdy</div>
<div class="line"><a name="l11550"></a><span class="lineno">11550</span>&#160;                                + solDr[1]*metricTerms2ndDer[4] + solDs[1]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l11551"></a><span class="lineno">11551</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rvdydy  = solDrDr[2]*drdy*drdy + solDsDs[2]*dsdy*dsdy</div>
<div class="line"><a name="l11552"></a><span class="lineno">11552</span>&#160;                                + 2.0*solDrDs[2]*drdy*dsdy</div>
<div class="line"><a name="l11553"></a><span class="lineno">11553</span>&#160;                                + solDr[2]*metricTerms2ndDer[4] + solDs[2]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l11554"></a><span class="lineno">11554</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rEdydy  = solDrDr[3]*drdy*drdy + solDsDs[3]*dsdy*dsdy</div>
<div class="line"><a name="l11555"></a><span class="lineno">11555</span>&#160;                                + 2.0*solDrDs[3]*drdy*dsdy</div>
<div class="line"><a name="l11556"></a><span class="lineno">11556</span>&#160;                                + solDr[3]*metricTerms2ndDer[4] + solDs[3]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l11557"></a><span class="lineno">11557</span>&#160; </div>
<div class="line"><a name="l11558"></a><span class="lineno">11558</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rhodxdy = solDrDr[0]*drdx*drdy + solDsDs[0]*dsdx*dsdy</div>
<div class="line"><a name="l11559"></a><span class="lineno">11559</span>&#160;                                + solDrDs[0]*(drdx*dsdy + dsdx*drdy)</div>
<div class="line"><a name="l11560"></a><span class="lineno">11560</span>&#160;                                + solDr[0]*metricTerms2ndDer[2] + solDs[0]*metricTerms2ndDer[3];</div>
<div class="line"><a name="l11561"></a><span class="lineno">11561</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rudxdy  = solDrDr[1]*drdx*drdy + solDsDs[1]*dsdx*dsdy</div>
<div class="line"><a name="l11562"></a><span class="lineno">11562</span>&#160;                                + solDrDs[1]*(drdx*dsdy + dsdx*drdy)</div>
<div class="line"><a name="l11563"></a><span class="lineno">11563</span>&#160;                                + solDr[1]*metricTerms2ndDer[2] + solDs[1]*metricTerms2ndDer[3];</div>
<div class="line"><a name="l11564"></a><span class="lineno">11564</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rvdxdy  = solDrDr[2]*drdx*drdy + solDsDs[2]*dsdx*dsdy</div>
<div class="line"><a name="l11565"></a><span class="lineno">11565</span>&#160;                                + solDrDs[2]*(drdx*dsdy + dsdx*drdy)</div>
<div class="line"><a name="l11566"></a><span class="lineno">11566</span>&#160;                                + solDr[2]*metricTerms2ndDer[2] + solDs[2]*metricTerms2ndDer[3];</div>
<div class="line"><a name="l11567"></a><span class="lineno">11567</span>&#160; </div>
<div class="line"><a name="l11568"></a><span class="lineno">11568</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the pressure, velocity components,</span></div>
<div class="line"><a name="l11569"></a><span class="lineno">11569</span>&#160;<span class="comment">         static energy and dynamic viscosity. */</span></div>
<div class="line"><a name="l11570"></a><span class="lineno">11570</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dpdx = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdx + kinEnergy*drhodx</div>
<div class="line"><a name="l11571"></a><span class="lineno">11571</span>&#160;                           -                  u*drudx - v*drvdx);</div>
<div class="line"><a name="l11572"></a><span class="lineno">11572</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dpdy = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdy + kinEnergy*drhody</div>
<div class="line"><a name="l11573"></a><span class="lineno">11573</span>&#160;                           -                  u*drudy - v*drvdy);</div>
<div class="line"><a name="l11574"></a><span class="lineno">11574</span>&#160; </div>
<div class="line"><a name="l11575"></a><span class="lineno">11575</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = rhoInv*(drudx - u*drhodx);</div>
<div class="line"><a name="l11576"></a><span class="lineno">11576</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = rhoInv*(drudy - u*drhody);</div>
<div class="line"><a name="l11577"></a><span class="lineno">11577</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = rhoInv*(drvdx - v*drhodx);</div>
<div class="line"><a name="l11578"></a><span class="lineno">11578</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = rhoInv*(drvdy - v*drhody);</div>
<div class="line"><a name="l11579"></a><span class="lineno">11579</span>&#160; </div>
<div class="line"><a name="l11580"></a><span class="lineno">11580</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dedx = rhoInv*(drEdx - TotalEnergy*drhodx) - u*dudx - v*dvdx;</div>
<div class="line"><a name="l11581"></a><span class="lineno">11581</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dedy = rhoInv*(drEdy - TotalEnergy*drhody) - u*dudy - v*dvdy;</div>
<div class="line"><a name="l11582"></a><span class="lineno">11582</span>&#160; </div>
<div class="line"><a name="l11583"></a><span class="lineno">11583</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscLamdx = CvInv*dedx*dViscLamdT;</div>
<div class="line"><a name="l11584"></a><span class="lineno">11584</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscLamdy = CvInv*dedy*dViscLamdT;</div>
<div class="line"><a name="l11585"></a><span class="lineno">11585</span>&#160; </div>
<div class="line"><a name="l11586"></a><span class="lineno">11586</span>&#160;      <span class="comment">/* Compute the second derivatives of the velocity components. */</span></div>
<div class="line"><a name="l11587"></a><span class="lineno">11587</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2udxdx = rhoInv*(d2rudxdx - u*d2rhodxdx</div>
<div class="line"><a name="l11588"></a><span class="lineno">11588</span>&#160;                              +         2.0*rhoInv*drhodx*(u*drhodx - drudx));</div>
<div class="line"><a name="l11589"></a><span class="lineno">11589</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2udydy = rhoInv*(d2rudydy - u*d2rhodydy</div>
<div class="line"><a name="l11590"></a><span class="lineno">11590</span>&#160;                              +         2.0*rhoInv*drhody*(u*drhody - drudy));</div>
<div class="line"><a name="l11591"></a><span class="lineno">11591</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2udxdy = rhoInv*(d2rudxdy - u*d2rhodxdy</div>
<div class="line"><a name="l11592"></a><span class="lineno">11592</span>&#160;                              +         rhoInv*(drhodx*(u*drhody - drudy)</div>
<div class="line"><a name="l11593"></a><span class="lineno">11593</span>&#160;                              +                 drhody*(u*drhodx - drudx)));</div>
<div class="line"><a name="l11594"></a><span class="lineno">11594</span>&#160; </div>
<div class="line"><a name="l11595"></a><span class="lineno">11595</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2vdxdx = rhoInv*(d2rvdxdx - v*d2rhodxdx</div>
<div class="line"><a name="l11596"></a><span class="lineno">11596</span>&#160;                              +         2.0*rhoInv*drhodx*(v*drhodx - drvdx));</div>
<div class="line"><a name="l11597"></a><span class="lineno">11597</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2vdydy = rhoInv*(d2rvdydy - v*d2rhodydy</div>
<div class="line"><a name="l11598"></a><span class="lineno">11598</span>&#160;                              +         2.0*rhoInv*drhody*(v*drhody - drvdy));</div>
<div class="line"><a name="l11599"></a><span class="lineno">11599</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2vdxdy = rhoInv*(d2rvdxdy - v*d2rhodxdy</div>
<div class="line"><a name="l11600"></a><span class="lineno">11600</span>&#160;                              +         rhoInv*(drhodx*(v*drhody - drvdy)</div>
<div class="line"><a name="l11601"></a><span class="lineno">11601</span>&#160;                              +                 drhody*(v*drhodx - drvdx)));</div>
<div class="line"><a name="l11602"></a><span class="lineno">11602</span>&#160; </div>
<div class="line"><a name="l11603"></a><span class="lineno">11603</span>&#160;      <span class="comment">/* Compute the second derivatives of the static energy. Note that this</span></div>
<div class="line"><a name="l11604"></a><span class="lineno">11604</span>&#160;<span class="comment">         term appears in the heat flux and therefore only the pure second</span></div>
<div class="line"><a name="l11605"></a><span class="lineno">11605</span>&#160;<span class="comment">         derivatives are needed. Hence, the cross-derivatives are omitted. */</span></div>
<div class="line"><a name="l11606"></a><span class="lineno">11606</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2edxdx = rhoInv*(d2rEdxdx - TotalEnergy*d2rhodxdx</div>
<div class="line"><a name="l11607"></a><span class="lineno">11607</span>&#160;                              +         2.0*rhoInv*drhodx*(TotalEnergy*drhodx - drEdx))</div>
<div class="line"><a name="l11608"></a><span class="lineno">11608</span>&#160;                              -         u*d2udxdx - dudx*dudx - v*d2vdxdx - dvdx*dvdx;</div>
<div class="line"><a name="l11609"></a><span class="lineno">11609</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2edydy = rhoInv*(d2rEdydy - TotalEnergy*d2rhodydy</div>
<div class="line"><a name="l11610"></a><span class="lineno">11610</span>&#160;                              +         2.0*rhoInv*drhody*(TotalEnergy*drhody - drEdy))</div>
<div class="line"><a name="l11611"></a><span class="lineno">11611</span>&#160;                              -         u*d2udydy - dudy*dudy - v*d2vdydy - dvdy*dvdy;</div>
<div class="line"><a name="l11612"></a><span class="lineno">11612</span>&#160; </div>
<div class="line"><a name="l11613"></a><span class="lineno">11613</span>&#160;      <span class="comment">/* If an SGS model is used the eddy viscosity and its spatial</span></div>
<div class="line"><a name="l11614"></a><span class="lineno">11614</span>&#160;<span class="comment">         derivatives must be computed. */</span></div>
<div class="line"><a name="l11615"></a><span class="lineno">11615</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l11616"></a><span class="lineno">11616</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscTurbdx = 0.0, dViscTurbdy = 0.0;</div>
<div class="line"><a name="l11617"></a><span class="lineno">11617</span>&#160; </div>
<div class="line"><a name="l11618"></a><span class="lineno">11618</span>&#160;      <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l11619"></a><span class="lineno">11619</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dist = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#abcd8ed2e51e1429b0f164086419a40ff">wallDistance</a>[i];</div>
<div class="line"><a name="l11620"></a><span class="lineno">11620</span>&#160;        ViscosityTurb = SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#aebef9146565169091059c7b1a0fb926d">ComputeEddyViscosity_2D</a>(rho, dudx, dudy, dvdx,</div>
<div class="line"><a name="l11621"></a><span class="lineno">11621</span>&#160;                                                          dvdy, lenScale, dist);</div>
<div class="line"><a name="l11622"></a><span class="lineno">11622</span>&#160; </div>
<div class="line"><a name="l11623"></a><span class="lineno">11623</span>&#160;        SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#a32de4fde5231a347640bf08d5be8876a">ComputeGradEddyViscosity_2D</a>(rho, drhodx, drhody, dudx, dudy,</div>
<div class="line"><a name="l11624"></a><span class="lineno">11624</span>&#160;                                              dvdx, dvdy, d2udxdx, d2udydy, d2udxdy,</div>
<div class="line"><a name="l11625"></a><span class="lineno">11625</span>&#160;                                              d2vdxdx, d2vdydy, d2vdxdy, lenScale,</div>
<div class="line"><a name="l11626"></a><span class="lineno">11626</span>&#160;                                              dist, dViscTurbdx, dViscTurbdy);</div>
<div class="line"><a name="l11627"></a><span class="lineno">11627</span>&#160;      }</div>
<div class="line"><a name="l11628"></a><span class="lineno">11628</span>&#160; </div>
<div class="line"><a name="l11629"></a><span class="lineno">11629</span>&#160;      <span class="comment">/* Compute the total viscosity, the total heat conductivity and their</span></div>
<div class="line"><a name="l11630"></a><span class="lineno">11630</span>&#160;<span class="comment">         gradients. Note that the heat conductivity is divided by the Cv,</span></div>
<div class="line"><a name="l11631"></a><span class="lineno">11631</span>&#160;<span class="comment">         because gradients of internal energy are computed and not temperature. */</span></div>
<div class="line"><a name="l11632"></a><span class="lineno">11632</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l11633"></a><span class="lineno">11633</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l11634"></a><span class="lineno">11634</span>&#160;                              + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l11635"></a><span class="lineno">11635</span>&#160; </div>
<div class="line"><a name="l11636"></a><span class="lineno">11636</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscDx = dViscLamdx + dViscTurbdx;</div>
<div class="line"><a name="l11637"></a><span class="lineno">11637</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscDy = dViscLamdy + dViscTurbdy;</div>
<div class="line"><a name="l11638"></a><span class="lineno">11638</span>&#160; </div>
<div class="line"><a name="l11639"></a><span class="lineno">11639</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dkOverCvdx = dViscLamdx *factHeatFlux_Lam</div>
<div class="line"><a name="l11640"></a><span class="lineno">11640</span>&#160;                                 + dViscTurbdx*factHeatFlux_Turb;</div>
<div class="line"><a name="l11641"></a><span class="lineno">11641</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dkOverCvdy = dViscLamdy *factHeatFlux_Lam</div>
<div class="line"><a name="l11642"></a><span class="lineno">11642</span>&#160;                                 + dViscTurbdy*factHeatFlux_Turb;</div>
<div class="line"><a name="l11643"></a><span class="lineno">11643</span>&#160; </div>
<div class="line"><a name="l11644"></a><span class="lineno">11644</span>&#160;      <span class="comment">/* Abbreviations, which make it easier to compute the divergence term. */</span></div>
<div class="line"><a name="l11645"></a><span class="lineno">11645</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv1 = drudx + drvdy;</div>
<div class="line"><a name="l11646"></a><span class="lineno">11646</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2 = u*drhodx + v*drhody;</div>
<div class="line"><a name="l11647"></a><span class="lineno">11647</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv3 = u*(drEdx + dpdx) + v*(drEdy + dpdy);</div>
<div class="line"><a name="l11648"></a><span class="lineno">11648</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv4 = dudx + dvdy;</div>
<div class="line"><a name="l11649"></a><span class="lineno">11649</span>&#160; </div>
<div class="line"><a name="l11650"></a><span class="lineno">11650</span>&#160;      <span class="comment">/* Compute the divergence of the grid velocity.</span></div>
<div class="line"><a name="l11651"></a><span class="lineno">11651</span>&#160;<span class="comment">         SET TO ZERO FOR NOW. THIS IS NOT CORRECT!!!!. */</span></div>
<div class="line"><a name="l11652"></a><span class="lineno">11652</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> divGridVel = 0.0;</div>
<div class="line"><a name="l11653"></a><span class="lineno">11653</span>&#160; </div>
<div class="line"><a name="l11654"></a><span class="lineno">11654</span>&#160;      <span class="comment">/* Set the pointer to store the divergence terms for this integration</span></div>
<div class="line"><a name="l11655"></a><span class="lineno">11655</span>&#160;<span class="comment">         point and compute these terms, multiplied by the integration weight</span></div>
<div class="line"><a name="l11656"></a><span class="lineno">11656</span>&#160;<span class="comment">         and Jacobian. */</span></div>
<div class="line"><a name="l11657"></a><span class="lineno">11657</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*Jac;</div>
<div class="line"><a name="l11658"></a><span class="lineno">11658</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFluxInt     = divFlux + offInt;</div>
<div class="line"><a name="l11659"></a><span class="lineno">11659</span>&#160; </div>
<div class="line"><a name="l11660"></a><span class="lineno">11660</span>&#160;      divFluxInt[0] = weightJac*(abv1 - rho*divGridVel</div>
<div class="line"><a name="l11661"></a><span class="lineno">11661</span>&#160;                    -            gridVel[0]*drhodx - gridVel[1]*drhody);</div>
<div class="line"><a name="l11662"></a><span class="lineno">11662</span>&#160;      divFluxInt[1] = weightJac*(dpdx + u*(abv1-abv2) - lambdaOverMu*abv4*dViscDx</div>
<div class="line"><a name="l11663"></a><span class="lineno">11663</span>&#160;                    +            u*drudx + v*drudy</div>
<div class="line"><a name="l11664"></a><span class="lineno">11664</span>&#160;                    -            lambdaOverMu*Viscosity*(d2udxdx + d2vdxdy)</div>
<div class="line"><a name="l11665"></a><span class="lineno">11665</span>&#160;                    -            Viscosity*(2.0*d2udxdx + d2udydy + d2vdxdy)</div>
<div class="line"><a name="l11666"></a><span class="lineno">11666</span>&#160;                    -            2.0*dViscDx*dudx - dViscDy*(dudy+dvdx)</div>
<div class="line"><a name="l11667"></a><span class="lineno">11667</span>&#160;                    -            ru*divGridVel</div>
<div class="line"><a name="l11668"></a><span class="lineno">11668</span>&#160;                    -            gridVel[0]*drudx - gridVel[1]*drudy);</div>
<div class="line"><a name="l11669"></a><span class="lineno">11669</span>&#160;      divFluxInt[2] = weightJac*(dpdy + v*(abv1-abv2) - lambdaOverMu*abv4*dViscDy</div>
<div class="line"><a name="l11670"></a><span class="lineno">11670</span>&#160;                    +            u*drvdx + v*drvdy</div>
<div class="line"><a name="l11671"></a><span class="lineno">11671</span>&#160;                    -            lambdaOverMu*Viscosity*(d2udxdy + d2vdydy)</div>
<div class="line"><a name="l11672"></a><span class="lineno">11672</span>&#160;                    -            Viscosity*(2.0*d2vdydy + d2vdxdx + d2udxdy)</div>
<div class="line"><a name="l11673"></a><span class="lineno">11673</span>&#160;                    -            dViscDx*(dudy + dvdx) - 2.0*dViscDy*dvdy</div>
<div class="line"><a name="l11674"></a><span class="lineno">11674</span>&#160;                    -            rv*divGridVel</div>
<div class="line"><a name="l11675"></a><span class="lineno">11675</span>&#160;                    -            gridVel[0]*drvdx - gridVel[1]*drvdy);</div>
<div class="line"><a name="l11676"></a><span class="lineno">11676</span>&#160;      divFluxInt[3] = weightJac*(abv3 + Htot*(abv1 - abv2)</div>
<div class="line"><a name="l11677"></a><span class="lineno">11677</span>&#160;                    -            abv4*lambdaOverMu*(Viscosity*abv4 + u*dViscDx + v*dViscDy)</div>
<div class="line"><a name="l11678"></a><span class="lineno">11678</span>&#160;                    -            dkOverCvdx*dedx - dkOverCvdy*dedy - kOverCv*(d2edxdx + d2edydy)</div>
<div class="line"><a name="l11679"></a><span class="lineno">11679</span>&#160;                    -            (Viscosity*dudx + u*dViscDx)*2.0*dudx</div>
<div class="line"><a name="l11680"></a><span class="lineno">11680</span>&#160;                    -            (Viscosity*dvdy + v*dViscDy)*2.0*dvdy</div>
<div class="line"><a name="l11681"></a><span class="lineno">11681</span>&#160;                    -            (Viscosity*dudy + u*dViscDy + Viscosity*dvdx + v*dViscDx)*(dudy + dvdx)</div>
<div class="line"><a name="l11682"></a><span class="lineno">11682</span>&#160;                    -            Viscosity*u*(d2udxdx+d2udydy + (1.0+lambdaOverMu)*(d2udxdx+d2vdxdy))</div>
<div class="line"><a name="l11683"></a><span class="lineno">11683</span>&#160;                    -            Viscosity*v*(d2vdxdx+d2vdydy + (1.0+lambdaOverMu)*(d2udxdy+d2vdydy))</div>
<div class="line"><a name="l11684"></a><span class="lineno">11684</span>&#160;                    -            rE*divGridVel</div>
<div class="line"><a name="l11685"></a><span class="lineno">11685</span>&#160;                    -            gridVel[0]*drEdx - gridVel[1]*drEdy);</div>
<div class="line"><a name="l11686"></a><span class="lineno">11686</span>&#160; </div>
<div class="line"><a name="l11687"></a><span class="lineno">11687</span>&#160;      <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l11688"></a><span class="lineno">11688</span>&#160;<span class="comment">         equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l11689"></a><span class="lineno">11689</span>&#160;<span class="comment">         integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l11690"></a><span class="lineno">11690</span>&#160;<span class="comment">         the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l11691"></a><span class="lineno">11691</span>&#160;<span class="comment">         velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l11692"></a><span class="lineno">11692</span>&#160;      divFluxInt[1] -= weightJac*bodyForceX;</div>
<div class="line"><a name="l11693"></a><span class="lineno">11693</span>&#160;      divFluxInt[2] -= weightJac*bodyForceY;</div>
<div class="line"><a name="l11694"></a><span class="lineno">11694</span>&#160;      divFluxInt[3] -= weightJac*(u*bodyForceX + v*bodyForceY);</div>
<div class="line"><a name="l11695"></a><span class="lineno">11695</span>&#160;    }</div>
<div class="line"><a name="l11696"></a><span class="lineno">11696</span>&#160;  }</div>
<div class="line"><a name="l11697"></a><span class="lineno">11697</span>&#160; </div>
<div class="line"><a name="l11698"></a><span class="lineno">11698</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11699"></a><span class="lineno">11699</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l11700"></a><span class="lineno">11700</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l11701"></a><span class="lineno">11701</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11702"></a><span class="lineno">11702</span>&#160; </div>
<div class="line"><a name="l11703"></a><span class="lineno">11703</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l11704"></a><span class="lineno">11704</span>&#160;}</div>
<div class="line"><a name="l11705"></a><span class="lineno">11705</span>&#160; </div>
<div class="line"><a name="l11706"></a><span class="lineno">11706</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ADER_DG_NonAliasedPredictorResidual_3D(<a class="code" href="class_c_config.html">CConfig</a>              *config,</div>
<div class="line"><a name="l11707"></a><span class="lineno">11707</span>&#160;                                                              <a class="code" href="class_c_volume_element_f_e_m.html">CVolumeElementFEM</a>    *elem,</div>
<div class="line"><a name="l11708"></a><span class="lineno">11708</span>&#160;                                                              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *sol,</div>
<div class="line"><a name="l11709"></a><span class="lineno">11709</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nSimul,</div>
<div class="line"><a name="l11710"></a><span class="lineno">11710</span>&#160;                                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l11711"></a><span class="lineno">11711</span>&#160;                                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *res,</div>
<div class="line"><a name="l11712"></a><span class="lineno">11712</span>&#160;                                                              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>            *work) {</div>
<div class="line"><a name="l11713"></a><span class="lineno">11713</span>&#160; </div>
<div class="line"><a name="l11714"></a><span class="lineno">11714</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector, the inverse of</span></div>
<div class="line"><a name="l11715"></a><span class="lineno">11715</span>&#160;<span class="comment">     the specific heat at constant volume and ratio lambdaOverMu. */</span></div>
<div class="line"><a name="l11716"></a><span class="lineno">11716</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Lam  =  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l11717"></a><span class="lineno">11717</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Turb =  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l11718"></a><span class="lineno">11718</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Gas_Constant      =  config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l11719"></a><span class="lineno">11719</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> CvInv             =  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>/Gas_Constant;</div>
<div class="line"><a name="l11720"></a><span class="lineno">11720</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambdaOverMu      = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>;</div>
<div class="line"><a name="l11721"></a><span class="lineno">11721</span>&#160; </div>
<div class="line"><a name="l11722"></a><span class="lineno">11722</span>&#160;  <span class="comment">/*--- Get the necessary information from the standard element. ---*/</span></div>
<div class="line"><a name="l11723"></a><span class="lineno">11723</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind                = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l11724"></a><span class="lineno">11724</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt               = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l11725"></a><span class="lineno">11725</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs              = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l11726"></a><span class="lineno">11726</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisInt            = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a6fbf928e9b9fa2fd9dab46309e0ed6b6">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l11727"></a><span class="lineno">11727</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *mat2ndDerBasisInt      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#ae4776b34ee12f735df9c227c10149160">GetMat2ndDerBasisFunctionsInt</a>();</div>
<div class="line"><a name="l11728"></a><span class="lineno">11728</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFunctionsIntTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0d8111ae54b825086ea24a9241a361f1">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l11729"></a><span class="lineno">11729</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights                = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l11730"></a><span class="lineno">11730</span>&#160; </div>
<div class="line"><a name="l11731"></a><span class="lineno">11731</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l11732"></a><span class="lineno">11732</span>&#160;  <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l11733"></a><span class="lineno">11733</span>&#160; </div>
<div class="line"><a name="l11734"></a><span class="lineno">11734</span>&#160;  <span class="comment">/* Check if a body force is present and set it accordingly. */</span></div>
<div class="line"><a name="l11735"></a><span class="lineno">11735</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> bodyForceX = 0.0, bodyForceY = 0.0, bodyForceZ = 0.0;</div>
<div class="line"><a name="l11736"></a><span class="lineno">11736</span>&#160;  <span class="keywordflow">if</span>( config-&gt;<a class="code" href="class_c_config.html#a9af4200d2cd764653d2707da4acc7847">GetBody_Force</a>() ) {</div>
<div class="line"><a name="l11737"></a><span class="lineno">11737</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *body_force_vector = config-&gt;<a class="code" href="class_c_config.html#aa6f6ce87c87183da706c9e5521c1b812">GetBody_Force_Vector</a>();</div>
<div class="line"><a name="l11738"></a><span class="lineno">11738</span>&#160;    bodyForceX = body_force_vector[0];</div>
<div class="line"><a name="l11739"></a><span class="lineno">11739</span>&#160;    bodyForceY = body_force_vector[1];</div>
<div class="line"><a name="l11740"></a><span class="lineno">11740</span>&#160;    bodyForceZ = body_force_vector[2];</div>
<div class="line"><a name="l11741"></a><span class="lineno">11741</span>&#160;  }</div>
<div class="line"><a name="l11742"></a><span class="lineno">11742</span>&#160; </div>
<div class="line"><a name="l11743"></a><span class="lineno">11743</span>&#160;  <span class="comment">/* Compute the length scale of the current element for the LES. */</span></div>
<div class="line"><a name="l11744"></a><span class="lineno">11744</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l11745"></a><span class="lineno">11745</span>&#160; </div>
<div class="line"><a name="l11746"></a><span class="lineno">11746</span>&#160;  <span class="comment">/* Set the pointers for solAndGradInt and divFlux to work. The same array</span></div>
<div class="line"><a name="l11747"></a><span class="lineno">11747</span>&#160;<span class="comment">     can be used for both help arrays. */</span></div>
<div class="line"><a name="l11748"></a><span class="lineno">11748</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solAndGradInt = work;</div>
<div class="line"><a name="l11749"></a><span class="lineno">11749</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFlux       = work;</div>
<div class="line"><a name="l11750"></a><span class="lineno">11750</span>&#160; </div>
<div class="line"><a name="l11751"></a><span class="lineno">11751</span>&#160;  <span class="comment">/* Determine the offset between the solution variables and the r-derivatives,</span></div>
<div class="line"><a name="l11752"></a><span class="lineno">11752</span>&#160;<span class="comment">     which is also the offset between the r- and s-derivatives in the</span></div>
<div class="line"><a name="l11753"></a><span class="lineno">11753</span>&#160;<span class="comment">     integration points. */</span></div>
<div class="line"><a name="l11754"></a><span class="lineno">11754</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDerivInt = NPad*nInt;</div>
<div class="line"><a name="l11755"></a><span class="lineno">11755</span>&#160; </div>
<div class="line"><a name="l11756"></a><span class="lineno">11756</span>&#160;  <span class="comment">/* Set the pointer for the second derivatives such that they are stored</span></div>
<div class="line"><a name="l11757"></a><span class="lineno">11757</span>&#160;<span class="comment">     after the first derivatives. */</span></div>
<div class="line"><a name="l11758"></a><span class="lineno">11758</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *secDerSol = solAndGradInt + 4*NPad*nInt;  <span class="comment">/*(nDim+1)*NPad*nInt. */</span></div>
<div class="line"><a name="l11759"></a><span class="lineno">11759</span>&#160; </div>
<div class="line"><a name="l11760"></a><span class="lineno">11760</span>&#160;  <span class="comment">/* Store the number of metric points per integration point for readability. */</span></div>
<div class="line"><a name="l11761"></a><span class="lineno">11761</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = 10;  <span class="comment">/* nDim*nDim + 1. */</span></div>
<div class="line"><a name="l11762"></a><span class="lineno">11762</span>&#160; </div>
<div class="line"><a name="l11763"></a><span class="lineno">11763</span>&#160;  <span class="comment">/* Store the number of additional metric points per integration point, which</span></div>
<div class="line"><a name="l11764"></a><span class="lineno">11764</span>&#160;<span class="comment">     are needed to compute the second derivatives. These terms take the</span></div>
<div class="line"><a name="l11765"></a><span class="lineno">11765</span>&#160;<span class="comment">     non-constant metric into account. */</span></div>
<div class="line"><a name="l11766"></a><span class="lineno">11766</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetric2ndDerPerPoint = 18; <span class="comment">/*nDim*(nDim + nDim*(nDim-1)/2). */</span></div>
<div class="line"><a name="l11767"></a><span class="lineno">11767</span>&#160; </div>
<div class="line"><a name="l11768"></a><span class="lineno">11768</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11769"></a><span class="lineno">11769</span>&#160;  <span class="comment">/*--- Interpolate the solution variables to the integration points and   ---*/</span></div>
<div class="line"><a name="l11770"></a><span class="lineno">11770</span>&#160;  <span class="comment">/*--- also determine the first and second derivatives of these variables ---*/</span></div>
<div class="line"><a name="l11771"></a><span class="lineno">11771</span>&#160;  <span class="comment">/*--- in the integration points. All derivatives are w.r.t. the          ---*/</span></div>
<div class="line"><a name="l11772"></a><span class="lineno">11772</span>&#160;  <span class="comment">/*--- parametric coordinates.                                            ---*/</span></div>
<div class="line"><a name="l11773"></a><span class="lineno">11773</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11774"></a><span class="lineno">11774</span>&#160; </div>
<div class="line"><a name="l11775"></a><span class="lineno">11775</span>&#160;  <span class="comment">/* Compute the solution and the derivatives w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l11776"></a><span class="lineno">11776</span>&#160;<span class="comment">     in the integration points. The first argument is nInt*(nDim+1). */</span></div>
<div class="line"><a name="l11777"></a><span class="lineno">11777</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*4, NPad, nDOFs, matBasisInt, sol, solAndGradInt, config);</div>
<div class="line"><a name="l11778"></a><span class="lineno">11778</span>&#160; </div>
<div class="line"><a name="l11779"></a><span class="lineno">11779</span>&#160;  <span class="comment">/* Compute the second derivatives w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l11780"></a><span class="lineno">11780</span>&#160;<span class="comment">     in the integration points. */</span></div>
<div class="line"><a name="l11781"></a><span class="lineno">11781</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*6, NPad, nDOFs, mat2ndDerBasisInt, sol, secDerSol, config);</div>
<div class="line"><a name="l11782"></a><span class="lineno">11782</span>&#160; </div>
<div class="line"><a name="l11783"></a><span class="lineno">11783</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11784"></a><span class="lineno">11784</span>&#160;  <span class="comment">/*--- Compute the divergence of viscous fluxes, multiplied by the        ---*/</span></div>
<div class="line"><a name="l11785"></a><span class="lineno">11785</span>&#160;  <span class="comment">/*--- integration weight in the integration points of the element.       ---*/</span></div>
<div class="line"><a name="l11786"></a><span class="lineno">11786</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l11787"></a><span class="lineno">11787</span>&#160; </div>
<div class="line"><a name="l11788"></a><span class="lineno">11788</span>&#160;  <span class="comment">/*--- Loop over the number of entities that are treated simultaneously. */</span></div>
<div class="line"><a name="l11789"></a><span class="lineno">11789</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> simul=0; simul&lt;nSimul; ++simul) {</div>
<div class="line"><a name="l11790"></a><span class="lineno">11790</span>&#160; </div>
<div class="line"><a name="l11791"></a><span class="lineno">11791</span>&#160;    <span class="comment">/*--- Loop over the integration points. ---*/</span></div>
<div class="line"><a name="l11792"></a><span class="lineno">11792</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l11793"></a><span class="lineno">11793</span>&#160; </div>
<div class="line"><a name="l11794"></a><span class="lineno">11794</span>&#160;      <span class="comment">/* Easier storage of the locations where the solution and the gradient</span></div>
<div class="line"><a name="l11795"></a><span class="lineno">11795</span>&#160;<span class="comment">         data of this integration point start. */</span></div>
<div class="line"><a name="l11796"></a><span class="lineno">11796</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offInt = NPad*i + simul*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l11797"></a><span class="lineno">11797</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol   = solAndGradInt + offInt;</div>
<div class="line"><a name="l11798"></a><span class="lineno">11798</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDr = sol   + offDerivInt;</div>
<div class="line"><a name="l11799"></a><span class="lineno">11799</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDs = solDr + offDerivInt;</div>
<div class="line"><a name="l11800"></a><span class="lineno">11800</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDt = solDs + offDerivInt;</div>
<div class="line"><a name="l11801"></a><span class="lineno">11801</span>&#160; </div>
<div class="line"><a name="l11802"></a><span class="lineno">11802</span>&#160;      <span class="comment">/* Easier storage of the locations where the second derivatives are</span></div>
<div class="line"><a name="l11803"></a><span class="lineno">11803</span>&#160;<span class="comment">         stored for this integration point. */</span></div>
<div class="line"><a name="l11804"></a><span class="lineno">11804</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDrDr = secDerSol + offInt;</div>
<div class="line"><a name="l11805"></a><span class="lineno">11805</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDrDs = solDrDr   + offDerivInt;</div>
<div class="line"><a name="l11806"></a><span class="lineno">11806</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDsDs = solDrDs   + offDerivInt;</div>
<div class="line"><a name="l11807"></a><span class="lineno">11807</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDrDt = solDsDs   + offDerivInt;</div>
<div class="line"><a name="l11808"></a><span class="lineno">11808</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDsDt = solDrDt   + offDerivInt;</div>
<div class="line"><a name="l11809"></a><span class="lineno">11809</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDtDt = solDsDt   + offDerivInt;</div>
<div class="line"><a name="l11810"></a><span class="lineno">11810</span>&#160; </div>
<div class="line"><a name="l11811"></a><span class="lineno">11811</span>&#160;      <span class="comment">/* Compute the velocities, pressure and total enthalpy</span></div>
<div class="line"><a name="l11812"></a><span class="lineno">11812</span>&#160;<span class="comment">         in this integration point. */</span></div>
<div class="line"><a name="l11813"></a><span class="lineno">11813</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rho = sol[0];</div>
<div class="line"><a name="l11814"></a><span class="lineno">11814</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ru  = sol[1];</div>
<div class="line"><a name="l11815"></a><span class="lineno">11815</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rv  = sol[2];</div>
<div class="line"><a name="l11816"></a><span class="lineno">11816</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rw  = sol[3];</div>
<div class="line"><a name="l11817"></a><span class="lineno">11817</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rE  = sol[4];</div>
<div class="line"><a name="l11818"></a><span class="lineno">11818</span>&#160; </div>
<div class="line"><a name="l11819"></a><span class="lineno">11819</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv       = 1.0/rho;</div>
<div class="line"><a name="l11820"></a><span class="lineno">11820</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = rhoInv*ru;</div>
<div class="line"><a name="l11821"></a><span class="lineno">11821</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = rhoInv*rv;</div>
<div class="line"><a name="l11822"></a><span class="lineno">11822</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w            = rhoInv*rw;</div>
<div class="line"><a name="l11823"></a><span class="lineno">11823</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kinEnergy    = 0.5*(u*u + v*v + w*w);</div>
<div class="line"><a name="l11824"></a><span class="lineno">11824</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = rhoInv*rE;</div>
<div class="line"><a name="l11825"></a><span class="lineno">11825</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - kinEnergy;</div>
<div class="line"><a name="l11826"></a><span class="lineno">11826</span>&#160; </div>
<div class="line"><a name="l11827"></a><span class="lineno">11827</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(rho, StaticEnergy);</div>
<div class="line"><a name="l11828"></a><span class="lineno">11828</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l11829"></a><span class="lineno">11829</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Htot     = rhoInv*(rE + Pressure);</div>
<div class="line"><a name="l11830"></a><span class="lineno">11830</span>&#160; </div>
<div class="line"><a name="l11831"></a><span class="lineno">11831</span>&#160;       <span class="comment">/* Compute the laminar viscosity and its derivative w.r.t. temperature. */</span></div>
<div class="line"><a name="l11832"></a><span class="lineno">11832</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l11833"></a><span class="lineno">11833</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscLamdT   = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#abe5c1bbc7a5822be2ca700a296a0090a">GetdmudT_rho</a>();</div>
<div class="line"><a name="l11834"></a><span class="lineno">11834</span>&#160; </div>
<div class="line"><a name="l11835"></a><span class="lineno">11835</span>&#160;      <span class="comment">/* Set the pointer to the grid velocities in this integration point.</span></div>
<div class="line"><a name="l11836"></a><span class="lineno">11836</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l11837"></a><span class="lineno">11837</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l11838"></a><span class="lineno">11838</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l11839"></a><span class="lineno">11839</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + 3*i; <span class="comment">/* nDim*i. */</span></div>
<div class="line"><a name="l11840"></a><span class="lineno">11840</span>&#160; </div>
<div class="line"><a name="l11841"></a><span class="lineno">11841</span>&#160;      <span class="comment">/* Easier storage of the metric terms in this integration point.</span></div>
<div class="line"><a name="l11842"></a><span class="lineno">11842</span>&#160;<span class="comment">         THIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l11843"></a><span class="lineno">11843</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l11844"></a><span class="lineno">11844</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l11845"></a><span class="lineno">11845</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data() + i*nMetricPerPoint;</div>
<div class="line"><a name="l11846"></a><span class="lineno">11846</span>&#160; </div>
<div class="line"><a name="l11847"></a><span class="lineno">11847</span>&#160;      <span class="comment">/* Compute the true metric terms. Note in metricTerms the actual metric</span></div>
<div class="line"><a name="l11848"></a><span class="lineno">11848</span>&#160;<span class="comment">         terms multiplied by the Jacobian are stored. */</span></div>
<div class="line"><a name="l11849"></a><span class="lineno">11849</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Jac    = metricTerms[0];</div>
<div class="line"><a name="l11850"></a><span class="lineno">11850</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> JacInv = 1.0/Jac;</div>
<div class="line"><a name="l11851"></a><span class="lineno">11851</span>&#160; </div>
<div class="line"><a name="l11852"></a><span class="lineno">11852</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l11853"></a><span class="lineno">11853</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l11854"></a><span class="lineno">11854</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdz = JacInv*metricTerms[3];</div>
<div class="line"><a name="l11855"></a><span class="lineno">11855</span>&#160; </div>
<div class="line"><a name="l11856"></a><span class="lineno">11856</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = JacInv*metricTerms[4];</div>
<div class="line"><a name="l11857"></a><span class="lineno">11857</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = JacInv*metricTerms[5];</div>
<div class="line"><a name="l11858"></a><span class="lineno">11858</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdz = JacInv*metricTerms[6];</div>
<div class="line"><a name="l11859"></a><span class="lineno">11859</span>&#160; </div>
<div class="line"><a name="l11860"></a><span class="lineno">11860</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdx = JacInv*metricTerms[7];</div>
<div class="line"><a name="l11861"></a><span class="lineno">11861</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdy = JacInv*metricTerms[8];</div>
<div class="line"><a name="l11862"></a><span class="lineno">11862</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdz = JacInv*metricTerms[9];</div>
<div class="line"><a name="l11863"></a><span class="lineno">11863</span>&#160; </div>
<div class="line"><a name="l11864"></a><span class="lineno">11864</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l11865"></a><span class="lineno">11865</span>&#160;<span class="comment">         variables from the gradients in parametric coordinates and the</span></div>
<div class="line"><a name="l11866"></a><span class="lineno">11866</span>&#160;<span class="comment">         metric terms in this integration point. */</span></div>
<div class="line"><a name="l11867"></a><span class="lineno">11867</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodx = solDr[0]*drdx + solDs[0]*dsdx + solDt[0]*dtdx;</div>
<div class="line"><a name="l11868"></a><span class="lineno">11868</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudx  = solDr[1]*drdx + solDs[1]*dsdx + solDt[1]*dtdx;</div>
<div class="line"><a name="l11869"></a><span class="lineno">11869</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdx  = solDr[2]*drdx + solDs[2]*dsdx + solDt[2]*dtdx;</div>
<div class="line"><a name="l11870"></a><span class="lineno">11870</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdx  = solDr[3]*drdx + solDs[3]*dsdx + solDt[3]*dtdx;</div>
<div class="line"><a name="l11871"></a><span class="lineno">11871</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdx  = solDr[4]*drdx + solDs[4]*dsdx + solDt[4]*dtdx;</div>
<div class="line"><a name="l11872"></a><span class="lineno">11872</span>&#160; </div>
<div class="line"><a name="l11873"></a><span class="lineno">11873</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhody = solDr[0]*drdy + solDs[0]*dsdy + solDt[0]*dtdy;</div>
<div class="line"><a name="l11874"></a><span class="lineno">11874</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudy  = solDr[1]*drdy + solDs[1]*dsdy + solDt[1]*dtdy;</div>
<div class="line"><a name="l11875"></a><span class="lineno">11875</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdy  = solDr[2]*drdy + solDs[2]*dsdy + solDt[2]*dtdy;</div>
<div class="line"><a name="l11876"></a><span class="lineno">11876</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdy  = solDr[3]*drdy + solDs[3]*dsdy + solDt[3]*dtdy;</div>
<div class="line"><a name="l11877"></a><span class="lineno">11877</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdy  = solDr[4]*drdy + solDs[4]*dsdy + solDt[4]*dtdy;</div>
<div class="line"><a name="l11878"></a><span class="lineno">11878</span>&#160; </div>
<div class="line"><a name="l11879"></a><span class="lineno">11879</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drhodz = solDr[0]*drdz + solDs[0]*dsdz + solDt[0]*dtdz;</div>
<div class="line"><a name="l11880"></a><span class="lineno">11880</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drudz  = solDr[1]*drdz + solDs[1]*dsdz + solDt[1]*dtdz;</div>
<div class="line"><a name="l11881"></a><span class="lineno">11881</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drvdz  = solDr[2]*drdz + solDs[2]*dsdz + solDt[2]*dtdz;</div>
<div class="line"><a name="l11882"></a><span class="lineno">11882</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drwdz  = solDr[3]*drdz + solDs[3]*dsdz + solDt[3]*dtdz;</div>
<div class="line"><a name="l11883"></a><span class="lineno">11883</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drEdz  = solDr[4]*drdz + solDs[4]*dsdz + solDt[4]*dtdz;</div>
<div class="line"><a name="l11884"></a><span class="lineno">11884</span>&#160; </div>
<div class="line"><a name="l11885"></a><span class="lineno">11885</span>&#160;      <span class="comment">/* Pointer to the necessary additional metric terms needed to compute</span></div>
<div class="line"><a name="l11886"></a><span class="lineno">11886</span>&#160;<span class="comment">         the Cartesian second derivatives for this integration point.</span></div>
<div class="line"><a name="l11887"></a><span class="lineno">11887</span>&#160;<span class="comment">         HIS IS A TEMPORARY IMPLEMENTATION. WHEN AN ACTUAL MOTION IS SPECIFIED,</span></div>
<div class="line"><a name="l11888"></a><span class="lineno">11888</span>&#160;<span class="comment">         THE DATA FOR THIS SPATIAL INTEGRATION POINT FOR THE CURRENT TIME</span></div>
<div class="line"><a name="l11889"></a><span class="lineno">11889</span>&#160;<span class="comment">         INTEGRATION POINT MUST BE TAKEN. */</span></div>
<div class="line"><a name="l11890"></a><span class="lineno">11890</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms2ndDer = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a4dce50854c91ee9d721a72bbadd50254">metricTerms2ndDer</a>.data()</div>
<div class="line"><a name="l11891"></a><span class="lineno">11891</span>&#160;                                         + i*nMetric2ndDerPerPoint;</div>
<div class="line"><a name="l11892"></a><span class="lineno">11892</span>&#160; </div>
<div class="line"><a name="l11893"></a><span class="lineno">11893</span>&#160;      <span class="comment">/* Compute the Cartesian second derivatives of the independent solution</span></div>
<div class="line"><a name="l11894"></a><span class="lineno">11894</span>&#160;<span class="comment">         variables from the gradients and second derivatives in parametric</span></div>
<div class="line"><a name="l11895"></a><span class="lineno">11895</span>&#160;<span class="comment">         coordinates and the metric terms and its derivatives w.r.t. the</span></div>
<div class="line"><a name="l11896"></a><span class="lineno">11896</span>&#160;<span class="comment">         parametric coordinates. */</span></div>
<div class="line"><a name="l11897"></a><span class="lineno">11897</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rhodxdx = solDrDr[0]*drdx*drdx + solDsDs[0]*dsdx*dsdx + solDtDt[0]*dtdx*dtdx</div>
<div class="line"><a name="l11898"></a><span class="lineno">11898</span>&#160;                                + 2.0*(solDrDs[0]*drdx*dsdx + solDrDt[0]*drdx*dtdx + solDsDt[0]*dsdx*dtdx)</div>
<div class="line"><a name="l11899"></a><span class="lineno">11899</span>&#160;                                + solDr[0]*metricTerms2ndDer[0] + solDs[0]*metricTerms2ndDer[1]</div>
<div class="line"><a name="l11900"></a><span class="lineno">11900</span>&#160;                                + solDt[0]*metricTerms2ndDer[2];</div>
<div class="line"><a name="l11901"></a><span class="lineno">11901</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rudxdx  = solDrDr[1]*drdx*drdx + solDsDs[1]*dsdx*dsdx + solDtDt[1]*dtdx*dtdx</div>
<div class="line"><a name="l11902"></a><span class="lineno">11902</span>&#160;                                + 2.0*(solDrDs[1]*drdx*dsdx + solDrDt[1]*drdx*dtdx + solDsDt[1]*dsdx*dtdx)</div>
<div class="line"><a name="l11903"></a><span class="lineno">11903</span>&#160;                                + solDr[1]*metricTerms2ndDer[0] + solDs[1]*metricTerms2ndDer[1]</div>
<div class="line"><a name="l11904"></a><span class="lineno">11904</span>&#160;                                + solDt[1]*metricTerms2ndDer[2];</div>
<div class="line"><a name="l11905"></a><span class="lineno">11905</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rvdxdx  = solDrDr[2]*drdx*drdx + solDsDs[2]*dsdx*dsdx + solDtDt[2]*dtdx*dtdx</div>
<div class="line"><a name="l11906"></a><span class="lineno">11906</span>&#160;                                + 2.0*(solDrDs[2]*drdx*dsdx + solDrDt[2]*drdx*dtdx + solDsDt[2]*dsdx*dtdx)</div>
<div class="line"><a name="l11907"></a><span class="lineno">11907</span>&#160;                                + solDr[2]*metricTerms2ndDer[0] + solDs[2]*metricTerms2ndDer[1]</div>
<div class="line"><a name="l11908"></a><span class="lineno">11908</span>&#160;                                + solDt[2]*metricTerms2ndDer[2];</div>
<div class="line"><a name="l11909"></a><span class="lineno">11909</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rwdxdx  = solDrDr[3]*drdx*drdx + solDsDs[3]*dsdx*dsdx + solDtDt[3]*dtdx*dtdx</div>
<div class="line"><a name="l11910"></a><span class="lineno">11910</span>&#160;                                + 2.0*(solDrDs[3]*drdx*dsdx + solDrDt[3]*drdx*dtdx + solDsDt[3]*dsdx*dtdx)</div>
<div class="line"><a name="l11911"></a><span class="lineno">11911</span>&#160;                                + solDr[3]*metricTerms2ndDer[0] + solDs[3]*metricTerms2ndDer[1]</div>
<div class="line"><a name="l11912"></a><span class="lineno">11912</span>&#160;                                + solDt[3]*metricTerms2ndDer[2];</div>
<div class="line"><a name="l11913"></a><span class="lineno">11913</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rEdxdx  = solDrDr[4]*drdx*drdx + solDsDs[4]*dsdx*dsdx + solDtDt[4]*dtdx*dtdx</div>
<div class="line"><a name="l11914"></a><span class="lineno">11914</span>&#160;                                + 2.0*(solDrDs[4]*drdx*dsdx + solDrDt[4]*drdx*dtdx + solDsDt[4]*dsdx*dtdx)</div>
<div class="line"><a name="l11915"></a><span class="lineno">11915</span>&#160;                                + solDr[4]*metricTerms2ndDer[0] + solDs[4]*metricTerms2ndDer[1]</div>
<div class="line"><a name="l11916"></a><span class="lineno">11916</span>&#160;                                + solDt[4]*metricTerms2ndDer[2];</div>
<div class="line"><a name="l11917"></a><span class="lineno">11917</span>&#160; </div>
<div class="line"><a name="l11918"></a><span class="lineno">11918</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rhodydy = solDrDr[0]*drdy*drdy + solDsDs[0]*dsdy*dsdy + solDtDt[0]*dtdy*dtdy</div>
<div class="line"><a name="l11919"></a><span class="lineno">11919</span>&#160;                                + 2.0*(solDrDs[0]*drdy*dsdy + solDrDt[0]*drdy*dtdy + solDsDt[0]*dsdy*dtdy)</div>
<div class="line"><a name="l11920"></a><span class="lineno">11920</span>&#160;                                + solDr[0]*metricTerms2ndDer[6] + solDs[0]*metricTerms2ndDer[7]</div>
<div class="line"><a name="l11921"></a><span class="lineno">11921</span>&#160;                                + solDt[0]*metricTerms2ndDer[8];</div>
<div class="line"><a name="l11922"></a><span class="lineno">11922</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rudydy  = solDrDr[1]*drdy*drdy + solDsDs[1]*dsdy*dsdy + solDtDt[1]*dtdy*dtdy</div>
<div class="line"><a name="l11923"></a><span class="lineno">11923</span>&#160;                                + 2.0*(solDrDs[1]*drdy*dsdy + solDrDt[1]*drdy*dtdy + solDsDt[1]*dsdy*dtdy)</div>
<div class="line"><a name="l11924"></a><span class="lineno">11924</span>&#160;                                + solDr[1]*metricTerms2ndDer[6] + solDs[1]*metricTerms2ndDer[7]</div>
<div class="line"><a name="l11925"></a><span class="lineno">11925</span>&#160;                                + solDt[1]*metricTerms2ndDer[8];</div>
<div class="line"><a name="l11926"></a><span class="lineno">11926</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rvdydy  = solDrDr[2]*drdy*drdy + solDsDs[2]*dsdy*dsdy + solDtDt[2]*dtdy*dtdy</div>
<div class="line"><a name="l11927"></a><span class="lineno">11927</span>&#160;                                + 2.0*(solDrDs[2]*drdy*dsdy + solDrDt[2]*drdy*dtdy + solDsDt[2]*dsdy*dtdy)</div>
<div class="line"><a name="l11928"></a><span class="lineno">11928</span>&#160;                                + solDr[2]*metricTerms2ndDer[6] + solDs[2]*metricTerms2ndDer[7]</div>
<div class="line"><a name="l11929"></a><span class="lineno">11929</span>&#160;                                + solDt[2]*metricTerms2ndDer[8];</div>
<div class="line"><a name="l11930"></a><span class="lineno">11930</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rwdydy  = solDrDr[3]*drdy*drdy + solDsDs[3]*dsdy*dsdy + solDtDt[3]*dtdy*dtdy</div>
<div class="line"><a name="l11931"></a><span class="lineno">11931</span>&#160;                                + 2.0*(solDrDs[3]*drdy*dsdy + solDrDt[3]*drdy*dtdy + solDsDt[3]*dsdy*dtdy)</div>
<div class="line"><a name="l11932"></a><span class="lineno">11932</span>&#160;                                + solDr[3]*metricTerms2ndDer[6] + solDs[3]*metricTerms2ndDer[7]</div>
<div class="line"><a name="l11933"></a><span class="lineno">11933</span>&#160;                                + solDt[3]*metricTerms2ndDer[8];</div>
<div class="line"><a name="l11934"></a><span class="lineno">11934</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rEdydy  = solDrDr[4]*drdy*drdy + solDsDs[4]*dsdy*dsdy + solDtDt[4]*dtdy*dtdy</div>
<div class="line"><a name="l11935"></a><span class="lineno">11935</span>&#160;                                + 2.0*(solDrDs[4]*drdy*dsdy + solDrDt[4]*drdy*dtdy + solDsDt[4]*dsdy*dtdy)</div>
<div class="line"><a name="l11936"></a><span class="lineno">11936</span>&#160;                                + solDr[4]*metricTerms2ndDer[6] + solDs[4]*metricTerms2ndDer[7]</div>
<div class="line"><a name="l11937"></a><span class="lineno">11937</span>&#160;                                + solDt[4]*metricTerms2ndDer[8];</div>
<div class="line"><a name="l11938"></a><span class="lineno">11938</span>&#160; </div>
<div class="line"><a name="l11939"></a><span class="lineno">11939</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rhodzdz = solDrDr[0]*drdz*drdz + solDsDs[0]*dsdz*dsdz + solDtDt[0]*dtdz*dtdz</div>
<div class="line"><a name="l11940"></a><span class="lineno">11940</span>&#160;                                + 2.0*(solDrDs[0]*drdz*dsdz + solDrDt[0]*drdz*dtdz + solDsDt[0]*dsdz*dtdz)</div>
<div class="line"><a name="l11941"></a><span class="lineno">11941</span>&#160;                                + solDr[0]*metricTerms2ndDer[15] + solDs[0]*metricTerms2ndDer[16]</div>
<div class="line"><a name="l11942"></a><span class="lineno">11942</span>&#160;                                + solDt[0]*metricTerms2ndDer[17];</div>
<div class="line"><a name="l11943"></a><span class="lineno">11943</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rudzdz  = solDrDr[1]*drdz*drdz + solDsDs[1]*dsdz*dsdz + solDtDt[1]*dtdz*dtdz</div>
<div class="line"><a name="l11944"></a><span class="lineno">11944</span>&#160;                                + 2.0*(solDrDs[1]*drdz*dsdz + solDrDt[1]*drdz*dtdz + solDsDt[1]*dsdz*dtdz)</div>
<div class="line"><a name="l11945"></a><span class="lineno">11945</span>&#160;                                + solDr[1]*metricTerms2ndDer[15] + solDs[1]*metricTerms2ndDer[16]</div>
<div class="line"><a name="l11946"></a><span class="lineno">11946</span>&#160;                                + solDt[1]*metricTerms2ndDer[17];</div>
<div class="line"><a name="l11947"></a><span class="lineno">11947</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rvdzdz  = solDrDr[2]*drdz*drdz + solDsDs[2]*dsdz*dsdz + solDtDt[2]*dtdz*dtdz</div>
<div class="line"><a name="l11948"></a><span class="lineno">11948</span>&#160;                                + 2.0*(solDrDs[2]*drdz*dsdz + solDrDt[2]*drdz*dtdz + solDsDt[2]*dsdz*dtdz)</div>
<div class="line"><a name="l11949"></a><span class="lineno">11949</span>&#160;                                + solDr[2]*metricTerms2ndDer[15] + solDs[2]*metricTerms2ndDer[16]</div>
<div class="line"><a name="l11950"></a><span class="lineno">11950</span>&#160;                                + solDt[2]*metricTerms2ndDer[17];</div>
<div class="line"><a name="l11951"></a><span class="lineno">11951</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rwdzdz  = solDrDr[3]*drdz*drdz + solDsDs[3]*dsdz*dsdz + solDtDt[3]*dtdz*dtdz</div>
<div class="line"><a name="l11952"></a><span class="lineno">11952</span>&#160;                                + 2.0*(solDrDs[3]*drdz*dsdz + solDrDt[3]*drdz*dtdz + solDsDt[3]*dsdz*dtdz)</div>
<div class="line"><a name="l11953"></a><span class="lineno">11953</span>&#160;                                + solDr[3]*metricTerms2ndDer[15] + solDs[3]*metricTerms2ndDer[16]</div>
<div class="line"><a name="l11954"></a><span class="lineno">11954</span>&#160;                                + solDt[3]*metricTerms2ndDer[17];</div>
<div class="line"><a name="l11955"></a><span class="lineno">11955</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rEdzdz  = solDrDr[4]*drdz*drdz + solDsDs[4]*dsdz*dsdz + solDtDt[4]*dtdz*dtdz</div>
<div class="line"><a name="l11956"></a><span class="lineno">11956</span>&#160;                                + 2.0*(solDrDs[4]*drdz*dsdz + solDrDt[4]*drdz*dtdz + solDsDt[4]*dsdz*dtdz)</div>
<div class="line"><a name="l11957"></a><span class="lineno">11957</span>&#160;                                + solDr[4]*metricTerms2ndDer[15] + solDs[4]*metricTerms2ndDer[16]</div>
<div class="line"><a name="l11958"></a><span class="lineno">11958</span>&#160;                                + solDt[4]*metricTerms2ndDer[17];</div>
<div class="line"><a name="l11959"></a><span class="lineno">11959</span>&#160; </div>
<div class="line"><a name="l11960"></a><span class="lineno">11960</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rhodxdy = solDrDr[0]*drdx*drdy + solDsDs[0]*dsdx*dsdy + solDtDt[0]*dtdx*dtdy</div>
<div class="line"><a name="l11961"></a><span class="lineno">11961</span>&#160;                                + solDrDs[0]*(drdx*dsdy + dsdx*drdy) + solDrDt[0]*(drdx*dtdy + dtdx*drdy)</div>
<div class="line"><a name="l11962"></a><span class="lineno">11962</span>&#160;                                + solDsDt[0]*(dsdx*dtdy + dtdx*dsdy) + solDr[0]*metricTerms2ndDer[3]</div>
<div class="line"><a name="l11963"></a><span class="lineno">11963</span>&#160;                                + solDs[0]*metricTerms2ndDer[4] + solDt[0]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l11964"></a><span class="lineno">11964</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rudxdy  = solDrDr[1]*drdx*drdy + solDsDs[1]*dsdx*dsdy + solDtDt[1]*dtdx*dtdy</div>
<div class="line"><a name="l11965"></a><span class="lineno">11965</span>&#160;                                + solDrDs[1]*(drdx*dsdy + dsdx*drdy) + solDrDt[1]*(drdx*dtdy + dtdx*drdy)</div>
<div class="line"><a name="l11966"></a><span class="lineno">11966</span>&#160;                                + solDsDt[1]*(dsdx*dtdy + dtdx*dsdy) + solDr[1]*metricTerms2ndDer[3]</div>
<div class="line"><a name="l11967"></a><span class="lineno">11967</span>&#160;                                + solDs[1]*metricTerms2ndDer[4] + solDt[1]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l11968"></a><span class="lineno">11968</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rvdxdy  = solDrDr[2]*drdx*drdy + solDsDs[2]*dsdx*dsdy + solDtDt[2]*dtdx*dtdy</div>
<div class="line"><a name="l11969"></a><span class="lineno">11969</span>&#160;                                + solDrDs[2]*(drdx*dsdy + dsdx*drdy) + solDrDt[2]*(drdx*dtdy + dtdx*drdy)</div>
<div class="line"><a name="l11970"></a><span class="lineno">11970</span>&#160;                                + solDsDt[2]*(dsdx*dtdy + dtdx*dsdy) + solDr[2]*metricTerms2ndDer[3]</div>
<div class="line"><a name="l11971"></a><span class="lineno">11971</span>&#160;                                + solDs[2]*metricTerms2ndDer[4] + solDt[2]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l11972"></a><span class="lineno">11972</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rwdxdy  = solDrDr[3]*drdx*drdy + solDsDs[3]*dsdx*dsdy + solDtDt[3]*dtdx*dtdy</div>
<div class="line"><a name="l11973"></a><span class="lineno">11973</span>&#160;                                + solDrDs[3]*(drdx*dsdy + dsdx*drdy) + solDrDt[3]*(drdx*dtdy + dtdx*drdy)</div>
<div class="line"><a name="l11974"></a><span class="lineno">11974</span>&#160;                                + solDsDt[3]*(dsdx*dtdy + dtdx*dsdy) + solDr[3]*metricTerms2ndDer[3]</div>
<div class="line"><a name="l11975"></a><span class="lineno">11975</span>&#160;                                + solDs[3]*metricTerms2ndDer[4] + solDt[3]*metricTerms2ndDer[5];</div>
<div class="line"><a name="l11976"></a><span class="lineno">11976</span>&#160; </div>
<div class="line"><a name="l11977"></a><span class="lineno">11977</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rhodxdz = solDrDr[0]*drdx*drdz + solDsDs[0]*dsdx*dsdz + solDtDt[0]*dtdx*dtdz</div>
<div class="line"><a name="l11978"></a><span class="lineno">11978</span>&#160;                                + solDrDs[0]*(drdx*dsdz + dsdx*drdz) + solDrDt[0]*(drdx*dtdz + dtdx*drdz)</div>
<div class="line"><a name="l11979"></a><span class="lineno">11979</span>&#160;                                + solDsDt[0]*(dsdx*dtdz + dtdx*dsdz) + solDr[0]*metricTerms2ndDer[9]</div>
<div class="line"><a name="l11980"></a><span class="lineno">11980</span>&#160;                                + solDs[0]*metricTerms2ndDer[10] + solDt[0]*metricTerms2ndDer[11];</div>
<div class="line"><a name="l11981"></a><span class="lineno">11981</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rudxdz  = solDrDr[1]*drdx*drdz + solDsDs[1]*dsdx*dsdz + solDtDt[1]*dtdx*dtdz</div>
<div class="line"><a name="l11982"></a><span class="lineno">11982</span>&#160;                                + solDrDs[1]*(drdx*dsdz + dsdx*drdz) + solDrDt[1]*(drdx*dtdz + dtdx*drdz)</div>
<div class="line"><a name="l11983"></a><span class="lineno">11983</span>&#160;                                + solDsDt[1]*(dsdx*dtdz + dtdx*dsdz) + solDr[1]*metricTerms2ndDer[9]</div>
<div class="line"><a name="l11984"></a><span class="lineno">11984</span>&#160;                                + solDs[1]*metricTerms2ndDer[10] + solDt[1]*metricTerms2ndDer[11];</div>
<div class="line"><a name="l11985"></a><span class="lineno">11985</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rvdxdz  = solDrDr[2]*drdx*drdz + solDsDs[2]*dsdx*dsdz + solDtDt[2]*dtdx*dtdz</div>
<div class="line"><a name="l11986"></a><span class="lineno">11986</span>&#160;                                + solDrDs[2]*(drdx*dsdz + dsdx*drdz) + solDrDt[2]*(drdx*dtdz + dtdx*drdz)</div>
<div class="line"><a name="l11987"></a><span class="lineno">11987</span>&#160;                                + solDsDt[2]*(dsdx*dtdz + dtdx*dsdz) + solDr[2]*metricTerms2ndDer[9]</div>
<div class="line"><a name="l11988"></a><span class="lineno">11988</span>&#160;                                + solDs[2]*metricTerms2ndDer[10] + solDt[2]*metricTerms2ndDer[11];</div>
<div class="line"><a name="l11989"></a><span class="lineno">11989</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rwdxdz  = solDrDr[3]*drdx*drdz + solDsDs[3]*dsdx*dsdz + solDtDt[3]*dtdx*dtdz</div>
<div class="line"><a name="l11990"></a><span class="lineno">11990</span>&#160;                                + solDrDs[3]*(drdx*dsdz + dsdx*drdz) + solDrDt[3]*(drdx*dtdz + dtdx*drdz)</div>
<div class="line"><a name="l11991"></a><span class="lineno">11991</span>&#160;                                + solDsDt[3]*(dsdx*dtdz + dtdx*dsdz) + solDr[3]*metricTerms2ndDer[9]</div>
<div class="line"><a name="l11992"></a><span class="lineno">11992</span>&#160;                                + solDs[3]*metricTerms2ndDer[10] + solDt[3]*metricTerms2ndDer[11];</div>
<div class="line"><a name="l11993"></a><span class="lineno">11993</span>&#160; </div>
<div class="line"><a name="l11994"></a><span class="lineno">11994</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rhodydz = solDrDr[0]*drdy*drdz + solDsDs[0]*dsdy*dsdz + solDtDt[0]*dtdy*dtdz</div>
<div class="line"><a name="l11995"></a><span class="lineno">11995</span>&#160;                                + solDrDs[0]*(drdy*dsdz + dsdy*drdz) + solDrDt[0]*(drdy*dtdz + dtdy*drdz)</div>
<div class="line"><a name="l11996"></a><span class="lineno">11996</span>&#160;                                + solDsDt[0]*(dsdy*dtdz + dtdy*dsdz) + solDr[0]*metricTerms2ndDer[12]</div>
<div class="line"><a name="l11997"></a><span class="lineno">11997</span>&#160;                                + solDs[0]*metricTerms2ndDer[13] + solDt[0]*metricTerms2ndDer[14];</div>
<div class="line"><a name="l11998"></a><span class="lineno">11998</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rudydz  = solDrDr[1]*drdy*drdz + solDsDs[1]*dsdy*dsdz + solDtDt[1]*dtdy*dtdz</div>
<div class="line"><a name="l11999"></a><span class="lineno">11999</span>&#160;                                + solDrDs[1]*(drdy*dsdz + dsdy*drdz) + solDrDt[1]*(drdy*dtdz + dtdy*drdz)</div>
<div class="line"><a name="l12000"></a><span class="lineno">12000</span>&#160;                                + solDsDt[1]*(dsdy*dtdz + dtdy*dsdz) + solDr[1]*metricTerms2ndDer[12]</div>
<div class="line"><a name="l12001"></a><span class="lineno">12001</span>&#160;                                + solDs[1]*metricTerms2ndDer[13] + solDt[1]*metricTerms2ndDer[14];</div>
<div class="line"><a name="l12002"></a><span class="lineno">12002</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rvdydz  = solDrDr[2]*drdy*drdz + solDsDs[2]*dsdy*dsdz + solDtDt[2]*dtdy*dtdz</div>
<div class="line"><a name="l12003"></a><span class="lineno">12003</span>&#160;                                + solDrDs[2]*(drdy*dsdz + dsdy*drdz) + solDrDt[2]*(drdy*dtdz + dtdy*drdz)</div>
<div class="line"><a name="l12004"></a><span class="lineno">12004</span>&#160;                                + solDsDt[2]*(dsdy*dtdz + dtdy*dsdz) + solDr[2]*metricTerms2ndDer[12]</div>
<div class="line"><a name="l12005"></a><span class="lineno">12005</span>&#160;                                + solDs[2]*metricTerms2ndDer[13] + solDt[2]*metricTerms2ndDer[14];</div>
<div class="line"><a name="l12006"></a><span class="lineno">12006</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2rwdydz  = solDrDr[3]*drdy*drdz + solDsDs[3]*dsdy*dsdz + solDtDt[3]*dtdy*dtdz</div>
<div class="line"><a name="l12007"></a><span class="lineno">12007</span>&#160;                                + solDrDs[3]*(drdy*dsdz + dsdy*drdz) + solDrDt[3]*(drdy*dtdz + dtdy*drdz)</div>
<div class="line"><a name="l12008"></a><span class="lineno">12008</span>&#160;                                + solDsDt[3]*(dsdy*dtdz + dtdy*dsdz) + solDr[3]*metricTerms2ndDer[12]</div>
<div class="line"><a name="l12009"></a><span class="lineno">12009</span>&#160;                                + solDs[3]*metricTerms2ndDer[13] + solDt[3]*metricTerms2ndDer[14];</div>
<div class="line"><a name="l12010"></a><span class="lineno">12010</span>&#160; </div>
<div class="line"><a name="l12011"></a><span class="lineno">12011</span>&#160;      <span class="comment">/* Compute the Cartesian gradients of the pressure, velocity components,</span></div>
<div class="line"><a name="l12012"></a><span class="lineno">12012</span>&#160;<span class="comment">         static energy and dynamic viscosity. */</span></div>
<div class="line"><a name="l12013"></a><span class="lineno">12013</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dpdx = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdx + kinEnergy*drhodx</div>
<div class="line"><a name="l12014"></a><span class="lineno">12014</span>&#160;                           -                  u*drudx - v*drvdx - w*drwdx);</div>
<div class="line"><a name="l12015"></a><span class="lineno">12015</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dpdy = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdy + kinEnergy*drhody</div>
<div class="line"><a name="l12016"></a><span class="lineno">12016</span>&#160;                           -                  u*drudy - v*drvdy - w*drwdy);</div>
<div class="line"><a name="l12017"></a><span class="lineno">12017</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dpdz = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>*(drEdz + kinEnergy*drhodz</div>
<div class="line"><a name="l12018"></a><span class="lineno">12018</span>&#160;                           -                  u*drudz - v*drvdz - w*drwdz);</div>
<div class="line"><a name="l12019"></a><span class="lineno">12019</span>&#160; </div>
<div class="line"><a name="l12020"></a><span class="lineno">12020</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = rhoInv*(drudx - u*drhodx);</div>
<div class="line"><a name="l12021"></a><span class="lineno">12021</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = rhoInv*(drudy - u*drhody);</div>
<div class="line"><a name="l12022"></a><span class="lineno">12022</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudz = rhoInv*(drudz - u*drhodz);</div>
<div class="line"><a name="l12023"></a><span class="lineno">12023</span>&#160; </div>
<div class="line"><a name="l12024"></a><span class="lineno">12024</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = rhoInv*(drvdx - v*drhodx);</div>
<div class="line"><a name="l12025"></a><span class="lineno">12025</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = rhoInv*(drvdy - v*drhody);</div>
<div class="line"><a name="l12026"></a><span class="lineno">12026</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdz = rhoInv*(drvdz - v*drhodz);</div>
<div class="line"><a name="l12027"></a><span class="lineno">12027</span>&#160; </div>
<div class="line"><a name="l12028"></a><span class="lineno">12028</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdx = rhoInv*(drwdx - w*drhodx);</div>
<div class="line"><a name="l12029"></a><span class="lineno">12029</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdy = rhoInv*(drwdy - w*drhody);</div>
<div class="line"><a name="l12030"></a><span class="lineno">12030</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdz = rhoInv*(drwdz - w*drhodz);</div>
<div class="line"><a name="l12031"></a><span class="lineno">12031</span>&#160; </div>
<div class="line"><a name="l12032"></a><span class="lineno">12032</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dedx = rhoInv*(drEdx - TotalEnergy*drhodx) - u*dudx - v*dvdx - w*dwdx;</div>
<div class="line"><a name="l12033"></a><span class="lineno">12033</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dedy = rhoInv*(drEdy - TotalEnergy*drhody) - u*dudy - v*dvdy - w*dwdy;</div>
<div class="line"><a name="l12034"></a><span class="lineno">12034</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dedz = rhoInv*(drEdz - TotalEnergy*drhodz) - u*dudz - v*dvdz - w*dwdz;</div>
<div class="line"><a name="l12035"></a><span class="lineno">12035</span>&#160; </div>
<div class="line"><a name="l12036"></a><span class="lineno">12036</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscLamdx = CvInv*dedx*dViscLamdT;</div>
<div class="line"><a name="l12037"></a><span class="lineno">12037</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscLamdy = CvInv*dedy*dViscLamdT;</div>
<div class="line"><a name="l12038"></a><span class="lineno">12038</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscLamdz = CvInv*dedz*dViscLamdT;</div>
<div class="line"><a name="l12039"></a><span class="lineno">12039</span>&#160; </div>
<div class="line"><a name="l12040"></a><span class="lineno">12040</span>&#160;      <span class="comment">/*--- Compute the second derivatives of the velocity components. ---*/</span></div>
<div class="line"><a name="l12041"></a><span class="lineno">12041</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2udxdx = rhoInv*(d2rudxdx - u*d2rhodxdx</div>
<div class="line"><a name="l12042"></a><span class="lineno">12042</span>&#160;                              +         2.0*rhoInv*drhodx*(u*drhodx - drudx));</div>
<div class="line"><a name="l12043"></a><span class="lineno">12043</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2udydy = rhoInv*(d2rudydy - u*d2rhodydy</div>
<div class="line"><a name="l12044"></a><span class="lineno">12044</span>&#160;                              +         2.0*rhoInv*drhody*(u*drhody - drudy));</div>
<div class="line"><a name="l12045"></a><span class="lineno">12045</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2udzdz = rhoInv*(d2rudzdz - u*d2rhodzdz</div>
<div class="line"><a name="l12046"></a><span class="lineno">12046</span>&#160;                              +         2.0*rhoInv*drhodz*(u*drhodz - drudz));</div>
<div class="line"><a name="l12047"></a><span class="lineno">12047</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2udxdy = rhoInv*(d2rudxdy - u*d2rhodxdy</div>
<div class="line"><a name="l12048"></a><span class="lineno">12048</span>&#160;                              +         rhoInv*(drhodx*(u*drhody - drudy)</div>
<div class="line"><a name="l12049"></a><span class="lineno">12049</span>&#160;                              +                 drhody*(u*drhodx - drudx)));</div>
<div class="line"><a name="l12050"></a><span class="lineno">12050</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2udxdz = rhoInv*(d2rudxdz - u*d2rhodxdz</div>
<div class="line"><a name="l12051"></a><span class="lineno">12051</span>&#160;                              +         rhoInv*(drhodx*(u*drhodz - drudz)</div>
<div class="line"><a name="l12052"></a><span class="lineno">12052</span>&#160;                              +                 drhodz*(u*drhodx - drudx)));</div>
<div class="line"><a name="l12053"></a><span class="lineno">12053</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2udydz = rhoInv*(d2rudydz - u*d2rhodydz</div>
<div class="line"><a name="l12054"></a><span class="lineno">12054</span>&#160;                              +         rhoInv*(drhody*(u*drhodz - drudz)</div>
<div class="line"><a name="l12055"></a><span class="lineno">12055</span>&#160;                              +                 drhodz*(u*drhody - drudy)));</div>
<div class="line"><a name="l12056"></a><span class="lineno">12056</span>&#160; </div>
<div class="line"><a name="l12057"></a><span class="lineno">12057</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2vdxdx = rhoInv*(d2rvdxdx - v*d2rhodxdx</div>
<div class="line"><a name="l12058"></a><span class="lineno">12058</span>&#160;                              +         2.0*rhoInv*drhodx*(v*drhodx - drvdx));</div>
<div class="line"><a name="l12059"></a><span class="lineno">12059</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2vdydy = rhoInv*(d2rvdydy - v*d2rhodydy</div>
<div class="line"><a name="l12060"></a><span class="lineno">12060</span>&#160;                              +         2.0*rhoInv*drhody*(v*drhody - drvdy));</div>
<div class="line"><a name="l12061"></a><span class="lineno">12061</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2vdzdz = rhoInv*(d2rvdzdz - v*d2rhodzdz</div>
<div class="line"><a name="l12062"></a><span class="lineno">12062</span>&#160;                              +         2.0*rhoInv*drhodz*(v*drhodz - drvdz));</div>
<div class="line"><a name="l12063"></a><span class="lineno">12063</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2vdxdy = rhoInv*(d2rvdxdy - v*d2rhodxdy</div>
<div class="line"><a name="l12064"></a><span class="lineno">12064</span>&#160;                              +         rhoInv*(drhodx*(v*drhody - drvdy)</div>
<div class="line"><a name="l12065"></a><span class="lineno">12065</span>&#160;                              +                 drhody*(v*drhodx - drvdx)));</div>
<div class="line"><a name="l12066"></a><span class="lineno">12066</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2vdxdz = rhoInv*(d2rvdxdz - v*d2rhodxdz</div>
<div class="line"><a name="l12067"></a><span class="lineno">12067</span>&#160;                              +         rhoInv*(drhodx*(v*drhodz - drvdz)</div>
<div class="line"><a name="l12068"></a><span class="lineno">12068</span>&#160;                              +                 drhodz*(v*drhodx - drvdx)));</div>
<div class="line"><a name="l12069"></a><span class="lineno">12069</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2vdydz = rhoInv*(d2rvdydz - v*d2rhodydz</div>
<div class="line"><a name="l12070"></a><span class="lineno">12070</span>&#160;                              +         rhoInv*(drhody*(v*drhodz - drvdz)</div>
<div class="line"><a name="l12071"></a><span class="lineno">12071</span>&#160;                              +                 drhodz*(v*drhody - drvdy)));</div>
<div class="line"><a name="l12072"></a><span class="lineno">12072</span>&#160; </div>
<div class="line"><a name="l12073"></a><span class="lineno">12073</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2wdxdx = rhoInv*(d2rwdxdx - w*d2rhodxdx</div>
<div class="line"><a name="l12074"></a><span class="lineno">12074</span>&#160;                              +         2.0*rhoInv*drhodx*(w*drhodx - drwdx));</div>
<div class="line"><a name="l12075"></a><span class="lineno">12075</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2wdydy = rhoInv*(d2rwdydy - w*d2rhodydy</div>
<div class="line"><a name="l12076"></a><span class="lineno">12076</span>&#160;                              +         2.0*rhoInv*drhody*(w*drhody - drwdy));</div>
<div class="line"><a name="l12077"></a><span class="lineno">12077</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2wdzdz = rhoInv*(d2rwdzdz - w*d2rhodzdz</div>
<div class="line"><a name="l12078"></a><span class="lineno">12078</span>&#160;                              +         2.0*rhoInv*drhodz*(w*drhodz - drwdz));</div>
<div class="line"><a name="l12079"></a><span class="lineno">12079</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2wdxdy = rhoInv*(d2rwdxdy - w*d2rhodxdy</div>
<div class="line"><a name="l12080"></a><span class="lineno">12080</span>&#160;                              +         rhoInv*(drhodx*(w*drhody - drwdy)</div>
<div class="line"><a name="l12081"></a><span class="lineno">12081</span>&#160;                              +                 drhody*(w*drhodx - drwdx)));</div>
<div class="line"><a name="l12082"></a><span class="lineno">12082</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2wdxdz = rhoInv*(d2rwdxdz - w*d2rhodxdz</div>
<div class="line"><a name="l12083"></a><span class="lineno">12083</span>&#160;                              +         rhoInv*(drhodx*(w*drhodz - drwdz)</div>
<div class="line"><a name="l12084"></a><span class="lineno">12084</span>&#160;                              +                 drhodz*(w*drhodx - drwdx)));</div>
<div class="line"><a name="l12085"></a><span class="lineno">12085</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2wdydz = rhoInv*(d2rwdydz - w*d2rhodydz</div>
<div class="line"><a name="l12086"></a><span class="lineno">12086</span>&#160;                              +         rhoInv*(drhody*(w*drhodz - drwdz)</div>
<div class="line"><a name="l12087"></a><span class="lineno">12087</span>&#160;                              +                 drhodz*(w*drhody - drwdy)));</div>
<div class="line"><a name="l12088"></a><span class="lineno">12088</span>&#160; </div>
<div class="line"><a name="l12089"></a><span class="lineno">12089</span>&#160;      <span class="comment">/* Compute the second derivatives of the static energy. Note that this</span></div>
<div class="line"><a name="l12090"></a><span class="lineno">12090</span>&#160;<span class="comment">         term appears in the heat flux and therefore only the pure second</span></div>
<div class="line"><a name="l12091"></a><span class="lineno">12091</span>&#160;<span class="comment">         derivatives are needed. Hence, the cross-derivatives are omitted. */</span></div>
<div class="line"><a name="l12092"></a><span class="lineno">12092</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2edxdx = rhoInv*(d2rEdxdx - TotalEnergy*d2rhodxdx</div>
<div class="line"><a name="l12093"></a><span class="lineno">12093</span>&#160;                              +         2.0*rhoInv*drhodx*(TotalEnergy*drhodx - drEdx))</div>
<div class="line"><a name="l12094"></a><span class="lineno">12094</span>&#160;                              -         u*d2udxdx - dudx*dudx - v*d2vdxdx - dvdx*dvdx</div>
<div class="line"><a name="l12095"></a><span class="lineno">12095</span>&#160;                              -         w*d2wdxdx - dwdx*dwdx;</div>
<div class="line"><a name="l12096"></a><span class="lineno">12096</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2edydy = rhoInv*(d2rEdydy - TotalEnergy*d2rhodydy</div>
<div class="line"><a name="l12097"></a><span class="lineno">12097</span>&#160;                              +         2.0*rhoInv*drhody*(TotalEnergy*drhody - drEdy))</div>
<div class="line"><a name="l12098"></a><span class="lineno">12098</span>&#160;                              -         u*d2udydy - dudy*dudy - v*d2vdydy - dvdy*dvdy</div>
<div class="line"><a name="l12099"></a><span class="lineno">12099</span>&#160;                              -         w*d2wdydy - dwdy*dwdy;</div>
<div class="line"><a name="l12100"></a><span class="lineno">12100</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> d2edzdz = rhoInv*(d2rEdzdz - TotalEnergy*d2rhodzdz</div>
<div class="line"><a name="l12101"></a><span class="lineno">12101</span>&#160;                              +         2.0*rhoInv*drhodz*(TotalEnergy*drhodz - drEdz))</div>
<div class="line"><a name="l12102"></a><span class="lineno">12102</span>&#160;                              -         u*d2udzdz - dudz*dudz - v*d2vdzdz - dvdz*dvdz</div>
<div class="line"><a name="l12103"></a><span class="lineno">12103</span>&#160;                              -         w*d2wdzdz - dwdz*dwdz;</div>
<div class="line"><a name="l12104"></a><span class="lineno">12104</span>&#160; </div>
<div class="line"><a name="l12105"></a><span class="lineno">12105</span>&#160;      <span class="comment">/*--- If an SGS model is used the eddy viscosity and its spatial</span></div>
<div class="line"><a name="l12106"></a><span class="lineno">12106</span>&#160;<span class="comment">            derivatives must be computed. ---*/</span></div>
<div class="line"><a name="l12107"></a><span class="lineno">12107</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l12108"></a><span class="lineno">12108</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscTurbdx = 0.0, dViscTurbdy = 0.0, dViscTurbdz = 0.0;</div>
<div class="line"><a name="l12109"></a><span class="lineno">12109</span>&#160; </div>
<div class="line"><a name="l12110"></a><span class="lineno">12110</span>&#160;      <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l12111"></a><span class="lineno">12111</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dist = elem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#abcd8ed2e51e1429b0f164086419a40ff">wallDistance</a>[i];</div>
<div class="line"><a name="l12112"></a><span class="lineno">12112</span>&#160;        ViscosityTurb = SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#a6017e86477c7d39b542d82a3b2b9f1cd">ComputeEddyViscosity_3D</a>(rho, dudx, dudy, dudz,</div>
<div class="line"><a name="l12113"></a><span class="lineno">12113</span>&#160;                                                          dvdx, dvdy, dvdz, dwdx,</div>
<div class="line"><a name="l12114"></a><span class="lineno">12114</span>&#160;                                                          dwdy, dwdz, lenScale, dist);</div>
<div class="line"><a name="l12115"></a><span class="lineno">12115</span>&#160; </div>
<div class="line"><a name="l12116"></a><span class="lineno">12116</span>&#160;        SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#a2d935e92d5cb774b14e5763ca6389a99">ComputeGradEddyViscosity_3D</a>(rho, drhodx, drhody, drhodz, dudx, dudy,</div>
<div class="line"><a name="l12117"></a><span class="lineno">12117</span>&#160;                                              dudz, dvdx, dvdy, dvdz, dwdx, dwdy, dwdz,</div>
<div class="line"><a name="l12118"></a><span class="lineno">12118</span>&#160;                                              d2udxdx, d2udydy, d2udzdz, d2udxdy,</div>
<div class="line"><a name="l12119"></a><span class="lineno">12119</span>&#160;                                              d2udxdz, d2udydz, d2vdxdx, d2vdydy,</div>
<div class="line"><a name="l12120"></a><span class="lineno">12120</span>&#160;                                              d2vdzdz, d2vdxdy, d2vdxdz, d2vdydz,</div>
<div class="line"><a name="l12121"></a><span class="lineno">12121</span>&#160;                                              d2wdxdx, d2wdydy, d2wdzdz, d2wdxdy,</div>
<div class="line"><a name="l12122"></a><span class="lineno">12122</span>&#160;                                              d2wdxdz, d2wdydz, lenScale, dist,</div>
<div class="line"><a name="l12123"></a><span class="lineno">12123</span>&#160;                                              dViscTurbdx, dViscTurbdy, dViscTurbdz);</div>
<div class="line"><a name="l12124"></a><span class="lineno">12124</span>&#160;      }</div>
<div class="line"><a name="l12125"></a><span class="lineno">12125</span>&#160; </div>
<div class="line"><a name="l12126"></a><span class="lineno">12126</span>&#160;      <span class="comment">/*--- Compute the total viscosity, the total heat conductivity and their</span></div>
<div class="line"><a name="l12127"></a><span class="lineno">12127</span>&#160;<span class="comment">            gradients. Note that the heat conductivity is divided by the Cv,</span></div>
<div class="line"><a name="l12128"></a><span class="lineno">12128</span>&#160;<span class="comment">            because gradients of internal energy are computed and not temperature. ---*/</span></div>
<div class="line"><a name="l12129"></a><span class="lineno">12129</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l12130"></a><span class="lineno">12130</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l12131"></a><span class="lineno">12131</span>&#160;                              + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l12132"></a><span class="lineno">12132</span>&#160; </div>
<div class="line"><a name="l12133"></a><span class="lineno">12133</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscDx = dViscLamdx + dViscTurbdx;</div>
<div class="line"><a name="l12134"></a><span class="lineno">12134</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscDy = dViscLamdy + dViscTurbdy;</div>
<div class="line"><a name="l12135"></a><span class="lineno">12135</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dViscDz = dViscLamdz + dViscTurbdz;</div>
<div class="line"><a name="l12136"></a><span class="lineno">12136</span>&#160; </div>
<div class="line"><a name="l12137"></a><span class="lineno">12137</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dkOverCvdx = dViscLamdx *factHeatFlux_Lam</div>
<div class="line"><a name="l12138"></a><span class="lineno">12138</span>&#160;                                 + dViscTurbdx*factHeatFlux_Turb;</div>
<div class="line"><a name="l12139"></a><span class="lineno">12139</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dkOverCvdy = dViscLamdy *factHeatFlux_Lam</div>
<div class="line"><a name="l12140"></a><span class="lineno">12140</span>&#160;                                 + dViscTurbdy*factHeatFlux_Turb;</div>
<div class="line"><a name="l12141"></a><span class="lineno">12141</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dkOverCvdz = dViscLamdz *factHeatFlux_Lam</div>
<div class="line"><a name="l12142"></a><span class="lineno">12142</span>&#160;                                 + dViscTurbdz*factHeatFlux_Turb;</div>
<div class="line"><a name="l12143"></a><span class="lineno">12143</span>&#160; </div>
<div class="line"><a name="l12144"></a><span class="lineno">12144</span>&#160;      <span class="comment">/* Abbreviations, which make it easier to compute the divergence term. */</span></div>
<div class="line"><a name="l12145"></a><span class="lineno">12145</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv1 = drudx + drvdy + drwdz;</div>
<div class="line"><a name="l12146"></a><span class="lineno">12146</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2 = u*drhodx + v*drhody + w*drhodz;</div>
<div class="line"><a name="l12147"></a><span class="lineno">12147</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv3 = u*(drEdx + dpdx) + v*(drEdy + dpdy) + w*(drEdz + dpdz);</div>
<div class="line"><a name="l12148"></a><span class="lineno">12148</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv4 = dudx + dvdy + dwdz;</div>
<div class="line"><a name="l12149"></a><span class="lineno">12149</span>&#160; </div>
<div class="line"><a name="l12150"></a><span class="lineno">12150</span>&#160;      <span class="comment">/*--- Compute the divergence of the grid velocity.</span></div>
<div class="line"><a name="l12151"></a><span class="lineno">12151</span>&#160;<span class="comment">            SET TO ZERO FOR NOW. THIS IS NOT CORRECT!!!!. ---*/</span></div>
<div class="line"><a name="l12152"></a><span class="lineno">12152</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> divGridVel = 0.0;</div>
<div class="line"><a name="l12153"></a><span class="lineno">12153</span>&#160; </div>
<div class="line"><a name="l12154"></a><span class="lineno">12154</span>&#160;      <span class="comment">/* Set the pointer to store the divergence terms for this integration</span></div>
<div class="line"><a name="l12155"></a><span class="lineno">12155</span>&#160;<span class="comment">         point and compute these terms, multiplied by the integration weight</span></div>
<div class="line"><a name="l12156"></a><span class="lineno">12156</span>&#160;<span class="comment">         and Jacobian. */</span></div>
<div class="line"><a name="l12157"></a><span class="lineno">12157</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*Jac;</div>
<div class="line"><a name="l12158"></a><span class="lineno">12158</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *divFluxInt     = divFlux + offInt;</div>
<div class="line"><a name="l12159"></a><span class="lineno">12159</span>&#160; </div>
<div class="line"><a name="l12160"></a><span class="lineno">12160</span>&#160;      divFluxInt[0] = weightJac*(abv1 - rho*divGridVel - gridVel[0]*drhodx</div>
<div class="line"><a name="l12161"></a><span class="lineno">12161</span>&#160;                    -            gridVel[1]*drhody - gridVel[2]*drhodz);</div>
<div class="line"><a name="l12162"></a><span class="lineno">12162</span>&#160;      divFluxInt[1] = weightJac*(dpdx + u*(abv1-abv2) - lambdaOverMu*abv4*dViscDx</div>
<div class="line"><a name="l12163"></a><span class="lineno">12163</span>&#160;                    +            u*drudx + v*drudy + w*drudz</div>
<div class="line"><a name="l12164"></a><span class="lineno">12164</span>&#160;                    -            lambdaOverMu*Viscosity*(d2udxdx + d2vdxdy + d2wdxdz)</div>
<div class="line"><a name="l12165"></a><span class="lineno">12165</span>&#160;                    -            Viscosity*(2.0*d2udxdx + d2udydy + d2vdxdy + d2udzdz + d2wdxdz)</div>
<div class="line"><a name="l12166"></a><span class="lineno">12166</span>&#160;                    -            2.0*dViscDx*dudx - dViscDy*(dudy+dvdx) - dViscDz*(dudz+dwdx)</div>
<div class="line"><a name="l12167"></a><span class="lineno">12167</span>&#160;                    -            ru*divGridVel</div>
<div class="line"><a name="l12168"></a><span class="lineno">12168</span>&#160;                    -            gridVel[0]*drudx - gridVel[1]*drudy - gridVel[2]*drudz);</div>
<div class="line"><a name="l12169"></a><span class="lineno">12169</span>&#160;      divFluxInt[2] = weightJac*(dpdy + v*(abv1-abv2) - lambdaOverMu*abv4*dViscDy</div>
<div class="line"><a name="l12170"></a><span class="lineno">12170</span>&#160;                    +            u*drvdx + v*drvdy + w*drvdz</div>
<div class="line"><a name="l12171"></a><span class="lineno">12171</span>&#160;                    -            lambdaOverMu*Viscosity*(d2udxdy + d2vdydy + d2wdydz)</div>
<div class="line"><a name="l12172"></a><span class="lineno">12172</span>&#160;                    -            Viscosity*(d2udxdy + d2vdxdx + 2.0*d2vdydy + d2vdzdz + d2wdydz)</div>
<div class="line"><a name="l12173"></a><span class="lineno">12173</span>&#160;                    -            dViscDx*(dudy + dvdx) - 2.0*dViscDy*dvdy - dViscDz*(dvdz+dwdy)</div>
<div class="line"><a name="l12174"></a><span class="lineno">12174</span>&#160;                    -            rv*divGridVel</div>
<div class="line"><a name="l12175"></a><span class="lineno">12175</span>&#160;                    -            gridVel[0]*drvdx - gridVel[1]*drvdy - gridVel[2]*drvdz);</div>
<div class="line"><a name="l12176"></a><span class="lineno">12176</span>&#160;      divFluxInt[3] = weightJac*(dpdz + w*(abv1-abv2) - lambdaOverMu*abv4*dViscDz</div>
<div class="line"><a name="l12177"></a><span class="lineno">12177</span>&#160;                    +            u*drwdx + v*drwdy + w*drwdz</div>
<div class="line"><a name="l12178"></a><span class="lineno">12178</span>&#160;                    -            lambdaOverMu*Viscosity*(d2udxdz + d2vdydz + d2wdzdz)</div>
<div class="line"><a name="l12179"></a><span class="lineno">12179</span>&#160;                    -            Viscosity*(d2udxdz + d2wdxdx + d2vdydz + d2wdydy + 2.0*d2wdzdz)</div>
<div class="line"><a name="l12180"></a><span class="lineno">12180</span>&#160;                    -            dViscDx*(dudz+dwdx) - dViscDy*(dvdz+dwdy) - 2.0*dViscDz*dwdz</div>
<div class="line"><a name="l12181"></a><span class="lineno">12181</span>&#160;                    -            rw*divGridVel</div>
<div class="line"><a name="l12182"></a><span class="lineno">12182</span>&#160;                    -            gridVel[0]*drwdx - gridVel[1]*drwdy - gridVel[2]*drwdz);</div>
<div class="line"><a name="l12183"></a><span class="lineno">12183</span>&#160;      divFluxInt[4] = weightJac*(abv3 + Htot*(abv1 - abv2)</div>
<div class="line"><a name="l12184"></a><span class="lineno">12184</span>&#160;                    -            abv4*lambdaOverMu*(Viscosity*abv4 + u*dViscDx + v*dViscDy + w*dViscDz)</div>
<div class="line"><a name="l12185"></a><span class="lineno">12185</span>&#160;                    -            dkOverCvdx*dedx - dkOverCvdy*dedy - dkOverCvdz*dedz</div>
<div class="line"><a name="l12186"></a><span class="lineno">12186</span>&#160;                    -            kOverCv*(d2edxdx + d2edydy + d2edzdz)</div>
<div class="line"><a name="l12187"></a><span class="lineno">12187</span>&#160;                    -            (Viscosity*dudx + u*dViscDx)*2.0*dudx</div>
<div class="line"><a name="l12188"></a><span class="lineno">12188</span>&#160;                    -            (Viscosity*dvdy + v*dViscDy)*2.0*dvdy</div>
<div class="line"><a name="l12189"></a><span class="lineno">12189</span>&#160;                    -            (Viscosity*dwdz + w*dViscDz)*2.0*dwdz</div>
<div class="line"><a name="l12190"></a><span class="lineno">12190</span>&#160;                    -            (Viscosity*dudy + u*dViscDy + Viscosity*dvdx + v*dViscDx)*(dudy + dvdx)</div>
<div class="line"><a name="l12191"></a><span class="lineno">12191</span>&#160;                    -            (Viscosity*dudz + u*dViscDz + Viscosity*dwdx + w*dViscDx)*(dudz + dwdx)</div>
<div class="line"><a name="l12192"></a><span class="lineno">12192</span>&#160;                    -            (Viscosity*dvdz + v*dViscDz + Viscosity*dwdy + w*dViscDy)*(dvdz + dwdy)</div>
<div class="line"><a name="l12193"></a><span class="lineno">12193</span>&#160;                    -            Viscosity*u*(d2udxdx+d2udydy+d2udzdz + (1.0+lambdaOverMu)*(d2udxdx+d2vdxdy+d2wdxdz))</div>
<div class="line"><a name="l12194"></a><span class="lineno">12194</span>&#160;                    -            Viscosity*v*(d2vdxdx+d2vdydy+d2vdzdz + (1.0+lambdaOverMu)*(d2udxdy+d2vdydy+d2wdydz))</div>
<div class="line"><a name="l12195"></a><span class="lineno">12195</span>&#160;                    -            Viscosity*w*(d2wdxdx+d2wdydy+d2wdzdz + (1.0+lambdaOverMu)*(d2udxdz+d2vdydz+d2wdzdz))</div>
<div class="line"><a name="l12196"></a><span class="lineno">12196</span>&#160;                    -            rE*divGridVel</div>
<div class="line"><a name="l12197"></a><span class="lineno">12197</span>&#160;                    -            gridVel[0]*drEdx - gridVel[1]*drEdy - gridVel[2]*drEdz);</div>
<div class="line"><a name="l12198"></a><span class="lineno">12198</span>&#160; </div>
<div class="line"><a name="l12199"></a><span class="lineno">12199</span>&#160;      <span class="comment">/* Add the body force to the flux divergence for the momentum and energy</span></div>
<div class="line"><a name="l12200"></a><span class="lineno">12200</span>&#160;<span class="comment">         equation. Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l12201"></a><span class="lineno">12201</span>&#160;<span class="comment">         integration weight in order to be consistent with the formulation of</span></div>
<div class="line"><a name="l12202"></a><span class="lineno">12202</span>&#160;<span class="comment">         the residual. Also note that for the energy source term the absolute</span></div>
<div class="line"><a name="l12203"></a><span class="lineno">12203</span>&#160;<span class="comment">         velocity must be taken and not the relative. */</span></div>
<div class="line"><a name="l12204"></a><span class="lineno">12204</span>&#160;      divFluxInt[1] -= weightJac*bodyForceX;</div>
<div class="line"><a name="l12205"></a><span class="lineno">12205</span>&#160;      divFluxInt[2] -= weightJac*bodyForceY;</div>
<div class="line"><a name="l12206"></a><span class="lineno">12206</span>&#160;      divFluxInt[3] -= weightJac*bodyForceZ;</div>
<div class="line"><a name="l12207"></a><span class="lineno">12207</span>&#160;      divFluxInt[4] -= weightJac*(u*bodyForceX + v*bodyForceY + w*bodyForceZ);</div>
<div class="line"><a name="l12208"></a><span class="lineno">12208</span>&#160;    }</div>
<div class="line"><a name="l12209"></a><span class="lineno">12209</span>&#160;  }</div>
<div class="line"><a name="l12210"></a><span class="lineno">12210</span>&#160; </div>
<div class="line"><a name="l12211"></a><span class="lineno">12211</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12212"></a><span class="lineno">12212</span>&#160;  <span class="comment">/*--- Compute the residual in the DOFs, which is the matrix product of   ---*/</span></div>
<div class="line"><a name="l12213"></a><span class="lineno">12213</span>&#160;  <span class="comment">/*--- basisFunctionsIntTrans and divFlux.                                ---*/</span></div>
<div class="line"><a name="l12214"></a><span class="lineno">12214</span>&#160;  <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12215"></a><span class="lineno">12215</span>&#160; </div>
<div class="line"><a name="l12216"></a><span class="lineno">12216</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, basisFunctionsIntTrans, divFlux, res, config);</div>
<div class="line"><a name="l12217"></a><span class="lineno">12217</span>&#160;}</div>
<div class="line"><a name="l12218"></a><span class="lineno">12218</span>&#160; </div>
<div class="line"><a name="l12219"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a6c6944d7036c9cb3e9664f938543b52b">12219</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a6c6944d7036c9cb3e9664f938543b52b">CFEM_DG_NSSolver::Shock_Capturing_DG</a>(<a class="code" href="class_c_config.html">CConfig</a>             *config,</div>
<div class="line"><a name="l12220"></a><span class="lineno">12220</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg,</div>
<div class="line"><a name="l12221"></a><span class="lineno">12221</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd,</div>
<div class="line"><a name="l12222"></a><span class="lineno">12222</span>&#160;                                          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>           *workArray) {</div>
<div class="line"><a name="l12223"></a><span class="lineno">12223</span>&#160; </div>
<div class="line"><a name="l12224"></a><span class="lineno">12224</span>&#160;  <span class="comment">/*--- Run shock capturing algorithm ---*/</span></div>
<div class="line"><a name="l12225"></a><span class="lineno">12225</span>&#160;  <span class="keywordflow">switch</span>( config-&gt;<a class="code" href="class_c_config.html#a2a41cb57187f164b7cbf220e47823116">GetKind_FEM_DG_Shock</a>() ) {</div>
<div class="line"><a name="l12226"></a><span class="lineno">12226</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a0e3c6990687ed4453e660b9db9181885ac157bdf0b85a40d2619cbc8bc1ae5fe2">NONE</a>:</div>
<div class="line"><a name="l12227"></a><span class="lineno">12227</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12228"></a><span class="lineno">12228</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a184f3e05360d2edd70ac64aaa2b29785a0a635ef58892b1996b2178d598e00db4">PERSSON</a>:</div>
<div class="line"><a name="l12229"></a><span class="lineno">12229</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a04fa3111afb642b208d97efe113ff1cf">Shock_Capturing_DG_Persson</a>(elemBeg, elemEnd, workArray);</div>
<div class="line"><a name="l12230"></a><span class="lineno">12230</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12231"></a><span class="lineno">12231</span>&#160;  }</div>
<div class="line"><a name="l12232"></a><span class="lineno">12232</span>&#160; </div>
<div class="line"><a name="l12233"></a><span class="lineno">12233</span>&#160;}</div>
<div class="line"><a name="l12234"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a04fa3111afb642b208d97efe113ff1cf">12234</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a04fa3111afb642b208d97efe113ff1cf">CFEM_DG_NSSolver::Shock_Capturing_DG_Persson</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg,</div>
<div class="line"><a name="l12235"></a><span class="lineno">12235</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd,</div>
<div class="line"><a name="l12236"></a><span class="lineno">12236</span>&#160;                                                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>           *workArray) {</div>
<div class="line"><a name="l12237"></a><span class="lineno">12237</span>&#160; </div>
<div class="line"><a name="l12238"></a><span class="lineno">12238</span>&#160;  <span class="comment">/*--- Dummy variable for storing shock sensor value temporarily ---*/</span></div>
<div class="line"><a name="l12239"></a><span class="lineno">12239</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> sensorVal, sensorLowerBound, machNorm, machMax;</div>
<div class="line"><a name="l12240"></a><span class="lineno">12240</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv, Velocity2, StaticEnergy, SoundSpeed2, Velocity2Rel;</div>
<div class="line"><a name="l12241"></a><span class="lineno">12241</span>&#160; </div>
<div class="line"><a name="l12242"></a><span class="lineno">12242</span>&#160;  <span class="keywordtype">bool</span> shockExist;</div>
<div class="line"><a name="l12243"></a><span class="lineno">12243</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsPm1;       <span class="comment">// Number of DOFs up to polynomial degree p-1</span></div>
<div class="line"><a name="l12244"></a><span class="lineno">12244</span>&#160; </div>
<div class="line"><a name="l12245"></a><span class="lineno">12245</span>&#160;  <span class="comment">/*--- Loop over the given range of elements to sense the shock. If shock exists,</span></div>
<div class="line"><a name="l12246"></a><span class="lineno">12246</span>&#160;<span class="comment">        add artificial viscosity for DG FEM formulation to the residual.  ---*/</span></div>
<div class="line"><a name="l12247"></a><span class="lineno">12247</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBeg; l&lt;elemEnd; ++l) {</div>
<div class="line"><a name="l12248"></a><span class="lineno">12248</span>&#160; </div>
<div class="line"><a name="l12249"></a><span class="lineno">12249</span>&#160;    <span class="comment">/* Get the data from the corresponding standard element. */</span></div>
<div class="line"><a name="l12250"></a><span class="lineno">12250</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind          = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l12251"></a><span class="lineno">12251</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l12252"></a><span class="lineno">12252</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> VTK_TypeElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a2d8cb0d23c35d78eb7f0a1ebc95be2c1">VTK_Type</a>;</div>
<div class="line"><a name="l12253"></a><span class="lineno">12253</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l12254"></a><span class="lineno">12254</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matVanderInv     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a614a01f0feddc3faadac991c7ffc267c">GetMatVandermondeInv</a>();</div>
<div class="line"><a name="l12255"></a><span class="lineno">12255</span>&#160; </div>
<div class="line"><a name="l12256"></a><span class="lineno">12256</span>&#160;    <span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12257"></a><span class="lineno">12257</span>&#160;    <span class="comment">/*--- Step 1: Calculate the number of DOFs up to polynomial degree p-1.    ---*/</span></div>
<div class="line"><a name="l12258"></a><span class="lineno">12258</span>&#160;    <span class="comment">/*----------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12259"></a><span class="lineno">12259</span>&#160; </div>
<div class="line"><a name="l12260"></a><span class="lineno">12260</span>&#160;    nDOFsPm1 = 0;</div>
<div class="line"><a name="l12261"></a><span class="lineno">12261</span>&#160;    <span class="keywordflow">switch</span>( VTK_TypeElem ) {</div>
<div class="line"><a name="l12262"></a><span class="lineno">12262</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a2fd33892864d1c342d3bead2f2d9ad56">TRIANGLE</a>:</div>
<div class="line"><a name="l12263"></a><span class="lineno">12263</span>&#160;        nDOFsPm1 = nPoly*(nPoly+1)/2;</div>
<div class="line"><a name="l12264"></a><span class="lineno">12264</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12265"></a><span class="lineno">12265</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a626d2901e9e521eb60f5681ada30849c">QUADRILATERAL</a>:</div>
<div class="line"><a name="l12266"></a><span class="lineno">12266</span>&#160;        nDOFsPm1 = nPoly*nPoly;</div>
<div class="line"><a name="l12267"></a><span class="lineno">12267</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12268"></a><span class="lineno">12268</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977ad447314c433c39f567ca6bd240eae16a">TETRAHEDRON</a>:</div>
<div class="line"><a name="l12269"></a><span class="lineno">12269</span>&#160;        nDOFsPm1 = nPoly*(nPoly+1)*(nPoly+2)/6;</div>
<div class="line"><a name="l12270"></a><span class="lineno">12270</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12271"></a><span class="lineno">12271</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a3fcd053f6577a9c10a59c3d3595658eb">PYRAMID</a>:</div>
<div class="line"><a name="l12272"></a><span class="lineno">12272</span>&#160;        nDOFsPm1 = nPoly*(nPoly+1)*(2*nPoly+1)/6;</div>
<div class="line"><a name="l12273"></a><span class="lineno">12273</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12274"></a><span class="lineno">12274</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a4cc31b3ed970e3f26bfd2d491b8d7946">PRISM</a>:</div>
<div class="line"><a name="l12275"></a><span class="lineno">12275</span>&#160;        nDOFsPm1 = nPoly*nPoly*(nPoly+1)/2;</div>
<div class="line"><a name="l12276"></a><span class="lineno">12276</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12277"></a><span class="lineno">12277</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977aa67bd73e46a66076a9980159f8011a02">HEXAHEDRON</a>:</div>
<div class="line"><a name="l12278"></a><span class="lineno">12278</span>&#160;        nDOFsPm1 = nPoly*nPoly*nPoly;</div>
<div class="line"><a name="l12279"></a><span class="lineno">12279</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12280"></a><span class="lineno">12280</span>&#160;    }</div>
<div class="line"><a name="l12281"></a><span class="lineno">12281</span>&#160; </div>
<div class="line"><a name="l12282"></a><span class="lineno">12282</span>&#160;    <span class="comment">/*---------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12283"></a><span class="lineno">12283</span>&#160;    <span class="comment">/*--- Step 2: Calculate the shock sensor value for this element.    ---*/</span></div>
<div class="line"><a name="l12284"></a><span class="lineno">12284</span>&#160;    <span class="comment">/*---------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12285"></a><span class="lineno">12285</span>&#160; </div>
<div class="line"><a name="l12286"></a><span class="lineno">12286</span>&#160;    <span class="comment">/* Initialize dummy variable for this volume element */</span></div>
<div class="line"><a name="l12287"></a><span class="lineno">12287</span>&#160;    sensorVal = 0;</div>
<div class="line"><a name="l12288"></a><span class="lineno">12288</span>&#160;    machMax = -1;</div>
<div class="line"><a name="l12289"></a><span class="lineno">12289</span>&#160;    shockExist = <span class="keyword">false</span>;</div>
<div class="line"><a name="l12290"></a><span class="lineno">12290</span>&#160;    sensorLowerBound = 1.e15;</div>
<div class="line"><a name="l12291"></a><span class="lineno">12291</span>&#160; </div>
<div class="line"><a name="l12292"></a><span class="lineno">12292</span>&#160;    <span class="comment">/* Easier storage of the solution variables for this element. */</span></div>
<div class="line"><a name="l12293"></a><span class="lineno">12293</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l12294"></a><span class="lineno">12294</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFs = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l12295"></a><span class="lineno">12295</span>&#160;                             + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l12296"></a><span class="lineno">12296</span>&#160; </div>
<div class="line"><a name="l12297"></a><span class="lineno">12297</span>&#160;    <span class="comment">/* Temporary storage of mach number for DOFs in this element. */</span></div>
<div class="line"><a name="l12298"></a><span class="lineno">12298</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *machSolDOFs = workArray;</div>
<div class="line"><a name="l12299"></a><span class="lineno">12299</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *vecTemp     = machSolDOFs + nDOFs;</div>
<div class="line"><a name="l12300"></a><span class="lineno">12300</span>&#160; </div>
<div class="line"><a name="l12301"></a><span class="lineno">12301</span>&#160;    <span class="comment">/* Calculate primitive variables and mach number for DOFs in this element.</span></div>
<div class="line"><a name="l12302"></a><span class="lineno">12302</span>&#160;<span class="comment">       Also, track the maximum mach number in this element. */</span></div>
<div class="line"><a name="l12303"></a><span class="lineno">12303</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iInd=0; iInd&lt;nDOFs; ++iInd) {</div>
<div class="line"><a name="l12304"></a><span class="lineno">12304</span>&#160; </div>
<div class="line"><a name="l12305"></a><span class="lineno">12305</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol     = solDOFs + iInd*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l12306"></a><span class="lineno">12306</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#a3c90e5beb43d51190439eeadd0f29c74">gridVelocitiesSolDOFs</a>.data() + iInd*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l12307"></a><span class="lineno">12307</span>&#160;      DensityInv = 1.0/sol[0];</div>
<div class="line"><a name="l12308"></a><span class="lineno">12308</span>&#160;      Velocity2 = 0.0;</div>
<div class="line"><a name="l12309"></a><span class="lineno">12309</span>&#160;      Velocity2Rel = 0.0;</div>
<div class="line"><a name="l12310"></a><span class="lineno">12310</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=1; iDim&lt;=<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l12311"></a><span class="lineno">12311</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel    = sol[iDim]*DensityInv;</div>
<div class="line"><a name="l12312"></a><span class="lineno">12312</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velRel = vel - gridVel[iDim-1];</div>
<div class="line"><a name="l12313"></a><span class="lineno">12313</span>&#160;        Velocity2    += vel*vel;</div>
<div class="line"><a name="l12314"></a><span class="lineno">12314</span>&#160;        Velocity2Rel += velRel*velRel;</div>
<div class="line"><a name="l12315"></a><span class="lineno">12315</span>&#160;      }</div>
<div class="line"><a name="l12316"></a><span class="lineno">12316</span>&#160; </div>
<div class="line"><a name="l12317"></a><span class="lineno">12317</span>&#160;      StaticEnergy = sol[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1]*DensityInv - 0.5*Velocity2;</div>
<div class="line"><a name="l12318"></a><span class="lineno">12318</span>&#160; </div>
<div class="line"><a name="l12319"></a><span class="lineno">12319</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l12320"></a><span class="lineno">12320</span>&#160;      SoundSpeed2 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a8c0910de10905f2ddcf02f1a9bb7ff61">GetSoundSpeed2</a>();</div>
<div class="line"><a name="l12321"></a><span class="lineno">12321</span>&#160;      machSolDOFs[iInd] = sqrt( Velocity2Rel/SoundSpeed2 );</div>
<div class="line"><a name="l12322"></a><span class="lineno">12322</span>&#160;      machMax = max(machSolDOFs[iInd],machMax);</div>
<div class="line"><a name="l12323"></a><span class="lineno">12323</span>&#160;    }</div>
<div class="line"><a name="l12324"></a><span class="lineno">12324</span>&#160; </div>
<div class="line"><a name="l12325"></a><span class="lineno">12325</span>&#160;    <span class="comment">/* Change the solution coefficients to modal form from nodal form */</span></div>
<div class="line"><a name="l12326"></a><span class="lineno">12326</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l12327"></a><span class="lineno">12327</span>&#160;      vecTemp[i] = 0.0;</div>
<div class="line"><a name="l12328"></a><span class="lineno">12328</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;nDOFs; ++j)</div>
<div class="line"><a name="l12329"></a><span class="lineno">12329</span>&#160;        vecTemp[i] += matVanderInv[i+j*nDOFs]*machSolDOFs[j];</div>
<div class="line"><a name="l12330"></a><span class="lineno">12330</span>&#160;    }</div>
<div class="line"><a name="l12331"></a><span class="lineno">12331</span>&#160; </div>
<div class="line"><a name="l12332"></a><span class="lineno">12332</span>&#160;    <span class="comment">/* Get the L2 norm of solution coefficients for the highest polynomial order. */</span></div>
<div class="line"><a name="l12333"></a><span class="lineno">12333</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=nDOFsPm1; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l12334"></a><span class="lineno">12334</span>&#160;        sensorVal += vecTemp[i]*vecTemp[i];</div>
<div class="line"><a name="l12335"></a><span class="lineno">12335</span>&#160;    }</div>
<div class="line"><a name="l12336"></a><span class="lineno">12336</span>&#160; </div>
<div class="line"><a name="l12337"></a><span class="lineno">12337</span>&#160;    <span class="comment">/* If the maximum mach number is greater than 1.0, try to calculate the shockSensorValue.</span></div>
<div class="line"><a name="l12338"></a><span class="lineno">12338</span>&#160;<span class="comment">       Otherwise, assign default value. */</span></div>
<div class="line"><a name="l12339"></a><span class="lineno">12339</span>&#160;    <span class="keywordflow">if</span> ( machMax &gt; 1.0) {</div>
<div class="line"><a name="l12340"></a><span class="lineno">12340</span>&#160;      <span class="comment">// !!!!!Threshold value for sensorVal should be further investigated</span></div>
<div class="line"><a name="l12341"></a><span class="lineno">12341</span>&#160;      <span class="keywordflow">if</span>(sensorVal &gt; 1.e-15) {</div>
<div class="line"><a name="l12342"></a><span class="lineno">12342</span>&#160;        machNorm = 0.0;</div>
<div class="line"><a name="l12343"></a><span class="lineno">12343</span>&#160; </div>
<div class="line"><a name="l12344"></a><span class="lineno">12344</span>&#160;        <span class="comment">/*--- Get L2 norm square of vecTemp ---*/</span></div>
<div class="line"><a name="l12345"></a><span class="lineno">12345</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i) {</div>
<div class="line"><a name="l12346"></a><span class="lineno">12346</span>&#160;          machNorm += vecTemp[i]*vecTemp[i];</div>
<div class="line"><a name="l12347"></a><span class="lineno">12347</span>&#160;        }</div>
<div class="line"><a name="l12348"></a><span class="lineno">12348</span>&#160;        <span class="keywordflow">if</span> (machNorm &lt; 1.e-15) {</div>
<div class="line"><a name="l12349"></a><span class="lineno">12349</span>&#160;          <span class="comment">// This should not happen</span></div>
<div class="line"><a name="l12350"></a><span class="lineno">12350</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#afee7aa41b9ef5cb33a6239ef2961fc57">shockSensorValue</a> = 1000.0;</div>
<div class="line"><a name="l12351"></a><span class="lineno">12351</span>&#160;        }</div>
<div class="line"><a name="l12352"></a><span class="lineno">12352</span>&#160;        <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12353"></a><span class="lineno">12353</span>&#160;          <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#afee7aa41b9ef5cb33a6239ef2961fc57">shockSensorValue</a> = log(sensorVal/machNorm);</div>
<div class="line"><a name="l12354"></a><span class="lineno">12354</span>&#160;          shockExist = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12355"></a><span class="lineno">12355</span>&#160;        }</div>
<div class="line"><a name="l12356"></a><span class="lineno">12356</span>&#160;      }</div>
<div class="line"><a name="l12357"></a><span class="lineno">12357</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12358"></a><span class="lineno">12358</span>&#160;        <span class="comment">// There is no shock in this element</span></div>
<div class="line"><a name="l12359"></a><span class="lineno">12359</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#afee7aa41b9ef5cb33a6239ef2961fc57">shockSensorValue</a> = -1000.0;</div>
<div class="line"><a name="l12360"></a><span class="lineno">12360</span>&#160;      }</div>
<div class="line"><a name="l12361"></a><span class="lineno">12361</span>&#160;    }</div>
<div class="line"><a name="l12362"></a><span class="lineno">12362</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12363"></a><span class="lineno">12363</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#afee7aa41b9ef5cb33a6239ef2961fc57">shockSensorValue</a> = -1000.0;</div>
<div class="line"><a name="l12364"></a><span class="lineno">12364</span>&#160;    }</div>
<div class="line"><a name="l12365"></a><span class="lineno">12365</span>&#160; </div>
<div class="line"><a name="l12366"></a><span class="lineno">12366</span>&#160;    <span class="comment">/*---------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12367"></a><span class="lineno">12367</span>&#160;    <span class="comment">/*--- Step 3: Determine artificial viscosity for this element.      ---*/</span></div>
<div class="line"><a name="l12368"></a><span class="lineno">12368</span>&#160;    <span class="comment">/*---------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12369"></a><span class="lineno">12369</span>&#160;    <span class="keywordflow">if</span> (shockExist) {</div>
<div class="line"><a name="l12370"></a><span class="lineno">12370</span>&#160;      <span class="comment">// Following if-else clause is purely empirical from NACA0012 case.</span></div>
<div class="line"><a name="l12371"></a><span class="lineno">12371</span>&#160;      <span class="comment">// Need to develop thorough method for general problems.</span></div>
<div class="line"><a name="l12372"></a><span class="lineno">12372</span>&#160;      <span class="keywordflow">switch</span> ( nPoly ) {</div>
<div class="line"><a name="l12373"></a><span class="lineno">12373</span>&#160;        <span class="keywordflow">case</span> 1:  sensorLowerBound =  -6.0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12374"></a><span class="lineno">12374</span>&#160;        <span class="keywordflow">case</span> 2:  sensorLowerBound = -12.0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12375"></a><span class="lineno">12375</span>&#160;        <span class="keywordflow">case</span> 3:  sensorLowerBound = -12.0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12376"></a><span class="lineno">12376</span>&#160;        <span class="keywordflow">case</span> 4:  sensorLowerBound = -17.0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12377"></a><span class="lineno">12377</span>&#160;        <span class="keywordflow">default</span>: sensorLowerBound = -17.0; <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12378"></a><span class="lineno">12378</span>&#160;      }</div>
<div class="line"><a name="l12379"></a><span class="lineno">12379</span>&#160; </div>
<div class="line"><a name="l12380"></a><span class="lineno">12380</span>&#160;      <span class="comment">// Assign artificial viscosity based on shockSensorValue</span></div>
<div class="line"><a name="l12381"></a><span class="lineno">12381</span>&#160;      <span class="keywordflow">if</span> ( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].shockSensorValue &gt; sensorLowerBound ) {</div>
<div class="line"><a name="l12382"></a><span class="lineno">12382</span>&#160;        <span class="comment">// Following value is initial guess.</span></div>
<div class="line"><a name="l12383"></a><span class="lineno">12383</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af8d803542e4530244295b095f0e40dcb">shockArtificialViscosity</a> = 1.e-10;</div>
<div class="line"><a name="l12384"></a><span class="lineno">12384</span>&#160;      }</div>
<div class="line"><a name="l12385"></a><span class="lineno">12385</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12386"></a><span class="lineno">12386</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af8d803542e4530244295b095f0e40dcb">shockArtificialViscosity</a> = 0.0;</div>
<div class="line"><a name="l12387"></a><span class="lineno">12387</span>&#160;      }</div>
<div class="line"><a name="l12388"></a><span class="lineno">12388</span>&#160;    }</div>
<div class="line"><a name="l12389"></a><span class="lineno">12389</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l12390"></a><span class="lineno">12390</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af8d803542e4530244295b095f0e40dcb">shockArtificialViscosity</a> = 0.0;</div>
<div class="line"><a name="l12391"></a><span class="lineno">12391</span>&#160;    }</div>
<div class="line"><a name="l12392"></a><span class="lineno">12392</span>&#160;  }</div>
<div class="line"><a name="l12393"></a><span class="lineno">12393</span>&#160;}</div>
<div class="line"><a name="l12394"></a><span class="lineno">12394</span>&#160; </div>
<div class="line"><a name="l12395"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#ac62df058348ffee37a945bcc3a66745b">12395</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#ac62df058348ffee37a945bcc3a66745b">CFEM_DG_NSSolver::Volume_Residual</a>(<a class="code" href="class_c_config.html">CConfig</a>             *config,</div>
<div class="line"><a name="l12396"></a><span class="lineno">12396</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemBeg,</div>
<div class="line"><a name="l12397"></a><span class="lineno">12397</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemEnd,</div>
<div class="line"><a name="l12398"></a><span class="lineno">12398</span>&#160;                                       <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>           *workArray) {</div>
<div class="line"><a name="l12399"></a><span class="lineno">12399</span>&#160; </div>
<div class="line"><a name="l12400"></a><span class="lineno">12400</span>&#160;  <span class="comment">/*--- Determine whether a body force term is present. ---*/</span></div>
<div class="line"><a name="l12401"></a><span class="lineno">12401</span>&#160;  <span class="keywordtype">bool</span> body_force = config-&gt;<a class="code" href="class_c_config.html#a9af4200d2cd764653d2707da4acc7847">GetBody_Force</a>();</div>
<div class="line"><a name="l12402"></a><span class="lineno">12402</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *body_force_vector = body_force ? config-&gt;<a class="code" href="class_c_config.html#aa6f6ce87c87183da706c9e5521c1b812">GetBody_Force_Vector</a>() : NULL;</div>
<div class="line"><a name="l12403"></a><span class="lineno">12403</span>&#160; </div>
<div class="line"><a name="l12404"></a><span class="lineno">12404</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector. */</span></div>
<div class="line"><a name="l12405"></a><span class="lineno">12405</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Lam  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l12406"></a><span class="lineno">12406</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Turb = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l12407"></a><span class="lineno">12407</span>&#160; </div>
<div class="line"><a name="l12408"></a><span class="lineno">12408</span>&#160;  <span class="comment">/* Determine the number of elements that are treated simultaneously</span></div>
<div class="line"><a name="l12409"></a><span class="lineno">12409</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l12410"></a><span class="lineno">12410</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l12411"></a><span class="lineno">12411</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nElemSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l12412"></a><span class="lineno">12412</span>&#160; </div>
<div class="line"><a name="l12413"></a><span class="lineno">12413</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l12414"></a><span class="lineno">12414</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l12415"></a><span class="lineno">12415</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l12416"></a><span class="lineno">12416</span>&#160; </div>
<div class="line"><a name="l12417"></a><span class="lineno">12417</span>&#160;  <span class="comment">/* Set the number of bytes that must be copied in the memcpy calls. */</span></div>
<div class="line"><a name="l12418"></a><span class="lineno">12418</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l12419"></a><span class="lineno">12419</span>&#160; </div>
<div class="line"><a name="l12420"></a><span class="lineno">12420</span>&#160;  <span class="comment">/* Store the number of metric points per integration point, which depends</span></div>
<div class="line"><a name="l12421"></a><span class="lineno">12421</span>&#160;<span class="comment">     on the number of dimensions. */</span></div>
<div class="line"><a name="l12422"></a><span class="lineno">12422</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nMetricPerPoint = <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> + 1;</div>
<div class="line"><a name="l12423"></a><span class="lineno">12423</span>&#160; </div>
<div class="line"><a name="l12424"></a><span class="lineno">12424</span>&#160;  <span class="comment">/*--- Loop over the given element range to compute the contribution of the</span></div>
<div class="line"><a name="l12425"></a><span class="lineno">12425</span>&#160;<span class="comment">        volume integral in the DG FEM formulation to the residual. Multiple</span></div>
<div class="line"><a name="l12426"></a><span class="lineno">12426</span>&#160;<span class="comment">        elements are treated simultaneously to improve the performance</span></div>
<div class="line"><a name="l12427"></a><span class="lineno">12427</span>&#160;<span class="comment">        of the matrix multiplications. As a consequence, the update of the</span></div>
<div class="line"><a name="l12428"></a><span class="lineno">12428</span>&#160;<span class="comment">        counter l happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l12429"></a><span class="lineno">12429</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=elemBeg; l&lt;elemEnd;) {</div>
<div class="line"><a name="l12430"></a><span class="lineno">12430</span>&#160; </div>
<div class="line"><a name="l12431"></a><span class="lineno">12431</span>&#160;    <span class="comment">/* Determine the end index for this chunk of elements and the padded</span></div>
<div class="line"><a name="l12432"></a><span class="lineno">12432</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l12433"></a><span class="lineno">12433</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l12434"></a><span class="lineno">12434</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l12435"></a><span class="lineno">12435</span>&#160; </div>
<div class="line"><a name="l12436"></a><span class="lineno">12436</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>, l, elemEnd, nElemSimul, nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l12437"></a><span class="lineno">12437</span>&#160; </div>
<div class="line"><a name="l12438"></a><span class="lineno">12438</span>&#160;    <span class="comment">/* Get the required data from the corresponding standard element. */</span></div>
<div class="line"><a name="l12439"></a><span class="lineno">12439</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt            = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l12440"></a><span class="lineno">12440</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs           = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[l].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l12441"></a><span class="lineno">12441</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisInt         = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a6fbf928e9b9fa2fd9dab46309e0ed6b6">GetMatBasisFunctionsIntegration</a>();</div>
<div class="line"><a name="l12442"></a><span class="lineno">12442</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matDerBasisIntTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0889b7c7bd8849913fabb2b4053c4b7d">GetDerMatBasisFunctionsIntTrans</a>();</div>
<div class="line"><a name="l12443"></a><span class="lineno">12443</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *matBasisIntTrans    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a0d8111ae54b825086ea24a9241a361f1">GetBasisFunctionsIntegrationTrans</a>();</div>
<div class="line"><a name="l12444"></a><span class="lineno">12444</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights             = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l12445"></a><span class="lineno">12445</span>&#160; </div>
<div class="line"><a name="l12446"></a><span class="lineno">12446</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l12447"></a><span class="lineno">12447</span>&#160;    <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l12448"></a><span class="lineno">12448</span>&#160; </div>
<div class="line"><a name="l12449"></a><span class="lineno">12449</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l12450"></a><span class="lineno">12450</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFs       = workArray;</div>
<div class="line"><a name="l12451"></a><span class="lineno">12451</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sources       = solDOFs       + nDOFs*NPad;</div>
<div class="line"><a name="l12452"></a><span class="lineno">12452</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solAndGradInt = sources       + nInt *NPad;</div>
<div class="line"><a name="l12453"></a><span class="lineno">12453</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxes        = solAndGradInt + nInt *NPad*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l12454"></a><span class="lineno">12454</span>&#160; </div>
<div class="line"><a name="l12455"></a><span class="lineno">12455</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12456"></a><span class="lineno">12456</span>&#160;    <span class="comment">/*--- Step 1: Determine the solution variables and their gradients     ---*/</span></div>
<div class="line"><a name="l12457"></a><span class="lineno">12457</span>&#160;    <span class="comment">/*---         w.r.t. the parametric coordinates in the integration     ---*/</span></div>
<div class="line"><a name="l12458"></a><span class="lineno">12458</span>&#160;    <span class="comment">/*---         points of the element.                                   ---*/</span></div>
<div class="line"><a name="l12459"></a><span class="lineno">12459</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12460"></a><span class="lineno">12460</span>&#160; </div>
<div class="line"><a name="l12461"></a><span class="lineno">12461</span>&#160;    <span class="comment">/* Copy the solution of the DOFs into solDOFs for this chunk of elements. */</span></div>
<div class="line"><a name="l12462"></a><span class="lineno">12462</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l12463"></a><span class="lineno">12463</span>&#160; </div>
<div class="line"><a name="l12464"></a><span class="lineno">12464</span>&#160;      <span class="comment">/* Easier storage of the solution variables for this element. */</span></div>
<div class="line"><a name="l12465"></a><span class="lineno">12465</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lInd = l + ll;</div>
<div class="line"><a name="l12466"></a><span class="lineno">12466</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l12467"></a><span class="lineno">12467</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFsElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l12468"></a><span class="lineno">12468</span>&#160;                                   + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l12469"></a><span class="lineno">12469</span>&#160; </div>
<div class="line"><a name="l12470"></a><span class="lineno">12470</span>&#160;      <span class="comment">/* Loop over the DOFs and copy the data. */</span></div>
<div class="line"><a name="l12471"></a><span class="lineno">12471</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l12472"></a><span class="lineno">12472</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i)</div>
<div class="line"><a name="l12473"></a><span class="lineno">12473</span>&#160;        memcpy(solDOFs+i*NPad+llNVar, solDOFsElem+i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, nBytes);</div>
<div class="line"><a name="l12474"></a><span class="lineno">12474</span>&#160;    }</div>
<div class="line"><a name="l12475"></a><span class="lineno">12475</span>&#160; </div>
<div class="line"><a name="l12476"></a><span class="lineno">12476</span>&#160;    <span class="comment">/* Call the general function to carry out the matrix product to determine</span></div>
<div class="line"><a name="l12477"></a><span class="lineno">12477</span>&#160;<span class="comment">       the solution and gradients in the integration points of the chunk</span></div>
<div class="line"><a name="l12478"></a><span class="lineno">12478</span>&#160;<span class="comment">       of elements. */</span></div>
<div class="line"><a name="l12479"></a><span class="lineno">12479</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1), NPad, nDOFs, matBasisInt, solDOFs, solAndGradInt, config);</div>
<div class="line"><a name="l12480"></a><span class="lineno">12480</span>&#160; </div>
<div class="line"><a name="l12481"></a><span class="lineno">12481</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12482"></a><span class="lineno">12482</span>&#160;    <span class="comment">/*--- Step 2: Compute the total fluxes (inviscid fluxes minus the      ---*/</span></div>
<div class="line"><a name="l12483"></a><span class="lineno">12483</span>&#160;    <span class="comment">/*---         viscous fluxes), multiplied by minus the integration     ---*/</span></div>
<div class="line"><a name="l12484"></a><span class="lineno">12484</span>&#160;    <span class="comment">/*---         weight, in the integration points.                       ---*/</span></div>
<div class="line"><a name="l12485"></a><span class="lineno">12485</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12486"></a><span class="lineno">12486</span>&#160; </div>
<div class="line"><a name="l12487"></a><span class="lineno">12487</span>&#160;    <span class="comment">/* Determine the offset between the solution variables and the r-derivatives,</span></div>
<div class="line"><a name="l12488"></a><span class="lineno">12488</span>&#160;<span class="comment">       which is also the offset between the r- and s-derivatives and the offset</span></div>
<div class="line"><a name="l12489"></a><span class="lineno">12489</span>&#160;<span class="comment">       between s- and t-derivatives. */</span></div>
<div class="line"><a name="l12490"></a><span class="lineno">12490</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l12491"></a><span class="lineno">12491</span>&#160; </div>
<div class="line"><a name="l12492"></a><span class="lineno">12492</span>&#160;    <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l12493"></a><span class="lineno">12493</span>&#160;<span class="comment">        in order to have the most efficient code. */</span></div>
<div class="line"><a name="l12494"></a><span class="lineno">12494</span>&#160;    <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l12495"></a><span class="lineno">12495</span>&#160; </div>
<div class="line"><a name="l12496"></a><span class="lineno">12496</span>&#160;      <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l12497"></a><span class="lineno">12497</span>&#160; </div>
<div class="line"><a name="l12498"></a><span class="lineno">12498</span>&#160;        <span class="comment">/* 2D simulation. Loop over the chunk of elements and loop over the</span></div>
<div class="line"><a name="l12499"></a><span class="lineno">12499</span>&#160;<span class="comment">           integration points of the elements to compute the fluxes. */</span></div>
<div class="line"><a name="l12500"></a><span class="lineno">12500</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l12501"></a><span class="lineno">12501</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l12502"></a><span class="lineno">12502</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l12503"></a><span class="lineno">12503</span>&#160; </div>
<div class="line"><a name="l12504"></a><span class="lineno">12504</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l12505"></a><span class="lineno">12505</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iNPad = i*NPad;</div>
<div class="line"><a name="l12506"></a><span class="lineno">12506</span>&#160; </div>
<div class="line"><a name="l12507"></a><span class="lineno">12507</span>&#160;            <span class="comment">/* Easier storage of the metric terms and grid velocities in this</span></div>
<div class="line"><a name="l12508"></a><span class="lineno">12508</span>&#160;<span class="comment">               integration point and compute the inverse of the Jacobian. */</span></div>
<div class="line"><a name="l12509"></a><span class="lineno">12509</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data()</div>
<div class="line"><a name="l12510"></a><span class="lineno">12510</span>&#160;                                         + i*nMetricPerPoint;</div>
<div class="line"><a name="l12511"></a><span class="lineno">12511</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l12512"></a><span class="lineno">12512</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Jac          = metricTerms[0];</div>
<div class="line"><a name="l12513"></a><span class="lineno">12513</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> JacInv       = 1.0/Jac;</div>
<div class="line"><a name="l12514"></a><span class="lineno">12514</span>&#160; </div>
<div class="line"><a name="l12515"></a><span class="lineno">12515</span>&#160;            <span class="comment">/* Compute the true metric terms in this integration point. */</span></div>
<div class="line"><a name="l12516"></a><span class="lineno">12516</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l12517"></a><span class="lineno">12517</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l12518"></a><span class="lineno">12518</span>&#160; </div>
<div class="line"><a name="l12519"></a><span class="lineno">12519</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = JacInv*metricTerms[3];</div>
<div class="line"><a name="l12520"></a><span class="lineno">12520</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = JacInv*metricTerms[4];</div>
<div class="line"><a name="l12521"></a><span class="lineno">12521</span>&#160; </div>
<div class="line"><a name="l12522"></a><span class="lineno">12522</span>&#160;            <span class="comment">/* Compute the metric terms multiplied by minus the integration weight.</span></div>
<div class="line"><a name="l12523"></a><span class="lineno">12523</span>&#160;<span class="comment">               The minus sign comes from the integration by parts in the weak</span></div>
<div class="line"><a name="l12524"></a><span class="lineno">12524</span>&#160;<span class="comment">               formulation. */</span></div>
<div class="line"><a name="l12525"></a><span class="lineno">12525</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdx = -weights[i]*metricTerms[1];</div>
<div class="line"><a name="l12526"></a><span class="lineno">12526</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdy = -weights[i]*metricTerms[2];</div>
<div class="line"><a name="l12527"></a><span class="lineno">12527</span>&#160; </div>
<div class="line"><a name="l12528"></a><span class="lineno">12528</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdx = -weights[i]*metricTerms[3];</div>
<div class="line"><a name="l12529"></a><span class="lineno">12529</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdy = -weights[i]*metricTerms[4];</div>
<div class="line"><a name="l12530"></a><span class="lineno">12530</span>&#160; </div>
<div class="line"><a name="l12531"></a><span class="lineno">12531</span>&#160;            <span class="comment">/* Easier storage of the location where the solution data of this</span></div>
<div class="line"><a name="l12532"></a><span class="lineno">12532</span>&#160;<span class="comment">               integration point starts. */</span></div>
<div class="line"><a name="l12533"></a><span class="lineno">12533</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol    = solAndGradInt + iNPad + llNVar;</div>
<div class="line"><a name="l12534"></a><span class="lineno">12534</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolDr = sol    + offDeriv;</div>
<div class="line"><a name="l12535"></a><span class="lineno">12535</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolDs = dSolDr + offDeriv;</div>
<div class="line"><a name="l12536"></a><span class="lineno">12536</span>&#160; </div>
<div class="line"><a name="l12537"></a><span class="lineno">12537</span>&#160;            <span class="comment">/*--- Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l12538"></a><span class="lineno">12538</span>&#160;<span class="comment">                  variables from the gradients in parametric coordinates and the</span></div>
<div class="line"><a name="l12539"></a><span class="lineno">12539</span>&#160;<span class="comment">                  metric terms in this integration point. ---*/</span></div>
<div class="line"><a name="l12540"></a><span class="lineno">12540</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoDx  = dSolDr[0]*drdx + dSolDs[0]*dsdx;</div>
<div class="line"><a name="l12541"></a><span class="lineno">12541</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoUDx = dSolDr[1]*drdx + dSolDs[1]*dsdx;</div>
<div class="line"><a name="l12542"></a><span class="lineno">12542</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoVDx = dSolDr[2]*drdx + dSolDs[2]*dsdx;</div>
<div class="line"><a name="l12543"></a><span class="lineno">12543</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoEDx = dSolDr[3]*drdx + dSolDs[3]*dsdx;</div>
<div class="line"><a name="l12544"></a><span class="lineno">12544</span>&#160; </div>
<div class="line"><a name="l12545"></a><span class="lineno">12545</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoDy  = dSolDr[0]*drdy + dSolDs[0]*dsdy;</div>
<div class="line"><a name="l12546"></a><span class="lineno">12546</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoUDy = dSolDr[1]*drdy + dSolDs[1]*dsdy;</div>
<div class="line"><a name="l12547"></a><span class="lineno">12547</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoVDy = dSolDr[2]*drdy + dSolDs[2]*dsdy;</div>
<div class="line"><a name="l12548"></a><span class="lineno">12548</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoEDy = dSolDr[3]*drdy + dSolDs[3]*dsdy;</div>
<div class="line"><a name="l12549"></a><span class="lineno">12549</span>&#160; </div>
<div class="line"><a name="l12550"></a><span class="lineno">12550</span>&#160;            <span class="comment">/*--- Compute the velocities and static energy in this integration point. ---*/</span></div>
<div class="line"><a name="l12551"></a><span class="lineno">12551</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv       = 1.0/sol[0];</div>
<div class="line"><a name="l12552"></a><span class="lineno">12552</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = sol[1]*rhoInv;</div>
<div class="line"><a name="l12553"></a><span class="lineno">12553</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = sol[2]*rhoInv;</div>
<div class="line"><a name="l12554"></a><span class="lineno">12554</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = sol[3]*rhoInv;</div>
<div class="line"><a name="l12555"></a><span class="lineno">12555</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - 0.5*(u*u + v*v);</div>
<div class="line"><a name="l12556"></a><span class="lineno">12556</span>&#160; </div>
<div class="line"><a name="l12557"></a><span class="lineno">12557</span>&#160;            <span class="comment">/*--- Compute the Cartesian gradients of the velocities and static energy</span></div>
<div class="line"><a name="l12558"></a><span class="lineno">12558</span>&#160;<span class="comment">                  in this integration point and also the divergence of the velocity. ---*/</span></div>
<div class="line"><a name="l12559"></a><span class="lineno">12559</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = rhoInv*(dRhoUDx - u*dRhoDx);</div>
<div class="line"><a name="l12560"></a><span class="lineno">12560</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = rhoInv*(dRhoUDy - u*dRhoDy);</div>
<div class="line"><a name="l12561"></a><span class="lineno">12561</span>&#160; </div>
<div class="line"><a name="l12562"></a><span class="lineno">12562</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = rhoInv*(dRhoVDx - v*dRhoDx);</div>
<div class="line"><a name="l12563"></a><span class="lineno">12563</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = rhoInv*(dRhoVDy - v*dRhoDy);</div>
<div class="line"><a name="l12564"></a><span class="lineno">12564</span>&#160; </div>
<div class="line"><a name="l12565"></a><span class="lineno">12565</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergyDx = rhoInv*(dRhoEDx - TotalEnergy*dRhoDx)</div>
<div class="line"><a name="l12566"></a><span class="lineno">12566</span>&#160;                                            - u*dudx - v*dvdx;</div>
<div class="line"><a name="l12567"></a><span class="lineno">12567</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergyDy = rhoInv*(dRhoEDy - TotalEnergy*dRhoDy)</div>
<div class="line"><a name="l12568"></a><span class="lineno">12568</span>&#160;                                            - u*dudy - v*dvdy;</div>
<div class="line"><a name="l12569"></a><span class="lineno">12569</span>&#160; </div>
<div class="line"><a name="l12570"></a><span class="lineno">12570</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> divVel = dudx + dvdy;</div>
<div class="line"><a name="l12571"></a><span class="lineno">12571</span>&#160; </div>
<div class="line"><a name="l12572"></a><span class="lineno">12572</span>&#160;            <span class="comment">/*--- Compute the pressure and the laminar viscosity. ---*/</span></div>
<div class="line"><a name="l12573"></a><span class="lineno">12573</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l12574"></a><span class="lineno">12574</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l12575"></a><span class="lineno">12575</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l12576"></a><span class="lineno">12576</span>&#160; </div>
<div class="line"><a name="l12577"></a><span class="lineno">12577</span>&#160;            <span class="comment">/*--- If an SGS model is used the eddy viscosity must be computed. ---*/</span></div>
<div class="line"><a name="l12578"></a><span class="lineno">12578</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l12579"></a><span class="lineno">12579</span>&#160;            <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l12580"></a><span class="lineno">12580</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l12581"></a><span class="lineno">12581</span>&#160;              ViscosityTurb = SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#aebef9146565169091059c7b1a0fb926d">ComputeEddyViscosity_2D</a>(sol[0], dudx, dudy,</div>
<div class="line"><a name="l12582"></a><span class="lineno">12582</span>&#160;                                                                dvdx, dvdy, lenScale,</div>
<div class="line"><a name="l12583"></a><span class="lineno">12583</span>&#160;                                                                <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].wallDistance[i]);</div>
<div class="line"><a name="l12584"></a><span class="lineno">12584</span>&#160;            }</div>
<div class="line"><a name="l12585"></a><span class="lineno">12585</span>&#160; </div>
<div class="line"><a name="l12586"></a><span class="lineno">12586</span>&#160;            <span class="comment">/* Compute the total viscosity and heat conductivity. Note that the heat</span></div>
<div class="line"><a name="l12587"></a><span class="lineno">12587</span>&#160;<span class="comment">               conductivity is divided by the Cv, because gradients of internal energy</span></div>
<div class="line"><a name="l12588"></a><span class="lineno">12588</span>&#160;<span class="comment">               are computed and not temperature. */</span></div>
<div class="line"><a name="l12589"></a><span class="lineno">12589</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l12590"></a><span class="lineno">12590</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l12591"></a><span class="lineno">12591</span>&#160;                                    + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l12592"></a><span class="lineno">12592</span>&#160; </div>
<div class="line"><a name="l12593"></a><span class="lineno">12593</span>&#160;            <span class="comment">/*--- Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l12594"></a><span class="lineno">12594</span>&#160;<span class="comment">                  term in the viscous normal stresses. ---*/</span></div>
<div class="line"><a name="l12595"></a><span class="lineno">12595</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l12596"></a><span class="lineno">12596</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l12597"></a><span class="lineno">12597</span>&#160; </div>
<div class="line"><a name="l12598"></a><span class="lineno">12598</span>&#160;            <span class="comment">/*--- Compute the viscous stress tensor and minus the heatflux vector. ---*/</span></div>
<div class="line"><a name="l12599"></a><span class="lineno">12599</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l12600"></a><span class="lineno">12600</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l12601"></a><span class="lineno">12601</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l12602"></a><span class="lineno">12602</span>&#160; </div>
<div class="line"><a name="l12603"></a><span class="lineno">12603</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qx = kOverCv*dStaticEnergyDx;</div>
<div class="line"><a name="l12604"></a><span class="lineno">12604</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qy = kOverCv*dStaticEnergyDy;</div>
<div class="line"><a name="l12605"></a><span class="lineno">12605</span>&#160; </div>
<div class="line"><a name="l12606"></a><span class="lineno">12606</span>&#160;            <span class="comment">/* Compute the relative velocities w.r.t. the grid. */</span></div>
<div class="line"><a name="l12607"></a><span class="lineno">12607</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> uRel = u - gridVel[0];</div>
<div class="line"><a name="l12608"></a><span class="lineno">12608</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vRel = v - gridVel[1];</div>
<div class="line"><a name="l12609"></a><span class="lineno">12609</span>&#160; </div>
<div class="line"><a name="l12610"></a><span class="lineno">12610</span>&#160;            <span class="comment">/* Compute the viscous normal stress minus the pressure. */</span></div>
<div class="line"><a name="l12611"></a><span class="lineno">12611</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxxMP = tauxx - Pressure;</div>
<div class="line"><a name="l12612"></a><span class="lineno">12612</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyyMP = tauyy - Pressure;</div>
<div class="line"><a name="l12613"></a><span class="lineno">12613</span>&#160; </div>
<div class="line"><a name="l12614"></a><span class="lineno">12614</span>&#160;            <span class="comment">/* Set the pointer for the fluxes in this integration point. */</span></div>
<div class="line"><a name="l12615"></a><span class="lineno">12615</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux = fluxes + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*iNPad + llNVar;</div>
<div class="line"><a name="l12616"></a><span class="lineno">12616</span>&#160; </div>
<div class="line"><a name="l12617"></a><span class="lineno">12617</span>&#160;            <span class="comment">/*--- Fluxes in r-direction. */</span></div>
<div class="line"><a name="l12618"></a><span class="lineno">12618</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Ur = uRel*wDrdx + vRel*wDrdy;</div>
<div class="line"><a name="l12619"></a><span class="lineno">12619</span>&#160; </div>
<div class="line"><a name="l12620"></a><span class="lineno">12620</span>&#160;            flux[0] = sol[0]*Ur;</div>
<div class="line"><a name="l12621"></a><span class="lineno">12621</span>&#160;            flux[1] = sol[1]*Ur - tauxxMP*wDrdx - tauxy*wDrdy;</div>
<div class="line"><a name="l12622"></a><span class="lineno">12622</span>&#160;            flux[2] = sol[2]*Ur - tauxy*wDrdx - tauyyMP*wDrdy;</div>
<div class="line"><a name="l12623"></a><span class="lineno">12623</span>&#160;            flux[3] = sol[3]*Ur - (u*tauxxMP + v*tauxy + qx)*wDrdx</div>
<div class="line"><a name="l12624"></a><span class="lineno">12624</span>&#160;                                - (u*tauxy + v*tauyyMP + qy)*wDrdy;</div>
<div class="line"><a name="l12625"></a><span class="lineno">12625</span>&#160; </div>
<div class="line"><a name="l12626"></a><span class="lineno">12626</span>&#160;            <span class="comment">/*--- Fluxes in s-direction. */</span></div>
<div class="line"><a name="l12627"></a><span class="lineno">12627</span>&#160;            flux = flux + NPad;</div>
<div class="line"><a name="l12628"></a><span class="lineno">12628</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Us = uRel*wDsdx + vRel*wDsdy;</div>
<div class="line"><a name="l12629"></a><span class="lineno">12629</span>&#160; </div>
<div class="line"><a name="l12630"></a><span class="lineno">12630</span>&#160;            flux[0] = sol[0]*Us;</div>
<div class="line"><a name="l12631"></a><span class="lineno">12631</span>&#160;            flux[1] = sol[1]*Us - tauxxMP*wDsdx - tauxy*wDsdy;</div>
<div class="line"><a name="l12632"></a><span class="lineno">12632</span>&#160;            flux[2] = sol[2]*Us - tauxy*wDsdx - tauyyMP*wDsdy;</div>
<div class="line"><a name="l12633"></a><span class="lineno">12633</span>&#160;            flux[3] = sol[3]*Us - (u*tauxxMP + v*tauxy + qx)*wDsdx</div>
<div class="line"><a name="l12634"></a><span class="lineno">12634</span>&#160;                                - (u*tauxy + v*tauyyMP + qy)*wDsdy;</div>
<div class="line"><a name="l12635"></a><span class="lineno">12635</span>&#160; </div>
<div class="line"><a name="l12636"></a><span class="lineno">12636</span>&#160;            <span class="comment">/*--- If needed, compute the body forces in this integration point.</span></div>
<div class="line"><a name="l12637"></a><span class="lineno">12637</span>&#160;<span class="comment">                  Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l12638"></a><span class="lineno">12638</span>&#160;<span class="comment">                  integration weight in order to be consistent with the</span></div>
<div class="line"><a name="l12639"></a><span class="lineno">12639</span>&#160;<span class="comment">                  formulation of the residual. Note that for the energy source</span></div>
<div class="line"><a name="l12640"></a><span class="lineno">12640</span>&#160;<span class="comment">                  term the absolute velocity must be taken and not the</span></div>
<div class="line"><a name="l12641"></a><span class="lineno">12641</span>&#160;<span class="comment">                  relative. ---*/</span></div>
<div class="line"><a name="l12642"></a><span class="lineno">12642</span>&#160;            <span class="keywordflow">if</span>( body_force ) {</div>
<div class="line"><a name="l12643"></a><span class="lineno">12643</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *source         = sources + iNPad + llNVar;</div>
<div class="line"><a name="l12644"></a><span class="lineno">12644</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*Jac;</div>
<div class="line"><a name="l12645"></a><span class="lineno">12645</span>&#160; </div>
<div class="line"><a name="l12646"></a><span class="lineno">12646</span>&#160;              source[0] =  0.0;</div>
<div class="line"><a name="l12647"></a><span class="lineno">12647</span>&#160;              source[1] = -weightJac*body_force_vector[0];</div>
<div class="line"><a name="l12648"></a><span class="lineno">12648</span>&#160;              source[2] = -weightJac*body_force_vector[1];</div>
<div class="line"><a name="l12649"></a><span class="lineno">12649</span>&#160;              source[3] = -weightJac*(u*body_force_vector[0] + v*body_force_vector[1]);</div>
<div class="line"><a name="l12650"></a><span class="lineno">12650</span>&#160;            }</div>
<div class="line"><a name="l12651"></a><span class="lineno">12651</span>&#160;          }</div>
<div class="line"><a name="l12652"></a><span class="lineno">12652</span>&#160;        }</div>
<div class="line"><a name="l12653"></a><span class="lineno">12653</span>&#160; </div>
<div class="line"><a name="l12654"></a><span class="lineno">12654</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12655"></a><span class="lineno">12655</span>&#160;      }</div>
<div class="line"><a name="l12656"></a><span class="lineno">12656</span>&#160; </div>
<div class="line"><a name="l12657"></a><span class="lineno">12657</span>&#160;      <span class="comment">/*----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12658"></a><span class="lineno">12658</span>&#160; </div>
<div class="line"><a name="l12659"></a><span class="lineno">12659</span>&#160;      <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l12660"></a><span class="lineno">12660</span>&#160; </div>
<div class="line"><a name="l12661"></a><span class="lineno">12661</span>&#160;        <span class="comment">/* 3D simulation. Loop over the chunk of elements and loop over the</span></div>
<div class="line"><a name="l12662"></a><span class="lineno">12662</span>&#160;<span class="comment">           integration points of the elements to compute the fluxes. */</span></div>
<div class="line"><a name="l12663"></a><span class="lineno">12663</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l12664"></a><span class="lineno">12664</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l12665"></a><span class="lineno">12665</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l12666"></a><span class="lineno">12666</span>&#160; </div>
<div class="line"><a name="l12667"></a><span class="lineno">12667</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l12668"></a><span class="lineno">12668</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iNPad = i*NPad;</div>
<div class="line"><a name="l12669"></a><span class="lineno">12669</span>&#160; </div>
<div class="line"><a name="l12670"></a><span class="lineno">12670</span>&#160;            <span class="comment">/* Easier storage of the metric terms and grid velocities in this</span></div>
<div class="line"><a name="l12671"></a><span class="lineno">12671</span>&#160;<span class="comment">               integration point and compute the inverse of the Jacobian. */</span></div>
<div class="line"><a name="l12672"></a><span class="lineno">12672</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data()</div>
<div class="line"><a name="l12673"></a><span class="lineno">12673</span>&#160;                                         + i*nMetricPerPoint;</div>
<div class="line"><a name="l12674"></a><span class="lineno">12674</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a1719ed3ac3197990c7463c9317cae90b">gridVelocities</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l12675"></a><span class="lineno">12675</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Jac          = metricTerms[0];</div>
<div class="line"><a name="l12676"></a><span class="lineno">12676</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> JacInv       = 1.0/Jac;</div>
<div class="line"><a name="l12677"></a><span class="lineno">12677</span>&#160; </div>
<div class="line"><a name="l12678"></a><span class="lineno">12678</span>&#160;            <span class="comment">/* Compute the true metric terms in this integration point. */</span></div>
<div class="line"><a name="l12679"></a><span class="lineno">12679</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = JacInv*metricTerms[1];</div>
<div class="line"><a name="l12680"></a><span class="lineno">12680</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = JacInv*metricTerms[2];</div>
<div class="line"><a name="l12681"></a><span class="lineno">12681</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdz = JacInv*metricTerms[3];</div>
<div class="line"><a name="l12682"></a><span class="lineno">12682</span>&#160; </div>
<div class="line"><a name="l12683"></a><span class="lineno">12683</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = JacInv*metricTerms[4];</div>
<div class="line"><a name="l12684"></a><span class="lineno">12684</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = JacInv*metricTerms[5];</div>
<div class="line"><a name="l12685"></a><span class="lineno">12685</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdz = JacInv*metricTerms[6];</div>
<div class="line"><a name="l12686"></a><span class="lineno">12686</span>&#160; </div>
<div class="line"><a name="l12687"></a><span class="lineno">12687</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdx = JacInv*metricTerms[7];</div>
<div class="line"><a name="l12688"></a><span class="lineno">12688</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdy = JacInv*metricTerms[8];</div>
<div class="line"><a name="l12689"></a><span class="lineno">12689</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdz = JacInv*metricTerms[9];</div>
<div class="line"><a name="l12690"></a><span class="lineno">12690</span>&#160; </div>
<div class="line"><a name="l12691"></a><span class="lineno">12691</span>&#160;            <span class="comment">/* Compute the metric terms multiplied by minus the integration weight.</span></div>
<div class="line"><a name="l12692"></a><span class="lineno">12692</span>&#160;<span class="comment">               The minus sign comes from the integration by parts in the weak</span></div>
<div class="line"><a name="l12693"></a><span class="lineno">12693</span>&#160;<span class="comment">               formulation. */</span></div>
<div class="line"><a name="l12694"></a><span class="lineno">12694</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdx = -weights[i]*metricTerms[1];</div>
<div class="line"><a name="l12695"></a><span class="lineno">12695</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdy = -weights[i]*metricTerms[2];</div>
<div class="line"><a name="l12696"></a><span class="lineno">12696</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDrdz = -weights[i]*metricTerms[3];</div>
<div class="line"><a name="l12697"></a><span class="lineno">12697</span>&#160; </div>
<div class="line"><a name="l12698"></a><span class="lineno">12698</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdx = -weights[i]*metricTerms[4];</div>
<div class="line"><a name="l12699"></a><span class="lineno">12699</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdy = -weights[i]*metricTerms[5];</div>
<div class="line"><a name="l12700"></a><span class="lineno">12700</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDsdz = -weights[i]*metricTerms[6];</div>
<div class="line"><a name="l12701"></a><span class="lineno">12701</span>&#160; </div>
<div class="line"><a name="l12702"></a><span class="lineno">12702</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdx = -weights[i]*metricTerms[7];</div>
<div class="line"><a name="l12703"></a><span class="lineno">12703</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdy = -weights[i]*metricTerms[8];</div>
<div class="line"><a name="l12704"></a><span class="lineno">12704</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wDtdz = -weights[i]*metricTerms[9];</div>
<div class="line"><a name="l12705"></a><span class="lineno">12705</span>&#160; </div>
<div class="line"><a name="l12706"></a><span class="lineno">12706</span>&#160;            <span class="comment">/* Easier storage of the location where the solution data of this</span></div>
<div class="line"><a name="l12707"></a><span class="lineno">12707</span>&#160;<span class="comment">               integration point starts. */</span></div>
<div class="line"><a name="l12708"></a><span class="lineno">12708</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol    = solAndGradInt + iNPad + llNVar;</div>
<div class="line"><a name="l12709"></a><span class="lineno">12709</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolDr = sol    + offDeriv;</div>
<div class="line"><a name="l12710"></a><span class="lineno">12710</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolDs = dSolDr + offDeriv;</div>
<div class="line"><a name="l12711"></a><span class="lineno">12711</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolDt = dSolDs + offDeriv;</div>
<div class="line"><a name="l12712"></a><span class="lineno">12712</span>&#160; </div>
<div class="line"><a name="l12713"></a><span class="lineno">12713</span>&#160;            <span class="comment">/*--- Compute the Cartesian gradients of the independent solution</span></div>
<div class="line"><a name="l12714"></a><span class="lineno">12714</span>&#160;<span class="comment">                  variables from the gradients in parametric coordinates and the</span></div>
<div class="line"><a name="l12715"></a><span class="lineno">12715</span>&#160;<span class="comment">                  metric terms in this integration point. ---*/</span></div>
<div class="line"><a name="l12716"></a><span class="lineno">12716</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoDx  = dSolDr[0]*drdx + dSolDs[0]*dsdx + dSolDt[0]*dtdx;</div>
<div class="line"><a name="l12717"></a><span class="lineno">12717</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoUDx = dSolDr[1]*drdx + dSolDs[1]*dsdx + dSolDt[1]*dtdx;</div>
<div class="line"><a name="l12718"></a><span class="lineno">12718</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoVDx = dSolDr[2]*drdx + dSolDs[2]*dsdx + dSolDt[2]*dtdx;</div>
<div class="line"><a name="l12719"></a><span class="lineno">12719</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoWDx = dSolDr[3]*drdx + dSolDs[3]*dsdx + dSolDt[3]*dtdx;</div>
<div class="line"><a name="l12720"></a><span class="lineno">12720</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoEDx = dSolDr[4]*drdx + dSolDs[4]*dsdx + dSolDt[4]*dtdx;</div>
<div class="line"><a name="l12721"></a><span class="lineno">12721</span>&#160; </div>
<div class="line"><a name="l12722"></a><span class="lineno">12722</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoDy  = dSolDr[0]*drdy + dSolDs[0]*dsdy + dSolDt[0]*dtdy;</div>
<div class="line"><a name="l12723"></a><span class="lineno">12723</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoUDy = dSolDr[1]*drdy + dSolDs[1]*dsdy + dSolDt[1]*dtdy;</div>
<div class="line"><a name="l12724"></a><span class="lineno">12724</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoVDy = dSolDr[2]*drdy + dSolDs[2]*dsdy + dSolDt[2]*dtdy;</div>
<div class="line"><a name="l12725"></a><span class="lineno">12725</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoWDy = dSolDr[3]*drdy + dSolDs[3]*dsdy + dSolDt[3]*dtdy;</div>
<div class="line"><a name="l12726"></a><span class="lineno">12726</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoEDy = dSolDr[4]*drdy + dSolDs[4]*dsdy + dSolDt[4]*dtdy;</div>
<div class="line"><a name="l12727"></a><span class="lineno">12727</span>&#160; </div>
<div class="line"><a name="l12728"></a><span class="lineno">12728</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoDz  = dSolDr[0]*drdz + dSolDs[0]*dsdz + dSolDt[0]*dtdz;</div>
<div class="line"><a name="l12729"></a><span class="lineno">12729</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoUDz = dSolDr[1]*drdz + dSolDs[1]*dsdz + dSolDt[1]*dtdz;</div>
<div class="line"><a name="l12730"></a><span class="lineno">12730</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoVDz = dSolDr[2]*drdz + dSolDs[2]*dsdz + dSolDt[2]*dtdz;</div>
<div class="line"><a name="l12731"></a><span class="lineno">12731</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoWDz = dSolDr[3]*drdz + dSolDs[3]*dsdz + dSolDt[3]*dtdz;</div>
<div class="line"><a name="l12732"></a><span class="lineno">12732</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dRhoEDz = dSolDr[4]*drdz + dSolDs[4]*dsdz + dSolDt[4]*dtdz;</div>
<div class="line"><a name="l12733"></a><span class="lineno">12733</span>&#160; </div>
<div class="line"><a name="l12734"></a><span class="lineno">12734</span>&#160;            <span class="comment">/*--- Compute the velocities and static energy in this integration point. ---*/</span></div>
<div class="line"><a name="l12735"></a><span class="lineno">12735</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv       = 1.0/sol[0];</div>
<div class="line"><a name="l12736"></a><span class="lineno">12736</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u            = sol[1]*rhoInv;</div>
<div class="line"><a name="l12737"></a><span class="lineno">12737</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v            = sol[2]*rhoInv;</div>
<div class="line"><a name="l12738"></a><span class="lineno">12738</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w            = sol[3]*rhoInv;</div>
<div class="line"><a name="l12739"></a><span class="lineno">12739</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = sol[4]*rhoInv;</div>
<div class="line"><a name="l12740"></a><span class="lineno">12740</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - 0.5*(u*u + v*v + w*w);</div>
<div class="line"><a name="l12741"></a><span class="lineno">12741</span>&#160; </div>
<div class="line"><a name="l12742"></a><span class="lineno">12742</span>&#160;            <span class="comment">/*--- Compute the Cartesian gradients of the velocities and static energy</span></div>
<div class="line"><a name="l12743"></a><span class="lineno">12743</span>&#160;<span class="comment">                  in this integration point and also the divergence of the velocity. ---*/</span></div>
<div class="line"><a name="l12744"></a><span class="lineno">12744</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = rhoInv*(dRhoUDx - u*dRhoDx);</div>
<div class="line"><a name="l12745"></a><span class="lineno">12745</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = rhoInv*(dRhoUDy - u*dRhoDy);</div>
<div class="line"><a name="l12746"></a><span class="lineno">12746</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudz = rhoInv*(dRhoUDz - u*dRhoDz);</div>
<div class="line"><a name="l12747"></a><span class="lineno">12747</span>&#160; </div>
<div class="line"><a name="l12748"></a><span class="lineno">12748</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = rhoInv*(dRhoVDx - v*dRhoDx);</div>
<div class="line"><a name="l12749"></a><span class="lineno">12749</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = rhoInv*(dRhoVDy - v*dRhoDy);</div>
<div class="line"><a name="l12750"></a><span class="lineno">12750</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdz = rhoInv*(dRhoVDz - v*dRhoDz);</div>
<div class="line"><a name="l12751"></a><span class="lineno">12751</span>&#160; </div>
<div class="line"><a name="l12752"></a><span class="lineno">12752</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdx = rhoInv*(dRhoWDx - w*dRhoDx);</div>
<div class="line"><a name="l12753"></a><span class="lineno">12753</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdy = rhoInv*(dRhoWDy - w*dRhoDy);</div>
<div class="line"><a name="l12754"></a><span class="lineno">12754</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdz = rhoInv*(dRhoWDz - w*dRhoDz);</div>
<div class="line"><a name="l12755"></a><span class="lineno">12755</span>&#160; </div>
<div class="line"><a name="l12756"></a><span class="lineno">12756</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergyDx = rhoInv*(dRhoEDx - TotalEnergy*dRhoDx)</div>
<div class="line"><a name="l12757"></a><span class="lineno">12757</span>&#160;                                            - u*dudx - v*dvdx - w*dwdx;</div>
<div class="line"><a name="l12758"></a><span class="lineno">12758</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergyDy = rhoInv*(dRhoEDy - TotalEnergy*dRhoDy)</div>
<div class="line"><a name="l12759"></a><span class="lineno">12759</span>&#160;                                            - u*dudy - v*dvdy - w*dwdy;</div>
<div class="line"><a name="l12760"></a><span class="lineno">12760</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergyDz = rhoInv*(dRhoEDz - TotalEnergy*dRhoDz)</div>
<div class="line"><a name="l12761"></a><span class="lineno">12761</span>&#160;                                            - u*dudz - v*dvdz - w*dwdz;</div>
<div class="line"><a name="l12762"></a><span class="lineno">12762</span>&#160; </div>
<div class="line"><a name="l12763"></a><span class="lineno">12763</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> divVel = dudx + dvdy + dwdz;</div>
<div class="line"><a name="l12764"></a><span class="lineno">12764</span>&#160; </div>
<div class="line"><a name="l12765"></a><span class="lineno">12765</span>&#160;            <span class="comment">/*--- Compute the pressure and the laminar viscosity. ---*/</span></div>
<div class="line"><a name="l12766"></a><span class="lineno">12766</span>&#160;            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l12767"></a><span class="lineno">12767</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l12768"></a><span class="lineno">12768</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l12769"></a><span class="lineno">12769</span>&#160; </div>
<div class="line"><a name="l12770"></a><span class="lineno">12770</span>&#160;            <span class="comment">/*--- If an SGS model is used the eddy viscosity must be computed. ---*/</span></div>
<div class="line"><a name="l12771"></a><span class="lineno">12771</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l12772"></a><span class="lineno">12772</span>&#160;            <span class="keywordflow">if</span>( SGSModelUsed ) {</div>
<div class="line"><a name="l12773"></a><span class="lineno">12773</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l12774"></a><span class="lineno">12774</span>&#160;              ViscosityTurb = SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#a6017e86477c7d39b542d82a3b2b9f1cd">ComputeEddyViscosity_3D</a>(sol[0], dudx, dudy, dudz,</div>
<div class="line"><a name="l12775"></a><span class="lineno">12775</span>&#160;                                                                dvdx, dvdy, dvdz, dwdx,</div>
<div class="line"><a name="l12776"></a><span class="lineno">12776</span>&#160;                                                                dwdy, dwdz, lenScale,</div>
<div class="line"><a name="l12777"></a><span class="lineno">12777</span>&#160;                                                                <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].wallDistance[i]);</div>
<div class="line"><a name="l12778"></a><span class="lineno">12778</span>&#160;            }</div>
<div class="line"><a name="l12779"></a><span class="lineno">12779</span>&#160; </div>
<div class="line"><a name="l12780"></a><span class="lineno">12780</span>&#160;            <span class="comment">/* Compute the total viscosity and heat conductivity. Note that the heat</span></div>
<div class="line"><a name="l12781"></a><span class="lineno">12781</span>&#160;<span class="comment">               conductivity is divided by the Cv, because gradients of internal energy</span></div>
<div class="line"><a name="l12782"></a><span class="lineno">12782</span>&#160;<span class="comment">               are computed and not temperature. */</span></div>
<div class="line"><a name="l12783"></a><span class="lineno">12783</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l12784"></a><span class="lineno">12784</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kOverCv = ViscosityLam *factHeatFlux_Lam</div>
<div class="line"><a name="l12785"></a><span class="lineno">12785</span>&#160;                                    + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l12786"></a><span class="lineno">12786</span>&#160; </div>
<div class="line"><a name="l12787"></a><span class="lineno">12787</span>&#160;            <span class="comment">/*--- Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l12788"></a><span class="lineno">12788</span>&#160;<span class="comment">                  term in the viscous normal stresses. ---*/</span></div>
<div class="line"><a name="l12789"></a><span class="lineno">12789</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l12790"></a><span class="lineno">12790</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l12791"></a><span class="lineno">12791</span>&#160; </div>
<div class="line"><a name="l12792"></a><span class="lineno">12792</span>&#160;            <span class="comment">/*--- Compute the viscous stress tensor and minus the heatflux vector. ---*/</span></div>
<div class="line"><a name="l12793"></a><span class="lineno">12793</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l12794"></a><span class="lineno">12794</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l12795"></a><span class="lineno">12795</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauzz = 2.0*Viscosity*dwdz + lamDivTerm;</div>
<div class="line"><a name="l12796"></a><span class="lineno">12796</span>&#160; </div>
<div class="line"><a name="l12797"></a><span class="lineno">12797</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l12798"></a><span class="lineno">12798</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxz = Viscosity*(dudz + dwdx);</div>
<div class="line"><a name="l12799"></a><span class="lineno">12799</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyz = Viscosity*(dvdz + dwdy);</div>
<div class="line"><a name="l12800"></a><span class="lineno">12800</span>&#160; </div>
<div class="line"><a name="l12801"></a><span class="lineno">12801</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qx = kOverCv*dStaticEnergyDx;</div>
<div class="line"><a name="l12802"></a><span class="lineno">12802</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qy = kOverCv*dStaticEnergyDy;</div>
<div class="line"><a name="l12803"></a><span class="lineno">12803</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qz = kOverCv*dStaticEnergyDz;</div>
<div class="line"><a name="l12804"></a><span class="lineno">12804</span>&#160; </div>
<div class="line"><a name="l12805"></a><span class="lineno">12805</span>&#160;            <span class="comment">/* Compute the relative velocities w.r.t. the grid. */</span></div>
<div class="line"><a name="l12806"></a><span class="lineno">12806</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> uRel = u - gridVel[0];</div>
<div class="line"><a name="l12807"></a><span class="lineno">12807</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vRel = v - gridVel[1];</div>
<div class="line"><a name="l12808"></a><span class="lineno">12808</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wRel = w - gridVel[2];</div>
<div class="line"><a name="l12809"></a><span class="lineno">12809</span>&#160; </div>
<div class="line"><a name="l12810"></a><span class="lineno">12810</span>&#160;            <span class="comment">/* Compute the viscous normal stress minus the pressure. */</span></div>
<div class="line"><a name="l12811"></a><span class="lineno">12811</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxxMP = tauxx - Pressure;</div>
<div class="line"><a name="l12812"></a><span class="lineno">12812</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyyMP = tauyy - Pressure;</div>
<div class="line"><a name="l12813"></a><span class="lineno">12813</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauzzMP = tauzz - Pressure;</div>
<div class="line"><a name="l12814"></a><span class="lineno">12814</span>&#160; </div>
<div class="line"><a name="l12815"></a><span class="lineno">12815</span>&#160;            <span class="comment">/* Set the pointer for the fluxes in this integration point. */</span></div>
<div class="line"><a name="l12816"></a><span class="lineno">12816</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux = fluxes + <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*iNPad + llNVar;</div>
<div class="line"><a name="l12817"></a><span class="lineno">12817</span>&#160; </div>
<div class="line"><a name="l12818"></a><span class="lineno">12818</span>&#160;            <span class="comment">/*--- Fluxes in r-direction. */</span></div>
<div class="line"><a name="l12819"></a><span class="lineno">12819</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Ur = uRel*wDrdx + vRel*wDrdy + wRel*wDrdz;</div>
<div class="line"><a name="l12820"></a><span class="lineno">12820</span>&#160; </div>
<div class="line"><a name="l12821"></a><span class="lineno">12821</span>&#160;            flux[0] = sol[0]*Ur;</div>
<div class="line"><a name="l12822"></a><span class="lineno">12822</span>&#160;            flux[1] = sol[1]*Ur - tauxxMP*wDrdx - tauxy*wDrdy - tauxz*wDrdz;</div>
<div class="line"><a name="l12823"></a><span class="lineno">12823</span>&#160;            flux[2] = sol[2]*Ur - tauxy*wDrdx - tauyyMP*wDrdy - tauyz*wDrdz;</div>
<div class="line"><a name="l12824"></a><span class="lineno">12824</span>&#160;            flux[3] = sol[3]*Ur - tauxz*wDrdx - tauyz*wDrdy - tauzzMP*wDrdz;</div>
<div class="line"><a name="l12825"></a><span class="lineno">12825</span>&#160;            flux[4] = sol[4]*Ur - (u*tauxxMP + v*tauxy + w*tauxz + qx)*wDrdx</div>
<div class="line"><a name="l12826"></a><span class="lineno">12826</span>&#160;                                - (u*tauxy + v*tauyyMP + w*tauyz + qy)*wDrdy</div>
<div class="line"><a name="l12827"></a><span class="lineno">12827</span>&#160;                                - (u*tauxz + v*tauyz + w*tauzzMP + qz)*wDrdz;</div>
<div class="line"><a name="l12828"></a><span class="lineno">12828</span>&#160; </div>
<div class="line"><a name="l12829"></a><span class="lineno">12829</span>&#160;            <span class="comment">/*--- Fluxes in s-direction. */</span></div>
<div class="line"><a name="l12830"></a><span class="lineno">12830</span>&#160;            flux = flux + NPad;</div>
<div class="line"><a name="l12831"></a><span class="lineno">12831</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Us = uRel*wDsdx + vRel*wDsdy + wRel*wDsdz;</div>
<div class="line"><a name="l12832"></a><span class="lineno">12832</span>&#160; </div>
<div class="line"><a name="l12833"></a><span class="lineno">12833</span>&#160;            flux[0] = sol[0]*Us;</div>
<div class="line"><a name="l12834"></a><span class="lineno">12834</span>&#160;            flux[1] = sol[1]*Us - tauxxMP*wDsdx - tauxy*wDsdy - tauxz*wDsdz;</div>
<div class="line"><a name="l12835"></a><span class="lineno">12835</span>&#160;            flux[2] = sol[2]*Us - tauxy*wDsdx - tauyyMP*wDsdy - tauyz*wDsdz;</div>
<div class="line"><a name="l12836"></a><span class="lineno">12836</span>&#160;            flux[3] = sol[3]*Us - tauxz*wDsdx - tauyz*wDsdy - tauzzMP*wDsdz;</div>
<div class="line"><a name="l12837"></a><span class="lineno">12837</span>&#160;            flux[4] = sol[4]*Us - (u*tauxxMP + v*tauxy + w*tauxz + qx)*wDsdx</div>
<div class="line"><a name="l12838"></a><span class="lineno">12838</span>&#160;                                - (u*tauxy + v*tauyyMP + w*tauyz + qy)*wDsdy</div>
<div class="line"><a name="l12839"></a><span class="lineno">12839</span>&#160;                                - (u*tauxz + v*tauyz + w*tauzzMP + qz)*wDsdz;</div>
<div class="line"><a name="l12840"></a><span class="lineno">12840</span>&#160; </div>
<div class="line"><a name="l12841"></a><span class="lineno">12841</span>&#160;            <span class="comment">/*--- Fluxes in t-direction. */</span></div>
<div class="line"><a name="l12842"></a><span class="lineno">12842</span>&#160;            flux = flux + NPad;</div>
<div class="line"><a name="l12843"></a><span class="lineno">12843</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Ut = uRel*wDtdx + vRel*wDtdy + wRel*wDtdz;</div>
<div class="line"><a name="l12844"></a><span class="lineno">12844</span>&#160; </div>
<div class="line"><a name="l12845"></a><span class="lineno">12845</span>&#160;            flux[0] = sol[0]*Ut;</div>
<div class="line"><a name="l12846"></a><span class="lineno">12846</span>&#160;            flux[1] = sol[1]*Ut - tauxxMP*wDtdx - tauxy*wDtdy - tauxz*wDtdz;</div>
<div class="line"><a name="l12847"></a><span class="lineno">12847</span>&#160;            flux[2] = sol[2]*Ut - tauxy*wDtdx - tauyyMP*wDtdy - tauyz*wDtdz;</div>
<div class="line"><a name="l12848"></a><span class="lineno">12848</span>&#160;            flux[3] = sol[3]*Ut - tauxz*wDtdx - tauyz*wDtdy - tauzzMP*wDtdz;</div>
<div class="line"><a name="l12849"></a><span class="lineno">12849</span>&#160;            flux[4] = sol[4]*Ut - (u*tauxxMP + v*tauxy + w*tauxz + qx)*wDtdx</div>
<div class="line"><a name="l12850"></a><span class="lineno">12850</span>&#160;                                - (u*tauxy + v*tauyyMP + w*tauyz + qy)*wDtdy</div>
<div class="line"><a name="l12851"></a><span class="lineno">12851</span>&#160;                                - (u*tauxz + v*tauyz + w*tauzzMP + qz)*wDtdz;</div>
<div class="line"><a name="l12852"></a><span class="lineno">12852</span>&#160; </div>
<div class="line"><a name="l12853"></a><span class="lineno">12853</span>&#160;            <span class="comment">/*--- If needed, compute the body forces in this integration point.</span></div>
<div class="line"><a name="l12854"></a><span class="lineno">12854</span>&#160;<span class="comment">                  Note that the source terms are multiplied with minus the</span></div>
<div class="line"><a name="l12855"></a><span class="lineno">12855</span>&#160;<span class="comment">                  integration weight in order to be consistent with the</span></div>
<div class="line"><a name="l12856"></a><span class="lineno">12856</span>&#160;<span class="comment">                  formulation of the residual. Note that for the energy source</span></div>
<div class="line"><a name="l12857"></a><span class="lineno">12857</span>&#160;<span class="comment">                  term the absolute velocity must be taken and not the</span></div>
<div class="line"><a name="l12858"></a><span class="lineno">12858</span>&#160;<span class="comment">                  relative. ---*/</span></div>
<div class="line"><a name="l12859"></a><span class="lineno">12859</span>&#160;            <span class="keywordflow">if</span>( body_force ) {</div>
<div class="line"><a name="l12860"></a><span class="lineno">12860</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *source         = sources + iNPad + llNVar;</div>
<div class="line"><a name="l12861"></a><span class="lineno">12861</span>&#160;              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac = weights[i]*Jac;</div>
<div class="line"><a name="l12862"></a><span class="lineno">12862</span>&#160; </div>
<div class="line"><a name="l12863"></a><span class="lineno">12863</span>&#160;              source[0] =  0.0;</div>
<div class="line"><a name="l12864"></a><span class="lineno">12864</span>&#160;              source[1] = -weightJac*body_force_vector[0];</div>
<div class="line"><a name="l12865"></a><span class="lineno">12865</span>&#160;              source[2] = -weightJac*body_force_vector[1];</div>
<div class="line"><a name="l12866"></a><span class="lineno">12866</span>&#160;              source[3] = -weightJac*body_force_vector[2];</div>
<div class="line"><a name="l12867"></a><span class="lineno">12867</span>&#160;              source[4] = -weightJac*(u*body_force_vector[0] + v*body_force_vector[1]</div>
<div class="line"><a name="l12868"></a><span class="lineno">12868</span>&#160;                        +             w*body_force_vector[2]);</div>
<div class="line"><a name="l12869"></a><span class="lineno">12869</span>&#160;            }</div>
<div class="line"><a name="l12870"></a><span class="lineno">12870</span>&#160;          }</div>
<div class="line"><a name="l12871"></a><span class="lineno">12871</span>&#160;        }</div>
<div class="line"><a name="l12872"></a><span class="lineno">12872</span>&#160; </div>
<div class="line"><a name="l12873"></a><span class="lineno">12873</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l12874"></a><span class="lineno">12874</span>&#160;      }</div>
<div class="line"><a name="l12875"></a><span class="lineno">12875</span>&#160;    }</div>
<div class="line"><a name="l12876"></a><span class="lineno">12876</span>&#160; </div>
<div class="line"><a name="l12877"></a><span class="lineno">12877</span>&#160;    <span class="comment">/* Initialize addSourceTerms to body_force. The value of addSourceTerms</span></div>
<div class="line"><a name="l12878"></a><span class="lineno">12878</span>&#160;<span class="comment">       is set to true when a manufactured solution is computed. */</span></div>
<div class="line"><a name="l12879"></a><span class="lineno">12879</span>&#160;    <span class="keywordtype">bool</span> addSourceTerms = body_force;</div>
<div class="line"><a name="l12880"></a><span class="lineno">12880</span>&#160; </div>
<div class="line"><a name="l12881"></a><span class="lineno">12881</span>&#160;<span class="preprocessor">#ifdef MANUFACTURED_SOLUTION</span></div>
<div class="line"><a name="l12882"></a><span class="lineno">12882</span>&#160; </div>
<div class="line"><a name="l12883"></a><span class="lineno">12883</span>&#160;    <span class="comment">/*--- For the manufactured solutions a source term must be added. If a</span></div>
<div class="line"><a name="l12884"></a><span class="lineno">12884</span>&#160;<span class="comment">          standard source term has not been specified, initialize the source</span></div>
<div class="line"><a name="l12885"></a><span class="lineno">12885</span>&#160;<span class="comment">          terms to zero and set addSourceTerms to true. ---*/</span></div>
<div class="line"><a name="l12886"></a><span class="lineno">12886</span>&#160;    addSourceTerms = <span class="keyword">true</span>;</div>
<div class="line"><a name="l12887"></a><span class="lineno">12887</span>&#160;    <span class="keywordflow">if</span>( !body_force ) {</div>
<div class="line"><a name="l12888"></a><span class="lineno">12888</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(nInt*NPad); ++i)</div>
<div class="line"><a name="l12889"></a><span class="lineno">12889</span>&#160;        sources[i] = 0.0;</div>
<div class="line"><a name="l12890"></a><span class="lineno">12890</span>&#160;    }</div>
<div class="line"><a name="l12891"></a><span class="lineno">12891</span>&#160; </div>
<div class="line"><a name="l12892"></a><span class="lineno">12892</span>&#160;    <span class="comment">/* Easier storage of the gas constant. */</span></div>
<div class="line"><a name="l12893"></a><span class="lineno">12893</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RGas = config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l12894"></a><span class="lineno">12894</span>&#160; </div>
<div class="line"><a name="l12895"></a><span class="lineno">12895</span>&#160;    <span class="comment">/*--- Loop over the chunk of elements and its integration points. ---*/</span></div>
<div class="line"><a name="l12896"></a><span class="lineno">12896</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l12897"></a><span class="lineno">12897</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l12898"></a><span class="lineno">12898</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l12899"></a><span class="lineno">12899</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l12900"></a><span class="lineno">12900</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iNPad = i*NPad;</div>
<div class="line"><a name="l12901"></a><span class="lineno">12901</span>&#160; </div>
<div class="line"><a name="l12902"></a><span class="lineno">12902</span>&#160;        <span class="comment">/* Determine the value of the viscosity and thermal conductivity. */</span></div>
<div class="line"><a name="l12903"></a><span class="lineno">12903</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol = solAndGradInt + iNPad + llNVar;</div>
<div class="line"><a name="l12904"></a><span class="lineno">12904</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv = 1.0/sol[0];</div>
<div class="line"><a name="l12905"></a><span class="lineno">12905</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kinEner = 0.0;</div>
<div class="line"><a name="l12906"></a><span class="lineno">12906</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=1; k&lt;=<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) {</div>
<div class="line"><a name="l12907"></a><span class="lineno">12907</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel = sol[k]*rhoInv;</div>
<div class="line"><a name="l12908"></a><span class="lineno">12908</span>&#160;          kinEner += 0.5*vel*vel;</div>
<div class="line"><a name="l12909"></a><span class="lineno">12909</span>&#160;        }</div>
<div class="line"><a name="l12910"></a><span class="lineno">12910</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = sol[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1]*rhoInv - kinEner;</div>
<div class="line"><a name="l12911"></a><span class="lineno">12911</span>&#160; </div>
<div class="line"><a name="l12912"></a><span class="lineno">12912</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l12913"></a><span class="lineno">12913</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityLam        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l12914"></a><span class="lineno">12914</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ThermalConductivity = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a1b4858b3dc8a65fa2e8c868689191e56">GetThermalConductivity</a>();</div>
<div class="line"><a name="l12915"></a><span class="lineno">12915</span>&#160; </div>
<div class="line"><a name="l12916"></a><span class="lineno">12916</span>&#160;        <span class="comment">/* Determine the integration weight multiplied by the Jacobian. */</span></div>
<div class="line"><a name="l12917"></a><span class="lineno">12917</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">metricTerms</a>.data()</div>
<div class="line"><a name="l12918"></a><span class="lineno">12918</span>&#160;                                     + i*nMetricPerPoint;</div>
<div class="line"><a name="l12919"></a><span class="lineno">12919</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> weightJac    = weights[i]*metricTerms[0];</div>
<div class="line"><a name="l12920"></a><span class="lineno">12920</span>&#160; </div>
<div class="line"><a name="l12921"></a><span class="lineno">12921</span>&#160;        <span class="comment">/* Set the pointer to the coordinates in this integration point and</span></div>
<div class="line"><a name="l12922"></a><span class="lineno">12922</span>&#160;<span class="comment">           call the function to compute the source terms for the manufactured</span></div>
<div class="line"><a name="l12923"></a><span class="lineno">12923</span>&#160;<span class="comment">           solution. Note that this is an inviscid computation, so for</span></div>
<div class="line"><a name="l12924"></a><span class="lineno">12924</span>&#160;<span class="comment">           viscosity and thermal conductivity a zero is passed. */</span></div>
<div class="line"><a name="l12925"></a><span class="lineno">12925</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a51a6fc4be49459ff00b9391ba87291cd">coorIntegrationPoints</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l12926"></a><span class="lineno">12926</span>&#160; </div>
<div class="line"><a name="l12927"></a><span class="lineno">12927</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> sourceMan[5];</div>
<div class="line"><a name="l12928"></a><span class="lineno">12928</span>&#160;        SourceTermManufacturedSolution(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>, RGas, ViscosityLam,</div>
<div class="line"><a name="l12929"></a><span class="lineno">12929</span>&#160;                                       ThermalConductivity, coor, sourceMan);</div>
<div class="line"><a name="l12930"></a><span class="lineno">12930</span>&#160; </div>
<div class="line"><a name="l12931"></a><span class="lineno">12931</span>&#160;        <span class="comment">/*--- Subtract the source term of the manufactured solution, multiplied</span></div>
<div class="line"><a name="l12932"></a><span class="lineno">12932</span>&#160;<span class="comment">              by the appropriate weight, from the possibly earlier computed</span></div>
<div class="line"><a name="l12933"></a><span class="lineno">12933</span>&#160;<span class="comment">              source term. It is subtracted in order to be consistent with</span></div>
<div class="line"><a name="l12934"></a><span class="lineno">12934</span>&#160;<span class="comment">              the definition of the residual used in this code. ---*/</span></div>
<div class="line"><a name="l12935"></a><span class="lineno">12935</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *source = sources + iNPad + llNVar;</div>
<div class="line"><a name="l12936"></a><span class="lineno">12936</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++k)</div>
<div class="line"><a name="l12937"></a><span class="lineno">12937</span>&#160;          source[k] -= weightJac*sourceMan[k];</div>
<div class="line"><a name="l12938"></a><span class="lineno">12938</span>&#160;      }</div>
<div class="line"><a name="l12939"></a><span class="lineno">12939</span>&#160;    }</div>
<div class="line"><a name="l12940"></a><span class="lineno">12940</span>&#160; </div>
<div class="line"><a name="l12941"></a><span class="lineno">12941</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l12942"></a><span class="lineno">12942</span>&#160; </div>
<div class="line"><a name="l12943"></a><span class="lineno">12943</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12944"></a><span class="lineno">12944</span>&#160;    <span class="comment">/*--- Step 3: Compute the contribution to the residuals from the       ---*/</span></div>
<div class="line"><a name="l12945"></a><span class="lineno">12945</span>&#160;    <span class="comment">/*---         integration over the volume element.                     ---*/</span></div>
<div class="line"><a name="l12946"></a><span class="lineno">12946</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l12947"></a><span class="lineno">12947</span>&#160; </div>
<div class="line"><a name="l12948"></a><span class="lineno">12948</span>&#160;    <span class="comment">/* Call the general function to carry out the matrix product.</span></div>
<div class="line"><a name="l12949"></a><span class="lineno">12949</span>&#160;<span class="comment">       Use solDOFs as a temporary storage for the matrix product. */</span></div>
<div class="line"><a name="l12950"></a><span class="lineno">12950</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, matDerBasisIntTrans, fluxes, solDOFs, config);</div>
<div class="line"><a name="l12951"></a><span class="lineno">12951</span>&#160; </div>
<div class="line"><a name="l12952"></a><span class="lineno">12952</span>&#160;    <span class="comment">/* Add the contribution from the source terms, if needed. Use solAndGradInt</span></div>
<div class="line"><a name="l12953"></a><span class="lineno">12953</span>&#160;<span class="comment">       as temporary storage for the matrix product. */</span></div>
<div class="line"><a name="l12954"></a><span class="lineno">12954</span>&#160;    <span class="keywordflow">if</span>( addSourceTerms ) {</div>
<div class="line"><a name="l12955"></a><span class="lineno">12955</span>&#160; </div>
<div class="line"><a name="l12956"></a><span class="lineno">12956</span>&#160;      <span class="comment">/* Call the general function to carry out the matrix product. */</span></div>
<div class="line"><a name="l12957"></a><span class="lineno">12957</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, matBasisIntTrans, sources, solAndGradInt, config);</div>
<div class="line"><a name="l12958"></a><span class="lineno">12958</span>&#160; </div>
<div class="line"><a name="l12959"></a><span class="lineno">12959</span>&#160;      <span class="comment">/* Add the residuals due to source terms to the volume residuals */</span></div>
<div class="line"><a name="l12960"></a><span class="lineno">12960</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(nDOFs*NPad); ++i)</div>
<div class="line"><a name="l12961"></a><span class="lineno">12961</span>&#160;        solDOFs[i] += solAndGradInt[i];</div>
<div class="line"><a name="l12962"></a><span class="lineno">12962</span>&#160;    }</div>
<div class="line"><a name="l12963"></a><span class="lineno">12963</span>&#160; </div>
<div class="line"><a name="l12964"></a><span class="lineno">12964</span>&#160;    <span class="comment">/* Loop over the elements in this chunk to store the residuals</span></div>
<div class="line"><a name="l12965"></a><span class="lineno">12965</span>&#160;<span class="comment">       in the appropriate locations. */</span></div>
<div class="line"><a name="l12966"></a><span class="lineno">12966</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l12967"></a><span class="lineno">12967</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l12968"></a><span class="lineno">12968</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lInd   = l + ll;</div>
<div class="line"><a name="l12969"></a><span class="lineno">12969</span>&#160; </div>
<div class="line"><a name="l12970"></a><span class="lineno">12970</span>&#160;      <span class="comment">/* Easier storage of the residuals for this volume element. */</span></div>
<div class="line"><a name="l12971"></a><span class="lineno">12971</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *res = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">VecResDOFs</a>.data() + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[lInd].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a>;</div>
<div class="line"><a name="l12972"></a><span class="lineno">12972</span>&#160; </div>
<div class="line"><a name="l12973"></a><span class="lineno">12973</span>&#160;      <span class="comment">/* Loop over the DOFs and copy the data. */</span></div>
<div class="line"><a name="l12974"></a><span class="lineno">12974</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i)</div>
<div class="line"><a name="l12975"></a><span class="lineno">12975</span>&#160;        memcpy(res+i*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, solDOFs+i*NPad+llNVar, nBytes);</div>
<div class="line"><a name="l12976"></a><span class="lineno">12976</span>&#160;    }</div>
<div class="line"><a name="l12977"></a><span class="lineno">12977</span>&#160; </div>
<div class="line"><a name="l12978"></a><span class="lineno">12978</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l12979"></a><span class="lineno">12979</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l12980"></a><span class="lineno">12980</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l12981"></a><span class="lineno">12981</span>&#160;  }</div>
<div class="line"><a name="l12982"></a><span class="lineno">12982</span>&#160;}</div>
<div class="line"><a name="l12983"></a><span class="lineno">12983</span>&#160; </div>
<div class="line"><a name="l12984"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a5afc06c0edede6e3917a6b24158930ba">12984</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a5afc06c0edede6e3917a6b24158930ba">CFEM_DG_NSSolver::ResidualFaces</a>(<a class="code" href="class_c_config.html">CConfig</a>             *config,</div>
<div class="line"><a name="l12985"></a><span class="lineno">12985</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indFaceBeg,</div>
<div class="line"><a name="l12986"></a><span class="lineno">12986</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indFaceEnd,</div>
<div class="line"><a name="l12987"></a><span class="lineno">12987</span>&#160;                                     <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>       &amp;indResFaces,</div>
<div class="line"><a name="l12988"></a><span class="lineno">12988</span>&#160;                                     <a class="code" href="class_c_numerics.html">CNumerics</a>           *numerics,</div>
<div class="line"><a name="l12989"></a><span class="lineno">12989</span>&#160;                                     <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>           *workArray) {</div>
<div class="line"><a name="l12990"></a><span class="lineno">12990</span>&#160; </div>
<div class="line"><a name="l12991"></a><span class="lineno">12991</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l12992"></a><span class="lineno">12992</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l12993"></a><span class="lineno">12993</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l12994"></a><span class="lineno">12994</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l12995"></a><span class="lineno">12995</span>&#160; </div>
<div class="line"><a name="l12996"></a><span class="lineno">12996</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l12997"></a><span class="lineno">12997</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l12998"></a><span class="lineno">12998</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l12999"></a><span class="lineno">12999</span>&#160; </div>
<div class="line"><a name="l13000"></a><span class="lineno">13000</span>&#160;  <span class="comment">/* Set the number of bytes that must be copied in the memcpy calls. */</span></div>
<div class="line"><a name="l13001"></a><span class="lineno">13001</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l13002"></a><span class="lineno">13002</span>&#160; </div>
<div class="line"><a name="l13003"></a><span class="lineno">13003</span>&#160;  <span class="comment">/*--- Loop over the requested range of matching faces. Multiple faces</span></div>
<div class="line"><a name="l13004"></a><span class="lineno">13004</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l13005"></a><span class="lineno">13005</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l13006"></a><span class="lineno">13006</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l13007"></a><span class="lineno">13007</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=indFaceBeg; l&lt;indFaceEnd;) {</div>
<div class="line"><a name="l13008"></a><span class="lineno">13008</span>&#160; </div>
<div class="line"><a name="l13009"></a><span class="lineno">13009</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l13010"></a><span class="lineno">13010</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l13011"></a><span class="lineno">13011</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l13012"></a><span class="lineno">13012</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l13013"></a><span class="lineno">13013</span>&#160; </div>
<div class="line"><a name="l13014"></a><span class="lineno">13014</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>, l, indFaceEnd, nFaceSimul,</div>
<div class="line"><a name="l13015"></a><span class="lineno">13015</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l13016"></a><span class="lineno">13016</span>&#160; </div>
<div class="line"><a name="l13017"></a><span class="lineno">13017</span>&#160;    <span class="comment">/* Get the necessary data from the standard face. */</span></div>
<div class="line"><a name="l13018"></a><span class="lineno">13018</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l13019"></a><span class="lineno">13019</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *weights  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l13020"></a><span class="lineno">13020</span>&#160; </div>
<div class="line"><a name="l13021"></a><span class="lineno">13021</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#acd4208ae47226c5917479d6a232b7584">GetNDOFsFaceSide0</a>();</div>
<div class="line"><a name="l13022"></a><span class="lineno">13022</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsFace1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a0e3ff97b8c11ca92ede562565eec7041">GetNDOFsFaceSide1</a>();</div>
<div class="line"><a name="l13023"></a><span class="lineno">13023</span>&#160; </div>
<div class="line"><a name="l13024"></a><span class="lineno">13024</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem0  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a0719e8b18410e4720f58449ac28e8c38">GetNDOFsElemSide0</a>();</div>
<div class="line"><a name="l13025"></a><span class="lineno">13025</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem1  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a043294eff88a9374a936fefaca0ea860">GetNDOFsElemSide1</a>();</div>
<div class="line"><a name="l13026"></a><span class="lineno">13026</span>&#160; </div>
<div class="line"><a name="l13027"></a><span class="lineno">13027</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l13028"></a><span class="lineno">13028</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeFluxes = nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l13029"></a><span class="lineno">13029</span>&#160;    sizeFluxes = NPad*max(sizeFluxes, (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>) max(nDOFsElem0, nDOFsElem1));</div>
<div class="line"><a name="l13030"></a><span class="lineno">13030</span>&#160; </div>
<div class="line"><a name="l13031"></a><span class="lineno">13031</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sizeGradSolInt = nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad;</div>
<div class="line"><a name="l13032"></a><span class="lineno">13032</span>&#160; </div>
<div class="line"><a name="l13033"></a><span class="lineno">13033</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL       = workArray;</div>
<div class="line"><a name="l13034"></a><span class="lineno">13034</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR       = solIntL       + NPad*max(nInt, nDOFsElem0);</div>
<div class="line"><a name="l13035"></a><span class="lineno">13035</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *viscosityIntL = solIntR       + NPad*max(nInt, nDOFsElem1);</div>
<div class="line"><a name="l13036"></a><span class="lineno">13036</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *kOverCvIntL   = viscosityIntL + llEnd*nInt;</div>
<div class="line"><a name="l13037"></a><span class="lineno">13037</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *viscosityIntR = kOverCvIntL   + llEnd*nInt;</div>
<div class="line"><a name="l13038"></a><span class="lineno">13038</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *kOverCvIntR   = viscosityIntR + llEnd*nInt;</div>
<div class="line"><a name="l13039"></a><span class="lineno">13039</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradSolInt    = kOverCvIntR   + llEnd*nInt;</div>
<div class="line"><a name="l13040"></a><span class="lineno">13040</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxes        = gradSolInt    + sizeGradSolInt;</div>
<div class="line"><a name="l13041"></a><span class="lineno">13041</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *viscFluxes    = fluxes        + sizeFluxes;</div>
<div class="line"><a name="l13042"></a><span class="lineno">13042</span>&#160; </div>
<div class="line"><a name="l13043"></a><span class="lineno">13043</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13044"></a><span class="lineno">13044</span>&#160;    <span class="comment">/*--- Step 1: Compute the inviscid fluxes in the integration points of ---*/</span></div>
<div class="line"><a name="l13045"></a><span class="lineno">13045</span>&#160;    <span class="comment">/*---         this chunk of matching faces.                            ---*/</span></div>
<div class="line"><a name="l13046"></a><span class="lineno">13046</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13047"></a><span class="lineno">13047</span>&#160; </div>
<div class="line"><a name="l13048"></a><span class="lineno">13048</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ab7546cb31b73191bbac2b338c88cfbc4">InviscidFluxesInternalMatchingFace</a>(config, l, lEnd, NPad,</div>
<div class="line"><a name="l13049"></a><span class="lineno">13049</span>&#160;                                       solIntL, solIntR, fluxes, numerics);</div>
<div class="line"><a name="l13050"></a><span class="lineno">13050</span>&#160; </div>
<div class="line"><a name="l13051"></a><span class="lineno">13051</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13052"></a><span class="lineno">13052</span>&#160;    <span class="comment">/*--- Step 2: Compute the viscous fluxes in the integration points of  ---*/</span></div>
<div class="line"><a name="l13053"></a><span class="lineno">13053</span>&#160;    <span class="comment">/*---         this chunk of matching faces and subtract them from the  ---*/</span></div>
<div class="line"><a name="l13054"></a><span class="lineno">13054</span>&#160;    <span class="comment">/*---         already computed inviscid fluxes.                        ---*/</span></div>
<div class="line"><a name="l13055"></a><span class="lineno">13055</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13056"></a><span class="lineno">13056</span>&#160; </div>
<div class="line"><a name="l13057"></a><span class="lineno">13057</span>&#160;    <span class="comment">/*---------------------------*/</span></div>
<div class="line"><a name="l13058"></a><span class="lineno">13058</span>&#160;    <span class="comment">/*--- Side 0 of the face. ---*/</span></div>
<div class="line"><a name="l13059"></a><span class="lineno">13059</span>&#160;    <span class="comment">/*---------------------------*/</span></div>
<div class="line"><a name="l13060"></a><span class="lineno">13060</span>&#160; </div>
<div class="line"><a name="l13061"></a><span class="lineno">13061</span>&#160;    <span class="comment">/* Get the matrix, which contains the derivatives w.r.t. the</span></div>
<div class="line"><a name="l13062"></a><span class="lineno">13062</span>&#160;<span class="comment">       parametric coordinates of the basis functions. */</span></div>
<div class="line"><a name="l13063"></a><span class="lineno">13063</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *derBasisElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a1bc86f1b12860e69e4f4ececf7ebd5dc">GetMatDerBasisElemIntegrationSide0</a>();</div>
<div class="line"><a name="l13064"></a><span class="lineno">13064</span>&#160; </div>
<div class="line"><a name="l13065"></a><span class="lineno">13065</span>&#160;    <span class="comment">/* Set the pointer solElem to viscFluxes. This is just for readability,</span></div>
<div class="line"><a name="l13066"></a><span class="lineno">13066</span>&#160;<span class="comment">       as the same memory can be used for the storage of the solution of the</span></div>
<div class="line"><a name="l13067"></a><span class="lineno">13067</span>&#160;<span class="comment">       DOFs of the element and the viscous fluxes to be computed. */</span></div>
<div class="line"><a name="l13068"></a><span class="lineno">13068</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solElem = viscFluxes;</div>
<div class="line"><a name="l13069"></a><span class="lineno">13069</span>&#160; </div>
<div class="line"><a name="l13070"></a><span class="lineno">13070</span>&#160;    <span class="comment">/*--- Loop over the faces in this chunk to set the conserved variables</span></div>
<div class="line"><a name="l13071"></a><span class="lineno">13071</span>&#160;<span class="comment">          in the DOFs of the faces. */</span></div>
<div class="line"><a name="l13072"></a><span class="lineno">13072</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l13073"></a><span class="lineno">13073</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel  = ll - l;</div>
<div class="line"><a name="l13074"></a><span class="lineno">13074</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = llRel*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l13075"></a><span class="lineno">13075</span>&#160; </div>
<div class="line"><a name="l13076"></a><span class="lineno">13076</span>&#160;      <span class="comment">/* Determine the time level of the face, which is the minimum</span></div>
<div class="line"><a name="l13077"></a><span class="lineno">13077</span>&#160;<span class="comment">         of the levels of the adjacent elements. */</span></div>
<div class="line"><a name="l13078"></a><span class="lineno">13078</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l13079"></a><span class="lineno">13079</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l13080"></a><span class="lineno">13080</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevelFace = min(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].timeLevel,</div>
<div class="line"><a name="l13081"></a><span class="lineno">13081</span>&#160;                                               <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].timeLevel);</div>
<div class="line"><a name="l13082"></a><span class="lineno">13082</span>&#160; </div>
<div class="line"><a name="l13083"></a><span class="lineno">13083</span>&#160;      <span class="comment">/* Determine the offset that must be applied to access the correct data</span></div>
<div class="line"><a name="l13084"></a><span class="lineno">13084</span>&#160;<span class="comment">         for this elemID0 in the working vector of the solution. If the element</span></div>
<div class="line"><a name="l13085"></a><span class="lineno">13085</span>&#160;<span class="comment">         has the same time level as the face offsetDOFsSolThisTimeLevel is used,</span></div>
<div class="line"><a name="l13086"></a><span class="lineno">13086</span>&#160;<span class="comment">         otherwise offsetDOFsSolPrevTimeLevel is the correct value. */</span></div>
<div class="line"><a name="l13087"></a><span class="lineno">13087</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset;</div>
<div class="line"><a name="l13088"></a><span class="lineno">13088</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].timeLevel == timeLevelFace) {</div>
<div class="line"><a name="l13089"></a><span class="lineno">13089</span>&#160;        offset = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l13090"></a><span class="lineno">13090</span>&#160;               - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l13091"></a><span class="lineno">13091</span>&#160;      }</div>
<div class="line"><a name="l13092"></a><span class="lineno">13092</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13093"></a><span class="lineno">13093</span>&#160;        offset = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l13094"></a><span class="lineno">13094</span>&#160;               - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].<a class="code" href="class_c_volume_element_f_e_m.html#aca2a1ae12ad274b8c2494ffb69bd73f1">offsetDOFsSolPrevTimeLevel</a>;</div>
<div class="line"><a name="l13095"></a><span class="lineno">13095</span>&#160;      }</div>
<div class="line"><a name="l13096"></a><span class="lineno">13096</span>&#160; </div>
<div class="line"><a name="l13097"></a><span class="lineno">13097</span>&#160;      <span class="comment">/*--- Store the solution of the DOFs of the elemID0 in the correct</span></div>
<div class="line"><a name="l13098"></a><span class="lineno">13098</span>&#160;<span class="comment">            sequence, such that a generalized approach is possible. ---*/</span></div>
<div class="line"><a name="l13099"></a><span class="lineno">13099</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFsElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#aaf7209a1e287371117f9e525f6aae3e6">DOFsSolElementSide0</a>.data();</div>
<div class="line"><a name="l13100"></a><span class="lineno">13100</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem0; ++i) {</div>
<div class="line"><a name="l13101"></a><span class="lineno">13101</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevelFace].data()</div>
<div class="line"><a name="l13102"></a><span class="lineno">13102</span>&#160;                                + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(DOFsElem[i] - offset);</div>
<div class="line"><a name="l13103"></a><span class="lineno">13103</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *sol    = solElem + NPad*i + llNVar;</div>
<div class="line"><a name="l13104"></a><span class="lineno">13104</span>&#160;        memcpy(sol, solDOF, nBytes);</div>
<div class="line"><a name="l13105"></a><span class="lineno">13105</span>&#160;      }</div>
<div class="line"><a name="l13106"></a><span class="lineno">13106</span>&#160;    }</div>
<div class="line"><a name="l13107"></a><span class="lineno">13107</span>&#160; </div>
<div class="line"><a name="l13108"></a><span class="lineno">13108</span>&#160;    <span class="comment">/* Compute the gradients w.r.t. the parametric coordinates in the integration</span></div>
<div class="line"><a name="l13109"></a><span class="lineno">13109</span>&#160;<span class="comment">       points. Call the general function to carry out the matrix product. */</span></div>
<div class="line"><a name="l13110"></a><span class="lineno">13110</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFsElem0, derBasisElem, solElem, gradSolInt, config);</div>
<div class="line"><a name="l13111"></a><span class="lineno">13111</span>&#160; </div>
<div class="line"><a name="l13112"></a><span class="lineno">13112</span>&#160;    <span class="comment">/*--- Loop over the faces in this chunk to compute the viscous flux</span></div>
<div class="line"><a name="l13113"></a><span class="lineno">13113</span>&#160;<span class="comment">          vector for side 0. */</span></div>
<div class="line"><a name="l13114"></a><span class="lineno">13114</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l13115"></a><span class="lineno">13115</span>&#160; </div>
<div class="line"><a name="l13116"></a><span class="lineno">13116</span>&#160;      <span class="comment">/* Determine the ID of the adjacent element. */</span></div>
<div class="line"><a name="l13117"></a><span class="lineno">13117</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel = ll - l;</div>
<div class="line"><a name="l13118"></a><span class="lineno">13118</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l13119"></a><span class="lineno">13119</span>&#160; </div>
<div class="line"><a name="l13120"></a><span class="lineno">13120</span>&#160;      <span class="comment">/* Call the general function to compute the viscous flux in normal</span></div>
<div class="line"><a name="l13121"></a><span class="lineno">13121</span>&#160;<span class="comment">         direction for side 0. */</span></div>
<div class="line"><a name="l13122"></a><span class="lineno">13122</span>&#160;      ViscousNormalFluxFace(&amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0], llRel, nInt, NPad,</div>
<div class="line"><a name="l13123"></a><span class="lineno">13123</span>&#160;                            0.0, <span class="keyword">false</span>, solIntL, gradSolInt,</div>
<div class="line"><a name="l13124"></a><span class="lineno">13124</span>&#160;                            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricCoorDerivFace0.data(),</div>
<div class="line"><a name="l13125"></a><span class="lineno">13125</span>&#160;                            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#ad986a0eec8bc2e27e76046f64cec1046">metricNormalsFace</a>.data(),</div>
<div class="line"><a name="l13126"></a><span class="lineno">13126</span>&#160;                            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#afec7875eae117cffa907fa22b0dfd2b7">wallDistance</a>.data(),</div>
<div class="line"><a name="l13127"></a><span class="lineno">13127</span>&#160;                            viscFluxes, viscosityIntL, kOverCvIntL);</div>
<div class="line"><a name="l13128"></a><span class="lineno">13128</span>&#160;    }</div>
<div class="line"><a name="l13129"></a><span class="lineno">13129</span>&#160; </div>
<div class="line"><a name="l13130"></a><span class="lineno">13130</span>&#160;    <span class="comment">/*--- Subtract half of the viscous fluxes from the inviscid fluxes. The</span></div>
<div class="line"><a name="l13131"></a><span class="lineno">13131</span>&#160;<span class="comment">          factor 0.5 comes from the fact that the average of the viscous fluxes</span></div>
<div class="line"><a name="l13132"></a><span class="lineno">13132</span>&#160;<span class="comment">          of side 0 and side 1 must be taken in the DG-FEM formulation. ---*/</span></div>
<div class="line"><a name="l13133"></a><span class="lineno">13133</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;(NPad*nInt); ++j) fluxes[j] -= 0.5*viscFluxes[j];</div>
<div class="line"><a name="l13134"></a><span class="lineno">13134</span>&#160; </div>
<div class="line"><a name="l13135"></a><span class="lineno">13135</span>&#160;    <span class="comment">/*---------------------------*/</span></div>
<div class="line"><a name="l13136"></a><span class="lineno">13136</span>&#160;    <span class="comment">/*--- Side 1 of the face. ---*/</span></div>
<div class="line"><a name="l13137"></a><span class="lineno">13137</span>&#160;    <span class="comment">/*---------------------------*/</span></div>
<div class="line"><a name="l13138"></a><span class="lineno">13138</span>&#160; </div>
<div class="line"><a name="l13139"></a><span class="lineno">13139</span>&#160;    <span class="comment">/* Get the matrix, which contains the derivatives w.r.t. the</span></div>
<div class="line"><a name="l13140"></a><span class="lineno">13140</span>&#160;<span class="comment">       parametric coordinates of the basis functions. */</span></div>
<div class="line"><a name="l13141"></a><span class="lineno">13141</span>&#160;    derBasisElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a0f00dfc701d8547806a8865a0fc22f3f">GetMatDerBasisElemIntegrationSide1</a>();</div>
<div class="line"><a name="l13142"></a><span class="lineno">13142</span>&#160; </div>
<div class="line"><a name="l13143"></a><span class="lineno">13143</span>&#160;    <span class="comment">/*--- Loop over the faces in this chunk to set the conserved variables</span></div>
<div class="line"><a name="l13144"></a><span class="lineno">13144</span>&#160;<span class="comment">          in the DOFs of the faces. */</span></div>
<div class="line"><a name="l13145"></a><span class="lineno">13145</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l13146"></a><span class="lineno">13146</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel  = ll - l;</div>
<div class="line"><a name="l13147"></a><span class="lineno">13147</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = llRel*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l13148"></a><span class="lineno">13148</span>&#160; </div>
<div class="line"><a name="l13149"></a><span class="lineno">13149</span>&#160;      <span class="comment">/* Determine the time level of the face, which is the minimum</span></div>
<div class="line"><a name="l13150"></a><span class="lineno">13150</span>&#160;<span class="comment">         of the levels of the adjacent elements. */</span></div>
<div class="line"><a name="l13151"></a><span class="lineno">13151</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l13152"></a><span class="lineno">13152</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l13153"></a><span class="lineno">13153</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevelFace = min(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].timeLevel,</div>
<div class="line"><a name="l13154"></a><span class="lineno">13154</span>&#160;                                               <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].timeLevel);</div>
<div class="line"><a name="l13155"></a><span class="lineno">13155</span>&#160; </div>
<div class="line"><a name="l13156"></a><span class="lineno">13156</span>&#160;      <span class="comment">/* Determine the offset that must be applied to access the correct data</span></div>
<div class="line"><a name="l13157"></a><span class="lineno">13157</span>&#160;<span class="comment">         for this elemID0 in the working vector of the solution. If the element</span></div>
<div class="line"><a name="l13158"></a><span class="lineno">13158</span>&#160;<span class="comment">         has the same time level as the face offsetDOFsSolThisTimeLevel is used,</span></div>
<div class="line"><a name="l13159"></a><span class="lineno">13159</span>&#160;<span class="comment">         otherwise offsetDOFsSolPrevTimeLevel is the correct value. */</span></div>
<div class="line"><a name="l13160"></a><span class="lineno">13160</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset;</div>
<div class="line"><a name="l13161"></a><span class="lineno">13161</span>&#160;      <span class="keywordflow">if</span>(<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].timeLevel == timeLevelFace) {</div>
<div class="line"><a name="l13162"></a><span class="lineno">13162</span>&#160;        offset = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l13163"></a><span class="lineno">13163</span>&#160;               - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l13164"></a><span class="lineno">13164</span>&#160;      }</div>
<div class="line"><a name="l13165"></a><span class="lineno">13165</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13166"></a><span class="lineno">13166</span>&#160;        offset = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l13167"></a><span class="lineno">13167</span>&#160;               - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].<a class="code" href="class_c_volume_element_f_e_m.html#aca2a1ae12ad274b8c2494ffb69bd73f1">offsetDOFsSolPrevTimeLevel</a>;</div>
<div class="line"><a name="l13168"></a><span class="lineno">13168</span>&#160;      }</div>
<div class="line"><a name="l13169"></a><span class="lineno">13169</span>&#160; </div>
<div class="line"><a name="l13170"></a><span class="lineno">13170</span>&#160;      <span class="comment">/*--- Store the solution of the DOFs of the elemID1 in the correct</span></div>
<div class="line"><a name="l13171"></a><span class="lineno">13171</span>&#160;<span class="comment">            sequence, such that a generalized approach is possible. ---*/</span></div>
<div class="line"><a name="l13172"></a><span class="lineno">13172</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFsElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#ab6c86e670d9d1ae338a04795a5638b1f">DOFsSolElementSide1</a>.data();</div>
<div class="line"><a name="l13173"></a><span class="lineno">13173</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem1; ++i) {</div>
<div class="line"><a name="l13174"></a><span class="lineno">13174</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevelFace].data()</div>
<div class="line"><a name="l13175"></a><span class="lineno">13175</span>&#160;                                + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(DOFsElem[i] - offset);</div>
<div class="line"><a name="l13176"></a><span class="lineno">13176</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *sol    = solElem + NPad*i + llNVar;</div>
<div class="line"><a name="l13177"></a><span class="lineno">13177</span>&#160;        memcpy(sol, solDOF, nBytes);</div>
<div class="line"><a name="l13178"></a><span class="lineno">13178</span>&#160;      }</div>
<div class="line"><a name="l13179"></a><span class="lineno">13179</span>&#160;    }</div>
<div class="line"><a name="l13180"></a><span class="lineno">13180</span>&#160; </div>
<div class="line"><a name="l13181"></a><span class="lineno">13181</span>&#160;    <span class="comment">/* Compute the gradients w.r.t. the parametric coordinates in the integration</span></div>
<div class="line"><a name="l13182"></a><span class="lineno">13182</span>&#160;<span class="comment">       points. Call the general function to carry out the matrix product. */</span></div>
<div class="line"><a name="l13183"></a><span class="lineno">13183</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFsElem1, derBasisElem, solElem, gradSolInt, config);</div>
<div class="line"><a name="l13184"></a><span class="lineno">13184</span>&#160; </div>
<div class="line"><a name="l13185"></a><span class="lineno">13185</span>&#160;    <span class="comment">/*--- Loop over the faces in this chunk to compute the viscous flux</span></div>
<div class="line"><a name="l13186"></a><span class="lineno">13186</span>&#160;<span class="comment">          vector for side 1. */</span></div>
<div class="line"><a name="l13187"></a><span class="lineno">13187</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l13188"></a><span class="lineno">13188</span>&#160; </div>
<div class="line"><a name="l13189"></a><span class="lineno">13189</span>&#160;      <span class="comment">/* Determine the ID of the adjacent element. */</span></div>
<div class="line"><a name="l13190"></a><span class="lineno">13190</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel = ll - l;</div>
<div class="line"><a name="l13191"></a><span class="lineno">13191</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l13192"></a><span class="lineno">13192</span>&#160; </div>
<div class="line"><a name="l13193"></a><span class="lineno">13193</span>&#160;      <span class="comment">/* Call the general function to compute the viscous flux in normal</span></div>
<div class="line"><a name="l13194"></a><span class="lineno">13194</span>&#160;<span class="comment">         direction for side 1. */</span></div>
<div class="line"><a name="l13195"></a><span class="lineno">13195</span>&#160;      ViscousNormalFluxFace(&amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1], llRel, nInt, NPad,</div>
<div class="line"><a name="l13196"></a><span class="lineno">13196</span>&#160;                            0.0, <span class="keyword">false</span>, solIntR, gradSolInt,</div>
<div class="line"><a name="l13197"></a><span class="lineno">13197</span>&#160;                            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricCoorDerivFace1.data(),</div>
<div class="line"><a name="l13198"></a><span class="lineno">13198</span>&#160;                            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#ad986a0eec8bc2e27e76046f64cec1046">metricNormalsFace</a>.data(),</div>
<div class="line"><a name="l13199"></a><span class="lineno">13199</span>&#160;                            <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#afec7875eae117cffa907fa22b0dfd2b7">wallDistance</a>.data(),</div>
<div class="line"><a name="l13200"></a><span class="lineno">13200</span>&#160;                            viscFluxes, viscosityIntR, kOverCvIntR);</div>
<div class="line"><a name="l13201"></a><span class="lineno">13201</span>&#160;    }</div>
<div class="line"><a name="l13202"></a><span class="lineno">13202</span>&#160; </div>
<div class="line"><a name="l13203"></a><span class="lineno">13203</span>&#160;    <span class="comment">/*--- Subtract half of the viscous fluxes from the inviscid fluxes. ---*/</span></div>
<div class="line"><a name="l13204"></a><span class="lineno">13204</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;(NPad*nInt); ++j) fluxes[j] -= 0.5*viscFluxes[j];</div>
<div class="line"><a name="l13205"></a><span class="lineno">13205</span>&#160; </div>
<div class="line"><a name="l13206"></a><span class="lineno">13206</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13207"></a><span class="lineno">13207</span>&#160;    <span class="comment">/*--- Step 3: Compute the penalty terms in the integration points of   ---*/</span></div>
<div class="line"><a name="l13208"></a><span class="lineno">13208</span>&#160;    <span class="comment">/*---         this chunk of matching faces and add them to the already ---*/</span></div>
<div class="line"><a name="l13209"></a><span class="lineno">13209</span>&#160;    <span class="comment">/*---         stored inviscid and viscous fluxes.                      ---*/</span></div>
<div class="line"><a name="l13210"></a><span class="lineno">13210</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13211"></a><span class="lineno">13211</span>&#160; </div>
<div class="line"><a name="l13212"></a><span class="lineno">13212</span>&#160;    <span class="comment">/* Get the required constant needed for the penalty terms. */</span></div>
<div class="line"><a name="l13213"></a><span class="lineno">13213</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ConstPenFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#ab40a08956d8e1bd5a19c7e166b63d3ee">GetPenaltyConstant</a>();</div>
<div class="line"><a name="l13214"></a><span class="lineno">13214</span>&#160; </div>
<div class="line"><a name="l13215"></a><span class="lineno">13215</span>&#160;    <span class="comment">/*--- Loop over the faces in this chunk to compute the penalty fluxes. ---*/</span></div>
<div class="line"><a name="l13216"></a><span class="lineno">13216</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l13217"></a><span class="lineno">13217</span>&#160; </div>
<div class="line"><a name="l13218"></a><span class="lineno">13218</span>&#160;      <span class="comment">/* Get the length scales of the adjacent elements. */</span></div>
<div class="line"><a name="l13219"></a><span class="lineno">13219</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel = ll - l;</div>
<div class="line"><a name="l13220"></a><span class="lineno">13220</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#a07efa5d61195d365f7650e36851c03bb">elemID0</a>;</div>
<div class="line"><a name="l13221"></a><span class="lineno">13221</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].<a class="code" href="class_c_internal_face_element_f_e_m.html#a26aae78c2fbc75adc617e6d5b152886f">elemID1</a>;</div>
<div class="line"><a name="l13222"></a><span class="lineno">13222</span>&#160; </div>
<div class="line"><a name="l13223"></a><span class="lineno">13223</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID0].<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>;</div>
<div class="line"><a name="l13224"></a><span class="lineno">13224</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID1].<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>;</div>
<div class="line"><a name="l13225"></a><span class="lineno">13225</span>&#160; </div>
<div class="line"><a name="l13226"></a><span class="lineno">13226</span>&#160;      <span class="comment">/* Call the function PenaltyTermsFluxFace to compute the actual penalty</span></div>
<div class="line"><a name="l13227"></a><span class="lineno">13227</span>&#160;<span class="comment">         terms. Use the array viscFluxes as storage. */</span></div>
<div class="line"><a name="l13228"></a><span class="lineno">13228</span>&#160;      PenaltyTermsFluxFace(llRel, nInt, NPad, solIntL, solIntR, viscosityIntL,</div>
<div class="line"><a name="l13229"></a><span class="lineno">13229</span>&#160;                           viscosityIntR, kOverCvIntL, kOverCvIntR,</div>
<div class="line"><a name="l13230"></a><span class="lineno">13230</span>&#160;                           ConstPenFace, lenScale0, lenScale1,</div>
<div class="line"><a name="l13231"></a><span class="lineno">13231</span>&#160;                           <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricNormalsFace.data(),</div>
<div class="line"><a name="l13232"></a><span class="lineno">13232</span>&#160;                           viscFluxes);</div>
<div class="line"><a name="l13233"></a><span class="lineno">13233</span>&#160;    }</div>
<div class="line"><a name="l13234"></a><span class="lineno">13234</span>&#160; </div>
<div class="line"><a name="l13235"></a><span class="lineno">13235</span>&#160;    <span class="comment">/* Add the penalty fluxes to the earlier computed fluxes. */</span></div>
<div class="line"><a name="l13236"></a><span class="lineno">13236</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;(NPad*nInt); ++j) fluxes[j] += viscFluxes[j];</div>
<div class="line"><a name="l13237"></a><span class="lineno">13237</span>&#160; </div>
<div class="line"><a name="l13238"></a><span class="lineno">13238</span>&#160;    <span class="comment">/* Multiply the fluxes with the integration weight of the corresponding</span></div>
<div class="line"><a name="l13239"></a><span class="lineno">13239</span>&#160;<span class="comment">       integration point. */</span></div>
<div class="line"><a name="l13240"></a><span class="lineno">13240</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l13241"></a><span class="lineno">13241</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux = fluxes + i*NPad;</div>
<div class="line"><a name="l13242"></a><span class="lineno">13242</span>&#160; </div>
<div class="line"><a name="l13243"></a><span class="lineno">13243</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;NPad; ++j)</div>
<div class="line"><a name="l13244"></a><span class="lineno">13244</span>&#160;        flux[j] *= weights[i];</div>
<div class="line"><a name="l13245"></a><span class="lineno">13245</span>&#160;    }</div>
<div class="line"><a name="l13246"></a><span class="lineno">13246</span>&#160; </div>
<div class="line"><a name="l13247"></a><span class="lineno">13247</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13248"></a><span class="lineno">13248</span>&#160;    <span class="comment">/*--- Step 4: Compute the contribution to the residuals from the       ---*/</span></div>
<div class="line"><a name="l13249"></a><span class="lineno">13249</span>&#160;    <span class="comment">/*---         integration over this internal matching face.            ---*/</span></div>
<div class="line"><a name="l13250"></a><span class="lineno">13250</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13251"></a><span class="lineno">13251</span>&#160; </div>
<div class="line"><a name="l13252"></a><span class="lineno">13252</span>&#160;    <span class="comment">/* Set the value of the offset of the residual between each of the fused</span></div>
<div class="line"><a name="l13253"></a><span class="lineno">13253</span>&#160;<span class="comment">       faces. This depends whether or not symmetrizing terms are stored.</span></div>
<div class="line"><a name="l13254"></a><span class="lineno">13254</span>&#160;<span class="comment">       Also set the location where the symmetrizing terms of the first face</span></div>
<div class="line"><a name="l13255"></a><span class="lineno">13255</span>&#160;<span class="comment">       must be stored. */</span></div>
<div class="line"><a name="l13256"></a><span class="lineno">13256</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offsetRes = nDOFsFace0 + nDOFsFace1;</div>
<div class="line"><a name="l13257"></a><span class="lineno">13257</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) offsetRes += nDOFsElem0 + nDOFsElem1;</div>
<div class="line"><a name="l13258"></a><span class="lineno">13258</span>&#160; </div>
<div class="line"><a name="l13259"></a><span class="lineno">13259</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResSym = indResFaces + nDOFsFace0 + nDOFsFace1;</div>
<div class="line"><a name="l13260"></a><span class="lineno">13260</span>&#160; </div>
<div class="line"><a name="l13261"></a><span class="lineno">13261</span>&#160;    <span class="comment">/* Get the correct form of the basis functions needed for the matrix</span></div>
<div class="line"><a name="l13262"></a><span class="lineno">13262</span>&#160;<span class="comment">       multiplication to compute the residual. Use gradSolInt as a temporary</span></div>
<div class="line"><a name="l13263"></a><span class="lineno">13263</span>&#160;<span class="comment">       buffer to store this product. */</span></div>
<div class="line"><a name="l13264"></a><span class="lineno">13264</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFaceTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a5dec1874e302623d6c8fb57e7e34e960">GetBasisFaceIntegrationTransposeSide0</a>();</div>
<div class="line"><a name="l13265"></a><span class="lineno">13265</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resSide0 = gradSolInt;</div>
<div class="line"><a name="l13266"></a><span class="lineno">13266</span>&#160; </div>
<div class="line"><a name="l13267"></a><span class="lineno">13267</span>&#160;    <span class="comment">/* Call the general function to carry out the matrix product. */</span></div>
<div class="line"><a name="l13268"></a><span class="lineno">13268</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFsFace0, NPad, nInt, basisFaceTrans, fluxes, resSide0, config);</div>
<div class="line"><a name="l13269"></a><span class="lineno">13269</span>&#160; </div>
<div class="line"><a name="l13270"></a><span class="lineno">13270</span>&#160;    <span class="comment">/* Check if the number of DOFs on both sides of the face is different.</span></div>
<div class="line"><a name="l13271"></a><span class="lineno">13271</span>&#160;<span class="comment">       In that case also the matrix product with the basis functions on side 1</span></div>
<div class="line"><a name="l13272"></a><span class="lineno">13272</span>&#160;<span class="comment">       must be carried out. Use viscFluxes as a temporary buffer to store</span></div>
<div class="line"><a name="l13273"></a><span class="lineno">13273</span>&#160;<span class="comment">       this product. */</span></div>
<div class="line"><a name="l13274"></a><span class="lineno">13274</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resSide1 = viscFluxes;</div>
<div class="line"><a name="l13275"></a><span class="lineno">13275</span>&#160;    <span class="keywordflow">if</span>(nDOFsFace1 != nDOFsFace0) {</div>
<div class="line"><a name="l13276"></a><span class="lineno">13276</span>&#160;      basisFaceTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a90446ea5444c214ece32dc39dc40a2ae">GetBasisFaceIntegrationTransposeSide1</a>();</div>
<div class="line"><a name="l13277"></a><span class="lineno">13277</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFsFace1, NPad, nInt, basisFaceTrans, fluxes, resSide1, config);</div>
<div class="line"><a name="l13278"></a><span class="lineno">13278</span>&#160;    }</div>
<div class="line"><a name="l13279"></a><span class="lineno">13279</span>&#160; </div>
<div class="line"><a name="l13280"></a><span class="lineno">13280</span>&#160;    <span class="comment">/* Loop over the number of faces in this chunk. */</span></div>
<div class="line"><a name="l13281"></a><span class="lineno">13281</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l13282"></a><span class="lineno">13282</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l13283"></a><span class="lineno">13283</span>&#160; </div>
<div class="line"><a name="l13284"></a><span class="lineno">13284</span>&#160;      <span class="comment">/* Set the pointer in the residual array where the residual of side 0</span></div>
<div class="line"><a name="l13285"></a><span class="lineno">13285</span>&#160;<span class="comment">         and side 1 of this face must be stored. Update the counter. */</span></div>
<div class="line"><a name="l13286"></a><span class="lineno">13286</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFace0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + indResFaces*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l13287"></a><span class="lineno">13287</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFace1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + (indResFaces+nDOFsFace0)*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l13288"></a><span class="lineno">13288</span>&#160;      indResFaces        += offsetRes;</div>
<div class="line"><a name="l13289"></a><span class="lineno">13289</span>&#160; </div>
<div class="line"><a name="l13290"></a><span class="lineno">13290</span>&#160;      <span class="comment">/* Loop over the DOFs and copy the data for side 0. */</span></div>
<div class="line"><a name="l13291"></a><span class="lineno">13291</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsFace0; ++i)</div>
<div class="line"><a name="l13292"></a><span class="lineno">13292</span>&#160;        memcpy(resFace0+<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i, resSide0+NPad*i+llNVar, nBytes);</div>
<div class="line"><a name="l13293"></a><span class="lineno">13293</span>&#160; </div>
<div class="line"><a name="l13294"></a><span class="lineno">13294</span>&#160;      <span class="comment">/* If the number of DOFs on both sides is the same, then the residual</span></div>
<div class="line"><a name="l13295"></a><span class="lineno">13295</span>&#160;<span class="comment">         of side 1 is obtained by simply negating the residual of side 0.</span></div>
<div class="line"><a name="l13296"></a><span class="lineno">13296</span>&#160;<span class="comment">         Otherwise a copy must be carried out and the residual negated,</span></div>
<div class="line"><a name="l13297"></a><span class="lineno">13297</span>&#160;<span class="comment">         because the normal is pointing into the adjacent element for side 1. */</span></div>
<div class="line"><a name="l13298"></a><span class="lineno">13298</span>&#160;      <span class="keywordflow">if</span>(nDOFsFace1 == nDOFsFace0) {</div>
<div class="line"><a name="l13299"></a><span class="lineno">13299</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*nDOFsFace1); ++i)</div>
<div class="line"><a name="l13300"></a><span class="lineno">13300</span>&#160;          resFace1[i] = -resFace0[i];</div>
<div class="line"><a name="l13301"></a><span class="lineno">13301</span>&#160;      }</div>
<div class="line"><a name="l13302"></a><span class="lineno">13302</span>&#160;      <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l13303"></a><span class="lineno">13303</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsFace1; ++i)</div>
<div class="line"><a name="l13304"></a><span class="lineno">13304</span>&#160;          memcpy(resFace1+<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i, resSide1+NPad*i+llNVar, nBytes);</div>
<div class="line"><a name="l13305"></a><span class="lineno">13305</span>&#160; </div>
<div class="line"><a name="l13306"></a><span class="lineno">13306</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;(<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*nDOFsFace1); ++i)</div>
<div class="line"><a name="l13307"></a><span class="lineno">13307</span>&#160;        resFace1[i] = -resFace1[i];</div>
<div class="line"><a name="l13308"></a><span class="lineno">13308</span>&#160;      }</div>
<div class="line"><a name="l13309"></a><span class="lineno">13309</span>&#160;    }</div>
<div class="line"><a name="l13310"></a><span class="lineno">13310</span>&#160; </div>
<div class="line"><a name="l13311"></a><span class="lineno">13311</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13312"></a><span class="lineno">13312</span>&#160;    <span class="comment">/*--- Step 5: Compute and distribute the symmetrizing terms, if        ---*/</span></div>
<div class="line"><a name="l13313"></a><span class="lineno">13313</span>&#160;    <span class="comment">/*---         present. Note that these terms must be distributed to    ---*/</span></div>
<div class="line"><a name="l13314"></a><span class="lineno">13314</span>&#160;    <span class="comment">/*---         DOFs of the adjacent element, not only of the face.      ---*/</span></div>
<div class="line"><a name="l13315"></a><span class="lineno">13315</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13316"></a><span class="lineno">13316</span>&#160; </div>
<div class="line"><a name="l13317"></a><span class="lineno">13317</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) {</div>
<div class="line"><a name="l13318"></a><span class="lineno">13318</span>&#160; </div>
<div class="line"><a name="l13319"></a><span class="lineno">13319</span>&#160;      <span class="comment">/* Use gradSolInt as a buffer to store the parametric fluxes. */</span></div>
<div class="line"><a name="l13320"></a><span class="lineno">13320</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *paramFluxes = gradSolInt;</div>
<div class="line"><a name="l13321"></a><span class="lineno">13321</span>&#160; </div>
<div class="line"><a name="l13322"></a><span class="lineno">13322</span>&#160;      <span class="comment">/* The symmetrizing fluxes will be multiplied by 0.5 times the theta</span></div>
<div class="line"><a name="l13323"></a><span class="lineno">13323</span>&#160;<span class="comment">         parameter. Store this factor a bit easier. */</span></div>
<div class="line"><a name="l13324"></a><span class="lineno">13324</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> halfTheta = 0.5*config-&gt;<a class="code" href="class_c_config.html#aebb368493e43eb306cf65de037c2e9bc">GetTheta_Interior_Penalty_DGFEM</a>();</div>
<div class="line"><a name="l13325"></a><span class="lineno">13325</span>&#160; </div>
<div class="line"><a name="l13326"></a><span class="lineno">13326</span>&#160;      <span class="comment">/* Loop over the faces in this chunk to compute the symmetrizing fluxes. */</span></div>
<div class="line"><a name="l13327"></a><span class="lineno">13327</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l13328"></a><span class="lineno">13328</span>&#160; </div>
<div class="line"><a name="l13329"></a><span class="lineno">13329</span>&#160;        <span class="comment">/* Compute the symmetrizing fluxes in the nDim directions in the</span></div>
<div class="line"><a name="l13330"></a><span class="lineno">13330</span>&#160;<span class="comment">           integration points of the face. */</span></div>
<div class="line"><a name="l13331"></a><span class="lineno">13331</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel = ll - l;</div>
<div class="line"><a name="l13332"></a><span class="lineno">13332</span>&#160;        SymmetrizingFluxesFace(llRel, nInt, NPad, solIntL, solIntR, viscosityIntL,</div>
<div class="line"><a name="l13333"></a><span class="lineno">13333</span>&#160;                               viscosityIntR, kOverCvIntL, kOverCvIntR,</div>
<div class="line"><a name="l13334"></a><span class="lineno">13334</span>&#160;                               <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricNormalsFace.data(),</div>
<div class="line"><a name="l13335"></a><span class="lineno">13335</span>&#160;                               fluxes);</div>
<div class="line"><a name="l13336"></a><span class="lineno">13336</span>&#160; </div>
<div class="line"><a name="l13337"></a><span class="lineno">13337</span>&#160;        <span class="comment">/* Transform the fluxes, such that they must be multiplied with the</span></div>
<div class="line"><a name="l13338"></a><span class="lineno">13338</span>&#160;<span class="comment">           gradients w.r.t. the parametric coordinates rather than the</span></div>
<div class="line"><a name="l13339"></a><span class="lineno">13339</span>&#160;<span class="comment">           Cartesian coordinates of the basis functions. Also a multiplication</span></div>
<div class="line"><a name="l13340"></a><span class="lineno">13340</span>&#160;<span class="comment">           with the integration weight and the theta parameter is carried out.</span></div>
<div class="line"><a name="l13341"></a><span class="lineno">13341</span>&#160;<span class="comment">           In this loop only side 0 of the face is treated. */</span></div>
<div class="line"><a name="l13342"></a><span class="lineno">13342</span>&#160;        TransformSymmetrizingFluxes(llRel, nInt, NPad, halfTheta, fluxes, weights,</div>
<div class="line"><a name="l13343"></a><span class="lineno">13343</span>&#160;                                    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricCoorDerivFace0.data(),</div>
<div class="line"><a name="l13344"></a><span class="lineno">13344</span>&#160;                                    paramFluxes);</div>
<div class="line"><a name="l13345"></a><span class="lineno">13345</span>&#160;      }</div>
<div class="line"><a name="l13346"></a><span class="lineno">13346</span>&#160; </div>
<div class="line"><a name="l13347"></a><span class="lineno">13347</span>&#160;      <span class="comment">/* Call the general function to carry out the matrix product to compute</span></div>
<div class="line"><a name="l13348"></a><span class="lineno">13348</span>&#160;<span class="comment">         the residual for side 0. Use solIntL as storage for the residual. */</span></div>
<div class="line"><a name="l13349"></a><span class="lineno">13349</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *derBasisElemTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#ac36f91c1dc67c889cbe1c2bea5af504c">GetMatDerBasisElemIntegrationTransposeSide0</a>();</div>
<div class="line"><a name="l13350"></a><span class="lineno">13350</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFsElem0, NPad, nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, derBasisElemTrans, paramFluxes, solIntL, config);</div>
<div class="line"><a name="l13351"></a><span class="lineno">13351</span>&#160; </div>
<div class="line"><a name="l13352"></a><span class="lineno">13352</span>&#160;      <span class="comment">/* Loop over the faces in this chunk to compute the transformed</span></div>
<div class="line"><a name="l13353"></a><span class="lineno">13353</span>&#160;<span class="comment">         symmetrizing fluxes for side 1. */</span></div>
<div class="line"><a name="l13354"></a><span class="lineno">13354</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l13355"></a><span class="lineno">13355</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel = ll - l;</div>
<div class="line"><a name="l13356"></a><span class="lineno">13356</span>&#160;        TransformSymmetrizingFluxes(llRel, nInt, NPad, halfTheta, fluxes, weights,</div>
<div class="line"><a name="l13357"></a><span class="lineno">13357</span>&#160;                                    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">matchingInternalFaces</a>[ll].metricCoorDerivFace1.data(),</div>
<div class="line"><a name="l13358"></a><span class="lineno">13358</span>&#160;                                    paramFluxes);</div>
<div class="line"><a name="l13359"></a><span class="lineno">13359</span>&#160;      }</div>
<div class="line"><a name="l13360"></a><span class="lineno">13360</span>&#160; </div>
<div class="line"><a name="l13361"></a><span class="lineno">13361</span>&#160;      <span class="comment">/* Call the general function to carry out the matrix product to compute</span></div>
<div class="line"><a name="l13362"></a><span class="lineno">13362</span>&#160;<span class="comment">         the residual for side 1. Note that the symmetrizing residual should not</span></div>
<div class="line"><a name="l13363"></a><span class="lineno">13363</span>&#160;<span class="comment">         be negated, because two minus signs enter the formulation for side 1,</span></div>
<div class="line"><a name="l13364"></a><span class="lineno">13364</span>&#160;<span class="comment">         which cancel each other. Use solIntR as storage for the residual. */</span></div>
<div class="line"><a name="l13365"></a><span class="lineno">13365</span>&#160;      derBasisElemTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">standardMatchingFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_internal_face.html#a98b6a45b0891c5df665f0a5bba3033c8">GetMatDerBasisElemIntegrationTransposeSide1</a>();</div>
<div class="line"><a name="l13366"></a><span class="lineno">13366</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFsElem1, NPad, nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, derBasisElemTrans, paramFluxes, solIntR, config);</div>
<div class="line"><a name="l13367"></a><span class="lineno">13367</span>&#160; </div>
<div class="line"><a name="l13368"></a><span class="lineno">13368</span>&#160;      <span class="comment">/* Loop over the number of faces in this chunk. */</span></div>
<div class="line"><a name="l13369"></a><span class="lineno">13369</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l13370"></a><span class="lineno">13370</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l13371"></a><span class="lineno">13371</span>&#160; </div>
<div class="line"><a name="l13372"></a><span class="lineno">13372</span>&#160;        <span class="comment">/* Set the pointer in the residual array where the residual of side 0</span></div>
<div class="line"><a name="l13373"></a><span class="lineno">13373</span>&#160;<span class="comment">           and side 1 of this face must be stored. Update the counter. */</span></div>
<div class="line"><a name="l13374"></a><span class="lineno">13374</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resElem0 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + indResSym*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l13375"></a><span class="lineno">13375</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resElem1 = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">VecResFaces</a>.data() + (indResSym+nDOFsElem0)*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l13376"></a><span class="lineno">13376</span>&#160;        indResSym          += offsetRes;</div>
<div class="line"><a name="l13377"></a><span class="lineno">13377</span>&#160; </div>
<div class="line"><a name="l13378"></a><span class="lineno">13378</span>&#160;        <span class="comment">/* Loop over the DOFs of the element and copy the data for side 0. */</span></div>
<div class="line"><a name="l13379"></a><span class="lineno">13379</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem0; ++i)</div>
<div class="line"><a name="l13380"></a><span class="lineno">13380</span>&#160;          memcpy(resElem0+<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i, solIntL+NPad*i+llNVar, nBytes);</div>
<div class="line"><a name="l13381"></a><span class="lineno">13381</span>&#160; </div>
<div class="line"><a name="l13382"></a><span class="lineno">13382</span>&#160;        <span class="comment">/* Loop over the DOFs of the element and copy the data for side 1. */</span></div>
<div class="line"><a name="l13383"></a><span class="lineno">13383</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem1; ++i)</div>
<div class="line"><a name="l13384"></a><span class="lineno">13384</span>&#160;          memcpy(resElem1+<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i, solIntR+NPad*i+llNVar, nBytes);</div>
<div class="line"><a name="l13385"></a><span class="lineno">13385</span>&#160;      }</div>
<div class="line"><a name="l13386"></a><span class="lineno">13386</span>&#160;    }</div>
<div class="line"><a name="l13387"></a><span class="lineno">13387</span>&#160; </div>
<div class="line"><a name="l13388"></a><span class="lineno">13388</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l13389"></a><span class="lineno">13389</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l13390"></a><span class="lineno">13390</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l13391"></a><span class="lineno">13391</span>&#160;  }</div>
<div class="line"><a name="l13392"></a><span class="lineno">13392</span>&#160;}</div>
<div class="line"><a name="l13393"></a><span class="lineno">13393</span>&#160; </div>
<div class="line"><a name="l13394"></a><span class="lineno">13394</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ViscousNormalFluxFace(<span class="keyword">const</span> <a class="code" href="class_c_volume_element_f_e_m.html">CVolumeElementFEM</a> *adjVolElem,</div>
<div class="line"><a name="l13395"></a><span class="lineno">13395</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>    indFaceChunk,</div>
<div class="line"><a name="l13396"></a><span class="lineno">13396</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>    nInt,</div>
<div class="line"><a name="l13397"></a><span class="lineno">13397</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>    NPad,</div>
<div class="line"><a name="l13398"></a><span class="lineno">13398</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>         Wall_HeatFlux,</div>
<div class="line"><a name="l13399"></a><span class="lineno">13399</span>&#160;                                             <span class="keyword">const</span> <span class="keywordtype">bool</span>              HeatFlux_Prescribed,</div>
<div class="line"><a name="l13400"></a><span class="lineno">13400</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>         *solInt,</div>
<div class="line"><a name="l13401"></a><span class="lineno">13401</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>         *gradSolInt,</div>
<div class="line"><a name="l13402"></a><span class="lineno">13402</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>         *metricCoorDerivFace,</div>
<div class="line"><a name="l13403"></a><span class="lineno">13403</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>         *metricNormalsFace,</div>
<div class="line"><a name="l13404"></a><span class="lineno">13404</span>&#160;                                             <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>         *wallDistanceInt,</div>
<div class="line"><a name="l13405"></a><span class="lineno">13405</span>&#160;                                                   <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>         *viscNormFluxes,</div>
<div class="line"><a name="l13406"></a><span class="lineno">13406</span>&#160;                                                   <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>         *viscosityInt,</div>
<div class="line"><a name="l13407"></a><span class="lineno">13407</span>&#160;                                                   <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>         *kOverCvInt) {</div>
<div class="line"><a name="l13408"></a><span class="lineno">13408</span>&#160; </div>
<div class="line"><a name="l13409"></a><span class="lineno">13409</span>&#160;  <span class="comment">/* Multiplication factor for the heat flux. It is set to zero if the wall heat flux</span></div>
<div class="line"><a name="l13410"></a><span class="lineno">13410</span>&#160;<span class="comment">     is prescribed, such that the computed heat flux is zero, and to one otherwise. */</span></div>
<div class="line"><a name="l13411"></a><span class="lineno">13411</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux = HeatFlux_Prescribed ? <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>(0.0): <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>(1.0);</div>
<div class="line"><a name="l13412"></a><span class="lineno">13412</span>&#160; </div>
<div class="line"><a name="l13413"></a><span class="lineno">13413</span>&#160;  <span class="comment">/* Set the value of the prescribed heat flux for the same reason. */</span></div>
<div class="line"><a name="l13414"></a><span class="lineno">13414</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> HeatFlux = HeatFlux_Prescribed ? Wall_HeatFlux : <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>(0.0);</div>
<div class="line"><a name="l13415"></a><span class="lineno">13415</span>&#160; </div>
<div class="line"><a name="l13416"></a><span class="lineno">13416</span>&#160;  <span class="comment">/* Compute the length scale for the LES of the adjacent element. */</span></div>
<div class="line"><a name="l13417"></a><span class="lineno">13417</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iind  = adjVolElem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l13418"></a><span class="lineno">13418</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>       nPoly = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[iind].<a class="code" href="class_c_f_e_m_standard_element.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l13419"></a><span class="lineno">13419</span>&#160;  <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l13420"></a><span class="lineno">13420</span>&#160; </div>
<div class="line"><a name="l13421"></a><span class="lineno">13421</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale_LES = adjVolElem-&gt;<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l13422"></a><span class="lineno">13422</span>&#160; </div>
<div class="line"><a name="l13423"></a><span class="lineno">13423</span>&#160;  <span class="comment">/* Determine the offset between r- and -s-derivatives, which is also the</span></div>
<div class="line"><a name="l13424"></a><span class="lineno">13424</span>&#160;<span class="comment">     offset between s- and t-derivatives. */</span></div>
<div class="line"><a name="l13425"></a><span class="lineno">13425</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l13426"></a><span class="lineno">13426</span>&#160; </div>
<div class="line"><a name="l13427"></a><span class="lineno">13427</span>&#160;  <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l13428"></a><span class="lineno">13428</span>&#160;<span class="comment">     in order to have the most efficient code. */</span></div>
<div class="line"><a name="l13429"></a><span class="lineno">13429</span>&#160;  <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l13430"></a><span class="lineno">13430</span>&#160; </div>
<div class="line"><a name="l13431"></a><span class="lineno">13431</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l13432"></a><span class="lineno">13432</span>&#160; </div>
<div class="line"><a name="l13433"></a><span class="lineno">13433</span>&#160;      <span class="comment">/* 2D simulation. Loop over the integration points to</span></div>
<div class="line"><a name="l13434"></a><span class="lineno">13434</span>&#160;<span class="comment">         compute the viscous fluxes. */</span></div>
<div class="line"><a name="l13435"></a><span class="lineno">13435</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l13436"></a><span class="lineno">13436</span>&#160; </div>
<div class="line"><a name="l13437"></a><span class="lineno">13437</span>&#160;        <span class="comment">/* Easier storage of the metric terms needed to compute the Cartesian</span></div>
<div class="line"><a name="l13438"></a><span class="lineno">13438</span>&#160;<span class="comment">           gradients in this integration point and the starting locations of</span></div>
<div class="line"><a name="l13439"></a><span class="lineno">13439</span>&#160;<span class="comment">           the solution and the gradients, w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l13440"></a><span class="lineno">13440</span>&#160;<span class="comment">           of this solution. */</span></div>
<div class="line"><a name="l13441"></a><span class="lineno">13441</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l13442"></a><span class="lineno">13442</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = metricCoorDerivFace + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l13443"></a><span class="lineno">13443</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol         = solInt     + offPointer;</div>
<div class="line"><a name="l13444"></a><span class="lineno">13444</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolDr      = gradSolInt + offPointer;</div>
<div class="line"><a name="l13445"></a><span class="lineno">13445</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolDs      = dSolDr     + offDeriv;</div>
<div class="line"><a name="l13446"></a><span class="lineno">13446</span>&#160; </div>
<div class="line"><a name="l13447"></a><span class="lineno">13447</span>&#160;        <span class="comment">/* Easier storage of the metric terms in this integration point. */</span></div>
<div class="line"><a name="l13448"></a><span class="lineno">13448</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l13449"></a><span class="lineno">13449</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l13450"></a><span class="lineno">13450</span>&#160; </div>
<div class="line"><a name="l13451"></a><span class="lineno">13451</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = metricTerms[2];</div>
<div class="line"><a name="l13452"></a><span class="lineno">13452</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = metricTerms[3];</div>
<div class="line"><a name="l13453"></a><span class="lineno">13453</span>&#160; </div>
<div class="line"><a name="l13454"></a><span class="lineno">13454</span>&#160;        <span class="comment">/*--- Compute the Cartesian gradients of the solution. ---*/</span></div>
<div class="line"><a name="l13455"></a><span class="lineno">13455</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> solGradCart[4][2];</div>
<div class="line"><a name="l13456"></a><span class="lineno">13456</span>&#160; </div>
<div class="line"><a name="l13457"></a><span class="lineno">13457</span>&#160;        solGradCart[0][0] = dSolDr[0]*drdx + dSolDs[0]*dsdx;</div>
<div class="line"><a name="l13458"></a><span class="lineno">13458</span>&#160;        solGradCart[1][0] = dSolDr[1]*drdx + dSolDs[1]*dsdx;</div>
<div class="line"><a name="l13459"></a><span class="lineno">13459</span>&#160;        solGradCart[2][0] = dSolDr[2]*drdx + dSolDs[2]*dsdx;</div>
<div class="line"><a name="l13460"></a><span class="lineno">13460</span>&#160;        solGradCart[3][0] = dSolDr[3]*drdx + dSolDs[3]*dsdx;</div>
<div class="line"><a name="l13461"></a><span class="lineno">13461</span>&#160; </div>
<div class="line"><a name="l13462"></a><span class="lineno">13462</span>&#160;        solGradCart[0][1] = dSolDr[0]*drdy + dSolDs[0]*dsdy;</div>
<div class="line"><a name="l13463"></a><span class="lineno">13463</span>&#160;        solGradCart[1][1] = dSolDr[1]*drdy + dSolDs[1]*dsdy;</div>
<div class="line"><a name="l13464"></a><span class="lineno">13464</span>&#160;        solGradCart[2][1] = dSolDr[2]*drdy + dSolDs[2]*dsdy;</div>
<div class="line"><a name="l13465"></a><span class="lineno">13465</span>&#160;        solGradCart[3][1] = dSolDr[3]*drdy + dSolDs[3]*dsdy;</div>
<div class="line"><a name="l13466"></a><span class="lineno">13466</span>&#160; </div>
<div class="line"><a name="l13467"></a><span class="lineno">13467</span>&#160;        <span class="comment">/*--- Call the function ViscousNormalFluxIntegrationPoint to compute the</span></div>
<div class="line"><a name="l13468"></a><span class="lineno">13468</span>&#160;<span class="comment">              actual normal viscous flux. The viscosity and thermal conductivity</span></div>
<div class="line"><a name="l13469"></a><span class="lineno">13469</span>&#160;<span class="comment">              are stored for later use. ---*/</span></div>
<div class="line"><a name="l13470"></a><span class="lineno">13470</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normal  = metricNormalsFace + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l13471"></a><span class="lineno">13471</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normalFlux    = viscNormFluxes + offPointer;</div>
<div class="line"><a name="l13472"></a><span class="lineno">13472</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wallDist = wallDistanceInt ? wallDistanceInt[i] : 0.0;</div>
<div class="line"><a name="l13473"></a><span class="lineno">13473</span>&#160; </div>
<div class="line"><a name="l13474"></a><span class="lineno">13474</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Viscosity, kOverCv;</div>
<div class="line"><a name="l13475"></a><span class="lineno">13475</span>&#160; </div>
<div class="line"><a name="l13476"></a><span class="lineno">13476</span>&#160;        ViscousNormalFluxIntegrationPoint_2D(sol, solGradCart, normal, HeatFlux,</div>
<div class="line"><a name="l13477"></a><span class="lineno">13477</span>&#160;                                             factHeatFlux, wallDist, lenScale_LES,</div>
<div class="line"><a name="l13478"></a><span class="lineno">13478</span>&#160;                                             Viscosity, kOverCv, normalFlux);</div>
<div class="line"><a name="l13479"></a><span class="lineno">13479</span>&#160; </div>
<div class="line"><a name="l13480"></a><span class="lineno">13480</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l13481"></a><span class="lineno">13481</span>&#160;        viscosityInt[ind] = Viscosity;</div>
<div class="line"><a name="l13482"></a><span class="lineno">13482</span>&#160;        kOverCvInt[ind]   = kOverCv;</div>
<div class="line"><a name="l13483"></a><span class="lineno">13483</span>&#160;      }</div>
<div class="line"><a name="l13484"></a><span class="lineno">13484</span>&#160; </div>
<div class="line"><a name="l13485"></a><span class="lineno">13485</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13486"></a><span class="lineno">13486</span>&#160;    }</div>
<div class="line"><a name="l13487"></a><span class="lineno">13487</span>&#160; </div>
<div class="line"><a name="l13488"></a><span class="lineno">13488</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13489"></a><span class="lineno">13489</span>&#160; </div>
<div class="line"><a name="l13490"></a><span class="lineno">13490</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l13491"></a><span class="lineno">13491</span>&#160; </div>
<div class="line"><a name="l13492"></a><span class="lineno">13492</span>&#160;      <span class="comment">/* 3D simulation. Loop over the integration points to</span></div>
<div class="line"><a name="l13493"></a><span class="lineno">13493</span>&#160;<span class="comment">         compute the viscous fluxes. */</span></div>
<div class="line"><a name="l13494"></a><span class="lineno">13494</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l13495"></a><span class="lineno">13495</span>&#160; </div>
<div class="line"><a name="l13496"></a><span class="lineno">13496</span>&#160;        <span class="comment">/* Easier storage of the metric terms needed to compute the Cartesian</span></div>
<div class="line"><a name="l13497"></a><span class="lineno">13497</span>&#160;<span class="comment">           gradients in this integration point and the starting locations of</span></div>
<div class="line"><a name="l13498"></a><span class="lineno">13498</span>&#160;<span class="comment">           the solution and the gradients, w.r.t. the parametric coordinates</span></div>
<div class="line"><a name="l13499"></a><span class="lineno">13499</span>&#160;<span class="comment">           of this solution. */</span></div>
<div class="line"><a name="l13500"></a><span class="lineno">13500</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l13501"></a><span class="lineno">13501</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = metricCoorDerivFace + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l13502"></a><span class="lineno">13502</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol         = solInt     + offPointer;</div>
<div class="line"><a name="l13503"></a><span class="lineno">13503</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolDr      = gradSolInt + offPointer;</div>
<div class="line"><a name="l13504"></a><span class="lineno">13504</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolDs      = dSolDr     + offDeriv;</div>
<div class="line"><a name="l13505"></a><span class="lineno">13505</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dSolDt      = dSolDs     + offDeriv;</div>
<div class="line"><a name="l13506"></a><span class="lineno">13506</span>&#160; </div>
<div class="line"><a name="l13507"></a><span class="lineno">13507</span>&#160;        <span class="comment">/* Easier storage of the metric terms in this integration point. */</span></div>
<div class="line"><a name="l13508"></a><span class="lineno">13508</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l13509"></a><span class="lineno">13509</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l13510"></a><span class="lineno">13510</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdz = metricTerms[2];</div>
<div class="line"><a name="l13511"></a><span class="lineno">13511</span>&#160; </div>
<div class="line"><a name="l13512"></a><span class="lineno">13512</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = metricTerms[3];</div>
<div class="line"><a name="l13513"></a><span class="lineno">13513</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = metricTerms[4];</div>
<div class="line"><a name="l13514"></a><span class="lineno">13514</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdz = metricTerms[5];</div>
<div class="line"><a name="l13515"></a><span class="lineno">13515</span>&#160; </div>
<div class="line"><a name="l13516"></a><span class="lineno">13516</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdx = metricTerms[6];</div>
<div class="line"><a name="l13517"></a><span class="lineno">13517</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdy = metricTerms[7];</div>
<div class="line"><a name="l13518"></a><span class="lineno">13518</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdz = metricTerms[8];</div>
<div class="line"><a name="l13519"></a><span class="lineno">13519</span>&#160; </div>
<div class="line"><a name="l13520"></a><span class="lineno">13520</span>&#160;        <span class="comment">/*--- Compute the Cartesian gradients of the solution. ---*/</span></div>
<div class="line"><a name="l13521"></a><span class="lineno">13521</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> solGradCart[5][3];</div>
<div class="line"><a name="l13522"></a><span class="lineno">13522</span>&#160; </div>
<div class="line"><a name="l13523"></a><span class="lineno">13523</span>&#160;        solGradCart[0][0] = dSolDr[0]*drdx + dSolDs[0]*dsdx + dSolDt[0]*dtdx;</div>
<div class="line"><a name="l13524"></a><span class="lineno">13524</span>&#160;        solGradCart[1][0] = dSolDr[1]*drdx + dSolDs[1]*dsdx + dSolDt[1]*dtdx;</div>
<div class="line"><a name="l13525"></a><span class="lineno">13525</span>&#160;        solGradCart[2][0] = dSolDr[2]*drdx + dSolDs[2]*dsdx + dSolDt[2]*dtdx;</div>
<div class="line"><a name="l13526"></a><span class="lineno">13526</span>&#160;        solGradCart[3][0] = dSolDr[3]*drdx + dSolDs[3]*dsdx + dSolDt[3]*dtdx;</div>
<div class="line"><a name="l13527"></a><span class="lineno">13527</span>&#160;        solGradCart[4][0] = dSolDr[4]*drdx + dSolDs[4]*dsdx + dSolDt[4]*dtdx;</div>
<div class="line"><a name="l13528"></a><span class="lineno">13528</span>&#160; </div>
<div class="line"><a name="l13529"></a><span class="lineno">13529</span>&#160;        solGradCart[0][1] = dSolDr[0]*drdy + dSolDs[0]*dsdy + dSolDt[0]*dtdy;</div>
<div class="line"><a name="l13530"></a><span class="lineno">13530</span>&#160;        solGradCart[1][1] = dSolDr[1]*drdy + dSolDs[1]*dsdy + dSolDt[1]*dtdy;</div>
<div class="line"><a name="l13531"></a><span class="lineno">13531</span>&#160;        solGradCart[2][1] = dSolDr[2]*drdy + dSolDs[2]*dsdy + dSolDt[2]*dtdy;</div>
<div class="line"><a name="l13532"></a><span class="lineno">13532</span>&#160;        solGradCart[3][1] = dSolDr[3]*drdy + dSolDs[3]*dsdy + dSolDt[3]*dtdy;</div>
<div class="line"><a name="l13533"></a><span class="lineno">13533</span>&#160;        solGradCart[4][1] = dSolDr[4]*drdy + dSolDs[4]*dsdy + dSolDt[4]*dtdy;</div>
<div class="line"><a name="l13534"></a><span class="lineno">13534</span>&#160; </div>
<div class="line"><a name="l13535"></a><span class="lineno">13535</span>&#160;        solGradCart[0][2] = dSolDr[0]*drdz + dSolDs[0]*dsdz + dSolDt[0]*dtdz;</div>
<div class="line"><a name="l13536"></a><span class="lineno">13536</span>&#160;        solGradCart[1][2] = dSolDr[1]*drdz + dSolDs[1]*dsdz + dSolDt[1]*dtdz;</div>
<div class="line"><a name="l13537"></a><span class="lineno">13537</span>&#160;        solGradCart[2][2] = dSolDr[2]*drdz + dSolDs[2]*dsdz + dSolDt[2]*dtdz;</div>
<div class="line"><a name="l13538"></a><span class="lineno">13538</span>&#160;        solGradCart[3][2] = dSolDr[3]*drdz + dSolDs[3]*dsdz + dSolDt[3]*dtdz;</div>
<div class="line"><a name="l13539"></a><span class="lineno">13539</span>&#160;        solGradCart[4][2] = dSolDr[4]*drdz + dSolDs[4]*dsdz + dSolDt[4]*dtdz;</div>
<div class="line"><a name="l13540"></a><span class="lineno">13540</span>&#160; </div>
<div class="line"><a name="l13541"></a><span class="lineno">13541</span>&#160;        <span class="comment">/*--- Call the function ViscousNormalFluxIntegrationPoint to compute the</span></div>
<div class="line"><a name="l13542"></a><span class="lineno">13542</span>&#160;<span class="comment">              actual normal viscous flux. The viscosity and thermal conductivity</span></div>
<div class="line"><a name="l13543"></a><span class="lineno">13543</span>&#160;<span class="comment">              are stored for later use. ---*/</span></div>
<div class="line"><a name="l13544"></a><span class="lineno">13544</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normal  = metricNormalsFace + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l13545"></a><span class="lineno">13545</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normalFlux    = viscNormFluxes + offPointer;</div>
<div class="line"><a name="l13546"></a><span class="lineno">13546</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wallDist = wallDistanceInt ? wallDistanceInt[i] : 0.0;</div>
<div class="line"><a name="l13547"></a><span class="lineno">13547</span>&#160; </div>
<div class="line"><a name="l13548"></a><span class="lineno">13548</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Viscosity, kOverCv;</div>
<div class="line"><a name="l13549"></a><span class="lineno">13549</span>&#160; </div>
<div class="line"><a name="l13550"></a><span class="lineno">13550</span>&#160;        ViscousNormalFluxIntegrationPoint_3D(sol, solGradCart, normal, HeatFlux,</div>
<div class="line"><a name="l13551"></a><span class="lineno">13551</span>&#160;                                             factHeatFlux, wallDist, lenScale_LES,</div>
<div class="line"><a name="l13552"></a><span class="lineno">13552</span>&#160;                                             Viscosity, kOverCv, normalFlux);</div>
<div class="line"><a name="l13553"></a><span class="lineno">13553</span>&#160; </div>
<div class="line"><a name="l13554"></a><span class="lineno">13554</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l13555"></a><span class="lineno">13555</span>&#160;        viscosityInt[ind] = Viscosity;</div>
<div class="line"><a name="l13556"></a><span class="lineno">13556</span>&#160;        kOverCvInt[ind]   = kOverCv;</div>
<div class="line"><a name="l13557"></a><span class="lineno">13557</span>&#160;      }</div>
<div class="line"><a name="l13558"></a><span class="lineno">13558</span>&#160; </div>
<div class="line"><a name="l13559"></a><span class="lineno">13559</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13560"></a><span class="lineno">13560</span>&#160;    }</div>
<div class="line"><a name="l13561"></a><span class="lineno">13561</span>&#160;  }</div>
<div class="line"><a name="l13562"></a><span class="lineno">13562</span>&#160;}</div>
<div class="line"><a name="l13563"></a><span class="lineno">13563</span>&#160; </div>
<div class="line"><a name="l13564"></a><span class="lineno">13564</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ViscousNormalFluxIntegrationPoint_2D(<span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol,</div>
<div class="line"><a name="l13565"></a><span class="lineno">13565</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> solGradCart[4][2],</div>
<div class="line"><a name="l13566"></a><span class="lineno">13566</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normal,</div>
<div class="line"><a name="l13567"></a><span class="lineno">13567</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> HeatFlux,</div>
<div class="line"><a name="l13568"></a><span class="lineno">13568</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux,</div>
<div class="line"><a name="l13569"></a><span class="lineno">13569</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wallDist,</div>
<div class="line"><a name="l13570"></a><span class="lineno">13570</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale_LES,</div>
<div class="line"><a name="l13571"></a><span class="lineno">13571</span>&#160;                                                                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> &amp;Viscosity,</div>
<div class="line"><a name="l13572"></a><span class="lineno">13572</span>&#160;                                                                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> &amp;kOverCv,</div>
<div class="line"><a name="l13573"></a><span class="lineno">13573</span>&#160;                                                                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normalFlux) {</div>
<div class="line"><a name="l13574"></a><span class="lineno">13574</span>&#160; </div>
<div class="line"><a name="l13575"></a><span class="lineno">13575</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector, namely the ratio of</span></div>
<div class="line"><a name="l13576"></a><span class="lineno">13576</span>&#160;<span class="comment">     thermal conductivity and viscosity. */</span></div>
<div class="line"><a name="l13577"></a><span class="lineno">13577</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Lam  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l13578"></a><span class="lineno">13578</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Turb = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l13579"></a><span class="lineno">13579</span>&#160; </div>
<div class="line"><a name="l13580"></a><span class="lineno">13580</span>&#160;  <span class="comment">/*--- Compute the velocities and static energy in this integration point. ---*/</span></div>
<div class="line"><a name="l13581"></a><span class="lineno">13581</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv = 1.0/sol[0];</div>
<div class="line"><a name="l13582"></a><span class="lineno">13582</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u = rhoInv*sol[1];</div>
<div class="line"><a name="l13583"></a><span class="lineno">13583</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v = rhoInv*sol[2];</div>
<div class="line"><a name="l13584"></a><span class="lineno">13584</span>&#160; </div>
<div class="line"><a name="l13585"></a><span class="lineno">13585</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = rhoInv*sol[3];</div>
<div class="line"><a name="l13586"></a><span class="lineno">13586</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - 0.5*(u*u + v*v);</div>
<div class="line"><a name="l13587"></a><span class="lineno">13587</span>&#160; </div>
<div class="line"><a name="l13588"></a><span class="lineno">13588</span>&#160;  <span class="comment">/*--- Compute the Cartesian gradients of the velocities and static energy</span></div>
<div class="line"><a name="l13589"></a><span class="lineno">13589</span>&#160;<span class="comment">        in this integration point and also the divergence of the velocity. ---*/</span></div>
<div class="line"><a name="l13590"></a><span class="lineno">13590</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = rhoInv*(solGradCart[1][0] - u*solGradCart[0][0]);</div>
<div class="line"><a name="l13591"></a><span class="lineno">13591</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = rhoInv*(solGradCart[1][1] - u*solGradCart[0][1]);</div>
<div class="line"><a name="l13592"></a><span class="lineno">13592</span>&#160; </div>
<div class="line"><a name="l13593"></a><span class="lineno">13593</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = rhoInv*(solGradCart[2][0] - v*solGradCart[0][0]);</div>
<div class="line"><a name="l13594"></a><span class="lineno">13594</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = rhoInv*(solGradCart[2][1] - v*solGradCart[0][1]);</div>
<div class="line"><a name="l13595"></a><span class="lineno">13595</span>&#160; </div>
<div class="line"><a name="l13596"></a><span class="lineno">13596</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergyDx = rhoInv*(solGradCart[3][0]</div>
<div class="line"><a name="l13597"></a><span class="lineno">13597</span>&#160;                                  -         TotalEnergy*solGradCart[0][0])</div>
<div class="line"><a name="l13598"></a><span class="lineno">13598</span>&#160;                                  - u*dudx - v*dvdx;</div>
<div class="line"><a name="l13599"></a><span class="lineno">13599</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergyDy = rhoInv*(solGradCart[3][1]</div>
<div class="line"><a name="l13600"></a><span class="lineno">13600</span>&#160;                                  -         TotalEnergy*solGradCart[0][1])</div>
<div class="line"><a name="l13601"></a><span class="lineno">13601</span>&#160;                                  - u*dudy - v*dvdy;</div>
<div class="line"><a name="l13602"></a><span class="lineno">13602</span>&#160; </div>
<div class="line"><a name="l13603"></a><span class="lineno">13603</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> divVel = dudx + dvdy;</div>
<div class="line"><a name="l13604"></a><span class="lineno">13604</span>&#160; </div>
<div class="line"><a name="l13605"></a><span class="lineno">13605</span>&#160;  <span class="comment">/*--- Compute the laminar viscosity. ---*/</span></div>
<div class="line"><a name="l13606"></a><span class="lineno">13606</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l13607"></a><span class="lineno">13607</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l13608"></a><span class="lineno">13608</span>&#160; </div>
<div class="line"><a name="l13609"></a><span class="lineno">13609</span>&#160;  <span class="comment">/*--- Compute the eddy viscosity, if needed. ---*/</span></div>
<div class="line"><a name="l13610"></a><span class="lineno">13610</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l13611"></a><span class="lineno">13611</span>&#160;  <span class="keywordflow">if</span>( SGSModelUsed )</div>
<div class="line"><a name="l13612"></a><span class="lineno">13612</span>&#160;    ViscosityTurb = SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#aebef9146565169091059c7b1a0fb926d">ComputeEddyViscosity_2D</a>(sol[0], dudx, dudy, dvdx,</div>
<div class="line"><a name="l13613"></a><span class="lineno">13613</span>&#160;                                                      dvdy, lenScale_LES, wallDist);</div>
<div class="line"><a name="l13614"></a><span class="lineno">13614</span>&#160; </div>
<div class="line"><a name="l13615"></a><span class="lineno">13615</span>&#160;  <span class="comment">/* Compute the total viscosity and heat conductivity. Note that the heat</span></div>
<div class="line"><a name="l13616"></a><span class="lineno">13616</span>&#160;<span class="comment">     conductivity is divided by the Cv, because gradients of internal energy</span></div>
<div class="line"><a name="l13617"></a><span class="lineno">13617</span>&#160;<span class="comment">     are computed and not temperature. */</span></div>
<div class="line"><a name="l13618"></a><span class="lineno">13618</span>&#160;  Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l13619"></a><span class="lineno">13619</span>&#160;  kOverCv   = ViscosityLam*factHeatFlux_Lam + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l13620"></a><span class="lineno">13620</span>&#160; </div>
<div class="line"><a name="l13621"></a><span class="lineno">13621</span>&#160;  <span class="comment">/*--- Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l13622"></a><span class="lineno">13622</span>&#160;<span class="comment">        term in the viscous normal stresses. ---*/</span></div>
<div class="line"><a name="l13623"></a><span class="lineno">13623</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l13624"></a><span class="lineno">13624</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l13625"></a><span class="lineno">13625</span>&#160; </div>
<div class="line"><a name="l13626"></a><span class="lineno">13626</span>&#160;  <span class="comment">/*--- Compute the viscous stress tensor and minus the heatflux vector.</span></div>
<div class="line"><a name="l13627"></a><span class="lineno">13627</span>&#160;<span class="comment">        The heat flux vector is multiplied by factHeatFlux, such that the</span></div>
<div class="line"><a name="l13628"></a><span class="lineno">13628</span>&#160;<span class="comment">        case of a prescribed heat flux is treated correctly. ---*/</span></div>
<div class="line"><a name="l13629"></a><span class="lineno">13629</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l13630"></a><span class="lineno">13630</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l13631"></a><span class="lineno">13631</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l13632"></a><span class="lineno">13632</span>&#160; </div>
<div class="line"><a name="l13633"></a><span class="lineno">13633</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qx = factHeatFlux*kOverCv*dStaticEnergyDx;</div>
<div class="line"><a name="l13634"></a><span class="lineno">13634</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qy = factHeatFlux*kOverCv*dStaticEnergyDy;</div>
<div class="line"><a name="l13635"></a><span class="lineno">13635</span>&#160; </div>
<div class="line"><a name="l13636"></a><span class="lineno">13636</span>&#160;  <span class="comment">/* Compute the unscaled normal vector. */</span></div>
<div class="line"><a name="l13637"></a><span class="lineno">13637</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nx = normal[0]*normal[2];</div>
<div class="line"><a name="l13638"></a><span class="lineno">13638</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ny = normal[1]*normal[2];</div>
<div class="line"><a name="l13639"></a><span class="lineno">13639</span>&#160; </div>
<div class="line"><a name="l13640"></a><span class="lineno">13640</span>&#160;  <span class="comment">/*--- Compute the viscous normal flux. Note that the energy flux get a</span></div>
<div class="line"><a name="l13641"></a><span class="lineno">13641</span>&#160;<span class="comment">        contribution from both the prescribed and the computed heat flux.</span></div>
<div class="line"><a name="l13642"></a><span class="lineno">13642</span>&#160;<span class="comment">        At least one of these terms is zero. ---*/</span></div>
<div class="line"><a name="l13643"></a><span class="lineno">13643</span>&#160;  normalFlux[0] = 0.0;</div>
<div class="line"><a name="l13644"></a><span class="lineno">13644</span>&#160;  normalFlux[1] = tauxx*nx + tauxy*ny;</div>
<div class="line"><a name="l13645"></a><span class="lineno">13645</span>&#160;  normalFlux[2] = tauxy*nx + tauyy*ny;</div>
<div class="line"><a name="l13646"></a><span class="lineno">13646</span>&#160;  normalFlux[3] = normal[2]*HeatFlux</div>
<div class="line"><a name="l13647"></a><span class="lineno">13647</span>&#160;                + (u*tauxx + v*tauxy + qx)*nx + (u*tauxy + v*tauyy + qy)*ny;</div>
<div class="line"><a name="l13648"></a><span class="lineno">13648</span>&#160;}</div>
<div class="line"><a name="l13649"></a><span class="lineno">13649</span>&#160; </div>
<div class="line"><a name="l13650"></a><span class="lineno">13650</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ViscousNormalFluxIntegrationPoint_3D(<span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol,</div>
<div class="line"><a name="l13651"></a><span class="lineno">13651</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> solGradCart[5][3],</div>
<div class="line"><a name="l13652"></a><span class="lineno">13652</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normal,</div>
<div class="line"><a name="l13653"></a><span class="lineno">13653</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> HeatFlux,</div>
<div class="line"><a name="l13654"></a><span class="lineno">13654</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux,</div>
<div class="line"><a name="l13655"></a><span class="lineno">13655</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wallDist,</div>
<div class="line"><a name="l13656"></a><span class="lineno">13656</span>&#160;                                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale_LES,</div>
<div class="line"><a name="l13657"></a><span class="lineno">13657</span>&#160;                                                                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> &amp;Viscosity,</div>
<div class="line"><a name="l13658"></a><span class="lineno">13658</span>&#160;                                                                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> &amp;kOverCv,</div>
<div class="line"><a name="l13659"></a><span class="lineno">13659</span>&#160;                                                                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normalFlux) {</div>
<div class="line"><a name="l13660"></a><span class="lineno">13660</span>&#160; </div>
<div class="line"><a name="l13661"></a><span class="lineno">13661</span>&#160;  <span class="comment">/* Constant factor present in the heat flux vector, namely the ratio of</span></div>
<div class="line"><a name="l13662"></a><span class="lineno">13662</span>&#160;<span class="comment">     thermal conductivity and viscosity. */</span></div>
<div class="line"><a name="l13663"></a><span class="lineno">13663</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Lam  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Lam;</div>
<div class="line"><a name="l13664"></a><span class="lineno">13664</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux_Turb = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>/Prandtl_Turb;</div>
<div class="line"><a name="l13665"></a><span class="lineno">13665</span>&#160; </div>
<div class="line"><a name="l13666"></a><span class="lineno">13666</span>&#160;  <span class="comment">/*--- Compute the velocities and static energy in this integration point. ---*/</span></div>
<div class="line"><a name="l13667"></a><span class="lineno">13667</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv = 1.0/sol[0];</div>
<div class="line"><a name="l13668"></a><span class="lineno">13668</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> u = rhoInv*sol[1];</div>
<div class="line"><a name="l13669"></a><span class="lineno">13669</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> v = rhoInv*sol[2];</div>
<div class="line"><a name="l13670"></a><span class="lineno">13670</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> w = rhoInv*sol[3];</div>
<div class="line"><a name="l13671"></a><span class="lineno">13671</span>&#160; </div>
<div class="line"><a name="l13672"></a><span class="lineno">13672</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TotalEnergy  = rhoInv*sol[4];</div>
<div class="line"><a name="l13673"></a><span class="lineno">13673</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = TotalEnergy - 0.5*(u*u + v*v + w*w);</div>
<div class="line"><a name="l13674"></a><span class="lineno">13674</span>&#160; </div>
<div class="line"><a name="l13675"></a><span class="lineno">13675</span>&#160;  <span class="comment">/*--- Compute the Cartesian gradients of the velocities and static energy</span></div>
<div class="line"><a name="l13676"></a><span class="lineno">13676</span>&#160;<span class="comment">        in this integration point and also the divergence of the velocity. ---*/</span></div>
<div class="line"><a name="l13677"></a><span class="lineno">13677</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudx = rhoInv*(solGradCart[1][0] - u*solGradCart[0][0]);</div>
<div class="line"><a name="l13678"></a><span class="lineno">13678</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudy = rhoInv*(solGradCart[1][1] - u*solGradCart[0][1]);</div>
<div class="line"><a name="l13679"></a><span class="lineno">13679</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dudz = rhoInv*(solGradCart[1][2] - u*solGradCart[0][2]);</div>
<div class="line"><a name="l13680"></a><span class="lineno">13680</span>&#160; </div>
<div class="line"><a name="l13681"></a><span class="lineno">13681</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdx = rhoInv*(solGradCart[2][0] - v*solGradCart[0][0]);</div>
<div class="line"><a name="l13682"></a><span class="lineno">13682</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdy = rhoInv*(solGradCart[2][1] - v*solGradCart[0][1]);</div>
<div class="line"><a name="l13683"></a><span class="lineno">13683</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dvdz = rhoInv*(solGradCart[2][2] - v*solGradCart[0][2]);</div>
<div class="line"><a name="l13684"></a><span class="lineno">13684</span>&#160; </div>
<div class="line"><a name="l13685"></a><span class="lineno">13685</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdx = rhoInv*(solGradCart[3][0] - w*solGradCart[0][0]);</div>
<div class="line"><a name="l13686"></a><span class="lineno">13686</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdy = rhoInv*(solGradCart[3][1] - w*solGradCart[0][1]);</div>
<div class="line"><a name="l13687"></a><span class="lineno">13687</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dwdz = rhoInv*(solGradCart[3][2] - w*solGradCart[0][2]);</div>
<div class="line"><a name="l13688"></a><span class="lineno">13688</span>&#160; </div>
<div class="line"><a name="l13689"></a><span class="lineno">13689</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergyDx = rhoInv*(solGradCart[4][0]</div>
<div class="line"><a name="l13690"></a><span class="lineno">13690</span>&#160;                                  -         TotalEnergy*solGradCart[0][0])</div>
<div class="line"><a name="l13691"></a><span class="lineno">13691</span>&#160;                                  - u*dudx - v*dvdx - w*dwdx;</div>
<div class="line"><a name="l13692"></a><span class="lineno">13692</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergyDy = rhoInv*(solGradCart[4][1]</div>
<div class="line"><a name="l13693"></a><span class="lineno">13693</span>&#160;                                  -         TotalEnergy*solGradCart[0][1])</div>
<div class="line"><a name="l13694"></a><span class="lineno">13694</span>&#160;                                  - u*dudy - v*dvdy - w*dwdy;</div>
<div class="line"><a name="l13695"></a><span class="lineno">13695</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dStaticEnergyDz = rhoInv*(solGradCart[4][2]</div>
<div class="line"><a name="l13696"></a><span class="lineno">13696</span>&#160;                                  -         TotalEnergy*solGradCart[0][2])</div>
<div class="line"><a name="l13697"></a><span class="lineno">13697</span>&#160;                                  - u*dudz - v*dvdz - w*dwdz;</div>
<div class="line"><a name="l13698"></a><span class="lineno">13698</span>&#160; </div>
<div class="line"><a name="l13699"></a><span class="lineno">13699</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> divVel = dudx + dvdy + dwdz;</div>
<div class="line"><a name="l13700"></a><span class="lineno">13700</span>&#160; </div>
<div class="line"><a name="l13701"></a><span class="lineno">13701</span>&#160;  <span class="comment">/*--- Compute the laminar viscosity. ---*/</span></div>
<div class="line"><a name="l13702"></a><span class="lineno">13702</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(sol[0], StaticEnergy);</div>
<div class="line"><a name="l13703"></a><span class="lineno">13703</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityLam = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l13704"></a><span class="lineno">13704</span>&#160; </div>
<div class="line"><a name="l13705"></a><span class="lineno">13705</span>&#160;  <span class="comment">/*--- Compute the eddy viscosity, if needed. ---*/</span></div>
<div class="line"><a name="l13706"></a><span class="lineno">13706</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ViscosityTurb = 0.0;</div>
<div class="line"><a name="l13707"></a><span class="lineno">13707</span>&#160;  <span class="keywordflow">if</span>( SGSModelUsed )</div>
<div class="line"><a name="l13708"></a><span class="lineno">13708</span>&#160;    ViscosityTurb = SGSModel-&gt;<a class="code" href="class_c_s_g_s_model.html#a6017e86477c7d39b542d82a3b2b9f1cd">ComputeEddyViscosity_3D</a>(sol[0], dudx, dudy, dudz,</div>
<div class="line"><a name="l13709"></a><span class="lineno">13709</span>&#160;                                                      dvdx, dvdy, dvdz, dwdx,</div>
<div class="line"><a name="l13710"></a><span class="lineno">13710</span>&#160;                                                      dwdy, dwdz, lenScale_LES,</div>
<div class="line"><a name="l13711"></a><span class="lineno">13711</span>&#160;                                                      wallDist);</div>
<div class="line"><a name="l13712"></a><span class="lineno">13712</span>&#160; </div>
<div class="line"><a name="l13713"></a><span class="lineno">13713</span>&#160;  <span class="comment">/* Compute the total viscosity and heat conductivity. Note that the heat</span></div>
<div class="line"><a name="l13714"></a><span class="lineno">13714</span>&#160;<span class="comment">     conductivity is divided by the Cv, because gradients of internal energy</span></div>
<div class="line"><a name="l13715"></a><span class="lineno">13715</span>&#160;<span class="comment">     are computed and not temperature. */</span></div>
<div class="line"><a name="l13716"></a><span class="lineno">13716</span>&#160;  Viscosity = ViscosityLam + ViscosityTurb;</div>
<div class="line"><a name="l13717"></a><span class="lineno">13717</span>&#160;  kOverCv   = ViscosityLam*factHeatFlux_Lam + ViscosityTurb*factHeatFlux_Turb;</div>
<div class="line"><a name="l13718"></a><span class="lineno">13718</span>&#160; </div>
<div class="line"><a name="l13719"></a><span class="lineno">13719</span>&#160;  <span class="comment">/*--- Set the value of the second viscosity and compute the divergence</span></div>
<div class="line"><a name="l13720"></a><span class="lineno">13720</span>&#160;<span class="comment">        term in the viscous normal stresses. ---*/</span></div>
<div class="line"><a name="l13721"></a><span class="lineno">13721</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambda     = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>*Viscosity;</div>
<div class="line"><a name="l13722"></a><span class="lineno">13722</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lamDivTerm =  lambda*divVel;</div>
<div class="line"><a name="l13723"></a><span class="lineno">13723</span>&#160; </div>
<div class="line"><a name="l13724"></a><span class="lineno">13724</span>&#160;  <span class="comment">/*--- Compute the viscous stress tensor and minus the heatflux vector.</span></div>
<div class="line"><a name="l13725"></a><span class="lineno">13725</span>&#160;<span class="comment">        The heat flux vector is multiplied by factHeatFlux, such that the</span></div>
<div class="line"><a name="l13726"></a><span class="lineno">13726</span>&#160;<span class="comment">        case of a prescribed heat flux is treated correctly. ---*/</span></div>
<div class="line"><a name="l13727"></a><span class="lineno">13727</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxx = 2.0*Viscosity*dudx + lamDivTerm;</div>
<div class="line"><a name="l13728"></a><span class="lineno">13728</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyy = 2.0*Viscosity*dvdy + lamDivTerm;</div>
<div class="line"><a name="l13729"></a><span class="lineno">13729</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauzz = 2.0*Viscosity*dwdz + lamDivTerm;</div>
<div class="line"><a name="l13730"></a><span class="lineno">13730</span>&#160; </div>
<div class="line"><a name="l13731"></a><span class="lineno">13731</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxy = Viscosity*(dudy + dvdx);</div>
<div class="line"><a name="l13732"></a><span class="lineno">13732</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauxz = Viscosity*(dudz + dwdx);</div>
<div class="line"><a name="l13733"></a><span class="lineno">13733</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauyz = Viscosity*(dvdz + dwdy);</div>
<div class="line"><a name="l13734"></a><span class="lineno">13734</span>&#160; </div>
<div class="line"><a name="l13735"></a><span class="lineno">13735</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qx = factHeatFlux*kOverCv*dStaticEnergyDx;</div>
<div class="line"><a name="l13736"></a><span class="lineno">13736</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qy = factHeatFlux*kOverCv*dStaticEnergyDy;</div>
<div class="line"><a name="l13737"></a><span class="lineno">13737</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> qz = factHeatFlux*kOverCv*dStaticEnergyDz;</div>
<div class="line"><a name="l13738"></a><span class="lineno">13738</span>&#160; </div>
<div class="line"><a name="l13739"></a><span class="lineno">13739</span>&#160;  <span class="comment">/* Compute the unscaled normal vector. */</span></div>
<div class="line"><a name="l13740"></a><span class="lineno">13740</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nx = normal[0]*normal[3];</div>
<div class="line"><a name="l13741"></a><span class="lineno">13741</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ny = normal[1]*normal[3];</div>
<div class="line"><a name="l13742"></a><span class="lineno">13742</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nz = normal[2]*normal[3];</div>
<div class="line"><a name="l13743"></a><span class="lineno">13743</span>&#160; </div>
<div class="line"><a name="l13744"></a><span class="lineno">13744</span>&#160;  <span class="comment">/*--- Compute the viscous normal flux. Note that the energy flux get a</span></div>
<div class="line"><a name="l13745"></a><span class="lineno">13745</span>&#160;<span class="comment">        contribution from both the prescribed and the computed heat flux.</span></div>
<div class="line"><a name="l13746"></a><span class="lineno">13746</span>&#160;<span class="comment">        At least one of these terms is zero. ---*/</span></div>
<div class="line"><a name="l13747"></a><span class="lineno">13747</span>&#160;  normalFlux[0] = 0.0;</div>
<div class="line"><a name="l13748"></a><span class="lineno">13748</span>&#160;  normalFlux[1] = tauxx*nx + tauxy*ny + tauxz*nz;</div>
<div class="line"><a name="l13749"></a><span class="lineno">13749</span>&#160;  normalFlux[2] = tauxy*nx + tauyy*ny + tauyz*nz;</div>
<div class="line"><a name="l13750"></a><span class="lineno">13750</span>&#160;  normalFlux[3] = tauxz*nx + tauyz*ny + tauzz*nz;</div>
<div class="line"><a name="l13751"></a><span class="lineno">13751</span>&#160;  normalFlux[4] = normal[3]*HeatFlux</div>
<div class="line"><a name="l13752"></a><span class="lineno">13752</span>&#160;                + (u*tauxx + v*tauxy + w*tauxz + qx)*nx</div>
<div class="line"><a name="l13753"></a><span class="lineno">13753</span>&#160;                + (u*tauxy + v*tauyy + w*tauyz + qy)*ny</div>
<div class="line"><a name="l13754"></a><span class="lineno">13754</span>&#160;                + (u*tauxz + v*tauyz + w*tauzz + qz)*nz;</div>
<div class="line"><a name="l13755"></a><span class="lineno">13755</span>&#160;}</div>
<div class="line"><a name="l13756"></a><span class="lineno">13756</span>&#160; </div>
<div class="line"><a name="l13757"></a><span class="lineno">13757</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::PenaltyTermsFluxFace(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indFaceChunk,</div>
<div class="line"><a name="l13758"></a><span class="lineno">13758</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt,</div>
<div class="line"><a name="l13759"></a><span class="lineno">13759</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l13760"></a><span class="lineno">13760</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *solInt0,</div>
<div class="line"><a name="l13761"></a><span class="lineno">13761</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *solInt1,</div>
<div class="line"><a name="l13762"></a><span class="lineno">13762</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *viscosityInt0,</div>
<div class="line"><a name="l13763"></a><span class="lineno">13763</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *viscosityInt1,</div>
<div class="line"><a name="l13764"></a><span class="lineno">13764</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *kOverCvInt0,</div>
<div class="line"><a name="l13765"></a><span class="lineno">13765</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *kOverCvInt1,</div>
<div class="line"><a name="l13766"></a><span class="lineno">13766</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      ConstPenFace,</div>
<div class="line"><a name="l13767"></a><span class="lineno">13767</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      lenScale0,</div>
<div class="line"><a name="l13768"></a><span class="lineno">13768</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      lenScale1,</div>
<div class="line"><a name="l13769"></a><span class="lineno">13769</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *metricNormalsFace,</div>
<div class="line"><a name="l13770"></a><span class="lineno">13770</span>&#160;                                                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *penaltyFluxes) {</div>
<div class="line"><a name="l13771"></a><span class="lineno">13771</span>&#160; </div>
<div class="line"><a name="l13772"></a><span class="lineno">13772</span>&#160;  <span class="comment">/* Constant ratio of the second viscosity and the viscosity itself. */</span></div>
<div class="line"><a name="l13773"></a><span class="lineno">13773</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambdaOverMu = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>;</div>
<div class="line"><a name="l13774"></a><span class="lineno">13774</span>&#160; </div>
<div class="line"><a name="l13775"></a><span class="lineno">13775</span>&#160;  <span class="comment">/* The eigenvalues of the viscous Jacobian, scaled by the kinematic viscosity,</span></div>
<div class="line"><a name="l13776"></a><span class="lineno">13776</span>&#160;<span class="comment">     are 1.0, 2.0 + lambdaOverMu and kOverCv/Mu. The last is variable due to the</span></div>
<div class="line"><a name="l13777"></a><span class="lineno">13777</span>&#160;<span class="comment">     possible presence of an eddy viscosity, but the first two are constant and</span></div>
<div class="line"><a name="l13778"></a><span class="lineno">13778</span>&#160;<span class="comment">     the maximum can be determined. */</span></div>
<div class="line"><a name="l13779"></a><span class="lineno">13779</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radOverNuTerm = max(1.0, 2.0+lambdaOverMu);</div>
<div class="line"><a name="l13780"></a><span class="lineno">13780</span>&#160; </div>
<div class="line"><a name="l13781"></a><span class="lineno">13781</span>&#160;  <span class="comment">/*--- Make a distinction between 2D and 3D for efficiency. ---*/</span></div>
<div class="line"><a name="l13782"></a><span class="lineno">13782</span>&#160;  <span class="keywordflow">switch</span> ( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l13783"></a><span class="lineno">13783</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l13784"></a><span class="lineno">13784</span>&#160; </div>
<div class="line"><a name="l13785"></a><span class="lineno">13785</span>&#160;      <span class="comment">/* 2D simulation. Loop over the integration points to compute</span></div>
<div class="line"><a name="l13786"></a><span class="lineno">13786</span>&#160;<span class="comment">         the penalty fluxes. */</span></div>
<div class="line"><a name="l13787"></a><span class="lineno">13787</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l13788"></a><span class="lineno">13788</span>&#160; </div>
<div class="line"><a name="l13789"></a><span class="lineno">13789</span>&#160;        <span class="comment">/* Easier storage of the variables for this integration point. */</span></div>
<div class="line"><a name="l13790"></a><span class="lineno">13790</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l13791"></a><span class="lineno">13791</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol0   = solInt0 + offPointer;</div>
<div class="line"><a name="l13792"></a><span class="lineno">13792</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol1   = solInt1 + offPointer;</div>
<div class="line"><a name="l13793"></a><span class="lineno">13793</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normal = metricNormalsFace + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l13794"></a><span class="lineno">13794</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *flux   = penaltyFluxes + offPointer;</div>
<div class="line"><a name="l13795"></a><span class="lineno">13795</span>&#160; </div>
<div class="line"><a name="l13796"></a><span class="lineno">13796</span>&#160;        <span class="comment">/* Determine the ratio of kOverCv and mu for both sides and compute the</span></div>
<div class="line"><a name="l13797"></a><span class="lineno">13797</span>&#160;<span class="comment">           spectral radius of the viscous terms, scaled by kinematic viscosity. */</span></div>
<div class="line"><a name="l13798"></a><span class="lineno">13798</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l13799"></a><span class="lineno">13799</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux0 = kOverCvInt0[ind]/viscosityInt0[ind];</div>
<div class="line"><a name="l13800"></a><span class="lineno">13800</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux1 = kOverCvInt1[ind]/viscosityInt1[ind];</div>
<div class="line"><a name="l13801"></a><span class="lineno">13801</span>&#160; </div>
<div class="line"><a name="l13802"></a><span class="lineno">13802</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radOverNu0 = max(radOverNuTerm, factHeatFlux0);</div>
<div class="line"><a name="l13803"></a><span class="lineno">13803</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radOverNu1 = max(radOverNuTerm, factHeatFlux1);</div>
<div class="line"><a name="l13804"></a><span class="lineno">13804</span>&#160; </div>
<div class="line"><a name="l13805"></a><span class="lineno">13805</span>&#160;        <span class="comment">/* Compute the kinematic viscosities of both sides. Multiply it by</span></div>
<div class="line"><a name="l13806"></a><span class="lineno">13806</span>&#160;<span class="comment">           ConstPenFace and divide by the length scale. */</span></div>
<div class="line"><a name="l13807"></a><span class="lineno">13807</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nu0 = ConstPenFace*viscosityInt0[ind]/(lenScale0*sol0[0]);</div>
<div class="line"><a name="l13808"></a><span class="lineno">13808</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nu1 = ConstPenFace*viscosityInt1[ind]/(lenScale1*sol1[0]);</div>
<div class="line"><a name="l13809"></a><span class="lineno">13809</span>&#160; </div>
<div class="line"><a name="l13810"></a><span class="lineno">13810</span>&#160;        <span class="comment">/* Compute the penalty parameter of this face as the maximum of the</span></div>
<div class="line"><a name="l13811"></a><span class="lineno">13811</span>&#160;<span class="comment">           penalty parameter from both sides. Multiply by the area to obtain the</span></div>
<div class="line"><a name="l13812"></a><span class="lineno">13812</span>&#160;<span class="comment">           correct expression. */</span></div>
<div class="line"><a name="l13813"></a><span class="lineno">13813</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pen0 = radOverNu0*nu0;</div>
<div class="line"><a name="l13814"></a><span class="lineno">13814</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pen1 = radOverNu1*nu1;</div>
<div class="line"><a name="l13815"></a><span class="lineno">13815</span>&#160; </div>
<div class="line"><a name="l13816"></a><span class="lineno">13816</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> penFace = normal[2]*max(pen0, pen1);</div>
<div class="line"><a name="l13817"></a><span class="lineno">13817</span>&#160; </div>
<div class="line"><a name="l13818"></a><span class="lineno">13818</span>&#160;        <span class="comment">/* Compute the penalty flux, where it is assumed that the normal points from</span></div>
<div class="line"><a name="l13819"></a><span class="lineno">13819</span>&#160;<span class="comment">           side 0 to side 1. */</span></div>
<div class="line"><a name="l13820"></a><span class="lineno">13820</span>&#160;        flux[0] = penFace*(sol0[0] - sol1[0]);</div>
<div class="line"><a name="l13821"></a><span class="lineno">13821</span>&#160;        flux[1] = penFace*(sol0[1] - sol1[1]);</div>
<div class="line"><a name="l13822"></a><span class="lineno">13822</span>&#160;        flux[2] = penFace*(sol0[2] - sol1[2]);</div>
<div class="line"><a name="l13823"></a><span class="lineno">13823</span>&#160;        flux[3] = penFace*(sol0[3] - sol1[3]);</div>
<div class="line"><a name="l13824"></a><span class="lineno">13824</span>&#160;      }</div>
<div class="line"><a name="l13825"></a><span class="lineno">13825</span>&#160; </div>
<div class="line"><a name="l13826"></a><span class="lineno">13826</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13827"></a><span class="lineno">13827</span>&#160;    }</div>
<div class="line"><a name="l13828"></a><span class="lineno">13828</span>&#160; </div>
<div class="line"><a name="l13829"></a><span class="lineno">13829</span>&#160;    <span class="comment">/*----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l13830"></a><span class="lineno">13830</span>&#160; </div>
<div class="line"><a name="l13831"></a><span class="lineno">13831</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l13832"></a><span class="lineno">13832</span>&#160; </div>
<div class="line"><a name="l13833"></a><span class="lineno">13833</span>&#160;      <span class="comment">/* 3D simulation. Loop over the integration points to compute</span></div>
<div class="line"><a name="l13834"></a><span class="lineno">13834</span>&#160;<span class="comment">         the penalty fluxes. */</span></div>
<div class="line"><a name="l13835"></a><span class="lineno">13835</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l13836"></a><span class="lineno">13836</span>&#160; </div>
<div class="line"><a name="l13837"></a><span class="lineno">13837</span>&#160;        <span class="comment">/* Easier storage of the variables for this integration point. */</span></div>
<div class="line"><a name="l13838"></a><span class="lineno">13838</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l13839"></a><span class="lineno">13839</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol0   = solInt0 + offPointer;</div>
<div class="line"><a name="l13840"></a><span class="lineno">13840</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol1   = solInt1 + offPointer;</div>
<div class="line"><a name="l13841"></a><span class="lineno">13841</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normal = metricNormalsFace + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l13842"></a><span class="lineno">13842</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *flux   = penaltyFluxes + offPointer;</div>
<div class="line"><a name="l13843"></a><span class="lineno">13843</span>&#160; </div>
<div class="line"><a name="l13844"></a><span class="lineno">13844</span>&#160;        <span class="comment">/* Determine the ratio of kOverCv and mu for both sides and compute the</span></div>
<div class="line"><a name="l13845"></a><span class="lineno">13845</span>&#160;<span class="comment">           spectral radius of the viscous terms, scaled by kinematic viscosity. */</span></div>
<div class="line"><a name="l13846"></a><span class="lineno">13846</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l13847"></a><span class="lineno">13847</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux0 = kOverCvInt0[ind]/viscosityInt0[ind];</div>
<div class="line"><a name="l13848"></a><span class="lineno">13848</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factHeatFlux1 = kOverCvInt1[ind]/viscosityInt1[ind];</div>
<div class="line"><a name="l13849"></a><span class="lineno">13849</span>&#160; </div>
<div class="line"><a name="l13850"></a><span class="lineno">13850</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radOverNu0 = max(radOverNuTerm, factHeatFlux0);</div>
<div class="line"><a name="l13851"></a><span class="lineno">13851</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> radOverNu1 = max(radOverNuTerm, factHeatFlux1);</div>
<div class="line"><a name="l13852"></a><span class="lineno">13852</span>&#160; </div>
<div class="line"><a name="l13853"></a><span class="lineno">13853</span>&#160;        <span class="comment">/* Compute the kinematic viscosities of both sides. Multiply it by</span></div>
<div class="line"><a name="l13854"></a><span class="lineno">13854</span>&#160;<span class="comment">           ConstPenFace and divide by the length scale. */</span></div>
<div class="line"><a name="l13855"></a><span class="lineno">13855</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nu0 = ConstPenFace*viscosityInt0[ind]/(lenScale0*sol0[0]);</div>
<div class="line"><a name="l13856"></a><span class="lineno">13856</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nu1 = ConstPenFace*viscosityInt1[ind]/(lenScale1*sol1[0]);</div>
<div class="line"><a name="l13857"></a><span class="lineno">13857</span>&#160; </div>
<div class="line"><a name="l13858"></a><span class="lineno">13858</span>&#160;        <span class="comment">/* Compute the penalty parameter of this face as the maximum of the</span></div>
<div class="line"><a name="l13859"></a><span class="lineno">13859</span>&#160;<span class="comment">           penalty parameter from both sides. Multiply by the area to obtain the</span></div>
<div class="line"><a name="l13860"></a><span class="lineno">13860</span>&#160;<span class="comment">           correct expression. */</span></div>
<div class="line"><a name="l13861"></a><span class="lineno">13861</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pen0 = radOverNu0*nu0;</div>
<div class="line"><a name="l13862"></a><span class="lineno">13862</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> pen1 = radOverNu1*nu1;</div>
<div class="line"><a name="l13863"></a><span class="lineno">13863</span>&#160; </div>
<div class="line"><a name="l13864"></a><span class="lineno">13864</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> penFace = normal[3]*max(pen0, pen1);</div>
<div class="line"><a name="l13865"></a><span class="lineno">13865</span>&#160; </div>
<div class="line"><a name="l13866"></a><span class="lineno">13866</span>&#160;        <span class="comment">/* Compute the penalty flux, where it is assumed that the normal points from</span></div>
<div class="line"><a name="l13867"></a><span class="lineno">13867</span>&#160;<span class="comment">           side 0 to side 1. */</span></div>
<div class="line"><a name="l13868"></a><span class="lineno">13868</span>&#160;        flux[0] = penFace*(sol0[0] - sol1[0]);</div>
<div class="line"><a name="l13869"></a><span class="lineno">13869</span>&#160;        flux[1] = penFace*(sol0[1] - sol1[1]);</div>
<div class="line"><a name="l13870"></a><span class="lineno">13870</span>&#160;        flux[2] = penFace*(sol0[2] - sol1[2]);</div>
<div class="line"><a name="l13871"></a><span class="lineno">13871</span>&#160;        flux[3] = penFace*(sol0[3] - sol1[3]);</div>
<div class="line"><a name="l13872"></a><span class="lineno">13872</span>&#160;        flux[4] = penFace*(sol0[4] - sol1[4]);</div>
<div class="line"><a name="l13873"></a><span class="lineno">13873</span>&#160;      }</div>
<div class="line"><a name="l13874"></a><span class="lineno">13874</span>&#160; </div>
<div class="line"><a name="l13875"></a><span class="lineno">13875</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l13876"></a><span class="lineno">13876</span>&#160;    }</div>
<div class="line"><a name="l13877"></a><span class="lineno">13877</span>&#160;  }</div>
<div class="line"><a name="l13878"></a><span class="lineno">13878</span>&#160;}</div>
<div class="line"><a name="l13879"></a><span class="lineno">13879</span>&#160; </div>
<div class="line"><a name="l13880"></a><span class="lineno">13880</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::SymmetrizingFluxesFace(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indFaceChunk,</div>
<div class="line"><a name="l13881"></a><span class="lineno">13881</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt,</div>
<div class="line"><a name="l13882"></a><span class="lineno">13882</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l13883"></a><span class="lineno">13883</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *solInt0,</div>
<div class="line"><a name="l13884"></a><span class="lineno">13884</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *solInt1,</div>
<div class="line"><a name="l13885"></a><span class="lineno">13885</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *viscosityInt0,</div>
<div class="line"><a name="l13886"></a><span class="lineno">13886</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *viscosityInt1,</div>
<div class="line"><a name="l13887"></a><span class="lineno">13887</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *kOverCvInt0,</div>
<div class="line"><a name="l13888"></a><span class="lineno">13888</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *kOverCvInt1,</div>
<div class="line"><a name="l13889"></a><span class="lineno">13889</span>&#160;                                              <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *metricNormalsFace,</div>
<div class="line"><a name="l13890"></a><span class="lineno">13890</span>&#160;                                                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *symmFluxes) {</div>
<div class="line"><a name="l13891"></a><span class="lineno">13891</span>&#160; </div>
<div class="line"><a name="l13892"></a><span class="lineno">13892</span>&#160;  <span class="comment">/* Constant ratio of the second viscosity and the viscosity itself. */</span></div>
<div class="line"><a name="l13893"></a><span class="lineno">13893</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambdaOverMu = -<a class="code" href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a>;</div>
<div class="line"><a name="l13894"></a><span class="lineno">13894</span>&#160; </div>
<div class="line"><a name="l13895"></a><span class="lineno">13895</span>&#160;  <span class="comment">/*--- Set two factors such that either the original or the transposed diffusion</span></div>
<div class="line"><a name="l13896"></a><span class="lineno">13896</span>&#160;<span class="comment">        tensor is taken in the symmetrizing fluxes. ---*/</span></div>
<div class="line"><a name="l13897"></a><span class="lineno">13897</span>&#160; </div>
<div class="line"><a name="l13898"></a><span class="lineno">13898</span>&#160;  <span class="comment">/* Use the following line for the original formulation. */</span></div>
<div class="line"><a name="l13899"></a><span class="lineno">13899</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> alpha = lambdaOverMu;</div>
<div class="line"><a name="l13900"></a><span class="lineno">13900</span>&#160; </div>
<div class="line"><a name="l13901"></a><span class="lineno">13901</span>&#160;  <span class="comment">/* Use the following line for the transposed formulation. */</span></div>
<div class="line"><a name="l13902"></a><span class="lineno">13902</span>&#160;  <span class="comment">//const su2double alpha = 1.0;</span></div>
<div class="line"><a name="l13903"></a><span class="lineno">13903</span>&#160; </div>
<div class="line"><a name="l13904"></a><span class="lineno">13904</span>&#160;  <span class="comment">/* Other constants, which appear in the symmetrizing fluxes. */</span></div>
<div class="line"><a name="l13905"></a><span class="lineno">13905</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> beta     = lambdaOverMu + 1.0 - alpha;</div>
<div class="line"><a name="l13906"></a><span class="lineno">13906</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> alphaP1  = alpha + 1.0;</div>
<div class="line"><a name="l13907"></a><span class="lineno">13907</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lambdaP1 = lambdaOverMu + 1.0;</div>
<div class="line"><a name="l13908"></a><span class="lineno">13908</span>&#160; </div>
<div class="line"><a name="l13909"></a><span class="lineno">13909</span>&#160;  <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l13910"></a><span class="lineno">13910</span>&#160;<span class="comment">     in order to have the most efficient code. */</span></div>
<div class="line"><a name="l13911"></a><span class="lineno">13911</span>&#160;  <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l13912"></a><span class="lineno">13912</span>&#160; </div>
<div class="line"><a name="l13913"></a><span class="lineno">13913</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l13914"></a><span class="lineno">13914</span>&#160; </div>
<div class="line"><a name="l13915"></a><span class="lineno">13915</span>&#160;      <span class="comment">/*--- 2D simulation. Loop over the number of integration points</span></div>
<div class="line"><a name="l13916"></a><span class="lineno">13916</span>&#160;<span class="comment">            of the face. ---*/</span></div>
<div class="line"><a name="l13917"></a><span class="lineno">13917</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l13918"></a><span class="lineno">13918</span>&#160; </div>
<div class="line"><a name="l13919"></a><span class="lineno">13919</span>&#160;        <span class="comment">/* Easier storage of the variables for this integration point. */</span></div>
<div class="line"><a name="l13920"></a><span class="lineno">13920</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l13921"></a><span class="lineno">13921</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol0   = solInt0 + offPointer;</div>
<div class="line"><a name="l13922"></a><span class="lineno">13922</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol1   = solInt1 + offPointer;</div>
<div class="line"><a name="l13923"></a><span class="lineno">13923</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normal = metricNormalsFace + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l13924"></a><span class="lineno">13924</span>&#160; </div>
<div class="line"><a name="l13925"></a><span class="lineno">13925</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux = symmFluxes + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l13926"></a><span class="lineno">13926</span>&#160; </div>
<div class="line"><a name="l13927"></a><span class="lineno">13927</span>&#160;         <span class="comment">/* Determine the difference in conservative variables. Multiply these</span></div>
<div class="line"><a name="l13928"></a><span class="lineno">13928</span>&#160;<span class="comment">           differences by the length of the normal vector to obtain the correct</span></div>
<div class="line"><a name="l13929"></a><span class="lineno">13929</span>&#160;<span class="comment">           dimensions for the symmetrizing fluxes. */</span></div>
<div class="line"><a name="l13930"></a><span class="lineno">13930</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dSol[] = {normal[2]*(sol0[0] - sol1[0]),</div>
<div class="line"><a name="l13931"></a><span class="lineno">13931</span>&#160;                                  normal[2]*(sol0[1] - sol1[1]),</div>
<div class="line"><a name="l13932"></a><span class="lineno">13932</span>&#160;                                  normal[2]*(sol0[2] - sol1[2]),</div>
<div class="line"><a name="l13933"></a><span class="lineno">13933</span>&#160;                                  normal[2]*(sol0[3] - sol1[3])};</div>
<div class="line"><a name="l13934"></a><span class="lineno">13934</span>&#160; </div>
<div class="line"><a name="l13935"></a><span class="lineno">13935</span>&#160;        <span class="comment">/*--- Compute the terms that occur in the symmetrizing fluxes</span></div>
<div class="line"><a name="l13936"></a><span class="lineno">13936</span>&#160;<span class="comment">              for state 0 and state 1. ---*/</span></div>
<div class="line"><a name="l13937"></a><span class="lineno">13937</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l13938"></a><span class="lineno">13938</span>&#160; </div>
<div class="line"><a name="l13939"></a><span class="lineno">13939</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv0 = 1.0/sol0[0],             DensityInv1 = 1.0/sol1[0];</div>
<div class="line"><a name="l13940"></a><span class="lineno">13940</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Etot0 = DensityInv0*sol0[3],           Etot1 = DensityInv1*sol1[3];</div>
<div class="line"><a name="l13941"></a><span class="lineno">13941</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nu0 = DensityInv0*viscosityInt0[ind],  nu1 = DensityInv1*viscosityInt1[ind];</div>
<div class="line"><a name="l13942"></a><span class="lineno">13942</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kScal0 = DensityInv0*kOverCvInt0[ind], kScal1 = DensityInv1*kOverCvInt1[ind];</div>
<div class="line"><a name="l13943"></a><span class="lineno">13943</span>&#160; </div>
<div class="line"><a name="l13944"></a><span class="lineno">13944</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel0[] = {DensityInv0*sol0[1], DensityInv0*sol0[2]};</div>
<div class="line"><a name="l13945"></a><span class="lineno">13945</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel1[] = {DensityInv1*sol1[1], DensityInv1*sol1[2]};</div>
<div class="line"><a name="l13946"></a><span class="lineno">13946</span>&#160; </div>
<div class="line"><a name="l13947"></a><span class="lineno">13947</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velNorm0 = vel0[0]*normal[0] + vel0[1]*normal[1];</div>
<div class="line"><a name="l13948"></a><span class="lineno">13948</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velNorm1 = vel1[0]*normal[0] + vel1[1]*normal[1];</div>
<div class="line"><a name="l13949"></a><span class="lineno">13949</span>&#160; </div>
<div class="line"><a name="l13950"></a><span class="lineno">13950</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velSquared0 = vel0[0]*vel0[0] + vel0[1]*vel0[1];</div>
<div class="line"><a name="l13951"></a><span class="lineno">13951</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velSquared1 = vel1[0]*vel1[0] + vel1[1]*vel1[1];</div>
<div class="line"><a name="l13952"></a><span class="lineno">13952</span>&#160; </div>
<div class="line"><a name="l13953"></a><span class="lineno">13953</span>&#160;        <span class="comment">/*--- Compute the average of the terms that occur in the symmetrizing</span></div>
<div class="line"><a name="l13954"></a><span class="lineno">13954</span>&#160;<span class="comment">              fluxes. The average of the left and right terms is taken, rather</span></div>
<div class="line"><a name="l13955"></a><span class="lineno">13955</span>&#160;<span class="comment">              than the terms evaluated at the average state, because the viscous</span></div>
<div class="line"><a name="l13956"></a><span class="lineno">13956</span>&#160;<span class="comment">              fluxes are also computed as the average of the fluxes and not the</span></div>
<div class="line"><a name="l13957"></a><span class="lineno">13957</span>&#160;<span class="comment">              fluxes of the averaged state. ---*/</span></div>
<div class="line"><a name="l13958"></a><span class="lineno">13958</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nuAvg    = 0.5*(nu0    + nu1);</div>
<div class="line"><a name="l13959"></a><span class="lineno">13959</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kScalAvg = 0.5*(kScal0 + kScal1);</div>
<div class="line"><a name="l13960"></a><span class="lineno">13960</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nuVelSquaredAvg     = 0.5*(nu0*velSquared0 + nu1*velSquared1);</div>
<div class="line"><a name="l13961"></a><span class="lineno">13961</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nuVelNormAve        = 0.5*(nu0*velNorm0    + nu1*velNorm1);</div>
<div class="line"><a name="l13962"></a><span class="lineno">13962</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kScalEminVelSquaredAve = 0.5*(kScal0*(Etot0-velSquared0)</div>
<div class="line"><a name="l13963"></a><span class="lineno">13963</span>&#160;                                               +      kScal1*(Etot1-velSquared1));</div>
<div class="line"><a name="l13964"></a><span class="lineno">13964</span>&#160; </div>
<div class="line"><a name="l13965"></a><span class="lineno">13965</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nuVelAvg[] = {0.5*(nu0*vel0[0] + nu1*vel1[0]),</div>
<div class="line"><a name="l13966"></a><span class="lineno">13966</span>&#160;                                      0.5*(nu0*vel0[1] + nu1*vel1[1])};</div>
<div class="line"><a name="l13967"></a><span class="lineno">13967</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kScalVelAvg[] = {0.5*(kScal0*vel0[0] + kScal1*vel1[0]),</div>
<div class="line"><a name="l13968"></a><span class="lineno">13968</span>&#160;                                         0.5*(kScal0*vel0[1] + kScal1*vel1[1])};</div>
<div class="line"><a name="l13969"></a><span class="lineno">13969</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nuVelVelAvg[] = {0.5*(nu0*vel0[0]*velNorm0 + nu1*vel1[0]*velNorm1),</div>
<div class="line"><a name="l13970"></a><span class="lineno">13970</span>&#160;                                         0.5*(nu0*vel0[1]*velNorm0 + nu1*vel1[1]*velNorm1)};</div>
<div class="line"><a name="l13971"></a><span class="lineno">13971</span>&#160; </div>
<div class="line"><a name="l13972"></a><span class="lineno">13972</span>&#160;        <span class="comment">/*--- Abbreviations to make the flux computations a bit more efficient. ---*/</span></div>
<div class="line"><a name="l13973"></a><span class="lineno">13973</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv1 = normal[0]  *dSol[1] + normal[1]  *dSol[2];</div>
<div class="line"><a name="l13974"></a><span class="lineno">13974</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2 = nuVelAvg[0]*dSol[1] + nuVelAvg[1]*dSol[2];</div>
<div class="line"><a name="l13975"></a><span class="lineno">13975</span>&#160; </div>
<div class="line"><a name="l13976"></a><span class="lineno">13976</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2kScal = kScalVelAvg[0]*dSol[1] + kScalVelAvg[1]*dSol[2];</div>
<div class="line"><a name="l13977"></a><span class="lineno">13977</span>&#160; </div>
<div class="line"><a name="l13978"></a><span class="lineno">13978</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv3 = beta*(nuAvg*abv1 - nuVelNormAve*dSol[0]);</div>
<div class="line"><a name="l13979"></a><span class="lineno">13979</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv4 = kScalAvg*dSol[3] - abv2kScal</div>
<div class="line"><a name="l13980"></a><span class="lineno">13980</span>&#160;                             - kScalEminVelSquaredAve*dSol[0] + abv2;</div>
<div class="line"><a name="l13981"></a><span class="lineno">13981</span>&#160; </div>
<div class="line"><a name="l13982"></a><span class="lineno">13982</span>&#160;        <span class="comment">/*--- Compute the symmetrizing fluxes in x-direction. ---*/</span></div>
<div class="line"><a name="l13983"></a><span class="lineno">13983</span>&#160;        flux[0] = 0.0;</div>
<div class="line"><a name="l13984"></a><span class="lineno">13984</span>&#160;        flux[1] = abv3 + alphaP1*normal[0]*(nuAvg*dSol[1] - nuVelAvg[0]*dSol[0]);</div>
<div class="line"><a name="l13985"></a><span class="lineno">13985</span>&#160;        flux[2] = nuAvg*(normal[0]*dSol[2] + alpha*normal[1]*dSol[1])</div>
<div class="line"><a name="l13986"></a><span class="lineno">13986</span>&#160;                - (normal[0]*nuVelAvg[1] + alpha*normal[1]*nuVelAvg[0])*dSol[0];</div>
<div class="line"><a name="l13987"></a><span class="lineno">13987</span>&#160;        flux[3] = normal[0]*abv4</div>
<div class="line"><a name="l13988"></a><span class="lineno">13988</span>&#160;                - (lambdaP1*nuVelVelAvg[0] + nuVelSquaredAvg*normal[0])*dSol[0]</div>
<div class="line"><a name="l13989"></a><span class="lineno">13989</span>&#160;                + alpha*nuVelNormAve*dSol[1] + beta*nuVelAvg[0]*abv1;</div>
<div class="line"><a name="l13990"></a><span class="lineno">13990</span>&#160; </div>
<div class="line"><a name="l13991"></a><span class="lineno">13991</span>&#160;        <span class="comment">/*--- Compute the symmetrizing fluxes in y-direction. */</span></div>
<div class="line"><a name="l13992"></a><span class="lineno">13992</span>&#160;        flux = flux + NPad;</div>
<div class="line"><a name="l13993"></a><span class="lineno">13993</span>&#160;        flux[0] = 0.0;</div>
<div class="line"><a name="l13994"></a><span class="lineno">13994</span>&#160;        flux[1] = nuAvg*(normal[1]*dSol[1] + alpha*normal[0]*dSol[2])</div>
<div class="line"><a name="l13995"></a><span class="lineno">13995</span>&#160;                - (normal[1]*nuVelAvg[0] + alpha*normal[0]*nuVelAvg[1])*dSol[0];</div>
<div class="line"><a name="l13996"></a><span class="lineno">13996</span>&#160;        flux[2] = abv3 + alphaP1*normal[1]*(nuAvg*dSol[2] - nuVelAvg[1]*dSol[0]);</div>
<div class="line"><a name="l13997"></a><span class="lineno">13997</span>&#160;        flux[3] = normal[1]*abv4</div>
<div class="line"><a name="l13998"></a><span class="lineno">13998</span>&#160;                - (lambdaP1*nuVelVelAvg[1] + nuVelSquaredAvg*normal[1])*dSol[0]</div>
<div class="line"><a name="l13999"></a><span class="lineno">13999</span>&#160;                + alpha*nuVelNormAve*dSol[2] + beta*nuVelAvg[1]*abv1;</div>
<div class="line"><a name="l14000"></a><span class="lineno">14000</span>&#160;      }</div>
<div class="line"><a name="l14001"></a><span class="lineno">14001</span>&#160; </div>
<div class="line"><a name="l14002"></a><span class="lineno">14002</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14003"></a><span class="lineno">14003</span>&#160;    }</div>
<div class="line"><a name="l14004"></a><span class="lineno">14004</span>&#160; </div>
<div class="line"><a name="l14005"></a><span class="lineno">14005</span>&#160;    <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l14006"></a><span class="lineno">14006</span>&#160; </div>
<div class="line"><a name="l14007"></a><span class="lineno">14007</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l14008"></a><span class="lineno">14008</span>&#160; </div>
<div class="line"><a name="l14009"></a><span class="lineno">14009</span>&#160;      <span class="comment">/*--- 3D simulation. Loop over the number of integration points</span></div>
<div class="line"><a name="l14010"></a><span class="lineno">14010</span>&#160;<span class="comment">            of the face. ---*/</span></div>
<div class="line"><a name="l14011"></a><span class="lineno">14011</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l14012"></a><span class="lineno">14012</span>&#160; </div>
<div class="line"><a name="l14013"></a><span class="lineno">14013</span>&#160;        <span class="comment">/* Easier storage of the variables for this integration point. */</span></div>
<div class="line"><a name="l14014"></a><span class="lineno">14014</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = NPad*i + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l14015"></a><span class="lineno">14015</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol0   = solInt0 + offPointer;</div>
<div class="line"><a name="l14016"></a><span class="lineno">14016</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *sol1   = solInt1 + offPointer;</div>
<div class="line"><a name="l14017"></a><span class="lineno">14017</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normal = metricNormalsFace + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l14018"></a><span class="lineno">14018</span>&#160; </div>
<div class="line"><a name="l14019"></a><span class="lineno">14019</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux = symmFluxes + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*indFaceChunk;</div>
<div class="line"><a name="l14020"></a><span class="lineno">14020</span>&#160; </div>
<div class="line"><a name="l14021"></a><span class="lineno">14021</span>&#160;        <span class="comment">/* Determine the difference in conservative variables. Multiply these</span></div>
<div class="line"><a name="l14022"></a><span class="lineno">14022</span>&#160;<span class="comment">           differences by the length of the normal vector to obtain the correct</span></div>
<div class="line"><a name="l14023"></a><span class="lineno">14023</span>&#160;<span class="comment">           dimensions for the symmetrizing fluxes. */</span></div>
<div class="line"><a name="l14024"></a><span class="lineno">14024</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dSol[] = {normal[3]*(sol0[0] - sol1[0]),</div>
<div class="line"><a name="l14025"></a><span class="lineno">14025</span>&#160;                                  normal[3]*(sol0[1] - sol1[1]),</div>
<div class="line"><a name="l14026"></a><span class="lineno">14026</span>&#160;                                  normal[3]*(sol0[2] - sol1[2]),</div>
<div class="line"><a name="l14027"></a><span class="lineno">14027</span>&#160;                                  normal[3]*(sol0[3] - sol1[3]),</div>
<div class="line"><a name="l14028"></a><span class="lineno">14028</span>&#160;                                  normal[3]*(sol0[4] - sol1[4])};</div>
<div class="line"><a name="l14029"></a><span class="lineno">14029</span>&#160; </div>
<div class="line"><a name="l14030"></a><span class="lineno">14030</span>&#160;        <span class="comment">/*--- Compute the terms that occur in the symmetrizing fluxes</span></div>
<div class="line"><a name="l14031"></a><span class="lineno">14031</span>&#160;<span class="comment">              for state 0 and state 1. ---*/</span></div>
<div class="line"><a name="l14032"></a><span class="lineno">14032</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = indFaceChunk*nInt + i;</div>
<div class="line"><a name="l14033"></a><span class="lineno">14033</span>&#160; </div>
<div class="line"><a name="l14034"></a><span class="lineno">14034</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv0 = 1.0/sol0[0],             DensityInv1 = 1.0/sol1[0];</div>
<div class="line"><a name="l14035"></a><span class="lineno">14035</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Etot0 = DensityInv0*sol0[4],           Etot1 = DensityInv1*sol1[4];</div>
<div class="line"><a name="l14036"></a><span class="lineno">14036</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nu0 = DensityInv0*viscosityInt0[ind],  nu1 = DensityInv1*viscosityInt1[ind];</div>
<div class="line"><a name="l14037"></a><span class="lineno">14037</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kScal0 = DensityInv0*kOverCvInt0[ind], kScal1 = DensityInv1*kOverCvInt1[ind];</div>
<div class="line"><a name="l14038"></a><span class="lineno">14038</span>&#160; </div>
<div class="line"><a name="l14039"></a><span class="lineno">14039</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel0[] = {DensityInv0*sol0[1], DensityInv0*sol0[2], DensityInv0*sol0[3]};</div>
<div class="line"><a name="l14040"></a><span class="lineno">14040</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel1[] = {DensityInv1*sol1[1], DensityInv1*sol1[2], DensityInv1*sol1[3]};</div>
<div class="line"><a name="l14041"></a><span class="lineno">14041</span>&#160; </div>
<div class="line"><a name="l14042"></a><span class="lineno">14042</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velNorm0 = vel0[0]*normal[0] + vel0[1]*normal[1] + vel0[2]*normal[2];</div>
<div class="line"><a name="l14043"></a><span class="lineno">14043</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velNorm1 = vel1[0]*normal[0] + vel1[1]*normal[1] + vel1[2]*normal[2];</div>
<div class="line"><a name="l14044"></a><span class="lineno">14044</span>&#160; </div>
<div class="line"><a name="l14045"></a><span class="lineno">14045</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velSquared0 = vel0[0]*vel0[0] + vel0[1]*vel0[1] + vel0[2]*vel0[2];</div>
<div class="line"><a name="l14046"></a><span class="lineno">14046</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velSquared1 = vel1[0]*vel1[0] + vel1[1]*vel1[1] + vel1[2]*vel1[2];</div>
<div class="line"><a name="l14047"></a><span class="lineno">14047</span>&#160; </div>
<div class="line"><a name="l14048"></a><span class="lineno">14048</span>&#160;        <span class="comment">/*--- Compute the average of the terms that occur in the symmetrizing</span></div>
<div class="line"><a name="l14049"></a><span class="lineno">14049</span>&#160;<span class="comment">              fluxes. The average of the left and right terms is taken, rather</span></div>
<div class="line"><a name="l14050"></a><span class="lineno">14050</span>&#160;<span class="comment">              than the terms evaluated at the average state, because the viscous</span></div>
<div class="line"><a name="l14051"></a><span class="lineno">14051</span>&#160;<span class="comment">              fluxes are also computed as the average of the fluxes and not the</span></div>
<div class="line"><a name="l14052"></a><span class="lineno">14052</span>&#160;<span class="comment">              fluxes of the averaged state. ---*/</span></div>
<div class="line"><a name="l14053"></a><span class="lineno">14053</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nuAvg    = 0.5*(nu0    + nu1);</div>
<div class="line"><a name="l14054"></a><span class="lineno">14054</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kScalAvg = 0.5*(kScal0 + kScal1);</div>
<div class="line"><a name="l14055"></a><span class="lineno">14055</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nuVelSquaredAvg     = 0.5*(nu0*velSquared0 + nu1*velSquared1);</div>
<div class="line"><a name="l14056"></a><span class="lineno">14056</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nuVelNormAve        = 0.5*(nu0*velNorm0    + nu1*velNorm1);</div>
<div class="line"><a name="l14057"></a><span class="lineno">14057</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kScalEminVelSquaredAve = 0.5*(kScal0*(Etot0-velSquared0)</div>
<div class="line"><a name="l14058"></a><span class="lineno">14058</span>&#160;                                               +      kScal1*(Etot1-velSquared1));</div>
<div class="line"><a name="l14059"></a><span class="lineno">14059</span>&#160; </div>
<div class="line"><a name="l14060"></a><span class="lineno">14060</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nuVelAvg[] = {0.5*(nu0*vel0[0] + nu1*vel1[0]),</div>
<div class="line"><a name="l14061"></a><span class="lineno">14061</span>&#160;                                      0.5*(nu0*vel0[1] + nu1*vel1[1]),</div>
<div class="line"><a name="l14062"></a><span class="lineno">14062</span>&#160;                                      0.5*(nu0*vel0[2] + nu1*vel1[2])};</div>
<div class="line"><a name="l14063"></a><span class="lineno">14063</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kScalVelAvg[] = {0.5*(kScal0*vel0[0] + kScal1*vel1[0]),</div>
<div class="line"><a name="l14064"></a><span class="lineno">14064</span>&#160;                                         0.5*(kScal0*vel0[1] + kScal1*vel1[1]),</div>
<div class="line"><a name="l14065"></a><span class="lineno">14065</span>&#160;                                         0.5*(kScal0*vel0[2] + kScal1*vel1[2])};</div>
<div class="line"><a name="l14066"></a><span class="lineno">14066</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> nuVelVelAvg[] = {0.5*(nu0*vel0[0]*velNorm0 + nu1*vel1[0]*velNorm1),</div>
<div class="line"><a name="l14067"></a><span class="lineno">14067</span>&#160;                                         0.5*(nu0*vel0[1]*velNorm0 + nu1*vel1[1]*velNorm1),</div>
<div class="line"><a name="l14068"></a><span class="lineno">14068</span>&#160;                                         0.5*(nu0*vel0[2]*velNorm0 + nu1*vel1[2]*velNorm1)};</div>
<div class="line"><a name="l14069"></a><span class="lineno">14069</span>&#160; </div>
<div class="line"><a name="l14070"></a><span class="lineno">14070</span>&#160;        <span class="comment">/*--- Abbreviations to make the flux computations a bit more efficient. ---*/</span></div>
<div class="line"><a name="l14071"></a><span class="lineno">14071</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv1 = normal[0]  *dSol[1] + normal[1]  *dSol[2] + normal[2]  *dSol[3];</div>
<div class="line"><a name="l14072"></a><span class="lineno">14072</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2 = nuVelAvg[0]*dSol[1] + nuVelAvg[1]*dSol[2] + nuVelAvg[2]*dSol[3];</div>
<div class="line"><a name="l14073"></a><span class="lineno">14073</span>&#160; </div>
<div class="line"><a name="l14074"></a><span class="lineno">14074</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv2kScal = kScalVelAvg[0]*dSol[1] + kScalVelAvg[1]*dSol[2]</div>
<div class="line"><a name="l14075"></a><span class="lineno">14075</span>&#160;                                  + kScalVelAvg[2]*dSol[3];</div>
<div class="line"><a name="l14076"></a><span class="lineno">14076</span>&#160; </div>
<div class="line"><a name="l14077"></a><span class="lineno">14077</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv3 = beta*(nuAvg*abv1 - nuVelNormAve*dSol[0]);</div>
<div class="line"><a name="l14078"></a><span class="lineno">14078</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> abv4 = kScalAvg*dSol[4] - abv2kScal</div>
<div class="line"><a name="l14079"></a><span class="lineno">14079</span>&#160;                             - kScalEminVelSquaredAve*dSol[0] + abv2;</div>
<div class="line"><a name="l14080"></a><span class="lineno">14080</span>&#160; </div>
<div class="line"><a name="l14081"></a><span class="lineno">14081</span>&#160;        <span class="comment">/*--- Compute the symmetrizing fluxes in x-direction. ---*/</span></div>
<div class="line"><a name="l14082"></a><span class="lineno">14082</span>&#160;        flux[0] = 0.0;</div>
<div class="line"><a name="l14083"></a><span class="lineno">14083</span>&#160;        flux[1] = abv3 + alphaP1*normal[0]*(nuAvg*dSol[1] - nuVelAvg[0]*dSol[0]);</div>
<div class="line"><a name="l14084"></a><span class="lineno">14084</span>&#160;        flux[2] = nuAvg*(normal[0]*dSol[2] + alpha*normal[1]*dSol[1])</div>
<div class="line"><a name="l14085"></a><span class="lineno">14085</span>&#160;                - (normal[0]*nuVelAvg[1] + alpha*normal[1]*nuVelAvg[0])*dSol[0];</div>
<div class="line"><a name="l14086"></a><span class="lineno">14086</span>&#160;        flux[3] = nuAvg*(normal[0]*dSol[3] + alpha*normal[2]*dSol[1])</div>
<div class="line"><a name="l14087"></a><span class="lineno">14087</span>&#160;                - (normal[0]*nuVelAvg[2] + alpha*normal[2]*nuVelAvg[0])*dSol[0];</div>
<div class="line"><a name="l14088"></a><span class="lineno">14088</span>&#160;        flux[4] = normal[0]*abv4</div>
<div class="line"><a name="l14089"></a><span class="lineno">14089</span>&#160;                - (lambdaP1*nuVelVelAvg[0] + nuVelSquaredAvg*normal[0])*dSol[0]</div>
<div class="line"><a name="l14090"></a><span class="lineno">14090</span>&#160;                + alpha*nuVelNormAve*dSol[1] + beta*nuVelAvg[0]*abv1;</div>
<div class="line"><a name="l14091"></a><span class="lineno">14091</span>&#160; </div>
<div class="line"><a name="l14092"></a><span class="lineno">14092</span>&#160;        <span class="comment">/*--- Compute the symmetrizing fluxes in y-direction. ---*/</span></div>
<div class="line"><a name="l14093"></a><span class="lineno">14093</span>&#160;        flux    = flux + NPad;</div>
<div class="line"><a name="l14094"></a><span class="lineno">14094</span>&#160;        flux[0] = 0.0;</div>
<div class="line"><a name="l14095"></a><span class="lineno">14095</span>&#160;        flux[1] = nuAvg*(normal[1]*dSol[1] + alpha*normal[0]*dSol[2])</div>
<div class="line"><a name="l14096"></a><span class="lineno">14096</span>&#160;                - (normal[1]*nuVelAvg[0] + alpha*normal[0]*nuVelAvg[1])*dSol[0];</div>
<div class="line"><a name="l14097"></a><span class="lineno">14097</span>&#160;        flux[2] = abv3 + alphaP1*normal[1]*(nuAvg*dSol[2] - nuVelAvg[1]*dSol[0]);</div>
<div class="line"><a name="l14098"></a><span class="lineno">14098</span>&#160;        flux[3] = nuAvg*(normal[1]*dSol[3] + alpha*normal[2]*dSol[2])</div>
<div class="line"><a name="l14099"></a><span class="lineno">14099</span>&#160;                - (normal[1]*nuVelAvg[2] + alpha*normal[2]*nuVelAvg[1])*dSol[0];</div>
<div class="line"><a name="l14100"></a><span class="lineno">14100</span>&#160;        flux[4] = normal[1]*abv4</div>
<div class="line"><a name="l14101"></a><span class="lineno">14101</span>&#160;                - (lambdaP1*nuVelVelAvg[1] + nuVelSquaredAvg*normal[1])*dSol[0]</div>
<div class="line"><a name="l14102"></a><span class="lineno">14102</span>&#160;                + alpha*nuVelNormAve*dSol[2] + beta*nuVelAvg[1]*abv1;</div>
<div class="line"><a name="l14103"></a><span class="lineno">14103</span>&#160; </div>
<div class="line"><a name="l14104"></a><span class="lineno">14104</span>&#160;        <span class="comment">/*--- Compute the symmetrizing fluxes in z-direction. ---*/</span></div>
<div class="line"><a name="l14105"></a><span class="lineno">14105</span>&#160;        flux    = flux + NPad;</div>
<div class="line"><a name="l14106"></a><span class="lineno">14106</span>&#160;        flux[0] = 0.0;</div>
<div class="line"><a name="l14107"></a><span class="lineno">14107</span>&#160;        flux[1] = nuAvg*(normal[2]*dSol[1] + alpha*normal[0]*dSol[3])</div>
<div class="line"><a name="l14108"></a><span class="lineno">14108</span>&#160;                - (normal[2]*nuVelAvg[0] + alpha*normal[0]*nuVelAvg[2])*dSol[0];</div>
<div class="line"><a name="l14109"></a><span class="lineno">14109</span>&#160;        flux[2] = nuAvg*(normal[2]*dSol[2] + alpha*normal[1]*dSol[3])</div>
<div class="line"><a name="l14110"></a><span class="lineno">14110</span>&#160;                - (normal[2]*nuVelAvg[1] + alpha*normal[1]*nuVelAvg[2])*dSol[0];</div>
<div class="line"><a name="l14111"></a><span class="lineno">14111</span>&#160;        flux[3] = abv3 + alphaP1*normal[2]*(nuAvg*dSol[3] - nuVelAvg[2]*dSol[0]);</div>
<div class="line"><a name="l14112"></a><span class="lineno">14112</span>&#160;        flux[4] = normal[2]*abv4</div>
<div class="line"><a name="l14113"></a><span class="lineno">14113</span>&#160;                - (lambdaP1*nuVelVelAvg[2] + nuVelSquaredAvg*normal[2])*dSol[0]</div>
<div class="line"><a name="l14114"></a><span class="lineno">14114</span>&#160;                + alpha*nuVelNormAve*dSol[3] + beta*nuVelAvg[2]*abv1;</div>
<div class="line"><a name="l14115"></a><span class="lineno">14115</span>&#160;      }</div>
<div class="line"><a name="l14116"></a><span class="lineno">14116</span>&#160; </div>
<div class="line"><a name="l14117"></a><span class="lineno">14117</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14118"></a><span class="lineno">14118</span>&#160;    }</div>
<div class="line"><a name="l14119"></a><span class="lineno">14119</span>&#160;  }</div>
<div class="line"><a name="l14120"></a><span class="lineno">14120</span>&#160;}</div>
<div class="line"><a name="l14121"></a><span class="lineno">14121</span>&#160; </div>
<div class="line"><a name="l14122"></a><span class="lineno">14122</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::TransformSymmetrizingFluxes(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> indFaceChunk,</div>
<div class="line"><a name="l14123"></a><span class="lineno">14123</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt,</div>
<div class="line"><a name="l14124"></a><span class="lineno">14124</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> NPad,</div>
<div class="line"><a name="l14125"></a><span class="lineno">14125</span>&#160;                                                   <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      halfTheta,</div>
<div class="line"><a name="l14126"></a><span class="lineno">14126</span>&#160;                                                   <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *symmFluxes,</div>
<div class="line"><a name="l14127"></a><span class="lineno">14127</span>&#160;                                                   <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *weights,</div>
<div class="line"><a name="l14128"></a><span class="lineno">14128</span>&#160;                                                   <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *metricCoorFace,</div>
<div class="line"><a name="l14129"></a><span class="lineno">14129</span>&#160;                                                         <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      *paramFluxes) {</div>
<div class="line"><a name="l14130"></a><span class="lineno">14130</span>&#160; </div>
<div class="line"><a name="l14131"></a><span class="lineno">14131</span>&#160;  <span class="comment">/*--- Transform the fluxes, such that they must be multiplied with the</span></div>
<div class="line"><a name="l14132"></a><span class="lineno">14132</span>&#160;<span class="comment">        gradients w.r.t. the parametric coordinates rather than the</span></div>
<div class="line"><a name="l14133"></a><span class="lineno">14133</span>&#160;<span class="comment">        Cartesian coordinates of the basis functions. This involves the</span></div>
<div class="line"><a name="l14134"></a><span class="lineno">14134</span>&#160;<span class="comment">        multiplication with the metric terms. Also multiply the fluxes with</span></div>
<div class="line"><a name="l14135"></a><span class="lineno">14135</span>&#160;<span class="comment">        their integration weights and -theta/2. The parameter theta is the</span></div>
<div class="line"><a name="l14136"></a><span class="lineno">14136</span>&#160;<span class="comment">        parameter in the Interior Penalty formulation, the factor 1/2 comes in</span></div>
<div class="line"><a name="l14137"></a><span class="lineno">14137</span>&#160;<span class="comment">        from the averaging and the minus sign is from the convention that the</span></div>
<div class="line"><a name="l14138"></a><span class="lineno">14138</span>&#160;<span class="comment">        viscous fluxes come with a minus sign in this code. ---*/</span></div>
<div class="line"><a name="l14139"></a><span class="lineno">14139</span>&#160; </div>
<div class="line"><a name="l14140"></a><span class="lineno">14140</span>&#160;  <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l14141"></a><span class="lineno">14141</span>&#160;<span class="comment">     in order to have the most efficient code. */</span></div>
<div class="line"><a name="l14142"></a><span class="lineno">14142</span>&#160;  <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l14143"></a><span class="lineno">14143</span>&#160; </div>
<div class="line"><a name="l14144"></a><span class="lineno">14144</span>&#160;    <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l14145"></a><span class="lineno">14145</span>&#160;      <span class="comment">/* Two-dimensional computation. Loop over the integration</span></div>
<div class="line"><a name="l14146"></a><span class="lineno">14146</span>&#160;<span class="comment">         points to correct the fluxes. */</span></div>
<div class="line"><a name="l14147"></a><span class="lineno">14147</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l14148"></a><span class="lineno">14148</span>&#160; </div>
<div class="line"><a name="l14149"></a><span class="lineno">14149</span>&#160;        <span class="comment">/* Easier storage of the location where the the fluxes</span></div>
<div class="line"><a name="l14150"></a><span class="lineno">14150</span>&#160;<span class="comment">           are stored for this integration point as well as an</span></div>
<div class="line"><a name="l14151"></a><span class="lineno">14151</span>&#160;<span class="comment">           abbreviation for the integration weights time halfTheta. */</span></div>
<div class="line"><a name="l14152"></a><span class="lineno">14152</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad + indFaceChunk*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l14153"></a><span class="lineno">14153</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxX =  symmFluxes + offPointer;</div>
<div class="line"><a name="l14154"></a><span class="lineno">14154</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxY =  fluxX + NPad;</div>
<div class="line"><a name="l14155"></a><span class="lineno">14155</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wTheta = -halfTheta*weights[i];</div>
<div class="line"><a name="l14156"></a><span class="lineno">14156</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *paramFlux   =  paramFluxes + offPointer;</div>
<div class="line"><a name="l14157"></a><span class="lineno">14157</span>&#160; </div>
<div class="line"><a name="l14158"></a><span class="lineno">14158</span>&#160;        <span class="comment">/* Compute the modified metric terms. */</span></div>
<div class="line"><a name="l14159"></a><span class="lineno">14159</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = metricCoorFace + 4*i;   <span class="comment">// The 4 is nDim*nDim;</span></div>
<div class="line"><a name="l14160"></a><span class="lineno">14160</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = wTheta*metricTerms[0];</div>
<div class="line"><a name="l14161"></a><span class="lineno">14161</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = wTheta*metricTerms[1];</div>
<div class="line"><a name="l14162"></a><span class="lineno">14162</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = wTheta*metricTerms[2];</div>
<div class="line"><a name="l14163"></a><span class="lineno">14163</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = wTheta*metricTerms[3];</div>
<div class="line"><a name="l14164"></a><span class="lineno">14164</span>&#160; </div>
<div class="line"><a name="l14165"></a><span class="lineno">14165</span>&#160;        <span class="comment">/* Parametric fluxes in r-direction. */</span></div>
<div class="line"><a name="l14166"></a><span class="lineno">14166</span>&#160;        paramFlux[0] = fluxX[0]*drdx + fluxY[0]*drdy;</div>
<div class="line"><a name="l14167"></a><span class="lineno">14167</span>&#160;        paramFlux[1] = fluxX[1]*drdx + fluxY[1]*drdy;</div>
<div class="line"><a name="l14168"></a><span class="lineno">14168</span>&#160;        paramFlux[2] = fluxX[2]*drdx + fluxY[2]*drdy;</div>
<div class="line"><a name="l14169"></a><span class="lineno">14169</span>&#160;        paramFlux[3] = fluxX[3]*drdx + fluxY[3]*drdy;</div>
<div class="line"><a name="l14170"></a><span class="lineno">14170</span>&#160; </div>
<div class="line"><a name="l14171"></a><span class="lineno">14171</span>&#160;        <span class="comment">/* Parametric fluxes in s-direction. */</span></div>
<div class="line"><a name="l14172"></a><span class="lineno">14172</span>&#160;        paramFlux    = paramFlux + NPad;</div>
<div class="line"><a name="l14173"></a><span class="lineno">14173</span>&#160;        paramFlux[0] = fluxX[0]*dsdx + fluxY[0]*dsdy;</div>
<div class="line"><a name="l14174"></a><span class="lineno">14174</span>&#160;        paramFlux[1] = fluxX[1]*dsdx + fluxY[1]*dsdy;</div>
<div class="line"><a name="l14175"></a><span class="lineno">14175</span>&#160;        paramFlux[2] = fluxX[2]*dsdx + fluxY[2]*dsdy;</div>
<div class="line"><a name="l14176"></a><span class="lineno">14176</span>&#160;        paramFlux[3] = fluxX[3]*dsdx + fluxY[3]*dsdy;</div>
<div class="line"><a name="l14177"></a><span class="lineno">14177</span>&#160;      }</div>
<div class="line"><a name="l14178"></a><span class="lineno">14178</span>&#160; </div>
<div class="line"><a name="l14179"></a><span class="lineno">14179</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14180"></a><span class="lineno">14180</span>&#160;    }</div>
<div class="line"><a name="l14181"></a><span class="lineno">14181</span>&#160; </div>
<div class="line"><a name="l14182"></a><span class="lineno">14182</span>&#160;    <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l14183"></a><span class="lineno">14183</span>&#160;      <span class="comment">/* Three-dimensional computation. Loop over the integration</span></div>
<div class="line"><a name="l14184"></a><span class="lineno">14184</span>&#160;<span class="comment">         points to correct the fluxes. */</span></div>
<div class="line"><a name="l14185"></a><span class="lineno">14185</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l14186"></a><span class="lineno">14186</span>&#160; </div>
<div class="line"><a name="l14187"></a><span class="lineno">14187</span>&#160;        <span class="comment">/* Easier storage of the location where the the fluxes</span></div>
<div class="line"><a name="l14188"></a><span class="lineno">14188</span>&#160;<span class="comment">           are stored for this integration point as well as an</span></div>
<div class="line"><a name="l14189"></a><span class="lineno">14189</span>&#160;<span class="comment">           abbreviation for the integration weights time halfTheta. */</span></div>
<div class="line"><a name="l14190"></a><span class="lineno">14190</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offPointer = i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*NPad + indFaceChunk*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l14191"></a><span class="lineno">14191</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxX =  symmFluxes + offPointer;</div>
<div class="line"><a name="l14192"></a><span class="lineno">14192</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxY =  fluxX + NPad;</div>
<div class="line"><a name="l14193"></a><span class="lineno">14193</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxZ =  fluxY + NPad;</div>
<div class="line"><a name="l14194"></a><span class="lineno">14194</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wTheta = -halfTheta*weights[i];</div>
<div class="line"><a name="l14195"></a><span class="lineno">14195</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *paramFlux   =  paramFluxes + offPointer;</div>
<div class="line"><a name="l14196"></a><span class="lineno">14196</span>&#160; </div>
<div class="line"><a name="l14197"></a><span class="lineno">14197</span>&#160;        <span class="comment">/* Compute the modified metric terms. */</span></div>
<div class="line"><a name="l14198"></a><span class="lineno">14198</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = metricCoorFace + 9*i;   <span class="comment">// The 9 is nDim*nDim;</span></div>
<div class="line"><a name="l14199"></a><span class="lineno">14199</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = wTheta*metricTerms[0];</div>
<div class="line"><a name="l14200"></a><span class="lineno">14200</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = wTheta*metricTerms[1];</div>
<div class="line"><a name="l14201"></a><span class="lineno">14201</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdz = wTheta*metricTerms[2];</div>
<div class="line"><a name="l14202"></a><span class="lineno">14202</span>&#160; </div>
<div class="line"><a name="l14203"></a><span class="lineno">14203</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = wTheta*metricTerms[3];</div>
<div class="line"><a name="l14204"></a><span class="lineno">14204</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = wTheta*metricTerms[4];</div>
<div class="line"><a name="l14205"></a><span class="lineno">14205</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdz = wTheta*metricTerms[5];</div>
<div class="line"><a name="l14206"></a><span class="lineno">14206</span>&#160; </div>
<div class="line"><a name="l14207"></a><span class="lineno">14207</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdx = wTheta*metricTerms[6];</div>
<div class="line"><a name="l14208"></a><span class="lineno">14208</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdy = wTheta*metricTerms[7];</div>
<div class="line"><a name="l14209"></a><span class="lineno">14209</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdz = wTheta*metricTerms[8];</div>
<div class="line"><a name="l14210"></a><span class="lineno">14210</span>&#160; </div>
<div class="line"><a name="l14211"></a><span class="lineno">14211</span>&#160;        <span class="comment">/* Parametric fluxes in r-direction. */</span></div>
<div class="line"><a name="l14212"></a><span class="lineno">14212</span>&#160;        paramFlux[0] = fluxX[0]*drdx + fluxY[0]*drdy + fluxZ[0]*drdz;</div>
<div class="line"><a name="l14213"></a><span class="lineno">14213</span>&#160;        paramFlux[1] = fluxX[1]*drdx + fluxY[1]*drdy + fluxZ[1]*drdz;</div>
<div class="line"><a name="l14214"></a><span class="lineno">14214</span>&#160;        paramFlux[2] = fluxX[2]*drdx + fluxY[2]*drdy + fluxZ[2]*drdz;</div>
<div class="line"><a name="l14215"></a><span class="lineno">14215</span>&#160;        paramFlux[3] = fluxX[3]*drdx + fluxY[3]*drdy + fluxZ[3]*drdz;</div>
<div class="line"><a name="l14216"></a><span class="lineno">14216</span>&#160;        paramFlux[4] = fluxX[4]*drdx + fluxY[4]*drdy + fluxZ[4]*drdz;</div>
<div class="line"><a name="l14217"></a><span class="lineno">14217</span>&#160; </div>
<div class="line"><a name="l14218"></a><span class="lineno">14218</span>&#160;        <span class="comment">/* Parametric fluxes in s-direction. */</span></div>
<div class="line"><a name="l14219"></a><span class="lineno">14219</span>&#160;        paramFlux    = paramFlux + NPad;</div>
<div class="line"><a name="l14220"></a><span class="lineno">14220</span>&#160;        paramFlux[0] = fluxX[0]*dsdx + fluxY[0]*dsdy + fluxZ[0]*dsdz;</div>
<div class="line"><a name="l14221"></a><span class="lineno">14221</span>&#160;        paramFlux[1] = fluxX[1]*dsdx + fluxY[1]*dsdy + fluxZ[1]*dsdz;</div>
<div class="line"><a name="l14222"></a><span class="lineno">14222</span>&#160;        paramFlux[2] = fluxX[2]*dsdx + fluxY[2]*dsdy + fluxZ[2]*dsdz;</div>
<div class="line"><a name="l14223"></a><span class="lineno">14223</span>&#160;        paramFlux[3] = fluxX[3]*dsdx + fluxY[3]*dsdy + fluxZ[3]*dsdz;</div>
<div class="line"><a name="l14224"></a><span class="lineno">14224</span>&#160;        paramFlux[4] = fluxX[4]*dsdx + fluxY[4]*dsdy + fluxZ[4]*dsdz;</div>
<div class="line"><a name="l14225"></a><span class="lineno">14225</span>&#160; </div>
<div class="line"><a name="l14226"></a><span class="lineno">14226</span>&#160;        <span class="comment">/* Parametric fluxes in t-direction. */</span></div>
<div class="line"><a name="l14227"></a><span class="lineno">14227</span>&#160;        paramFlux    = paramFlux + NPad;</div>
<div class="line"><a name="l14228"></a><span class="lineno">14228</span>&#160;        paramFlux[0] = fluxX[0]*dtdx + fluxY[0]*dtdy + fluxZ[0]*dtdz;</div>
<div class="line"><a name="l14229"></a><span class="lineno">14229</span>&#160;        paramFlux[1] = fluxX[1]*dtdx + fluxY[1]*dtdy + fluxZ[1]*dtdz;</div>
<div class="line"><a name="l14230"></a><span class="lineno">14230</span>&#160;        paramFlux[2] = fluxX[2]*dtdx + fluxY[2]*dtdy + fluxZ[2]*dtdz;</div>
<div class="line"><a name="l14231"></a><span class="lineno">14231</span>&#160;        paramFlux[3] = fluxX[3]*dtdx + fluxY[3]*dtdy + fluxZ[3]*dtdz;</div>
<div class="line"><a name="l14232"></a><span class="lineno">14232</span>&#160;        paramFlux[4] = fluxX[4]*dtdx + fluxY[4]*dtdy + fluxZ[4]*dtdz;</div>
<div class="line"><a name="l14233"></a><span class="lineno">14233</span>&#160;      }</div>
<div class="line"><a name="l14234"></a><span class="lineno">14234</span>&#160; </div>
<div class="line"><a name="l14235"></a><span class="lineno">14235</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14236"></a><span class="lineno">14236</span>&#160;    }</div>
<div class="line"><a name="l14237"></a><span class="lineno">14237</span>&#160;  }</div>
<div class="line"><a name="l14238"></a><span class="lineno">14238</span>&#160;}</div>
<div class="line"><a name="l14239"></a><span class="lineno">14239</span>&#160; </div>
<div class="line"><a name="l14240"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a93ed201e11f8456abfc0a57841b781a7">14240</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a93ed201e11f8456abfc0a57841b781a7">CFEM_DG_NSSolver::BC_Euler_Wall</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l14241"></a><span class="lineno">14241</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l14242"></a><span class="lineno">14242</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l14243"></a><span class="lineno">14243</span>&#160;                                     <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l14244"></a><span class="lineno">14244</span>&#160;                                     <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l14245"></a><span class="lineno">14245</span>&#160;                                     <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l14246"></a><span class="lineno">14246</span>&#160;                                     <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray){</div>
<div class="line"><a name="l14247"></a><span class="lineno">14247</span>&#160; </div>
<div class="line"><a name="l14248"></a><span class="lineno">14248</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l14249"></a><span class="lineno">14249</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l14250"></a><span class="lineno">14250</span>&#160; </div>
<div class="line"><a name="l14251"></a><span class="lineno">14251</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l14252"></a><span class="lineno">14252</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l14253"></a><span class="lineno">14253</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l14254"></a><span class="lineno">14254</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l14255"></a><span class="lineno">14255</span>&#160; </div>
<div class="line"><a name="l14256"></a><span class="lineno">14256</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l14257"></a><span class="lineno">14257</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l14258"></a><span class="lineno">14258</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l14259"></a><span class="lineno">14259</span>&#160; </div>
<div class="line"><a name="l14260"></a><span class="lineno">14260</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l14261"></a><span class="lineno">14261</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l14262"></a><span class="lineno">14262</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l14263"></a><span class="lineno">14263</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l14264"></a><span class="lineno">14264</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l14265"></a><span class="lineno">14265</span>&#160; </div>
<div class="line"><a name="l14266"></a><span class="lineno">14266</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l14267"></a><span class="lineno">14267</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l14268"></a><span class="lineno">14268</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l14269"></a><span class="lineno">14269</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l14270"></a><span class="lineno">14270</span>&#160; </div>
<div class="line"><a name="l14271"></a><span class="lineno">14271</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l14272"></a><span class="lineno">14272</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l14273"></a><span class="lineno">14273</span>&#160; </div>
<div class="line"><a name="l14274"></a><span class="lineno">14274</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l14275"></a><span class="lineno">14275</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l14276"></a><span class="lineno">14276</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l14277"></a><span class="lineno">14277</span>&#160; </div>
<div class="line"><a name="l14278"></a><span class="lineno">14278</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l14279"></a><span class="lineno">14279</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l14280"></a><span class="lineno">14280</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l14281"></a><span class="lineno">14281</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l14282"></a><span class="lineno">14282</span>&#160; </div>
<div class="line"><a name="l14283"></a><span class="lineno">14283</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l14284"></a><span class="lineno">14284</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l14285"></a><span class="lineno">14285</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l14286"></a><span class="lineno">14286</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l14287"></a><span class="lineno">14287</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l14288"></a><span class="lineno">14288</span>&#160; </div>
<div class="line"><a name="l14289"></a><span class="lineno">14289</span>&#160;    <span class="comment">/* Compute the right state by applying the inviscid wall BC&#39;s. */</span></div>
<div class="line"><a name="l14290"></a><span class="lineno">14290</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5d32e85923daf35ff0126d5f716ff9ec">BoundaryStates_Euler_Wall</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l14291"></a><span class="lineno">14291</span>&#160;                              solIntL, solIntR);</div>
<div class="line"><a name="l14292"></a><span class="lineno">14292</span>&#160; </div>
<div class="line"><a name="l14293"></a><span class="lineno">14293</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l14294"></a><span class="lineno">14294</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l14295"></a><span class="lineno">14295</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l14296"></a><span class="lineno">14296</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l14297"></a><span class="lineno">14297</span>&#160;                                    solIntL, solIntR, work, resFaces,</div>
<div class="line"><a name="l14298"></a><span class="lineno">14298</span>&#160;                                    indResFaces, NULL);</div>
<div class="line"><a name="l14299"></a><span class="lineno">14299</span>&#160; </div>
<div class="line"><a name="l14300"></a><span class="lineno">14300</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l14301"></a><span class="lineno">14301</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l14302"></a><span class="lineno">14302</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l14303"></a><span class="lineno">14303</span>&#160;  }</div>
<div class="line"><a name="l14304"></a><span class="lineno">14304</span>&#160;}</div>
<div class="line"><a name="l14305"></a><span class="lineno">14305</span>&#160; </div>
<div class="line"><a name="l14306"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a123ec948e378e84eca5f772d28aec0d2">14306</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a123ec948e378e84eca5f772d28aec0d2">CFEM_DG_NSSolver::BC_Far_Field</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l14307"></a><span class="lineno">14307</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l14308"></a><span class="lineno">14308</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l14309"></a><span class="lineno">14309</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l14310"></a><span class="lineno">14310</span>&#160;                                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l14311"></a><span class="lineno">14311</span>&#160;                                    <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l14312"></a><span class="lineno">14312</span>&#160;                                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray){</div>
<div class="line"><a name="l14313"></a><span class="lineno">14313</span>&#160; </div>
<div class="line"><a name="l14314"></a><span class="lineno">14314</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l14315"></a><span class="lineno">14315</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l14316"></a><span class="lineno">14316</span>&#160; </div>
<div class="line"><a name="l14317"></a><span class="lineno">14317</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l14318"></a><span class="lineno">14318</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l14319"></a><span class="lineno">14319</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l14320"></a><span class="lineno">14320</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l14321"></a><span class="lineno">14321</span>&#160; </div>
<div class="line"><a name="l14322"></a><span class="lineno">14322</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l14323"></a><span class="lineno">14323</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l14324"></a><span class="lineno">14324</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l14325"></a><span class="lineno">14325</span>&#160; </div>
<div class="line"><a name="l14326"></a><span class="lineno">14326</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l14327"></a><span class="lineno">14327</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l14328"></a><span class="lineno">14328</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l14329"></a><span class="lineno">14329</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l14330"></a><span class="lineno">14330</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l14331"></a><span class="lineno">14331</span>&#160; </div>
<div class="line"><a name="l14332"></a><span class="lineno">14332</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l14333"></a><span class="lineno">14333</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l14334"></a><span class="lineno">14334</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l14335"></a><span class="lineno">14335</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l14336"></a><span class="lineno">14336</span>&#160; </div>
<div class="line"><a name="l14337"></a><span class="lineno">14337</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l14338"></a><span class="lineno">14338</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l14339"></a><span class="lineno">14339</span>&#160; </div>
<div class="line"><a name="l14340"></a><span class="lineno">14340</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l14341"></a><span class="lineno">14341</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l14342"></a><span class="lineno">14342</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l14343"></a><span class="lineno">14343</span>&#160; </div>
<div class="line"><a name="l14344"></a><span class="lineno">14344</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l14345"></a><span class="lineno">14345</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l14346"></a><span class="lineno">14346</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l14347"></a><span class="lineno">14347</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l14348"></a><span class="lineno">14348</span>&#160; </div>
<div class="line"><a name="l14349"></a><span class="lineno">14349</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l14350"></a><span class="lineno">14350</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l14351"></a><span class="lineno">14351</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l14352"></a><span class="lineno">14352</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l14353"></a><span class="lineno">14353</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l14354"></a><span class="lineno">14354</span>&#160; </div>
<div class="line"><a name="l14355"></a><span class="lineno">14355</span>&#160;    <span class="comment">/* Set the right state in the integration points to the free stream value. */</span></div>
<div class="line"><a name="l14356"></a><span class="lineno">14356</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l14357"></a><span class="lineno">14357</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l14358"></a><span class="lineno">14358</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l14359"></a><span class="lineno">14359</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR = solIntR + i*NPad + llNVar;</div>
<div class="line"><a name="l14360"></a><span class="lineno">14360</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>; ++j)</div>
<div class="line"><a name="l14361"></a><span class="lineno">14361</span>&#160;          UR[j] = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">ConsVarFreeStream</a>[j];</div>
<div class="line"><a name="l14362"></a><span class="lineno">14362</span>&#160;      }</div>
<div class="line"><a name="l14363"></a><span class="lineno">14363</span>&#160;    }</div>
<div class="line"><a name="l14364"></a><span class="lineno">14364</span>&#160; </div>
<div class="line"><a name="l14365"></a><span class="lineno">14365</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l14366"></a><span class="lineno">14366</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l14367"></a><span class="lineno">14367</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l14368"></a><span class="lineno">14368</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l14369"></a><span class="lineno">14369</span>&#160;                                    solIntL, solIntR, work, resFaces,</div>
<div class="line"><a name="l14370"></a><span class="lineno">14370</span>&#160;                                    indResFaces, NULL);</div>
<div class="line"><a name="l14371"></a><span class="lineno">14371</span>&#160; </div>
<div class="line"><a name="l14372"></a><span class="lineno">14372</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l14373"></a><span class="lineno">14373</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l14374"></a><span class="lineno">14374</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l14375"></a><span class="lineno">14375</span>&#160;  }</div>
<div class="line"><a name="l14376"></a><span class="lineno">14376</span>&#160;}</div>
<div class="line"><a name="l14377"></a><span class="lineno">14377</span>&#160; </div>
<div class="line"><a name="l14378"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a148134abb8821df7c68a8f9adedbe851">14378</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a148134abb8821df7c68a8f9adedbe851">CFEM_DG_NSSolver::BC_Sym_Plane</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l14379"></a><span class="lineno">14379</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l14380"></a><span class="lineno">14380</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l14381"></a><span class="lineno">14381</span>&#160;                                    <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l14382"></a><span class="lineno">14382</span>&#160;                                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l14383"></a><span class="lineno">14383</span>&#160;                                    <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l14384"></a><span class="lineno">14384</span>&#160;                                    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray){</div>
<div class="line"><a name="l14385"></a><span class="lineno">14385</span>&#160; </div>
<div class="line"><a name="l14386"></a><span class="lineno">14386</span>&#160;  <span class="comment">/* Easier storage of the number of bytes to copy in the memcpy calls. */</span></div>
<div class="line"><a name="l14387"></a><span class="lineno">14387</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l14388"></a><span class="lineno">14388</span>&#160; </div>
<div class="line"><a name="l14389"></a><span class="lineno">14389</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l14390"></a><span class="lineno">14390</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l14391"></a><span class="lineno">14391</span>&#160; </div>
<div class="line"><a name="l14392"></a><span class="lineno">14392</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l14393"></a><span class="lineno">14393</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l14394"></a><span class="lineno">14394</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l14395"></a><span class="lineno">14395</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l14396"></a><span class="lineno">14396</span>&#160; </div>
<div class="line"><a name="l14397"></a><span class="lineno">14397</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l14398"></a><span class="lineno">14398</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l14399"></a><span class="lineno">14399</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l14400"></a><span class="lineno">14400</span>&#160; </div>
<div class="line"><a name="l14401"></a><span class="lineno">14401</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l14402"></a><span class="lineno">14402</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l14403"></a><span class="lineno">14403</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l14404"></a><span class="lineno">14404</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l14405"></a><span class="lineno">14405</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l14406"></a><span class="lineno">14406</span>&#160; </div>
<div class="line"><a name="l14407"></a><span class="lineno">14407</span>&#160;    <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l14408"></a><span class="lineno">14408</span>&#160;    <span class="comment">/*--- Step 1: Initialization and computation of the left states.         ---*/</span></div>
<div class="line"><a name="l14409"></a><span class="lineno">14409</span>&#160;    <span class="comment">/*--------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l14410"></a><span class="lineno">14410</span>&#160; </div>
<div class="line"><a name="l14411"></a><span class="lineno">14411</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l14412"></a><span class="lineno">14412</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l14413"></a><span class="lineno">14413</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l14414"></a><span class="lineno">14414</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l14415"></a><span class="lineno">14415</span>&#160; </div>
<div class="line"><a name="l14416"></a><span class="lineno">14416</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l14417"></a><span class="lineno">14417</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l14418"></a><span class="lineno">14418</span>&#160; </div>
<div class="line"><a name="l14419"></a><span class="lineno">14419</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l14420"></a><span class="lineno">14420</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l14421"></a><span class="lineno">14421</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt         = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l14422"></a><span class="lineno">14422</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#aad6afe2fa8d35697a57dfc22a7542176">GetNDOFsElem</a>();</div>
<div class="line"><a name="l14423"></a><span class="lineno">14423</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>     *derBasisElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#af348ced10e1bc0d2a33992de84c13127">GetMatDerBasisElemIntegration</a>();</div>
<div class="line"><a name="l14424"></a><span class="lineno">14424</span>&#160; </div>
<div class="line"><a name="l14425"></a><span class="lineno">14425</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l14426"></a><span class="lineno">14426</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL      = workArray;</div>
<div class="line"><a name="l14427"></a><span class="lineno">14427</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR      = solIntL + NPad*nInt;</div>
<div class="line"><a name="l14428"></a><span class="lineno">14428</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *viscosityInt = solIntR + NPad*nInt;</div>
<div class="line"><a name="l14429"></a><span class="lineno">14429</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *kOverCvInt   = viscosityInt + llEnd*nInt;</div>
<div class="line"><a name="l14430"></a><span class="lineno">14430</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradSolInt   = kOverCvInt   + llEnd*nInt;</div>
<div class="line"><a name="l14431"></a><span class="lineno">14431</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxes       = gradSolInt   + NPad*nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l14432"></a><span class="lineno">14432</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *viscFluxes   = fluxes       + NPad*max(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, (<span class="keywordtype">int</span>) nDOFsElem);</div>
<div class="line"><a name="l14433"></a><span class="lineno">14433</span>&#160; </div>
<div class="line"><a name="l14434"></a><span class="lineno">14434</span>&#160;    <span class="comment">/* Compute the left states in the integration points of this chunk of</span></div>
<div class="line"><a name="l14435"></a><span class="lineno">14435</span>&#160;<span class="comment">       faces.  Use fluxes as a temporary storage array. */</span></div>
<div class="line"><a name="l14436"></a><span class="lineno">14436</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l14437"></a><span class="lineno">14437</span>&#160;                                            fluxes, solIntL);</div>
<div class="line"><a name="l14438"></a><span class="lineno">14438</span>&#160; </div>
<div class="line"><a name="l14439"></a><span class="lineno">14439</span>&#160;    <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l14440"></a><span class="lineno">14440</span>&#160;    <span class="comment">/*--- Step 2: Computation of the gradients of the conservative        ---*/</span></div>
<div class="line"><a name="l14441"></a><span class="lineno">14441</span>&#160;    <span class="comment">/*---         variables w.r.t. the parametric coordinates.            ---*/</span></div>
<div class="line"><a name="l14442"></a><span class="lineno">14442</span>&#160;    <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l14443"></a><span class="lineno">14443</span>&#160; </div>
<div class="line"><a name="l14444"></a><span class="lineno">14444</span>&#160;    <span class="comment">/* Set the pointer solElem to fluxes, just for readability. It is a temporary</span></div>
<div class="line"><a name="l14445"></a><span class="lineno">14445</span>&#160;<span class="comment">       storage of the solution of the elements, such that the gradients can be</span></div>
<div class="line"><a name="l14446"></a><span class="lineno">14446</span>&#160;<span class="comment">       computed efficiently. */</span></div>
<div class="line"><a name="l14447"></a><span class="lineno">14447</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solElem = fluxes;</div>
<div class="line"><a name="l14448"></a><span class="lineno">14448</span>&#160; </div>
<div class="line"><a name="l14449"></a><span class="lineno">14449</span>&#160;    <span class="comment">/* Loop over the faces of the chunk to set the conservative variables</span></div>
<div class="line"><a name="l14450"></a><span class="lineno">14450</span>&#160;<span class="comment">       in the appropriate sequence. */</span></div>
<div class="line"><a name="l14451"></a><span class="lineno">14451</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l14452"></a><span class="lineno">14452</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel  = ll - l;</div>
<div class="line"><a name="l14453"></a><span class="lineno">14453</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = llRel*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l14454"></a><span class="lineno">14454</span>&#160; </div>
<div class="line"><a name="l14455"></a><span class="lineno">14455</span>&#160;      <span class="comment">/* Determine the time level of the boundary face, which is equal</span></div>
<div class="line"><a name="l14456"></a><span class="lineno">14456</span>&#160;<span class="comment">         to the time level of the adjacent element. */</span></div>
<div class="line"><a name="l14457"></a><span class="lineno">14457</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elemID    = surfElem[ll].<a class="code" href="class_c_surface_element_f_e_m.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>;</div>
<div class="line"><a name="l14458"></a><span class="lineno">14458</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l14459"></a><span class="lineno">14459</span>&#160; </div>
<div class="line"><a name="l14460"></a><span class="lineno">14460</span>&#160;      <span class="comment">/* Determine the offset that must be applied to access the correct data for</span></div>
<div class="line"><a name="l14461"></a><span class="lineno">14461</span>&#160;<span class="comment">         the adjacent element in the working vector of the solution. This is a</span></div>
<div class="line"><a name="l14462"></a><span class="lineno">14462</span>&#160;<span class="comment">         boundary face, which has the same time level as the adjacent element. */</span></div>
<div class="line"><a name="l14463"></a><span class="lineno">14463</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l14464"></a><span class="lineno">14464</span>&#160;                                 - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l14465"></a><span class="lineno">14465</span>&#160; </div>
<div class="line"><a name="l14466"></a><span class="lineno">14466</span>&#160;      <span class="comment">/* Loop over the DOFs of the element and copy the solution. */</span></div>
<div class="line"><a name="l14467"></a><span class="lineno">14467</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem; ++i) {</div>
<div class="line"><a name="l14468"></a><span class="lineno">14468</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l14469"></a><span class="lineno">14469</span>&#160;                                + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(surfElem[ll].<a class="code" href="class_c_surface_element_f_e_m.html#abdf9f21e0435e853d60d7faeecbb5e2f">DOFsSolElement</a>[i] - offset);</div>
<div class="line"><a name="l14470"></a><span class="lineno">14470</span>&#160;        memcpy(solElem+NPad*i+llNVar, solDOF, nBytes);</div>
<div class="line"><a name="l14471"></a><span class="lineno">14471</span>&#160;      }</div>
<div class="line"><a name="l14472"></a><span class="lineno">14472</span>&#160;    }</div>
<div class="line"><a name="l14473"></a><span class="lineno">14473</span>&#160; </div>
<div class="line"><a name="l14474"></a><span class="lineno">14474</span>&#160;    <span class="comment">/* Compute the left gradients in the integration points. Call the general</span></div>
<div class="line"><a name="l14475"></a><span class="lineno">14475</span>&#160;<span class="comment">       function to carry out the matrix product. */</span></div>
<div class="line"><a name="l14476"></a><span class="lineno">14476</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFsElem, derBasisElem, solElem, gradSolInt, config);</div>
<div class="line"><a name="l14477"></a><span class="lineno">14477</span>&#160; </div>
<div class="line"><a name="l14478"></a><span class="lineno">14478</span>&#160;    <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l14479"></a><span class="lineno">14479</span>&#160;    <span class="comment">/*--- Step 3: Computation of the viscous fluxes in the integration    ---*/</span></div>
<div class="line"><a name="l14480"></a><span class="lineno">14480</span>&#160;    <span class="comment">/*---         points.                                                 ---*/</span></div>
<div class="line"><a name="l14481"></a><span class="lineno">14481</span>&#160;    <span class="comment">/*-----------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l14482"></a><span class="lineno">14482</span>&#160; </div>
<div class="line"><a name="l14483"></a><span class="lineno">14483</span>&#160;    <span class="comment">/* Determine the offset between r- and -s-derivatives, which is also the</span></div>
<div class="line"><a name="l14484"></a><span class="lineno">14484</span>&#160;<span class="comment">       offset between s- and t-derivatives. */</span></div>
<div class="line"><a name="l14485"></a><span class="lineno">14485</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> offDeriv = NPad*nInt;</div>
<div class="line"><a name="l14486"></a><span class="lineno">14486</span>&#160; </div>
<div class="line"><a name="l14487"></a><span class="lineno">14487</span>&#160;    <span class="comment">/* Loop over the faces of the chunk. */</span></div>
<div class="line"><a name="l14488"></a><span class="lineno">14488</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> ll=l; ll&lt;lEnd; ++ll) {</div>
<div class="line"><a name="l14489"></a><span class="lineno">14489</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llRel  = ll - l;</div>
<div class="line"><a name="l14490"></a><span class="lineno">14490</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = llRel*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l14491"></a><span class="lineno">14491</span>&#160; </div>
<div class="line"><a name="l14492"></a><span class="lineno">14492</span>&#160;      <span class="comment">/* Compute the length scale for the LES of the adjacent element. */</span></div>
<div class="line"><a name="l14493"></a><span class="lineno">14493</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  elemID = surfElem[ll].<a class="code" href="class_c_surface_element_f_e_m.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>;</div>
<div class="line"><a name="l14494"></a><span class="lineno">14494</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iind   = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">indStandardElement</a>;</div>
<div class="line"><a name="l14495"></a><span class="lineno">14495</span>&#160; </div>
<div class="line"><a name="l14496"></a><span class="lineno">14496</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPoly = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">standardElementsSol</a>[iind].<a class="code" href="class_c_f_e_m_standard_element.html#a007e03cd4cc6bd8f37e54411eaf0b23f">GetNPoly</a>();</div>
<div class="line"><a name="l14497"></a><span class="lineno">14497</span>&#160;      <span class="keywordflow">if</span>(nPoly == 0) nPoly = 1;</div>
<div class="line"><a name="l14498"></a><span class="lineno">14498</span>&#160; </div>
<div class="line"><a name="l14499"></a><span class="lineno">14499</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale_LES = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>/nPoly;</div>
<div class="line"><a name="l14500"></a><span class="lineno">14500</span>&#160; </div>
<div class="line"><a name="l14501"></a><span class="lineno">14501</span>&#160;      <span class="comment">/* Easier storage of the wall distance array for this surface element. */</span></div>
<div class="line"><a name="l14502"></a><span class="lineno">14502</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *wallDistance = surfElem[ll].<a class="code" href="class_c_surface_element_f_e_m.html#a69fdb86db7c5b6ac05be11490c3696b5">wallDistance</a>.data();</div>
<div class="line"><a name="l14503"></a><span class="lineno">14503</span>&#160; </div>
<div class="line"><a name="l14504"></a><span class="lineno">14504</span>&#160;      <span class="comment">/* Make a distinction between two and three space dimensions</span></div>
<div class="line"><a name="l14505"></a><span class="lineno">14505</span>&#160;<span class="comment">         in order to have the most efficient code. */</span></div>
<div class="line"><a name="l14506"></a><span class="lineno">14506</span>&#160;      <span class="keywordflow">switch</span>( <a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a> ) {</div>
<div class="line"><a name="l14507"></a><span class="lineno">14507</span>&#160; </div>
<div class="line"><a name="l14508"></a><span class="lineno">14508</span>&#160;        <span class="keywordflow">case</span> 2: {</div>
<div class="line"><a name="l14509"></a><span class="lineno">14509</span>&#160; </div>
<div class="line"><a name="l14510"></a><span class="lineno">14510</span>&#160;          <span class="comment">/*--- 2D simulation. Loop over the integration points to apply the</span></div>
<div class="line"><a name="l14511"></a><span class="lineno">14511</span>&#160;<span class="comment">                symmetry condition and to compute the viscous normal fluxes. This</span></div>
<div class="line"><a name="l14512"></a><span class="lineno">14512</span>&#160;<span class="comment">                is done in the same loop, because the gradients in the right</span></div>
<div class="line"><a name="l14513"></a><span class="lineno">14513</span>&#160;<span class="comment">                integration points are constructed using the symmetry boundary</span></div>
<div class="line"><a name="l14514"></a><span class="lineno">14514</span>&#160;<span class="comment">                condition. ---*/</span></div>
<div class="line"><a name="l14515"></a><span class="lineno">14515</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l14516"></a><span class="lineno">14516</span>&#160; </div>
<div class="line"><a name="l14517"></a><span class="lineno">14517</span>&#160;            <span class="comment">/* Easier storage of the left and right solution and the normals</span></div>
<div class="line"><a name="l14518"></a><span class="lineno">14518</span>&#160;<span class="comment">               for this integration point. */</span></div>
<div class="line"><a name="l14519"></a><span class="lineno">14519</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pointerOffset = NPad*i + llNVar;</div>
<div class="line"><a name="l14520"></a><span class="lineno">14520</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solIntL + pointerOffset;</div>
<div class="line"><a name="l14521"></a><span class="lineno">14521</span>&#160;                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solIntR + pointerOffset;</div>
<div class="line"><a name="l14522"></a><span class="lineno">14522</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[ll].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l14523"></a><span class="lineno">14523</span>&#160; </div>
<div class="line"><a name="l14524"></a><span class="lineno">14524</span>&#160;            <span class="comment">/* Compute twice the normal component of the momentum variables. The</span></div>
<div class="line"><a name="l14525"></a><span class="lineno">14525</span>&#160;<span class="comment">               factor 2 comes from the fact that the velocity must be mirrored. */</span></div>
<div class="line"><a name="l14526"></a><span class="lineno">14526</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rVn = 2.0*(UL[1]*normals[0] + UL[2]*normals[1]);</div>
<div class="line"><a name="l14527"></a><span class="lineno">14527</span>&#160; </div>
<div class="line"><a name="l14528"></a><span class="lineno">14528</span>&#160;            <span class="comment">/* Set the right state. Note that the total energy of the right state is</span></div>
<div class="line"><a name="l14529"></a><span class="lineno">14529</span>&#160;<span class="comment">               identical to the left state, because the magnitude of the velocity</span></div>
<div class="line"><a name="l14530"></a><span class="lineno">14530</span>&#160;<span class="comment">               remains the same. */</span></div>
<div class="line"><a name="l14531"></a><span class="lineno">14531</span>&#160;            UR[0] = UL[0];</div>
<div class="line"><a name="l14532"></a><span class="lineno">14532</span>&#160;            UR[1] = UL[1] - rVn*normals[0];</div>
<div class="line"><a name="l14533"></a><span class="lineno">14533</span>&#160;            UR[2] = UL[2] - rVn*normals[1];</div>
<div class="line"><a name="l14534"></a><span class="lineno">14534</span>&#160;            UR[3] = UL[3];</div>
<div class="line"><a name="l14535"></a><span class="lineno">14535</span>&#160; </div>
<div class="line"><a name="l14536"></a><span class="lineno">14536</span>&#160;            <span class="comment">/* Easier storage of the metric terms and left gradients of this</span></div>
<div class="line"><a name="l14537"></a><span class="lineno">14537</span>&#160;<span class="comment">               integration point. */</span></div>
<div class="line"><a name="l14538"></a><span class="lineno">14538</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = surfElem[ll].<a class="code" href="class_c_surface_element_f_e_m.html#a49f9ee99ed3a8a6c5c895050f29169d8">metricCoorDerivFace</a>.data()</div>
<div class="line"><a name="l14539"></a><span class="lineno">14539</span>&#160;                                         + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l14540"></a><span class="lineno">14540</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dULDr       = gradSolInt + pointerOffset;</div>
<div class="line"><a name="l14541"></a><span class="lineno">14541</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dULDs       = dULDr + offDeriv;</div>
<div class="line"><a name="l14542"></a><span class="lineno">14542</span>&#160; </div>
<div class="line"><a name="l14543"></a><span class="lineno">14543</span>&#160;            <span class="comment">/* Easier storage of the metric terms in this integration point. */</span></div>
<div class="line"><a name="l14544"></a><span class="lineno">14544</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l14545"></a><span class="lineno">14545</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l14546"></a><span class="lineno">14546</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = metricTerms[2];</div>
<div class="line"><a name="l14547"></a><span class="lineno">14547</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = metricTerms[3];</div>
<div class="line"><a name="l14548"></a><span class="lineno">14548</span>&#160; </div>
<div class="line"><a name="l14549"></a><span class="lineno">14549</span>&#160;            <span class="comment">/* Compute the Cartesian gradients of the left solution. */</span></div>
<div class="line"><a name="l14550"></a><span class="lineno">14550</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ULGradCart[4][2];</div>
<div class="line"><a name="l14551"></a><span class="lineno">14551</span>&#160;            ULGradCart[0][0] = dULDr[0]*drdx + dULDs[0]*dsdx;</div>
<div class="line"><a name="l14552"></a><span class="lineno">14552</span>&#160;            ULGradCart[1][0] = dULDr[1]*drdx + dULDs[1]*dsdx;</div>
<div class="line"><a name="l14553"></a><span class="lineno">14553</span>&#160;            ULGradCart[2][0] = dULDr[2]*drdx + dULDs[2]*dsdx;</div>
<div class="line"><a name="l14554"></a><span class="lineno">14554</span>&#160;            ULGradCart[3][0] = dULDr[3]*drdx + dULDs[3]*dsdx;</div>
<div class="line"><a name="l14555"></a><span class="lineno">14555</span>&#160; </div>
<div class="line"><a name="l14556"></a><span class="lineno">14556</span>&#160;            ULGradCart[0][1] = dULDr[0]*drdy + dULDs[0]*dsdy;</div>
<div class="line"><a name="l14557"></a><span class="lineno">14557</span>&#160;            ULGradCart[1][1] = dULDr[1]*drdy + dULDs[1]*dsdy;</div>
<div class="line"><a name="l14558"></a><span class="lineno">14558</span>&#160;            ULGradCart[2][1] = dULDr[2]*drdy + dULDs[2]*dsdy;</div>
<div class="line"><a name="l14559"></a><span class="lineno">14559</span>&#160;            ULGradCart[3][1] = dULDr[3]*drdy + dULDs[3]*dsdy;</div>
<div class="line"><a name="l14560"></a><span class="lineno">14560</span>&#160; </div>
<div class="line"><a name="l14561"></a><span class="lineno">14561</span>&#160;            <span class="comment">/* Determine the normal gradients of all variables. */</span></div>
<div class="line"><a name="l14562"></a><span class="lineno">14562</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ULGradNorm[4];</div>
<div class="line"><a name="l14563"></a><span class="lineno">14563</span>&#160;            ULGradNorm[0] = ULGradCart[0][0]*normals[0] + ULGradCart[0][1]*normals[1];</div>
<div class="line"><a name="l14564"></a><span class="lineno">14564</span>&#160;            ULGradNorm[1] = ULGradCart[1][0]*normals[0] + ULGradCart[1][1]*normals[1];</div>
<div class="line"><a name="l14565"></a><span class="lineno">14565</span>&#160;            ULGradNorm[2] = ULGradCart[2][0]*normals[0] + ULGradCart[2][1]*normals[1];</div>
<div class="line"><a name="l14566"></a><span class="lineno">14566</span>&#160;            ULGradNorm[3] = ULGradCart[3][0]*normals[0] + ULGradCart[3][1]*normals[1];</div>
<div class="line"><a name="l14567"></a><span class="lineno">14567</span>&#160; </div>
<div class="line"><a name="l14568"></a><span class="lineno">14568</span>&#160;            <span class="comment">/* For the construction of the gradients of the right solution, also</span></div>
<div class="line"><a name="l14569"></a><span class="lineno">14569</span>&#160;<span class="comment">               the Cartesian gradients and the normal gradient of the normal</span></div>
<div class="line"><a name="l14570"></a><span class="lineno">14570</span>&#160;<span class="comment">               momentum is needed. This is computed below. */</span></div>
<div class="line"><a name="l14571"></a><span class="lineno">14571</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> GradCartNormMomL[2];</div>
<div class="line"><a name="l14572"></a><span class="lineno">14572</span>&#160;            GradCartNormMomL[0] = ULGradCart[1][0]*normals[0] + ULGradCart[2][0]*normals[1];</div>
<div class="line"><a name="l14573"></a><span class="lineno">14573</span>&#160;            GradCartNormMomL[1] = ULGradCart[1][1]*normals[0] + ULGradCart[2][1]*normals[1];</div>
<div class="line"><a name="l14574"></a><span class="lineno">14574</span>&#160; </div>
<div class="line"><a name="l14575"></a><span class="lineno">14575</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> GradNormNormMomL = ULGradNorm[1]*normals[0] + ULGradNorm[2]*normals[1];</div>
<div class="line"><a name="l14576"></a><span class="lineno">14576</span>&#160; </div>
<div class="line"><a name="l14577"></a><span class="lineno">14577</span>&#160;            <span class="comment">/* Abbreviate twice the normal vector. */</span></div>
<div class="line"><a name="l14578"></a><span class="lineno">14578</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tnx = 2.0*normals[0], tny = 2.0*normals[1];</div>
<div class="line"><a name="l14579"></a><span class="lineno">14579</span>&#160; </div>
<div class="line"><a name="l14580"></a><span class="lineno">14580</span>&#160;            <span class="comment">/*--- Construct the gradients of the right solution. The tangential</span></div>
<div class="line"><a name="l14581"></a><span class="lineno">14581</span>&#160;<span class="comment">                  gradients of the normal momentum and normal gradients of the other</span></div>
<div class="line"><a name="l14582"></a><span class="lineno">14582</span>&#160;<span class="comment">                  variables, density, energy and tangential momentum, must be negated.</span></div>
<div class="line"><a name="l14583"></a><span class="lineno">14583</span>&#160;<span class="comment">                  For the common situation that the symmetry plane coincides with an</span></div>
<div class="line"><a name="l14584"></a><span class="lineno">14584</span>&#160;<span class="comment">                  x- or y-plane this boils down to a multiplication by -1 or +1,</span></div>
<div class="line"><a name="l14585"></a><span class="lineno">14585</span>&#160;<span class="comment">                  depending on the variable and gradient. However, the implementation</span></div>
<div class="line"><a name="l14586"></a><span class="lineno">14586</span>&#160;<span class="comment">                  below is valid for an arbitrary orientation of the symmetry plane. ---*/</span></div>
<div class="line"><a name="l14587"></a><span class="lineno">14587</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> URGradCart[4][2];</div>
<div class="line"><a name="l14588"></a><span class="lineno">14588</span>&#160;            URGradCart[0][0] = ULGradCart[0][0] - tnx*ULGradNorm[0];</div>
<div class="line"><a name="l14589"></a><span class="lineno">14589</span>&#160;            URGradCart[1][0] = ULGradCart[1][0] - tnx*ULGradNorm[1] - tnx*GradCartNormMomL[0] + tnx*tnx*GradNormNormMomL;</div>
<div class="line"><a name="l14590"></a><span class="lineno">14590</span>&#160;            URGradCart[2][0] = ULGradCart[2][0] - tnx*ULGradNorm[2] - tny*GradCartNormMomL[0] + tnx*tny*GradNormNormMomL;</div>
<div class="line"><a name="l14591"></a><span class="lineno">14591</span>&#160;            URGradCart[3][0] = ULGradCart[3][0] - tnx*ULGradNorm[3];</div>
<div class="line"><a name="l14592"></a><span class="lineno">14592</span>&#160; </div>
<div class="line"><a name="l14593"></a><span class="lineno">14593</span>&#160;            URGradCart[0][1] = ULGradCart[0][1] - tny*ULGradNorm[0];</div>
<div class="line"><a name="l14594"></a><span class="lineno">14594</span>&#160;            URGradCart[1][1] = ULGradCart[1][1] - tny*ULGradNorm[1] - tnx*GradCartNormMomL[1] + tny*tnx*GradNormNormMomL;</div>
<div class="line"><a name="l14595"></a><span class="lineno">14595</span>&#160;            URGradCart[2][1] = ULGradCart[2][1] - tny*ULGradNorm[2] - tny*GradCartNormMomL[1] + tny*tny*GradNormNormMomL;</div>
<div class="line"><a name="l14596"></a><span class="lineno">14596</span>&#160;            URGradCart[3][1] = ULGradCart[3][1] - tny*ULGradNorm[3];</div>
<div class="line"><a name="l14597"></a><span class="lineno">14597</span>&#160; </div>
<div class="line"><a name="l14598"></a><span class="lineno">14598</span>&#160;            <span class="comment">/*--- Compute the viscous fluxes of the left and right state and average</span></div>
<div class="line"><a name="l14599"></a><span class="lineno">14599</span>&#160;<span class="comment">                  them to compute the correct viscous flux for a symmetry boundary. ---*/</span></div>
<div class="line"><a name="l14600"></a><span class="lineno">14600</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wallDist = wallDistance ? wallDistance[i] : 0.0;</div>
<div class="line"><a name="l14601"></a><span class="lineno">14601</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> viscFluxL[4], viscFluxR[4];</div>
<div class="line"><a name="l14602"></a><span class="lineno">14602</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Viscosity, kOverCv;</div>
<div class="line"><a name="l14603"></a><span class="lineno">14603</span>&#160; </div>
<div class="line"><a name="l14604"></a><span class="lineno">14604</span>&#160;            ViscousNormalFluxIntegrationPoint_2D(UR, URGradCart, normals, 0.0, 1.0,</div>
<div class="line"><a name="l14605"></a><span class="lineno">14605</span>&#160;                                                 wallDist, lenScale_LES, Viscosity,</div>
<div class="line"><a name="l14606"></a><span class="lineno">14606</span>&#160;                                                 kOverCv, viscFluxR);</div>
<div class="line"><a name="l14607"></a><span class="lineno">14607</span>&#160;            ViscousNormalFluxIntegrationPoint_2D(UL, ULGradCart, normals, 0.0, 1.0,</div>
<div class="line"><a name="l14608"></a><span class="lineno">14608</span>&#160;                                                 wallDist, lenScale_LES, Viscosity,</div>
<div class="line"><a name="l14609"></a><span class="lineno">14609</span>&#160;                                                 kOverCv, viscFluxL);</div>
<div class="line"><a name="l14610"></a><span class="lineno">14610</span>&#160;            viscosityInt[nInt*llRel+i] = Viscosity;</div>
<div class="line"><a name="l14611"></a><span class="lineno">14611</span>&#160;            kOverCvInt[nInt*llRel+i]   = kOverCv;</div>
<div class="line"><a name="l14612"></a><span class="lineno">14612</span>&#160; </div>
<div class="line"><a name="l14613"></a><span class="lineno">14613</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *viscNormalFlux = viscFluxes + pointerOffset;</div>
<div class="line"><a name="l14614"></a><span class="lineno">14614</span>&#160;            viscNormalFlux[0] = 0.5*(viscFluxL[0] + viscFluxR[0]);</div>
<div class="line"><a name="l14615"></a><span class="lineno">14615</span>&#160;            viscNormalFlux[1] = 0.5*(viscFluxL[1] + viscFluxR[1]);</div>
<div class="line"><a name="l14616"></a><span class="lineno">14616</span>&#160;            viscNormalFlux[2] = 0.5*(viscFluxL[2] + viscFluxR[2]);</div>
<div class="line"><a name="l14617"></a><span class="lineno">14617</span>&#160;            viscNormalFlux[3] = 0.5*(viscFluxL[3] + viscFluxR[3]);</div>
<div class="line"><a name="l14618"></a><span class="lineno">14618</span>&#160;          }</div>
<div class="line"><a name="l14619"></a><span class="lineno">14619</span>&#160; </div>
<div class="line"><a name="l14620"></a><span class="lineno">14620</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14621"></a><span class="lineno">14621</span>&#160;        }</div>
<div class="line"><a name="l14622"></a><span class="lineno">14622</span>&#160; </div>
<div class="line"><a name="l14623"></a><span class="lineno">14623</span>&#160;        <span class="comment">/*--------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l14624"></a><span class="lineno">14624</span>&#160; </div>
<div class="line"><a name="l14625"></a><span class="lineno">14625</span>&#160;        <span class="keywordflow">case</span> 3: {</div>
<div class="line"><a name="l14626"></a><span class="lineno">14626</span>&#160; </div>
<div class="line"><a name="l14627"></a><span class="lineno">14627</span>&#160;          <span class="comment">/*--- 3D simulation. Loop over the integration points to apply the</span></div>
<div class="line"><a name="l14628"></a><span class="lineno">14628</span>&#160;<span class="comment">                symmetry condition and to compute the viscous normal fluxes. This</span></div>
<div class="line"><a name="l14629"></a><span class="lineno">14629</span>&#160;<span class="comment">                is done in the same loop, because the gradients in the right</span></div>
<div class="line"><a name="l14630"></a><span class="lineno">14630</span>&#160;<span class="comment">                integration points are constructed using the symmetry boundary</span></div>
<div class="line"><a name="l14631"></a><span class="lineno">14631</span>&#160;<span class="comment">                condition. ---*/</span></div>
<div class="line"><a name="l14632"></a><span class="lineno">14632</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l14633"></a><span class="lineno">14633</span>&#160; </div>
<div class="line"><a name="l14634"></a><span class="lineno">14634</span>&#160;            <span class="comment">/* Easier storage of the left and right solution and the normals</span></div>
<div class="line"><a name="l14635"></a><span class="lineno">14635</span>&#160;<span class="comment">               for this integration point. */</span></div>
<div class="line"><a name="l14636"></a><span class="lineno">14636</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> pointerOffset = NPad*i + llNVar;</div>
<div class="line"><a name="l14637"></a><span class="lineno">14637</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solIntL + pointerOffset;</div>
<div class="line"><a name="l14638"></a><span class="lineno">14638</span>&#160;                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solIntR + pointerOffset;</div>
<div class="line"><a name="l14639"></a><span class="lineno">14639</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[ll].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + i*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l14640"></a><span class="lineno">14640</span>&#160; </div>
<div class="line"><a name="l14641"></a><span class="lineno">14641</span>&#160;            <span class="comment">/* Compute twice the normal component of the momentum variables. The</span></div>
<div class="line"><a name="l14642"></a><span class="lineno">14642</span>&#160;<span class="comment">               factor 2 comes from the fact that the velocity must be mirrored. */</span></div>
<div class="line"><a name="l14643"></a><span class="lineno">14643</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rVn = 2.0*(UL[1]*normals[0] + UL[2]*normals[1] + UL[3]*normals[2]);</div>
<div class="line"><a name="l14644"></a><span class="lineno">14644</span>&#160; </div>
<div class="line"><a name="l14645"></a><span class="lineno">14645</span>&#160;            <span class="comment">/* Set the right state. Note that the total energy of the right state is</span></div>
<div class="line"><a name="l14646"></a><span class="lineno">14646</span>&#160;<span class="comment">               identical to the left state, because the magnitude of the velocity</span></div>
<div class="line"><a name="l14647"></a><span class="lineno">14647</span>&#160;<span class="comment">               remains the same. */</span></div>
<div class="line"><a name="l14648"></a><span class="lineno">14648</span>&#160;            UR[0] = UL[0];</div>
<div class="line"><a name="l14649"></a><span class="lineno">14649</span>&#160;            UR[1] = UL[1] - rVn*normals[0];</div>
<div class="line"><a name="l14650"></a><span class="lineno">14650</span>&#160;            UR[2] = UL[2] - rVn*normals[1];</div>
<div class="line"><a name="l14651"></a><span class="lineno">14651</span>&#160;            UR[3] = UL[3] - rVn*normals[2];</div>
<div class="line"><a name="l14652"></a><span class="lineno">14652</span>&#160;            UR[4] = UL[4];</div>
<div class="line"><a name="l14653"></a><span class="lineno">14653</span>&#160; </div>
<div class="line"><a name="l14654"></a><span class="lineno">14654</span>&#160;            <span class="comment">/* Easier storage of the metric terms and left gradients of this</span></div>
<div class="line"><a name="l14655"></a><span class="lineno">14655</span>&#160;<span class="comment">               integration point. */</span></div>
<div class="line"><a name="l14656"></a><span class="lineno">14656</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *metricTerms = surfElem[ll].<a class="code" href="class_c_surface_element_f_e_m.html#a49f9ee99ed3a8a6c5c895050f29169d8">metricCoorDerivFace</a>.data()</div>
<div class="line"><a name="l14657"></a><span class="lineno">14657</span>&#160;                                         + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l14658"></a><span class="lineno">14658</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dULDr       = gradSolInt + pointerOffset;</div>
<div class="line"><a name="l14659"></a><span class="lineno">14659</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dULDs       = dULDr + offDeriv;</div>
<div class="line"><a name="l14660"></a><span class="lineno">14660</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *dULDt       = dULDs + offDeriv;</div>
<div class="line"><a name="l14661"></a><span class="lineno">14661</span>&#160; </div>
<div class="line"><a name="l14662"></a><span class="lineno">14662</span>&#160;            <span class="comment">/* Easier storage of the metric terms in this integration point. */</span></div>
<div class="line"><a name="l14663"></a><span class="lineno">14663</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdx = metricTerms[0];</div>
<div class="line"><a name="l14664"></a><span class="lineno">14664</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdy = metricTerms[1];</div>
<div class="line"><a name="l14665"></a><span class="lineno">14665</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> drdz = metricTerms[2];</div>
<div class="line"><a name="l14666"></a><span class="lineno">14666</span>&#160; </div>
<div class="line"><a name="l14667"></a><span class="lineno">14667</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdx = metricTerms[3];</div>
<div class="line"><a name="l14668"></a><span class="lineno">14668</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdy = metricTerms[4];</div>
<div class="line"><a name="l14669"></a><span class="lineno">14669</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dsdz = metricTerms[5];</div>
<div class="line"><a name="l14670"></a><span class="lineno">14670</span>&#160; </div>
<div class="line"><a name="l14671"></a><span class="lineno">14671</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdx = metricTerms[6];</div>
<div class="line"><a name="l14672"></a><span class="lineno">14672</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdy = metricTerms[7];</div>
<div class="line"><a name="l14673"></a><span class="lineno">14673</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dtdz = metricTerms[8];</div>
<div class="line"><a name="l14674"></a><span class="lineno">14674</span>&#160; </div>
<div class="line"><a name="l14675"></a><span class="lineno">14675</span>&#160;            <span class="comment">/* Compute the Cartesian gradients of the left solution. */</span></div>
<div class="line"><a name="l14676"></a><span class="lineno">14676</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ULGradCart[5][3];</div>
<div class="line"><a name="l14677"></a><span class="lineno">14677</span>&#160;            ULGradCart[0][0] = dULDr[0]*drdx + dULDs[0]*dsdx + dULDt[0]*dtdx;</div>
<div class="line"><a name="l14678"></a><span class="lineno">14678</span>&#160;            ULGradCart[1][0] = dULDr[1]*drdx + dULDs[1]*dsdx + dULDt[1]*dtdx;</div>
<div class="line"><a name="l14679"></a><span class="lineno">14679</span>&#160;            ULGradCart[2][0] = dULDr[2]*drdx + dULDs[2]*dsdx + dULDt[2]*dtdx;</div>
<div class="line"><a name="l14680"></a><span class="lineno">14680</span>&#160;            ULGradCart[3][0] = dULDr[3]*drdx + dULDs[3]*dsdx + dULDt[3]*dtdx;</div>
<div class="line"><a name="l14681"></a><span class="lineno">14681</span>&#160;            ULGradCart[4][0] = dULDr[4]*drdx + dULDs[4]*dsdx + dULDt[4]*dtdx;</div>
<div class="line"><a name="l14682"></a><span class="lineno">14682</span>&#160; </div>
<div class="line"><a name="l14683"></a><span class="lineno">14683</span>&#160;            ULGradCart[0][1] = dULDr[0]*drdy + dULDs[0]*dsdy + dULDt[0]*dtdy;</div>
<div class="line"><a name="l14684"></a><span class="lineno">14684</span>&#160;            ULGradCart[1][1] = dULDr[1]*drdy + dULDs[1]*dsdy + dULDt[1]*dtdy;</div>
<div class="line"><a name="l14685"></a><span class="lineno">14685</span>&#160;            ULGradCart[2][1] = dULDr[2]*drdy + dULDs[2]*dsdy + dULDt[2]*dtdy;</div>
<div class="line"><a name="l14686"></a><span class="lineno">14686</span>&#160;            ULGradCart[3][1] = dULDr[3]*drdy + dULDs[3]*dsdy + dULDt[3]*dtdy;</div>
<div class="line"><a name="l14687"></a><span class="lineno">14687</span>&#160;            ULGradCart[4][1] = dULDr[4]*drdy + dULDs[4]*dsdy + dULDt[4]*dtdy;</div>
<div class="line"><a name="l14688"></a><span class="lineno">14688</span>&#160; </div>
<div class="line"><a name="l14689"></a><span class="lineno">14689</span>&#160;            ULGradCart[0][2] = dULDr[0]*drdz + dULDs[0]*dsdz + dULDt[0]*dtdz;</div>
<div class="line"><a name="l14690"></a><span class="lineno">14690</span>&#160;            ULGradCart[1][2] = dULDr[1]*drdz + dULDs[1]*dsdz + dULDt[1]*dtdz;</div>
<div class="line"><a name="l14691"></a><span class="lineno">14691</span>&#160;            ULGradCart[2][2] = dULDr[2]*drdz + dULDs[2]*dsdz + dULDt[2]*dtdz;</div>
<div class="line"><a name="l14692"></a><span class="lineno">14692</span>&#160;            ULGradCart[3][2] = dULDr[3]*drdz + dULDs[3]*dsdz + dULDt[3]*dtdz;</div>
<div class="line"><a name="l14693"></a><span class="lineno">14693</span>&#160;            ULGradCart[4][2] = dULDr[4]*drdz + dULDs[4]*dsdz + dULDt[4]*dtdz;</div>
<div class="line"><a name="l14694"></a><span class="lineno">14694</span>&#160; </div>
<div class="line"><a name="l14695"></a><span class="lineno">14695</span>&#160;            <span class="comment">/* Determine the normal gradients of all variables. */</span></div>
<div class="line"><a name="l14696"></a><span class="lineno">14696</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> ULGradNorm[5];</div>
<div class="line"><a name="l14697"></a><span class="lineno">14697</span>&#160;            ULGradNorm[0] = ULGradCart[0][0]*normals[0] + ULGradCart[0][1]*normals[1] + ULGradCart[0][2]*normals[2];</div>
<div class="line"><a name="l14698"></a><span class="lineno">14698</span>&#160;            ULGradNorm[1] = ULGradCart[1][0]*normals[0] + ULGradCart[1][1]*normals[1] + ULGradCart[1][2]*normals[2];</div>
<div class="line"><a name="l14699"></a><span class="lineno">14699</span>&#160;            ULGradNorm[2] = ULGradCart[2][0]*normals[0] + ULGradCart[2][1]*normals[1] + ULGradCart[2][2]*normals[2];</div>
<div class="line"><a name="l14700"></a><span class="lineno">14700</span>&#160;            ULGradNorm[3] = ULGradCart[3][0]*normals[0] + ULGradCart[3][1]*normals[1] + ULGradCart[3][2]*normals[2];</div>
<div class="line"><a name="l14701"></a><span class="lineno">14701</span>&#160;            ULGradNorm[4] = ULGradCart[4][0]*normals[0] + ULGradCart[4][1]*normals[1] + ULGradCart[4][2]*normals[2];</div>
<div class="line"><a name="l14702"></a><span class="lineno">14702</span>&#160; </div>
<div class="line"><a name="l14703"></a><span class="lineno">14703</span>&#160;            <span class="comment">/* For the construction of the gradients of the right solution, also</span></div>
<div class="line"><a name="l14704"></a><span class="lineno">14704</span>&#160;<span class="comment">               the Cartesian gradients and the normal gradient of the normal</span></div>
<div class="line"><a name="l14705"></a><span class="lineno">14705</span>&#160;<span class="comment">               momentum is needed. This is computed below. */</span></div>
<div class="line"><a name="l14706"></a><span class="lineno">14706</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> GradCartNormMomL[3];</div>
<div class="line"><a name="l14707"></a><span class="lineno">14707</span>&#160;            GradCartNormMomL[0] = ULGradCart[1][0]*normals[0] + ULGradCart[2][0]*normals[1] + ULGradCart[3][0]*normals[2];</div>
<div class="line"><a name="l14708"></a><span class="lineno">14708</span>&#160;            GradCartNormMomL[1] = ULGradCart[1][1]*normals[0] + ULGradCart[2][1]*normals[1] + ULGradCart[3][1]*normals[2];</div>
<div class="line"><a name="l14709"></a><span class="lineno">14709</span>&#160;            GradCartNormMomL[2] = ULGradCart[1][2]*normals[0] + ULGradCart[2][2]*normals[1] + ULGradCart[3][2]*normals[2];</div>
<div class="line"><a name="l14710"></a><span class="lineno">14710</span>&#160; </div>
<div class="line"><a name="l14711"></a><span class="lineno">14711</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> GradNormNormMomL = ULGradNorm[1]*normals[0]</div>
<div class="line"><a name="l14712"></a><span class="lineno">14712</span>&#160;                                             + ULGradNorm[2]*normals[1]</div>
<div class="line"><a name="l14713"></a><span class="lineno">14713</span>&#160;                                             + ULGradNorm[3]*normals[2];</div>
<div class="line"><a name="l14714"></a><span class="lineno">14714</span>&#160; </div>
<div class="line"><a name="l14715"></a><span class="lineno">14715</span>&#160;            <span class="comment">/* Abbreviate twice the normal vector. */</span></div>
<div class="line"><a name="l14716"></a><span class="lineno">14716</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tnx = 2.0*normals[0], tny = 2.0*normals[1], tnz = 2.0*normals[2];</div>
<div class="line"><a name="l14717"></a><span class="lineno">14717</span>&#160; </div>
<div class="line"><a name="l14718"></a><span class="lineno">14718</span>&#160;            <span class="comment">/*--- Construct the gradients of the right solution. The tangential</span></div>
<div class="line"><a name="l14719"></a><span class="lineno">14719</span>&#160;<span class="comment">                  gradients of the normal momentum and normal gradients of the other</span></div>
<div class="line"><a name="l14720"></a><span class="lineno">14720</span>&#160;<span class="comment">                  variables, density, energy and tangential momentum, must be negated.</span></div>
<div class="line"><a name="l14721"></a><span class="lineno">14721</span>&#160;<span class="comment">                  For the common situation that the symmetry plane coincides with an</span></div>
<div class="line"><a name="l14722"></a><span class="lineno">14722</span>&#160;<span class="comment">                  x-, y- or z-plane this boils down to a multiplication by -1 or +1,</span></div>
<div class="line"><a name="l14723"></a><span class="lineno">14723</span>&#160;<span class="comment">                  depending on the variable and gradient. However, the implementation</span></div>
<div class="line"><a name="l14724"></a><span class="lineno">14724</span>&#160;<span class="comment">                  below is valid for an arbitrary orientation of the symmetry plane. ---*/</span></div>
<div class="line"><a name="l14725"></a><span class="lineno">14725</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> URGradCart[5][3];</div>
<div class="line"><a name="l14726"></a><span class="lineno">14726</span>&#160;            URGradCart[0][0] = ULGradCart[0][0] - tnx*ULGradNorm[0];</div>
<div class="line"><a name="l14727"></a><span class="lineno">14727</span>&#160;            URGradCart[1][0] = ULGradCart[1][0] - tnx*ULGradNorm[1] - tnx*GradCartNormMomL[0] + tnx*tnx*GradNormNormMomL;</div>
<div class="line"><a name="l14728"></a><span class="lineno">14728</span>&#160;            URGradCart[2][0] = ULGradCart[2][0] - tnx*ULGradNorm[2] - tny*GradCartNormMomL[0] + tnx*tny*GradNormNormMomL;</div>
<div class="line"><a name="l14729"></a><span class="lineno">14729</span>&#160;            URGradCart[3][0] = ULGradCart[3][0] - tnx*ULGradNorm[3] - tnz*GradCartNormMomL[0] + tnx*tnz*GradNormNormMomL;</div>
<div class="line"><a name="l14730"></a><span class="lineno">14730</span>&#160;            URGradCart[4][0] = ULGradCart[4][0] - tnx*ULGradNorm[4];</div>
<div class="line"><a name="l14731"></a><span class="lineno">14731</span>&#160; </div>
<div class="line"><a name="l14732"></a><span class="lineno">14732</span>&#160;            URGradCart[0][1] = ULGradCart[0][1] - tny*ULGradNorm[0];</div>
<div class="line"><a name="l14733"></a><span class="lineno">14733</span>&#160;            URGradCart[1][1] = ULGradCart[1][1] - tny*ULGradNorm[1] - tnx*GradCartNormMomL[1] + tny*tnx*GradNormNormMomL;</div>
<div class="line"><a name="l14734"></a><span class="lineno">14734</span>&#160;            URGradCart[2][1] = ULGradCart[2][1] - tny*ULGradNorm[2] - tny*GradCartNormMomL[1] + tny*tny*GradNormNormMomL;</div>
<div class="line"><a name="l14735"></a><span class="lineno">14735</span>&#160;            URGradCart[3][1] = ULGradCart[3][1] - tny*ULGradNorm[3] - tnz*GradCartNormMomL[1] + tny*tnz*GradNormNormMomL;</div>
<div class="line"><a name="l14736"></a><span class="lineno">14736</span>&#160;            URGradCart[4][1] = ULGradCart[4][1] - tny*ULGradNorm[4];</div>
<div class="line"><a name="l14737"></a><span class="lineno">14737</span>&#160; </div>
<div class="line"><a name="l14738"></a><span class="lineno">14738</span>&#160;            URGradCart[0][2] = ULGradCart[0][2] - tnz*ULGradNorm[0];</div>
<div class="line"><a name="l14739"></a><span class="lineno">14739</span>&#160;            URGradCart[1][2] = ULGradCart[1][2] - tnz*ULGradNorm[1] - tnx*GradCartNormMomL[2] + tnz*tnx*GradNormNormMomL;</div>
<div class="line"><a name="l14740"></a><span class="lineno">14740</span>&#160;            URGradCart[2][2] = ULGradCart[2][2] - tnz*ULGradNorm[2] - tny*GradCartNormMomL[2] + tnz*tny*GradNormNormMomL;</div>
<div class="line"><a name="l14741"></a><span class="lineno">14741</span>&#160;            URGradCart[3][2] = ULGradCart[3][2] - tnz*ULGradNorm[3] - tnz*GradCartNormMomL[2] + tnz*tnz*GradNormNormMomL;</div>
<div class="line"><a name="l14742"></a><span class="lineno">14742</span>&#160;            URGradCart[4][2] = ULGradCart[4][2] - tnz*ULGradNorm[4];</div>
<div class="line"><a name="l14743"></a><span class="lineno">14743</span>&#160; </div>
<div class="line"><a name="l14744"></a><span class="lineno">14744</span>&#160;            <span class="comment">/*--- Compute the viscous fluxes of the left and right state and average</span></div>
<div class="line"><a name="l14745"></a><span class="lineno">14745</span>&#160;<span class="comment">                  them to compute the correct viscous flux for a symmetry boundary. ---*/</span></div>
<div class="line"><a name="l14746"></a><span class="lineno">14746</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> wallDist = wallDistance ? wallDistance[i] : 0.0;</div>
<div class="line"><a name="l14747"></a><span class="lineno">14747</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> viscFluxL[5], viscFluxR[5];</div>
<div class="line"><a name="l14748"></a><span class="lineno">14748</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Viscosity, kOverCv;</div>
<div class="line"><a name="l14749"></a><span class="lineno">14749</span>&#160; </div>
<div class="line"><a name="l14750"></a><span class="lineno">14750</span>&#160;            ViscousNormalFluxIntegrationPoint_3D(UR, URGradCart, normals, 0.0, 1.0,</div>
<div class="line"><a name="l14751"></a><span class="lineno">14751</span>&#160;                                                 wallDist, lenScale_LES, Viscosity,</div>
<div class="line"><a name="l14752"></a><span class="lineno">14752</span>&#160;                                                 kOverCv, viscFluxR);</div>
<div class="line"><a name="l14753"></a><span class="lineno">14753</span>&#160;            ViscousNormalFluxIntegrationPoint_3D(UL, ULGradCart, normals, 0.0, 1.0,</div>
<div class="line"><a name="l14754"></a><span class="lineno">14754</span>&#160;                                                 wallDist, lenScale_LES, Viscosity,</div>
<div class="line"><a name="l14755"></a><span class="lineno">14755</span>&#160;                                                 kOverCv, viscFluxL);</div>
<div class="line"><a name="l14756"></a><span class="lineno">14756</span>&#160;            viscosityInt[nInt*llRel+i] = Viscosity;</div>
<div class="line"><a name="l14757"></a><span class="lineno">14757</span>&#160;            kOverCvInt[nInt*llRel+i]   = kOverCv;</div>
<div class="line"><a name="l14758"></a><span class="lineno">14758</span>&#160; </div>
<div class="line"><a name="l14759"></a><span class="lineno">14759</span>&#160;            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *viscNormalFlux = viscFluxes + pointerOffset;</div>
<div class="line"><a name="l14760"></a><span class="lineno">14760</span>&#160;            viscNormalFlux[0] = 0.5*(viscFluxL[0] + viscFluxR[0]);</div>
<div class="line"><a name="l14761"></a><span class="lineno">14761</span>&#160;            viscNormalFlux[1] = 0.5*(viscFluxL[1] + viscFluxR[1]);</div>
<div class="line"><a name="l14762"></a><span class="lineno">14762</span>&#160;            viscNormalFlux[2] = 0.5*(viscFluxL[2] + viscFluxR[2]);</div>
<div class="line"><a name="l14763"></a><span class="lineno">14763</span>&#160;            viscNormalFlux[3] = 0.5*(viscFluxL[3] + viscFluxR[3]);</div>
<div class="line"><a name="l14764"></a><span class="lineno">14764</span>&#160;            viscNormalFlux[4] = 0.5*(viscFluxL[4] + viscFluxR[4]);</div>
<div class="line"><a name="l14765"></a><span class="lineno">14765</span>&#160;          }</div>
<div class="line"><a name="l14766"></a><span class="lineno">14766</span>&#160; </div>
<div class="line"><a name="l14767"></a><span class="lineno">14767</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l14768"></a><span class="lineno">14768</span>&#160;        }</div>
<div class="line"><a name="l14769"></a><span class="lineno">14769</span>&#160;      }</div>
<div class="line"><a name="l14770"></a><span class="lineno">14770</span>&#160;    }</div>
<div class="line"><a name="l14771"></a><span class="lineno">14771</span>&#160; </div>
<div class="line"><a name="l14772"></a><span class="lineno">14772</span>&#160;    <span class="comment">/* The remainder of the boundary condition treatment is the same for all</span></div>
<div class="line"><a name="l14773"></a><span class="lineno">14773</span>&#160;<span class="comment">       types of boundary conditions, including the symmetry plane. The function</span></div>
<div class="line"><a name="l14774"></a><span class="lineno">14774</span>&#160;<span class="comment">       ResidualViscousBoundaryFace will carry out this task. */</span></div>
<div class="line"><a name="l14775"></a><span class="lineno">14775</span>&#160;    ResidualViscousBoundaryFace(config, conv_numerics, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l14776"></a><span class="lineno">14776</span>&#160;                                solIntL, solIntR, gradSolInt, fluxes, viscFluxes,</div>
<div class="line"><a name="l14777"></a><span class="lineno">14777</span>&#160;                                viscosityInt, kOverCvInt, resFaces, indResFaces);</div>
<div class="line"><a name="l14778"></a><span class="lineno">14778</span>&#160; </div>
<div class="line"><a name="l14779"></a><span class="lineno">14779</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l14780"></a><span class="lineno">14780</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l14781"></a><span class="lineno">14781</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l14782"></a><span class="lineno">14782</span>&#160;  }</div>
<div class="line"><a name="l14783"></a><span class="lineno">14783</span>&#160;}</div>
<div class="line"><a name="l14784"></a><span class="lineno">14784</span>&#160; </div>
<div class="line"><a name="l14785"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a5559128bafcbb12f3f87601eca580ec5">14785</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a5559128bafcbb12f3f87601eca580ec5">CFEM_DG_NSSolver::BC_Supersonic_Outlet</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l14786"></a><span class="lineno">14786</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l14787"></a><span class="lineno">14787</span>&#160;                                            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l14788"></a><span class="lineno">14788</span>&#160;                                            <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l14789"></a><span class="lineno">14789</span>&#160;                                            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l14790"></a><span class="lineno">14790</span>&#160;                                            <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l14791"></a><span class="lineno">14791</span>&#160;                                            <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray){</div>
<div class="line"><a name="l14792"></a><span class="lineno">14792</span>&#160; </div>
<div class="line"><a name="l14793"></a><span class="lineno">14793</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l14794"></a><span class="lineno">14794</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l14795"></a><span class="lineno">14795</span>&#160; </div>
<div class="line"><a name="l14796"></a><span class="lineno">14796</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l14797"></a><span class="lineno">14797</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l14798"></a><span class="lineno">14798</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l14799"></a><span class="lineno">14799</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l14800"></a><span class="lineno">14800</span>&#160; </div>
<div class="line"><a name="l14801"></a><span class="lineno">14801</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l14802"></a><span class="lineno">14802</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l14803"></a><span class="lineno">14803</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l14804"></a><span class="lineno">14804</span>&#160; </div>
<div class="line"><a name="l14805"></a><span class="lineno">14805</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l14806"></a><span class="lineno">14806</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l14807"></a><span class="lineno">14807</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l14808"></a><span class="lineno">14808</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l14809"></a><span class="lineno">14809</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l14810"></a><span class="lineno">14810</span>&#160; </div>
<div class="line"><a name="l14811"></a><span class="lineno">14811</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l14812"></a><span class="lineno">14812</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l14813"></a><span class="lineno">14813</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l14814"></a><span class="lineno">14814</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l14815"></a><span class="lineno">14815</span>&#160; </div>
<div class="line"><a name="l14816"></a><span class="lineno">14816</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l14817"></a><span class="lineno">14817</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l14818"></a><span class="lineno">14818</span>&#160; </div>
<div class="line"><a name="l14819"></a><span class="lineno">14819</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l14820"></a><span class="lineno">14820</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l14821"></a><span class="lineno">14821</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l14822"></a><span class="lineno">14822</span>&#160; </div>
<div class="line"><a name="l14823"></a><span class="lineno">14823</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l14824"></a><span class="lineno">14824</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l14825"></a><span class="lineno">14825</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l14826"></a><span class="lineno">14826</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l14827"></a><span class="lineno">14827</span>&#160; </div>
<div class="line"><a name="l14828"></a><span class="lineno">14828</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l14829"></a><span class="lineno">14829</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l14830"></a><span class="lineno">14830</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l14831"></a><span class="lineno">14831</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l14832"></a><span class="lineno">14832</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l14833"></a><span class="lineno">14833</span>&#160; </div>
<div class="line"><a name="l14834"></a><span class="lineno">14834</span>&#160;    <span class="comment">/* Set the right state in the integration points to the left state, i.e.</span></div>
<div class="line"><a name="l14835"></a><span class="lineno">14835</span>&#160;<span class="comment">       no boundary condition is applied for a supersonic outlet. */</span></div>
<div class="line"><a name="l14836"></a><span class="lineno">14836</span>&#160;    memcpy(solIntR, solIntL, NPad*nInt*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>));</div>
<div class="line"><a name="l14837"></a><span class="lineno">14837</span>&#160; </div>
<div class="line"><a name="l14838"></a><span class="lineno">14838</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l14839"></a><span class="lineno">14839</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l14840"></a><span class="lineno">14840</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l14841"></a><span class="lineno">14841</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l14842"></a><span class="lineno">14842</span>&#160;                                    solIntL, solIntR, work, resFaces,</div>
<div class="line"><a name="l14843"></a><span class="lineno">14843</span>&#160;                                    indResFaces, NULL);</div>
<div class="line"><a name="l14844"></a><span class="lineno">14844</span>&#160; </div>
<div class="line"><a name="l14845"></a><span class="lineno">14845</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l14846"></a><span class="lineno">14846</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l14847"></a><span class="lineno">14847</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l14848"></a><span class="lineno">14848</span>&#160;  }</div>
<div class="line"><a name="l14849"></a><span class="lineno">14849</span>&#160;}</div>
<div class="line"><a name="l14850"></a><span class="lineno">14850</span>&#160; </div>
<div class="line"><a name="l14851"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a2865905d6ed26dcd2d2d850db9366d05">14851</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a2865905d6ed26dcd2d2d850db9366d05">CFEM_DG_NSSolver::BC_Inlet</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l14852"></a><span class="lineno">14852</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l14853"></a><span class="lineno">14853</span>&#160;                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l14854"></a><span class="lineno">14854</span>&#160;                                <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l14855"></a><span class="lineno">14855</span>&#160;                                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l14856"></a><span class="lineno">14856</span>&#160;                                <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l14857"></a><span class="lineno">14857</span>&#160;                                <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l14858"></a><span class="lineno">14858</span>&#160;                                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l14859"></a><span class="lineno">14859</span>&#160; </div>
<div class="line"><a name="l14860"></a><span class="lineno">14860</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l14861"></a><span class="lineno">14861</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l14862"></a><span class="lineno">14862</span>&#160; </div>
<div class="line"><a name="l14863"></a><span class="lineno">14863</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l14864"></a><span class="lineno">14864</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l14865"></a><span class="lineno">14865</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l14866"></a><span class="lineno">14866</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l14867"></a><span class="lineno">14867</span>&#160; </div>
<div class="line"><a name="l14868"></a><span class="lineno">14868</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l14869"></a><span class="lineno">14869</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l14870"></a><span class="lineno">14870</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l14871"></a><span class="lineno">14871</span>&#160; </div>
<div class="line"><a name="l14872"></a><span class="lineno">14872</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l14873"></a><span class="lineno">14873</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l14874"></a><span class="lineno">14874</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l14875"></a><span class="lineno">14875</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l14876"></a><span class="lineno">14876</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l14877"></a><span class="lineno">14877</span>&#160; </div>
<div class="line"><a name="l14878"></a><span class="lineno">14878</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l14879"></a><span class="lineno">14879</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l14880"></a><span class="lineno">14880</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l14881"></a><span class="lineno">14881</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l14882"></a><span class="lineno">14882</span>&#160; </div>
<div class="line"><a name="l14883"></a><span class="lineno">14883</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l14884"></a><span class="lineno">14884</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l14885"></a><span class="lineno">14885</span>&#160; </div>
<div class="line"><a name="l14886"></a><span class="lineno">14886</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l14887"></a><span class="lineno">14887</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l14888"></a><span class="lineno">14888</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l14889"></a><span class="lineno">14889</span>&#160; </div>
<div class="line"><a name="l14890"></a><span class="lineno">14890</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l14891"></a><span class="lineno">14891</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l14892"></a><span class="lineno">14892</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l14893"></a><span class="lineno">14893</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l14894"></a><span class="lineno">14894</span>&#160; </div>
<div class="line"><a name="l14895"></a><span class="lineno">14895</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l14896"></a><span class="lineno">14896</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l14897"></a><span class="lineno">14897</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l14898"></a><span class="lineno">14898</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l14899"></a><span class="lineno">14899</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l14900"></a><span class="lineno">14900</span>&#160; </div>
<div class="line"><a name="l14901"></a><span class="lineno">14901</span>&#160;    <span class="comment">/* Compute the right state by applying the subsonic inlet BC&#39;s. */</span></div>
<div class="line"><a name="l14902"></a><span class="lineno">14902</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#af993f01423bbb8e24b8c2bb565bf55eb">BoundaryStates_Inlet</a>(config, llEnd, NPad, &amp;surfElem[l], val_marker, solIntL, solIntR);</div>
<div class="line"><a name="l14903"></a><span class="lineno">14903</span>&#160; </div>
<div class="line"><a name="l14904"></a><span class="lineno">14904</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l14905"></a><span class="lineno">14905</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l14906"></a><span class="lineno">14906</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l14907"></a><span class="lineno">14907</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l14908"></a><span class="lineno">14908</span>&#160;                                    solIntL, solIntR, work, resFaces,</div>
<div class="line"><a name="l14909"></a><span class="lineno">14909</span>&#160;                                    indResFaces, NULL);</div>
<div class="line"><a name="l14910"></a><span class="lineno">14910</span>&#160; </div>
<div class="line"><a name="l14911"></a><span class="lineno">14911</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l14912"></a><span class="lineno">14912</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l14913"></a><span class="lineno">14913</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l14914"></a><span class="lineno">14914</span>&#160;  }</div>
<div class="line"><a name="l14915"></a><span class="lineno">14915</span>&#160;}</div>
<div class="line"><a name="l14916"></a><span class="lineno">14916</span>&#160; </div>
<div class="line"><a name="l14917"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#ae6136de48e182fc62658c9250e01c674">14917</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#ae6136de48e182fc62658c9250e01c674">CFEM_DG_NSSolver::BC_Outlet</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l14918"></a><span class="lineno">14918</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l14919"></a><span class="lineno">14919</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l14920"></a><span class="lineno">14920</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l14921"></a><span class="lineno">14921</span>&#160;                                 <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l14922"></a><span class="lineno">14922</span>&#160;                                 <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l14923"></a><span class="lineno">14923</span>&#160;                                 <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l14924"></a><span class="lineno">14924</span>&#160;                                 <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l14925"></a><span class="lineno">14925</span>&#160; </div>
<div class="line"><a name="l14926"></a><span class="lineno">14926</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l14927"></a><span class="lineno">14927</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l14928"></a><span class="lineno">14928</span>&#160; </div>
<div class="line"><a name="l14929"></a><span class="lineno">14929</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l14930"></a><span class="lineno">14930</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l14931"></a><span class="lineno">14931</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l14932"></a><span class="lineno">14932</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l14933"></a><span class="lineno">14933</span>&#160; </div>
<div class="line"><a name="l14934"></a><span class="lineno">14934</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l14935"></a><span class="lineno">14935</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l14936"></a><span class="lineno">14936</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l14937"></a><span class="lineno">14937</span>&#160; </div>
<div class="line"><a name="l14938"></a><span class="lineno">14938</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l14939"></a><span class="lineno">14939</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l14940"></a><span class="lineno">14940</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l14941"></a><span class="lineno">14941</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l14942"></a><span class="lineno">14942</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l14943"></a><span class="lineno">14943</span>&#160; </div>
<div class="line"><a name="l14944"></a><span class="lineno">14944</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l14945"></a><span class="lineno">14945</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l14946"></a><span class="lineno">14946</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l14947"></a><span class="lineno">14947</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l14948"></a><span class="lineno">14948</span>&#160; </div>
<div class="line"><a name="l14949"></a><span class="lineno">14949</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l14950"></a><span class="lineno">14950</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l14951"></a><span class="lineno">14951</span>&#160; </div>
<div class="line"><a name="l14952"></a><span class="lineno">14952</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l14953"></a><span class="lineno">14953</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l14954"></a><span class="lineno">14954</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l14955"></a><span class="lineno">14955</span>&#160; </div>
<div class="line"><a name="l14956"></a><span class="lineno">14956</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l14957"></a><span class="lineno">14957</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l14958"></a><span class="lineno">14958</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l14959"></a><span class="lineno">14959</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l14960"></a><span class="lineno">14960</span>&#160; </div>
<div class="line"><a name="l14961"></a><span class="lineno">14961</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l14962"></a><span class="lineno">14962</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l14963"></a><span class="lineno">14963</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l14964"></a><span class="lineno">14964</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l14965"></a><span class="lineno">14965</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l14966"></a><span class="lineno">14966</span>&#160; </div>
<div class="line"><a name="l14967"></a><span class="lineno">14967</span>&#160;    <span class="comment">/* Compute the right state by applying the subsonic outlet BC&#39;s. */</span></div>
<div class="line"><a name="l14968"></a><span class="lineno">14968</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a3233306f97b6173c5c109cae04a4c9be">BoundaryStates_Outlet</a>(config, llEnd, NPad, &amp;surfElem[l], val_marker, solIntL, solIntR);</div>
<div class="line"><a name="l14969"></a><span class="lineno">14969</span>&#160; </div>
<div class="line"><a name="l14970"></a><span class="lineno">14970</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l14971"></a><span class="lineno">14971</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l14972"></a><span class="lineno">14972</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l14973"></a><span class="lineno">14973</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l14974"></a><span class="lineno">14974</span>&#160;                                    solIntL, solIntR, work, resFaces,</div>
<div class="line"><a name="l14975"></a><span class="lineno">14975</span>&#160;                                    indResFaces, NULL);</div>
<div class="line"><a name="l14976"></a><span class="lineno">14976</span>&#160; </div>
<div class="line"><a name="l14977"></a><span class="lineno">14977</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l14978"></a><span class="lineno">14978</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l14979"></a><span class="lineno">14979</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l14980"></a><span class="lineno">14980</span>&#160;  }</div>
<div class="line"><a name="l14981"></a><span class="lineno">14981</span>&#160;}</div>
<div class="line"><a name="l14982"></a><span class="lineno">14982</span>&#160; </div>
<div class="line"><a name="l14983"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a7cc49cd695dcd974a1d791de72502323">14983</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a7cc49cd695dcd974a1d791de72502323">CFEM_DG_NSSolver::BC_HeatFlux_Wall</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l14984"></a><span class="lineno">14984</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l14985"></a><span class="lineno">14985</span>&#160;                                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l14986"></a><span class="lineno">14986</span>&#160;                                        <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l14987"></a><span class="lineno">14987</span>&#160;                                        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l14988"></a><span class="lineno">14988</span>&#160;                                        <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l14989"></a><span class="lineno">14989</span>&#160;                                        <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l14990"></a><span class="lineno">14990</span>&#160;                                        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l14991"></a><span class="lineno">14991</span>&#160; </div>
<div class="line"><a name="l14992"></a><span class="lineno">14992</span>&#160;  <span class="comment">/* Set the factor for the wall velocity. For factWallVel = 0, the right state</span></div>
<div class="line"><a name="l14993"></a><span class="lineno">14993</span>&#160;<span class="comment">     contains the wall velocity. For factWallVel = 1.0, the velocity of the</span></div>
<div class="line"><a name="l14994"></a><span class="lineno">14994</span>&#160;<span class="comment">     right state is obtained by negating the interior velocity w.r.t. the</span></div>
<div class="line"><a name="l14995"></a><span class="lineno">14995</span>&#160;<span class="comment">     velocity of the wall. */</span></div>
<div class="line"><a name="l14996"></a><span class="lineno">14996</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factWallVel = 0.0;</div>
<div class="line"><a name="l14997"></a><span class="lineno">14997</span>&#160;  <span class="comment">// const su2double factWallVel = 1.0;</span></div>
<div class="line"><a name="l14998"></a><span class="lineno">14998</span>&#160; </div>
<div class="line"><a name="l14999"></a><span class="lineno">14999</span>&#160;  <span class="comment">/* Get the wall heat flux. */</span></div>
<div class="line"><a name="l15000"></a><span class="lineno">15000</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">string</span> Marker_Tag       = config-&gt;<a class="code" href="class_c_config.html#a967e969a3beb24bb6e57d7036af003be">GetMarker_All_TagBound</a>(val_marker);</div>
<div class="line"><a name="l15001"></a><span class="lineno">15001</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Wall_HeatFlux = config-&gt;<a class="code" href="class_c_config.html#a13a89ffbaf099f490fb7080163879e55">GetWall_HeatFlux</a>(Marker_Tag);</div>
<div class="line"><a name="l15002"></a><span class="lineno">15002</span>&#160; </div>
<div class="line"><a name="l15003"></a><span class="lineno">15003</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l15004"></a><span class="lineno">15004</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l15005"></a><span class="lineno">15005</span>&#160; </div>
<div class="line"><a name="l15006"></a><span class="lineno">15006</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l15007"></a><span class="lineno">15007</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l15008"></a><span class="lineno">15008</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l15009"></a><span class="lineno">15009</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15010"></a><span class="lineno">15010</span>&#160; </div>
<div class="line"><a name="l15011"></a><span class="lineno">15011</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l15012"></a><span class="lineno">15012</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l15013"></a><span class="lineno">15013</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l15014"></a><span class="lineno">15014</span>&#160; </div>
<div class="line"><a name="l15015"></a><span class="lineno">15015</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l15016"></a><span class="lineno">15016</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l15017"></a><span class="lineno">15017</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l15018"></a><span class="lineno">15018</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l15019"></a><span class="lineno">15019</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l15020"></a><span class="lineno">15020</span>&#160; </div>
<div class="line"><a name="l15021"></a><span class="lineno">15021</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l15022"></a><span class="lineno">15022</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l15023"></a><span class="lineno">15023</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l15024"></a><span class="lineno">15024</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l15025"></a><span class="lineno">15025</span>&#160; </div>
<div class="line"><a name="l15026"></a><span class="lineno">15026</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l15027"></a><span class="lineno">15027</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l15028"></a><span class="lineno">15028</span>&#160; </div>
<div class="line"><a name="l15029"></a><span class="lineno">15029</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l15030"></a><span class="lineno">15030</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l15031"></a><span class="lineno">15031</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l15032"></a><span class="lineno">15032</span>&#160; </div>
<div class="line"><a name="l15033"></a><span class="lineno">15033</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l15034"></a><span class="lineno">15034</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l15035"></a><span class="lineno">15035</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l15036"></a><span class="lineno">15036</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l15037"></a><span class="lineno">15037</span>&#160; </div>
<div class="line"><a name="l15038"></a><span class="lineno">15038</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l15039"></a><span class="lineno">15039</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l15040"></a><span class="lineno">15040</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l15041"></a><span class="lineno">15041</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l15042"></a><span class="lineno">15042</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l15043"></a><span class="lineno">15043</span>&#160; </div>
<div class="line"><a name="l15044"></a><span class="lineno">15044</span>&#160;    <span class="comment">/*--- Compute the right states. A distinction must be made whether or not</span></div>
<div class="line"><a name="l15045"></a><span class="lineno">15045</span>&#160;<span class="comment">          all functions are used. ---*/</span></div>
<div class="line"><a name="l15046"></a><span class="lineno">15046</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[val_marker].wallModel ) {</div>
<div class="line"><a name="l15047"></a><span class="lineno">15047</span>&#160; </div>
<div class="line"><a name="l15048"></a><span class="lineno">15048</span>&#160;      <span class="comment">/*--- Wall functions are used to model the lower part of the boundary</span></div>
<div class="line"><a name="l15049"></a><span class="lineno">15049</span>&#160;<span class="comment">            layer. Consequently, a slip boundary condition is used for the</span></div>
<div class="line"><a name="l15050"></a><span class="lineno">15050</span>&#160;<span class="comment">            velocities and the skin friction and heat flux from the wall</span></div>
<div class="line"><a name="l15051"></a><span class="lineno">15051</span>&#160;<span class="comment">            should drive the velocities towards the no-slip and prescribed</span></div>
<div class="line"><a name="l15052"></a><span class="lineno">15052</span>&#160;<span class="comment">            heat flux. Therefore the right states for the actual flow solver</span></div>
<div class="line"><a name="l15053"></a><span class="lineno">15053</span>&#160;<span class="comment">            can be computed using BoundaryStates_Euler_Wall. ---*/</span></div>
<div class="line"><a name="l15054"></a><span class="lineno">15054</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5d32e85923daf35ff0126d5f716ff9ec">BoundaryStates_Euler_Wall</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l15055"></a><span class="lineno">15055</span>&#160;                                solIntL, solIntR);</div>
<div class="line"><a name="l15056"></a><span class="lineno">15056</span>&#160;    }</div>
<div class="line"><a name="l15057"></a><span class="lineno">15057</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15058"></a><span class="lineno">15058</span>&#160; </div>
<div class="line"><a name="l15059"></a><span class="lineno">15059</span>&#160;      <span class="comment">/*--- Integration to the wall is used, so the no-slip condition is enforced,</span></div>
<div class="line"><a name="l15060"></a><span class="lineno">15060</span>&#160;<span class="comment">            albeit weakly. Loop over the number of faces in this chunk and the</span></div>
<div class="line"><a name="l15061"></a><span class="lineno">15061</span>&#160;<span class="comment">            number of integration points and apply the heat flux wall boundary</span></div>
<div class="line"><a name="l15062"></a><span class="lineno">15062</span>&#160;<span class="comment">            conditions to compute the right state. There are two options. Either</span></div>
<div class="line"><a name="l15063"></a><span class="lineno">15063</span>&#160;<span class="comment">            the velocity is negated or it is set to zero. Some experiments are</span></div>
<div class="line"><a name="l15064"></a><span class="lineno">15064</span>&#160;<span class="comment">            needed to see which formulation gives better results. ---*/</span></div>
<div class="line"><a name="l15065"></a><span class="lineno">15065</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l15066"></a><span class="lineno">15066</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l15067"></a><span class="lineno">15067</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15068"></a><span class="lineno">15068</span>&#160; </div>
<div class="line"><a name="l15069"></a><span class="lineno">15069</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l15070"></a><span class="lineno">15070</span>&#160; </div>
<div class="line"><a name="l15071"></a><span class="lineno">15071</span>&#160;          <span class="comment">/* Easier storage of the grid velocity and the left and right solution</span></div>
<div class="line"><a name="l15072"></a><span class="lineno">15072</span>&#160;<span class="comment">             for this integration point. */</span></div>
<div class="line"><a name="l15073"></a><span class="lineno">15073</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l15074"></a><span class="lineno">15074</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solIntL + NPad*i + llNVar;</div>
<div class="line"><a name="l15075"></a><span class="lineno">15075</span>&#160;                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solIntR + NPad*i + llNVar;</div>
<div class="line"><a name="l15076"></a><span class="lineno">15076</span>&#160; </div>
<div class="line"><a name="l15077"></a><span class="lineno">15077</span>&#160;          <span class="comment">/* Set the right state. The initial value of the total energy is the</span></div>
<div class="line"><a name="l15078"></a><span class="lineno">15078</span>&#160;<span class="comment">             energy of the left state. Also compute the difference in kinetic</span></div>
<div class="line"><a name="l15079"></a><span class="lineno">15079</span>&#160;<span class="comment">             energy between the left and right state. */</span></div>
<div class="line"><a name="l15080"></a><span class="lineno">15080</span>&#160;          UR[0]      = UL[0];</div>
<div class="line"><a name="l15081"></a><span class="lineno">15081</span>&#160;          UR[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = UL[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1];</div>
<div class="line"><a name="l15082"></a><span class="lineno">15082</span>&#160; </div>
<div class="line"><a name="l15083"></a><span class="lineno">15083</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv = 1.0/UL[0];</div>
<div class="line"><a name="l15084"></a><span class="lineno">15084</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> diffKin    = 0.0;</div>
<div class="line"><a name="l15085"></a><span class="lineno">15085</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l15086"></a><span class="lineno">15086</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velL = DensityInv*UL[iDim+1];</div>
<div class="line"><a name="l15087"></a><span class="lineno">15087</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dV   = factWallVel*(velL-gridVel[iDim]);</div>
<div class="line"><a name="l15088"></a><span class="lineno">15088</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velR = gridVel[iDim] - dV;</div>
<div class="line"><a name="l15089"></a><span class="lineno">15089</span>&#160; </div>
<div class="line"><a name="l15090"></a><span class="lineno">15090</span>&#160;            UR[iDim+1] = UR[0]*velR;</div>
<div class="line"><a name="l15091"></a><span class="lineno">15091</span>&#160;            diffKin   += velL*velL - velR*velR;</div>
<div class="line"><a name="l15092"></a><span class="lineno">15092</span>&#160;          }</div>
<div class="line"><a name="l15093"></a><span class="lineno">15093</span>&#160; </div>
<div class="line"><a name="l15094"></a><span class="lineno">15094</span>&#160;          <span class="comment">/* As only the internal energy of UR is equal to UL, the difference</span></div>
<div class="line"><a name="l15095"></a><span class="lineno">15095</span>&#160;<span class="comment">             in kinetic energy must be subtracted. */</span></div>
<div class="line"><a name="l15096"></a><span class="lineno">15096</span>&#160;          UR[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] -= 0.5*UR[0]*diffKin;</div>
<div class="line"><a name="l15097"></a><span class="lineno">15097</span>&#160;        }</div>
<div class="line"><a name="l15098"></a><span class="lineno">15098</span>&#160;      }</div>
<div class="line"><a name="l15099"></a><span class="lineno">15099</span>&#160;    }</div>
<div class="line"><a name="l15100"></a><span class="lineno">15100</span>&#160; </div>
<div class="line"><a name="l15101"></a><span class="lineno">15101</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l15102"></a><span class="lineno">15102</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l15103"></a><span class="lineno">15103</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l15104"></a><span class="lineno">15104</span>&#160;                                    Wall_HeatFlux, <span class="keyword">true</span>, 0.0, <span class="keyword">false</span>,</div>
<div class="line"><a name="l15105"></a><span class="lineno">15105</span>&#160;                                    &amp;surfElem[l], solIntL, solIntR,</div>
<div class="line"><a name="l15106"></a><span class="lineno">15106</span>&#160;                                    work, resFaces, indResFaces,</div>
<div class="line"><a name="l15107"></a><span class="lineno">15107</span>&#160;                                    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[val_marker].wallModel);</div>
<div class="line"><a name="l15108"></a><span class="lineno">15108</span>&#160; </div>
<div class="line"><a name="l15109"></a><span class="lineno">15109</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l15110"></a><span class="lineno">15110</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l15111"></a><span class="lineno">15111</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l15112"></a><span class="lineno">15112</span>&#160;  }</div>
<div class="line"><a name="l15113"></a><span class="lineno">15113</span>&#160;}</div>
<div class="line"><a name="l15114"></a><span class="lineno">15114</span>&#160; </div>
<div class="line"><a name="l15115"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#abcb36132263699c73988c03ca324e290">15115</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#abcb36132263699c73988c03ca324e290">CFEM_DG_NSSolver::BC_Isothermal_Wall</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l15116"></a><span class="lineno">15116</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l15117"></a><span class="lineno">15117</span>&#160;                                          <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l15118"></a><span class="lineno">15118</span>&#160;                                          <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l15119"></a><span class="lineno">15119</span>&#160;                                          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l15120"></a><span class="lineno">15120</span>&#160;                                          <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l15121"></a><span class="lineno">15121</span>&#160;                                          <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l15122"></a><span class="lineno">15122</span>&#160;                                          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l15123"></a><span class="lineno">15123</span>&#160; </div>
<div class="line"><a name="l15124"></a><span class="lineno">15124</span>&#160;  <span class="comment">/* Set the factor for the wall velocity. For factWallVel = 0, the right state</span></div>
<div class="line"><a name="l15125"></a><span class="lineno">15125</span>&#160;<span class="comment">     contains the wall velocity. For factWallVel = 1.0, the velocity of the</span></div>
<div class="line"><a name="l15126"></a><span class="lineno">15126</span>&#160;<span class="comment">     right state is obtained by negating the interior velocity w.r.t. the</span></div>
<div class="line"><a name="l15127"></a><span class="lineno">15127</span>&#160;<span class="comment">     velocity of the wall. */</span></div>
<div class="line"><a name="l15128"></a><span class="lineno">15128</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> factWallVel = 0.0;</div>
<div class="line"><a name="l15129"></a><span class="lineno">15129</span>&#160;  <span class="comment">// const su2double factWallVel = 1.0;</span></div>
<div class="line"><a name="l15130"></a><span class="lineno">15130</span>&#160; </div>
<div class="line"><a name="l15131"></a><span class="lineno">15131</span>&#160;  <span class="comment">/* Get the wall temperature. */</span></div>
<div class="line"><a name="l15132"></a><span class="lineno">15132</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">string</span> Marker_Tag = config-&gt;<a class="code" href="class_c_config.html#a967e969a3beb24bb6e57d7036af003be">GetMarker_All_TagBound</a>(val_marker);</div>
<div class="line"><a name="l15133"></a><span class="lineno">15133</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> TWall   = config-&gt;<a class="code" href="class_c_config.html#a714590a2565d2a339ee22009ada1c7f9">GetIsothermal_Temperature</a>(Marker_Tag)/config-&gt;<a class="code" href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">GetTemperature_Ref</a>();</div>
<div class="line"><a name="l15134"></a><span class="lineno">15134</span>&#160; </div>
<div class="line"><a name="l15135"></a><span class="lineno">15135</span>&#160;  <span class="comment">/* Compute the prescribed value of the energy (per unit mass). */</span></div>
<div class="line"><a name="l15136"></a><span class="lineno">15136</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Gas_Constant = config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l15137"></a><span class="lineno">15137</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Cv           = Gas_Constant/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a>;</div>
<div class="line"><a name="l15138"></a><span class="lineno">15138</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> StaticEnergy = Cv*TWall;</div>
<div class="line"><a name="l15139"></a><span class="lineno">15139</span>&#160; </div>
<div class="line"><a name="l15140"></a><span class="lineno">15140</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l15141"></a><span class="lineno">15141</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l15142"></a><span class="lineno">15142</span>&#160; </div>
<div class="line"><a name="l15143"></a><span class="lineno">15143</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l15144"></a><span class="lineno">15144</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l15145"></a><span class="lineno">15145</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l15146"></a><span class="lineno">15146</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15147"></a><span class="lineno">15147</span>&#160; </div>
<div class="line"><a name="l15148"></a><span class="lineno">15148</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l15149"></a><span class="lineno">15149</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l15150"></a><span class="lineno">15150</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l15151"></a><span class="lineno">15151</span>&#160; </div>
<div class="line"><a name="l15152"></a><span class="lineno">15152</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l15153"></a><span class="lineno">15153</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l15154"></a><span class="lineno">15154</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l15155"></a><span class="lineno">15155</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l15156"></a><span class="lineno">15156</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l15157"></a><span class="lineno">15157</span>&#160; </div>
<div class="line"><a name="l15158"></a><span class="lineno">15158</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l15159"></a><span class="lineno">15159</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l15160"></a><span class="lineno">15160</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l15161"></a><span class="lineno">15161</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l15162"></a><span class="lineno">15162</span>&#160; </div>
<div class="line"><a name="l15163"></a><span class="lineno">15163</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l15164"></a><span class="lineno">15164</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l15165"></a><span class="lineno">15165</span>&#160; </div>
<div class="line"><a name="l15166"></a><span class="lineno">15166</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l15167"></a><span class="lineno">15167</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l15168"></a><span class="lineno">15168</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l15169"></a><span class="lineno">15169</span>&#160; </div>
<div class="line"><a name="l15170"></a><span class="lineno">15170</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l15171"></a><span class="lineno">15171</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l15172"></a><span class="lineno">15172</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l15173"></a><span class="lineno">15173</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l15174"></a><span class="lineno">15174</span>&#160; </div>
<div class="line"><a name="l15175"></a><span class="lineno">15175</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l15176"></a><span class="lineno">15176</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l15177"></a><span class="lineno">15177</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l15178"></a><span class="lineno">15178</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l15179"></a><span class="lineno">15179</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l15180"></a><span class="lineno">15180</span>&#160; </div>
<div class="line"><a name="l15181"></a><span class="lineno">15181</span>&#160;    <span class="comment">/*--- Compute the right states. A distinction must be made whether or not</span></div>
<div class="line"><a name="l15182"></a><span class="lineno">15182</span>&#160;<span class="comment">          all functions are used. ---*/</span></div>
<div class="line"><a name="l15183"></a><span class="lineno">15183</span>&#160;    <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[val_marker].wallModel ) {</div>
<div class="line"><a name="l15184"></a><span class="lineno">15184</span>&#160; </div>
<div class="line"><a name="l15185"></a><span class="lineno">15185</span>&#160;      <span class="comment">/*--- Wall functions are used to model the lower part of the boundary</span></div>
<div class="line"><a name="l15186"></a><span class="lineno">15186</span>&#160;<span class="comment">            layer. Consequently, a slip boundary condition is used for the</span></div>
<div class="line"><a name="l15187"></a><span class="lineno">15187</span>&#160;<span class="comment">            velocities and the skin friction and heat flux from the wall</span></div>
<div class="line"><a name="l15188"></a><span class="lineno">15188</span>&#160;<span class="comment">            should drive the velocities towards the no-slip and prescribed</span></div>
<div class="line"><a name="l15189"></a><span class="lineno">15189</span>&#160;<span class="comment">            temperature. Therefore the right states for the actual flow solver</span></div>
<div class="line"><a name="l15190"></a><span class="lineno">15190</span>&#160;<span class="comment">            can be computed using BoundaryStates_Euler_Wall. ---*/</span></div>
<div class="line"><a name="l15191"></a><span class="lineno">15191</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5d32e85923daf35ff0126d5f716ff9ec">BoundaryStates_Euler_Wall</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l15192"></a><span class="lineno">15192</span>&#160;                                solIntL, solIntR);</div>
<div class="line"><a name="l15193"></a><span class="lineno">15193</span>&#160;    }</div>
<div class="line"><a name="l15194"></a><span class="lineno">15194</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15195"></a><span class="lineno">15195</span>&#160; </div>
<div class="line"><a name="l15196"></a><span class="lineno">15196</span>&#160;      <span class="comment">/*--- Integration to the wall is used, so the no-slip condition is enforced,</span></div>
<div class="line"><a name="l15197"></a><span class="lineno">15197</span>&#160;<span class="comment">            albeit weakly. Loop over the number of faces in this chunk and the</span></div>
<div class="line"><a name="l15198"></a><span class="lineno">15198</span>&#160;<span class="comment">            number of integration points and apply the isothermal wall boundary</span></div>
<div class="line"><a name="l15199"></a><span class="lineno">15199</span>&#160;<span class="comment">            conditions to compute the right state. There are two options. Either</span></div>
<div class="line"><a name="l15200"></a><span class="lineno">15200</span>&#160;<span class="comment">            the velocity is negated or it is set to zero. Some experiments are</span></div>
<div class="line"><a name="l15201"></a><span class="lineno">15201</span>&#160;<span class="comment">            needed to see which formulation gives better results. ---*/</span></div>
<div class="line"><a name="l15202"></a><span class="lineno">15202</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l15203"></a><span class="lineno">15203</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>  lll    = l + ll;</div>
<div class="line"><a name="l15204"></a><span class="lineno">15204</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15205"></a><span class="lineno">15205</span>&#160; </div>
<div class="line"><a name="l15206"></a><span class="lineno">15206</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l15207"></a><span class="lineno">15207</span>&#160; </div>
<div class="line"><a name="l15208"></a><span class="lineno">15208</span>&#160;           <span class="comment">/* Easier storage of the grid velocity and the left and right solution</span></div>
<div class="line"><a name="l15209"></a><span class="lineno">15209</span>&#160;<span class="comment">             for this integration point. */</span></div>
<div class="line"><a name="l15210"></a><span class="lineno">15210</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = surfElem[lll].<a class="code" href="class_c_surface_element_f_e_m.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l15211"></a><span class="lineno">15211</span>&#160;          <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UL      = solIntL + NPad*i + llNVar;</div>
<div class="line"><a name="l15212"></a><span class="lineno">15212</span>&#160;                <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR      = solIntR + NPad*i + llNVar;</div>
<div class="line"><a name="l15213"></a><span class="lineno">15213</span>&#160; </div>
<div class="line"><a name="l15214"></a><span class="lineno">15214</span>&#160;          <span class="comment">/* Set the right state for the density and the momentum variables of the</span></div>
<div class="line"><a name="l15215"></a><span class="lineno">15215</span>&#160;<span class="comment">             right state. Compute twice the possible kinetic energy. */</span></div>
<div class="line"><a name="l15216"></a><span class="lineno">15216</span>&#160;          UR[0] = UL[0];</div>
<div class="line"><a name="l15217"></a><span class="lineno">15217</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> DensityInv = 1.0/UL[0];</div>
<div class="line"><a name="l15218"></a><span class="lineno">15218</span>&#160;          <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> kinEner    = 0.0;</div>
<div class="line"><a name="l15219"></a><span class="lineno">15219</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> iDim=0; iDim&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++iDim) {</div>
<div class="line"><a name="l15220"></a><span class="lineno">15220</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velL = DensityInv*UL[iDim+1];</div>
<div class="line"><a name="l15221"></a><span class="lineno">15221</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dV   = factWallVel*(velL-gridVel[iDim]);</div>
<div class="line"><a name="l15222"></a><span class="lineno">15222</span>&#160;            <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velR = gridVel[iDim] - dV;</div>
<div class="line"><a name="l15223"></a><span class="lineno">15223</span>&#160; </div>
<div class="line"><a name="l15224"></a><span class="lineno">15224</span>&#160;            UR[iDim+1] = UR[0]*velR;</div>
<div class="line"><a name="l15225"></a><span class="lineno">15225</span>&#160;            kinEner   += velR*velR;</div>
<div class="line"><a name="l15226"></a><span class="lineno">15226</span>&#160;          }</div>
<div class="line"><a name="l15227"></a><span class="lineno">15227</span>&#160; </div>
<div class="line"><a name="l15228"></a><span class="lineno">15228</span>&#160;          <span class="comment">/* Compute the total energy of the right state. */</span></div>
<div class="line"><a name="l15229"></a><span class="lineno">15229</span>&#160;          UR[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1] = UR[0]*(StaticEnergy + 0.5*kinEner);</div>
<div class="line"><a name="l15230"></a><span class="lineno">15230</span>&#160;        }</div>
<div class="line"><a name="l15231"></a><span class="lineno">15231</span>&#160;      }</div>
<div class="line"><a name="l15232"></a><span class="lineno">15232</span>&#160;    }</div>
<div class="line"><a name="l15233"></a><span class="lineno">15233</span>&#160; </div>
<div class="line"><a name="l15234"></a><span class="lineno">15234</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l15235"></a><span class="lineno">15235</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l15236"></a><span class="lineno">15236</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l15237"></a><span class="lineno">15237</span>&#160;                                    0.0, <span class="keyword">false</span>, TWall, <span class="keyword">true</span>,</div>
<div class="line"><a name="l15238"></a><span class="lineno">15238</span>&#160;                                    &amp;surfElem[l], solIntL, solIntR,</div>
<div class="line"><a name="l15239"></a><span class="lineno">15239</span>&#160;                                    work, resFaces, indResFaces,</div>
<div class="line"><a name="l15240"></a><span class="lineno">15240</span>&#160;                                    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">boundaries</a>[val_marker].wallModel);</div>
<div class="line"><a name="l15241"></a><span class="lineno">15241</span>&#160; </div>
<div class="line"><a name="l15242"></a><span class="lineno">15242</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l15243"></a><span class="lineno">15243</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l15244"></a><span class="lineno">15244</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l15245"></a><span class="lineno">15245</span>&#160;  }</div>
<div class="line"><a name="l15246"></a><span class="lineno">15246</span>&#160;}</div>
<div class="line"><a name="l15247"></a><span class="lineno">15247</span>&#160; </div>
<div class="line"><a name="l15248"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#afa0326d05f194eaacbb86e6231b27dd4">15248</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#afa0326d05f194eaacbb86e6231b27dd4">CFEM_DG_NSSolver::BC_Riemann</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l15249"></a><span class="lineno">15249</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l15250"></a><span class="lineno">15250</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l15251"></a><span class="lineno">15251</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l15252"></a><span class="lineno">15252</span>&#160;                                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l15253"></a><span class="lineno">15253</span>&#160;                                  <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l15254"></a><span class="lineno">15254</span>&#160;                                  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>           val_marker,</div>
<div class="line"><a name="l15255"></a><span class="lineno">15255</span>&#160;                                  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l15256"></a><span class="lineno">15256</span>&#160; </div>
<div class="line"><a name="l15257"></a><span class="lineno">15257</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l15258"></a><span class="lineno">15258</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l15259"></a><span class="lineno">15259</span>&#160; </div>
<div class="line"><a name="l15260"></a><span class="lineno">15260</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l15261"></a><span class="lineno">15261</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l15262"></a><span class="lineno">15262</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l15263"></a><span class="lineno">15263</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15264"></a><span class="lineno">15264</span>&#160; </div>
<div class="line"><a name="l15265"></a><span class="lineno">15265</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l15266"></a><span class="lineno">15266</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l15267"></a><span class="lineno">15267</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l15268"></a><span class="lineno">15268</span>&#160; </div>
<div class="line"><a name="l15269"></a><span class="lineno">15269</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l15270"></a><span class="lineno">15270</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l15271"></a><span class="lineno">15271</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l15272"></a><span class="lineno">15272</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l15273"></a><span class="lineno">15273</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l15274"></a><span class="lineno">15274</span>&#160; </div>
<div class="line"><a name="l15275"></a><span class="lineno">15275</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l15276"></a><span class="lineno">15276</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l15277"></a><span class="lineno">15277</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l15278"></a><span class="lineno">15278</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l15279"></a><span class="lineno">15279</span>&#160; </div>
<div class="line"><a name="l15280"></a><span class="lineno">15280</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l15281"></a><span class="lineno">15281</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l15282"></a><span class="lineno">15282</span>&#160; </div>
<div class="line"><a name="l15283"></a><span class="lineno">15283</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l15284"></a><span class="lineno">15284</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l15285"></a><span class="lineno">15285</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l15286"></a><span class="lineno">15286</span>&#160; </div>
<div class="line"><a name="l15287"></a><span class="lineno">15287</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l15288"></a><span class="lineno">15288</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l15289"></a><span class="lineno">15289</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l15290"></a><span class="lineno">15290</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l15291"></a><span class="lineno">15291</span>&#160; </div>
<div class="line"><a name="l15292"></a><span class="lineno">15292</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l15293"></a><span class="lineno">15293</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l15294"></a><span class="lineno">15294</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l15295"></a><span class="lineno">15295</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l15296"></a><span class="lineno">15296</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l15297"></a><span class="lineno">15297</span>&#160; </div>
<div class="line"><a name="l15298"></a><span class="lineno">15298</span>&#160;    <span class="comment">/* Compute the right state by applying the Riemann BC&#39;s. */</span></div>
<div class="line"><a name="l15299"></a><span class="lineno">15299</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a5bfdc0bca1daa8e5d716d4fc3c7f5867">BoundaryStates_Riemann</a>(config, llEnd, NPad, &amp;surfElem[l], val_marker, solIntL, solIntR);</div>
<div class="line"><a name="l15300"></a><span class="lineno">15300</span>&#160; </div>
<div class="line"><a name="l15301"></a><span class="lineno">15301</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l15302"></a><span class="lineno">15302</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l15303"></a><span class="lineno">15303</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l15304"></a><span class="lineno">15304</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l15305"></a><span class="lineno">15305</span>&#160;                                    solIntL, solIntR, work,</div>
<div class="line"><a name="l15306"></a><span class="lineno">15306</span>&#160;                                    resFaces, indResFaces, NULL);</div>
<div class="line"><a name="l15307"></a><span class="lineno">15307</span>&#160; </div>
<div class="line"><a name="l15308"></a><span class="lineno">15308</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l15309"></a><span class="lineno">15309</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l15310"></a><span class="lineno">15310</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l15311"></a><span class="lineno">15311</span>&#160;  }</div>
<div class="line"><a name="l15312"></a><span class="lineno">15312</span>&#160;}</div>
<div class="line"><a name="l15313"></a><span class="lineno">15313</span>&#160; </div>
<div class="line"><a name="l15314"></a><span class="lineno"><a class="line" href="class_c_f_e_m___d_g___n_s_solver.html#a8e27fad06f1bde21670f2e2990d3027e">15314</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="class_c_f_e_m___d_g___n_s_solver.html#a8e27fad06f1bde21670f2e2990d3027e">CFEM_DG_NSSolver::BC_Custom</a>(<a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l15315"></a><span class="lineno">15315</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemBeg,</div>
<div class="line"><a name="l15316"></a><span class="lineno">15316</span>&#160;                                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      surfElemEnd,</div>
<div class="line"><a name="l15317"></a><span class="lineno">15317</span>&#160;                                 <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l15318"></a><span class="lineno">15318</span>&#160;                                 <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l15319"></a><span class="lineno">15319</span>&#160;                                 <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l15320"></a><span class="lineno">15320</span>&#160;                                 <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *workArray) {</div>
<div class="line"><a name="l15321"></a><span class="lineno">15321</span>&#160; </div>
<div class="line"><a name="l15322"></a><span class="lineno">15322</span>&#160;<span class="preprocessor">#ifdef CUSTOM_BC_NSUNITQUAD</span></div>
<div class="line"><a name="l15323"></a><span class="lineno">15323</span>&#160;  <span class="comment">/* Get the flow angle, which is stored in the angle of attack and the</span></div>
<div class="line"><a name="l15324"></a><span class="lineno">15324</span>&#160;<span class="comment">     viscosity coefficient. */</span></div>
<div class="line"><a name="l15325"></a><span class="lineno">15325</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> flowAngle = config-&gt;<a class="code" href="class_c_config.html#a6020a5df7025ffb286f9b9f55f3f2773">GetAoA</a>()*<a class="code" href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a>/180.0;</div>
<div class="line"><a name="l15326"></a><span class="lineno">15326</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> mu        = config-&gt;<a class="code" href="class_c_config.html#a2ede918fd25217170b85049ddf07408b">GetViscosity_FreeStreamND</a>();</div>
<div class="line"><a name="l15327"></a><span class="lineno">15327</span>&#160; </div>
<div class="line"><a name="l15328"></a><span class="lineno">15328</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> cosFlowAngle = cos(flowAngle);</div>
<div class="line"><a name="l15329"></a><span class="lineno">15329</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> sinFlowAngle = sin(flowAngle);</div>
<div class="line"><a name="l15330"></a><span class="lineno">15330</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l15331"></a><span class="lineno">15331</span>&#160; </div>
<div class="line"><a name="l15332"></a><span class="lineno">15332</span>&#160;  <span class="comment">/* Initialization of the counter in resFaces. */</span></div>
<div class="line"><a name="l15333"></a><span class="lineno">15333</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResFaces = 0;</div>
<div class="line"><a name="l15334"></a><span class="lineno">15334</span>&#160; </div>
<div class="line"><a name="l15335"></a><span class="lineno">15335</span>&#160;  <span class="comment">/* Determine the number of faces that are treated simultaneously</span></div>
<div class="line"><a name="l15336"></a><span class="lineno">15336</span>&#160;<span class="comment">     in the matrix products to obtain good gemm performance. */</span></div>
<div class="line"><a name="l15337"></a><span class="lineno">15337</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadInput  = config-&gt;<a class="code" href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">GetSizeMatMulPadding</a>();</div>
<div class="line"><a name="l15338"></a><span class="lineno">15338</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nFaceSimul = nPadInput/<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15339"></a><span class="lineno">15339</span>&#160; </div>
<div class="line"><a name="l15340"></a><span class="lineno">15340</span>&#160;  <span class="comment">/* Determine the minimum padded size in the matrix multiplications, which</span></div>
<div class="line"><a name="l15341"></a><span class="lineno">15341</span>&#160;<span class="comment">     corresponds to 64 byte alignment. */</span></div>
<div class="line"><a name="l15342"></a><span class="lineno">15342</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nPadMin = 64/<span class="keyword">sizeof</span>(<a class="code" href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a>);</div>
<div class="line"><a name="l15343"></a><span class="lineno">15343</span>&#160; </div>
<div class="line"><a name="l15344"></a><span class="lineno">15344</span>&#160;  <span class="comment">/*--- Loop over the requested range of surface faces. Multiple faces</span></div>
<div class="line"><a name="l15345"></a><span class="lineno">15345</span>&#160;<span class="comment">        are treated simultaneously to improve the performance of the matrix</span></div>
<div class="line"><a name="l15346"></a><span class="lineno">15346</span>&#160;<span class="comment">        multiplications. As a consequence, the update of the counter l</span></div>
<div class="line"><a name="l15347"></a><span class="lineno">15347</span>&#160;<span class="comment">        happens at the end of this loop section. ---*/</span></div>
<div class="line"><a name="l15348"></a><span class="lineno">15348</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> l=surfElemBeg; l&lt;surfElemEnd;) {</div>
<div class="line"><a name="l15349"></a><span class="lineno">15349</span>&#160; </div>
<div class="line"><a name="l15350"></a><span class="lineno">15350</span>&#160;    <span class="comment">/* Determine the end index for this chunk of faces and the padded</span></div>
<div class="line"><a name="l15351"></a><span class="lineno">15351</span>&#160;<span class="comment">       N value in the gemm computations. */</span></div>
<div class="line"><a name="l15352"></a><span class="lineno">15352</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> lEnd;</div>
<div class="line"><a name="l15353"></a><span class="lineno">15353</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind, llEnd, NPad;</div>
<div class="line"><a name="l15354"></a><span class="lineno">15354</span>&#160; </div>
<div class="line"><a name="l15355"></a><span class="lineno">15355</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">MetaDataChunkOfElem</a>(surfElem, l, surfElemEnd, nFaceSimul,</div>
<div class="line"><a name="l15356"></a><span class="lineno">15356</span>&#160;                        nPadMin, lEnd, ind, llEnd, NPad);</div>
<div class="line"><a name="l15357"></a><span class="lineno">15357</span>&#160; </div>
<div class="line"><a name="l15358"></a><span class="lineno">15358</span>&#160;    <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l15359"></a><span class="lineno">15359</span>&#160;<span class="comment">          for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l15360"></a><span class="lineno">15360</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l15361"></a><span class="lineno">15361</span>&#160; </div>
<div class="line"><a name="l15362"></a><span class="lineno">15362</span>&#160;    <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l15363"></a><span class="lineno">15363</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntL = workArray;</div>
<div class="line"><a name="l15364"></a><span class="lineno">15364</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solIntR = solIntL + NPad*nInt;</div>
<div class="line"><a name="l15365"></a><span class="lineno">15365</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *work    = solIntR + NPad*nInt;</div>
<div class="line"><a name="l15366"></a><span class="lineno">15366</span>&#160; </div>
<div class="line"><a name="l15367"></a><span class="lineno">15367</span>&#160;    <span class="comment">/* Compute the left states in the integration points of the chunk of</span></div>
<div class="line"><a name="l15368"></a><span class="lineno">15368</span>&#160;<span class="comment">       faces. The array workarray is used as temporary storage inside the</span></div>
<div class="line"><a name="l15369"></a><span class="lineno">15369</span>&#160;<span class="comment">       function LeftStatesIntegrationPointsBoundaryFace. */</span></div>
<div class="line"><a name="l15370"></a><span class="lineno">15370</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">LeftStatesIntegrationPointsBoundaryFace</a>(config, llEnd, NPad, &amp;surfElem[l],</div>
<div class="line"><a name="l15371"></a><span class="lineno">15371</span>&#160;                                            work, solIntL);</div>
<div class="line"><a name="l15372"></a><span class="lineno">15372</span>&#160; </div>
<div class="line"><a name="l15373"></a><span class="lineno">15373</span>&#160;    <span class="comment">/*--- Loop over the number of faces and integration points to compute the</span></div>
<div class="line"><a name="l15374"></a><span class="lineno">15374</span>&#160;<span class="comment">          right state via the customized boundary conditions. ---*/</span></div>
<div class="line"><a name="l15375"></a><span class="lineno">15375</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ll=0; ll&lt;llEnd; ++ll) {</div>
<div class="line"><a name="l15376"></a><span class="lineno">15376</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l15377"></a><span class="lineno">15377</span>&#160; </div>
<div class="line"><a name="l15378"></a><span class="lineno">15378</span>&#160;<span class="preprocessor">#ifdef CUSTOM_BC_NSUNITQUAD</span></div>
<div class="line"><a name="l15379"></a><span class="lineno">15379</span>&#160; </div>
<div class="line"><a name="l15380"></a><span class="lineno">15380</span>&#160;        <span class="comment">/* Easier storage of the right solution for this integration point and</span></div>
<div class="line"><a name="l15381"></a><span class="lineno">15381</span>&#160;<span class="comment">           the coordinates of this integration point. */</span></div>
<div class="line"><a name="l15382"></a><span class="lineno">15382</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = surfElem[l+ll].<a class="code" href="class_c_surface_element_f_e_m.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l15383"></a><span class="lineno">15383</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR   = solIntR + NPad*i + ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15384"></a><span class="lineno">15384</span>&#160; </div>
<div class="line"><a name="l15385"></a><span class="lineno">15385</span>&#160;        <span class="comment">/*--- Set the exact solution in this integration point. ---*/</span></div>
<div class="line"><a name="l15386"></a><span class="lineno">15386</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> xTilde = coor[0]*cosFlowAngle - coor[1]*sinFlowAngle;</div>
<div class="line"><a name="l15387"></a><span class="lineno">15387</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span> yTilde = coor[0]*sinFlowAngle + coor[1]*cosFlowAngle;</div>
<div class="line"><a name="l15388"></a><span class="lineno">15388</span>&#160; </div>
<div class="line"><a name="l15389"></a><span class="lineno">15389</span>&#160;        UR[0]      =  1.0;</div>
<div class="line"><a name="l15390"></a><span class="lineno">15390</span>&#160;        UR[1]      =  cosFlowAngle*yTilde*yTilde;</div>
<div class="line"><a name="l15391"></a><span class="lineno">15391</span>&#160;        UR[2]      = -sinFlowAngle*yTilde*yTilde;</div>
<div class="line"><a name="l15392"></a><span class="lineno">15392</span>&#160;        UR[3]      =  0.0;</div>
<div class="line"><a name="l15393"></a><span class="lineno">15393</span>&#160;        UR[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] =  (2.0*mu*xTilde + 10)/<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">Gamma_Minus_One</a></div>
<div class="line"><a name="l15394"></a><span class="lineno">15394</span>&#160;                   +  0.5*yTilde*yTilde*yTilde*yTilde;</div>
<div class="line"><a name="l15395"></a><span class="lineno">15395</span>&#160; </div>
<div class="line"><a name="l15396"></a><span class="lineno">15396</span>&#160;<span class="preprocessor">#elif MANUFACTURED_SOLUTION</span></div>
<div class="line"><a name="l15397"></a><span class="lineno">15397</span>&#160; </div>
<div class="line"><a name="l15398"></a><span class="lineno">15398</span>&#160;        <span class="comment">/* Manufactured solution. Specify the exact solution for the right solution.</span></div>
<div class="line"><a name="l15399"></a><span class="lineno">15399</span>&#160;<span class="comment">           First determine the pointer to the coordinates of this integration</span></div>
<div class="line"><a name="l15400"></a><span class="lineno">15400</span>&#160;<span class="comment">           point and the pointer to the solution. Afterwards call the function</span></div>
<div class="line"><a name="l15401"></a><span class="lineno">15401</span>&#160;<span class="comment">           DetermineManufacturedSolution to do the actual job. */</span></div>
<div class="line"><a name="l15402"></a><span class="lineno">15402</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *coor = surfElem[ll+l].<a class="code" href="class_c_surface_element_f_e_m.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">coorIntegrationPoints</a>.data() + i*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l15403"></a><span class="lineno">15403</span>&#160;              <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *UR   = solIntR + NPad*i + ll*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15404"></a><span class="lineno">15404</span>&#160; </div>
<div class="line"><a name="l15405"></a><span class="lineno">15405</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> RGas = config-&gt;<a class="code" href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">GetGas_ConstantND</a>();</div>
<div class="line"><a name="l15406"></a><span class="lineno">15406</span>&#160;        DetermineManufacturedSolution(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">Gamma</a>, RGas,  coor, UR);</div>
<div class="line"><a name="l15407"></a><span class="lineno">15407</span>&#160; </div>
<div class="line"><a name="l15408"></a><span class="lineno">15408</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l15409"></a><span class="lineno">15409</span>&#160; </div>
<div class="line"><a name="l15410"></a><span class="lineno">15410</span>&#160;        <span class="comment">/* No compiler directive specified. Write an error message and exit. */</span></div>
<div class="line"><a name="l15411"></a><span class="lineno">15411</span>&#160; </div>
<div class="line"><a name="l15412"></a><span class="lineno">15412</span>&#160;        <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;No or wrong compiler directive specified. This is necessary for customized boundary conditions.&quot;</span>,</div>
<div class="line"><a name="l15413"></a><span class="lineno">15413</span>&#160;                       <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l15414"></a><span class="lineno">15414</span>&#160; </div>
<div class="line"><a name="l15415"></a><span class="lineno">15415</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l15416"></a><span class="lineno">15416</span>&#160;      }</div>
<div class="line"><a name="l15417"></a><span class="lineno">15417</span>&#160;    }</div>
<div class="line"><a name="l15418"></a><span class="lineno">15418</span>&#160; </div>
<div class="line"><a name="l15419"></a><span class="lineno">15419</span>&#160;    <span class="comment">/* The remainder of the boundary treatment is the same for all</span></div>
<div class="line"><a name="l15420"></a><span class="lineno">15420</span>&#160;<span class="comment">       boundary conditions (except the symmetry plane). */</span></div>
<div class="line"><a name="l15421"></a><span class="lineno">15421</span>&#160;    ViscousBoundaryFacesBCTreatment(config, conv_numerics, llEnd, NPad,</div>
<div class="line"><a name="l15422"></a><span class="lineno">15422</span>&#160;                                    0.0, <span class="keyword">false</span>, 0.0, <span class="keyword">false</span>, &amp;surfElem[l],</div>
<div class="line"><a name="l15423"></a><span class="lineno">15423</span>&#160;                                    solIntL, solIntR, work,</div>
<div class="line"><a name="l15424"></a><span class="lineno">15424</span>&#160;                                    resFaces, indResFaces, NULL);</div>
<div class="line"><a name="l15425"></a><span class="lineno">15425</span>&#160; </div>
<div class="line"><a name="l15426"></a><span class="lineno">15426</span>&#160;    <span class="comment">/* Update the value of the counter l to the end index of the</span></div>
<div class="line"><a name="l15427"></a><span class="lineno">15427</span>&#160;<span class="comment">       current chunk. */</span></div>
<div class="line"><a name="l15428"></a><span class="lineno">15428</span>&#160;    l = lEnd;</div>
<div class="line"><a name="l15429"></a><span class="lineno">15429</span>&#160;  }</div>
<div class="line"><a name="l15430"></a><span class="lineno">15430</span>&#160;}</div>
<div class="line"><a name="l15431"></a><span class="lineno">15431</span>&#160; </div>
<div class="line"><a name="l15432"></a><span class="lineno">15432</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ViscousBoundaryFacesBCTreatment(</div>
<div class="line"><a name="l15433"></a><span class="lineno">15433</span>&#160;                                       <a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l15434"></a><span class="lineno">15434</span>&#160;                                       <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l15435"></a><span class="lineno">15435</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l15436"></a><span class="lineno">15436</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l15437"></a><span class="lineno">15437</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          Wall_HeatFlux,</div>
<div class="line"><a name="l15438"></a><span class="lineno">15438</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">bool</span>               HeatFlux_Prescribed,</div>
<div class="line"><a name="l15439"></a><span class="lineno">15439</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          Wall_Temperature,</div>
<div class="line"><a name="l15440"></a><span class="lineno">15440</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">bool</span>               Temperature_Prescribed,</div>
<div class="line"><a name="l15441"></a><span class="lineno">15441</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l15442"></a><span class="lineno">15442</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *solIntL,</div>
<div class="line"><a name="l15443"></a><span class="lineno">15443</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *solIntR,</div>
<div class="line"><a name="l15444"></a><span class="lineno">15444</span>&#160;                                             <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *workArray,</div>
<div class="line"><a name="l15445"></a><span class="lineno">15445</span>&#160;                                             <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *resFaces,</div>
<div class="line"><a name="l15446"></a><span class="lineno">15446</span>&#160;                                             <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>      &amp;indResFaces,</div>
<div class="line"><a name="l15447"></a><span class="lineno">15447</span>&#160;                                             <a class="code" href="class_c_wall_model.html">CWallModel</a>         *wallModel) {</div>
<div class="line"><a name="l15448"></a><span class="lineno">15448</span>&#160; </div>
<div class="line"><a name="l15449"></a><span class="lineno">15449</span>&#160;  <span class="comment">/*--- Get the information from the standard element, which is the same</span></div>
<div class="line"><a name="l15450"></a><span class="lineno">15450</span>&#160;<span class="comment">        for all the faces in the chunks considered. ---*/</span></div>
<div class="line"><a name="l15451"></a><span class="lineno">15451</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind       = surfElem[0].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l15452"></a><span class="lineno">15452</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l15453"></a><span class="lineno">15453</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#aad6afe2fa8d35697a57dfc22a7542176">GetNDOFsElem</a>();</div>
<div class="line"><a name="l15454"></a><span class="lineno">15454</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *derBasisElem  = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#af348ced10e1bc0d2a33992de84c13127">GetMatDerBasisElemIntegration</a>();</div>
<div class="line"><a name="l15455"></a><span class="lineno">15455</span>&#160; </div>
<div class="line"><a name="l15456"></a><span class="lineno">15456</span>&#160;  <span class="comment">/*--- Set the pointers for the local arrays. ---*/</span></div>
<div class="line"><a name="l15457"></a><span class="lineno">15457</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *viscosityInt = workArray;</div>
<div class="line"><a name="l15458"></a><span class="lineno">15458</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *kOverCvInt   = viscosityInt + nFaceSimul*nInt;</div>
<div class="line"><a name="l15459"></a><span class="lineno">15459</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gradSolInt   = kOverCvInt   + nFaceSimul*nInt;</div>
<div class="line"><a name="l15460"></a><span class="lineno">15460</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *fluxes       = gradSolInt   + NPad*nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l15461"></a><span class="lineno">15461</span>&#160;  <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *viscFluxes   = fluxes       + NPad*max(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, (<span class="keywordtype">int</span>) nDOFsElem);</div>
<div class="line"><a name="l15462"></a><span class="lineno">15462</span>&#160; </div>
<div class="line"><a name="l15463"></a><span class="lineno">15463</span>&#160;  <span class="comment">/* Compute the viscous fluxes in the integration points of the faces that</span></div>
<div class="line"><a name="l15464"></a><span class="lineno">15464</span>&#160;<span class="comment">     are treated simulaneously. Make a distinction between a wall function</span></div>
<div class="line"><a name="l15465"></a><span class="lineno">15465</span>&#160;<span class="comment">     treatment and a standard computation of the viscous fluxes. */</span></div>
<div class="line"><a name="l15466"></a><span class="lineno">15466</span>&#160;  <span class="keywordflow">if</span>( wallModel ) {</div>
<div class="line"><a name="l15467"></a><span class="lineno">15467</span>&#160;    WallTreatmentViscousFluxes(config, nFaceSimul, NPad, nInt, Wall_HeatFlux,</div>
<div class="line"><a name="l15468"></a><span class="lineno">15468</span>&#160;                               HeatFlux_Prescribed, Wall_Temperature,</div>
<div class="line"><a name="l15469"></a><span class="lineno">15469</span>&#160;                               Temperature_Prescribed, surfElem,</div>
<div class="line"><a name="l15470"></a><span class="lineno">15470</span>&#160;                               gradSolInt, viscFluxes, viscosityInt,</div>
<div class="line"><a name="l15471"></a><span class="lineno">15471</span>&#160;                               kOverCvInt, wallModel);</div>
<div class="line"><a name="l15472"></a><span class="lineno">15472</span>&#160;  }</div>
<div class="line"><a name="l15473"></a><span class="lineno">15473</span>&#160;  <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l15474"></a><span class="lineno">15474</span>&#160;    ComputeViscousFluxesBoundaryFaces(config, nFaceSimul, NPad, nInt, nDOFsElem,</div>
<div class="line"><a name="l15475"></a><span class="lineno">15475</span>&#160;                                      Wall_HeatFlux, HeatFlux_Prescribed,</div>
<div class="line"><a name="l15476"></a><span class="lineno">15476</span>&#160;                                      derBasisElem, surfElem, solIntL,</div>
<div class="line"><a name="l15477"></a><span class="lineno">15477</span>&#160;                                      fluxes, gradSolInt, viscFluxes,</div>
<div class="line"><a name="l15478"></a><span class="lineno">15478</span>&#160;                                      viscosityInt, kOverCvInt);</div>
<div class="line"><a name="l15479"></a><span class="lineno">15479</span>&#160;  }</div>
<div class="line"><a name="l15480"></a><span class="lineno">15480</span>&#160; </div>
<div class="line"><a name="l15481"></a><span class="lineno">15481</span>&#160;  <span class="comment">/* The remainder of the boundary condition treatment is the same for all</span></div>
<div class="line"><a name="l15482"></a><span class="lineno">15482</span>&#160;<span class="comment">     types of boundary conditions, including the symmetry plane and the</span></div>
<div class="line"><a name="l15483"></a><span class="lineno">15483</span>&#160;<span class="comment">     wall function treatment. The function ResidualViscousBoundaryFace will</span></div>
<div class="line"><a name="l15484"></a><span class="lineno">15484</span>&#160;<span class="comment">     carry out this task. */</span></div>
<div class="line"><a name="l15485"></a><span class="lineno">15485</span>&#160; </div>
<div class="line"><a name="l15486"></a><span class="lineno">15486</span>&#160;  ResidualViscousBoundaryFace(config, conv_numerics, nFaceSimul, NPad, surfElem,</div>
<div class="line"><a name="l15487"></a><span class="lineno">15487</span>&#160;                              solIntL, solIntR, gradSolInt, fluxes, viscFluxes,</div>
<div class="line"><a name="l15488"></a><span class="lineno">15488</span>&#160;                              viscosityInt, kOverCvInt, resFaces, indResFaces);</div>
<div class="line"><a name="l15489"></a><span class="lineno">15489</span>&#160;}</div>
<div class="line"><a name="l15490"></a><span class="lineno">15490</span>&#160; </div>
<div class="line"><a name="l15491"></a><span class="lineno">15491</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ComputeViscousFluxesBoundaryFaces(</div>
<div class="line"><a name="l15492"></a><span class="lineno">15492</span>&#160;                                       <a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l15493"></a><span class="lineno">15493</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l15494"></a><span class="lineno">15494</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l15495"></a><span class="lineno">15495</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nInt,</div>
<div class="line"><a name="l15496"></a><span class="lineno">15496</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nDOFsElem,</div>
<div class="line"><a name="l15497"></a><span class="lineno">15497</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          Wall_HeatFlux,</div>
<div class="line"><a name="l15498"></a><span class="lineno">15498</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">bool</span>               HeatFlux_Prescribed,</div>
<div class="line"><a name="l15499"></a><span class="lineno">15499</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *derBasisElem,</div>
<div class="line"><a name="l15500"></a><span class="lineno">15500</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l15501"></a><span class="lineno">15501</span>&#160;                                       <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *solIntL,</div>
<div class="line"><a name="l15502"></a><span class="lineno">15502</span>&#160;                                             <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *solElem,</div>
<div class="line"><a name="l15503"></a><span class="lineno">15503</span>&#160;                                             <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *gradSolInt,</div>
<div class="line"><a name="l15504"></a><span class="lineno">15504</span>&#160;                                             <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *viscFluxes,</div>
<div class="line"><a name="l15505"></a><span class="lineno">15505</span>&#160;                                             <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *viscosityInt,</div>
<div class="line"><a name="l15506"></a><span class="lineno">15506</span>&#160;                                             <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *kOverCvInt) {</div>
<div class="line"><a name="l15507"></a><span class="lineno">15507</span>&#160; </div>
<div class="line"><a name="l15508"></a><span class="lineno">15508</span>&#160;  <span class="comment">/* Easier storage of the number of bytes to copy in the memcpy calls. */</span></div>
<div class="line"><a name="l15509"></a><span class="lineno">15509</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l15510"></a><span class="lineno">15510</span>&#160; </div>
<div class="line"><a name="l15511"></a><span class="lineno">15511</span>&#160;  <span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l15512"></a><span class="lineno">15512</span>&#160;  <span class="comment">/*--- Step 1: Compute the gradients of the conservative variables in the  ---*/</span></div>
<div class="line"><a name="l15513"></a><span class="lineno">15513</span>&#160;  <span class="comment">/*---         integration points of the faces.                            ---*/</span></div>
<div class="line"><a name="l15514"></a><span class="lineno">15514</span>&#160;  <span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l15515"></a><span class="lineno">15515</span>&#160; </div>
<div class="line"><a name="l15516"></a><span class="lineno">15516</span>&#160;  <span class="comment">/* Loop over the simultaneously treated faces to set the solution of the elements. */</span></div>
<div class="line"><a name="l15517"></a><span class="lineno">15517</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l15518"></a><span class="lineno">15518</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15519"></a><span class="lineno">15519</span>&#160; </div>
<div class="line"><a name="l15520"></a><span class="lineno">15520</span>&#160;    <span class="comment">/* Determine the offset that must be applied to access the correct data for</span></div>
<div class="line"><a name="l15521"></a><span class="lineno">15521</span>&#160;<span class="comment">       this element in the working vector of the solution. Per definition the</span></div>
<div class="line"><a name="l15522"></a><span class="lineno">15522</span>&#160;<span class="comment">       boundary face has the same time level as the adjacent element, hence</span></div>
<div class="line"><a name="l15523"></a><span class="lineno">15523</span>&#160;<span class="comment">       offsetDOFsSolThisTimeLevel is used. */</span></div>
<div class="line"><a name="l15524"></a><span class="lineno">15524</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID     = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>;</div>
<div class="line"><a name="l15525"></a><span class="lineno">15525</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l15526"></a><span class="lineno">15526</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offset     = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">offsetDOFsSolLocal</a></div>
<div class="line"><a name="l15527"></a><span class="lineno">15527</span>&#160;                                   - <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l15528"></a><span class="lineno">15528</span>&#160; </div>
<div class="line"><a name="l15529"></a><span class="lineno">15529</span>&#160;    <span class="comment">/* Loop over the DOFs of the element and copy the solution to the appropriate</span></div>
<div class="line"><a name="l15530"></a><span class="lineno">15530</span>&#160;<span class="comment">       position in solElem. */</span></div>
<div class="line"><a name="l15531"></a><span class="lineno">15531</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> *DOFsElem = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#abdf9f21e0435e853d60d7faeecbb5e2f">DOFsSolElement</a>.data();</div>
<div class="line"><a name="l15532"></a><span class="lineno">15532</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem; ++i) {</div>
<div class="line"><a name="l15533"></a><span class="lineno">15533</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOF = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l15534"></a><span class="lineno">15534</span>&#160;                              + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(DOFsElem[i] - offset);</div>
<div class="line"><a name="l15535"></a><span class="lineno">15535</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>       *sol    = solElem + NPad*i + llNVar;</div>
<div class="line"><a name="l15536"></a><span class="lineno">15536</span>&#160;      memcpy(sol, solDOF, nBytes);</div>
<div class="line"><a name="l15537"></a><span class="lineno">15537</span>&#160;    }</div>
<div class="line"><a name="l15538"></a><span class="lineno">15538</span>&#160;  }</div>
<div class="line"><a name="l15539"></a><span class="lineno">15539</span>&#160; </div>
<div class="line"><a name="l15540"></a><span class="lineno">15540</span>&#160;  <span class="comment">/* Compute the gradients in the integration points. Call the general function to</span></div>
<div class="line"><a name="l15541"></a><span class="lineno">15541</span>&#160;<span class="comment">     carry out the matrix product. */</span></div>
<div class="line"><a name="l15542"></a><span class="lineno">15542</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, NPad, nDOFsElem, derBasisElem, solElem, gradSolInt, config);</div>
<div class="line"><a name="l15543"></a><span class="lineno">15543</span>&#160; </div>
<div class="line"><a name="l15544"></a><span class="lineno">15544</span>&#160;  <span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l15545"></a><span class="lineno">15545</span>&#160;  <span class="comment">/*--- Step 2: Compute the viscous normal fluxes in the integration points ---*/</span></div>
<div class="line"><a name="l15546"></a><span class="lineno">15546</span>&#160;  <span class="comment">/*---         of the faces.                                               ---*/</span></div>
<div class="line"><a name="l15547"></a><span class="lineno">15547</span>&#160;  <span class="comment">/*---------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l15548"></a><span class="lineno">15548</span>&#160; </div>
<div class="line"><a name="l15549"></a><span class="lineno">15549</span>&#160;  <span class="comment">/* Loop over the simultaneously treated faces. */</span></div>
<div class="line"><a name="l15550"></a><span class="lineno">15550</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l15551"></a><span class="lineno">15551</span>&#160; </div>
<div class="line"><a name="l15552"></a><span class="lineno">15552</span>&#160;    <span class="comment">/* Determine the ID of the adjacent element. */</span></div>
<div class="line"><a name="l15553"></a><span class="lineno">15553</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> elemID = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>;</div>
<div class="line"><a name="l15554"></a><span class="lineno">15554</span>&#160; </div>
<div class="line"><a name="l15555"></a><span class="lineno">15555</span>&#160;    <span class="comment">/* Call the general function to compute the viscous flux in normal</span></div>
<div class="line"><a name="l15556"></a><span class="lineno">15556</span>&#160;<span class="comment">       direction for the face. */</span></div>
<div class="line"><a name="l15557"></a><span class="lineno">15557</span>&#160;    ViscousNormalFluxFace(&amp;<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[elemID], l, nInt, NPad, Wall_HeatFlux,</div>
<div class="line"><a name="l15558"></a><span class="lineno">15558</span>&#160;                          HeatFlux_Prescribed, solIntL, gradSolInt,</div>
<div class="line"><a name="l15559"></a><span class="lineno">15559</span>&#160;                          surfElem[l].metricCoorDerivFace.data(),</div>
<div class="line"><a name="l15560"></a><span class="lineno">15560</span>&#160;                          surfElem[l].metricNormalsFace.data(),</div>
<div class="line"><a name="l15561"></a><span class="lineno">15561</span>&#160;                          surfElem[l].<a class="code" href="class_c_volume_element_f_e_m.html#abcd8ed2e51e1429b0f164086419a40ff">wallDistance</a>.data(),</div>
<div class="line"><a name="l15562"></a><span class="lineno">15562</span>&#160;                          viscFluxes, viscosityInt, kOverCvInt);</div>
<div class="line"><a name="l15563"></a><span class="lineno">15563</span>&#160;  }</div>
<div class="line"><a name="l15564"></a><span class="lineno">15564</span>&#160;}</div>
<div class="line"><a name="l15565"></a><span class="lineno">15565</span>&#160; </div>
<div class="line"><a name="l15566"></a><span class="lineno">15566</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::WallTreatmentViscousFluxes(</div>
<div class="line"><a name="l15567"></a><span class="lineno">15567</span>&#160;                                  <a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l15568"></a><span class="lineno">15568</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l15569"></a><span class="lineno">15569</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l15570"></a><span class="lineno">15570</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nInt,</div>
<div class="line"><a name="l15571"></a><span class="lineno">15571</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          Wall_HeatFlux,</div>
<div class="line"><a name="l15572"></a><span class="lineno">15572</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">bool</span>               HeatFlux_Prescribed,</div>
<div class="line"><a name="l15573"></a><span class="lineno">15573</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          Wall_Temperature,</div>
<div class="line"><a name="l15574"></a><span class="lineno">15574</span>&#160;                                  <span class="keyword">const</span> <span class="keywordtype">bool</span>               Temperature_Prescribed,</div>
<div class="line"><a name="l15575"></a><span class="lineno">15575</span>&#160;                                  <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l15576"></a><span class="lineno">15576</span>&#160;                                        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *workArray,</div>
<div class="line"><a name="l15577"></a><span class="lineno">15577</span>&#160;                                        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *viscFluxes,</div>
<div class="line"><a name="l15578"></a><span class="lineno">15578</span>&#160;                                        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *viscosityInt,</div>
<div class="line"><a name="l15579"></a><span class="lineno">15579</span>&#160;                                        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *kOverCvInt,</div>
<div class="line"><a name="l15580"></a><span class="lineno">15580</span>&#160;                                        <a class="code" href="class_c_wall_model.html">CWallModel</a>         *wallModel) {</div>
<div class="line"><a name="l15581"></a><span class="lineno">15581</span>&#160; </div>
<div class="line"><a name="l15582"></a><span class="lineno">15582</span>&#160;  <span class="comment">/* Loop over the simultaneously treated faces. */</span></div>
<div class="line"><a name="l15583"></a><span class="lineno">15583</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l15584"></a><span class="lineno">15584</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15585"></a><span class="lineno">15585</span>&#160; </div>
<div class="line"><a name="l15586"></a><span class="lineno">15586</span>&#160;    <span class="comment">/* Loop over the donors for this boundary face. */</span></div>
<div class="line"><a name="l15587"></a><span class="lineno">15587</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> j=0; j&lt;surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a7a048944dcc446cbc2fc2128bfa425cc">donorsWallFunction</a>.size(); ++j) {</div>
<div class="line"><a name="l15588"></a><span class="lineno">15588</span>&#160; </div>
<div class="line"><a name="l15589"></a><span class="lineno">15589</span>&#160;      <span class="comment">/* Easier storage of the element ID of the donor and set the pointer</span></div>
<div class="line"><a name="l15590"></a><span class="lineno">15590</span>&#160;<span class="comment">         where the solution of this element starts. Note that by construction</span></div>
<div class="line"><a name="l15591"></a><span class="lineno">15591</span>&#160;<span class="comment">         the time level of the donor element is the same as the time level</span></div>
<div class="line"><a name="l15592"></a><span class="lineno">15592</span>&#160;<span class="comment">         of the boundary face. */</span></div>
<div class="line"><a name="l15593"></a><span class="lineno">15593</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> donorID    = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a7a048944dcc446cbc2fc2128bfa425cc">donorsWallFunction</a>[j];</div>
<div class="line"><a name="l15594"></a><span class="lineno">15594</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> timeLevel = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[donorID].<a class="code" href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">timeLevel</a>;</div>
<div class="line"><a name="l15595"></a><span class="lineno">15595</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[donorID].<a class="code" href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">nDOFsSol</a>;</div>
<div class="line"><a name="l15596"></a><span class="lineno">15596</span>&#160;      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solDOFsElem   = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">VecWorkSolDOFs</a>[timeLevel].data()</div>
<div class="line"><a name="l15597"></a><span class="lineno">15597</span>&#160;                                     + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[donorID].<a class="code" href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">offsetDOFsSolThisTimeLevel</a>;</div>
<div class="line"><a name="l15598"></a><span class="lineno">15598</span>&#160; </div>
<div class="line"><a name="l15599"></a><span class="lineno">15599</span>&#160;      <span class="comment">/* Determine the number of integration points for this donor and</span></div>
<div class="line"><a name="l15600"></a><span class="lineno">15600</span>&#160;<span class="comment">         interpolate the solution for the corresponding exchange points. */</span></div>
<div class="line"><a name="l15601"></a><span class="lineno">15601</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nIntThisDonor = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j+1]</div>
<div class="line"><a name="l15602"></a><span class="lineno">15602</span>&#160;                                         - surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j];</div>
<div class="line"><a name="l15603"></a><span class="lineno">15603</span>&#160; </div>
<div class="line"><a name="l15604"></a><span class="lineno">15604</span>&#160;      <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nIntThisDonor, <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>, nDOFsElem, surfElem[l].matWallFunctionDonor[j].data(),</div>
<div class="line"><a name="l15605"></a><span class="lineno">15605</span>&#160;                          solDOFsElem, workArray, config);</div>
<div class="line"><a name="l15606"></a><span class="lineno">15606</span>&#160; </div>
<div class="line"><a name="l15607"></a><span class="lineno">15607</span>&#160;      <span class="comment">/* Loop over the integration points for this donor element. */</span></div>
<div class="line"><a name="l15608"></a><span class="lineno">15608</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=surfElem[l].nIntPerWallFunctionDonor[j];</div>
<div class="line"><a name="l15609"></a><span class="lineno">15609</span>&#160;                         i&lt;surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j+1]; ++i) {</div>
<div class="line"><a name="l15610"></a><span class="lineno">15610</span>&#160; </div>
<div class="line"><a name="l15611"></a><span class="lineno">15611</span>&#160;        <span class="comment">/* Easier storage of the actual integration point. */</span></div>
<div class="line"><a name="l15612"></a><span class="lineno">15612</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ii = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#aa6f58573b6ae42747d3e98e1497d76f1">intPerWallFunctionDonor</a>[i];</div>
<div class="line"><a name="l15613"></a><span class="lineno">15613</span>&#160; </div>
<div class="line"><a name="l15614"></a><span class="lineno">15614</span>&#160;        <span class="comment">/* Determine the normal and the wall velocity for this integration point. */</span></div>
<div class="line"><a name="l15615"></a><span class="lineno">15615</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normals = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data() + ii*(<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>+1);</div>
<div class="line"><a name="l15616"></a><span class="lineno">15616</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *gridVel = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data() + ii*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>;</div>
<div class="line"><a name="l15617"></a><span class="lineno">15617</span>&#160; </div>
<div class="line"><a name="l15618"></a><span class="lineno">15618</span>&#160;        <span class="comment">/* Determine the velocities and pressure in the exchange point. */</span></div>
<div class="line"><a name="l15619"></a><span class="lineno">15619</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *solInt = workArray</div>
<div class="line"><a name="l15620"></a><span class="lineno">15620</span>&#160;                                + <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*(i-surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#aae397626d48e4506157b9c4d7df06ab4">nIntPerWallFunctionDonor</a>[j]);</div>
<div class="line"><a name="l15621"></a><span class="lineno">15621</span>&#160; </div>
<div class="line"><a name="l15622"></a><span class="lineno">15622</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> rhoInv = 1.0/solInt[0];</div>
<div class="line"><a name="l15623"></a><span class="lineno">15623</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel[]  = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l15624"></a><span class="lineno">15624</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) vel[k] = rhoInv*solInt[k+1];</div>
<div class="line"><a name="l15625"></a><span class="lineno">15625</span>&#160; </div>
<div class="line"><a name="l15626"></a><span class="lineno">15626</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> vel2Mag = vel[0]*vel[0] + vel[1]*vel[1] + vel[2]*vel[2];</div>
<div class="line"><a name="l15627"></a><span class="lineno">15627</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> eInt    = rhoInv*solInt[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] - 0.5*vel2Mag;</div>
<div class="line"><a name="l15628"></a><span class="lineno">15628</span>&#160; </div>
<div class="line"><a name="l15629"></a><span class="lineno">15629</span>&#160;        <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">SetTDState_rhoe</a>(solInt[0], eInt);</div>
<div class="line"><a name="l15630"></a><span class="lineno">15630</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Pressure = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">GetPressure</a>();</div>
<div class="line"><a name="l15631"></a><span class="lineno">15631</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> Temperature = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aeba3f29d27211ff50acad59477105969">GetTemperature</a>();</div>
<div class="line"><a name="l15632"></a><span class="lineno">15632</span>&#160;        <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> LaminarViscosity= <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">FluidModel</a>-&gt;<a class="code" href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">GetLaminarViscosity</a>();</div>
<div class="line"><a name="l15633"></a><span class="lineno">15633</span>&#160; </div>
<div class="line"><a name="l15634"></a><span class="lineno">15634</span>&#160;        <span class="comment">/* Subtract the prescribed wall velocity, i.e. grid velocity</span></div>
<div class="line"><a name="l15635"></a><span class="lineno">15635</span>&#160;<span class="comment">           from the velocity in the exchange point. */</span></div>
<div class="line"><a name="l15636"></a><span class="lineno">15636</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) vel[k] -= gridVel[k];</div>
<div class="line"><a name="l15637"></a><span class="lineno">15637</span>&#160; </div>
<div class="line"><a name="l15638"></a><span class="lineno">15638</span>&#160;        <span class="comment">/* Determine the tangential velocity by subtracting the normal</span></div>
<div class="line"><a name="l15639"></a><span class="lineno">15639</span>&#160;<span class="comment">           velocity component. */</span></div>
<div class="line"><a name="l15640"></a><span class="lineno">15640</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velNorm = 0.0;</div>
<div class="line"><a name="l15641"></a><span class="lineno">15641</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) velNorm += normals[k]*vel[k];</div>
<div class="line"><a name="l15642"></a><span class="lineno">15642</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) vel[k]  -= normals[k]*velNorm;</div>
<div class="line"><a name="l15643"></a><span class="lineno">15643</span>&#160; </div>
<div class="line"><a name="l15644"></a><span class="lineno">15644</span>&#160;        <span class="comment">/* Determine the magnitude of the tangential velocity as well</span></div>
<div class="line"><a name="l15645"></a><span class="lineno">15645</span>&#160;<span class="comment">           as its direction (unit vector). */</span></div>
<div class="line"><a name="l15646"></a><span class="lineno">15646</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velTan = sqrt(vel[0]*vel[0] + vel[1]*vel[1] + vel[2]*vel[2]);</div>
<div class="line"><a name="l15647"></a><span class="lineno">15647</span>&#160;        velTan = max(velTan,1.e-25);</div>
<div class="line"><a name="l15648"></a><span class="lineno">15648</span>&#160; </div>
<div class="line"><a name="l15649"></a><span class="lineno">15649</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> dirTan[] = {0.0, 0.0, 0.0};</div>
<div class="line"><a name="l15650"></a><span class="lineno">15650</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k) dirTan[k] = vel[k]/velTan;</div>
<div class="line"><a name="l15651"></a><span class="lineno">15651</span>&#160;        </div>
<div class="line"><a name="l15652"></a><span class="lineno">15652</span>&#160;        <span class="comment">/* Compute the wall shear stress and heat flux vector using</span></div>
<div class="line"><a name="l15653"></a><span class="lineno">15653</span>&#160;<span class="comment">           the wall model. */</span></div>
<div class="line"><a name="l15654"></a><span class="lineno">15654</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> tauWall, qWall, ViscosityWall, kOverCvWall;</div>
<div class="line"><a name="l15655"></a><span class="lineno">15655</span>&#160;        </div>
<div class="line"><a name="l15656"></a><span class="lineno">15656</span>&#160;        wallModel-&gt;<a class="code" href="class_c_wall_model.html#a813b1c83b53bfa4f76e2ac228067459f">WallShearStressAndHeatFlux</a>(Temperature, velTan, LaminarViscosity, Pressure,</div>
<div class="line"><a name="l15657"></a><span class="lineno">15657</span>&#160;                                              Wall_HeatFlux, HeatFlux_Prescribed,</div>
<div class="line"><a name="l15658"></a><span class="lineno">15658</span>&#160;                                              Wall_Temperature, Temperature_Prescribed,</div>
<div class="line"><a name="l15659"></a><span class="lineno">15659</span>&#160;                                              tauWall, qWall, ViscosityWall, kOverCvWall);</div>
<div class="line"><a name="l15660"></a><span class="lineno">15660</span>&#160;        <span class="comment">/* Determine the position where the viscous fluxes, viscosity and</span></div>
<div class="line"><a name="l15661"></a><span class="lineno">15661</span>&#160;<span class="comment">           thermal conductivity must be stored. */</span></div>
<div class="line"><a name="l15662"></a><span class="lineno">15662</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *normalFlux = viscFluxes + NPad*ii + llNVar;</div>
<div class="line"><a name="l15663"></a><span class="lineno">15663</span>&#160; </div>
<div class="line"><a name="l15664"></a><span class="lineno">15664</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind = l*nInt + ii;</div>
<div class="line"><a name="l15665"></a><span class="lineno">15665</span>&#160;        viscosityInt[ind] = ViscosityWall;</div>
<div class="line"><a name="l15666"></a><span class="lineno">15666</span>&#160;        kOverCvInt[ind]   = kOverCvWall;</div>
<div class="line"><a name="l15667"></a><span class="lineno">15667</span>&#160; </div>
<div class="line"><a name="l15668"></a><span class="lineno">15668</span>&#160;        <span class="comment">/* Compute the prescribed velocity in tangential direction. */</span></div>
<div class="line"><a name="l15669"></a><span class="lineno">15669</span>&#160;        <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> velTanPrescribed = 0.0;</div>
<div class="line"><a name="l15670"></a><span class="lineno">15670</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k)</div>
<div class="line"><a name="l15671"></a><span class="lineno">15671</span>&#160;          velTanPrescribed += gridVel[k]*dirTan[k];</div>
<div class="line"><a name="l15672"></a><span class="lineno">15672</span>&#160; </div>
<div class="line"><a name="l15673"></a><span class="lineno">15673</span>&#160;        <span class="comment">/* Compute the viscous normal flux. Note that the unscaled normals</span></div>
<div class="line"><a name="l15674"></a><span class="lineno">15674</span>&#160;<span class="comment">           must be used, hence the multiplication with normals[nDim]. */</span></div>
<div class="line"><a name="l15675"></a><span class="lineno">15675</span>&#160;        normalFlux[0] = 0.0;</div>
<div class="line"><a name="l15676"></a><span class="lineno">15676</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> k=0; k&lt;<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>; ++k)</div>
<div class="line"><a name="l15677"></a><span class="lineno">15677</span>&#160;          normalFlux[k+1] = -normals[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*tauWall*dirTan[k];</div>
<div class="line"><a name="l15678"></a><span class="lineno">15678</span>&#160;        normalFlux[<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>-1] = normals[<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>]*(qWall - tauWall*velTanPrescribed);</div>
<div class="line"><a name="l15679"></a><span class="lineno">15679</span>&#160;      }</div>
<div class="line"><a name="l15680"></a><span class="lineno">15680</span>&#160;    }</div>
<div class="line"><a name="l15681"></a><span class="lineno">15681</span>&#160;  }</div>
<div class="line"><a name="l15682"></a><span class="lineno">15682</span>&#160;}</div>
<div class="line"><a name="l15683"></a><span class="lineno">15683</span>&#160; </div>
<div class="line"><a name="l15684"></a><span class="lineno">15684</span>&#160;<span class="keywordtype">void</span> CFEM_DG_NSSolver::ResidualViscousBoundaryFace(</div>
<div class="line"><a name="l15685"></a><span class="lineno">15685</span>&#160;                                      <a class="code" href="class_c_config.html">CConfig</a>                  *config,</div>
<div class="line"><a name="l15686"></a><span class="lineno">15686</span>&#160;                                      <a class="code" href="class_c_numerics.html">CNumerics</a>                *conv_numerics,</div>
<div class="line"><a name="l15687"></a><span class="lineno">15687</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     nFaceSimul,</div>
<div class="line"><a name="l15688"></a><span class="lineno">15688</span>&#160;                                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span>     NPad,</div>
<div class="line"><a name="l15689"></a><span class="lineno">15689</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a> *surfElem,</div>
<div class="line"><a name="l15690"></a><span class="lineno">15690</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *solInt0,</div>
<div class="line"><a name="l15691"></a><span class="lineno">15691</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *solInt1,</div>
<div class="line"><a name="l15692"></a><span class="lineno">15692</span>&#160;                                      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *paramFluxes,</div>
<div class="line"><a name="l15693"></a><span class="lineno">15693</span>&#160;                                      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *fluxes,</div>
<div class="line"><a name="l15694"></a><span class="lineno">15694</span>&#160;                                      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *viscFluxes,</div>
<div class="line"><a name="l15695"></a><span class="lineno">15695</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *viscosityInt,</div>
<div class="line"><a name="l15696"></a><span class="lineno">15696</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>          *kOverCvInt,</div>
<div class="line"><a name="l15697"></a><span class="lineno">15697</span>&#160;                                      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>                *resFaces,</div>
<div class="line"><a name="l15698"></a><span class="lineno">15698</span>&#160;                                      <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>            &amp;indResFaces) {</div>
<div class="line"><a name="l15699"></a><span class="lineno">15699</span>&#160; </div>
<div class="line"><a name="l15700"></a><span class="lineno">15700</span>&#160;  <span class="comment">/* Easier storage of the number of bytes to copy in the memcpy calls. */</span></div>
<div class="line"><a name="l15701"></a><span class="lineno">15701</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nBytes = <a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*<span class="keyword">sizeof</span>(<a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>);</div>
<div class="line"><a name="l15702"></a><span class="lineno">15702</span>&#160; </div>
<div class="line"><a name="l15703"></a><span class="lineno">15703</span>&#160;  <span class="comment">/*--- Get the required information from the standard element, which is the</span></div>
<div class="line"><a name="l15704"></a><span class="lineno">15704</span>&#160;<span class="comment">        same for all faces considered. ---*/</span></div>
<div class="line"><a name="l15705"></a><span class="lineno">15705</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> ind          = surfElem[0].<a class="code" href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">indStandardElement</a>;</div>
<div class="line"><a name="l15706"></a><span class="lineno">15706</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nInt         = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">GetNIntegration</a>();</div>
<div class="line"><a name="l15707"></a><span class="lineno">15707</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFs        = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a26266f4d68d95c22bbb949fe6d8f5db6">GetNDOFsFace</a>();</div>
<div class="line"><a name="l15708"></a><span class="lineno">15708</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nDOFsElem    = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#aad6afe2fa8d35697a57dfc22a7542176">GetNDOFsElem</a>();</div>
<div class="line"><a name="l15709"></a><span class="lineno">15709</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>      ConstPenFace = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#aa2e4984684567bfa78f6556ad41a7c9c">GetPenaltyConstant</a>();</div>
<div class="line"><a name="l15710"></a><span class="lineno">15710</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>     *weights      = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">GetWeightsIntegration</a>();</div>
<div class="line"><a name="l15711"></a><span class="lineno">15711</span>&#160; </div>
<div class="line"><a name="l15712"></a><span class="lineno">15712</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l15713"></a><span class="lineno">15713</span>&#160;  <span class="comment">/*--- Step 1: Compute the sum of the inviscid, viscous and penalty     ---*/</span></div>
<div class="line"><a name="l15714"></a><span class="lineno">15714</span>&#160;  <span class="comment">/*---         fluxes in the integration points of the faces.           ---*/</span></div>
<div class="line"><a name="l15715"></a><span class="lineno">15715</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l15716"></a><span class="lineno">15716</span>&#160; </div>
<div class="line"><a name="l15717"></a><span class="lineno">15717</span>&#160;  <span class="comment">/* Store the normals and grid velocities of the faces in an array of</span></div>
<div class="line"><a name="l15718"></a><span class="lineno">15718</span>&#160;<span class="comment">     pointers to be used in the call to ComputeInviscidFluxesFace. */</span></div>
<div class="line"><a name="l15719"></a><span class="lineno">15719</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>* arrNorm[<a class="code" href="solver__direct__mean__fem_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>];</div>
<div class="line"><a name="l15720"></a><span class="lineno">15720</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a>* arrGridVel[<a class="code" href="solver__direct__mean__fem_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>];</div>
<div class="line"><a name="l15721"></a><span class="lineno">15721</span>&#160; </div>
<div class="line"><a name="l15722"></a><span class="lineno">15722</span>&#160;  <span class="keywordflow">if</span>(nFaceSimul &gt; <a class="code" href="solver__direct__mean__fem_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a>)</div>
<div class="line"><a name="l15723"></a><span class="lineno">15723</span>&#160;    <a class="code" href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">SU2_MPI::Error</a>(<span class="stringliteral">&quot;SIZE_ARR_NORM is too small. Increase it or decrease ALIGNED_BYTES_MATMUL&quot;</span>,</div>
<div class="line"><a name="l15724"></a><span class="lineno">15724</span>&#160;                   <a class="code" href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a>);</div>
<div class="line"><a name="l15725"></a><span class="lineno">15725</span>&#160; </div>
<div class="line"><a name="l15726"></a><span class="lineno">15726</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l15727"></a><span class="lineno">15727</span>&#160;    arrNorm[l]    = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">metricNormalsFace</a>.data();</div>
<div class="line"><a name="l15728"></a><span class="lineno">15728</span>&#160;    arrGridVel[l] = surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a75e3433e592f810c39db50d1377b0509">gridVelocities</a>.data();</div>
<div class="line"><a name="l15729"></a><span class="lineno">15729</span>&#160;  }</div>
<div class="line"><a name="l15730"></a><span class="lineno">15730</span>&#160; </div>
<div class="line"><a name="l15731"></a><span class="lineno">15731</span>&#160;  <span class="comment">/* General function to compute the inviscid fluxes, using an approximate</span></div>
<div class="line"><a name="l15732"></a><span class="lineno">15732</span>&#160;<span class="comment">     Riemann solver in the integration points. */</span></div>
<div class="line"><a name="l15733"></a><span class="lineno">15733</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a4851d39829e12202592d85c36ea36489">ComputeInviscidFluxesFace</a>(config, nFaceSimul, NPad, nInt, arrNorm, arrGridVel,</div>
<div class="line"><a name="l15734"></a><span class="lineno">15734</span>&#160;                            solInt0, solInt1, fluxes, conv_numerics);</div>
<div class="line"><a name="l15735"></a><span class="lineno">15735</span>&#160; </div>
<div class="line"><a name="l15736"></a><span class="lineno">15736</span>&#160;  <span class="comment">/* Subtract the viscous fluxes from the inviscid fluxes. */</span></div>
<div class="line"><a name="l15737"></a><span class="lineno">15737</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;(NPad*nInt); ++j) fluxes[j] -= viscFluxes[j];</div>
<div class="line"><a name="l15738"></a><span class="lineno">15738</span>&#160; </div>
<div class="line"><a name="l15739"></a><span class="lineno">15739</span>&#160;  <span class="comment">/*--- Loop over the faces in this chunk to compute the penalty fluxes. ---*/</span></div>
<div class="line"><a name="l15740"></a><span class="lineno">15740</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l15741"></a><span class="lineno">15741</span>&#160; </div>
<div class="line"><a name="l15742"></a><span class="lineno">15742</span>&#160;    <span class="comment">/* Get the length scale for the adjacent element. */</span></div>
<div class="line"><a name="l15743"></a><span class="lineno">15743</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> lenScale = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">volElem</a>[surfElem[l].<a class="code" href="class_c_surface_element_f_e_m.html#a01bc57f549254d1a4c48b56de5c135c6">volElemID</a>].<a class="code" href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">lenScale</a>;</div>
<div class="line"><a name="l15744"></a><span class="lineno">15744</span>&#160; </div>
<div class="line"><a name="l15745"></a><span class="lineno">15745</span>&#160;    <span class="comment">/* Call the function PenaltyTermsFluxFace to compute the actual penalty</span></div>
<div class="line"><a name="l15746"></a><span class="lineno">15746</span>&#160;<span class="comment">       terms. Use the array viscFluxes as storage. */</span></div>
<div class="line"><a name="l15747"></a><span class="lineno">15747</span>&#160;    PenaltyTermsFluxFace(l, nInt, NPad, solInt0, solInt1, viscosityInt,</div>
<div class="line"><a name="l15748"></a><span class="lineno">15748</span>&#160;                         viscosityInt, kOverCvInt, kOverCvInt, ConstPenFace,</div>
<div class="line"><a name="l15749"></a><span class="lineno">15749</span>&#160;                         lenScale, lenScale, surfElem[l].metricNormalsFace.data(),</div>
<div class="line"><a name="l15750"></a><span class="lineno">15750</span>&#160;                         viscFluxes);</div>
<div class="line"><a name="l15751"></a><span class="lineno">15751</span>&#160;  }</div>
<div class="line"><a name="l15752"></a><span class="lineno">15752</span>&#160; </div>
<div class="line"><a name="l15753"></a><span class="lineno">15753</span>&#160;  <span class="comment">/* Add the penalty fluxes to the earlier computed fluxes. */</span></div>
<div class="line"><a name="l15754"></a><span class="lineno">15754</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;(NPad*nInt); ++j) fluxes[j] += viscFluxes[j];</div>
<div class="line"><a name="l15755"></a><span class="lineno">15755</span>&#160; </div>
<div class="line"><a name="l15756"></a><span class="lineno">15756</span>&#160;  <span class="comment">/* Multiply the fluxes with the integration weight of the corresponding</span></div>
<div class="line"><a name="l15757"></a><span class="lineno">15757</span>&#160;<span class="comment">     integration point. */</span></div>
<div class="line"><a name="l15758"></a><span class="lineno">15758</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nInt; ++i) {</div>
<div class="line"><a name="l15759"></a><span class="lineno">15759</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *flux = fluxes + i*NPad;</div>
<div class="line"><a name="l15760"></a><span class="lineno">15760</span>&#160; </div>
<div class="line"><a name="l15761"></a><span class="lineno">15761</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> j=0; j&lt;NPad; ++j)</div>
<div class="line"><a name="l15762"></a><span class="lineno">15762</span>&#160;      flux[j] *= weights[i];</div>
<div class="line"><a name="l15763"></a><span class="lineno">15763</span>&#160;  }</div>
<div class="line"><a name="l15764"></a><span class="lineno">15764</span>&#160; </div>
<div class="line"><a name="l15765"></a><span class="lineno">15765</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l15766"></a><span class="lineno">15766</span>&#160;  <span class="comment">/*--- Step 2: Compute the contribution to the residuals from the       ---*/</span></div>
<div class="line"><a name="l15767"></a><span class="lineno">15767</span>&#160;  <span class="comment">/*---         integration over the surface element of the invisid      ---*/</span></div>
<div class="line"><a name="l15768"></a><span class="lineno">15768</span>&#160;  <span class="comment">/*---         fluxes, viscous fluxes and penalty terms.                ---*/</span></div>
<div class="line"><a name="l15769"></a><span class="lineno">15769</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l15770"></a><span class="lineno">15770</span>&#160; </div>
<div class="line"><a name="l15771"></a><span class="lineno">15771</span>&#160;  <span class="comment">/* Set the value of the offset of the residual between each of the</span></div>
<div class="line"><a name="l15772"></a><span class="lineno">15772</span>&#160;<span class="comment">     faces. This depends whether or not symmetrizing terms are stored.</span></div>
<div class="line"><a name="l15773"></a><span class="lineno">15773</span>&#160;<span class="comment">     Also set the location where the symmetrizing terms of the first face</span></div>
<div class="line"><a name="l15774"></a><span class="lineno">15774</span>&#160;<span class="comment">     must be stored. */</span></div>
<div class="line"><a name="l15775"></a><span class="lineno">15775</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> offsetRes = nDOFs;</div>
<div class="line"><a name="l15776"></a><span class="lineno">15776</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) offsetRes += nDOFsElem;</div>
<div class="line"><a name="l15777"></a><span class="lineno">15777</span>&#160; </div>
<div class="line"><a name="l15778"></a><span class="lineno">15778</span>&#160;  <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> indResSym = indResFaces + nDOFs;</div>
<div class="line"><a name="l15779"></a><span class="lineno">15779</span>&#160; </div>
<div class="line"><a name="l15780"></a><span class="lineno">15780</span>&#160;  <span class="comment">/* Get the correct form of the basis functions needed for the matrix</span></div>
<div class="line"><a name="l15781"></a><span class="lineno">15781</span>&#160;<span class="comment">     multiplication to compute the residual. */</span></div>
<div class="line"><a name="l15782"></a><span class="lineno">15782</span>&#160;  <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *basisFaceTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a2d12edcf4ade4e05af14d9c9f2fa6e07">GetBasisFaceIntegrationTranspose</a>();</div>
<div class="line"><a name="l15783"></a><span class="lineno">15783</span>&#160; </div>
<div class="line"><a name="l15784"></a><span class="lineno">15784</span>&#160;  <span class="comment">/* Call the general function to carry out the matrix product. Use viscFluxes</span></div>
<div class="line"><a name="l15785"></a><span class="lineno">15785</span>&#160;<span class="comment">     as temporary storage for the result. */</span></div>
<div class="line"><a name="l15786"></a><span class="lineno">15786</span>&#160;  <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFs, NPad, nInt, basisFaceTrans, fluxes, viscFluxes, config);</div>
<div class="line"><a name="l15787"></a><span class="lineno">15787</span>&#160; </div>
<div class="line"><a name="l15788"></a><span class="lineno">15788</span>&#160;  <span class="comment">/* Loop over the number of faces in this chunk to store the residual in</span></div>
<div class="line"><a name="l15789"></a><span class="lineno">15789</span>&#160;<span class="comment">     the correct locations in resFaces. */</span></div>
<div class="line"><a name="l15790"></a><span class="lineno">15790</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l15791"></a><span class="lineno">15791</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15792"></a><span class="lineno">15792</span>&#160; </div>
<div class="line"><a name="l15793"></a><span class="lineno">15793</span>&#160;    <span class="comment">/* Easier storage of the position in the residual array for this face</span></div>
<div class="line"><a name="l15794"></a><span class="lineno">15794</span>&#160;<span class="comment">       and update the corresponding counter. */</span></div>
<div class="line"><a name="l15795"></a><span class="lineno">15795</span>&#160;    <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resFace = resFaces + indResFaces*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15796"></a><span class="lineno">15796</span>&#160;    indResFaces       += offsetRes;</div>
<div class="line"><a name="l15797"></a><span class="lineno">15797</span>&#160; </div>
<div class="line"><a name="l15798"></a><span class="lineno">15798</span>&#160;    <span class="comment">/* Loop over the DOFs and copy the data. */</span></div>
<div class="line"><a name="l15799"></a><span class="lineno">15799</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFs; ++i)</div>
<div class="line"><a name="l15800"></a><span class="lineno">15800</span>&#160;      memcpy(resFace+<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i, viscFluxes+NPad*i+llNVar, nBytes);</div>
<div class="line"><a name="l15801"></a><span class="lineno">15801</span>&#160;  }</div>
<div class="line"><a name="l15802"></a><span class="lineno">15802</span>&#160; </div>
<div class="line"><a name="l15803"></a><span class="lineno">15803</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l15804"></a><span class="lineno">15804</span>&#160;  <span class="comment">/*--- Step 3: Compute and distribute the symmetrizing terms, if        ---*/</span></div>
<div class="line"><a name="l15805"></a><span class="lineno">15805</span>&#160;  <span class="comment">/*---         present. Note that these terms must be distributed to    ---*/</span></div>
<div class="line"><a name="l15806"></a><span class="lineno">15806</span>&#160;  <span class="comment">/*---         DOFs of the adjacent element, not only of the face.      ---*/</span></div>
<div class="line"><a name="l15807"></a><span class="lineno">15807</span>&#160;  <span class="comment">/*------------------------------------------------------------------------*/</span></div>
<div class="line"><a name="l15808"></a><span class="lineno">15808</span>&#160; </div>
<div class="line"><a name="l15809"></a><span class="lineno">15809</span>&#160;  <span class="keywordflow">if</span>( <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">symmetrizingTermsPresent</a> ) {</div>
<div class="line"><a name="l15810"></a><span class="lineno">15810</span>&#160; </div>
<div class="line"><a name="l15811"></a><span class="lineno">15811</span>&#160;    <span class="comment">/* The symmetrizing fluxes will be multiplied by 0.5 times the theta</span></div>
<div class="line"><a name="l15812"></a><span class="lineno">15812</span>&#160;<span class="comment">       parameter. Store this factor a bit easier. */</span></div>
<div class="line"><a name="l15813"></a><span class="lineno">15813</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> halfTheta = 0.5*config-&gt;<a class="code" href="class_c_config.html#aebb368493e43eb306cf65de037c2e9bc">GetTheta_Interior_Penalty_DGFEM</a>();</div>
<div class="line"><a name="l15814"></a><span class="lineno">15814</span>&#160; </div>
<div class="line"><a name="l15815"></a><span class="lineno">15815</span>&#160;    <span class="comment">/* Loop over the simultaneously treated faces. */</span></div>
<div class="line"><a name="l15816"></a><span class="lineno">15816</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l15817"></a><span class="lineno">15817</span>&#160; </div>
<div class="line"><a name="l15818"></a><span class="lineno">15818</span>&#160;      <span class="comment">/* Compute the symmetrizing fluxes in the nDim directions. */</span></div>
<div class="line"><a name="l15819"></a><span class="lineno">15819</span>&#160;      SymmetrizingFluxesFace(l, nInt, NPad, solInt0, solInt1, viscosityInt,</div>
<div class="line"><a name="l15820"></a><span class="lineno">15820</span>&#160;                             viscosityInt, kOverCvInt, kOverCvInt,</div>
<div class="line"><a name="l15821"></a><span class="lineno">15821</span>&#160;                             surfElem[l].metricNormalsFace.data(), fluxes);</div>
<div class="line"><a name="l15822"></a><span class="lineno">15822</span>&#160; </div>
<div class="line"><a name="l15823"></a><span class="lineno">15823</span>&#160;      <span class="comment">/* Transform the fluxes, such that they must be multiplied with the</span></div>
<div class="line"><a name="l15824"></a><span class="lineno">15824</span>&#160;<span class="comment">         gradients w.r.t. the parametric coordinates rather than the</span></div>
<div class="line"><a name="l15825"></a><span class="lineno">15825</span>&#160;<span class="comment">         Cartesian coordinates of the basis functions. Also a multiplication</span></div>
<div class="line"><a name="l15826"></a><span class="lineno">15826</span>&#160;<span class="comment">         with the integration weight and the theta parameter is carried out. */</span></div>
<div class="line"><a name="l15827"></a><span class="lineno">15827</span>&#160;      TransformSymmetrizingFluxes(l, nInt, NPad, halfTheta, fluxes, weights,</div>
<div class="line"><a name="l15828"></a><span class="lineno">15828</span>&#160;                                  surfElem[l].metricCoorDerivFace.data(),</div>
<div class="line"><a name="l15829"></a><span class="lineno">15829</span>&#160;                                  paramFluxes);</div>
<div class="line"><a name="l15830"></a><span class="lineno">15830</span>&#160;    }</div>
<div class="line"><a name="l15831"></a><span class="lineno">15831</span>&#160; </div>
<div class="line"><a name="l15832"></a><span class="lineno">15832</span>&#160;    <span class="comment">/* Call the general function to carry out the matrix product to compute</span></div>
<div class="line"><a name="l15833"></a><span class="lineno">15833</span>&#160;<span class="comment">       the residual. Use fluxes as temporary storage for the result. */</span></div>
<div class="line"><a name="l15834"></a><span class="lineno">15834</span>&#160;    <span class="keyword">const</span> <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *derBasisElemTrans = <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">standardBoundaryFacesSol</a>[ind].<a class="code" href="class_c_f_e_m_standard_boundary_face.html#a60da212d9394abf0741c61fa2a955ced">GetMatDerBasisElemIntegrationTranspose</a>();</div>
<div class="line"><a name="l15835"></a><span class="lineno">15835</span>&#160; </div>
<div class="line"><a name="l15836"></a><span class="lineno">15836</span>&#160;    <a class="code" href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">blasFunctions</a>-&gt;<a class="code" href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">gemm</a>(nDOFsElem, NPad, nInt*<a class="code" href="class_c_solver.html#a203241aa245597347fb258fac60962f6">nDim</a>, derBasisElemTrans, paramFluxes, fluxes, config);</div>
<div class="line"><a name="l15837"></a><span class="lineno">15837</span>&#160; </div>
<div class="line"><a name="l15838"></a><span class="lineno">15838</span>&#160;    <span class="comment">/* Loop over the faces of this chunk to store the residual in</span></div>
<div class="line"><a name="l15839"></a><span class="lineno">15839</span>&#160;<span class="comment">       the correct locations in resFaces. */</span></div>
<div class="line"><a name="l15840"></a><span class="lineno">15840</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> l=0; l&lt;nFaceSimul; ++l) {</div>
<div class="line"><a name="l15841"></a><span class="lineno">15841</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> llNVar = l*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15842"></a><span class="lineno">15842</span>&#160; </div>
<div class="line"><a name="l15843"></a><span class="lineno">15843</span>&#160;      <span class="comment">/* Easier storage of the position in the residual array for this face</span></div>
<div class="line"><a name="l15844"></a><span class="lineno">15844</span>&#160;<span class="comment">         and update the corresponding counter. */</span></div>
<div class="line"><a name="l15845"></a><span class="lineno">15845</span>&#160;      <a class="code" href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a> *resElem = resFaces + indResSym*<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>;</div>
<div class="line"><a name="l15846"></a><span class="lineno">15846</span>&#160;      indResSym         += offsetRes;</div>
<div class="line"><a name="l15847"></a><span class="lineno">15847</span>&#160; </div>
<div class="line"><a name="l15848"></a><span class="lineno">15848</span>&#160;      <span class="comment">/* Loop over the DOFs of the element and copy the data. */</span></div>
<div class="line"><a name="l15849"></a><span class="lineno">15849</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> i=0; i&lt;nDOFsElem; ++i)</div>
<div class="line"><a name="l15850"></a><span class="lineno">15850</span>&#160;        memcpy(resElem+<a class="code" href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">nVar</a>*i, fluxes+NPad*i+llNVar, nBytes);</div>
<div class="line"><a name="l15851"></a><span class="lineno">15851</span>&#160;    }</div>
<div class="line"><a name="l15852"></a><span class="lineno">15852</span>&#160;  }</div>
<div class="line"><a name="l15853"></a><span class="lineno">15853</span>&#160;}</div>
<div class="ttc" id="aclass_c_base_m_p_i_wrapper_html_a04457c47629bda56704e6a8804833eeb"><div class="ttname"><a href="class_c_base_m_p_i_wrapper.html#a04457c47629bda56704e6a8804833eeb">CBaseMPIWrapper::Error</a></div><div class="ttdeci">static void Error(std::string ErrorMsg, std::string FunctionName)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8inl_source.html#l00479">mpi_structure.inl:479</a></div></div>
<div class="ttc" id="aclass_c_base_m_p_i_wrapper_html_a07f24df31c87ac960540ce8ac2b407d2"><div class="ttname"><a href="class_c_base_m_p_i_wrapper.html#a07f24df31c87ac960540ce8ac2b407d2">CBaseMPIWrapper::Barrier</a></div><div class="ttdeci">static void Barrier(Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8inl_source.html#l00513">mpi_structure.inl:513</a></div></div>
<div class="ttc" id="aclass_c_base_m_p_i_wrapper_html_a18215cfe692fc1e82232e155504c1711"><div class="ttname"><a href="class_c_base_m_p_i_wrapper.html#a18215cfe692fc1e82232e155504c1711">CBaseMPIWrapper::Probe</a></div><div class="ttdeci">static void Probe(int source, int tag, Comm comm, Status *status)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8inl_source.html#l00600">mpi_structure.inl:600</a></div></div>
<div class="ttc" id="aclass_c_base_m_p_i_wrapper_html_a2a0cf206352327fc745b3848b8c6d130"><div class="ttname"><a href="class_c_base_m_p_i_wrapper.html#a2a0cf206352327fc745b3848b8c6d130">CBaseMPIWrapper::Recv</a></div><div class="ttdeci">static void Recv(void *buf, int count, Datatype datatype, int dest, int tag, Comm comm, Status *status)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8inl_source.html#l00539">mpi_structure.inl:539</a></div></div>
<div class="ttc" id="aclass_c_base_m_p_i_wrapper_html_a2b80feee34755a59d180ab64eb2d712b"><div class="ttname"><a href="class_c_base_m_p_i_wrapper.html#a2b80feee34755a59d180ab64eb2d712b">CBaseMPIWrapper::Get_count</a></div><div class="ttdeci">static void Get_count(Status *status, Datatype datatype, int *count)</div></div>
<div class="ttc" id="aclass_c_base_m_p_i_wrapper_html_a43a415ec11a029ade218eaf8c807a817"><div class="ttname"><a href="class_c_base_m_p_i_wrapper.html#a43a415ec11a029ade218eaf8c807a817">CBaseMPIWrapper::Isend</a></div><div class="ttdeci">static void Isend(void *buf, int count, Datatype datatype, int dest, int tag, Comm comm, Request *request)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8inl_source.html#l00523">mpi_structure.inl:523</a></div></div>
<div class="ttc" id="aclass_c_base_m_p_i_wrapper_html_a55195abbb7206e08a4933fa53cd41923"><div class="ttname"><a href="class_c_base_m_p_i_wrapper.html#a55195abbb7206e08a4933fa53cd41923">CBaseMPIWrapper::Allgather</a></div><div class="ttdeci">static void Allgather(void *sendbuf, int sendcnt, Datatype sendtype, void *recvbuf, int recvcnt, Datatype recvtype, Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8inl_source.html#l00575">mpi_structure.inl:575</a></div></div>
<div class="ttc" id="aclass_c_base_m_p_i_wrapper_html_a637b6fd917a8ca91ce748ba88e0d66b6"><div class="ttname"><a href="class_c_base_m_p_i_wrapper.html#a637b6fd917a8ca91ce748ba88e0d66b6">CBaseMPIWrapper::Allreduce</a></div><div class="ttdeci">static void Allreduce(void *sendbuf, void *recvbuf, int count, Datatype datatype, Op op, Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8inl_source.html#l00553">mpi_structure.inl:553</a></div></div>
<div class="ttc" id="aclass_c_base_m_p_i_wrapper_html_a7a83091a6fcdc392a11be74734362eaa"><div class="ttname"><a href="class_c_base_m_p_i_wrapper.html#a7a83091a6fcdc392a11be74734362eaa">CBaseMPIWrapper::Waitall</a></div><div class="ttdeci">static void Waitall(int nrequests, Request *request, Status *status)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8inl_source.html#l00531">mpi_structure.inl:531</a></div></div>
<div class="ttc" id="aclass_c_base_m_p_i_wrapper_html_a860dfcee07be04be175e06d342e0fc68"><div class="ttname"><a href="class_c_base_m_p_i_wrapper.html#a860dfcee07be04be175e06d342e0fc68">CBaseMPIWrapper::Reduce</a></div><div class="ttdeci">static void Reduce(void *sendbuf, void *recvbuf, int count, Datatype datatype, Op op, int root, Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8inl_source.html#l00548">mpi_structure.inl:548</a></div></div>
<div class="ttc" id="aclass_c_base_m_p_i_wrapper_html_ae41565b441aee76e1b48eb03e5ac86dd"><div class="ttname"><a href="class_c_base_m_p_i_wrapper.html#ae41565b441aee76e1b48eb03e5ac86dd">CBaseMPIWrapper::Irecv</a></div><div class="ttdeci">static void Irecv(void *buf, int count, Datatype datatype, int source, int tag, Comm comm, Request *request)</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8inl_source.html#l00526">mpi_structure.inl:526</a></div></div>
<div class="ttc" id="aclass_c_blas_structure_html"><div class="ttname"><a href="class_c_blas_structure.html">CBlasStructure</a></div><div class="ttdoc">Class, which serves as an interface to the BLAS functionalities needed.</div><div class="ttdef"><b>Definition:</b> <a href="blas__structure_8hpp_source.html#l00050">blas_structure.hpp:50</a></div></div>
<div class="ttc" id="aclass_c_blas_structure_html_a40a585307895af828a7f51cd0ccbf81d"><div class="ttname"><a href="class_c_blas_structure.html#a40a585307895af828a7f51cd0ccbf81d">CBlasStructure::gemm</a></div><div class="ttdeci">void gemm(const int M, const int N, const int K, const su2double *A, const su2double *B, su2double *C, CConfig *config)</div><div class="ttdoc">Function, which carries out a dense matrix product. It is a limited version of the BLAS gemm function...</div><div class="ttdef"><b>Definition:</b> <a href="blas__structure_8cpp_source.html#l00061">blas_structure.cpp:61</a></div></div>
<div class="ttc" id="aclass_c_boundary_f_e_m_html_a56dc8a452cc81445b0349f49122942c8"><div class="ttname"><a href="class_c_boundary_f_e_m.html#a56dc8a452cc81445b0349f49122942c8">CBoundaryFEM::surfElem</a></div><div class="ttdeci">vector&lt; CSurfaceElementFEM &gt; surfElem</div><div class="ttdoc">Vector of the local surface elements.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00564">fem_geometry_structure.hpp:564</a></div></div>
<div class="ttc" id="aclass_c_boundary_f_e_m_html_ab955ab8e1e78b773c33cc1d1f705d7d4"><div class="ttname"><a href="class_c_boundary_f_e_m.html#ab955ab8e1e78b773c33cc1d1f705d7d4">CBoundaryFEM::nSurfElem</a></div><div class="ttdeci">vector&lt; unsigned long &gt; nSurfElem</div><div class="ttdoc">Number of surface elements per time level, cumulative storage format.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00561">fem_geometry_structure.hpp:561</a></div></div>
<div class="ttc" id="aclass_c_config_html"><div class="ttname"><a href="class_c_config.html">CConfig</a></div><div class="ttdoc">Main class for defining the problem; basically this class reads the configuration file,...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8hpp_source.html#l00071">config_structure.hpp:71</a></div></div>
<div class="ttc" id="aclass_c_config_html_a00454cff9575acd21239959b4030b192"><div class="ttname"><a href="class_c_config.html#a00454cff9575acd21239959b4030b192">CConfig::GetTemperature_FreeStreamND</a></div><div class="ttdeci">su2double GetTemperature_FreeStreamND(void)</div><div class="ttdoc">Get the value of the non-dimensionalized freestream temperature.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00540">config_structure.inl:540</a></div></div>
<div class="ttc" id="aclass_c_config_html_a03e72fe3f8576f2aecb234079607dc46"><div class="ttname"><a href="class_c_config.html#a03e72fe3f8576f2aecb234079607dc46">CConfig::SetDensity_FreeStream</a></div><div class="ttdeci">void SetDensity_FreeStream(su2double val_density_freestream)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00625">config_structure.inl:625</a></div></div>
<div class="ttc" id="aclass_c_config_html_a048053ffa126a91fc931109042a04fcb"><div class="ttname"><a href="class_c_config.html#a048053ffa126a91fc931109042a04fcb">CConfig::GetMu_Temperature_Ref</a></div><div class="ttdeci">su2double GetMu_Temperature_Ref(void)</div><div class="ttdoc">Get the value of the reference temperature for Sutherland model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00888">config_structure.inl:888</a></div></div>
<div class="ttc" id="aclass_c_config_html_a06234c8c7b3b63373789e8826b5122d0"><div class="ttname"><a href="class_c_config.html#a06234c8c7b3b63373789e8826b5122d0">CConfig::SetModVel_FreeStreamND</a></div><div class="ttdeci">void SetModVel_FreeStreamND(su2double val_modvel_freestreamnd)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00631">config_structure.inl:631</a></div></div>
<div class="ttc" id="aclass_c_config_html_a07e07baa3b8259bfa545fd1de2fac74a"><div class="ttname"><a href="class_c_config.html#a07e07baa3b8259bfa545fd1de2fac74a">CConfig::GetLength_Reynolds</a></div><div class="ttdeci">su2double GetLength_Reynolds(void)</div><div class="ttdoc">Get the value of the Reynolds length.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00578">config_structure.inl:578</a></div></div>
<div class="ttc" id="aclass_c_config_html_a08a17689e8bcd7b952b530fcb5a44842"><div class="ttname"><a href="class_c_config.html#a08a17689e8bcd7b952b530fcb5a44842">CConfig::GetTime_Ref</a></div><div class="ttdeci">su2double GetTime_Ref(void)</div><div class="ttdoc">Get the value of the reference time for non-dimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00522">config_structure.inl:522</a></div></div>
<div class="ttc" id="aclass_c_config_html_a0a57191f369bf048976ea80590688c3c"><div class="ttname"><a href="class_c_config.html#a0a57191f369bf048976ea80590688c3c">CConfig::GetRiemann_Var2</a></div><div class="ttdeci">su2double GetRiemann_Var2(string val_marker)</div><div class="ttdoc">Get the var 2 at Riemann boundary.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8cpp_source.html#l07712">config_structure.cpp:7712</a></div></div>
<div class="ttc" id="aclass_c_config_html_a0af31479b78f20cfab0d770c270da6d6"><div class="ttname"><a href="class_c_config.html#a0af31479b78f20cfab0d770c270da6d6">CConfig::SetForce_Ref</a></div><div class="ttdeci">void SetForce_Ref(su2double val_force_ref)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00685">config_structure.inl:685</a></div></div>
<div class="ttc" id="aclass_c_config_html_a0b17ab1184ea660b13ff0fa1c861239f"><div class="ttname"><a href="class_c_config.html#a0b17ab1184ea660b13ff0fa1c861239f">CConfig::GetKind_GridMovement</a></div><div class="ttdeci">unsigned short GetKind_GridMovement(unsigned short val_iZone)</div><div class="ttdoc">Get the type of dynamic mesh motion.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00906">config_structure.inl:906</a></div></div>
<div class="ttc" id="aclass_c_config_html_a0c3089623173e72c021c745235fdd47d"><div class="ttname"><a href="class_c_config.html#a0c3089623173e72c021c745235fdd47d">CConfig::GetMu_Constant</a></div><div class="ttdeci">su2double GetMu_Constant(void)</div><div class="ttdoc">Get the value of the constant viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00876">config_structure.inl:876</a></div></div>
<div class="ttc" id="aclass_c_config_html_a0db6b19fdbad621160f1ff55da7cec0d"><div class="ttname"><a href="class_c_config.html#a0db6b19fdbad621160f1ff55da7cec0d">CConfig::GetPressure_Critical</a></div><div class="ttdeci">su2double GetPressure_Critical(void)</div><div class="ttdoc">Get the value of the critical pressure.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00866">config_structure.inl:866</a></div></div>
<div class="ttc" id="aclass_c_config_html_a0dd94d37a95acbb120ec45ea7f5e4e9c"><div class="ttname"><a href="class_c_config.html#a0dd94d37a95acbb120ec45ea7f5e4e9c">CConfig::SetVelocity_FreeStreamND</a></div><div class="ttdeci">void SetVelocity_FreeStreamND(su2double val_velocity_freestreamnd, unsigned short val_dim)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00647">config_structure.inl:647</a></div></div>
<div class="ttc" id="aclass_c_config_html_a0e2628fc803f14ec6179427ee02e8655"><div class="ttname"><a href="class_c_config.html#a0e2628fc803f14ec6179427ee02e8655">CConfig::GetKind_Solver</a></div><div class="ttdeci">unsigned short GetKind_Solver(void)</div><div class="ttdoc">Governing equations of the flow (it can be different from the run time equation).</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00846">config_structure.inl:846</a></div></div>
<div class="ttc" id="aclass_c_config_html_a0f7ace5ebf01fd50bcadab8b50b897c8"><div class="ttname"><a href="class_c_config.html#a0f7ace5ebf01fd50bcadab8b50b897c8">CConfig::GetEntropyFix_Coeff</a></div><div class="ttdeci">su2double GetEntropyFix_Coeff(void)</div><div class="ttdoc">Get the entropy fix.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01028">config_structure.inl:1028</a></div></div>
<div class="ttc" id="aclass_c_config_html_a10a3691153903d82aecc25cadcc03917"><div class="ttname"><a href="class_c_config.html#a10a3691153903d82aecc25cadcc03917">CConfig::GetEnergy_FreeStreamND</a></div><div class="ttdeci">su2double GetEnergy_FreeStreamND(void)</div><div class="ttdoc">Get the value of the non-dimensionalized freestream energy.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00548">config_structure.inl:548</a></div></div>
<div class="ttc" id="aclass_c_config_html_a11302b0fc39a262419332a53e0a82c19"><div class="ttname"><a href="class_c_config.html#a11302b0fc39a262419332a53e0a82c19">CConfig::GetRefOriginMoment</a></div><div class="ttdeci">su2double * GetRefOriginMoment(unsigned short val_marker)</div><div class="ttdoc">Get reference origin for moment computation.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00582">config_structure.inl:582</a></div></div>
<div class="ttc" id="aclass_c_config_html_a13840ca712bf87d32d18917d0c39cfae"><div class="ttname"><a href="class_c_config.html#a13840ca712bf87d32d18917d0c39cfae">CConfig::GetVelocity_FreeStreamND</a></div><div class="ttdeci">su2double * GetVelocity_FreeStreamND(void)</div><div class="ttdoc">Get the vector of the non-dimensionalized freestream velocity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00544">config_structure.inl:544</a></div></div>
<div class="ttc" id="aclass_c_config_html_a13a89ffbaf099f490fb7080163879e55"><div class="ttname"><a href="class_c_config.html#a13a89ffbaf099f490fb7080163879e55">CConfig::GetWall_HeatFlux</a></div><div class="ttdeci">su2double GetWall_HeatFlux(string val_index)</div><div class="ttdoc">Get the wall heat flux on a constant heat flux boundary.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8cpp_source.html#l07972">config_structure.cpp:7972</a></div></div>
<div class="ttc" id="aclass_c_config_html_a13d0041a3a4692ec11ceb8913e6f838c"><div class="ttname"><a href="class_c_config.html#a13d0041a3a4692ec11ceb8913e6f838c">CConfig::SetMu_RefND</a></div><div class="ttdeci">void SetMu_RefND(su2double mu_ref)</div><div class="ttdoc">Set the value of the non-dimensional reference viscosity for Sutherland model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00898">config_structure.inl:898</a></div></div>
<div class="ttc" id="aclass_c_config_html_a1696047f983ba93433524f68c91081ab"><div class="ttname"><a href="class_c_config.html#a1696047f983ba93433524f68c91081ab">CConfig::SetMu_Temperature_RefND</a></div><div class="ttdeci">void SetMu_Temperature_RefND(su2double mu_Tref)</div><div class="ttdoc">Set the value of the non-dimensional reference temperature for Sutherland model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00900">config_structure.inl:900</a></div></div>
<div class="ttc" id="aclass_c_config_html_a17823326106008a63a75524ecc822cf9"><div class="ttname"><a href="class_c_config.html#a17823326106008a63a75524ecc822cf9">CConfig::GetConductivity_Ref</a></div><div class="ttdeci">su2double GetConductivity_Ref(void)</div><div class="ttdoc">Get the value of the reference conductivity for non-dimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00526">config_structure.inl:526</a></div></div>
<div class="ttc" id="aclass_c_config_html_a19a4294421a26b0562de1677d6b219ef"><div class="ttname"><a href="class_c_config.html#a19a4294421a26b0562de1677d6b219ef">CConfig::GetUnst_CFL</a></div><div class="ttdeci">su2double GetUnst_CFL(void)</div><div class="ttdoc">Get the Courant Friedrich Levi number for unsteady simulations.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00761">config_structure.inl:761</a></div></div>
<div class="ttc" id="aclass_c_config_html_a1bdb2d57f337b3d09b7a805ab69763c8"><div class="ttname"><a href="class_c_config.html#a1bdb2d57f337b3d09b7a805ab69763c8">CConfig::GetEnergy_Ref</a></div><div class="ttdeci">su2double GetEnergy_Ref(void)</div><div class="ttdoc">Get the value of the reference pressure for non-dimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00520">config_structure.inl:520</a></div></div>
<div class="ttc" id="aclass_c_config_html_a1d437bdfd2876763fc5cba066b2d8ee3"><div class="ttname"><a href="class_c_config.html#a1d437bdfd2876763fc5cba066b2d8ee3">CConfig::SetVelocity_Ref</a></div><div class="ttdeci">void SetVelocity_Ref(su2double val_velocity_ref)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00673">config_structure.inl:673</a></div></div>
<div class="ttc" id="aclass_c_config_html_a204106aac96526165d76f6055d75758c"><div class="ttname"><a href="class_c_config.html#a204106aac96526165d76f6055d75758c">CConfig::GetKind_FreeStreamOption</a></div><div class="ttdeci">unsigned short GetKind_FreeStreamOption(void)</div><div class="ttdoc">free stream option to initialize the solution</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00858">config_structure.inl:858</a></div></div>
<div class="ttc" id="aclass_c_config_html_a206b2d3e5357d3da3dc9686b434f674c"><div class="ttname"><a href="class_c_config.html#a206b2d3e5357d3da3dc9686b434f674c">CConfig::GetMu_SND</a></div><div class="ttdeci">su2double GetMu_SND(void)</div><div class="ttdoc">Get the value of the non-dimensional reference S for Sutherland model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00894">config_structure.inl:894</a></div></div>
<div class="ttc" id="aclass_c_config_html_a20e5fd7b43cfd2bf2bcf5137f12bc635"><div class="ttname"><a href="class_c_config.html#a20e5fd7b43cfd2bf2bcf5137f12bc635">CConfig::GetKind_TimeIntScheme_Flow</a></div><div class="ttdeci">unsigned short GetKind_TimeIntScheme_Flow(void)</div><div class="ttdoc">Get the kind of integration scheme (explicit or implicit) for the flow equations.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01082">config_structure.inl:1082</a></div></div>
<div class="ttc" id="aclass_c_config_html_a21815dd5c18f4d1029a1717de952ebea"><div class="ttname"><a href="class_c_config.html#a21815dd5c18f4d1029a1717de952ebea">CConfig::GetKind_ConductivityModel</a></div><div class="ttdeci">unsigned short GetKind_ConductivityModel(void)</div><div class="ttdoc">Get the value of the thermal conductivity model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00874">config_structure.inl:874</a></div></div>
<div class="ttc" id="aclass_c_config_html_a238624f1ee47bacb9d016b78071f3a87"><div class="ttname"><a href="class_c_config.html#a238624f1ee47bacb9d016b78071f3a87">CConfig::GetInlet_FlowDir</a></div><div class="ttdeci">su2double * GetInlet_FlowDir(string val_index)</div><div class="ttdoc">Get the flow direction unit vector at an inlet boundary.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8cpp_source.html#l07663">config_structure.cpp:7663</a></div></div>
<div class="ttc" id="aclass_c_config_html_a2a41cb57187f164b7cbf220e47823116"><div class="ttname"><a href="class_c_config.html#a2a41cb57187f164b7cbf220e47823116">CConfig::GetKind_FEM_DG_Shock</a></div><div class="ttdeci">unsigned short GetKind_FEM_DG_Shock(void)</div><div class="ttdoc">Get the kind of shock capturing method in FEM DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01118">config_structure.inl:1118</a></div></div>
<div class="ttc" id="aclass_c_config_html_a2da60a55b89307f3a0cc98aad0d84581"><div class="ttname"><a href="class_c_config.html#a2da60a55b89307f3a0cc98aad0d84581">CConfig::GetKind_Data_Riemann</a></div><div class="ttdeci">unsigned short GetKind_Data_Riemann(string val_marker)</div><div class="ttdoc">Get Kind Data of Riemann boundary.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8cpp_source.html#l07726">config_structure.cpp:7726</a></div></div>
<div class="ttc" id="aclass_c_config_html_a2e9af0bd3e1f5ed865e81b627e94a662"><div class="ttname"><a href="class_c_config.html#a2e9af0bd3e1f5ed865e81b627e94a662">CConfig::GetViscous</a></div><div class="ttdeci">bool GetViscous(void)</div><div class="ttdoc">Determines if problem is viscous.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00292">config_structure.inl:292</a></div></div>
<div class="ttc" id="aclass_c_config_html_a2ede918fd25217170b85049ddf07408b"><div class="ttname"><a href="class_c_config.html#a2ede918fd25217170b85049ddf07408b">CConfig::GetViscosity_FreeStreamND</a></div><div class="ttdeci">su2double GetViscosity_FreeStreamND(void)</div><div class="ttdoc">Get the value of the non-dimensionalized freestream viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00550">config_structure.inl:550</a></div></div>
<div class="ttc" id="aclass_c_config_html_a2f650d295acb30ca08709eafab7f01fb"><div class="ttname"><a href="class_c_config.html#a2f650d295acb30ca08709eafab7f01fb">CConfig::GetInlet_Ptotal</a></div><div class="ttdeci">su2double GetInlet_Ptotal(string val_index)</div><div class="ttdoc">Get the total pressure at an inlet boundary.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8cpp_source.html#l07649">config_structure.cpp:7649</a></div></div>
<div class="ttc" id="aclass_c_config_html_a2fca6d5964fb443f9d517df57659ccbc"><div class="ttname"><a href="class_c_config.html#a2fca6d5964fb443f9d517df57659ccbc">CConfig::GetPrandtl_Turb</a></div><div class="ttdeci">su2double GetPrandtl_Turb(void)</div><div class="ttdoc">Get the value of the turbulent Prandtl number.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00506">config_structure.inl:506</a></div></div>
<div class="ttc" id="aclass_c_config_html_a2fe0babb15a85eac009543a6915b2d33"><div class="ttname"><a href="class_c_config.html#a2fe0babb15a85eac009543a6915b2d33">CConfig::GetOutlet_Pressure</a></div><div class="ttdeci">su2double GetOutlet_Pressure(string val_index)</div><div class="ttdoc">Get the back pressure (static) at an outlet boundary.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8cpp_source.html#l07691">config_structure.cpp:7691</a></div></div>
<div class="ttc" id="aclass_c_config_html_a300c4884edfc0c2acf395036439004f4"><div class="ttname"><a href="class_c_config.html#a300c4884edfc0c2acf395036439004f4">CConfig::GetnMarker_All</a></div><div class="ttdeci">unsigned short GetnMarker_All(void)</div><div class="ttdoc">Get the total number of boundary markers.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01393">config_structure.inl:1393</a></div></div>
<div class="ttc" id="aclass_c_config_html_a37f4ffc9f97f54715ea40e411e60670f"><div class="ttname"><a href="class_c_config.html#a37f4ffc9f97f54715ea40e411e60670f">CConfig::GetRead_Binary_Restart</a></div><div class="ttdeci">bool GetRead_Binary_Restart(void)</div><div class="ttdoc">Flag for whether binary SU2 native restart files are read.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01290">config_structure.inl:1290</a></div></div>
<div class="ttc" id="aclass_c_config_html_a39147c417b27ad7df00efea4ea1fcecc"><div class="ttname"><a href="class_c_config.html#a39147c417b27ad7df00efea4ea1fcecc">CConfig::GetPressure_Ref</a></div><div class="ttdeci">su2double GetPressure_Ref(void)</div><div class="ttdoc">Get the value of the reference pressure for non-dimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00512">config_structure.inl:512</a></div></div>
<div class="ttc" id="aclass_c_config_html_a3cbef01a6e1083e96cebef19c96d9ad6"><div class="ttname"><a href="class_c_config.html#a3cbef01a6e1083e96cebef19c96d9ad6">CConfig::SetTime_Ref</a></div><div class="ttdeci">void SetTime_Ref(su2double val_time_ref)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00681">config_structure.inl:681</a></div></div>
<div class="ttc" id="aclass_c_config_html_a40aaed07fc5844d505d2c0b7076594d7"><div class="ttname"><a href="class_c_config.html#a40aaed07fc5844d505d2c0b7076594d7">CConfig::GetKind_Turb_Model</a></div><div class="ttdeci">unsigned short GetKind_Turb_Model(void)</div><div class="ttdoc">Get the kind of the turbulence model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01601">config_structure.inl:1601</a></div></div>
<div class="ttc" id="aclass_c_config_html_a411b28e2984c771c3f3f4472bc425940"><div class="ttname"><a href="class_c_config.html#a411b28e2984c771c3f3f4472bc425940">CConfig::SetViscosity_Ref</a></div><div class="ttdeci">void SetViscosity_Ref(su2double val_viscosity_ref)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00699">config_structure.inl:699</a></div></div>
<div class="ttc" id="aclass_c_config_html_a417b45d0da107126e803258901f57920"><div class="ttname"><a href="class_c_config.html#a417b45d0da107126e803258901f57920">CConfig::GetDelta_UnstTimeND</a></div><div class="ttdeci">su2double GetDelta_UnstTimeND(void)</div><div class="ttdoc">If we are prforming an unsteady simulation, there is only one value of the time step for the complete...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01505">config_structure.inl:1505</a></div></div>
<div class="ttc" id="aclass_c_config_html_a4305a79a4c74f13160c0dd8daae181ef"><div class="ttname"><a href="class_c_config.html#a4305a79a4c74f13160c0dd8daae181ef">CConfig::GetAoS</a></div><div class="ttdeci">su2double GetAoS(void)</div><div class="ttdoc">Get the angle of sideslip of the body. It relates to the rotation of the aircraft centerline from the...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00719">config_structure.inl:719</a></div></div>
<div class="ttc" id="aclass_c_config_html_a434fe0922532828b7e40ded865c5ce51"><div class="ttname"><a href="class_c_config.html#a434fe0922532828b7e40ded865c5ce51">CConfig::SetNonphysical_Points</a></div><div class="ttdeci">void SetNonphysical_Points(unsigned long val_nonphys_points)</div><div class="ttdoc">Set the current number of non-physical nodes in the solution.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01783">config_structure.inl:1783</a></div></div>
<div class="ttc" id="aclass_c_config_html_a43d642b59f0e1dae7abd613f337f5cf4"><div class="ttname"><a href="class_c_config.html#a43d642b59f0e1dae7abd613f337f5cf4">CConfig::GetReynolds</a></div><div class="ttdeci">su2double GetReynolds(void)</div><div class="ttdoc">Get the Reynolds number. Dimensionless number that gives a measure of the ratio of inertial forces to...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00611">config_structure.inl:611</a></div></div>
<div class="ttc" id="aclass_c_config_html_a45e95664235928d911e7c3876fe078b3"><div class="ttname"><a href="class_c_config.html#a45e95664235928d911e7c3876fe078b3">CConfig::GetUnsteady_Simulation</a></div><div class="ttdeci">unsigned short GetUnsteady_Simulation(void)</div><div class="ttdoc">Provides information about the time integration, and change the write in the output files information...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01284">config_structure.inl:1284</a></div></div>
<div class="ttc" id="aclass_c_config_html_a4804ac178513e42634818413c96dbf69"><div class="ttname"><a href="class_c_config.html#a4804ac178513e42634818413c96dbf69">CConfig::GetTemperature_Critical</a></div><div class="ttdeci">su2double GetTemperature_Critical(void)</div><div class="ttdoc">Get the value of the critical temperature.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00868">config_structure.inl:868</a></div></div>
<div class="ttc" id="aclass_c_config_html_a4839611d49c172c1d8ee67b862c6e621"><div class="ttname"><a href="class_c_config.html#a4839611d49c172c1d8ee67b862c6e621">CConfig::SetMu_ConstantND</a></div><div class="ttdeci">void SetMu_ConstantND(su2double mu_const)</div><div class="ttdoc">Set the value of the non-dimensional constant viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00896">config_structure.inl:896</a></div></div>
<div class="ttc" id="aclass_c_config_html_a4abc46b3abb3a9226d9ea323aaa17e0e"><div class="ttname"><a href="class_c_config.html#a4abc46b3abb3a9226d9ea323aaa17e0e">CConfig::SetTotal_UnstTimeND</a></div><div class="ttdeci">void SetTotal_UnstTimeND(su2double val_total_unsttimend)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00663">config_structure.inl:663</a></div></div>
<div class="ttc" id="aclass_c_config_html_a4cd8ee91bc2fc5601aff8f8eb017591d"><div class="ttname"><a href="class_c_config.html#a4cd8ee91bc2fc5601aff8f8eb017591d">CConfig::SetOmega_Ref</a></div><div class="ttdeci">void SetOmega_Ref(su2double val_omega_ref)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00683">config_structure.inl:683</a></div></div>
<div class="ttc" id="aclass_c_config_html_a4d36c240b8d496897ccbedbd6e4259dc"><div class="ttname"><a href="class_c_config.html#a4d36c240b8d496897ccbedbd6e4259dc">CConfig::GetKt_Constant</a></div><div class="ttdeci">su2double GetKt_Constant(void)</div><div class="ttdoc">Get the value of the thermal conductivity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00880">config_structure.inl:880</a></div></div>
<div class="ttc" id="aclass_c_config_html_a50947bb098db079c9ea1829ed09b5d01"><div class="ttname"><a href="class_c_config.html#a50947bb098db079c9ea1829ed09b5d01">CConfig::SetOmega_FreeStream</a></div><div class="ttdeci">void SetOmega_FreeStream(su2double val_omega_freestream)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00657">config_structure.inl:657</a></div></div>
<div class="ttc" id="aclass_c_config_html_a51588bf33cbfbb2866b0b0b9b5133907"><div class="ttname"><a href="class_c_config.html#a51588bf33cbfbb2866b0b0b9b5133907">CConfig::GetModVel_FreeStreamND</a></div><div class="ttdeci">su2double GetModVel_FreeStreamND(void)</div><div class="ttdoc">Get the value of the frestream temperature.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00496">config_structure.inl:496</a></div></div>
<div class="ttc" id="aclass_c_config_html_a530e7500f6d37f1b08b491c73adca7c5"><div class="ttname"><a href="class_c_config.html#a530e7500f6d37f1b08b491c73adca7c5">CConfig::SetModVel_FreeStream</a></div><div class="ttdeci">void SetModVel_FreeStream(su2double val_modvel_freestream)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00629">config_structure.inl:629</a></div></div>
<div class="ttc" id="aclass_c_config_html_a54d01076568a5d48e16f2029af794b26"><div class="ttname"><a href="class_c_config.html#a54d01076568a5d48e16f2029af794b26">CConfig::SetEnergy_Ref</a></div><div class="ttdeci">void SetEnergy_Ref(su2double val_energy_ref)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00703">config_structure.inl:703</a></div></div>
<div class="ttc" id="aclass_c_config_html_a54f9761f3971e4c3b74afa7b09e17281"><div class="ttname"><a href="class_c_config.html#a54f9761f3971e4c3b74afa7b09e17281">CConfig::GetCompute_Entropy</a></div><div class="ttdeci">bool GetCompute_Entropy(void)</div><div class="ttdoc">Function to make available whether or not the entropy must be computed.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01925">config_structure.inl:1925</a></div></div>
<div class="ttc" id="aclass_c_config_html_a57d43acc1457d2d27095ce006218862e"><div class="ttname"><a href="class_c_config.html#a57d43acc1457d2d27095ce006218862e">CConfig::GetMarker_All_KindBC</a></div><div class="ttdeci">unsigned short GetMarker_All_KindBC(unsigned short val_marker)</div><div class="ttdoc">Get the kind of boundary for each marker.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01329">config_structure.inl:1329</a></div></div>
<div class="ttc" id="aclass_c_config_html_a593225859a0bf4bfd7d9f94a69b3a680"><div class="ttname"><a href="class_c_config.html#a593225859a0bf4bfd7d9f94a69b3a680">CConfig::GetOmega_FreeStream</a></div><div class="ttdeci">su2double GetOmega_FreeStream(void)</div><div class="ttdoc">Get the value of the non-dimensionalized freestream viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00558">config_structure.inl:558</a></div></div>
<div class="ttc" id="aclass_c_config_html_a59a783581a8ff2203a5df4143ba1f9d3"><div class="ttname"><a href="class_c_config.html#a59a783581a8ff2203a5df4143ba1f9d3">CConfig::SetGas_Constant_Ref</a></div><div class="ttdeci">void SetGas_Constant_Ref(su2double val_gas_constant_ref)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00687">config_structure.inl:687</a></div></div>
<div class="ttc" id="aclass_c_config_html_a59c43ad0ef9a59bc51c2a7e399fea004"><div class="ttname"><a href="class_c_config.html#a59c43ad0ef9a59bc51c2a7e399fea004">CConfig::GetPressure_FreeStreamND</a></div><div class="ttdeci">su2double GetPressure_FreeStreamND(void)</div><div class="ttdoc">Get the value of the non-dimensionalized freestream pressure.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00536">config_structure.inl:536</a></div></div>
<div class="ttc" id="aclass_c_config_html_a5a509e57de00494a1cb92e011c1c0dbc"><div class="ttname"><a href="class_c_config.html#a5a509e57de00494a1cb92e011c1c0dbc">CConfig::GetCFL</a></div><div class="ttdeci">su2double GetCFL(unsigned short val_mesh)</div><div class="ttdoc">Get the Courant Friedrich Levi number for each grid.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00755">config_structure.inl:755</a></div></div>
<div class="ttc" id="aclass_c_config_html_a5bf47083eec0b00543d3d8c387f41ab2"><div class="ttname"><a href="class_c_config.html#a5bf47083eec0b00543d3d8c387f41ab2">CConfig::GetMarker_Monitoring_TagBound</a></div><div class="ttdeci">string GetMarker_Monitoring_TagBound(unsigned short val_marker)</div><div class="ttdoc">Get the name of the surface defined in the geometry file.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01312">config_structure.inl:1312</a></div></div>
<div class="ttc" id="aclass_c_config_html_a5dd15f92f800bf0a8501daf65cbf24fd"><div class="ttname"><a href="class_c_config.html#a5dd15f92f800bf0a8501daf65cbf24fd">CConfig::SetTemperature_FreeStream</a></div><div class="ttdeci">void SetTemperature_FreeStream(su2double val_temperature_freestream)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00633">config_structure.inl:633</a></div></div>
<div class="ttc" id="aclass_c_config_html_a5eb88779f285d4d51e4fea690d060d27"><div class="ttname"><a href="class_c_config.html#a5eb88779f285d4d51e4fea690d060d27">CConfig::GetKind_SGS_Model</a></div><div class="ttdeci">unsigned short GetKind_SGS_Model(void)</div><div class="ttdoc">Get the kind of the subgrid scale model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01605">config_structure.inl:1605</a></div></div>
<div class="ttc" id="aclass_c_config_html_a5f01bbbd9c331ecea38eebbe9cc9cd4e"><div class="ttname"><a href="class_c_config.html#a5f01bbbd9c331ecea38eebbe9cc9cd4e">CConfig::GetGamma</a></div><div class="ttdeci">su2double GetGamma(void)</div><div class="ttdoc">Get the value of the Gamma of fluid (ratio of specific heats).</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00436">config_structure.inl:436</a></div></div>
<div class="ttc" id="aclass_c_config_html_a6020a5df7025ffb286f9b9f55f3f2773"><div class="ttname"><a href="class_c_config.html#a6020a5df7025ffb286f9b9f55f3f2773">CConfig::GetAoA</a></div><div class="ttdeci">su2double GetAoA(void)</div><div class="ttdoc">Get the angle of attack of the body. This is the angle between a reference line on a lifting body (of...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00707">config_structure.inl:707</a></div></div>
<div class="ttc" id="aclass_c_config_html_a60325c7c0961c3ec27b040de0416af55"><div class="ttname"><a href="class_c_config.html#a60325c7c0961c3ec27b040de0416af55">CConfig::SetTke_FreeStream</a></div><div class="ttdeci">void SetTke_FreeStream(su2double val_tke_freestream)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00655">config_structure.inl:655</a></div></div>
<div class="ttc" id="aclass_c_config_html_a619cb1400d6c944e83ad0ffe82deb021"><div class="ttname"><a href="class_c_config.html#a619cb1400d6c944e83ad0ffe82deb021">CConfig::GetPrandtl_Lam</a></div><div class="ttdeci">su2double GetPrandtl_Lam(void)</div><div class="ttdoc">Get the value of the laminar Prandtl number.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00504">config_structure.inl:504</a></div></div>
<div class="ttc" id="aclass_c_config_html_a62305792633c8d0cb5ccd564d126fc0a"><div class="ttname"><a href="class_c_config.html#a62305792633c8d0cb5ccd564d126fc0a">CConfig::Get_Alpha_RKStep</a></div><div class="ttdeci">su2double Get_Alpha_RKStep(unsigned short val_step)</div><div class="ttdoc">Get the alpha (convective) coefficients for the Runge-Kutta integration scheme.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00801">config_structure.inl:801</a></div></div>
<div class="ttc" id="aclass_c_config_html_a624138f0bb5ee7494459b8e25c5d6287"><div class="ttname"><a href="class_c_config.html#a624138f0bb5ee7494459b8e25c5d6287">CConfig::GetMach</a></div><div class="ttdeci">su2double GetMach(void)</div><div class="ttdoc">Get the value of the Mach number (velocity divided by speed of sound).</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00434">config_structure.inl:434</a></div></div>
<div class="ttc" id="aclass_c_config_html_a62a92b26c1300323f4a4a035ec19af1a"><div class="ttname"><a href="class_c_config.html#a62a92b26c1300323f4a4a035ec19af1a">CConfig::GetnMarker_Monitoring</a></div><div class="ttdeci">unsigned short GetnMarker_Monitoring(void)</div><div class="ttdoc">Get the total number of monitoring markers.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01407">config_structure.inl:1407</a></div></div>
<div class="ttc" id="aclass_c_config_html_a63ce45e68b93f8f3f1de44a2abad67ef"><div class="ttname"><a href="class_c_config.html#a63ce45e68b93f8f3f1de44a2abad67ef">CConfig::GetRefLength</a></div><div class="ttdeci">su2double GetRefLength(void)</div><div class="ttdoc">Get the reference length for computing moment (the default value is 1).</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00418">config_structure.inl:418</a></div></div>
<div class="ttc" id="aclass_c_config_html_a65f49bf3888539804cc0ceac28a32923"><div class="ttname"><a href="class_c_config.html#a65f49bf3888539804cc0ceac28a32923">CConfig::GetGrid_Movement</a></div><div class="ttdeci">bool GetGrid_Movement(void)</div><div class="ttdoc">Get information about the grid movement.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01577">config_structure.inl:1577</a></div></div>
<div class="ttc" id="aclass_c_config_html_a65fda2155cdc4ac10c448e4322e5d04e"><div class="ttname"><a href="class_c_config.html#a65fda2155cdc4ac10c448e4322e5d04e">CConfig::GetInlet_Ttotal</a></div><div class="ttdeci">su2double GetInlet_Ttotal(string val_index)</div><div class="ttdoc">Get the total temperature at an inlet boundary.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8cpp_source.html#l07642">config_structure.cpp:7642</a></div></div>
<div class="ttc" id="aclass_c_config_html_a66ca7e620390a81cd49cd0a00716128e"><div class="ttname"><a href="class_c_config.html#a66ca7e620390a81cd49cd0a00716128e">CConfig::GetKind_Regime</a></div><div class="ttdeci">unsigned short GetKind_Regime(void)</div><div class="ttdoc">Governing equations of the flow (it can be different from the run time equation).</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00850">config_structure.inl:850</a></div></div>
<div class="ttc" id="aclass_c_config_html_a6a283ba2b1eacb99905f0e12636c8e15"><div class="ttname"><a href="class_c_config.html#a6a283ba2b1eacb99905f0e12636c8e15">CConfig::GetKind_ADER_Predictor</a></div><div class="ttdeci">unsigned short GetKind_ADER_Predictor(void)</div><div class="ttdoc">Get the kind of scheme (aliased or non-aliased) to be used in the predictor step of ADER-DG.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01084">config_structure.inl:1084</a></div></div>
<div class="ttc" id="aclass_c_config_html_a6a5600113766e9e2a353f704f2c86351"><div class="ttname"><a href="class_c_config.html#a6a5600113766e9e2a353f704f2c86351">CConfig::GetViscosity_FreeStream</a></div><div class="ttdeci">su2double GetViscosity_FreeStream(void)</div><div class="ttdoc">Get the value of the frestream temperature.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00488">config_structure.inl:488</a></div></div>
<div class="ttc" id="aclass_c_config_html_a6a9642ebdd5941ab1d4e72519439ef51"><div class="ttname"><a href="class_c_config.html#a6a9642ebdd5941ab1d4e72519439ef51">CConfig::SetDensity_FreeStreamND</a></div><div class="ttdeci">void SetDensity_FreeStreamND(su2double val_density_freestreamnd)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00623">config_structure.inl:623</a></div></div>
<div class="ttc" id="aclass_c_config_html_a6aa8fe1e4a3b1122be37013d25de9987"><div class="ttname"><a href="class_c_config.html#a6aa8fe1e4a3b1122be37013d25de9987">CConfig::GetModVel_FreeStream</a></div><div class="ttdeci">su2double GetModVel_FreeStream(void)</div><div class="ttdoc">Get the value of the frestream temperature.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00494">config_structure.inl:494</a></div></div>
<div class="ttc" id="aclass_c_config_html_a6d835a954bb5e99c5a3de6db5ed24ff3"><div class="ttname"><a href="class_c_config.html#a6d835a954bb5e99c5a3de6db5ed24ff3">CConfig::GetGas_ConstantND</a></div><div class="ttdeci">su2double GetGas_ConstantND(void)</div><div class="ttdoc">Get the value of specific gas constant.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00448">config_structure.inl:448</a></div></div>
<div class="ttc" id="aclass_c_config_html_a714590a2565d2a339ee22009ada1c7f9"><div class="ttname"><a href="class_c_config.html#a714590a2565d2a339ee22009ada1c7f9">CConfig::GetIsothermal_Temperature</a></div><div class="ttdeci">su2double GetIsothermal_Temperature(string val_index)</div><div class="ttdoc">Get the wall temperature (static) at an isothermal boundary.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8cpp_source.html#l07960">config_structure.cpp:7960</a></div></div>
<div class="ttc" id="aclass_c_config_html_a77175a3f3539c5884347ec0d8a5dd3ed"><div class="ttname"><a href="class_c_config.html#a77175a3f3539c5884347ec0d8a5dd3ed">CConfig::SetGas_Constant</a></div><div class="ttdeci">void SetGas_Constant(su2double val_gas_constant)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00689">config_structure.inl:689</a></div></div>
<div class="ttc" id="aclass_c_config_html_a7db9cd4759eae88ef1a589be622ba9df"><div class="ttname"><a href="class_c_config.html#a7db9cd4759eae88ef1a589be622ba9df">CConfig::GetTke_FreeStream</a></div><div class="ttdeci">su2double GetTke_FreeStream(void)</div><div class="ttdoc">Get the value of the non-dimensionalized freestream viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00556">config_structure.inl:556</a></div></div>
<div class="ttc" id="aclass_c_config_html_a802168826c8d609805ca466c495fcffd"><div class="ttname"><a href="class_c_config.html#a802168826c8d609805ca466c495fcffd">CConfig::GetAcentric_Factor</a></div><div class="ttdeci">su2double GetAcentric_Factor(void)</div><div class="ttdoc">Get the value of the critical pressure.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00870">config_structure.inl:870</a></div></div>
<div class="ttc" id="aclass_c_config_html_a84da3953107e3dad010e13227f1d84d0"><div class="ttname"><a href="class_c_config.html#a84da3953107e3dad010e13227f1d84d0">CConfig::GetMach_Motion</a></div><div class="ttdeci">su2double GetMach_Motion(void)</div><div class="ttdoc">Get the mach number based on the mesh velocity and freestream quantities.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00910">config_structure.inl:910</a></div></div>
<div class="ttc" id="aclass_c_config_html_a85b0488628cfb289b5413a888fb7cb0c"><div class="ttname"><a href="class_c_config.html#a85b0488628cfb289b5413a888fb7cb0c">CConfig::GetTemperature_FreeStream</a></div><div class="ttdeci">su2double GetTemperature_FreeStream(void)</div><div class="ttdoc">Get the value of the frestream temperature.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00484">config_structure.inl:484</a></div></div>
<div class="ttc" id="aclass_c_config_html_a86599996300e409cf4f474b8a061d906"><div class="ttname"><a href="class_c_config.html#a86599996300e409cf4f474b8a061d906">CConfig::SetTemperature_Ref</a></div><div class="ttdeci">void SetTemperature_Ref(su2double val_temperature_ref)</div><div class="ttdoc">Set the reference temperature.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00679">config_structure.inl:679</a></div></div>
<div class="ttc" id="aclass_c_config_html_a890da0048214096d7fba85048e9336cf"><div class="ttname"><a href="class_c_config.html#a890da0048214096d7fba85048e9336cf">CConfig::GetMu_Temperature_RefND</a></div><div class="ttdeci">su2double GetMu_Temperature_RefND(void)</div><div class="ttdoc">Get the value of the non-dimensional reference temperature for Sutherland model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00890">config_structure.inl:890</a></div></div>
<div class="ttc" id="aclass_c_config_html_a8b427e418c23b7e25da647fb21024098"><div class="ttname"><a href="class_c_config.html#a8b427e418c23b7e25da647fb21024098">CConfig::GetPeriodicRotAngles</a></div><div class="ttdeci">su2double * GetPeriodicRotAngles(string val_marker)</div><div class="ttdoc">Angles of rotation for a rotational periodic boundary.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8cpp_source.html#l07399">config_structure.cpp:7399</a></div></div>
<div class="ttc" id="aclass_c_config_html_a8cc3d7d06d995bf315cbed96412a9b7e"><div class="ttname"><a href="class_c_config.html#a8cc3d7d06d995bf315cbed96412a9b7e">CConfig::GetDensity_Ref</a></div><div class="ttdeci">su2double GetDensity_Ref(void)</div><div class="ttdoc">Get the value of the reference density for non-dimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00516">config_structure.inl:516</a></div></div>
<div class="ttc" id="aclass_c_config_html_a8d4fc7062852023d1daec115ca5eceba"><div class="ttname"><a href="class_c_config.html#a8d4fc7062852023d1daec115ca5eceba">CConfig::SetLength_Ref</a></div><div class="ttdeci">void SetLength_Ref(su2double val_length_ref)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00671">config_structure.inl:671</a></div></div>
<div class="ttc" id="aclass_c_config_html_a8e18855ef00253c9b6a311c2c77ba292"><div class="ttname"><a href="class_c_config.html#a8e18855ef00253c9b6a311c2c77ba292">CConfig::SetOmega_FreeStreamND</a></div><div class="ttdeci">void SetOmega_FreeStreamND(su2double val_omega_freestreamnd)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00653">config_structure.inl:653</a></div></div>
<div class="ttc" id="aclass_c_config_html_a8ec4a0951d9a432dadffad665a9892b3"><div class="ttname"><a href="class_c_config.html#a8ec4a0951d9a432dadffad665a9892b3">CConfig::GetTemperature_Ref</a></div><div class="ttdeci">su2double GetTemperature_Ref(void)</div><div class="ttdoc">Get the value of the reference temperature for non-dimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00514">config_structure.inl:514</a></div></div>
<div class="ttc" id="aclass_c_config_html_a8f2c6f68c1e3756237596a7274e713f4"><div class="ttname"><a href="class_c_config.html#a8f2c6f68c1e3756237596a7274e713f4">CConfig::GetVelocity_Ref</a></div><div class="ttdeci">su2double GetVelocity_Ref(void)</div><div class="ttdoc">Get the value of the reference velocity for non-dimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00518">config_structure.inl:518</a></div></div>
<div class="ttc" id="aclass_c_config_html_a8fe434bf622c8a3eb95994dfa96ac9e9"><div class="ttname"><a href="class_c_config.html#a8fe434bf622c8a3eb95994dfa96ac9e9">CConfig::SetConductivity_Ref</a></div><div class="ttdeci">void SetConductivity_Ref(su2double val_conductivity_ref)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00701">config_structure.inl:701</a></div></div>
<div class="ttc" id="aclass_c_config_html_a9045d1fd0c03ccf094f511b8c695529f"><div class="ttname"><a href="class_c_config.html#a9045d1fd0c03ccf094f511b8c695529f">CConfig::GetRiemann_FlowDir</a></div><div class="ttdeci">su2double * GetRiemann_FlowDir(string val_marker)</div><div class="ttdoc">Get the Flowdir at Riemann boundary.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8cpp_source.html#l07719">config_structure.cpp:7719</a></div></div>
<div class="ttc" id="aclass_c_config_html_a925f9f6e7ae91307610f6d2b0586aad5"><div class="ttname"><a href="class_c_config.html#a925f9f6e7ae91307610f6d2b0586aad5">CConfig::SetEnergy_FreeStream</a></div><div class="ttdeci">void SetEnergy_FreeStream(su2double val_energy_freestream)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00661">config_structure.inl:661</a></div></div>
<div class="ttc" id="aclass_c_config_html_a9301440279b2cbf0f8ea3c8a83e240e6"><div class="ttname"><a href="class_c_config.html#a9301440279b2cbf0f8ea3c8a83e240e6">CConfig::GetJacobian_Spatial_Discretization_Only</a></div><div class="ttdeci">bool GetJacobian_Spatial_Discretization_Only(void)</div><div class="ttdoc">Function to make available whether or not only the exact Jacobian of the spatial discretization must ...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01929">config_structure.inl:1929</a></div></div>
<div class="ttc" id="aclass_c_config_html_a942619938b389de95268bce31434c276"><div class="ttname"><a href="class_c_config.html#a942619938b389de95268bce31434c276">CConfig::GetMarker_All_Monitoring</a></div><div class="ttdeci">unsigned short GetMarker_All_Monitoring(unsigned short val_marker)</div><div class="ttdoc">Get the monitoring information for a marker val_marker.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01363">config_structure.inl:1363</a></div></div>
<div class="ttc" id="aclass_c_config_html_a9429d355e689d8751b5c229dfd09184a"><div class="ttname"><a href="class_c_config.html#a9429d355e689d8751b5c229dfd09184a">CConfig::GetOmega_FreeStreamND</a></div><div class="ttdeci">su2double GetOmega_FreeStreamND(void)</div><div class="ttdoc">Get the value of the non-dimensionalized freestream viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00554">config_structure.inl:554</a></div></div>
<div class="ttc" id="aclass_c_config_html_a942b0f312131b0074be26c5343ed8a05"><div class="ttname"><a href="class_c_config.html#a942b0f312131b0074be26c5343ed8a05">CConfig::SetKt_ConstantND</a></div><div class="ttdeci">void SetKt_ConstantND(su2double kt_const)</div><div class="ttdoc">Set the value of the non-dimensional thermal conductivity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00904">config_structure.inl:904</a></div></div>
<div class="ttc" id="aclass_c_config_html_a957806325eb8ed6cc4c41e886903f9cf"><div class="ttname"><a href="class_c_config.html#a957806325eb8ed6cc4c41e886903f9cf">CConfig::GetPressure_FreeStream</a></div><div class="ttdeci">su2double GetPressure_FreeStream(void)</div><div class="ttdoc">Get the value of the non-dimensionalized freestream pressure.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00498">config_structure.inl:498</a></div></div>
<div class="ttc" id="aclass_c_config_html_a957e791919e7c6947131c06aedc7ff8d"><div class="ttname"><a href="class_c_config.html#a957e791919e7c6947131c06aedc7ff8d">CConfig::GetnLevels_TimeAccurateLTS</a></div><div class="ttdeci">unsigned short GetnLevels_TimeAccurateLTS(void)</div><div class="ttdoc">Get the number of time levels for time accurate local time stepping.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00787">config_structure.inl:787</a></div></div>
<div class="ttc" id="aclass_c_config_html_a967e969a3beb24bb6e57d7036af003be"><div class="ttname"><a href="class_c_config.html#a967e969a3beb24bb6e57d7036af003be">CConfig::GetMarker_All_TagBound</a></div><div class="ttdeci">string GetMarker_All_TagBound(unsigned short val_marker)</div><div class="ttdoc">Get the index of the surface defined in the geometry file.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01302">config_structure.inl:1302</a></div></div>
<div class="ttc" id="aclass_c_config_html_a9902362e404162a3aaac7dd6c2c2e895"><div class="ttname"><a href="class_c_config.html#a9902362e404162a3aaac7dd6c2c2e895">CConfig::GetKt_ConstantND</a></div><div class="ttdeci">su2double GetKt_ConstantND(void)</div><div class="ttdoc">Get the value of the non-dimensional thermal conductivity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00882">config_structure.inl:882</a></div></div>
<div class="ttc" id="aclass_c_config_html_a9af4200d2cd764653d2707da4acc7847"><div class="ttname"><a href="class_c_config.html#a9af4200d2cd764653d2707da4acc7847">CConfig::GetBody_Force</a></div><div class="ttdeci">bool GetBody_Force(void)</div><div class="ttdoc">Get information about the body force.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01593">config_structure.inl:1593</a></div></div>
<div class="ttc" id="aclass_c_config_html_a9d3085d222e6ab0b658d79c52b6477fc"><div class="ttname"><a href="class_c_config.html#a9d3085d222e6ab0b658d79c52b6477fc">CConfig::SetDelta_UnstTimeND</a></div><div class="ttdeci">void SetDelta_UnstTimeND(su2double val_delta_unsttimend)</div><div class="ttdoc">Set the value of the unsteadty time step using the CFL number.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01513">config_structure.inl:1513</a></div></div>
<div class="ttc" id="aclass_c_config_html_aa479f31b4df9dc8825a97c2b46ba14b3"><div class="ttname"><a href="class_c_config.html#aa479f31b4df9dc8825a97c2b46ba14b3">CConfig::GetGas_Constant_Ref</a></div><div class="ttdeci">su2double GetGas_Constant_Ref(void)</div><div class="ttdoc">Get the reference value for the specific gas constant.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00482">config_structure.inl:482</a></div></div>
<div class="ttc" id="aclass_c_config_html_aa48f2fc504ec2b261d5046f9a17677dd"><div class="ttname"><a href="class_c_config.html#aa48f2fc504ec2b261d5046f9a17677dd">CConfig::GetExtIter</a></div><div class="ttdeci">unsigned long GetExtIter(void)</div><div class="ttdoc">Get the current external iteration number.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00308">config_structure.inl:308</a></div></div>
<div class="ttc" id="aclass_c_config_html_aa529accbcb66c5f6b56eaab6fda7071b"><div class="ttname"><a href="class_c_config.html#aa529accbcb66c5f6b56eaab6fda7071b">CConfig::SetPressure_Ref</a></div><div class="ttdeci">void SetPressure_Ref(su2double val_pressure_ref)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00675">config_structure.inl:675</a></div></div>
<div class="ttc" id="aclass_c_config_html_aa6f6ce87c87183da706c9e5521c1b812"><div class="ttname"><a href="class_c_config.html#aa6f6ce87c87183da706c9e5521c1b812">CConfig::GetBody_Force_Vector</a></div><div class="ttdeci">su2double * GetBody_Force_Vector(void)</div><div class="ttdoc">Get a pointer to the body force vector.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01595">config_structure.inl:1595</a></div></div>
<div class="ttc" id="aclass_c_config_html_aa70032ce7349ef173870f72c58be0a6f"><div class="ttname"><a href="class_c_config.html#aa70032ce7349ef173870f72c58be0a6f">CConfig::SetTke_FreeStreamND</a></div><div class="ttdeci">void SetTke_FreeStreamND(su2double val_tke_freestreamnd)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00651">config_structure.inl:651</a></div></div>
<div class="ttc" id="aclass_c_config_html_aa81134852bfae258be83fcbb88bea0a6"><div class="ttname"><a href="class_c_config.html#aa81134852bfae258be83fcbb88bea0a6">CConfig::SetPressure_FreeStreamND</a></div><div class="ttdeci">void SetPressure_FreeStreamND(su2double val_pressure_freestreamnd)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00615">config_structure.inl:615</a></div></div>
<div class="ttc" id="aclass_c_config_html_aa81b35e9f5a93d058fd02b2b294656db"><div class="ttname"><a href="class_c_config.html#aa81b35e9f5a93d058fd02b2b294656db">CConfig::GetEnergy_FreeStream</a></div><div class="ttdeci">su2double GetEnergy_FreeStream(void)</div><div class="ttdoc">Get the value of the frestream temperature.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00486">config_structure.inl:486</a></div></div>
<div class="ttc" id="aclass_c_config_html_aa878788c30e1c7c3ed4788e485bd2fb0"><div class="ttname"><a href="class_c_config.html#aa878788c30e1c7c3ed4788e485bd2fb0">CConfig::GetConsole_Output_Verb</a></div><div class="ttdeci">unsigned short GetConsole_Output_Verb(void)</div><div class="ttdoc">Get the verbosity level of the console output.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01791">config_structure.inl:1791</a></div></div>
<div class="ttc" id="aclass_c_config_html_aa9a5ddd6d3f6f56bc21f8a2ec3e7d220"><div class="ttname"><a href="class_c_config.html#aa9a5ddd6d3f6f56bc21f8a2ec3e7d220">CConfig::GetDelta_UnstTime</a></div><div class="ttdeci">su2double GetDelta_UnstTime(void)</div><div class="ttdoc">If we are prforming an unsteady simulation, there is only one value of the time step for the complete...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01509">config_structure.inl:1509</a></div></div>
<div class="ttc" id="aclass_c_config_html_aac9fcd40a51d17b6f7a296126b62caf9"><div class="ttname"><a href="class_c_config.html#aac9fcd40a51d17b6f7a296126b62caf9">CConfig::GetRef_NonDim</a></div><div class="ttdeci">unsigned short GetRef_NonDim(void)</div><div class="ttdoc">Get the kind of non-dimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00284">config_structure.inl:284</a></div></div>
<div class="ttc" id="aclass_c_config_html_ab0ded0ff59242b315296a98e136fc080"><div class="ttname"><a href="class_c_config.html#ab0ded0ff59242b315296a98e136fc080">CConfig::GetMu_S</a></div><div class="ttdeci">su2double GetMu_S(void)</div><div class="ttdoc">Get the value of the reference S for Sutherland model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00892">config_structure.inl:892</a></div></div>
<div class="ttc" id="aclass_c_config_html_ab110ba67babf383e40ac4896bc65a599"><div class="ttname"><a href="class_c_config.html#ab110ba67babf383e40ac4896bc65a599">CConfig::GetnTimeDOFsADER_DG</a></div><div class="ttdeci">unsigned short GetnTimeDOFsADER_DG(void)</div><div class="ttdoc">Get the number time DOFs for ADER-DG.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00791">config_structure.inl:791</a></div></div>
<div class="ttc" id="aclass_c_config_html_ab2c45bd43a8f9e852c7f52a0b5003552"><div class="ttname"><a href="class_c_config.html#ab2c45bd43a8f9e852c7f52a0b5003552">CConfig::GetTurb2LamViscRatio_FreeStream</a></div><div class="ttdeci">su2double GetTurb2LamViscRatio_FreeStream(void)</div><div class="ttdoc">Get the value of the turbulent to laminar viscosity ratio.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00574">config_structure.inl:574</a></div></div>
<div class="ttc" id="aclass_c_config_html_ab3fc57386d5b28f678f79b49aed96e5b"><div class="ttname"><a href="class_c_config.html#ab3fc57386d5b28f678f79b49aed96e5b">CConfig::GetnRKStep</a></div><div class="ttdeci">unsigned short GetnRKStep(void)</div><div class="ttdoc">Get the number of Runge-Kutta steps.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00785">config_structure.inl:785</a></div></div>
<div class="ttc" id="aclass_c_config_html_ab61a5a25dc9a2d37c22d4744d26b690d"><div class="ttname"><a href="class_c_config.html#ab61a5a25dc9a2d37c22d4744d26b690d">CConfig::GetWeightsIntegrationADER_DG</a></div><div class="ttdeci">su2double * GetWeightsIntegrationADER_DG(void)</div><div class="ttdoc">Get the weights of the time integration points for ADER-DG.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00799">config_structure.inl:799</a></div></div>
<div class="ttc" id="aclass_c_config_html_ab8374bd6eab3ea2e8c240ab8e702a508"><div class="ttname"><a href="class_c_config.html#ab8374bd6eab3ea2e8c240ab8e702a508">CConfig::GetMu_ConstantND</a></div><div class="ttdeci">su2double GetMu_ConstantND(void)</div><div class="ttdoc">Get the value of the non-dimensional constant viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00878">config_structure.inl:878</a></div></div>
<div class="ttc" id="aclass_c_config_html_ab9f282a9910f42c0871da3718965eb0a"><div class="ttname"><a href="class_c_config.html#ab9f282a9910f42c0871da3718965eb0a">CConfig::SetPressure_FreeStream</a></div><div class="ttdeci">void SetPressure_FreeStream(su2double val_pressure_freestream)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00617">config_structure.inl:617</a></div></div>
<div class="ttc" id="aclass_c_config_html_ac1d01eba47c6802477c7975166f656bc"><div class="ttname"><a href="class_c_config.html#ac1d01eba47c6802477c7975166f656bc">CConfig::SetEnergy_FreeStreamND</a></div><div class="ttdeci">void SetEnergy_FreeStreamND(su2double val_energy_freestreamnd)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00659">config_structure.inl:659</a></div></div>
<div class="ttc" id="aclass_c_config_html_ac36fbf73af5ad628f510769c556717d3"><div class="ttname"><a href="class_c_config.html#ac36fbf73af5ad628f510769c556717d3">CConfig::GetKind_FluidModel</a></div><div class="ttdeci">unsigned short GetKind_FluidModel(void)</div><div class="ttdoc">Fluid model that we are using.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00856">config_structure.inl:856</a></div></div>
<div class="ttc" id="aclass_c_config_html_ac5caa07310bcfde15a16e5eeadbfa454"><div class="ttname"><a href="class_c_config.html#ac5caa07310bcfde15a16e5eeadbfa454">CConfig::GetKind_InitOption</a></div><div class="ttdeci">unsigned short GetKind_InitOption(void)</div><div class="ttdoc">free stream option to initialize the solution</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00864">config_structure.inl:864</a></div></div>
<div class="ttc" id="aclass_c_config_html_ac5d613463ef0d7b01e66c4e33f586afb"><div class="ttname"><a href="class_c_config.html#ac5d613463ef0d7b01e66c4e33f586afb">CConfig::GetRiemann_Solver_FEM</a></div><div class="ttdeci">unsigned short GetRiemann_Solver_FEM(void)</div><div class="ttdoc">Get the kind of Riemann solver for the DG method (FEM flow solver).</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01913">config_structure.inl:1913</a></div></div>
<div class="ttc" id="aclass_c_config_html_acab57b0918bd4f1d5b9893dcdf0f987c"><div class="ttname"><a href="class_c_config.html#acab57b0918bd4f1d5b9893dcdf0f987c">CConfig::GetTurbulenceIntensity_FreeStream</a></div><div class="ttdeci">su2double GetTurbulenceIntensity_FreeStream(void)</div><div class="ttdoc">Get the value of the non-dimensionalized freestream turbulence intensity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00572">config_structure.inl:572</a></div></div>
<div class="ttc" id="aclass_c_config_html_acb8a7f20f16f7201b27be06fd765cd9b"><div class="ttname"><a href="class_c_config.html#acb8a7f20f16f7201b27be06fd765cd9b">CConfig::GetTotal_UnstTimeND</a></div><div class="ttdeci">su2double GetTotal_UnstTimeND(void)</div><div class="ttdoc">If we are prforming an unsteady simulation, there is only one value of the time step for the complete...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01507">config_structure.inl:1507</a></div></div>
<div class="ttc" id="aclass_c_config_html_acc01ed919b224cf1c8419848ba157332"><div class="ttname"><a href="class_c_config.html#acc01ed919b224cf1c8419848ba157332">CConfig::GetGas_Constant</a></div><div class="ttdeci">su2double GetGas_Constant(void)</div><div class="ttdoc">Get the value of specific gas constant.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00446">config_structure.inl:446</a></div></div>
<div class="ttc" id="aclass_c_config_html_acc0e8477d26aab6003845d62cb43b0fa"><div class="ttname"><a href="class_c_config.html#acc0e8477d26aab6003845d62cb43b0fa">CConfig::GetDensity_FreeStreamND</a></div><div class="ttdeci">su2double GetDensity_FreeStreamND(void)</div><div class="ttdoc">Get the value of the non-dimensionalized freestream density.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00542">config_structure.inl:542</a></div></div>
<div class="ttc" id="aclass_c_config_html_ad12ed151b8d775fc13358c090d6ed028"><div class="ttname"><a href="class_c_config.html#ad12ed151b8d775fc13358c090d6ed028">CConfig::GetRiemann_Var1</a></div><div class="ttdeci">su2double GetRiemann_Var1(string val_marker)</div><div class="ttdoc">Get the var 1 at Riemann boundary.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8cpp_source.html#l07705">config_structure.cpp:7705</a></div></div>
<div class="ttc" id="aclass_c_config_html_ad1d22f6d4f0225e3281d826a4c866779"><div class="ttname"><a href="class_c_config.html#ad1d22f6d4f0225e3281d826a4c866779">CConfig::GetRefArea</a></div><div class="ttdeci">su2double GetRefArea(void)</div><div class="ttdoc">Get the reference area for non dimensional coefficient computation. If the value from the is 0 then,...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00356">config_structure.inl:356</a></div></div>
<div class="ttc" id="aclass_c_config_html_ad29da5efbc55028f58a405ae9363ff9f"><div class="ttname"><a href="class_c_config.html#ad29da5efbc55028f58a405ae9363ff9f">CConfig::SetViscosity_FreeStream</a></div><div class="ttdeci">void SetViscosity_FreeStream(su2double val_viscosity_freestream)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00627">config_structure.inl:627</a></div></div>
<div class="ttc" id="aclass_c_config_html_ad2df4adf68a538a1b151deba9b94090f"><div class="ttname"><a href="class_c_config.html#ad2df4adf68a538a1b151deba9b94090f">CConfig::SetViscosity_FreeStreamND</a></div><div class="ttdeci">void SetViscosity_FreeStreamND(su2double val_viscosity_freestreamnd)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00649">config_structure.inl:649</a></div></div>
<div class="ttc" id="aclass_c_config_html_ad91f3fcd28080a11685432e760221c1d"><div class="ttname"><a href="class_c_config.html#ad91f3fcd28080a11685432e760221c1d">CConfig::GetSolution_FlowFileName</a></div><div class="ttdeci">string GetSolution_FlowFileName(void)</div><div class="ttdoc">Get the name of the file with the solution of the flow problem.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01445">config_structure.inl:1445</a></div></div>
<div class="ttc" id="aclass_c_config_html_adaef7ca454b96e9bb01416cbd523abdc"><div class="ttname"><a href="class_c_config.html#adaef7ca454b96e9bb01416cbd523abdc">CConfig::SetGas_ConstantND</a></div><div class="ttdeci">void SetGas_ConstantND(su2double val_gas_constantnd)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00637">config_structure.inl:637</a></div></div>
<div class="ttc" id="aclass_c_config_html_ade2279cd5e412277dfe4699475c12305"><div class="ttname"><a href="class_c_config.html#ade2279cd5e412277dfe4699475c12305">CConfig::GetTotal_UnstTime</a></div><div class="ttdeci">su2double GetTotal_UnstTime(void)</div><div class="ttdoc">If we are performing an unsteady simulation, this is the value of max physical time for which we run ...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01515">config_structure.inl:1515</a></div></div>
<div class="ttc" id="aclass_c_config_html_adf48507f6200c50ac2e02f0d89bb3b59"><div class="ttname"><a href="class_c_config.html#adf48507f6200c50ac2e02f0d89bb3b59">CConfig::GetViscosity_Ref</a></div><div class="ttdeci">su2double GetViscosity_Ref(void)</div><div class="ttdoc">Get the value of the reference viscosity for non-dimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00524">config_structure.inl:524</a></div></div>
<div class="ttc" id="aclass_c_config_html_ae7e9d4b942d0db4b72f461c180ade3a4"><div class="ttname"><a href="class_c_config.html#ae7e9d4b942d0db4b72f461c180ade3a4">CConfig::GetnTimeIntegrationADER_DG</a></div><div class="ttdeci">unsigned short GetnTimeIntegrationADER_DG(void)</div><div class="ttdoc">Get the number time integration points for ADER-DG.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00795">config_structure.inl:795</a></div></div>
<div class="ttc" id="aclass_c_config_html_ae91198a9134853e8970cd38db8628c24"><div class="ttname"><a href="class_c_config.html#ae91198a9134853e8970cd38db8628c24">CConfig::SetFroude</a></div><div class="ttdeci">void SetFroude(su2double val_froude)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00665">config_structure.inl:665</a></div></div>
<div class="ttc" id="aclass_c_config_html_ae9520958df27678474890ee79980ee24"><div class="ttname"><a href="class_c_config.html#ae9520958df27678474890ee79980ee24">CConfig::GetDensity_FreeStream</a></div><div class="ttdeci">su2double GetDensity_FreeStream(void)</div><div class="ttdoc">Get the value of the frestream temperature.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00490">config_structure.inl:490</a></div></div>
<div class="ttc" id="aclass_c_config_html_aea5478f0851e4cb4d11c262fb6c6e8c4"><div class="ttname"><a href="class_c_config.html#aea5478f0851e4cb4d11c262fb6c6e8c4">CConfig::GetSizeMatMulPadding</a></div><div class="ttdeci">unsigned short GetSizeMatMulPadding(void)</div><div class="ttdoc">Function to make available the matrix size in vectorization in order to optimize the gemm performance...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01923">config_structure.inl:1923</a></div></div>
<div class="ttc" id="aclass_c_config_html_aebb368493e43eb306cf65de037c2e9bc"><div class="ttname"><a href="class_c_config.html#aebb368493e43eb306cf65de037c2e9bc">CConfig::GetTheta_Interior_Penalty_DGFEM</a></div><div class="ttdeci">su2double GetTheta_Interior_Penalty_DGFEM(void)</div><div class="ttdoc">Function to make available the multiplication factor theta of the symmetrizing terms in the DG discre...</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01921">config_structure.inl:1921</a></div></div>
<div class="ttc" id="aclass_c_config_html_aec59768cd9ae76e07db52a62c532a677"><div class="ttname"><a href="class_c_config.html#aec59768cd9ae76e07db52a62c532a677">CConfig::GetMu_Ref</a></div><div class="ttdeci">su2double GetMu_Ref(void)</div><div class="ttdoc">Get the value of the reference viscosity for Sutherland model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00884">config_structure.inl:884</a></div></div>
<div class="ttc" id="aclass_c_config_html_aed0475c5a5a27525d544f40366ce561a"><div class="ttname"><a href="class_c_config.html#aed0475c5a5a27525d544f40366ce561a">CConfig::SetDensity_Ref</a></div><div class="ttdeci">void SetDensity_Ref(su2double val_density_ref)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00677">config_structure.inl:677</a></div></div>
<div class="ttc" id="aclass_c_config_html_aeec93abf99b07f5fd7505df58a5577ae"><div class="ttname"><a href="class_c_config.html#aeec93abf99b07f5fd7505df58a5577ae">CConfig::GetKind_TimeIntScheme</a></div><div class="ttdeci">unsigned short GetKind_TimeIntScheme(void)</div><div class="ttdoc">Get the kind of time integration method.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l01062">config_structure.inl:1062</a></div></div>
<div class="ttc" id="aclass_c_config_html_af0723b9f35c1762a4c8edacb35f98984"><div class="ttname"><a href="class_c_config.html#af0723b9f35c1762a4c8edacb35f98984">CConfig::GetVelocity_FreeStream</a></div><div class="ttdeci">su2double * GetVelocity_FreeStream(void)</div><div class="ttdoc">Get the vector of the dimensionalized freestream velocity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00546">config_structure.inl:546</a></div></div>
<div class="ttc" id="aclass_c_config_html_af6fbd87066353c64a6a7e97d77c237db"><div class="ttname"><a href="class_c_config.html#af6fbd87066353c64a6a7e97d77c237db">CConfig::GetKind_ViscosityModel</a></div><div class="ttdeci">unsigned short GetKind_ViscosityModel(void)</div><div class="ttdoc">Get the value of the viscosity model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00872">config_structure.inl:872</a></div></div>
<div class="ttc" id="aclass_c_config_html_af782fd344d8cbaac0d99eee409266c35"><div class="ttname"><a href="class_c_config.html#af782fd344d8cbaac0d99eee409266c35">CConfig::GetTke_FreeStreamND</a></div><div class="ttdeci">su2double GetTke_FreeStreamND(void)</div><div class="ttdoc">Get the value of the non-dimensionalized freestream viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00552">config_structure.inl:552</a></div></div>
<div class="ttc" id="aclass_c_config_html_afaa9eb2373caea9d89df79ff693c4a0d"><div class="ttname"><a href="class_c_config.html#afaa9eb2373caea9d89df79ff693c4a0d">CConfig::SetTemperature_FreeStreamND</a></div><div class="ttdeci">void SetTemperature_FreeStreamND(su2double val_temperature_freestreamnd)</div><div class="ttdoc">Set the Froude number for free surface problems.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00635">config_structure.inl:635</a></div></div>
<div class="ttc" id="aclass_c_config_html_afbc5c2467fd51eafa6e05e5bda7d3d3e"><div class="ttname"><a href="class_c_config.html#afbc5c2467fd51eafa6e05e5bda7d3d3e">CConfig::GetSystemMeasurements</a></div><div class="ttdeci">unsigned short GetSystemMeasurements(void)</div><div class="ttdoc">Governing equations of the flow (it can be different from the run time equation).</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00852">config_structure.inl:852</a></div></div>
<div class="ttc" id="aclass_c_config_html_afda4123ea9b79517fff1acf7747dd873"><div class="ttname"><a href="class_c_config.html#afda4123ea9b79517fff1acf7747dd873">CConfig::SetMu_SND</a></div><div class="ttdeci">void SetMu_SND(su2double mu_s)</div><div class="ttdoc">Set the value of the non-dimensional S for Sutherland model.</div><div class="ttdef"><b>Definition:</b> <a href="config__structure_8inl_source.html#l00902">config_structure.inl:902</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html">CFEM_DG_EulerSolver</a></div><div class="ttdoc">Main class for defining the Euler Discontinuous Galerkin finite element flow solver.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13336">solver_structure.hpp:13336</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a002d30c9052117b77a33d1f290b1195b"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a002d30c9052117b77a33d1f290b1195b">CFEM_DG_EulerSolver::BC_Sym_Plane</a></div><div class="ttdeci">virtual void BC_Sym_Plane(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray)</div><div class="ttdoc">Impose the symmetry boundary condition. It is a virtual function, because for Navier-Stokes it is ove...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l08221">solver_direct_mean_fem.cpp:8221</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a041ecaba8cd8d9bcfcec123c27bf9a7a"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a041ecaba8cd8d9bcfcec123c27bf9a7a">CFEM_DG_EulerSolver::SetTime_Step</a></div><div class="ttdeci">void SetTime_Step(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, unsigned long Iteration)</div><div class="ttdoc">Function to compute the time step for solving the Euler equations.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l03827">solver_direct_mean_fem.cpp:3827</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a0540afa5ec869952098d67fed71432f8"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a0540afa5ec869952098d67fed71432f8">CFEM_DG_EulerSolver::meshPoints</a></div><div class="ttdeci">CPointFEM * meshPoints</div><div class="ttdoc">Array of the points of the FEM mesh.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13446">solver_structure.hpp:13446</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a069e21a1a7bb86994d97296c8be8482d"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a069e21a1a7bb86994d97296c8be8482d">CFEM_DG_EulerSolver::CSF_Inv</a></div><div class="ttdeci">su2double * CSF_Inv</div><div class="ttdoc">Sideforce coefficient (inviscid contribution) for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13359">solver_structure.hpp:13359</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a07533d746dc24cbc365c157776189de4"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a07533d746dc24cbc365c157776189de4">CFEM_DG_EulerSolver::Surface_CFx_Inv</a></div><div class="ttdeci">su2double * Surface_CFx_Inv</div><div class="ttdoc">x Force coefficient (inviscid contribution) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13372">solver_structure.hpp:13372</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a0a18dfd035e17379824d2a3a032d3ab3"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a0a18dfd035e17379824d2a3a032d3ab3">CFEM_DG_EulerSolver::AccumulateSpaceTimeResidualADEROwnedElem</a></div><div class="ttdeci">void AccumulateSpaceTimeResidualADEROwnedElem(CConfig *config, const unsigned short timeLevel, const unsigned short intPoint)</div><div class="ttdoc">Function, which accumulates the space time residual of the ADER-DG time integration scheme for the ow...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l06524">solver_direct_mean_fem.cpp:6524</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a0e61340858f57929e2697e19f730c260"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a0e61340858f57929e2697e19f730c260">CFEM_DG_EulerSolver::Total_CL</a></div><div class="ttdeci">su2double Total_CL</div><div class="ttdoc">Total lift coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13393">solver_structure.hpp:13393</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a0e63fc77fc810025d45bfd8e0bf4d6dd"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a0e63fc77fc810025d45bfd8e0bf4d6dd">CFEM_DG_EulerSolver::BC_Custom</a></div><div class="ttdeci">virtual void BC_Custom(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray)</div><div class="ttdoc">Impose the user customized boundary condition. It is a virtual function, because for Navier-Stokes it...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l08607">solver_direct_mean_fem.cpp:8607</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a114589ab188875a99b7879c4099eb757"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a114589ab188875a99b7879c4099eb757">CFEM_DG_EulerSolver::entriesResAdjFaces</a></div><div class="ttdeci">vector&lt; unsigned long &gt; entriesResAdjFaces</div><div class="ttdoc">The corresponding entries in the residual of the faces.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13505">solver_structure.hpp:13505</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a11757fe7375c83ebc3179093b92d0e82"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a11757fe7375c83ebc3179093b92d0e82">CFEM_DG_EulerSolver::Surface_CMz_Inv</a></div><div class="ttdeci">su2double * Surface_CMz_Inv</div><div class="ttdoc">z Moment coefficient (inviscid contribution) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13377">solver_structure.hpp:13377</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a12a7b04efdba0f2488dc786a1261f1b0"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a12a7b04efdba0f2488dc786a1261f1b0">CFEM_DG_EulerSolver::timeInterpolDOFToIntegrationADER_DG</a></div><div class="ttdeci">const su2double * timeInterpolDOFToIntegrationADER_DG</div><div class="ttdoc">The interpolation matrix between the time DOFs and the time integration points for ADER-DG.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13470">solver_structure.hpp:13470</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a133aaaddb5579a2db12ecff0185fe94c"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a133aaaddb5579a2db12ecff0185fe94c">CFEM_DG_EulerSolver::CFx_Inv</a></div><div class="ttdeci">su2double * CFx_Inv</div><div class="ttdoc">x Force coefficient (inviscid contribution) for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13360">solver_structure.hpp:13360</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a152da9c26be58881c7f469b22c82fd2b"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a152da9c26be58881c7f469b22c82fd2b">CFEM_DG_EulerSolver::Surface_CMx_Inv</a></div><div class="ttdeci">su2double * Surface_CMx_Inv</div><div class="ttdoc">x Moment coefficient (inviscid contribution) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13375">solver_structure.hpp:13375</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a195f99f02c2acdb5c441b0e60b6ca6cc"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a195f99f02c2acdb5c441b0e60b6ca6cc">CFEM_DG_EulerSolver::Surface_CMz</a></div><div class="ttdeci">su2double * Surface_CMz</div><div class="ttdoc">z Moment coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13413">solver_structure.hpp:13413</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a1f8fc98a188469be0d59e9053457bcaf"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a1f8fc98a188469be0d59e9053457bcaf">CFEM_DG_EulerSolver::Temperature_Inf</a></div><div class="ttdeci">su2double Temperature_Inf</div><div class="ttdoc">Energy at infinity.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13350">solver_structure.hpp:13350</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a215f5d64c363a662ee0cb31cbd4f13a1"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a215f5d64c363a662ee0cb31cbd4f13a1">CFEM_DG_EulerSolver::Total_CFx</a></div><div class="ttdeci">su2double Total_CFx</div><div class="ttdoc">Total x force coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13396">solver_structure.hpp:13396</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a256b4f3287dc3bb464d39c7908c77235"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a256b4f3287dc3bb464d39c7908c77235">CFEM_DG_EulerSolver::standardElementsSol</a></div><div class="ttdeci">const CFEMStandardElement * standardElementsSol</div><div class="ttdoc">Array that contains the standard volume elements used for the solution of the DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13462">solver_structure.hpp:13462</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a25cf9b1d594afcd4b3ef2f7538a885d1"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a25cf9b1d594afcd4b3ef2f7538a885d1">CFEM_DG_EulerSolver::AllBound_CFy_Inv</a></div><div class="ttdeci">su2double AllBound_CFy_Inv</div><div class="ttdoc">Total y force coefficient (inviscid contribution) for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13385">solver_structure.hpp:13385</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a275680d0b201cfb25fdaaeb9c2ca1d22"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a275680d0b201cfb25fdaaeb9c2ca1d22">CFEM_DG_EulerSolver::nMatchingInternalFacesLocalElem</a></div><div class="ttdeci">const unsigned long * nMatchingInternalFacesLocalElem</div><div class="ttdoc">Number of local matching internal faces per time level between local elements. Cumulative storage.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13450">solver_structure.hpp:13450</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a28853952a2d55f77b1826b10c5e608b5"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a28853952a2d55f77b1826b10c5e608b5">CFEM_DG_EulerSolver::Pressure_Inf</a></div><div class="ttdeci">su2double Pressure_Inf</div><div class="ttdoc">Pressure at infinity.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13351">solver_structure.hpp:13351</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a29c6daddcdecd116aaf32d40cd09f7c2"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a29c6daddcdecd116aaf32d40cd09f7c2">CFEM_DG_EulerSolver::TolerancesADERPredictorStep</a></div><div class="ttdeci">void TolerancesADERPredictorStep(void)</div><div class="ttdoc">Function, which determines the values of the tolerances in the predictor step of ADER-DG.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l04345">solver_direct_mean_fem.cpp:4345</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a2a26031c6fd9824899ecb92125207b60"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a2a26031c6fd9824899ecb92125207b60">CFEM_DG_EulerSolver::Surface_CSF</a></div><div class="ttdeci">su2double * Surface_CSF</div><div class="ttdoc">Side-force coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13407">solver_structure.hpp:13407</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a2b4d02d555cf80f6c1c92bd31770aeb6"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a2b4d02d555cf80f6c1c92bd31770aeb6">CFEM_DG_EulerSolver::Surface_CL</a></div><div class="ttdeci">su2double * Surface_CL</div><div class="ttdoc">Lift coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13405">solver_structure.hpp:13405</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a2dc5d2b874e11337478712b88838aea1"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a2dc5d2b874e11337478712b88838aea1">CFEM_DG_EulerSolver::CMz_Inv</a></div><div class="ttdeci">su2double * CMz_Inv</div><div class="ttdoc">z Moment coefficient (inviscid contribution) for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13365">solver_structure.hpp:13365</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a31316dc2fe564329d9bb372961b10a3a"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a31316dc2fe564329d9bb372961b10a3a">CFEM_DG_EulerSolver::SetNondimensionalization</a></div><div class="ttdeci">void SetNondimensionalization(CConfig *config, unsigned short iMesh, const bool writeOutput)</div><div class="ttdoc">Set the fluid solver nondimensionalization.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l00761">solver_direct_mean_fem.cpp:761</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a3229d640319633467304b5bf69739424"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a3229d640319633467304b5bf69739424">CFEM_DG_EulerSolver::CD_Inv</a></div><div class="ttdeci">su2double * CD_Inv</div><div class="ttdoc">Drag coefficient (inviscid contribution) for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13358">solver_structure.hpp:13358</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a3233306f97b6173c5c109cae04a4c9be"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a3233306f97b6173c5c109cae04a4c9be">CFEM_DG_EulerSolver::BoundaryStates_Outlet</a></div><div class="ttdeci">void BoundaryStates_Outlet(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const CSurfaceElementFEM *surfElem, unsigned short val_marker, const su2double *solIntL, su2double *solIntR)</div><div class="ttdoc">Function, which computes the boundary states in the integration points of the boundary face by applyi...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l07577">solver_direct_mean_fem.cpp:7577</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a33db005fb5a88393f688c9f29d8bc287"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a33db005fb5a88393f688c9f29d8bc287">CFEM_DG_EulerSolver::AllBound_CEff_Inv</a></div><div class="ttdeci">su2double AllBound_CEff_Inv</div><div class="ttdoc">Total efficiency (Cl/Cd) (inviscid contribution) for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13390">solver_structure.hpp:13390</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a34748ca6005136ee4ac1028624e7530c"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a34748ca6005136ee4ac1028624e7530c">CFEM_DG_EulerSolver::nDOFsGlobal</a></div><div class="ttdeci">unsigned long nDOFsGlobal</div><div class="ttdoc">Number of global DOFs.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13426">solver_structure.hpp:13426</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a3490fa3bd85d5fade030b46f3d90fb51"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a3490fa3bd85d5fade030b46f3d90fb51">CFEM_DG_EulerSolver::CEff_Inv</a></div><div class="ttdeci">su2double * CEff_Inv</div><div class="ttdoc">Efficiency (Cl/Cd) (inviscid contribution) for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13366">solver_structure.hpp:13366</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a353efc3b5e3478ca75ba6cb27acab9bb"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a353efc3b5e3478ca75ba6cb27acab9bb">CFEM_DG_EulerSolver::timeCoefADER_DG</a></div><div class="ttdeci">const su2double * timeCoefADER_DG</div><div class="ttdoc">The time coefficients in the iteration matrix of the ADER-DG predictor step.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13468">solver_structure.hpp:13468</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a3d32ed98538d3d4c345dd9c3a7d74c28"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a3d32ed98538d3d4c345dd9c3a7d74c28">CFEM_DG_EulerSolver::Total_CFz</a></div><div class="ttdeci">su2double Total_CFz</div><div class="ttdoc">Total z force coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13398">solver_structure.hpp:13398</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a3dde950e7512a05dc691db87cd8ca51f"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a3dde950e7512a05dc691db87cd8ca51f">CFEM_DG_EulerSolver::Surface_CFx</a></div><div class="ttdeci">su2double * Surface_CFx</div><div class="ttdoc">x Force coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13408">solver_structure.hpp:13408</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a3e5c79fc125e57530648d404111e73c2"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a3e5c79fc125e57530648d404111e73c2">CFEM_DG_EulerSolver::matchingInternalFaces</a></div><div class="ttdeci">CInternalFaceElementFEM * matchingInternalFaces</div><div class="ttdoc">Array of the local matching internal faces.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13453">solver_structure.hpp:13453</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a412f5e00b438248a33f3f95ec8115fd4"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a412f5e00b438248a33f3f95ec8115fd4">CFEM_DG_EulerSolver::Energy_Inf</a></div><div class="ttdeci">su2double Energy_Inf</div><div class="ttdoc">Energy at infinity.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13349">solver_structure.hpp:13349</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a417c1b82a8a8b76d049cd48a796f68f3"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a417c1b82a8a8b76d049cd48a796f68f3">CFEM_DG_EulerSolver::Surface_CMy</a></div><div class="ttdeci">su2double * Surface_CMy</div><div class="ttdoc">y Moment coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13412">solver_structure.hpp:13412</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a437065d7efd625e534a9c7522b22d609"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a437065d7efd625e534a9c7522b22d609">CFEM_DG_EulerSolver::Surface_CSF_Inv</a></div><div class="ttdeci">su2double * Surface_CSF_Inv</div><div class="ttdoc">Side-force coefficient (inviscid contribution) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13371">solver_structure.hpp:13371</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a455240c02f2946e2263089865256170b"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a455240c02f2946e2263089865256170b">CFEM_DG_EulerSolver::AllBound_CSF_Inv</a></div><div class="ttdeci">su2double AllBound_CSF_Inv</div><div class="ttdoc">Total sideforce coefficient (inviscid contribution) for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13383">solver_structure.hpp:13383</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a456d88944ff65d3c05368245a573ecb7"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a456d88944ff65d3c05368245a573ecb7">CFEM_DG_EulerSolver::CFEM_DG_EulerSolver</a></div><div class="ttdeci">CFEM_DG_EulerSolver(void)</div><div class="ttdoc">Constructor of the class.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l00037">solver_direct_mean_fem.cpp:37</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a479dae53b587411629e2e2e42718f7a4"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a479dae53b587411629e2e2e42718f7a4">CFEM_DG_EulerSolver::AllBound_CMz_Inv</a></div><div class="ttdeci">su2double AllBound_CMz_Inv</div><div class="ttdoc">Total z moment coefficient (inviscid contribution) for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13389">solver_structure.hpp:13389</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a47bc2e588fd015b5b565e5b5263cf423"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a47bc2e588fd015b5b565e5b5263cf423">CFEM_DG_EulerSolver::timeInterpolAdjDOFToIntegrationADER_DG</a></div><div class="ttdeci">const su2double * timeInterpolAdjDOFToIntegrationADER_DG</div><div class="ttdoc">The interpolation matrix between the time DOFs of adjacent elements of a higher time level and the ti...</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13472">solver_structure.hpp:13472</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a4851d39829e12202592d85c36ea36489"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a4851d39829e12202592d85c36ea36489">CFEM_DG_EulerSolver::ComputeInviscidFluxesFace</a></div><div class="ttdeci">void ComputeInviscidFluxesFace(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const unsigned long nPoints, const su2double *normalsFace[], const su2double *gridVelsFace[], const su2double *solL, const su2double *solR, su2double *fluxes, CNumerics *numerics)</div><div class="ttdoc">Function, which computes the inviscid fluxes in face points.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l08835">solver_direct_mean_fem.cpp:8835</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a4856180300943d0a34620292be9fb44c"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a4856180300943d0a34620292be9fb44c">CFEM_DG_EulerSolver::haloElemAdjLowTimeLevel</a></div><div class="ttdeci">vector&lt; vector&lt; unsigned long &gt; &gt; haloElemAdjLowTimeLevel</div><div class="ttdoc">List of halo elements per time level that are adjacent to elements of the lower time level.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13442">solver_structure.hpp:13442</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a48b8a50d3e9deee07bd02a30249f6f6d"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a48b8a50d3e9deee07bd02a30249f6f6d">CFEM_DG_EulerSolver::BC_Far_Field</a></div><div class="ttdeci">virtual void BC_Far_Field(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray)</div><div class="ttdoc">Impose the far-field boundary condition. It is a virtual function, because for Navier-Stokes it is ov...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l08151">solver_direct_mean_fem.cpp:8151</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a492db7771aa00ca8a1b154931b7dd0ef"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a492db7771aa00ca8a1b154931b7dd0ef">CFEM_DG_EulerSolver::VecSolDOFsNew</a></div><div class="ttdeci">vector&lt; su2double &gt; VecSolDOFsNew</div><div class="ttdoc">Vector, which stores the new solution variables in the owned DOFs (needed for classical RK4 scheme).</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13482">solver_structure.hpp:13482</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a49a02faff89405aab2a322001a8c4fe6"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a49a02faff89405aab2a322001a8c4fe6">CFEM_DG_EulerSolver::volElem</a></div><div class="ttdeci">CVolumeElementFEM * volElem</div><div class="ttdoc">Array of the local volume elements, including halos.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13430">solver_structure.hpp:13430</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a4e6f20a8479376be5ce2b8f9d0a45d41"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a4e6f20a8479376be5ce2b8f9d0a45d41">CFEM_DG_EulerSolver::CFy_Inv</a></div><div class="ttdeci">su2double * CFy_Inv</div><div class="ttdoc">y Force coefficient (inviscid contribution) for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13361">solver_structure.hpp:13361</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a4eaf18ac074f0d11d4325a1965225a6b"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a4eaf18ac074f0d11d4325a1965225a6b">CFEM_DG_EulerSolver::VecSolDOFs</a></div><div class="ttdeci">vector&lt; su2double &gt; VecSolDOFs</div><div class="ttdoc">Vector, which stores the solution variables in the owned DOFs.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13481">solver_structure.hpp:13481</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a50202c322d1794f32fbfe7eff7617c25"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a50202c322d1794f32fbfe7eff7617c25">CFEM_DG_EulerSolver::Surface_CFz</a></div><div class="ttdeci">su2double * Surface_CFz</div><div class="ttdoc">z Force coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13410">solver_structure.hpp:13410</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a50d77fe3071118de657c0549bba78010"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a50d77fe3071118de657c0549bba78010">CFEM_DG_EulerSolver::AllBound_CD_Inv</a></div><div class="ttdeci">su2double AllBound_CD_Inv</div><div class="ttdoc">Total drag coefficient (inviscid contribution) for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13382">solver_structure.hpp:13382</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a5220631548af87d689c9b4acb38b7a1c"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a5220631548af87d689c9b4acb38b7a1c">CFEM_DG_EulerSolver::CheckTimeSynchronization</a></div><div class="ttdeci">void CheckTimeSynchronization(CConfig *config, const su2double TimeSync, su2double &amp;timeEvolved, bool &amp;syncTimeReached)</div><div class="ttdoc">Function, which checks whether or not the time synchronization point is reached when explicit time st...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l03981">solver_direct_mean_fem.cpp:3981</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a53f3bd445632823baa18657a29553842"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a53f3bd445632823baa18657a29553842">CFEM_DG_EulerSolver::ADER_DG_PredictorStep</a></div><div class="ttdeci">void ADER_DG_PredictorStep(CConfig *config, const unsigned long elemBeg, const unsigned long elemEnd, su2double *workArray)</div><div class="ttdoc">Function, carries out the predictor step of the ADER-DG time integration.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l04398">solver_direct_mean_fem.cpp:4398</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a541316bc7d1623f16e839578dc9a4aa9"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a541316bc7d1623f16e839578dc9a4aa9">CFEM_DG_EulerSolver::ADER_DG_TimeInterpolatePredictorSol</a></div><div class="ttdeci">void ADER_DG_TimeInterpolatePredictorSol(CConfig *config, const unsigned short iTime, const unsigned long elemBeg, const unsigned long elemEnd, const unsigned long nAdjElem, const unsigned long *adjElem, const bool secondPartTimeInt, su2double *solTimeLevel)</div><div class="ttdoc">Function, which interpolates the predictor solution of ADER-DG to the time value that corresponds to ...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l05694">solver_direct_mean_fem.cpp:5694</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a54b44d56de430143b203dedb967e69d9"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a54b44d56de430143b203dedb967e69d9">CFEM_DG_EulerSolver::Total_CMy</a></div><div class="ttdeci">su2double Total_CMy</div><div class="ttdoc">Total y moment coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13400">solver_structure.hpp:13400</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a56c65d7a358c016a7bb58dfcfc3999d7"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a56c65d7a358c016a7bb58dfcfc3999d7">CFEM_DG_EulerSolver::startLocResInternalFacesWithHaloElem</a></div><div class="ttdeci">vector&lt; unsigned long &gt; startLocResInternalFacesWithHaloElem</div><div class="ttdoc">The starting location in the residual of the faces for the time levels of internal faces between an o...</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13514">solver_structure.hpp:13514</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a57c08132a09947983dacf60feac90c5e"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a57c08132a09947983dacf60feac90c5e">CFEM_DG_EulerSolver::AllBound_CMy_Inv</a></div><div class="ttdeci">su2double AllBound_CMy_Inv</div><div class="ttdoc">Total y moment coefficient (inviscid contribution) for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13388">solver_structure.hpp:13388</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a59148852103da2fb75a30e40f7ea4eb4"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a59148852103da2fb75a30e40f7ea4eb4">CFEM_DG_EulerSolver::Initiate_MPI_ReverseCommunication</a></div><div class="ttdeci">void Initiate_MPI_ReverseCommunication(CConfig *config, const unsigned short timeLevel)</div><div class="ttdoc">Routine that initiates the reverse non-blocking communication between ranks.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l02939">solver_direct_mean_fem.cpp:2939</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a5aa7f52ba149678087c03b59ca9dd9cf"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a5aa7f52ba149678087c03b59ca9dd9cf">CFEM_DG_EulerSolver::SetInitialCondition</a></div><div class="ttdeci">void SetInitialCondition(CGeometry **geometry, CSolver ***solver_container, CConfig *config, unsigned long ExtIter)</div><div class="ttdoc">Set the initial condition for the Euler Equations.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l03139">solver_direct_mean_fem.cpp:3139</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a5b3e068f83cbf3aeb8e6a4e02b4bf27b"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a5b3e068f83cbf3aeb8e6a4e02b4bf27b">CFEM_DG_EulerSolver::Pressure_Forces</a></div><div class="ttdeci">void Pressure_Forces(CGeometry *geometry, CConfig *config)</div><div class="ttdoc">Compute the pressure forces and all the adimensional coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l06746">solver_direct_mean_fem.cpp:6746</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a5bda43e6dcef5d4811431f7e24bc6369"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a5bda43e6dcef5d4811431f7e24bc6369">CFEM_DG_EulerSolver::nGlobalColors</a></div><div class="ttdeci">int nGlobalColors</div><div class="ttdoc">Number of global colors for the Jacobian computation.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13527">solver_structure.hpp:13527</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a5bfdc0bca1daa8e5d716d4fc3c7f5867"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a5bfdc0bca1daa8e5d716d4fc3c7f5867">CFEM_DG_EulerSolver::BoundaryStates_Riemann</a></div><div class="ttdeci">void BoundaryStates_Riemann(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const CSurfaceElementFEM *surfElem, unsigned short val_marker, const su2double *solIntL, su2double *solIntR)</div><div class="ttdoc">Function, which computes the boundary states in the integration points of the boundary face by applyi...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l07654">solver_direct_mean_fem.cpp:7654</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a5d32e85923daf35ff0126d5f716ff9ec"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a5d32e85923daf35ff0126d5f716ff9ec">CFEM_DG_EulerSolver::BoundaryStates_Euler_Wall</a></div><div class="ttdeci">void BoundaryStates_Euler_Wall(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const CSurfaceElementFEM *surfElem, const su2double *solIntL, su2double *solIntR)</div><div class="ttdoc">Function, which computes the boundary states in the integration points of the boundary face by applyi...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l07395">solver_direct_mean_fem.cpp:7395</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a5f3702ec7e07a248211a10b94068af41"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a5f3702ec7e07a248211a10b94068af41">CFEM_DG_EulerSolver::ExplicitRK_Iteration</a></div><div class="ttdeci">void ExplicitRK_Iteration(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iRKStep)</div><div class="ttdoc">Update the solution using a Runge-Kutta scheme.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l07158">solver_direct_mean_fem.cpp:7158</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a651cad1a94f2024c75a1a8be347e3375"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a651cad1a94f2024c75a1a8be347e3375">CFEM_DG_EulerSolver::ProcessTaskList_DG</a></div><div class="ttdeci">void ProcessTaskList_DG(CGeometry *geometry, CSolver **solver_container, CNumerics **numerics, CConfig *config, unsigned short iMesh)</div><div class="ttdoc">Function, which processes the list of tasks to be executed by the DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l04018">solver_direct_mean_fem.cpp:4018</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a672e33567a14a4de4cbc36e0dd1ed1a3"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a672e33567a14a4de4cbc36e0dd1ed1a3">CFEM_DG_EulerSolver::AllBound_CMx_Inv</a></div><div class="ttdeci">su2double AllBound_CMx_Inv</div><div class="ttdoc">Total x moment coefficient (inviscid contribution) for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13387">solver_structure.hpp:13387</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a6a9e78792a4e1dd0b5c27501105be895"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a6a9e78792a4e1dd0b5c27501105be895">CFEM_DG_EulerSolver::Total_CFy</a></div><div class="ttdeci">su2double Total_CFy</div><div class="ttdoc">Total y force coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13397">solver_structure.hpp:13397</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a6aacb6fcbb27cf80c3f62dacb10ccdbf"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a6aacb6fcbb27cf80c3f62dacb10ccdbf">CFEM_DG_EulerSolver::Surface_CMy_Inv</a></div><div class="ttdeci">su2double * Surface_CMy_Inv</div><div class="ttdoc">y Moment coefficient (inviscid contribution) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13376">solver_structure.hpp:13376</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a6d2d005c8472c1437afd3a1846467421"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a6d2d005c8472c1437afd3a1846467421">CFEM_DG_EulerSolver::ConsVarFreeStream</a></div><div class="ttdeci">vector&lt; su2double &gt; ConsVarFreeStream</div><div class="ttdoc">Vector, which contains the free stream conservative variables.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13354">solver_structure.hpp:13354</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a6d7d256bd8da591999b249512b44617e"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a6d7d256bd8da591999b249512b44617e">CFEM_DG_EulerSolver::VecWorkSolDOFs</a></div><div class="ttdeci">vector&lt; vector&lt; su2double &gt; &gt; VecWorkSolDOFs</div><div class="ttdoc">Working double vector to store the conserved variables for the DOFs for the different time levels.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13488">solver_structure.hpp:13488</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a6e0a2262626fecae2af8958d3de6fb75"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a6e0a2262626fecae2af8958d3de6fb75">CFEM_DG_EulerSolver::Mach_Inf</a></div><div class="ttdeci">su2double Mach_Inf</div><div class="ttdoc">Mach number at infinity.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13347">solver_structure.hpp:13347</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a6e525ee74295275a1cbe9cdd275cd1b6"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a6e525ee74295275a1cbe9cdd275cd1b6">CFEM_DG_EulerSolver::nDOFsPerRank</a></div><div class="ttdeci">vector&lt; unsigned long &gt; nDOFsPerRank</div><div class="ttdoc">Number of DOFs per rank in cumulative storage format.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13521">solver_structure.hpp:13521</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a6f4c714e164d22da328988fe79553aac"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a6f4c714e164d22da328988fe79553aac">CFEM_DG_EulerSolver::Surface_CD_Inv</a></div><div class="ttdeci">su2double * Surface_CD_Inv</div><div class="ttdoc">Drag coefficient (inviscid contribution) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13370">solver_structure.hpp:13370</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a718b146b340f72455a2ca0bd3ff4982b"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a718b146b340f72455a2ca0bd3ff4982b">CFEM_DG_EulerSolver::Surface_CL_Inv</a></div><div class="ttdeci">su2double * Surface_CL_Inv</div><div class="ttdoc">Lift coefficient (inviscid contribution) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13369">solver_structure.hpp:13369</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a741af8678935b8dace1f9c821d94da07"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a741af8678935b8dace1f9c821d94da07">CFEM_DG_EulerSolver::FluidModel</a></div><div class="ttdeci">CFluidModel * FluidModel</div><div class="ttdoc">fluid model used in the solver</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13344">solver_structure.hpp:13344</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a75e4f51232371a443db3e137df8007a1"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a75e4f51232371a443db3e137df8007a1">CFEM_DG_EulerSolver::VecTotResDOFsADER</a></div><div class="ttdeci">vector&lt; su2double &gt; VecTotResDOFsADER</div><div class="ttdoc">Vector, which stores the accumulated residuals of the owned DOFs for the ADER corrector step.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13494">solver_structure.hpp:13494</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a777496791f91315cc44fa3bf90237738"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a777496791f91315cc44fa3bf90237738">CFEM_DG_EulerSolver::CMx_Inv</a></div><div class="ttdeci">su2double * CMx_Inv</div><div class="ttdoc">x Moment coefficient (inviscid contribution) for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13363">solver_structure.hpp:13363</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a785146ae1cdaef2a880dab58dfcca0e1"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a785146ae1cdaef2a880dab58dfcca0e1">CFEM_DG_EulerSolver::~CFEM_DG_EulerSolver</a></div><div class="ttdeci">virtual ~CFEM_DG_EulerSolver(void)</div><div class="ttdoc">Destructor of the class.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l00721">solver_direct_mean_fem.cpp:721</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a78f3b044c00751d3995e326b7a824048"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a78f3b044c00751d3995e326b7a824048">CFEM_DG_EulerSolver::nStandardMatchingFacesSol</a></div><div class="ttdeci">unsigned short nStandardMatchingFacesSol</div><div class="ttdoc">Number of standard matching internal faces used for solution of the DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13458">solver_structure.hpp:13458</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a7924707aed377b385c0cd7019ae1ef71"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a7924707aed377b385c0cd7019ae1ef71">CFEM_DG_EulerSolver::Total_CMz</a></div><div class="ttdeci">su2double Total_CMz</div><div class="ttdoc">Total z moment coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13401">solver_structure.hpp:13401</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a79debb4e2ee70feac94e9a420705dbf9"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a79debb4e2ee70feac94e9a420705dbf9">CFEM_DG_EulerSolver::LeftStatesIntegrationPointsBoundaryFace</a></div><div class="ttdeci">void LeftStatesIntegrationPointsBoundaryFace(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const CSurfaceElementFEM *surfElem, su2double *solFace, su2double *solIntL)</div><div class="ttdoc">Function, which computes the left state of a boundary face.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l08787">solver_direct_mean_fem.cpp:8787</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a7d7110b59eb940c5e354f2303946dcf2"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a7d7110b59eb940c5e354f2303946dcf2">CFEM_DG_EulerSolver::Surface_CFy</a></div><div class="ttdeci">su2double * Surface_CFy</div><div class="ttdoc">y Force coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13409">solver_structure.hpp:13409</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a7d84d5e44c469d17b9024f44a93bb2bc"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a7d84d5e44c469d17b9024f44a93bb2bc">CFEM_DG_EulerSolver::Surface_CEff</a></div><div class="ttdeci">su2double * Surface_CEff</div><div class="ttdoc">Efficiency (Cl/Cd) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13414">solver_structure.hpp:13414</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a7f0da04d44069701db2228210b91c59e"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a7f0da04d44069701db2228210b91c59e">CFEM_DG_EulerSolver::ADER_SpaceTimeIntegration</a></div><div class="ttdeci">void ADER_SpaceTimeIntegration(CGeometry *geometry, CSolver **solver_container, CNumerics **numerics, CConfig *config, unsigned short iMesh, unsigned short RunTime_EqSystem)</div><div class="ttdoc">Function, to carry out the space time integration for ADER with time accurate local time stepping.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l04331">solver_direct_mean_fem.cpp:4331</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a7f54ebf747f54031baaa79339ff5503f"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a7f54ebf747f54031baaa79339ff5503f">CFEM_DG_EulerSolver::nVolElemInternalPerTimeLevel</a></div><div class="ttdeci">const unsigned long * nVolElemInternalPerTimeLevel</div><div class="ttdoc">Number of internal local volume elements per time level. Internal means that the solution data does n...</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13434">solver_structure.hpp:13434</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a7fe136e76d176a903d223e989e01b29c"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a7fe136e76d176a903d223e989e01b29c">CFEM_DG_EulerSolver::nVolElemOwned</a></div><div class="ttdeci">unsigned long nVolElemOwned</div><div class="ttdoc">Number of owned local volume elements.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13429">solver_structure.hpp:13429</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a80fffbff76c3c0dbcf04030d999d8e71"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a80fffbff76c3c0dbcf04030d999d8e71">CFEM_DG_EulerSolver::Set_OldSolution</a></div><div class="ttdeci">void Set_OldSolution(CGeometry *geometry)</div><div class="ttdoc">Set the working solution of the first time level to the current solution. Used for Runge-Kutta type s...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l03817">solver_direct_mean_fem.cpp:3817</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a85ca865434583283c6fa8da85f635b74"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a85ca865434583283c6fa8da85f635b74">CFEM_DG_EulerSolver::entriesResFaces</a></div><div class="ttdeci">vector&lt; unsigned long &gt; entriesResFaces</div><div class="ttdoc">The corresponding entries in the residual of the faces.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13500">solver_structure.hpp:13500</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a86580fa20aba8a73a9bd741fdc6e6a47"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a86580fa20aba8a73a9bd741fdc6e6a47">CFEM_DG_EulerSolver::VecDeltaTime</a></div><div class="ttdeci">vector&lt; su2double &gt; VecDeltaTime</div><div class="ttdoc">Vector, which stores the time steps of the owned volume elements.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13483">solver_structure.hpp:13483</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a869796e928f7618ea7f47d9ebc80cf76"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a869796e928f7618ea7f47d9ebc80cf76">CFEM_DG_EulerSolver::BC_Outlet</a></div><div class="ttdeci">virtual void BC_Outlet(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray)</div><div class="ttdoc">Impose the outlet boundary condition.It is a virtual function, because for Navier-Stokes it is overwr...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l08479">solver_direct_mean_fem.cpp:8479</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a8811f2fe9d2efb93b2fcdedf228083d1"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a8811f2fe9d2efb93b2fcdedf228083d1">CFEM_DG_EulerSolver::Shock_Capturing_DG</a></div><div class="ttdeci">virtual void Shock_Capturing_DG(CConfig *config, const unsigned long elemBeg, const unsigned long elemEnd, su2double *workArray)</div><div class="ttdoc">Compute the artificial viscosity for shock capturing in DG. It is a virtual function,...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l05783">solver_direct_mean_fem.cpp:5783</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a8875e58364f55e735fc3732f545d5f29"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a8875e58364f55e735fc3732f545d5f29">CFEM_DG_EulerSolver::ResidualFaces</a></div><div class="ttdeci">virtual void ResidualFaces(CConfig *config, const unsigned long indFaceBeg, const unsigned long indFaceEnd, unsigned long &amp;indResFaces, CNumerics *numerics, su2double *workArray)</div><div class="ttdoc">Compute the spatial residual for the given range of faces. It is a virtual function,...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l06257">solver_direct_mean_fem.cpp:6257</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a88d4c52f65d715fc4fe957d18f05bc7a"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a88d4c52f65d715fc4fe957d18f05bc7a">CFEM_DG_EulerSolver::AllBound_CFz_Inv</a></div><div class="ttdeci">su2double AllBound_CFz_Inv</div><div class="ttdoc">Total z force coefficient (inviscid contribution) for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13386">solver_structure.hpp:13386</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a8d2f8c9a6a10df61413ba7a206a034da"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a8d2f8c9a6a10df61413ba7a206a034da">CFEM_DG_EulerSolver::startLocResFacesMarkers</a></div><div class="ttdeci">vector&lt; vector&lt; unsigned long &gt; &gt; startLocResFacesMarkers</div><div class="ttdoc">The starting location in the residual of the faces for the time levels of the boundary markers.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13507">solver_structure.hpp:13507</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a8f73c23ba58699a103874a6c8f7cebb6"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a8f73c23ba58699a103874a6c8f7cebb6">CFEM_DG_EulerSolver::nStandardBoundaryFacesSol</a></div><div class="ttdeci">unsigned short nStandardBoundaryFacesSol</div><div class="ttdoc">Number of standard boundary faces used for solution of the DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13456">solver_structure.hpp:13456</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a8f81a6011b17cbb65c8be69d517e8faf"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a8f81a6011b17cbb65c8be69d517e8faf">CFEM_DG_EulerSolver::BC_Euler_Wall</a></div><div class="ttdeci">virtual void BC_Euler_Wall(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray)</div><div class="ttdoc">Impose via the residual the Euler wall boundary condition. It is a virtual function,...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l08087">solver_direct_mean_fem.cpp:8087</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a90cc2cb0300290dd6c94022d47aa5b95"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a90cc2cb0300290dd6c94022d47aa5b95">CFEM_DG_EulerSolver::Surface_CFz_Inv</a></div><div class="ttdeci">su2double * Surface_CFz_Inv</div><div class="ttdoc">z Force coefficient (inviscid contribution) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13374">solver_structure.hpp:13374</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a92b0e3fa2d142ef6ed6c2ac4aafc9c04"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a92b0e3fa2d142ef6ed6c2ac4aafc9c04">CFEM_DG_EulerSolver::Total_CSF</a></div><div class="ttdeci">su2double Total_CSF</div><div class="ttdoc">Total sideforce coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13395">solver_structure.hpp:13395</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a93e6d09a155cd888a20b1875b77ce2be"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a93e6d09a155cd888a20b1875b77ce2be">CFEM_DG_EulerSolver::BC_HeatFlux_Wall</a></div><div class="ttdeci">virtual void BC_HeatFlux_Wall(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray)</div><div class="ttdoc">Impose a constant heat-flux condition at the wall. It is a virtual function, such that it can be over...</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8inl_source.html#l01904">solver_structure.inl:1904</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a9486f2b2e6491dc0798628f6fe4aebb3"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a9486f2b2e6491dc0798628f6fe4aebb3">CFEM_DG_EulerSolver::nDOFsLocTot</a></div><div class="ttdeci">unsigned long nDOFsLocTot</div><div class="ttdoc">Total number of local DOFs, including halos.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13424">solver_structure.hpp:13424</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a95cef33ccbfa61def433d11ddef5745d"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a95cef33ccbfa61def433d11ddef5745d">CFEM_DG_EulerSolver::sizeWorkArray</a></div><div class="ttdeci">unsigned int sizeWorkArray</div><div class="ttdoc">The size of the work array needed.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13476">solver_structure.hpp:13476</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a973142a08d87ce2338d5c64f7f1e146b"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a973142a08d87ce2338d5c64f7f1e146b">CFEM_DG_EulerSolver::Total_CEff</a></div><div class="ttdeci">su2double Total_CEff</div><div class="ttdoc">Total efficiency coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13402">solver_structure.hpp:13402</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a98849e262d69140a6a2d222d1a33de00"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a98849e262d69140a6a2d222d1a33de00">CFEM_DG_EulerSolver::VecSolDOFsPredictorADER</a></div><div class="ttdeci">vector&lt; su2double &gt; VecSolDOFsPredictorADER</div><div class="ttdoc">Vector, which stores the ADER predictor solution in the owned DOFs. These are both space and time DOF...</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13485">solver_structure.hpp:13485</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a98a70e1cdcb69212d4ad0c8783bc6dee"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a98a70e1cdcb69212d4ad0c8783bc6dee">CFEM_DG_EulerSolver::AllBound_CFx_Inv</a></div><div class="ttdeci">su2double AllBound_CFx_Inv</div><div class="ttdoc">Total x force coefficient (inviscid contribution) for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13384">solver_structure.hpp:13384</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a99232a4f053e949762b0919a6c288c73"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a99232a4f053e949762b0919a6c288c73">CFEM_DG_EulerSolver::BC_Supersonic_Outlet</a></div><div class="ttdeci">virtual void BC_Supersonic_Outlet(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray)</div><div class="ttdoc">Impose the supersonic outlet boundary condition. It is a virtual function, because for Navier-Stokes ...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l08351">solver_direct_mean_fem.cpp:8351</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a9ada4b64ba200cf75493d963191c182e"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a9ada4b64ba200cf75493d963191c182e">CFEM_DG_EulerSolver::Gamma_Minus_One</a></div><div class="ttdeci">su2double Gamma_Minus_One</div><div class="ttdoc">Fluids's Gamma - 1.0 .</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13342">solver_structure.hpp:13342</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a9bd60c9b156ccff8b417360544bf2dd1"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a9bd60c9b156ccff8b417360544bf2dd1">CFEM_DG_EulerSolver::nDOFsLocOwned</a></div><div class="ttdeci">unsigned long nDOFsLocOwned</div><div class="ttdoc">Number of owned local DOFs.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13425">solver_structure.hpp:13425</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a9d920892529ca8e2f5060f4c95238df4"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a9d920892529ca8e2f5060f4c95238df4">CFEM_DG_EulerSolver::nVolElemTot</a></div><div class="ttdeci">unsigned long nVolElemTot</div><div class="ttdoc">Total number of local volume elements, including halos.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13428">solver_structure.hpp:13428</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a9def227eeb9ccbe7a34741c58b8eb132"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a9def227eeb9ccbe7a34741c58b8eb132">CFEM_DG_EulerSolver::Surface_CFy_Inv</a></div><div class="ttdeci">su2double * Surface_CFy_Inv</div><div class="ttdoc">y Force coefficient (inviscid contribution) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13373">solver_structure.hpp:13373</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a9e7a08fa34a5d46b21a127c5e0535a98"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a9e7a08fa34a5d46b21a127c5e0535a98">CFEM_DG_EulerSolver::CFz_Inv</a></div><div class="ttdeci">su2double * CFz_Inv</div><div class="ttdoc">z Force coefficient (inviscid contribution) for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13362">solver_structure.hpp:13362</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a9f3df866845a7ab68be4c8ddc08a84ea"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a9f3df866845a7ab68be4c8ddc08a84ea">CFEM_DG_EulerSolver::Gamma</a></div><div class="ttdeci">su2double Gamma</div><div class="ttdoc">Fluid's Gamma constant (ratio of specific heats).</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13341">solver_structure.hpp:13341</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a9f443708e1245051148ad5a009120325"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a9f443708e1245051148ad5a009120325">CFEM_DG_EulerSolver::Surface_CD</a></div><div class="ttdeci">su2double * Surface_CD</div><div class="ttdoc">Drag coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13406">solver_structure.hpp:13406</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_a9f7075a39087b68ffbe4791d3e7c97aa"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#a9f7075a39087b68ffbe4791d3e7c97aa">CFEM_DG_EulerSolver::symmetrizingTermsPresent</a></div><div class="ttdeci">bool symmetrizingTermsPresent</div><div class="ttdoc">Whether or not symmetrizing terms are present in the discretization.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13518">solver_structure.hpp:13518</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_aa2b0fa39f8b4853f27c537e30681d2c7"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#aa2b0fa39f8b4853f27c537e30681d2c7">CFEM_DG_EulerSolver::Surface_CMx</a></div><div class="ttdeci">su2double * Surface_CMx</div><div class="ttdoc">x Moment coefficient for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13411">solver_structure.hpp:13411</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_aa33f1846586c3bdc563903d84338464c"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#aa33f1846586c3bdc563903d84338464c">CFEM_DG_EulerSolver::CL_Inv</a></div><div class="ttdeci">su2double * CL_Inv</div><div class="ttdoc">Lift coefficient (inviscid contribution) for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13357">solver_structure.hpp:13357</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_aa4480bd23e59713336af7ea0a57e724a"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#aa4480bd23e59713336af7ea0a57e724a">CFEM_DG_EulerSolver::VecResFaces</a></div><div class="ttdeci">vector&lt; su2double &gt; VecResFaces</div><div class="ttdoc">Vector, which stores the residuals of the DOFs that come from the faces, both boundary and internal.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13492">solver_structure.hpp:13492</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_aa7f0f59d70754d0b2abb8face8f8398d"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#aa7f0f59d70754d0b2abb8face8f8398d">CFEM_DG_EulerSolver::LoadRestart</a></div><div class="ttdeci">void LoadRestart(CGeometry **geometry, CSolver ***solver, CConfig *config, int val_iter, bool val_update_geo)</div><div class="ttdoc">Load a solution from a restart file.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l09471">solver_direct_mean_fem.cpp:9471</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_aa9c51b1803e120b62903c76d666f7dc2"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#aa9c51b1803e120b62903c76d666f7dc2">CFEM_DG_EulerSolver::Density_Inf</a></div><div class="ttdeci">su2double Density_Inf</div><div class="ttdoc">Density at infinity.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13348">solver_structure.hpp:13348</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_aaa4aaaa9a0aa09dc4863e94edf8ef6ee"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#aaa4aaaa9a0aa09dc4863e94edf8ef6ee">CFEM_DG_EulerSolver::nVolElemHaloPerTimeLevel</a></div><div class="ttdeci">const unsigned long * nVolElemHaloPerTimeLevel</div><div class="ttdoc">Number of halo volume elements per time level. Cumulative storage.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13437">solver_structure.hpp:13437</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_aabc23d10af6da02d6ea66ec9ebafb81c"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#aabc23d10af6da02d6ea66ec9ebafb81c">CFEM_DG_EulerSolver::nMarker</a></div><div class="ttdeci">unsigned long nMarker</div><div class="ttdoc">Total number of markers using the grid information.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13339">solver_structure.hpp:13339</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_aaff04081aba8d9e24f0e615161e8020f"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#aaff04081aba8d9e24f0e615161e8020f">CFEM_DG_EulerSolver::BC_Riemann</a></div><div class="ttdeci">virtual void BC_Riemann(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray)</div><div class="ttdoc">Impose the boundary condition using characteristic reconstruction. It is a virtual function,...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l08543">solver_direct_mean_fem.cpp:8543</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ab1f72e1efac556ea4cbb994142cbd555"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ab1f72e1efac556ea4cbb994142cbd555">CFEM_DG_EulerSolver::BC_Isothermal_Wall</a></div><div class="ttdeci">virtual void BC_Isothermal_Wall(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray)</div><div class="ttdoc">Impose an isothermal condition at the wall. It is a virtual function, such that it can be overwritten...</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8inl_source.html#l01913">solver_structure.inl:1913</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ab3dd315b7aa42bad300c3ad9e6af5058"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ab3dd315b7aa42bad300c3ad9e6af5058">CFEM_DG_EulerSolver::nonZeroEntriesJacobian</a></div><div class="ttdeci">vector&lt; vector&lt; unsigned long &gt; &gt; nonZeroEntriesJacobian</div><div class="ttdoc">The ID's of the DOFs for the non-zero entries of the Jacobian for the locally owned DOFs.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13523">solver_structure.hpp:13523</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ab7546cb31b73191bbac2b338c88cfbc4"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ab7546cb31b73191bbac2b338c88cfbc4">CFEM_DG_EulerSolver::InviscidFluxesInternalMatchingFace</a></div><div class="ttdeci">void InviscidFluxesInternalMatchingFace(CConfig *config, const unsigned long lBeg, const unsigned long lEnd, const unsigned short NPad, su2double *solIntL, su2double *solIntR, su2double *fluxes, CNumerics *numerics)</div><div class="ttdoc">Function, which computes the inviscid fluxes in the face integration points of a chunk of matching in...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l06381">solver_direct_mean_fem.cpp:6381</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_abad30bde8b5b03ff16260218bbb10ac9"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#abad30bde8b5b03ff16260218bbb10ac9">CFEM_DG_EulerSolver::TolSolADER</a></div><div class="ttdeci">vector&lt; su2double &gt; TolSolADER</div><div class="ttdoc">Vector, which stores the tolerances for the conserved variables in the ADER predictor step.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13478">solver_structure.hpp:13478</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_abb32d1dea64bec72ee273f0ceff0da6a"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#abb32d1dea64bec72ee273f0ceff0da6a">CFEM_DG_EulerSolver::Velocity_Inf</a></div><div class="ttdeci">su2double * Velocity_Inf</div><div class="ttdoc">Flow velocity vector at infinity.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13352">solver_structure.hpp:13352</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ac11cd50dda8ce7d14d5561576b2e673e"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ac11cd50dda8ce7d14d5561576b2e673e">CFEM_DG_EulerSolver::standardMatchingFacesSol</a></div><div class="ttdeci">const CFEMStandardInternalFace * standardMatchingFacesSol</div><div class="ttdoc">Array that contains the standard matching internal faces used for the solution of the DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13464">solver_structure.hpp:13464</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ac4a8cda93a2c52067378ab6b4a46f469"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ac4a8cda93a2c52067378ab6b4a46f469">CFEM_DG_EulerSolver::Surface_CEff_Inv</a></div><div class="ttdeci">su2double * Surface_CEff_Inv</div><div class="ttdoc">Efficiency (Cl/Cd) (inviscid contribution) for each monitoring surface.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13378">solver_structure.hpp:13378</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ac59d8dae95e3c3cc3ab3feaeb9be4b22"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ac59d8dae95e3c3cc3ab3feaeb9be4b22">CFEM_DG_EulerSolver::ComputeSpatialJacobian</a></div><div class="ttdeci">void ComputeSpatialJacobian(CGeometry *geometry, CSolver **solver_container, CNumerics **numerics, CConfig *config, unsigned short iMesh, unsigned short RunTime_EqSystem)</div><div class="ttdoc">Function, which controls the computation of the spatial Jacobian.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l03657">solver_direct_mean_fem.cpp:3657</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ac870835423bcf03b2c005d21c4056100"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ac870835423bcf03b2c005d21c4056100">CFEM_DG_EulerSolver::nStandardElementsSol</a></div><div class="ttdeci">unsigned short nStandardElementsSol</div><div class="ttdoc">Number of standard volume elements used for solution of the DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13457">solver_structure.hpp:13457</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_acef8be666e3344d8040644c250579cf4"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#acef8be666e3344d8040644c250579cf4">CFEM_DG_EulerSolver::localDOFsPerColor</a></div><div class="ttdeci">vector&lt; vector&lt; unsigned long &gt; &gt; localDOFsPerColor</div><div class="ttdoc">Double vector, which contains for every color the local DOFs.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13529">solver_structure.hpp:13529</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ad1f55a7f9d7d977e9dbae3182131673f"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ad1f55a7f9d7d977e9dbae3182131673f">CFEM_DG_EulerSolver::ownedElemAdjLowTimeLevel</a></div><div class="ttdeci">vector&lt; vector&lt; unsigned long &gt; &gt; ownedElemAdjLowTimeLevel</div><div class="ttdoc">List of owned elements per time level that are adjacent to elements of the lower time level.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13440">solver_structure.hpp:13440</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ad3428a192cfff4925a3ce854866119de"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ad3428a192cfff4925a3ce854866119de">CFEM_DG_EulerSolver::Complete_MPI_Communication</a></div><div class="ttdeci">bool Complete_MPI_Communication(CConfig *config, const unsigned short timeLevel, const bool commMustBeCompleted)</div><div class="ttdoc">Routine that completes the non-blocking communication between ranks.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l02798">solver_direct_mean_fem.cpp:2798</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ad358fa06c0e5b2762ad3258eb2c677e2"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ad358fa06c0e5b2762ad3258eb2c677e2">CFEM_DG_EulerSolver::MetaDataChunkOfElem</a></div><div class="ttdeci">void MetaDataChunkOfElem(const TElemType *elem, const unsigned long l, const unsigned long elemEnd, const unsigned short nElemSimul, const unsigned short nPadMin, unsigned long &amp;lEnd, unsigned short &amp;ind, unsigned short &amp;llEnd, unsigned short &amp;NPad)</div><div class="ttdoc">Template function, which determines some meta data for the chunk of elements/faces that must be treat...</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l14922">solver_structure.hpp:14922</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ad581ff9821dc607597049b9d52ce5fdf"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ad581ff9821dc607597049b9d52ce5fdf">CFEM_DG_EulerSolver::ADER_DG_Iteration</a></div><div class="ttdeci">void ADER_DG_Iteration(const unsigned long elemBeg, const unsigned long elemEnd)</div><div class="ttdoc">Update the solution for the ADER-DG scheme for the given range of elements.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l07374">solver_direct_mean_fem.cpp:7374</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ad69d3dd7fafb9203abbc9e876cbcd7a8"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ad69d3dd7fafb9203abbc9e876cbcd7a8">CFEM_DG_EulerSolver::AccumulateSpaceTimeResidualADERHaloElem</a></div><div class="ttdeci">void AccumulateSpaceTimeResidualADERHaloElem(CConfig *config, const unsigned short timeLevel, const unsigned short intPoint)</div><div class="ttdoc">Function, which accumulates the space time residual of the ADER-DG time integration scheme for the ha...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l06597">solver_direct_mean_fem.cpp:6597</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ad6c3809edcd555e6387d36a6a0b6550d"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ad6c3809edcd555e6387d36a6a0b6550d">CFEM_DG_EulerSolver::Total_CD</a></div><div class="ttdeci">su2double Total_CD</div><div class="ttdoc">Total drag coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13394">solver_structure.hpp:13394</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ada0555d25a6c2b0f0118dcb954169500"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ada0555d25a6c2b0f0118dcb954169500">CFEM_DG_EulerSolver::colorToIndEntriesJacobian</a></div><div class="ttdeci">vector&lt; vector&lt; int &gt; &gt; colorToIndEntriesJacobian</div><div class="ttdoc">Double vector, which contains for every local DOF the mapping from the color to the entry in the Jaco...</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13531">solver_structure.hpp:13531</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_adae0b69228db8a532b39824eee930605"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#adae0b69228db8a532b39824eee930605">CFEM_DG_EulerSolver::VecResDOFs</a></div><div class="ttdeci">vector&lt; su2double &gt; VecResDOFs</div><div class="ttdoc">Vector, which stores the residuals in the owned DOFs.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13491">solver_structure.hpp:13491</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_adcd6c309300a05665a4a738ec400e264"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#adcd6c309300a05665a4a738ec400e264">CFEM_DG_EulerSolver::standardBoundaryFacesSol</a></div><div class="ttdeci">const CFEMStandardBoundaryFace * standardBoundaryFacesSol</div><div class="ttdoc">Array that contains the standard boundary faces used for the solution of the DG solver.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13460">solver_structure.hpp:13460</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_add195fe8af6532465c2b677c7a625b3e"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#add195fe8af6532465c2b677c7a625b3e">CFEM_DG_EulerSolver::ClassicalRK4_Iteration</a></div><div class="ttdeci">void ClassicalRK4_Iteration(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iRKStep)</div><div class="ttdoc">Update the solution using the classical fourth-order Runge-Kutta scheme.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l07265">solver_direct_mean_fem.cpp:7265</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_add6a32199a4a6df9ade18f1c4fe325d1"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#add6a32199a4a6df9ade18f1c4fe325d1">CFEM_DG_EulerSolver::Cauchy_Serie</a></div><div class="ttdeci">su2double * Cauchy_Serie</div><div class="ttdoc">Complete Cauchy serial.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13419">solver_structure.hpp:13419</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_addf1215b06e5a8166f8d84979eb1ed2d"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#addf1215b06e5a8166f8d84979eb1ed2d">CFEM_DG_EulerSolver::Postprocessing</a></div><div class="ttdeci">void Postprocessing(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh)</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l03654">solver_direct_mean_fem.cpp:3654</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_addfa3cde2c8c248370af20b1e04e270d"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#addfa3cde2c8c248370af20b1e04e270d">CFEM_DG_EulerSolver::boundaries</a></div><div class="ttdeci">CBoundaryFEM * boundaries</div><div class="ttdoc">Array of the boundaries of the FEM mesh.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13454">solver_structure.hpp:13454</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ade8441a575543603f4e4218fb52e33a2"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ade8441a575543603f4e4218fb52e33a2">CFEM_DG_EulerSolver::BC_Inlet</a></div><div class="ttdeci">virtual void BC_Inlet(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray)</div><div class="ttdoc">Impose the subsonic inlet boundary condition. It is a virtual function, because for Navier-Stokes it ...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l08415">solver_direct_mean_fem.cpp:8415</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ae0cae68d85b27d5eb1d3b27ec4669f3d"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ae0cae68d85b27d5eb1d3b27ec4669f3d">CFEM_DG_EulerSolver::Set_NewSolution</a></div><div class="ttdeci">void Set_NewSolution(CGeometry *geometry)</div><div class="ttdoc">Set the new solution to the current solution for classical RK.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l03822">solver_direct_mean_fem.cpp:3822</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ae37f8eba6d7793bc4edb5de6e26f992d"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ae37f8eba6d7793bc4edb5de6e26f992d">CFEM_DG_EulerSolver::Boundary_Conditions</a></div><div class="ttdeci">void Boundary_Conditions(const unsigned short timeLevel, CConfig *config, CNumerics **numerics, const bool haloInfoNeededForBC, su2double *workArray)</div><div class="ttdoc">Function, which computes the spatial residual for the DG discretization.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l06173">solver_direct_mean_fem.cpp:6173</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_ae6c2fff0649a4d8fd723ee9776778003"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#ae6c2fff0649a4d8fd723ee9776778003">CFEM_DG_EulerSolver::Volume_Residual</a></div><div class="ttdeci">virtual void Volume_Residual(CConfig *config, const unsigned long elemBeg, const unsigned long elemEnd, su2double *workArray)</div><div class="ttdoc">Compute the volume contributions to the spatial residual. It is a virtual function,...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l05795">solver_direct_mean_fem.cpp:5795</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_aeb9ecebe3a3192fa6a00b0dcdf88d469"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#aeb9ecebe3a3192fa6a00b0dcdf88d469">CFEM_DG_EulerSolver::Preprocessing</a></div><div class="ttdeci">void Preprocessing(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, unsigned short iStep, unsigned short RunTime_EqSystem, bool Output)</div><div class="ttdoc">Compute primitive variables and their gradients.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l03374">solver_direct_mean_fem.cpp:3374</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_aef4dade05b74d3e36f5b2c91d0a6fa46"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#aef4dade05b74d3e36f5b2c91d0a6fa46">CFEM_DG_EulerSolver::Initiate_MPI_Communication</a></div><div class="ttdeci">void Initiate_MPI_Communication(CConfig *config, const unsigned short timeLevel)</div><div class="ttdoc">Routine that initiates the non-blocking communication between ranks for the givem time level.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l02732">solver_direct_mean_fem.cpp:2732</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_aef4ed349d7fd826d372ce1fe6119bfc1"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#aef4ed349d7fd826d372ce1fe6119bfc1">CFEM_DG_EulerSolver::CMy_Inv</a></div><div class="ttdeci">su2double * CMy_Inv</div><div class="ttdoc">y Moment coefficient (inviscid contribution) for each boundary.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13364">solver_structure.hpp:13364</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_af361cf886d4af1e69b91aed78ff0f5e5"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#af361cf886d4af1e69b91aed78ff0f5e5">CFEM_DG_EulerSolver::nVolElemOwnedPerTimeLevel</a></div><div class="ttdeci">const unsigned long * nVolElemOwnedPerTimeLevel</div><div class="ttdoc">Number of owned local volume elements per time level. Cumulative storage.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13432">solver_structure.hpp:13432</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_af365d7212c43e1baeaa4cdef2e8f296e"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#af365d7212c43e1baeaa4cdef2e8f296e">CFEM_DG_EulerSolver::AllBound_CL_Inv</a></div><div class="ttdeci">su2double AllBound_CL_Inv</div><div class="ttdoc">Total lift coefficient (inviscid contribution) for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13381">solver_structure.hpp:13381</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_af47adcfc34283af5e61df0a69374e912"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#af47adcfc34283af5e61df0a69374e912">CFEM_DG_EulerSolver::Total_CMx</a></div><div class="ttdeci">su2double Total_CMx</div><div class="ttdoc">Total x moment coefficient for all the boundaries.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13399">solver_structure.hpp:13399</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_af49be394a337648305708ce9d970d81a"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#af49be394a337648305708ce9d970d81a">CFEM_DG_EulerSolver::startLocResInternalFacesLocalElem</a></div><div class="ttdeci">vector&lt; unsigned long &gt; startLocResInternalFacesLocalElem</div><div class="ttdoc">The starting location in the residual of the faces for the time levels of internal faces between loca...</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13511">solver_structure.hpp:13511</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_af5891c1fd8de49fe774a68cd7bc0b6ec"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#af5891c1fd8de49fe774a68cd7bc0b6ec">CFEM_DG_EulerSolver::Complete_MPI_ReverseCommunication</a></div><div class="ttdeci">bool Complete_MPI_ReverseCommunication(CConfig *config, const unsigned short timeLevel, const bool commMustBeCompleted)</div><div class="ttdoc">Routine that completes the reverse non-blocking communication between ranks.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l03044">solver_direct_mean_fem.cpp:3044</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_af993f01423bbb8e24b8c2bb565bf55eb"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#af993f01423bbb8e24b8c2bb565bf55eb">CFEM_DG_EulerSolver::BoundaryStates_Inlet</a></div><div class="ttdeci">void BoundaryStates_Inlet(CConfig *config, const unsigned short nFaceSimul, const unsigned short NPad, const CSurfaceElementFEM *surfElem, unsigned short val_marker, const su2double *solIntL, su2double *solIntR)</div><div class="ttdoc">Function, which computes the boundary states in the integration points of the boundary face by applyi...</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l07462">solver_direct_mean_fem.cpp:7462</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_afa04dc04f2f6aece10303e9aab1ccc1e"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#afa04dc04f2f6aece10303e9aab1ccc1e">CFEM_DG_EulerSolver::nMeshPoints</a></div><div class="ttdeci">unsigned long nMeshPoints</div><div class="ttdoc">Number of mesh points in the local part of the grid.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13445">solver_structure.hpp:13445</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_afcf2187419e68b6a1a7150d641e2b84b"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#afcf2187419e68b6a1a7150d641e2b84b">CFEM_DG_EulerSolver::nMatchingInternalFacesWithHaloElem</a></div><div class="ttdeci">const unsigned long * nMatchingInternalFacesWithHaloElem</div><div class="ttdoc">Number of local matching internal faces per time level between an owned and a halo element....</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13448">solver_structure.hpp:13448</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_afd06be65d61d9e7571b40871aadbe01b"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#afd06be65d61d9e7571b40871aadbe01b">CFEM_DG_EulerSolver::nEntriesResAdjFaces</a></div><div class="ttdeci">vector&lt; unsigned long &gt; nEntriesResAdjFaces</div><div class="ttdoc">Number of entries for the DOFs in the residual of the faces, where the face is adjacent to an element...</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13502">solver_structure.hpp:13502</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_afd9d2770da1ab4b01a8bc3a86d8af9da"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#afd9d2770da1ab4b01a8bc3a86d8af9da">CFEM_DG_EulerSolver::nEntriesResFaces</a></div><div class="ttdeci">vector&lt; unsigned long &gt; nEntriesResFaces</div><div class="ttdoc">Number of entries for the DOFs in the residual of the faces. Cumulative storage.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13498">solver_structure.hpp:13498</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___euler_solver_html_afe0727b6abf5816f8fd383dac6d91196"><div class="ttname"><a href="class_c_f_e_m___d_g___euler_solver.html#afe0727b6abf5816f8fd383dac6d91196">CFEM_DG_EulerSolver::blasFunctions</a></div><div class="ttdeci">CBlasStructure * blasFunctions</div><div class="ttdoc">Pointer to the object to carry out the BLAS functionalities.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l13537">solver_structure.hpp:13537</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a04fa3111afb642b208d97efe113ff1cf"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a04fa3111afb642b208d97efe113ff1cf">CFEM_DG_NSSolver::Shock_Capturing_DG_Persson</a></div><div class="ttdeci">void Shock_Capturing_DG_Persson(const unsigned long elemBeg, const unsigned long elemEnd, su2double *workArray)</div><div class="ttdoc">Per-Olof Persson's method for capturing shock in DG.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l12234">solver_direct_mean_fem.cpp:12234</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a123ec948e378e84eca5f772d28aec0d2"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a123ec948e378e84eca5f772d28aec0d2">CFEM_DG_NSSolver::BC_Far_Field</a></div><div class="ttdeci">void BC_Far_Field(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray)</div><div class="ttdoc">Impose the far-field boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l14306">solver_direct_mean_fem.cpp:14306</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a148134abb8821df7c68a8f9adedbe851"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a148134abb8821df7c68a8f9adedbe851">CFEM_DG_NSSolver::BC_Sym_Plane</a></div><div class="ttdeci">void BC_Sym_Plane(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray)</div><div class="ttdoc">Impose the symmetry boundary condition using the residual.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l14378">solver_direct_mean_fem.cpp:14378</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a15cec95ab40ebb36ee69bc5f58840cf3"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a15cec95ab40ebb36ee69bc5f58840cf3">CFEM_DG_NSSolver::Friction_Forces</a></div><div class="ttdeci">void Friction_Forces(CGeometry *geometry, CConfig *config)</div><div class="ttdoc">Compute the viscous forces and all the addimensional coefficients.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l09747">solver_direct_mean_fem.cpp:9747</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a2865905d6ed26dcd2d2d850db9366d05"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a2865905d6ed26dcd2d2d850db9366d05">CFEM_DG_NSSolver::BC_Inlet</a></div><div class="ttdeci">void BC_Inlet(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray)</div><div class="ttdoc">Impose the subsonic inlet boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l14851">solver_direct_mean_fem.cpp:14851</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a29c1a5c8d0afd5b82ff19c6f6f64a75b"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a29c1a5c8d0afd5b82ff19c6f6f64a75b">CFEM_DG_NSSolver::CFEM_DG_NSSolver</a></div><div class="ttdeci">CFEM_DG_NSSolver(void)</div><div class="ttdoc">Constructor of the class.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l09594">solver_direct_mean_fem.cpp:9594</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a5559128bafcbb12f3f87601eca580ec5"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a5559128bafcbb12f3f87601eca580ec5">CFEM_DG_NSSolver::BC_Supersonic_Outlet</a></div><div class="ttdeci">void BC_Supersonic_Outlet(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray)</div><div class="ttdoc">Impose the supersonic outlet boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l14785">solver_direct_mean_fem.cpp:14785</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a5afc06c0edede6e3917a6b24158930ba"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a5afc06c0edede6e3917a6b24158930ba">CFEM_DG_NSSolver::ResidualFaces</a></div><div class="ttdeci">void ResidualFaces(CConfig *config, const unsigned long indFaceBeg, const unsigned long indFaceEnd, unsigned long &amp;indResFaces, CNumerics *numerics, su2double *workArray)</div><div class="ttdoc">Compute the spatial residual for the given range of faces.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l12984">solver_direct_mean_fem.cpp:12984</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a6c6944d7036c9cb3e9664f938543b52b"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a6c6944d7036c9cb3e9664f938543b52b">CFEM_DG_NSSolver::Shock_Capturing_DG</a></div><div class="ttdeci">void Shock_Capturing_DG(CConfig *config, const unsigned long elemBeg, const unsigned long elemEnd, su2double *workArray)</div><div class="ttdoc">Compute the artificial viscosity for shock capturing in DG.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l12219">solver_direct_mean_fem.cpp:12219</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a7cc49cd695dcd974a1d791de72502323"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a7cc49cd695dcd974a1d791de72502323">CFEM_DG_NSSolver::BC_HeatFlux_Wall</a></div><div class="ttdeci">void BC_HeatFlux_Wall(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray)</div><div class="ttdoc">Impose a constant heat-flux condition at the wall.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l14983">solver_direct_mean_fem.cpp:14983</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a8e27fad06f1bde21670f2e2990d3027e"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a8e27fad06f1bde21670f2e2990d3027e">CFEM_DG_NSSolver::BC_Custom</a></div><div class="ttdeci">void BC_Custom(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray)</div><div class="ttdoc">Impose the user customized boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l15314">solver_direct_mean_fem.cpp:15314</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a93ed201e11f8456abfc0a57841b781a7"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a93ed201e11f8456abfc0a57841b781a7">CFEM_DG_NSSolver::BC_Euler_Wall</a></div><div class="ttdeci">void BC_Euler_Wall(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, su2double *workArray)</div><div class="ttdoc">Impose via the residual the Euler wall boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l14240">solver_direct_mean_fem.cpp:14240</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_a993de2bb61a532e9d1508bae98dd3a12"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#a993de2bb61a532e9d1508bae98dd3a12">CFEM_DG_NSSolver::SetTime_Step</a></div><div class="ttdeci">void SetTime_Step(CGeometry *geometry, CSolver **solver_container, CConfig *config, unsigned short iMesh, unsigned long Iteration)</div><div class="ttdoc">Function to compute the time step for solving the Navier-Stokes equations.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l10338">solver_direct_mean_fem.cpp:10338</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_abcb36132263699c73988c03ca324e290"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#abcb36132263699c73988c03ca324e290">CFEM_DG_NSSolver::BC_Isothermal_Wall</a></div><div class="ttdeci">void BC_Isothermal_Wall(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray)</div><div class="ttdoc">Impose an isothermal condition at the wall.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l15115">solver_direct_mean_fem.cpp:15115</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_ac62df058348ffee37a945bcc3a66745b"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#ac62df058348ffee37a945bcc3a66745b">CFEM_DG_NSSolver::Volume_Residual</a></div><div class="ttdeci">void Volume_Residual(CConfig *config, const unsigned long elemBeg, const unsigned long elemEnd, su2double *workArray)</div><div class="ttdoc">Compute the volume contributions to the spatial residual.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l12395">solver_direct_mean_fem.cpp:12395</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_ae3273efca4ed1059dde23d2ace51491a"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#ae3273efca4ed1059dde23d2ace51491a">CFEM_DG_NSSolver::~CFEM_DG_NSSolver</a></div><div class="ttdeci">~CFEM_DG_NSSolver(void)</div><div class="ttdoc">Destructor of the class.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l09715">solver_direct_mean_fem.cpp:9715</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_ae6136de48e182fc62658c9250e01c674"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#ae6136de48e182fc62658c9250e01c674">CFEM_DG_NSSolver::BC_Outlet</a></div><div class="ttdeci">void BC_Outlet(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray)</div><div class="ttdoc">Impose the outlet boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l14917">solver_direct_mean_fem.cpp:14917</a></div></div>
<div class="ttc" id="aclass_c_f_e_m___d_g___n_s_solver_html_afa0326d05f194eaacbb86e6231b27dd4"><div class="ttname"><a href="class_c_f_e_m___d_g___n_s_solver.html#afa0326d05f194eaacbb86e6231b27dd4">CFEM_DG_NSSolver::BC_Riemann</a></div><div class="ttdeci">void BC_Riemann(CConfig *config, const unsigned long surfElemBeg, const unsigned long surfElemEnd, const CSurfaceElementFEM *surfElem, su2double *resFaces, CNumerics *conv_numerics, unsigned short val_marker, su2double *workArray)</div><div class="ttdoc">Impose the boundary condition using characteristic reconstruction.</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l15248">solver_direct_mean_fem.cpp:15248</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_boundary_face_html_a26266f4d68d95c22bbb949fe6d8f5db6"><div class="ttname"><a href="class_c_f_e_m_standard_boundary_face.html#a26266f4d68d95c22bbb949fe6d8f5db6">CFEMStandardBoundaryFace::GetNDOFsFace</a></div><div class="ttdeci">unsigned short GetNDOFsFace(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00194">fem_standard_element.inl:194</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_boundary_face_html_a283dc8babad462022e4621afe0251929"><div class="ttname"><a href="class_c_f_e_m_standard_boundary_face.html#a283dc8babad462022e4621afe0251929">CFEMStandardBoundaryFace::GetBasisFaceIntegration</a></div><div class="ttdeci">const su2double * GetBasisFaceIntegration(void) const</div><div class="ttdoc">Function, which makes available the face basis functions in the integration points.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00184">fem_standard_element.inl:184</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_boundary_face_html_a2d12edcf4ade4e05af14d9c9f2fa6e07"><div class="ttname"><a href="class_c_f_e_m_standard_boundary_face.html#a2d12edcf4ade4e05af14d9c9f2fa6e07">CFEMStandardBoundaryFace::GetBasisFaceIntegrationTranspose</a></div><div class="ttdeci">const su2double * GetBasisFaceIntegrationTranspose(void) const</div><div class="ttdoc">Function, which makes available transpose matrix of the face basis functions in the integration point...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00186">fem_standard_element.inl:186</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_boundary_face_html_a60da212d9394abf0741c61fa2a955ced"><div class="ttname"><a href="class_c_f_e_m_standard_boundary_face.html#a60da212d9394abf0741c61fa2a955ced">CFEMStandardBoundaryFace::GetMatDerBasisElemIntegrationTranspose</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegrationTranspose(void) const</div><div class="ttdoc">Function, which makes available the transpose of the matrix with the derivatives of the element basis...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00182">fem_standard_element.inl:182</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_boundary_face_html_aa2e4984684567bfa78f6556ad41a7c9c"><div class="ttname"><a href="class_c_f_e_m_standard_boundary_face.html#aa2e4984684567bfa78f6556ad41a7c9c">CFEMStandardBoundaryFace::GetPenaltyConstant</a></div><div class="ttdeci">su2double GetPenaltyConstant(void) const</div><div class="ttdoc">Function, which makes available the penalty constant for this standard face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00198">fem_standard_element.inl:198</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_boundary_face_html_aad6afe2fa8d35697a57dfc22a7542176"><div class="ttname"><a href="class_c_f_e_m_standard_boundary_face.html#aad6afe2fa8d35697a57dfc22a7542176">CFEMStandardBoundaryFace::GetNDOFsElem</a></div><div class="ttdeci">unsigned short GetNDOFsElem(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs of the adjacent element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00192">fem_standard_element.inl:192</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_boundary_face_html_af348ced10e1bc0d2a33992de84c13127"><div class="ttname"><a href="class_c_f_e_m_standard_boundary_face.html#af348ced10e1bc0d2a33992de84c13127">CFEMStandardBoundaryFace::GetMatDerBasisElemIntegration</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegration(void) const</div><div class="ttdoc">Function, which makes available the matrix with the derivatives of the element basis functions in the...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00180">fem_standard_element.inl:180</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_element_base_html_aa5ad06a05a1d7b66bccca65521168a3b"><div class="ttname"><a href="class_c_f_e_m_standard_element_base.html#aa5ad06a05a1d7b66bccca65521168a3b">CFEMStandardElementBase::GetNIntegration</a></div><div class="ttdeci">unsigned short GetNIntegration(void) const</div><div class="ttdoc">Function, which makes available the number of integration points for this standard element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00042">fem_standard_element.inl:42</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_element_base_html_abf33578c3a19de596dc704d3d4d00039"><div class="ttname"><a href="class_c_f_e_m_standard_element_base.html#abf33578c3a19de596dc704d3d4d00039">CFEMStandardElementBase::GetWeightsIntegration</a></div><div class="ttdeci">const su2double * GetWeightsIntegration(void) const</div><div class="ttdoc">Function, which makes available the weights in the integration points.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00040">fem_standard_element.inl:40</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_element_html_a007e03cd4cc6bd8f37e54411eaf0b23f"><div class="ttname"><a href="class_c_f_e_m_standard_element.html#a007e03cd4cc6bd8f37e54411eaf0b23f">CFEMStandardElement::GetNPoly</a></div><div class="ttdeci">unsigned short GetNPoly(void) const</div><div class="ttdoc">Function, which makes available the polynomial degree for this standard element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00092">fem_standard_element.inl:92</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_element_html_a0889b7c7bd8849913fabb2b4053c4b7d"><div class="ttname"><a href="class_c_f_e_m_standard_element.html#a0889b7c7bd8849913fabb2b4053c4b7d">CFEMStandardElement::GetDerMatBasisFunctionsIntTrans</a></div><div class="ttdeci">const su2double * GetDerMatBasisFunctionsIntTrans(void) const</div><div class="ttdoc">Function, which makes available the transpose matrix of the derivative of the basis functions in the ...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00070">fem_standard_element.inl:70</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_element_html_a0d8111ae54b825086ea24a9241a361f1"><div class="ttname"><a href="class_c_f_e_m_standard_element.html#a0d8111ae54b825086ea24a9241a361f1">CFEMStandardElement::GetBasisFunctionsIntegrationTrans</a></div><div class="ttdeci">const su2double * GetBasisFunctionsIntegrationTrans(void) const</div><div class="ttdoc">Function, which makes available the transpose of the basis functions in the integration points.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00056">fem_standard_element.inl:56</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_element_html_a614a01f0feddc3faadac991c7ffc267c"><div class="ttname"><a href="class_c_f_e_m_standard_element.html#a614a01f0feddc3faadac991c7ffc267c">CFEMStandardElement::GetMatVandermondeInv</a></div><div class="ttdeci">const su2double * GetMatVandermondeInv(void) const</div><div class="ttdoc">Function, which makes available the matrix storage of the inverse of Vandermonde matrix of solution D...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00066">fem_standard_element.inl:66</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_element_html_a6fbf928e9b9fa2fd9dab46309e0ed6b6"><div class="ttname"><a href="class_c_f_e_m_standard_element.html#a6fbf928e9b9fa2fd9dab46309e0ed6b6">CFEMStandardElement::GetMatBasisFunctionsIntegration</a></div><div class="ttdeci">const su2double * GetMatBasisFunctionsIntegration(void) const</div><div class="ttdoc">Function, which makes available the matrix storage of the basis functions in the integration points.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00068">fem_standard_element.inl:68</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_element_html_a8610f2db30d0c53bc46b9513d492d46b"><div class="ttname"><a href="class_c_f_e_m_standard_element.html#a8610f2db30d0c53bc46b9513d492d46b">CFEMStandardElement::GetNDOFs</a></div><div class="ttdeci">unsigned short GetNDOFs(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs for this standard element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00090">fem_standard_element.inl:90</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_element_html_ae4776b34ee12f735df9c227c10149160"><div class="ttname"><a href="class_c_f_e_m_standard_element.html#ae4776b34ee12f735df9c227c10149160">CFEMStandardElement::GetMat2ndDerBasisFunctionsInt</a></div><div class="ttdeci">const su2double * GetMat2ndDerBasisFunctionsInt(void) const</div><div class="ttdoc">Function, which makes available the matrix storage of the second derivativex of the basis functions i...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00076">fem_standard_element.inl:76</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_element_html_afaac8e4c875c81435a55a298d20492a7"><div class="ttname"><a href="class_c_f_e_m_standard_element.html#afaac8e4c875c81435a55a298d20492a7">CFEMStandardElement::GetMatDerBasisFunctionsSolDOFs</a></div><div class="ttdeci">const su2double * GetMatDerBasisFunctionsSolDOFs(void) const</div><div class="ttdoc">Function, which makes available the matrix storage of the derivative of the basis functions in the so...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00074">fem_standard_element.inl:74</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_a043294eff88a9374a936fefaca0ea860"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#a043294eff88a9374a936fefaca0ea860">CFEMStandardInternalFace::GetNDOFsElemSide1</a></div><div class="ttdeci">unsigned short GetNDOFsElemSide1(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs of the element on side 1 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00158">fem_standard_element.inl:158</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_a0719e8b18410e4720f58449ac28e8c38"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#a0719e8b18410e4720f58449ac28e8c38">CFEMStandardInternalFace::GetNDOFsElemSide0</a></div><div class="ttdeci">unsigned short GetNDOFsElemSide0(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs of the element on side 0 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00156">fem_standard_element.inl:156</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_a0e3ff97b8c11ca92ede562565eec7041"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#a0e3ff97b8c11ca92ede562565eec7041">CFEMStandardInternalFace::GetNDOFsFaceSide1</a></div><div class="ttdeci">unsigned short GetNDOFsFaceSide1(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs on side 1 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00162">fem_standard_element.inl:162</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_a0f00dfc701d8547806a8865a0fc22f3f"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#a0f00dfc701d8547806a8865a0fc22f3f">CFEMStandardInternalFace::GetMatDerBasisElemIntegrationSide1</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegrationSide1(void) const</div><div class="ttdoc">Function, which makes available the matrix with the derivatives of the element basis functions of sid...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00134">fem_standard_element.inl:134</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_a1bc86f1b12860e69e4f4ececf7ebd5dc"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#a1bc86f1b12860e69e4f4ececf7ebd5dc">CFEMStandardInternalFace::GetMatDerBasisElemIntegrationSide0</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegrationSide0(void) const</div><div class="ttdoc">Function, which makes available the matrix with the derivatives of the element basis functions of sid...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00132">fem_standard_element.inl:132</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_a5dec1874e302623d6c8fb57e7e34e960"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#a5dec1874e302623d6c8fb57e7e34e960">CFEMStandardInternalFace::GetBasisFaceIntegrationTransposeSide0</a></div><div class="ttdeci">const su2double * GetBasisFaceIntegrationTransposeSide0(void) const</div><div class="ttdoc">Function, which makes available transpose matrix of the face basis functions of side 0 in the integra...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00144">fem_standard_element.inl:144</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_a606c7cbb5727b4c2750c6449f4349492"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#a606c7cbb5727b4c2750c6449f4349492">CFEMStandardInternalFace::GetBasisFaceIntegrationSide0</a></div><div class="ttdeci">const su2double * GetBasisFaceIntegrationSide0(void) const</div><div class="ttdoc">Function, which makes available the face basis functions of side 0 in the integration points.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00140">fem_standard_element.inl:140</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_a8c3ca9c06c4b57b2a946cb0a32be0e1e"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#a8c3ca9c06c4b57b2a946cb0a32be0e1e">CFEMStandardInternalFace::GetBasisFaceIntegrationSide1</a></div><div class="ttdeci">const su2double * GetBasisFaceIntegrationSide1(void) const</div><div class="ttdoc">Function, which makes available the face basis functions of side 1 in the integration points.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00142">fem_standard_element.inl:142</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_a90446ea5444c214ece32dc39dc40a2ae"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#a90446ea5444c214ece32dc39dc40a2ae">CFEMStandardInternalFace::GetBasisFaceIntegrationTransposeSide1</a></div><div class="ttdeci">const su2double * GetBasisFaceIntegrationTransposeSide1(void) const</div><div class="ttdoc">Function, which makes available transpose matrix of the face basis functions of side 1 in the integra...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00146">fem_standard_element.inl:146</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_a98b6a45b0891c5df665f0a5bba3033c8"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#a98b6a45b0891c5df665f0a5bba3033c8">CFEMStandardInternalFace::GetMatDerBasisElemIntegrationTransposeSide1</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegrationTransposeSide1(void) const</div><div class="ttdoc">Function, which makes available the transpose of the matrix with the derivatives of the element basis...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00138">fem_standard_element.inl:138</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_ab40a08956d8e1bd5a19c7e166b63d3ee"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#ab40a08956d8e1bd5a19c7e166b63d3ee">CFEMStandardInternalFace::GetPenaltyConstant</a></div><div class="ttdeci">su2double GetPenaltyConstant(void) const</div><div class="ttdoc">Function, which makes available the penalty constant for this standard face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00164">fem_standard_element.inl:164</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_ac36f91c1dc67c889cbe1c2bea5af504c"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#ac36f91c1dc67c889cbe1c2bea5af504c">CFEMStandardInternalFace::GetMatDerBasisElemIntegrationTransposeSide0</a></div><div class="ttdeci">const su2double * GetMatDerBasisElemIntegrationTransposeSide0(void) const</div><div class="ttdoc">Function, which makes available the transpose of the matrix with the derivatives of the element basis...</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00136">fem_standard_element.inl:136</a></div></div>
<div class="ttc" id="aclass_c_f_e_m_standard_internal_face_html_acd4208ae47226c5917479d6a232b7584"><div class="ttname"><a href="class_c_f_e_m_standard_internal_face.html#acd4208ae47226c5917479d6a232b7584">CFEMStandardInternalFace::GetNDOFsFaceSide0</a></div><div class="ttdeci">unsigned short GetNDOFsFaceSide0(void) const</div><div class="ttdoc">Function, which makes available the number of DOFs on side 0 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__standard__element_8inl_source.html#l00160">fem_standard_element.inl:160</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_a169d9e9a0c7f8b5d35642940c62c4ecb"><div class="ttname"><a href="class_c_fluid_model.html#a169d9e9a0c7f8b5d35642940c62c4ecb">CFluidModel::GetPressure</a></div><div class="ttdeci">su2double GetPressure()</div><div class="ttdoc">Get fluid pressure.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00040">fluid_model.inl:40</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_a1b4858b3dc8a65fa2e8c868689191e56"><div class="ttname"><a href="class_c_fluid_model.html#a1b4858b3dc8a65fa2e8c868689191e56">CFluidModel::GetThermalConductivity</a></div><div class="ttdeci">su2double GetThermalConductivity()</div><div class="ttdoc">Get fluid thermal conductivity.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00075">fluid_model.inl:75</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_a445de8d73576e76b0264c2fc7e3430ad"><div class="ttname"><a href="class_c_fluid_model.html#a445de8d73576e76b0264c2fc7e3430ad">CFluidModel::SetTDState_hs</a></div><div class="ttdeci">virtual void SetTDState_hs(su2double h, su2double s)</div><div class="ttdoc">virtual member that would be different for each gas model implemented</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00096">fluid_model.inl:96</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_a4a2b307dfa2a545c632548c8d7c6e86c"><div class="ttname"><a href="class_c_fluid_model.html#a4a2b307dfa2a545c632548c8d7c6e86c">CFluidModel::GetSoundSpeed</a></div><div class="ttdeci">su2double GetSoundSpeed()</div><div class="ttdoc">Get fluid speed of sound.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00041">fluid_model.inl:41</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_a77fd0c1114048ef6ce3b574c9321533b"><div class="ttname"><a href="class_c_fluid_model.html#a77fd0c1114048ef6ce3b574c9321533b">CFluidModel::SetTDState_rhoT</a></div><div class="ttdeci">virtual void SetTDState_rhoT(su2double rho, su2double T)</div><div class="ttdoc">virtual member that would be different for each gas model implemented</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00097">fluid_model.inl:97</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_a8c0910de10905f2ddcf02f1a9bb7ff61"><div class="ttname"><a href="class_c_fluid_model.html#a8c0910de10905f2ddcf02f1a9bb7ff61">CFluidModel::GetSoundSpeed2</a></div><div class="ttdeci">su2double GetSoundSpeed2()</div><div class="ttdoc">Get fluid speed of sound squared.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00042">fluid_model.inl:42</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_a90fdefd3a55d97d55d5211988c9a7ab1"><div class="ttname"><a href="class_c_fluid_model.html#a90fdefd3a55d97d55d5211988c9a7ab1">CFluidModel::SetTDState_rhoe</a></div><div class="ttdeci">virtual void SetTDState_rhoe(su2double rho, su2double e)</div><div class="ttdoc">virtual member that would be different for each gas model implemented</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00093">fluid_model.inl:93</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_a99d4d8c322ea4f1072e0326f09154318"><div class="ttname"><a href="class_c_fluid_model.html#a99d4d8c322ea4f1072e0326f09154318">CFluidModel::GetStaticEnergy</a></div><div class="ttdeci">su2double GetStaticEnergy()</div><div class="ttdoc">Get fluid internal energy.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00045">fluid_model.inl:45</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_aacc86b5eb9d89d858870caf49c63eed8"><div class="ttname"><a href="class_c_fluid_model.html#aacc86b5eb9d89d858870caf49c63eed8">CFluidModel::GetLaminarViscosity</a></div><div class="ttdeci">su2double GetLaminarViscosity()</div><div class="ttdoc">Get fluid dynamic viscosity.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00058">fluid_model.inl:58</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_ab386408b4b890e3e27be7a28a740d1ae"><div class="ttname"><a href="class_c_fluid_model.html#ab386408b4b890e3e27be7a28a740d1ae">CFluidModel::GetDensity</a></div><div class="ttdeci">su2double GetDensity()</div><div class="ttdoc">Get fluid density.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00043">fluid_model.inl:43</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_aba62ecbb521322a3c475561f84d77a1a"><div class="ttname"><a href="class_c_fluid_model.html#aba62ecbb521322a3c475561f84d77a1a">CFluidModel::SetTDState_PT</a></div><div class="ttdeci">virtual void SetTDState_PT(su2double P, su2double T)</div><div class="ttdoc">virtual member that would be different for each gas model implemented</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00094">fluid_model.inl:94</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_abe5c1bbc7a5822be2ca700a296a0090a"><div class="ttname"><a href="class_c_fluid_model.html#abe5c1bbc7a5822be2ca700a296a0090a">CFluidModel::GetdmudT_rho</a></div><div class="ttdeci">su2double GetdmudT_rho()</div><div class="ttdoc">Get fluid dynamic viscosity partial derivative.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00071">fluid_model.inl:71</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_ad93e74a6cc6610e9c31c180040bda4e6"><div class="ttname"><a href="class_c_fluid_model.html#ad93e74a6cc6610e9c31c180040bda4e6">CFluidModel::SetTDState_Prho</a></div><div class="ttdeci">virtual void SetTDState_Prho(su2double P, su2double rho)</div><div class="ttdoc">virtual member that would be different for each gas model implemented</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00095">fluid_model.inl:95</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_adead4cab94b577e9e4129ef57110febd"><div class="ttname"><a href="class_c_fluid_model.html#adead4cab94b577e9e4129ef57110febd">CFluidModel::SetEnergy_Prho</a></div><div class="ttdeci">virtual void SetEnergy_Prho(su2double P, su2double rho)</div><div class="ttdoc">virtual member that would be different for each gas model implemented</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00098">fluid_model.inl:98</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_ae5660a6bc666007eb80b491873d487d2"><div class="ttname"><a href="class_c_fluid_model.html#ae5660a6bc666007eb80b491873d487d2">CFluidModel::SetLaminarViscosityModel</a></div><div class="ttdeci">void SetLaminarViscosityModel(CConfig *config)</div><div class="ttdoc">Set viscosity model.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8cpp_source.html#l00069">fluid_model.cpp:69</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_ae58726982aa144f14d097c86ae76e871"><div class="ttname"><a href="class_c_fluid_model.html#ae58726982aa144f14d097c86ae76e871">CFluidModel::GetEntropy</a></div><div class="ttdeci">su2double GetEntropy()</div><div class="ttdoc">Get fluid entropy.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00044">fluid_model.inl:44</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_aeba3f29d27211ff50acad59477105969"><div class="ttname"><a href="class_c_fluid_model.html#aeba3f29d27211ff50acad59477105969">CFluidModel::GetTemperature</a></div><div class="ttdeci">su2double GetTemperature()</div><div class="ttdoc">Get fluid temperature.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8inl_source.html#l00046">fluid_model.inl:46</a></div></div>
<div class="ttc" id="aclass_c_fluid_model_html_af21d9b7b51689e064184eb7b09ae639a"><div class="ttname"><a href="class_c_fluid_model.html#af21d9b7b51689e064184eb7b09ae639a">CFluidModel::SetThermalConductivityModel</a></div><div class="ttdeci">void SetThermalConductivityModel(CConfig *config)</div><div class="ttdoc">Set thermal conductivity model.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8cpp_source.html#l00082">fluid_model.cpp:82</a></div></div>
<div class="ttc" id="aclass_c_geometry_html"><div class="ttname"><a href="class_c_geometry.html">CGeometry</a></div><div class="ttdoc">Parent class for defining the geometry of the problem (complete geometry, multigrid agglomerated geom...</div><div class="ttdef"><b>Definition:</b> <a href="geometry__structure_8hpp_source.html#l00262">geometry_structure.hpp:262</a></div></div>
<div class="ttc" id="aclass_c_geometry_html_a22f1fbc70d2133f1d1924cc7b56caee9"><div class="ttname"><a href="class_c_geometry.html#a22f1fbc70d2133f1d1924cc7b56caee9">CGeometry::GetGlobal_nPointDomain</a></div><div class="ttdeci">virtual unsigned long GetGlobal_nPointDomain()</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="geometry__structure_8inl_source.html#l00086">geometry_structure.inl:86</a></div></div>
<div class="ttc" id="aclass_c_geometry_html_a2af01006c0c4f74ba089582f1a3587fe"><div class="ttname"><a href="class_c_geometry.html#a2af01006c0c4f74ba089582f1a3587fe">CGeometry::GetnDim</a></div><div class="ttdeci">unsigned short GetnDim(void)</div><div class="ttdoc">Get number of coordinates.</div><div class="ttdef"><b>Definition:</b> <a href="geometry__structure_8inl_source.html#l00184">geometry_structure.inl:184</a></div></div>
<div class="ttc" id="aclass_c_geometry_html_aa9837fdad77772142c8f43cf9d6d958c"><div class="ttname"><a href="class_c_geometry.html#aa9837fdad77772142c8f43cf9d6d958c">CGeometry::SetGlobal_nPointDomain</a></div><div class="ttdeci">virtual void SetGlobal_nPointDomain(unsigned long val_global_npoint)</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="geometry__structure_8inl_source.html#l00084">geometry_structure.inl:84</a></div></div>
<div class="ttc" id="aclass_c_geometry_html_af8c9098e9da9a7c6c86d7316fe76230f"><div class="ttname"><a href="class_c_geometry.html#af8c9098e9da9a7c6c86d7316fe76230f">CGeometry::GetGlobal_to_Local_Point</a></div><div class="ttdeci">virtual long GetGlobal_to_Local_Point(unsigned long val_ipoint)</div><div class="ttdoc">A virtual member.</div><div class="ttdef"><b>Definition:</b> <a href="geometry__structure_8inl_source.html#l00078">geometry_structure.inl:78</a></div></div>
<div class="ttc" id="aclass_c_geometry_html_afa2a7a03d8fd185ef68e922008008187"><div class="ttname"><a href="class_c_geometry.html#afa2a7a03d8fd185ef68e922008008187">CGeometry::SetnPointDomain</a></div><div class="ttdeci">void SetnPointDomain(unsigned long val_npoint)</div><div class="ttdoc">Set the number of grid points in the domain.</div><div class="ttdef"><b>Definition:</b> <a href="geometry__structure_8inl_source.html#l00204">geometry_structure.inl:204</a></div></div>
<div class="ttc" id="aclass_c_graph_coloring_structure_html"><div class="ttname"><a href="class_c_graph_coloring_structure.html">CGraphColoringStructure</a></div><div class="ttdoc">Class, which provides graph coloring algorithms.</div><div class="ttdef"><b>Definition:</b> <a href="graph__coloring__structure_8hpp_source.html#l00049">graph_coloring_structure.hpp:49</a></div></div>
<div class="ttc" id="aclass_c_graph_coloring_structure_html_af201979cd95be98ba34369bb30629956"><div class="ttname"><a href="class_c_graph_coloring_structure.html#af201979cd95be98ba34369bb30629956">CGraphColoringStructure::GraphVertexColoring</a></div><div class="ttdeci">void GraphVertexColoring(CConfig *config, const vector&lt; unsigned long &gt; &amp;nVerticesPerRank, const vector&lt; vector&lt; unsigned long &gt; &gt; &amp;entriesVertices, int &amp;nGlobalColors, vector&lt; int &gt; &amp;colorLocalVertices)</div><div class="ttdoc">Function, which determines the colors for the vertices of the given graph.</div><div class="ttdef"><b>Definition:</b> <a href="graph__coloring__structure_8cpp_source.html#l00041">graph_coloring_structure.cpp:41</a></div></div>
<div class="ttc" id="aclass_c_ideal_gas_html"><div class="ttname"><a href="class_c_ideal_gas.html">CIdealGas</a></div><div class="ttdoc">Child class for defining ideal gas model.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8hpp_source.html#l00328">fluid_model.hpp:328</a></div></div>
<div class="ttc" id="aclass_c_internal_face_element_f_e_m_html_a07efa5d61195d365f7650e36851c03bb"><div class="ttname"><a href="class_c_internal_face_element_f_e_m.html#a07efa5d61195d365f7650e36851c03bb">CInternalFaceElementFEM::elemID0</a></div><div class="ttdeci">unsigned long elemID0</div><div class="ttdoc">Element ID adjacent to side 0 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00399">fem_geometry_structure.hpp:399</a></div></div>
<div class="ttc" id="aclass_c_internal_face_element_f_e_m_html_a26aae78c2fbc75adc617e6d5b152886f"><div class="ttname"><a href="class_c_internal_face_element_f_e_m.html#a26aae78c2fbc75adc617e6d5b152886f">CInternalFaceElementFEM::elemID1</a></div><div class="ttdeci">unsigned long elemID1</div><div class="ttdoc">Element ID adjacent to side 1 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00400">fem_geometry_structure.hpp:400</a></div></div>
<div class="ttc" id="aclass_c_internal_face_element_f_e_m_html_a5653721389ffa28c4c5a0a10d41b0183"><div class="ttname"><a href="class_c_internal_face_element_f_e_m.html#a5653721389ffa28c4c5a0a10d41b0183">CInternalFaceElementFEM::coorIntegrationPoints</a></div><div class="ttdeci">vector&lt; su2double &gt; coorIntegrationPoints</div><div class="ttdoc">Coordinates for the integration points of this face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00419">fem_geometry_structure.hpp:419</a></div></div>
<div class="ttc" id="aclass_c_internal_face_element_f_e_m_html_a6bd23e7c338057fe4aa5bed22b284323"><div class="ttname"><a href="class_c_internal_face_element_f_e_m.html#a6bd23e7c338057fe4aa5bed22b284323">CInternalFaceElementFEM::indStandardElement</a></div><div class="ttdeci">unsigned short indStandardElement</div><div class="ttdoc">Index in the vector of standard face elements.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00397">fem_geometry_structure.hpp:397</a></div></div>
<div class="ttc" id="aclass_c_internal_face_element_f_e_m_html_aaf7209a1e287371117f9e525f6aae3e6"><div class="ttname"><a href="class_c_internal_face_element_f_e_m.html#aaf7209a1e287371117f9e525f6aae3e6">CInternalFaceElementFEM::DOFsSolElementSide0</a></div><div class="ttdeci">vector&lt; unsigned long &gt; DOFsSolElementSide0</div><div class="ttdoc">Vector of the solution DOFs of the element of side 0.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00409">fem_geometry_structure.hpp:409</a></div></div>
<div class="ttc" id="aclass_c_internal_face_element_f_e_m_html_ab2262d6fc255298ba8ac9f9c0685173c"><div class="ttname"><a href="class_c_internal_face_element_f_e_m.html#ab2262d6fc255298ba8ac9f9c0685173c">CInternalFaceElementFEM::DOFsSolFaceSide1</a></div><div class="ttdeci">vector&lt; unsigned long &gt; DOFsSolFaceSide1</div><div class="ttdoc">Vector of the solution DOFs of side 1 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00405">fem_geometry_structure.hpp:405</a></div></div>
<div class="ttc" id="aclass_c_internal_face_element_f_e_m_html_ab6c86e670d9d1ae338a04795a5638b1f"><div class="ttname"><a href="class_c_internal_face_element_f_e_m.html#ab6c86e670d9d1ae338a04795a5638b1f">CInternalFaceElementFEM::DOFsSolElementSide1</a></div><div class="ttdeci">vector&lt; unsigned long &gt; DOFsSolElementSide1</div><div class="ttdoc">Vector of the solution DOFs of the element of side 1.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00410">fem_geometry_structure.hpp:410</a></div></div>
<div class="ttc" id="aclass_c_internal_face_element_f_e_m_html_abe02962a6c79e9222e37282d146ad5a2"><div class="ttname"><a href="class_c_internal_face_element_f_e_m.html#abe02962a6c79e9222e37282d146ad5a2">CInternalFaceElementFEM::gridVelocities</a></div><div class="ttdeci">vector&lt; su2double &gt; gridVelocities</div><div class="ttdoc">Grid velocities in the integration points of this face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00420">fem_geometry_structure.hpp:420</a></div></div>
<div class="ttc" id="aclass_c_internal_face_element_f_e_m_html_ad986a0eec8bc2e27e76046f64cec1046"><div class="ttname"><a href="class_c_internal_face_element_f_e_m.html#ad986a0eec8bc2e27e76046f64cec1046">CInternalFaceElementFEM::metricNormalsFace</a></div><div class="ttdeci">vector&lt; su2double &gt; metricNormalsFace</div><div class="ttdoc">The normals in the integration points of the face. The normals point from side 0 to side 1.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00412">fem_geometry_structure.hpp:412</a></div></div>
<div class="ttc" id="aclass_c_internal_face_element_f_e_m_html_af43fe79ecbba91bb155dc13f7dfa8140"><div class="ttname"><a href="class_c_internal_face_element_f_e_m.html#af43fe79ecbba91bb155dc13f7dfa8140">CInternalFaceElementFEM::DOFsSolFaceSide0</a></div><div class="ttdeci">vector&lt; unsigned long &gt; DOFsSolFaceSide0</div><div class="ttdoc">Vector of the solution DOFs of side 0 of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00404">fem_geometry_structure.hpp:404</a></div></div>
<div class="ttc" id="aclass_c_internal_face_element_f_e_m_html_afec7875eae117cffa907fa22b0dfd2b7"><div class="ttname"><a href="class_c_internal_face_element_f_e_m.html#afec7875eae117cffa907fa22b0dfd2b7">CInternalFaceElementFEM::wallDistance</a></div><div class="ttdeci">vector&lt; su2double &gt; wallDistance</div><div class="ttdoc">The wall distance to the viscous walls for the integration points of this face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00421">fem_geometry_structure.hpp:421</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m___d_g_html"><div class="ttname"><a href="class_c_mesh_f_e_m___d_g.html">CMeshFEM_DG</a></div><div class="ttdoc">Class which contains all the variables for the DG FEM solver.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00860">fem_geometry_structure.hpp:860</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m___d_g_html_a2703c77a006ce3188d76cbdf351ca373"><div class="ttname"><a href="class_c_mesh_f_e_m___d_g.html#a2703c77a006ce3188d76cbdf351ca373">CMeshFEM_DG::GetTimeCoefADER_DG</a></div><div class="ttdeci">su2double * GetTimeCoefADER_DG(void)</div><div class="ttdoc">Function, which makes available the time coefficients in the iteration matrix of the ADER-DG predicto...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00174">fem_geometry_structure.inl:174</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m___d_g_html_a28f901b586c3e81f6a172a9489df2541"><div class="ttname"><a href="class_c_mesh_f_e_m___d_g.html#a28f901b586c3e81f6a172a9489df2541">CMeshFEM_DG::GetNStandardElementsSol</a></div><div class="ttdeci">unsigned short GetNStandardElementsSol(void)</div><div class="ttdoc">Function, which makes available the number of standard volume elements of the solution.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00186">fem_geometry_structure.inl:186</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m___d_g_html_a3939eb809d5977e54e14bfa30e9bf7b2"><div class="ttname"><a href="class_c_mesh_f_e_m___d_g.html#a3939eb809d5977e54e14bfa30e9bf7b2">CMeshFEM_DG::GetNMatchingFacesWithHaloElem</a></div><div class="ttdeci">unsigned long * GetNMatchingFacesWithHaloElem(void)</div><div class="ttdoc">Function, which makes available the number of matching internal faces between an owned element and a ...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00180">fem_geometry_structure.inl:180</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m___d_g_html_a3e70f3ccf8c20e6a134b65ddbd0db793"><div class="ttname"><a href="class_c_mesh_f_e_m___d_g.html#a3e70f3ccf8c20e6a134b65ddbd0db793">CMeshFEM_DG::GetStandardMatchingFacesSol</a></div><div class="ttdeci">CFEMStandardInternalFace * GetStandardMatchingFacesSol(void)</div><div class="ttdoc">Function, which makes available the standard internal matching faces of the solution.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00192">fem_geometry_structure.inl:192</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m___d_g_html_a543cd1533ba1dd5b7c976765047cf62a"><div class="ttname"><a href="class_c_mesh_f_e_m___d_g.html#a543cd1533ba1dd5b7c976765047cf62a">CMeshFEM_DG::GetMatchingFaces</a></div><div class="ttdeci">CInternalFaceElementFEM * GetMatchingFaces(void)</div><div class="ttdoc">Function, which makes available the matching internal faces.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00184">fem_geometry_structure.inl:184</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m___d_g_html_a54499dba9b28c04afe4fde40692e13b6"><div class="ttname"><a href="class_c_mesh_f_e_m___d_g.html#a54499dba9b28c04afe4fde40692e13b6">CMeshFEM_DG::GetStandardElementsSol</a></div><div class="ttdeci">CFEMStandardElement * GetStandardElementsSol(void)</div><div class="ttdoc">Function, which makes available the standard volume elements of the solution.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00188">fem_geometry_structure.inl:188</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m___d_g_html_a5cb43fb02147615d3bbd7d89fccc1437"><div class="ttname"><a href="class_c_mesh_f_e_m___d_g.html#a5cb43fb02147615d3bbd7d89fccc1437">CMeshFEM_DG::GetTimeInterpolDOFToIntegrationADER_DG</a></div><div class="ttdeci">su2double * GetTimeInterpolDOFToIntegrationADER_DG(void)</div><div class="ttdoc">Function, which makes available the time interpolation matrix between the time DOFs and time integrat...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00176">fem_geometry_structure.inl:176</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m___d_g_html_a615c4d6a9dd427b88692efa390bc56e0"><div class="ttname"><a href="class_c_mesh_f_e_m___d_g.html#a615c4d6a9dd427b88692efa390bc56e0">CMeshFEM_DG::GetNMatchingFacesInternal</a></div><div class="ttdeci">unsigned long * GetNMatchingFacesInternal(void)</div><div class="ttdoc">Function, which makes available the number of matching internal faces between two owned elements per ...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00182">fem_geometry_structure.inl:182</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m___d_g_html_a76e74c45b81fabf7dd4d67b7f9f8cfcf"><div class="ttname"><a href="class_c_mesh_f_e_m___d_g.html#a76e74c45b81fabf7dd4d67b7f9f8cfcf">CMeshFEM_DG::GetTimeInterpolAdjDOFToIntegrationADER_DG</a></div><div class="ttdeci">su2double * GetTimeInterpolAdjDOFToIntegrationADER_DG(void)</div><div class="ttdoc">Function, which makes available the time interpolation matrix between the adjacent time DOFs of the n...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00178">fem_geometry_structure.inl:178</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m___d_g_html_a849f86fec4a59548e161ff5309c73a3b"><div class="ttname"><a href="class_c_mesh_f_e_m___d_g.html#a849f86fec4a59548e161ff5309c73a3b">CMeshFEM_DG::GetNStandardMatchingFacesSol</a></div><div class="ttdeci">unsigned short GetNStandardMatchingFacesSol(void)</div><div class="ttdoc">Function, which makes available the number of standard internal matching faces of the solution.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00190">fem_geometry_structure.inl:190</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html"><div class="ttname"><a href="class_c_mesh_f_e_m.html">CMeshFEM</a></div><div class="ttdoc">Base class for the FEM solver.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00586">fem_geometry_structure.hpp:586</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_a2883fff4dbef506dfeffda8ed57da0b6"><div class="ttname"><a href="class_c_mesh_f_e_m.html#a2883fff4dbef506dfeffda8ed57da0b6">CMeshFEM::GetRotPerHalos</a></div><div class="ttdeci">const vector&lt; vector&lt; unsigned long &gt; &gt; &amp; GetRotPerHalos(void) const</div><div class="ttdoc">Function, which makes available the vector of vectors containing the rotational periodic halos as a c...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00145">fem_geometry_structure.inl:145</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_a2ce361abdf78606a7c979200d0651cd4"><div class="ttname"><a href="class_c_mesh_f_e_m.html#a2ce361abdf78606a7c979200d0651cd4">CMeshFEM::GetNVolElemHaloPerTimeLevel</a></div><div class="ttdeci">unsigned long * GetNVolElemHaloPerTimeLevel(void)</div><div class="ttdoc">Function, which makes available the number of halo volume elements per time level.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00125">fem_geometry_structure.inl:125</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_a2e7a02df420fb13f650e4873d2f133fb"><div class="ttname"><a href="class_c_mesh_f_e_m.html#a2e7a02df420fb13f650e4873d2f133fb">CMeshFEM::GetNMeshPoints</a></div><div class="ttdeci">unsigned long GetNMeshPoints(void)</div><div class="ttdoc">Function, which makes available the number of mesh points of the local FEM mesh.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00113">fem_geometry_structure.inl:113</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_a3c91aa9efae12fe6b85d8ff80d5bbd29"><div class="ttname"><a href="class_c_mesh_f_e_m.html#a3c91aa9efae12fe6b85d8ff80d5bbd29">CMeshFEM::GetHaloElemAdjLowTimeLevel</a></div><div class="ttdeci">vector&lt; vector&lt; unsigned long &gt; &gt; GetHaloElemAdjLowTimeLevel(void)</div><div class="ttdoc">Function, which makes available the vector of vectors containing the halo element IDs adjacent to ele...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00129">fem_geometry_structure.inl:129</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_a40be25094dbd18e97a336e62f97410b1"><div class="ttname"><a href="class_c_mesh_f_e_m.html#a40be25094dbd18e97a336e62f97410b1">CMeshFEM::GetEntitiesRecv</a></div><div class="ttdeci">const vector&lt; vector&lt; unsigned long &gt; &gt; &amp; GetEntitiesRecv(void) const</div><div class="ttdoc">Function, which makes available the vector of vectors containing the receive entities as a const refe...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00139">fem_geometry_structure.inl:139</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_a5aad0edfb69733376406772385e3b7b8"><div class="ttname"><a href="class_c_mesh_f_e_m.html#a5aad0edfb69733376406772385e3b7b8">CMeshFEM::GetEntitiesSend</a></div><div class="ttdeci">const vector&lt; vector&lt; unsigned long &gt; &gt; &amp; GetEntitiesSend(void) const</div><div class="ttdoc">Function, which makes available the vector of vectors containing the send entities as a const referen...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00141">fem_geometry_structure.inl:141</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_a6362ff203ba22102290ef749df8dc2ae"><div class="ttname"><a href="class_c_mesh_f_e_m.html#a6362ff203ba22102290ef749df8dc2ae">CMeshFEM::GetOwnedElemAdjLowTimeLevel</a></div><div class="ttdeci">vector&lt; vector&lt; unsigned long &gt; &gt; GetOwnedElemAdjLowTimeLevel(void)</div><div class="ttdoc">Function, which makes available the vector of vectors containing the owned element IDs adjacent to el...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00127">fem_geometry_structure.inl:127</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_a6577c4980bf903b48255719c1c0a06cb"><div class="ttname"><a href="class_c_mesh_f_e_m.html#a6577c4980bf903b48255719c1c0a06cb">CMeshFEM::GetNVolElemInternalPerTimeLevel</a></div><div class="ttdeci">unsigned long * GetNVolElemInternalPerTimeLevel(void)</div><div class="ttdoc">Function, which makes available the number of internal volume elements per time level.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00123">fem_geometry_structure.inl:123</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_a665c7319b3d55a66ba83cd074b35f9a5"><div class="ttname"><a href="class_c_mesh_f_e_m.html#a665c7319b3d55a66ba83cd074b35f9a5">CMeshFEM::GetNVolElemOwned</a></div><div class="ttdeci">unsigned long GetNVolElemOwned(void)</div><div class="ttdoc">Function, which makes available the number of owned volume elements in the local FEM mesh.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00115">fem_geometry_structure.inl:115</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_a77083c260f7414aebd965f8acc6b06c2"><div class="ttname"><a href="class_c_mesh_f_e_m.html#a77083c260f7414aebd965f8acc6b06c2">CMeshFEM::GetRanksRecv</a></div><div class="ttdeci">const vector&lt; int &gt; &amp; GetRanksRecv(void) const</div><div class="ttdoc">Function, which makes available the vector of receive ranks as a const reference.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00135">fem_geometry_structure.inl:135</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_a838a7b4f4ad6edcf019a90113a09b290"><div class="ttname"><a href="class_c_mesh_f_e_m.html#a838a7b4f4ad6edcf019a90113a09b290">CMeshFEM::GetVolElem</a></div><div class="ttdeci">CVolumeElementFEM * GetVolElem(void)</div><div class="ttdoc">Function, which makes available the volume elements in the local FEM mesh.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00119">fem_geometry_structure.inl:119</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_ab056ee4e0e2283a391d35c5412406c1d"><div class="ttname"><a href="class_c_mesh_f_e_m.html#ab056ee4e0e2283a391d35c5412406c1d">CMeshFEM::GetBoundaries</a></div><div class="ttdeci">CBoundaryFEM * GetBoundaries(void)</div><div class="ttdoc">Function, which makes available the boundaries of the local FEM mesh.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00109">fem_geometry_structure.inl:109</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_abe0901934ae02df89c88d001a92c1e36"><div class="ttname"><a href="class_c_mesh_f_e_m.html#abe0901934ae02df89c88d001a92c1e36">CMeshFEM::GetMeshPoints</a></div><div class="ttdeci">CPointFEM * GetMeshPoints(void)</div><div class="ttdoc">Function, which makes available the mesh points of the local FEM mesh.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00111">fem_geometry_structure.inl:111</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_ad52714f971aaaa67a26012d286f51090"><div class="ttname"><a href="class_c_mesh_f_e_m.html#ad52714f971aaaa67a26012d286f51090">CMeshFEM::GetStandardBoundaryFacesSol</a></div><div class="ttdeci">CFEMStandardBoundaryFace * GetStandardBoundaryFacesSol(void)</div><div class="ttdoc">Function, which makes available the standard boundary faces of the solution.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00133">fem_geometry_structure.inl:133</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_ad609c4e6db76df210be7140bace02120"><div class="ttname"><a href="class_c_mesh_f_e_m.html#ad609c4e6db76df210be7140bace02120">CMeshFEM::GetNStandardBoundaryFacesSol</a></div><div class="ttdeci">unsigned short GetNStandardBoundaryFacesSol(void)</div><div class="ttdoc">Function, which makes available the number of standard boundary faces of the solution.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00131">fem_geometry_structure.inl:131</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_aeb53bd5673788fa54b2b5cb8f9e4351c"><div class="ttname"><a href="class_c_mesh_f_e_m.html#aeb53bd5673788fa54b2b5cb8f9e4351c">CMeshFEM::GetNVolElemOwnedPerTimeLevel</a></div><div class="ttdeci">unsigned long * GetNVolElemOwnedPerTimeLevel(void)</div><div class="ttdoc">Function, which makes available the number of owned volume elements per time level.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00121">fem_geometry_structure.inl:121</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_aed3107fd85604d7461e62b4d10624744"><div class="ttname"><a href="class_c_mesh_f_e_m.html#aed3107fd85604d7461e62b4d10624744">CMeshFEM::GetRanksSend</a></div><div class="ttdeci">const vector&lt; int &gt; &amp; GetRanksSend(void) const</div><div class="ttdoc">Function, which makes available the vector of send ranks as a const reference.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00137">fem_geometry_structure.inl:137</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_af06ca9410fb198794145e8e58fb56f44"><div class="ttname"><a href="class_c_mesh_f_e_m.html#af06ca9410fb198794145e8e58fb56f44">CMeshFEM::GetNVolElemTot</a></div><div class="ttdeci">unsigned long GetNVolElemTot(void)</div><div class="ttdoc">Function, which makes available the total number of volume elements in the local FEM mesh.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00117">fem_geometry_structure.inl:117</a></div></div>
<div class="ttc" id="aclass_c_mesh_f_e_m_html_af94cdea59c732edb9373b95b65ea1f49"><div class="ttname"><a href="class_c_mesh_f_e_m.html#af94cdea59c732edb9373b95b65ea1f49">CMeshFEM::GetRotPerMarkers</a></div><div class="ttdeci">const vector&lt; unsigned short &gt; &amp; GetRotPerMarkers(void) const</div><div class="ttdoc">Function, which makes available the vector of rotational periodic markers as a const reference.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8inl_source.html#l00143">fem_geometry_structure.inl:143</a></div></div>
<div class="ttc" id="aclass_c_numerics_html"><div class="ttname"><a href="class_c_numerics.html">CNumerics</a></div><div class="ttdoc">Class for defining the numerical methods.</div><div class="ttdef"><b>Definition:</b> <a href="numerics__structure_8hpp_source.html#l00062">numerics_structure.hpp:62</a></div></div>
<div class="ttc" id="aclass_c_numerics_html_a41903d97957f351cd9ee63ca404985b1"><div class="ttname"><a href="class_c_numerics.html#a41903d97957f351cd9ee63ca404985b1">CNumerics::SetNormal</a></div><div class="ttdeci">void SetNormal(su2double *val_normal)</div><div class="ttdoc">Set the value of the normal vector to the face between two points.</div><div class="ttdef"><b>Definition:</b> <a href="numerics__structure_8inl_source.html#l00471">numerics_structure.inl:471</a></div></div>
<div class="ttc" id="aclass_c_numerics_html_abe734316e0047f463f059fd77a281958"><div class="ttname"><a href="class_c_numerics.html#abe734316e0047f463f059fd77a281958">CNumerics::ComputeResidual</a></div><div class="ttdeci">virtual void ComputeResidual(su2double *val_residual, CConfig *config)</div><div class="ttdoc">Compute the numerical residual.</div><div class="ttdef"><b>Definition:</b> <a href="numerics__structure_8inl_source.html#l00161">numerics_structure.inl:161</a></div></div>
<div class="ttc" id="aclass_c_numerics_html_ae15b9e4ad2008444365109c434e24207"><div class="ttname"><a href="class_c_numerics.html#ae15b9e4ad2008444365109c434e24207">CNumerics::SetGridVel</a></div><div class="ttdeci">void SetGridVel(su2double *val_gridvel_i, su2double *val_gridvel_j)</div><div class="ttdoc">Set the velocity of the computational grid.</div><div class="ttdef"><b>Definition:</b> <a href="numerics__structure_8inl_source.html#l00401">numerics_structure.inl:401</a></div></div>
<div class="ttc" id="aclass_c_numerics_html_af72b17d397adf09beed2e99e2daf895c"><div class="ttname"><a href="class_c_numerics.html#af72b17d397adf09beed2e99e2daf895c">CNumerics::SetPrimitive</a></div><div class="ttdeci">void SetPrimitive(su2double *val_v_i, su2double *val_v_j)</div><div class="ttdoc">Set the value of the primitive variables.</div><div class="ttdef"><b>Definition:</b> <a href="numerics__structure_8inl_source.html#l00228">numerics_structure.inl:228</a></div></div>
<div class="ttc" id="aclass_c_peng_robinson_html"><div class="ttname"><a href="class_c_peng_robinson.html">CPengRobinson</a></div><div class="ttdoc">Child class for defining the Peng-Robinson model.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8hpp_source.html#l00527">fluid_model.hpp:527</a></div></div>
<div class="ttc" id="aclass_c_s_g_s_model_html_a2d935e92d5cb774b14e5763ca6389a99"><div class="ttname"><a href="class_c_s_g_s_model.html#a2d935e92d5cb774b14e5763ca6389a99">CSGSModel::ComputeGradEddyViscosity_3D</a></div><div class="ttdeci">virtual void ComputeGradEddyViscosity_3D(const su2double rho, const su2double drhodx, const su2double drhody, const su2double drhodz, const su2double dudx, const su2double dudy, const su2double dudz, const su2double dvdx, const su2double dvdy, const su2double dvdz, const su2double dwdx, const su2double dwdy, const su2double dwdz, const su2double d2udx2, const su2double d2udy2, const su2double d2udz2, const su2double d2udxdy, const su2double d2udxdz, const su2double d2udydz, const su2double d2vdx2, const su2double d2vdy2, const su2double d2vdz2, const su2double d2vdxdy, const su2double d2vdxdz, const su2double d2vdydz, const su2double d2wdx2, const su2double d2wdy2, const su2double d2wdz2, const su2double d2wdxdy, const su2double d2wdxdz, const su2double d2wdydz, const su2double lenScale, const su2double distToWall, su2double &amp;dMuTdx, su2double &amp;dMuTdy, su2double &amp;dMuTdz)</div><div class="ttdoc">Virtual function to determine the gradients of the eddy viscosity for the given function arguments fo...</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8inl_source.html#l00084">sgs_model.inl:84</a></div></div>
<div class="ttc" id="aclass_c_s_g_s_model_html_a32de4fde5231a347640bf08d5be8876a"><div class="ttname"><a href="class_c_s_g_s_model.html#a32de4fde5231a347640bf08d5be8876a">CSGSModel::ComputeGradEddyViscosity_2D</a></div><div class="ttdeci">virtual void ComputeGradEddyViscosity_2D(const su2double rho, const su2double drhodx, const su2double drhody, const su2double dudx, const su2double dudy, const su2double dvdx, const su2double dvdy, const su2double d2udx2, const su2double d2udy2, const su2double d2udxdy, const su2double d2vdx2, const su2double d2vdy2, const su2double d2vdxdy, const su2double lenScale, const su2double distToWall, su2double &amp;dMuTdx, su2double &amp;dMuTdy)</div><div class="ttdoc">Virtual function to determine the gradients of the eddy viscosity for the given function arguments fo...</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8inl_source.html#l00064">sgs_model.inl:64</a></div></div>
<div class="ttc" id="aclass_c_s_g_s_model_html_a6017e86477c7d39b542d82a3b2b9f1cd"><div class="ttname"><a href="class_c_s_g_s_model.html#a6017e86477c7d39b542d82a3b2b9f1cd">CSGSModel::ComputeEddyViscosity_3D</a></div><div class="ttdeci">virtual su2double ComputeEddyViscosity_3D(const su2double rho, const su2double dudx, const su2double dudy, const su2double dudz, const su2double dvdx, const su2double dvdy, const su2double dvdz, const su2double dwdx, const su2double dwdy, const su2double dwdz, const su2double lenScale, const su2double distToWall)</div><div class="ttdoc">Virtual function to determine the eddy viscosity for the given function arguments for a 3D simulation...</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8inl_source.html#l00049">sgs_model.inl:49</a></div></div>
<div class="ttc" id="aclass_c_s_g_s_model_html_aebef9146565169091059c7b1a0fb926d"><div class="ttname"><a href="class_c_s_g_s_model.html#aebef9146565169091059c7b1a0fb926d">CSGSModel::ComputeEddyViscosity_2D</a></div><div class="ttdeci">virtual su2double ComputeEddyViscosity_2D(const su2double rho, const su2double dudx, const su2double dudy, const su2double dvdx, const su2double dvdy, const su2double lenScale, const su2double distToWall)</div><div class="ttdoc">Virtual function to determine the eddy viscosity for the given function arguments for a 2D simulation...</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8inl_source.html#l00039">sgs_model.inl:39</a></div></div>
<div class="ttc" id="aclass_c_smagorinsky_model_html"><div class="ttname"><a href="class_c_smagorinsky_model.html">CSmagorinskyModel</a></div><div class="ttdoc">Derived class for defining the Smagorinsky SGS model.</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8hpp_source.html#l00235">sgs_model.hpp:235</a></div></div>
<div class="ttc" id="aclass_c_solver_html"><div class="ttname"><a href="class_c_solver.html">CSolver</a></div><div class="ttdoc">Main class for defining the PDE solution, it requires a child class for each particular solver (Euler...</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00080">solver_structure.hpp:80</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a11fe70fe56043dd44dd79b7d9aa358f0"><div class="ttname"><a href="class_c_solver.html#a11fe70fe56043dd44dd79b7d9aa358f0">CSolver::Jacobian_j</a></div><div class="ttdeci">su2double ** Jacobian_j</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians at point j.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00121">solver_structure.hpp:121</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a1c24b55e0849f7f6ba2f62d15d7e4f8e"><div class="ttname"><a href="class_c_solver.html#a1c24b55e0849f7f6ba2f62d15d7e4f8e">CSolver::GetRes_RMS</a></div><div class="ttdeci">su2double GetRes_RMS(unsigned short val_var)</div><div class="ttdoc">Get the maximal residual, this is useful for the convergence history.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8inl_source.html#l00917">solver_structure.inl:917</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a1c63fab194b1e802e0675a70014cc95b"><div class="ttname"><a href="class_c_solver.html#a1c63fab194b1e802e0675a70014cc95b">CSolver::Jacobian</a></div><div class="ttdeci">CSysMatrix Jacobian</div><div class="ttdoc">Complete sparse Jacobian structure for implicit computations.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00152">solver_structure.hpp:152</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a203241aa245597347fb258fac60962f6"><div class="ttname"><a href="class_c_solver.html#a203241aa245597347fb258fac60962f6">CSolver::nDim</a></div><div class="ttdeci">unsigned short nDim</div><div class="ttdoc">Number of dimensions of the problem.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00091">solver_structure.hpp:91</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a223a1270fee36d9c742e806a47b0ffb3"><div class="ttname"><a href="class_c_solver.html#a223a1270fee36d9c742e806a47b0ffb3">CSolver::Jacobian_i</a></div><div class="ttdeci">su2double ** Jacobian_i</div><div class="ttdoc">Auxiliary matrices for storing point to point Jacobians at point i.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00120">solver_structure.hpp:120</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a25ae37dcfbdd521de50f5a1da2633722"><div class="ttname"><a href="class_c_solver.html#a25ae37dcfbdd521de50f5a1da2633722">CSolver::Min_Delta_Time</a></div><div class="ttdeci">su2double Min_Delta_Time</div><div class="ttdoc">Minimum value of the delta time for all the control volumes.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00095">solver_structure.hpp:95</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a2eefc28ecb9b38a0776fc4f95efdb8ed"><div class="ttname"><a href="class_c_solver.html#a2eefc28ecb9b38a0776fc4f95efdb8ed">CSolver::Residual_RMS</a></div><div class="ttdeci">su2double * Residual_RMS</div><div class="ttdoc">Vector with the mean residual for each variable.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00096">solver_structure.hpp:96</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a3ce1d9393be33a7100c900a6d367205a"><div class="ttname"><a href="class_c_solver.html#a3ce1d9393be33a7100c900a6d367205a">CSolver::size</a></div><div class="ttdeci">int size</div><div class="ttdoc">MPI Size.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00083">solver_structure.hpp:83</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a41bc448daf37985882cb2cf27ab1ffd4"><div class="ttname"><a href="class_c_solver.html#a41bc448daf37985882cb2cf27ab1ffd4">CSolver::AddRes_RMS</a></div><div class="ttdeci">void AddRes_RMS(unsigned short val_var, su2double val_residual)</div><div class="ttdoc">Adds the maximal residual, this is useful for the convergence history.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8inl_source.html#l00915">solver_structure.inl:915</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a4b5582eaad51ea3d30bd8952e3e61ee9"><div class="ttname"><a href="class_c_solver.html#a4b5582eaad51ea3d30bd8952e3e61ee9">CSolver::Restart_Vars</a></div><div class="ttdeci">int * Restart_Vars</div><div class="ttdoc">Auxiliary structure for holding the number of variables and points in a restart.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00130">solver_structure.hpp:130</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a5c2921b0edd0eec84882c328a740904a"><div class="ttname"><a href="class_c_solver.html#a5c2921b0edd0eec84882c328a740904a">CSolver::rank</a></div><div class="ttdeci">int rank</div><div class="ttdoc">MPI Rank.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00082">solver_structure.hpp:82</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a63d2dfa86c11b820cd97620eac163a49"><div class="ttname"><a href="class_c_solver.html#a63d2dfa86c11b820cd97620eac163a49">CSolver::Point_Max_Coord</a></div><div class="ttdeci">su2double ** Point_Max_Coord</div><div class="ttdoc">Vector with pointers to the coords of the maximal residual for each variable.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00105">solver_structure.hpp:105</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a69bc3df96cdb96a8b25b788118c4fcc9"><div class="ttname"><a href="class_c_solver.html#a69bc3df96cdb96a8b25b788118c4fcc9">CSolver::nVar</a></div><div class="ttdeci">unsigned short nVar</div><div class="ttdoc">Number of variables of the problem.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00085">solver_structure.hpp:85</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a6b74eb7a8bc01a4997c9844598f39d2f"><div class="ttname"><a href="class_c_solver.html#a6b74eb7a8bc01a4997c9844598f39d2f">CSolver::SetRes_RMS</a></div><div class="ttdeci">void SetRes_RMS(unsigned short val_var, su2double val_residual)</div><div class="ttdoc">Set the maximal residual, this is useful for the convergence history.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8inl_source.html#l00913">solver_structure.inl:913</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a75322711ff68e7268b0ef7b0cf03906f"><div class="ttname"><a href="class_c_solver.html#a75322711ff68e7268b0ef7b0cf03906f">CSolver::Point_Max</a></div><div class="ttdeci">unsigned long * Point_Max</div><div class="ttdoc">Vector with the maximal residual for each variable.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00103">solver_structure.hpp:103</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a7eb29d1b014277fe6fdba3a276acc67d"><div class="ttname"><a href="class_c_solver.html#a7eb29d1b014277fe6fdba3a276acc67d">CSolver::Read_SU2_Restart_Binary</a></div><div class="ttdeci">void Read_SU2_Restart_Binary(CGeometry *geometry, CConfig *config, string val_filename)</div><div class="ttdoc">Read a native SU2 restart file in binary format.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8cpp_source.html#l02345">solver_structure.cpp:2345</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a7fa2598a504eef695b0ae88db95b5c4b"><div class="ttname"><a href="class_c_solver.html#a7fa2598a504eef695b0ae88db95b5c4b">CSolver::Residual_Max</a></div><div class="ttdeci">su2double * Residual_Max</div><div class="ttdoc">Vector with the maximal residual for each variable.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00097">solver_structure.hpp:97</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a8068067ba1b56173c95d4799bfb48d9e"><div class="ttname"><a href="class_c_solver.html#a8068067ba1b56173c95d4799bfb48d9e">CSolver::AddRes_Max</a></div><div class="ttdeci">void AddRes_Max(unsigned short val_var, su2double val_residual, unsigned long val_point, su2double *val_coord)</div><div class="ttdoc">Adds the maximal residual, this is useful for the convergence history.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8inl_source.html#l00921">solver_structure.inl:921</a></div></div>
<div class="ttc" id="aclass_c_solver_html_a83cc131d1581bb838bb23721edf2afa4"><div class="ttname"><a href="class_c_solver.html#a83cc131d1581bb838bb23721edf2afa4">CSolver::Max_Delta_Time</a></div><div class="ttdeci">su2double Max_Delta_Time</div><div class="ttdoc">Maximum value of the delta time for all the control volumes.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00094">solver_structure.hpp:94</a></div></div>
<div class="ttc" id="aclass_c_solver_html_ac5d5660eff53510f678a3aa122130585"><div class="ttname"><a href="class_c_solver.html#ac5d5660eff53510f678a3aa122130585">CSolver::Read_SU2_Restart_ASCII</a></div><div class="ttdeci">void Read_SU2_Restart_ASCII(CGeometry *geometry, CConfig *config, string val_filename)</div><div class="ttdoc">Read a native SU2 restart file in ASCII format.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8cpp_source.html#l02194">solver_structure.cpp:2194</a></div></div>
<div class="ttc" id="aclass_c_solver_html_accab22fb55e07508cf8be5a3b5f4fa02"><div class="ttname"><a href="class_c_solver.html#accab22fb55e07508cf8be5a3b5f4fa02">CSolver::Restart_Data</a></div><div class="ttdeci">passivedouble * Restart_Data</div><div class="ttdoc">Auxiliary structure for holding the data values from a restart.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8hpp_source.html#l00132">solver_structure.hpp:132</a></div></div>
<div class="ttc" id="aclass_c_solver_html_adf14c8391575b286636b04e66f0b5ca7"><div class="ttname"><a href="class_c_solver.html#adf14c8391575b286636b04e66f0b5ca7">CSolver::SetRes_Max</a></div><div class="ttdeci">void SetRes_Max(unsigned short val_var, su2double val_residual, unsigned long val_point)</div><div class="ttdoc">Set the maximal residual, this is useful for the convergence history.</div><div class="ttdef"><b>Definition:</b> <a href="solver__structure_8inl_source.html#l00919">solver_structure.inl:919</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html"><div class="ttname"><a href="class_c_surface_element_f_e_m.html">CSurfaceElementFEM</a></div><div class="ttdoc">Class to store a surface element for the FEM solver.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00464">fem_geometry_structure.hpp:464</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_a01bc57f549254d1a4c48b56de5c135c6"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#a01bc57f549254d1a4c48b56de5c135c6">CSurfaceElementFEM::volElemID</a></div><div class="ttdeci">unsigned long volElemID</div><div class="ttdoc">ID of the corresponding volume element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00472">fem_geometry_structure.hpp:472</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_a2ce24062976b9c064622aad15699e3dd"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#a2ce24062976b9c064622aad15699e3dd">CSurfaceElementFEM::metricNormalsFace</a></div><div class="ttdeci">vector&lt; su2double &gt; metricNormalsFace</div><div class="ttdoc">The normals in the integration points of the face. The normals point out of the adjacent element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00488">fem_geometry_structure.hpp:488</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_a3acf4bc4e5877c7e1bebd11cdf99a8f5"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#a3acf4bc4e5877c7e1bebd11cdf99a8f5">CSurfaceElementFEM::coorIntegrationPoints</a></div><div class="ttdeci">vector&lt; su2double &gt; coorIntegrationPoints</div><div class="ttdoc">The coordinates of the integration points of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00492">fem_geometry_structure.hpp:492</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_a49f9ee99ed3a8a6c5c895050f29169d8"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#a49f9ee99ed3a8a6c5c895050f29169d8">CSurfaceElementFEM::metricCoorDerivFace</a></div><div class="ttdeci">vector&lt; su2double &gt; metricCoorDerivFace</div><div class="ttdoc">The terms drdx, dsdx, etc. in the integration points of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00490">fem_geometry_structure.hpp:490</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_a502c48a6cfd3ede3dd87f7b18922044f"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#a502c48a6cfd3ede3dd87f7b18922044f">CSurfaceElementFEM::indStandardElement</a></div><div class="ttdeci">unsigned short indStandardElement</div><div class="ttdoc">Index in the vector of standard elements.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00470">fem_geometry_structure.hpp:470</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_a69fdb86db7c5b6ac05be11490c3696b5"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#a69fdb86db7c5b6ac05be11490c3696b5">CSurfaceElementFEM::wallDistance</a></div><div class="ttdeci">vector&lt; su2double &gt; wallDistance</div><div class="ttdoc">The wall distances of the integration points of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00494">fem_geometry_structure.hpp:494</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_a75e3433e592f810c39db50d1377b0509"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#a75e3433e592f810c39db50d1377b0509">CSurfaceElementFEM::gridVelocities</a></div><div class="ttdeci">vector&lt; su2double &gt; gridVelocities</div><div class="ttdoc">Grid velocities in the integration points of this face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00493">fem_geometry_structure.hpp:493</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_a7a048944dcc446cbc2fc2128bfa425cc"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#a7a048944dcc446cbc2fc2128bfa425cc">CSurfaceElementFEM::donorsWallFunction</a></div><div class="ttdeci">vector&lt; unsigned long &gt; donorsWallFunction</div><div class="ttdoc">Local element IDs of the donors for the wall function treatment. These donors can be halo's.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00497">fem_geometry_structure.hpp:497</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_aa6f58573b6ae42747d3e98e1497d76f1"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#aa6f58573b6ae42747d3e98e1497d76f1">CSurfaceElementFEM::intPerWallFunctionDonor</a></div><div class="ttdeci">vector&lt; unsigned short &gt; intPerWallFunctionDonor</div><div class="ttdoc">The integration points per donor element for the wall function treatment.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00501">fem_geometry_structure.hpp:501</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_aae397626d48e4506157b9c4d7df06ab4"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#aae397626d48e4506157b9c4d7df06ab4">CSurfaceElementFEM::nIntPerWallFunctionDonor</a></div><div class="ttdeci">vector&lt; unsigned short &gt; nIntPerWallFunctionDonor</div><div class="ttdoc">The number of integration points per donor element for the wall function treatment.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00499">fem_geometry_structure.hpp:499</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_abdf9f21e0435e853d60d7faeecbb5e2f"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#abdf9f21e0435e853d60d7faeecbb5e2f">CSurfaceElementFEM::DOFsSolElement</a></div><div class="ttdeci">vector&lt; unsigned long &gt; DOFsSolElement</div><div class="ttdoc">Vector of the solution DOFs of the adjacent element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00486">fem_geometry_structure.hpp:486</a></div></div>
<div class="ttc" id="aclass_c_surface_element_f_e_m_html_aee91841e533b10cdbe3b3b09e98e3695"><div class="ttname"><a href="class_c_surface_element_f_e_m.html#aee91841e533b10cdbe3b3b09e98e3695">CSurfaceElementFEM::DOFsSolFace</a></div><div class="ttdeci">vector&lt; unsigned long &gt; DOFsSolFace</div><div class="ttdoc">Vector of the solution DOFs of the face.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00483">fem_geometry_structure.hpp:483</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html"><div class="ttname"><a href="class_c_task_definition.html">CTaskDefinition</a></div><div class="ttdoc">Class for defining a task to be carried out.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00048">task_definition.hpp:48</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a173b606ca522e3ac4103f4e43311e082"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a173b606ca522e3ac4103f4e43311e082">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_OWNED</a></div><div class="ttdeci">@ BOUNDARY_CONDITIONS_DEPEND_ON_OWNED</div><div class="ttdoc">Compute the contribution to the residual from the boundary conditions that only depend on owned eleme...</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00070">task_definition.hpp:70</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a223498245ffb57eb996c758cb9bcff43"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a223498245ffb57eb996c758cb9bcff43">CTaskDefinition::INITIATE_REVERSE_MPI_COMMUNICATION</a></div><div class="ttdeci">@ INITIATE_REVERSE_MPI_COMMUNICATION</div><div class="ttdoc">Start the communication of the residuals.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00061">task_definition.hpp:61</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a36f92d9c7d2f67190ce5da2cc0dfb885"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a36f92d9c7d2f67190ce5da2cc0dfb885">CTaskDefinition::ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS</a></div><div class="ttdeci">@ ADER_PREDICTOR_STEP_INTERNAL_ELEMENTS</div><div class="ttdoc">ADER predictor step for internal elements.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00058">task_definition.hpp:58</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a38b0ce8cd837938d82de2e50ec9e2a2a"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a38b0ce8cd837938d82de2e50ec9e2a2a">CTaskDefinition::INITIATE_MPI_COMMUNICATION</a></div><div class="ttdeci">@ INITIATE_MPI_COMMUNICATION</div><div class="ttdoc">Start the communication of the conserved variables.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00059">task_definition.hpp:59</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a3bfecd203c9e27daa248a223ab8fa3cb"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a3bfecd203c9e27daa248a223ab8fa3cb">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_HALO_ELEMENTS</a></div><div class="ttdeci">@ ADER_ACCUMULATE_SPACETIME_RESIDUAL_HALO_ELEMENTS</div><div class="ttdoc">Accumlate the ADER space time residual for the halo elements.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00075">task_definition.hpp:75</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a488a3ac4df1541941741ed605e6b7121"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a488a3ac4df1541941741ed605e6b7121">CTaskDefinition::ADER_UPDATE_SOLUTION</a></div><div class="ttdeci">@ ADER_UPDATE_SOLUTION</div><div class="ttdoc">Update the solution for the ADER scheme.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00078">task_definition.hpp:77</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a4f83604f71f03a0535dbc845096bcfec"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a4f83604f71f03a0535dbc845096bcfec">CTaskDefinition::SURFACE_RESIDUAL_OWNED_ELEMENTS</a></div><div class="ttdeci">@ SURFACE_RESIDUAL_OWNED_ELEMENTS</div><div class="ttdoc">Compute the contribution to the residual from the interior surface integral between owned elements.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00068">task_definition.hpp:68</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a701f1f1d4796783265f1ca3c9b0ace32"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a701f1f1d4796783265f1ca3c9b0ace32">CTaskDefinition::SUM_UP_RESIDUAL_CONTRIBUTIONS_OWNED_ELEMENTS</a></div><div class="ttdeci">@ SUM_UP_RESIDUAL_CONTRIBUTIONS_OWNED_ELEMENTS</div><div class="ttdoc">Sum up all contributions to the residual for the owned elements.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00072">task_definition.hpp:72</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a7c76da9a0dfec35be76a43ae8c059c9e"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a7c76da9a0dfec35be76a43ae8c059c9e">CTaskDefinition::COMPLETE_MPI_COMMUNICATION</a></div><div class="ttdeci">@ COMPLETE_MPI_COMMUNICATION</div><div class="ttdoc">Complete the communication of the conserved variables.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00060">task_definition.hpp:60</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a8d40e9069e07e9a58bfaebe57d05bbbd"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a8d40e9069e07e9a58bfaebe57d05bbbd">CTaskDefinition::ADER_TIME_INTERPOLATE_HALO_ELEMENTS</a></div><div class="ttdeci">@ ADER_TIME_INTERPOLATE_HALO_ELEMENTS</div><div class="ttdoc">Carry out a time interpolation to an integration point for the halo elements.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00064">task_definition.hpp:64</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a9e8d6353cb1f2eba954d362e17be57c0"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9e8d6353cb1f2eba954d362e17be57c0">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_HALO_ELEMENTS</a></div><div class="ttdeci">@ SHOCK_CAPTURING_VISCOSITY_HALO_ELEMENTS</div><div class="ttdoc">Compute the shock capturing artificial viscosity for the halo elements, if needed.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00066">task_definition.hpp:66</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74a9f1a6175c942a7aab7fe961d7b144779"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74a9f1a6175c942a7aab7fe961d7b144779">CTaskDefinition::SHOCK_CAPTURING_VISCOSITY_OWNED_ELEMENTS</a></div><div class="ttdeci">@ SHOCK_CAPTURING_VISCOSITY_OWNED_ELEMENTS</div><div class="ttdoc">Compute the shock capturing artificial viscosity for the owned elements, if needed.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00065">task_definition.hpp:65</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74aa5a84198558a8415e59d8179c9f9086b"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aa5a84198558a8415e59d8179c9f9086b">CTaskDefinition::SURFACE_RESIDUAL_HALO_ELEMENTS</a></div><div class="ttdeci">@ SURFACE_RESIDUAL_HALO_ELEMENTS</div><div class="ttdoc">Compute the contribution to the residual from the interior surface integral between an owned and halo...</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00069">task_definition.hpp:69</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac056ed05b47e44894d17fa8e1b28e17">CTaskDefinition::ADER_PREDICTOR_STEP_COMM_ELEMENTS</a></div><div class="ttdeci">@ ADER_PREDICTOR_STEP_COMM_ELEMENTS</div><div class="ttdoc">ADER predictor step for elements whose solution must be communicated.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00057">task_definition.hpp:57</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74aac997ca4b8d79ba7a41fb51cb53c8458"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aac997ca4b8d79ba7a41fb51cb53c8458">CTaskDefinition::BOUNDARY_CONDITIONS_DEPEND_ON_HALO</a></div><div class="ttdeci">@ BOUNDARY_CONDITIONS_DEPEND_ON_HALO</div><div class="ttdoc">Compute the contribution to the residual from the boundary conditions that depend on halo elements.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00071">task_definition.hpp:71</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74ad0a99da83dbd845544315fd5ba3ec874"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ad0a99da83dbd845544315fd5ba3ec874">CTaskDefinition::SUM_UP_RESIDUAL_CONTRIBUTIONS_HALO_ELEMENTS</a></div><div class="ttdeci">@ SUM_UP_RESIDUAL_CONTRIBUTIONS_HALO_ELEMENTS</div><div class="ttdoc">Sum up all contributions to the residual for the halo elements.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00073">task_definition.hpp:73</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74ad0d58281f452d4daa9507dd35d948f3b"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ad0d58281f452d4daa9507dd35d948f3b">CTaskDefinition::ADER_TIME_INTERPOLATE_OWNED_ELEMENTS</a></div><div class="ttdeci">@ ADER_TIME_INTERPOLATE_OWNED_ELEMENTS</div><div class="ttdoc">Carry out a time interpolation to an integration point for the owned elements.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00063">task_definition.hpp:63</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74adde810be8601e9a6ee25b90abc35fbf1"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74adde810be8601e9a6ee25b90abc35fbf1">CTaskDefinition::MULTIPLY_INVERSE_MASS_MATRIX</a></div><div class="ttdeci">@ MULTIPLY_INVERSE_MASS_MATRIX</div><div class="ttdoc">Multiply the accumulated residual with the inverse of the mass matrix.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00076">task_definition.hpp:76</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74ae7a15d8f6916cb075308fdf330f8d7cd"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74ae7a15d8f6916cb075308fdf330f8d7cd">CTaskDefinition::ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS</a></div><div class="ttdeci">@ ADER_ACCUMULATE_SPACETIME_RESIDUAL_OWNED_ELEMENTS</div><div class="ttdoc">Accumlate the ADER space time residual for the owned elements.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00074">task_definition.hpp:74</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74aecf3a269d02eb493020bceecf4262415"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74aecf3a269d02eb493020bceecf4262415">CTaskDefinition::COMPLETE_REVERSE_MPI_COMMUNICATION</a></div><div class="ttdeci">@ COMPLETE_REVERSE_MPI_COMMUNICATION</div><div class="ttdoc">Complete the communication of the residuals.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00062">task_definition.hpp:62</a></div></div>
<div class="ttc" id="aclass_c_task_definition_html_a8e02821f42eb86937de9937e82c6dd74af3eb9ac3d402c19dc3d270edff6625aa"><div class="ttname"><a href="class_c_task_definition.html#a8e02821f42eb86937de9937e82c6dd74af3eb9ac3d402c19dc3d270edff6625aa">CTaskDefinition::VOLUME_RESIDUAL</a></div><div class="ttdeci">@ VOLUME_RESIDUAL</div><div class="ttdoc">Compute the contribution to the residual from the volume integral.</div><div class="ttdef"><b>Definition:</b> <a href="task__definition_8hpp_source.html#l00067">task_definition.hpp:67</a></div></div>
<div class="ttc" id="aclass_c_van_der_waals_gas_html"><div class="ttname"><a href="class_c_van_der_waals_gas.html">CVanDerWaalsGas</a></div><div class="ttdoc">Child class for defining the Van der Waals model.</div><div class="ttdef"><b>Definition:</b> <a href="fluid__model_8hpp_source.html#l00433">fluid_model.hpp:433</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html"><div class="ttname"><a href="class_c_volume_element_f_e_m.html">CVolumeElementFEM</a></div><div class="ttdoc">Class to store a volume element for the FEM solver.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00237">fem_geometry_structure.hpp:237</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a02b5ff59de9ae4559e88381a0571acf1"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a02b5ff59de9ae4559e88381a0571acf1">CVolumeElementFEM::offsetDOFsSolLocal</a></div><div class="ttdeci">unsigned long offsetDOFsSolLocal</div><div class="ttdoc">Local offset of the solution DOFs of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00267">fem_geometry_structure.hpp:267</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a0e6816b988bcaeeb106a228096412c4b"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a0e6816b988bcaeeb106a228096412c4b">CVolumeElementFEM::indStandardElement</a></div><div class="ttdeci">unsigned short indStandardElement</div><div class="ttdoc">Index in the vector of standard elements.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00259">fem_geometry_structure.hpp:259</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a1719ed3ac3197990c7463c9317cae90b"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a1719ed3ac3197990c7463c9317cae90b">CVolumeElementFEM::gridVelocities</a></div><div class="ttdeci">vector&lt; su2double &gt; gridVelocities</div><div class="ttdoc">Vector of the grid velocities in the integration points of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00297">fem_geometry_structure.hpp:297</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a2d8cb0d23c35d78eb7f0a1ebc95be2c1"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a2d8cb0d23c35d78eb7f0a1ebc95be2c1">CVolumeElementFEM::VTK_Type</a></div><div class="ttdeci">unsigned short VTK_Type</div><div class="ttdoc">Element type using the VTK convention.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00250">fem_geometry_structure.hpp:250</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a2e1ebd88419fba439acdfb1524915ab5"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a2e1ebd88419fba439acdfb1524915ab5">CVolumeElementFEM::lenScale</a></div><div class="ttdeci">su2double lenScale</div><div class="ttdoc">Length scale of the element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00282">fem_geometry_structure.hpp:282</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a3c90e5beb43d51190439eeadd0f29c74"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a3c90e5beb43d51190439eeadd0f29c74">CVolumeElementFEM::gridVelocitiesSolDOFs</a></div><div class="ttdeci">vector&lt; su2double &gt; gridVelocitiesSolDOFs</div><div class="ttdoc">Vector of the grid velocities in the solution DOFs of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00299">fem_geometry_structure.hpp:299</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a4dce50854c91ee9d721a72bbadd50254"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a4dce50854c91ee9d721a72bbadd50254">CVolumeElementFEM::metricTerms2ndDer</a></div><div class="ttdeci">vector&lt; su2double &gt; metricTerms2ndDer</div><div class="ttdoc">Vector of the metric terms needed for the computation of the 2nd derivatives in the integration point...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00292">fem_geometry_structure.hpp:292</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a51a6fc4be49459ff00b9391ba87291cd"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a51a6fc4be49459ff00b9391ba87291cd">CVolumeElementFEM::coorIntegrationPoints</a></div><div class="ttdeci">vector&lt; su2double &gt; coorIntegrationPoints</div><div class="ttdoc">The coordinates of the integration points of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00305">fem_geometry_structure.hpp:305</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a53ea2b1580c4f0c4da67a21cbeaf27b3"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a53ea2b1580c4f0c4da67a21cbeaf27b3">CVolumeElementFEM::coorSolDOFs</a></div><div class="ttdeci">vector&lt; su2double &gt; coorSolDOFs</div><div class="ttdoc">The coordinates of the solution DOFs of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00306">fem_geometry_structure.hpp:306</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a672104ec690d1efa0e99d3d527264ef4"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a672104ec690d1efa0e99d3d527264ef4">CVolumeElementFEM::metricTerms</a></div><div class="ttdeci">vector&lt; su2double &gt; metricTerms</div><div class="ttdoc">Vector of the metric terms in the integration points of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00288">fem_geometry_structure.hpp:288</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a6adc8d7d1588b7747b8f278fcd73b58f"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a6adc8d7d1588b7747b8f278fcd73b58f">CVolumeElementFEM::wallDistanceSolDOFs</a></div><div class="ttdeci">vector&lt; su2double &gt; wallDistanceSolDOFs</div><div class="ttdoc">The wall distance to the viscous walls for the solution DOFs of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00309">fem_geometry_structure.hpp:309</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_a740772246345edeefefc843e4b787d68"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#a740772246345edeefefc843e4b787d68">CVolumeElementFEM::offsetDOFsSolGlobal</a></div><div class="ttdeci">unsigned long offsetDOFsSolGlobal</div><div class="ttdoc">Global offset of the solution DOFs of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00266">fem_geometry_structure.hpp:266</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_aa9c40460f4f77c1d43a99e7a77e595ca"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#aa9c40460f4f77c1d43a99e7a77e595ca">CVolumeElementFEM::factTimeLevel</a></div><div class="ttdeci">unsigned int factTimeLevel</div><div class="ttdoc">Number of local time steps for this element compared to the largest time step when time accurate loca...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00261">fem_geometry_structure.hpp:261</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_abcd8ed2e51e1429b0f164086419a40ff"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#abcd8ed2e51e1429b0f164086419a40ff">CVolumeElementFEM::wallDistance</a></div><div class="ttdeci">vector&lt; su2double &gt; wallDistance</div><div class="ttdoc">The wall distance to the viscous walls for the integration points of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00307">fem_geometry_structure.hpp:307</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_ac0f0a4de25e6201fc028247bd0cd40eb"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#ac0f0a4de25e6201fc028247bd0cd40eb">CVolumeElementFEM::lumpedMassMatrix</a></div><div class="ttdeci">vector&lt; su2double &gt; lumpedMassMatrix</div><div class="ttdoc">Lumped mass matrix for this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00303">fem_geometry_structure.hpp:303</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_aca2a1ae12ad274b8c2494ffb69bd73f1"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#aca2a1ae12ad274b8c2494ffb69bd73f1">CVolumeElementFEM::offsetDOFsSolPrevTimeLevel</a></div><div class="ttdeci">unsigned long offsetDOFsSolPrevTimeLevel</div><div class="ttdoc">Local offset of the solution DOFs of this element in the working vector of the previous time level.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00272">fem_geometry_structure.hpp:272</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_ad861b94102b072bb21d1665ef7932f2d"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#ad861b94102b072bb21d1665ef7932f2d">CVolumeElementFEM::timeLevel</a></div><div class="ttdeci">unsigned short timeLevel</div><div class="ttdoc">Time level of the element when time accurate local time stepping is employed.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00256">fem_geometry_structure.hpp:256</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_ade87ae25bf13e3f96ff015e79386173c"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#ade87ae25bf13e3f96ff015e79386173c">CVolumeElementFEM::offsetDOFsSolThisTimeLevel</a></div><div class="ttdeci">unsigned long offsetDOFsSolThisTimeLevel</div><div class="ttdoc">Local offset of the solution DOFs of this element in the working vector of the time level of the elem...</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00269">fem_geometry_structure.hpp:269</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_ae6c47cde654970b624c84f026f604a67"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#ae6c47cde654970b624c84f026f604a67">CVolumeElementFEM::metricTermsSolDOFs</a></div><div class="ttdeci">vector&lt; su2double &gt; metricTermsSolDOFs</div><div class="ttdoc">Vector of the metric terms in the solution DOFs of this element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00290">fem_geometry_structure.hpp:290</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_af8d803542e4530244295b095f0e40dcb"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#af8d803542e4530244295b095f0e40dcb">CVolumeElementFEM::shockArtificialViscosity</a></div><div class="ttdeci">su2double shockArtificialViscosity</div><div class="ttdoc">Artificial viscosity for a shock.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00285">fem_geometry_structure.hpp:285</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_af986cf3e59a8ce535f65b32b360a0258"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#af986cf3e59a8ce535f65b32b360a0258">CVolumeElementFEM::nDOFsSol</a></div><div class="ttdeci">unsigned short nDOFsSol</div><div class="ttdoc">Number of DOFs for the solution of the element.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00254">fem_geometry_structure.hpp:254</a></div></div>
<div class="ttc" id="aclass_c_volume_element_f_e_m_html_afee7aa41b9ef5cb33a6239ef2961fc57"><div class="ttname"><a href="class_c_volume_element_f_e_m.html#afee7aa41b9ef5cb33a6239ef2961fc57">CVolumeElementFEM::shockSensorValue</a></div><div class="ttdeci">su2double shockSensorValue</div><div class="ttdoc">Value for sensing a shock.</div><div class="ttdef"><b>Definition:</b> <a href="fem__geometry__structure_8hpp_source.html#l00284">fem_geometry_structure.hpp:284</a></div></div>
<div class="ttc" id="aclass_c_vreman_model_html"><div class="ttname"><a href="class_c_vreman_model.html">CVremanModel</a></div><div class="ttdoc">Derived class for defining the WALE SGS model.</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8hpp_source.html#l00612">sgs_model.hpp:612</a></div></div>
<div class="ttc" id="aclass_c_w_a_l_e_model_html"><div class="ttname"><a href="class_c_w_a_l_e_model.html">CWALEModel</a></div><div class="ttdoc">Derived class for defining the WALE SGS model.</div><div class="ttdef"><b>Definition:</b> <a href="sgs__model_8hpp_source.html#l00424">sgs_model.hpp:424</a></div></div>
<div class="ttc" id="aclass_c_wall_model_html"><div class="ttname"><a href="class_c_wall_model.html">CWallModel</a></div><div class="ttdoc">Base class for defining the LES wall model.</div><div class="ttdef"><b>Definition:</b> <a href="wall__model_8hpp_source.html#l00050">wall_model.hpp:50</a></div></div>
<div class="ttc" id="aclass_c_wall_model_html_a813b1c83b53bfa4f76e2ac228067459f"><div class="ttname"><a href="class_c_wall_model.html#a813b1c83b53bfa4f76e2ac228067459f">CWallModel::WallShearStressAndHeatFlux</a></div><div class="ttdeci">virtual void WallShearStressAndHeatFlux(const su2double tExchange, const su2double velExchange, const su2double muExchange, const su2double pExchange, const su2double Wall_HeatFlux, const bool HeatFlux_Prescribed, const su2double TWall, const bool Temperature_Prescribed, su2double &amp;tauWall, su2double &amp;qWall, su2double &amp;ViscosityWall, su2double &amp;kOverCvWall)</div><div class="ttdoc">Virtual function, which computes the wall shear stress and heat flux from the data at the exchange lo...</div><div class="ttdef"><b>Definition:</b> <a href="wall__model_8inl_source.html#l00049">wall_model.inl:49</a></div></div>
<div class="ttc" id="acodi__forward__structure_8hpp_html_a87976ffca908428510c7b3fb2f4c1a80"><div class="ttname"><a href="codi__forward__structure_8hpp.html#a87976ffca908428510c7b3fb2f4c1a80">su2double</a></div><div class="ttdeci">codi::RealForward su2double</div><div class="ttdef"><b>Definition:</b> <a href="codi__forward__structure_8hpp_source.html#l00041">codi_forward_structure.hpp:41</a></div></div>
<div class="ttc" id="adatatype__structure_8hpp_html_abb7b40f22e781523236840ff3c747b62"><div class="ttname"><a href="datatype__structure_8hpp.html#abb7b40f22e781523236840ff3c747b62">passivedouble</a></div><div class="ttdeci">double passivedouble</div><div class="ttdef"><b>Definition:</b> <a href="datatype__structure_8hpp_source.html#l00064">datatype_structure.hpp:64</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_a2df6a15627583d5e6f5a48550644cbef"><div class="ttname"><a href="mpi__structure_8hpp.html#a2df6a15627583d5e6f5a48550644cbef">MPI_COMM_WORLD</a></div><div class="ttdeci">#define MPI_COMM_WORLD</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00303">mpi_structure.hpp:303</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_a43ed7cd86d20f84db849adc64a09415e"><div class="ttname"><a href="mpi__structure_8hpp.html#a43ed7cd86d20f84db849adc64a09415e">MPI_INT</a></div><div class="ttdeci">#define MPI_INT</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00314">mpi_structure.hpp:314</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_a80d80987b473f4a13b0cc0384eddb51b"><div class="ttname"><a href="mpi__structure_8hpp.html#a80d80987b473f4a13b0cc0384eddb51b">MPI_MAX</a></div><div class="ttdeci">#define MPI_MAX</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00313">mpi_structure.hpp:313</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_a84662874cf763c9001e3913fe20b3785"><div class="ttname"><a href="mpi__structure_8hpp.html#a84662874cf763c9001e3913fe20b3785">CURRENT_FUNCTION</a></div><div class="ttdeci">#define CURRENT_FUNCTION</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00441">mpi_structure.hpp:441</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_a9b2b3fcdfe74a7a8b6d98a14d92a4b43"><div class="ttname"><a href="mpi__structure_8hpp.html#a9b2b3fcdfe74a7a8b6d98a14d92a4b43">MPI_UNSIGNED_LONG</a></div><div class="ttdeci">#define MPI_UNSIGNED_LONG</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00304">mpi_structure.hpp:304</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aa058ba472f0fd41ae860caeaebca0166"><div class="ttname"><a href="mpi__structure_8hpp.html#aa058ba472f0fd41ae860caeaebca0166">MPI_SUM</a></div><div class="ttdeci">#define MPI_SUM</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00309">mpi_structure.hpp:309</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aa2fecfa16d35e8fa3894c512a527b73f"><div class="ttname"><a href="mpi__structure_8hpp.html#aa2fecfa16d35e8fa3894c512a527b73f">MPI_MIN</a></div><div class="ttdeci">#define MPI_MIN</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00312">mpi_structure.hpp:312</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aad01846ca8da972658f74b9affe1d5e8"><div class="ttname"><a href="mpi__structure_8hpp.html#aad01846ca8da972658f74b9affe1d5e8">MPI_ANY_SOURCE</a></div><div class="ttdeci">#define MPI_ANY_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00308">mpi_structure.hpp:308</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_aafd1dc0086079e7904385538c54c9c8f"><div class="ttname"><a href="mpi__structure_8hpp.html#aafd1dc0086079e7904385538c54c9c8f">MPI_DOUBLE</a></div><div class="ttdeci">#define MPI_DOUBLE</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00307">mpi_structure.hpp:307</a></div></div>
<div class="ttc" id="ampi__structure_8hpp_html_acdbf7a6bf241b33828d6d38aac098c0f"><div class="ttname"><a href="mpi__structure_8hpp.html#acdbf7a6bf241b33828d6d38aac098c0f">MPI_UNSIGNED_SHORT</a></div><div class="ttdeci">#define MPI_UNSIGNED_SHORT</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00306">mpi_structure.hpp:306</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a010c51bd37c27270292797ea1db8a942"><div class="ttname"><a href="option__structure_8hpp.html#a010c51bd37c27270292797ea1db8a942">MASTER_NODE</a></div><div class="ttdeci">const int MASTER_NODE</div><div class="ttdoc">Master node for MPI parallelization.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00147">option_structure.hpp:147</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a092d4e3317e650c1976872c763a668d8"><div class="ttname"><a href="option__structure_8hpp.html#a092d4e3317e650c1976872c763a668d8">PI_NUMBER</a></div><div class="ttdeci">const su2double PI_NUMBER</div><div class="ttdoc">Pi number.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00145">option_structure.hpp:145</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a0e3c6990687ed4453e660b9db9181885a0d077f5b932ce05e5b9f30c6087a2f31"><div class="ttname"><a href="option__structure_8hpp.html#a0e3c6990687ed4453e660b9db9181885a0d077f5b932ce05e5b9f30c6087a2f31">NO</a></div><div class="ttdeci">@ NO</div><div class="ttdoc">Boolean definition of no.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00173">option_structure.hpp:173</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a0e3c6990687ed4453e660b9db9181885a99f136a862ba5c7d16967231c29f09d6"><div class="ttname"><a href="option__structure_8hpp.html#a0e3c6990687ed4453e660b9db9181885a99f136a862ba5c7d16967231c29f09d6">YES</a></div><div class="ttdeci">@ YES</div><div class="ttdoc">Boolean definition of yes.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00175">option_structure.hpp:174</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a0e3c6990687ed4453e660b9db9181885ac157bdf0b85a40d2619cbc8bc1ae5fe2"><div class="ttname"><a href="option__structure_8hpp.html#a0e3c6990687ed4453e660b9db9181885ac157bdf0b85a40d2619cbc8bc1ae5fe2">NONE</a></div><div class="ttdeci">@ NONE</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00172">option_structure.hpp:172</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a0e6f6eb4c523780ba375ff4b5ecb906aa531fbaba650723322b74397cd70021c1"><div class="ttname"><a href="option__structure_8hpp.html#a0e6f6eb4c523780ba375ff4b5ecb906aa531fbaba650723322b74397cd70021c1">LAX_FRIEDRICH</a></div><div class="ttdeci">@ LAX_FRIEDRICH</div><div class="ttdoc">Lax-Friedrich numerical method.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00719">option_structure.hpp:718</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a0e6f6eb4c523780ba375ff4b5ecb906aa93529177c2934ca4f60d82a6b1c85c67"><div class="ttname"><a href="option__structure_8hpp.html#a0e6f6eb4c523780ba375ff4b5ecb906aa93529177c2934ca4f60d82a6b1c85c67">ROE</a></div><div class="ttdeci">@ ROE</div><div class="ttdoc">Roe's upwind numerical method.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00704">option_structure.hpp:704</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a12f1af627694b6770a33eb21cbbe4a36a87b50d917dc1184a391e4e66490b5c47"><div class="ttname"><a href="option__structure_8hpp.html#a12f1af627694b6770a33eb21cbbe4a36a87b50d917dc1184a391e4e66490b5c47">TEMPERATURE_FS</a></div><div class="ttdeci">@ TEMPERATURE_FS</div><div class="ttdoc">_____.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00580">option_structure.hpp:580</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a184f3e05360d2edd70ac64aaa2b29785a0a635ef58892b1996b2178d598e00db4"><div class="ttname"><a href="option__structure_8hpp.html#a184f3e05360d2edd70ac64aaa2b29785a0a635ef58892b1996b2178d598e00db4">PERSSON</a></div><div class="ttdeci">@ PERSSON</div><div class="ttdoc">Per-Olof Persson's sub-cell shock capturing method.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00755">option_structure.hpp:754</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a194d116741c1b9a9b2d2d5ca0de9c5a3"><div class="ttname"><a href="option__structure_8hpp.html#a194d116741c1b9a9b2d2d5ca0de9c5a3">STANDARD_GRAVITY</a></div><div class="ttdeci">const su2double STANDARD_GRAVITY</div><div class="ttdoc">Acceleration due to gravity at surface of earth.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00134">option_structure.hpp:134</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a1c0aaa963aeef12ad1fd705409815248a6b39c56a74e0c2bbb104a17be7aaf269"><div class="ttname"><a href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248a6b39c56a74e0c2bbb104a17be7aaf269">CLASSICAL_RK4_EXPLICIT</a></div><div class="ttdeci">@ CLASSICAL_RK4_EXPLICIT</div><div class="ttdoc">Classical RK4 time integration definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00905">option_structure.hpp:905</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9"><div class="ttname"><a href="option__structure_8hpp.html#a1c0aaa963aeef12ad1fd705409815248ac0d2a1ff53828112e8a60386186a10c9">ADER_DG</a></div><div class="ttdeci">@ ADER_DG</div><div class="ttdoc">ADER-DG time integration definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00907">option_structure.hpp:906</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a2678e216127388c9c2e1812dda61dd7f"><div class="ttname"><a href="option__structure_8hpp.html#a2678e216127388c9c2e1812dda61dd7f">EPS</a></div><div class="ttdeci">const su2double EPS</div><div class="ttdoc">Error scale.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00138">option_structure.hpp:138</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a2a786c02917df4dda5cf6c49e01794fea5fa3210aba4e29bca6294a071fdf8086"><div class="ttname"><a href="option__structure_8hpp.html#a2a786c02917df4dda5cf6c49e01794fea5fa3210aba4e29bca6294a071fdf8086">ADER_ALIASED_PREDICTOR</a></div><div class="ttdeci">@ ADER_ALIASED_PREDICTOR</div><div class="ttdoc">Aliased predictor, easiest to do.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00919">option_structure.hpp:919</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a3616aebee98fba744158cf119de2c9e6a92f4c6db8015e92cae8263aa01bb3812"><div class="ttname"><a href="option__structure_8hpp.html#a3616aebee98fba744158cf119de2c9e6a92f4c6db8015e92cae8263aa01bb3812">CONSTANT_CONDUCTIVITY</a></div><div class="ttdeci">@ CONSTANT_CONDUCTIVITY</div><div class="ttdoc">_____.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00605">option_structure.hpp:605</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a3616aebee98fba744158cf119de2c9e6ada97e16f7fdc7812f37949e2d75cd3b6"><div class="ttname"><a href="option__structure_8hpp.html#a3616aebee98fba744158cf119de2c9e6ada97e16f7fdc7812f37949e2d75cd3b6">CONSTANT_PRANDTL</a></div><div class="ttdeci">@ CONSTANT_PRANDTL</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00607">option_structure.hpp:606</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a3d92e0a004752d2ef55cf6c1e2e3d6f0a20621ea72bb142dc0c8bf116a257516a"><div class="ttname"><a href="option__structure_8hpp.html#a3d92e0a004752d2ef55cf6c1e2e3d6f0a20621ea72bb142dc0c8bf116a257516a">COMPRESSIBLE</a></div><div class="ttdeci">@ COMPRESSIBLE</div><div class="ttdoc">Definition of compressible solver.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00396">option_structure.hpp:396</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a43ea705e690ad6482423e483ddf04ed1"><div class="ttname"><a href="option__structure_8hpp.html#a43ea705e690ad6482423e483ddf04ed1">MESH_0</a></div><div class="ttdeci">const unsigned int MESH_0</div><div class="ttdoc">Definition of the finest grid level.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00128">option_structure.hpp:128</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977a2fd33892864d1c342d3bead2f2d9ad56"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a2fd33892864d1c342d3bead2f2d9ad56">TRIANGLE</a></div><div class="ttdeci">@ TRIANGLE</div><div class="ttdoc">VTK nomenclature for defining a triangle element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01307">option_structure.hpp:1307</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977a3fcd053f6577a9c10a59c3d3595658eb"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a3fcd053f6577a9c10a59c3d3595658eb">PYRAMID</a></div><div class="ttdeci">@ PYRAMID</div><div class="ttdoc">VTK nomenclature for defining a pyramid element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01313">option_structure.hpp:1312</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977a4cc31b3ed970e3f26bfd2d491b8d7946"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a4cc31b3ed970e3f26bfd2d491b8d7946">PRISM</a></div><div class="ttdeci">@ PRISM</div><div class="ttdoc">VTK nomenclature for defining a prism element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01311">option_structure.hpp:1311</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977a626d2901e9e521eb60f5681ada30849c"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977a626d2901e9e521eb60f5681ada30849c">QUADRILATERAL</a></div><div class="ttdeci">@ QUADRILATERAL</div><div class="ttdoc">VTK nomenclature for defining a quadrilateral element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01308">option_structure.hpp:1308</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977aa67bd73e46a66076a9980159f8011a02"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977aa67bd73e46a66076a9980159f8011a02">HEXAHEDRON</a></div><div class="ttdeci">@ HEXAHEDRON</div><div class="ttdoc">VTK nomenclature for defining a hexahedron element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01310">option_structure.hpp:1310</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a53dca17cf73f15e0b4209faab95c6977ad447314c433c39f567ca6bd240eae16a"><div class="ttname"><a href="option__structure_8hpp.html#a53dca17cf73f15e0b4209faab95c6977ad447314c433c39f567ca6bd240eae16a">TETRAHEDRON</a></div><div class="ttdeci">@ TETRAHEDRON</div><div class="ttdoc">VTK nomenclature for defining a tetrahedron element.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01309">option_structure.hpp:1309</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a58bff0617305ea06492d81d265b0a10da21ba3bc4a36398f4c11fba2c3db9e877"><div class="ttname"><a href="option__structure_8hpp.html#a58bff0617305ea06492d81d265b0a10da21ba3bc4a36398f4c11fba2c3db9e877">MOVING_WALL</a></div><div class="ttdeci">@ MOVING_WALL</div><div class="ttdoc">Simulation with moving walls (translation/rotation).</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00624">option_structure.hpp:624</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a58bff0617305ea06492d81d265b0a10da3833563dbc80900ab1895a2c412c4a2f"><div class="ttname"><a href="option__structure_8hpp.html#a58bff0617305ea06492d81d265b0a10da3833563dbc80900ab1895a2c412c4a2f">STEADY_TRANSLATION</a></div><div class="ttdeci">@ STEADY_TRANSLATION</div><div class="ttdoc">Simulation in a steadily translating frame.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00628">option_structure.hpp:628</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a58bff0617305ea06492d81d265b0a10da64b25709b7956ea45c64741c6fcc6893"><div class="ttname"><a href="option__structure_8hpp.html#a58bff0617305ea06492d81d265b0a10da64b25709b7956ea45c64741c6fcc6893">RIGID_MOTION</a></div><div class="ttdeci">@ RIGID_MOTION</div><div class="ttdoc">Simulation with rigid mesh motion (plunging/pitching/rotation).</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00619">option_structure.hpp:619</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a58bff0617305ea06492d81d265b0a10da9bbe0bc2eafe12b2c686a121e632602a"><div class="ttname"><a href="option__structure_8hpp.html#a58bff0617305ea06492d81d265b0a10da9bbe0bc2eafe12b2c686a121e632602a">ROTATING_FRAME</a></div><div class="ttdeci">@ ROTATING_FRAME</div><div class="ttdoc">Simulation in a rotating frame.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00625">option_structure.hpp:625</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a5d71f391b914291d278ea064ff1d630aa3220fb2c414b80589e6e55d1158b4d00"><div class="ttname"><a href="option__structure_8hpp.html#a5d71f391b914291d278ea064ff1d630aa3220fb2c414b80589e6e55d1158b4d00">STATIC_SUPERSONIC_INFLOW_PD</a></div><div class="ttdeci">@ STATIC_SUPERSONIC_INFLOW_PD</div><div class="ttdoc">User specifies static pressure, static temperature, and Mach components.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01125">option_structure.hpp:1125</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a5d71f391b914291d278ea064ff1d630aa4e7c809b164ce0e69b9bf6b0de9c2be6"><div class="ttname"><a href="option__structure_8hpp.html#a5d71f391b914291d278ea064ff1d630aa4e7c809b164ce0e69b9bf6b0de9c2be6">TOTAL_CONDITIONS_PT</a></div><div class="ttdeci">@ TOTAL_CONDITIONS_PT</div><div class="ttdoc">User specifies total pressure, total temperature, and flow direction.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01120">option_structure.hpp:1120</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a5d71f391b914291d278ea064ff1d630aa79ad8580d95c49a84a083e789310407d"><div class="ttname"><a href="option__structure_8hpp.html#a5d71f391b914291d278ea064ff1d630aa79ad8580d95c49a84a083e789310407d">DENSITY_VELOCITY</a></div><div class="ttdeci">@ DENSITY_VELOCITY</div><div class="ttdoc">User specifies density and velocity, and flow direction.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01121">option_structure.hpp:1121</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a5d71f391b914291d278ea064ff1d630aab43a8babdd78cf02702bb2fb348a8026"><div class="ttname"><a href="option__structure_8hpp.html#a5d71f391b914291d278ea064ff1d630aab43a8babdd78cf02702bb2fb348a8026">STATIC_PRESSURE</a></div><div class="ttdeci">@ STATIC_PRESSURE</div><div class="ttdoc">User specifies static pressure.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01122">option_structure.hpp:1122</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a5d71f391b914291d278ea064ff1d630aae3e034605bb816c85708093e4feba319"><div class="ttname"><a href="option__structure_8hpp.html#a5d71f391b914291d278ea064ff1d630aae3e034605bb816c85708093e4feba319">STATIC_SUPERSONIC_INFLOW_PT</a></div><div class="ttdeci">@ STATIC_SUPERSONIC_INFLOW_PT</div><div class="ttdoc">User specifies static pressure, static temperature, and Mach components.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01124">option_structure.hpp:1124</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a67e195cd9919c129a4abecd5dec5d9d0a116141d28357277f6fac452184452141"><div class="ttname"><a href="option__structure_8hpp.html#a67e195cd9919c129a4abecd5dec5d9d0a116141d28357277f6fac452184452141">HARMONIC_BALANCE</a></div><div class="ttdeci">@ HARMONIC_BALANCE</div><div class="ttdoc">Use a harmonic balance source term.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01800">option_structure.hpp:1798</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a67e195cd9919c129a4abecd5dec5d9d0ad914f117053e185f2adaab9780d9a50d"><div class="ttname"><a href="option__structure_8hpp.html#a67e195cd9919c129a4abecd5dec5d9d0ad914f117053e185f2adaab9780d9a50d">TIME_STEPPING</a></div><div class="ttdeci">@ TIME_STEPPING</div><div class="ttdoc">Use a time stepping strategy for unsteady computations.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01794">option_structure.hpp:1794</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a7e93bda08563596859d4d82f0ab516aca9833bae71221104500b678a587572a2b"><div class="ttname"><a href="option__structure_8hpp.html#a7e93bda08563596859d4d82f0ab516aca9833bae71221104500b678a587572a2b">FEM_RANS</a></div><div class="ttdeci">@ FEM_RANS</div><div class="ttdoc">Definition of the finite element Reynolds-averaged Navier-Stokes' (RANS) solver.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00226">option_structure.hpp:226</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a7e93bda08563596859d4d82f0ab516acad2cab85bb44510e289b85c4d94ac478a"><div class="ttname"><a href="option__structure_8hpp.html#a7e93bda08563596859d4d82f0ab516acad2cab85bb44510e289b85c4d94ac478a">FEM_LES</a></div><div class="ttdeci">@ FEM_LES</div><div class="ttdoc">Definition of the finite element Large Eddy Simulation Navier-Stokes' (LES) solver.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00228">option_structure.hpp:227</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a83df276d33a9e23b8ae7dd00db6fd817a0316ed5cbc90bdaf08101ed1aeeae0c8"><div class="ttname"><a href="option__structure_8hpp.html#a83df276d33a9e23b8ae7dd00db6fd817a0316ed5cbc90bdaf08101ed1aeeae0c8">SUTHERLAND</a></div><div class="ttdeci">@ SUTHERLAND</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00595">option_structure.hpp:594</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a83df276d33a9e23b8ae7dd00db6fd817ac665ee5e2a93b496d0c9dd82b30c4480"><div class="ttname"><a href="option__structure_8hpp.html#a83df276d33a9e23b8ae7dd00db6fd817ac665ee5e2a93b496d0c9dd82b30c4480">CONSTANT_VISCOSITY</a></div><div class="ttdeci">@ CONSTANT_VISCOSITY</div><div class="ttdoc">_____.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00593">option_structure.hpp:593</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_a88c999a2ce949a2b939c223ae1132480"><div class="ttname"><a href="option__structure_8hpp.html#a88c999a2ce949a2b939c223ae1132480">TWO3</a></div><div class="ttdeci">const su2double TWO3</div><div class="ttdoc">Two divided by three.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00142">option_structure.hpp:142</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba11d18e3062791a329262ca35eba70a9e"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba11d18e3062791a329262ca35eba70a9e">CUSTOM_BOUNDARY</a></div><div class="ttdeci">@ CUSTOM_BOUNDARY</div><div class="ttdoc">custom boundary definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01021">option_structure.hpp:1021</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba2017081e4aa73a6aef6fdd6b3a380fbf"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba2017081e4aa73a6aef6fdd6b3a380fbf">FAR_FIELD</a></div><div class="ttdeci">@ FAR_FIELD</div><div class="ttdoc">Boundary far-field definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01013">option_structure.hpp:1013</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba229d80524b666a7ebf409d3655255a1a"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba229d80524b666a7ebf409d3655255a1a">EULER_WALL</a></div><div class="ttdeci">@ EULER_WALL</div><div class="ttdoc">Boundary Euler wall definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01012">option_structure.hpp:1012</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba39cc771bae1aefe200524778d36daa34">ISOTHERMAL</a></div><div class="ttdeci">@ ISOTHERMAL</div><div class="ttdoc">No slip isothermal wall boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01033">option_structure.hpp:1033</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba6dc1b159829aa7885fc905d3d81f28bd"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba6dc1b159829aa7885fc905d3d81f28bd">INLET_FLOW</a></div><div class="ttdeci">@ INLET_FLOW</div><div class="ttdoc">Boundary inlet flow definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01015">option_structure.hpp:1015</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba7dce7f1da4453165b8d91c603393cac7"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba7dce7f1da4453165b8d91c603393cac7">RIEMANN_BOUNDARY</a></div><div class="ttdeci">@ RIEMANN_BOUNDARY</div><div class="ttdoc">Riemann Boundary definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01032">option_structure.hpp:1032</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba86e05bfda25f3af9a4a88a45551c1711"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba86e05bfda25f3af9a4a88a45551c1711">OUTLET_FLOW</a></div><div class="ttdeci">@ OUTLET_FLOW</div><div class="ttdoc">Boundary outlet flow definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01016">option_structure.hpp:1016</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba880ef9c3117aab907dc52253247e0c23"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba880ef9c3117aab907dc52253247e0c23">SYMMETRY_PLANE</a></div><div class="ttdeci">@ SYMMETRY_PLANE</div><div class="ttdoc">Boundary symmetry plane definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01014">option_structure.hpp:1014</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba8e57aa6eae14b4e84e2ebd0be0d385fb"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba8e57aa6eae14b4e84e2ebd0be0d385fb">SUPERSONIC_INLET</a></div><div class="ttdeci">@ SUPERSONIC_INLET</div><div class="ttdoc">Boundary supersonic inlet definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01028">option_structure.hpp:1028</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820ba971f1c6045acd204579feb9e41166d44">HEAT_FLUX</a></div><div class="ttdeci">@ HEAT_FLUX</div><div class="ttdoc">No slip constant heat flux wall boundary condition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01034">option_structure.hpp:1034</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820bacaed259788fb153495d0901f31e529bf"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820bacaed259788fb153495d0901f31e529bf">SUPERSONIC_OUTLET</a></div><div class="ttdeci">@ SUPERSONIC_OUTLET</div><div class="ttdoc">Boundary supersonic inlet definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01029">option_structure.hpp:1029</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ab191e495c66e3b4c7560f90ad44e820baff3fbf5c45243583a13a7c1c78959953"><div class="ttname"><a href="option__structure_8hpp.html#ab191e495c66e3b4c7560f90ad44e820baff3fbf5c45243583a13a7c1c78959953">PERIODIC_BOUNDARY</a></div><div class="ttdeci">@ PERIODIC_BOUNDARY</div><div class="ttdoc">Periodic boundary definition.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l01017">option_structure.hpp:1017</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_abb44095cd1b2b41f904fc18bc658b543a36c407890548309c6d9931dc2026d793"><div class="ttname"><a href="option__structure_8hpp.html#abb44095cd1b2b41f904fc18bc658b543a36c407890548309c6d9931dc2026d793">FREESTREAM_PRESS_EQ_ONE</a></div><div class="ttdeci">@ FREESTREAM_PRESS_EQ_ONE</div><div class="ttdoc">Non-dimensional compressible simulation with freestream pressure equal to 1.0.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00408">option_structure.hpp:408</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_abb44095cd1b2b41f904fc18bc658b543a844c8392dad6330e1016dd64031273bd"><div class="ttname"><a href="option__structure_8hpp.html#abb44095cd1b2b41f904fc18bc658b543a844c8392dad6330e1016dd64031273bd">DIMENSIONAL</a></div><div class="ttdeci">@ DIMENSIONAL</div><div class="ttdoc">Dimensional simulation (compressible or incompressible).</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00407">option_structure.hpp:407</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_abb44095cd1b2b41f904fc18bc658b543a92bd0b044c90bae1d77b5d60562ad548"><div class="ttname"><a href="option__structure_8hpp.html#abb44095cd1b2b41f904fc18bc658b543a92bd0b044c90bae1d77b5d60562ad548">FREESTREAM_VEL_EQ_MACH</a></div><div class="ttdeci">@ FREESTREAM_VEL_EQ_MACH</div><div class="ttdoc">Non-dimensional compressible simulation with freestream velocity equal to Mach number.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00409">option_structure.hpp:409</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_abb44095cd1b2b41f904fc18bc658b543ab0999eb35a4affc392d7d52037c1f91e"><div class="ttname"><a href="option__structure_8hpp.html#abb44095cd1b2b41f904fc18bc658b543ab0999eb35a4affc392d7d52037c1f91e">FREESTREAM_VEL_EQ_ONE</a></div><div class="ttdeci">@ FREESTREAM_VEL_EQ_ONE</div><div class="ttdoc">Non-dimensional compressible simulation with freestream pressure equal to 1.0.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00410">option_structure.hpp:410</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ac309910df55b56aee3a4077631ef2ca6a018f14c4cf09b1168d285920002c0e02"><div class="ttname"><a href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6a018f14c4cf09b1168d285920002c0e02">IDEAL_GAS</a></div><div class="ttdeci">@ IDEAL_GAS</div><div class="ttdoc">_____.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00531">option_structure.hpp:531</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ac309910df55b56aee3a4077631ef2ca6a27b0e0183e180e07e87338c46d879469"><div class="ttname"><a href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6a27b0e0183e180e07e87338c46d879469">STANDARD_AIR</a></div><div class="ttdeci">@ STANDARD_AIR</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00530">option_structure.hpp:530</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ac309910df55b56aee3a4077631ef2ca6abbbb49e6f42fe5d0fec2f5728888a595"><div class="ttname"><a href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6abbbb49e6f42fe5d0fec2f5728888a595">VW_GAS</a></div><div class="ttdeci">@ VW_GAS</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00532">option_structure.hpp:532</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ac309910df55b56aee3a4077631ef2ca6af5fbeda4fe0ca675217a7e8ce7e33376"><div class="ttname"><a href="option__structure_8hpp.html#ac309910df55b56aee3a4077631ef2ca6af5fbeda4fe0ca675217a7e8ce7e33376">PR_GAS</a></div><div class="ttdeci">@ PR_GAS</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00533">option_structure.hpp:533</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ac7757527c090ef0691642d903069125d"><div class="ttname"><a href="option__structure_8hpp.html#ac7757527c090ef0691642d903069125d">CONV_BOUND_TERM</a></div><div class="ttdeci">const int CONV_BOUND_TERM</div><div class="ttdoc">Position of the convective boundary terms in the numerics container array.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00467">option_structure.hpp:467</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ac9f3f2c2da455edd2b4b1f7ff0688db1a966c1ce78de3189e9f29ab4f1bb900f6"><div class="ttname"><a href="option__structure_8hpp.html#ac9f3f2c2da455edd2b4b1f7ff0688db1a966c1ce78de3189e9f29ab4f1bb900f6">REYNOLDS</a></div><div class="ttdeci">@ REYNOLDS</div><div class="ttdoc">_____.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00566">option_structure.hpp:566</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ad373dc9c6ae8d8d7fe047111b3944f4ea92433826a98d86b2750b2126b12892e6"><div class="ttname"><a href="option__structure_8hpp.html#ad373dc9c6ae8d8d7fe047111b3944f4ea92433826a98d86b2750b2126b12892e6">SST</a></div><div class="ttdeci">@ SST</div><div class="ttdoc">Kind of Turbulence model (Menter SST).</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00799">option_structure.hpp:799</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_adc962393ac6198eea617cc5384baf5e0"><div class="ttname"><a href="option__structure_8hpp.html#adc962393ac6198eea617cc5384baf5e0">CONV_TERM</a></div><div class="ttdeci">const int CONV_TERM</div><div class="ttdoc">Position of the convective terms in the numerics container array.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00463">option_structure.hpp:463</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ae397fe76319f131641386b93affbecb4a52921cb45f445c9b3ed0a770a8bcb5bc"><div class="ttname"><a href="option__structure_8hpp.html#ae397fe76319f131641386b93affbecb4a52921cb45f445c9b3ed0a770a8bcb5bc">VREMAN</a></div><div class="ttdeci">@ VREMAN</div><div class="ttdoc">Vreman SGS model.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00835">option_structure.hpp:834</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ae397fe76319f131641386b93affbecb4aab4eea6b795ac144f4d01fdba5b09ead"><div class="ttname"><a href="option__structure_8hpp.html#ae397fe76319f131641386b93affbecb4aab4eea6b795ac144f4d01fdba5b09ead">IMPLICIT_LES</a></div><div class="ttdeci">@ IMPLICIT_LES</div><div class="ttdoc">Implicit LES, i.e. no explicit SGS model.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00831">option_structure.hpp:831</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ae397fe76319f131641386b93affbecb4ab0a1c23d76a86fa25af680205c74aad0"><div class="ttname"><a href="option__structure_8hpp.html#ae397fe76319f131641386b93affbecb4ab0a1c23d76a86fa25af680205c74aad0">SMAGORINSKY</a></div><div class="ttdeci">@ SMAGORINSKY</div><div class="ttdoc">Smagorinsky SGS model.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00832">option_structure.hpp:832</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ae397fe76319f131641386b93affbecb4aebe1b12794696d7a9825edf3a36a4e37"><div class="ttname"><a href="option__structure_8hpp.html#ae397fe76319f131641386b93affbecb4aebe1b12794696d7a9825edf3a36a4e37">WALE</a></div><div class="ttdeci">@ WALE</div><div class="ttdoc">Wall-Adapting Local Eddy-viscosity SGS model.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00833">option_structure.hpp:833</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_ae40552e21f517bdde7c1a26de77b3e11a686b9a708a0e02450f0b19f485e7e96c"><div class="ttname"><a href="option__structure_8hpp.html#ae40552e21f517bdde7c1a26de77b3e11a686b9a708a0e02450f0b19f485e7e96c">VERB_HIGH</a></div><div class="ttdeci">@ VERB_HIGH</div><div class="ttdoc">High level of verbosity.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00184">option_structure.hpp:183</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa"><div class="ttname"><a href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a56de89a713ba25cddd89edd52fdf2eaa">US</a></div><div class="ttdeci">@ US</div><div class="ttdoc">Definition of incompressible solver.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00428">option_structure.hpp:427</a></div></div>
<div class="ttc" id="aoption__structure_8hpp_html_af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791"><div class="ttname"><a href="option__structure_8hpp.html#af6bed6db440befe2a34b40c6915d5b05a6cbe5ff42f143903e1c67abf94613791">SI</a></div><div class="ttdeci">@ SI</div><div class="ttdoc">Definition of compressible solver.</div><div class="ttdef"><b>Definition:</b> <a href="option__structure_8hpp_source.html#l00426">option_structure.hpp:426</a></div></div>
<div class="ttc" id="asolver__direct__mean__fem_8cpp_html_ad9581c7d57445a61638a869e3b4b8e3b"><div class="ttname"><a href="solver__direct__mean__fem_8cpp.html#ad9581c7d57445a61638a869e3b4b8e3b">SIZE_ARR_NORM</a></div><div class="ttdeci">#define SIZE_ARR_NORM</div><div class="ttdef"><b>Definition:</b> <a href="solver__direct__mean__fem_8cpp_source.html#l00035">solver_direct_mean_fem.cpp:35</a></div></div>
<div class="ttc" id="astruct_c_base_m_p_i_wrapper_1_1_status_html"><div class="ttname"><a href="struct_c_base_m_p_i_wrapper_1_1_status.html">CBaseMPIWrapper::Status</a></div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00323">mpi_structure.hpp:323</a></div></div>
<div class="ttc" id="astruct_c_base_m_p_i_wrapper_1_1_status_html_a0f9345f9774b7ed545340a0bc2b59ef1"><div class="ttname"><a href="struct_c_base_m_p_i_wrapper_1_1_status.html#a0f9345f9774b7ed545340a0bc2b59ef1">CBaseMPIWrapper::Status::MPI_SOURCE</a></div><div class="ttdeci">int MPI_SOURCE</div><div class="ttdef"><b>Definition:</b> <a href="mpi__structure_8hpp_source.html#l00325">mpi_structure.hpp:325</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_6f9fd837e39f246a8f0c94f670ad0309.html">SU2_CFD</a></li><li class="navelem"><a class="el" href="dir_74ad77d76f42ded9212b1c5616a2ad50.html">src</a></li><li class="navelem"><a class="el" href="solver__direct__mean__fem_8cpp.html">solver_direct_mean_fem.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
